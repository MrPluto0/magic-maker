import {
	$ as vT,
	$a as pe,
	$b as _l,
	$c as gC,
	$d as BC,
	$e as Kp,
	$f as of,
	$g as EI,
	$h as $I,
	$i as Ui,
	$j as k_,
	A as Wx,
	Aa as Tp,
	Ab as Ap,
	Ac as nC,
	Ad as mv,
	Ae as o2,
	Af as H2,
	Ag as uI,
	Ah as AI,
	Ai as hc,
	Aj as x_,
	Ak as Le,
	B as uT,
	Ba as Xd,
	Bb as UT,
	Bc as Js,
	Bd as Bp,
	Be as n2,
	Bf as U2,
	Bg as Nl,
	Bh as mm,
	Bi as jI,
	Bj as v_,
	Bk as $f,
	C as Kx,
	Ca as Di,
	Cb as GT,
	Cc as ec,
	Cd as _C,
	Ce as i2,
	Cf as G2,
	Cg as pI,
	Ch as Hv,
	Ci as Lf,
	Cj as ot,
	Ck as dt,
	D as pt,
	Da as Vr,
	Db as WT,
	Dc as dn,
	Dd as AC,
	De as a2,
	Df as W2,
	Dg as fI,
	Dh as kI,
	Di as QI,
	Dj as Gl,
	Dk as H_,
	E as ni,
	Ea as Cp,
	Eb as Fe,
	Ec as Fi,
	Ed as kC,
	Ee as l2,
	Ef as K2,
	Eg as df,
	Eh as LI,
	Ei as Mf,
	Ej as Ff,
	Ek as Kl,
	F as yl,
	Fa as Co,
	Fb as KT,
	Fc as iC,
	Fd as im,
	Fe as s2,
	Ff as jp,
	Fg as Ol,
	Fh as MI,
	Fi as Pf,
	Fj as E_,
	Fk as li,
	G as Kd,
	Ga as xa,
	Gb as YT,
	Gc as Mr,
	Gd as LC,
	Ge as c2,
	Gf as Y2,
	Gg as mf,
	Gh as Uv,
	Gi as JI,
	Gj as y_,
	Gk as U_,
	H as Bs,
	Ha as PT,
	Hb as jd,
	Hc as Rp,
	Hd as MC,
	He as Pl,
	Hf as V2,
	Hg as cm,
	Hh as vf,
	Hi as Rf,
	Hj as w_,
	I as Nn,
	Ia as Zd,
	Ib as kp,
	Ic as aC,
	Id as ic,
	Ie as Up,
	If as Lv,
	Ig as $i,
	Ih as Gv,
	Ii as ai,
	Ij as S_,
	J as Ri,
	Ja as Io,
	Jb as Lp,
	Jc as Fn,
	Jd as PC,
	Je as d2,
	Jf as Qp,
	Jg as gI,
	Jh as Wv,
	Ji as Xv,
	Jj as xc,
	K as $e,
	Ka as Ar,
	Kb as Ys,
	Kc as lC,
	Kd as zp,
	Ke as m2,
	Kf as X2,
	Kg as Ia,
	Kh as PI,
	Ki as e_,
	Kj as rE,
	L as On,
	La as RT,
	Lb as VT,
	Lc as sC,
	Ld as $p,
	Le as u2,
	Lf as Z2,
	Lg as _a,
	Lh as RI,
	Li as Df,
	Lj as T_,
	M as zs,
	Ma as DT,
	Mb as Vs,
	Mc as tc,
	Md as RC,
	Me as p2,
	Mf as Bi,
	Mg as Pv,
	Mh as DI,
	Mi as t_,
	Mj as C_,
	N as $s,
	Na as NT,
	Nb as Qd,
	Nc as Vt,
	Nd as DC,
	Ne as f2,
	Nf as zi,
	Ng as Rv,
	Nh as NI,
	Ni as r_,
	Nj as I_,
	O as bp,
	Oa as Jx,
	Ob as Er,
	Oc as cC,
	Od as uv,
	Oe as g2,
	Of as $n,
	Og as uf,
	Oh as Kv,
	Oi as o_,
	Oj as oE,
	P as Yx,
	Pa as kr,
	Pb as wa,
	Pc as dC,
	Pd as pv,
	Pe as h2,
	Pf as Mv,
	Pg as pf,
	Ph as OI,
	Pi as Q7,
	Pj as __,
	Q as xp,
	Qa as cn,
	Qb as Mp,
	Qc as mC,
	Qd as NC,
	Qe as Gp,
	Qf as q2,
	Qg as hI,
	Qh as FI,
	Qi as La,
	Qj as A_,
	R as pT,
	Ra as OT,
	Rb as Jd,
	Rc as Dp,
	Rd as OC,
	Re as b2,
	Rf as Jp,
	Rg as pn,
	Rh as Ef,
	Ri as fm,
	Rj as Yo,
	S as Yd,
	Sa as ev,
	Sb as XT,
	Sc as uC,
	Sd as fv,
	Se as Wp,
	Sf as am,
	Sg as H,
	Sh as um,
	Si as Zv,
	Sj as Gi,
	T as fT,
	Ta as Us,
	Tb as ZT,
	Tc as Ta,
	Td as gv,
	Te as Av,
	Tf as Hn,
	Tg as bI,
	Th as yf,
	Ti as qv,
	Tj as Un,
	U as gT,
	Ua as Gs,
	Ub as _o,
	Uc as Bn,
	Ud as hv,
	Ue as ac,
	Uf as j2,
	Ug as Dv,
	Uh as wf,
	Ui as jv,
	Uj as me,
	V as Vx,
	Va as Ws,
	Vb as Xs,
	Vc as Np,
	Vd as bv,
	Ve as x2,
	Vf as Q2,
	Vg as Fl,
	Vh as Sf,
	Vi as Qv,
	Vj as Me,
	W as hT,
	Wa as Ip,
	Wb as kt,
	Wc as pC,
	Wd as xv,
	We as v2,
	Wf as ef,
	Wg as xI,
	Wh as Tf,
	Wi as bc,
	Wj as nE,
	X as vr,
	Xa as tv,
	Xb as qT,
	Xc as fC,
	Xd as vv,
	Xe as E2,
	Xf as cc,
	Xg as pc,
	Xh as Cf,
	Xi as mo,
	Xj as Wl,
	Y as vp,
	Ya as rv,
	Yb as jT,
	Yc as re,
	Yd as Ev,
	Ye as y2,
	Yf as tf,
	Yg as Nv,
	Yh as zl,
	Yi as yt,
	Yj as hm,
	Z as bT,
	Za as FT,
	Zb as Zs,
	Zc as mn,
	Zd as yv,
	Ze as w2,
	Zf as dc,
	Zg as vI,
	Zh as BI,
	Zi as Wo,
	Zj as vc,
	_ as xT,
	_a as ov,
	_b as em,
	_c as ft,
	_d as FC,
	_e as S2,
	_f as rf,
	_g as Bl,
	_h as zI,
	_i as Jv,
	_j as iE,
	a as Q,
	aa as ET,
	ab as ao,
	ac as ct,
	ad as zn,
	ae as wv,
	af as Yp,
	ag as J2,
	ah as fc,
	ai as HI,
	aj as n_,
	ak as Bf,
	b as M,
	ba as yT,
	bb as va,
	bc as so,
	bd as Ca,
	be as Sv,
	bf as lc,
	bg as eI,
	bh as ff,
	bi as If,
	bj as Ma,
	bk as L_,
	c as j,
	ca as wT,
	cb as nv,
	cc as Al,
	cd as rc,
	ce as Hp,
	cf as Vp,
	cg as Be,
	ch as Ov,
	ci as UI,
	cj as Hl,
	ck as M_,
	d as Yr,
	da as Hs,
	db as Ea,
	dc as qs,
	dd as hC,
	de as un,
	df as Xp,
	dg as R,
	dh as yI,
	di as GI,
	dj as eE,
	dk as zf,
	e as rT,
	ea as Xx,
	eb as BT,
	ec as Ee,
	ed as bC,
	ee as Tv,
	ef as T2,
	eg as nf,
	eh as Fv,
	ei as Yv,
	ej as i_,
	ek as aE,
	f as vl,
	fa as Zx,
	fb as iv,
	fc as QT,
	fd as xC,
	fe as Cv,
	ff as sc,
	fg as Rl,
	fh as Y7,
	fi as gc,
	fj as a_,
	fk as lE,
	g as oT,
	ga as ST,
	gb as zT,
	gc as Pp,
	gd as Ll,
	ge as zC,
	gf as C2,
	gg as af,
	gh as Bv,
	gi as WI,
	gj as l_,
	gk as sE,
	h as nT,
	ha as TT,
	hb as ii,
	hc as Ye,
	hd as oc,
	he as $C,
	hf as I2,
	hg as mc,
	hh as dm,
	hi as KI,
	hj as tE,
	hk as P_,
	i as Mi,
	ia as Ep,
	ib as wl,
	ic as at,
	id as vC,
	ie as HC,
	if as _2,
	ig as lf,
	ii as YI,
	ij as s_,
	ik as R_,
	j as up,
	ja as yp,
	jb as Lr,
	jc as Lt,
	jd as EC,
	je as UC,
	jf as Go,
	jg as uc,
	ji as _f,
	jj as c_,
	jk as D_,
	k as pp,
	ka as qx,
	kb as Sl,
	kc as qe,
	kd as yC,
	ke as Iv,
	kf as A2,
	kg as tI,
	ki as VI,
	kj as d_,
	kk as N_,
	l as fp,
	la as CT,
	lb as Ks,
	lc as JT,
	ld as wC,
	le as GC,
	lf as k2,
	lg as rI,
	li as Aa,
	lj as Br,
	lk as Ec,
	m as iT,
	ma as IT,
	mb as Tl,
	mc as Ni,
	md as Op,
	me as WC,
	mf as L2,
	mg as oI,
	mi as $l,
	mj as De,
	mk as O_,
	n as aT,
	na as _T,
	nb as $T,
	nc as eC,
	nd as SC,
	ne as KC,
	nf as Zp,
	ng as sf,
	nh as wI,
	ni as V7,
	nj as m_,
	nk as F_,
	o as lT,
	oa as AT,
	ob as HT,
	oc as sv,
	od as cv,
	oe as YC,
	of as M2,
	og as nI,
	oh as SI,
	oi as pm,
	oj as gm,
	ok as B_,
	p as Dn,
	pa as kT,
	pb as Cl,
	pc as Oi,
	pd as dv,
	pe as VC,
	pf as P2,
	pg as Dl,
	ph as gf,
	pi as X7,
	pj as u_,
	pk as cE,
	q as gp,
	qa as wp,
	qb as Yt,
	qc as tC,
	qd as TC,
	qe as XC,
	qf as R2,
	qg as iI,
	qh as hf,
	qi as Z7,
	qj as p_,
	qk as yc,
	r as Pi,
	ra as ba,
	rb as V,
	rc as kl,
	rd as Uo,
	re as ZC,
	rf as D2,
	rg as aI,
	rh as zv,
	ri as q7,
	rj as Ul,
	rk as J7,
	s as sT,
	sa as LT,
	sb as Ot,
	sc as Ao,
	sd as CC,
	se as qC,
	sf as kv,
	sg as cf,
	sh as bf,
	si as j7,
	sj as jt,
	sk as dE,
	t as cT,
	ta as jx,
	tb as lo,
	tc as co,
	td as rm,
	te as jC,
	tf as qp,
	tg as lm,
	th as TI,
	ti as Af,
	tj as Nf,
	tk as mE,
	u as dT,
	ua as MT,
	ub as qd,
	uc as js,
	ud as om,
	ue as QC,
	uf as N2,
	ug as lI,
	uh as $v,
	ui as XI,
	uj as f_,
	uk as Ve,
	v as Gd,
	va as Sp,
	vb as ya,
	vc as rC,
	vd as nm,
	ve as JC,
	vf as O2,
	vg as sI,
	vh as Hi,
	vi as kf,
	vj as Of,
	vk as uE,
	w as Wd,
	wa as Qx,
	wb as _p,
	wc as oC,
	wd as Fp,
	we as _v,
	wf as F2,
	wg as cI,
	wh as CI,
	wi as Vv,
	wj as Ko,
	wk as wc,
	x as El,
	xa as sn,
	xb as av,
	xc as tm,
	xd as Ml,
	xe as e2,
	xf as B2,
	xg as dI,
	xh as xf,
	xi as ZI,
	xj as g_,
	xk as z_,
	y as hp,
	ya as Vd,
	yb as lv,
	yc as Sa,
	yd as nc,
	ye as t2,
	yf as z2,
	yg as sm,
	yh as II,
	yi as ka,
	yj as h_,
	yk as bt,
	z as mT,
	za as To,
	zb as Il,
	zc as Qs,
	zd as IC,
	ze as r2,
	zf as $2,
	zg as mI,
	zh as _I,
	zi as qI,
	zj as b_,
	zk as $_,
} from "./excalidraw-assets/chunk-XVQM53Z2.js";
import { a as b, b as _ } from "./excalidraw-assets/chunk-M2JW2GFW.js";
import { J as Gx } from "./excalidraw-assets/chunk-CNXMBO7K.js";
import { aa as tT } from "./excalidraw-assets/chunk-V55EI3XA.js";
import {
	b as JS,
	d as xl,
	e as eT,
	f as w,
} from "./excalidraw-assets/chunk-SXMPUQ6M.js";
var Gn = xl((mG, J_) => {
	b();
	J_.exports = ReactDOM;
});
var U3 = xl(($3, H3) => {
	b();
	(function () {
		var e = this,
			t = {};
		typeof $3 < "u" ? (H3.exports = t) : (e.fuzzy = t),
			(t.simpleFilter = function (r, o) {
				return o.filter(function (i) {
					return t.test(r, i);
				});
			}),
			(t.test = function (r, o) {
				return t.match(r, o) !== null;
			}),
			(t.match = function (r, o, i) {
				i = i || {};
				var a = 0,
					s = [],
					c = o.length,
					d = 0,
					u = 0,
					f = i.pre || "",
					m = i.post || "",
					g = (i.caseSensitive && o) || o.toLowerCase(),
					h;
				r = (i.caseSensitive && r) || r.toLowerCase();
				for (var y = 0; y < c; y++)
					(h = o[y]),
						g[y] === r[a] ? ((h = f + h + m), (a += 1), (u += 1 + u)) : (u = 0),
						(d += u),
						(s[s.length] = h);
				return a === r.length
					? ((d = g === r ? 1 / 0 : d), { rendered: s.join(""), score: d })
					: null;
			}),
			(t.filter = function (r, o, i) {
				return !o || o.length === 0
					? []
					: typeof r != "string"
						? o
						: ((i = i || {}),
							o
								.reduce(function (a, s, c, d) {
									var u = s;
									i.extract && (u = i.extract(s));
									var f = t.match(r, u, i);
									return (
										f != null &&
											(a[a.length] = {
												string: f.rendered,
												score: f.score,
												index: c,
												original: s,
											}),
										a
									);
								}, [])
								.sort(function (a, s) {
									var c = s.score - a.score;
									return c || a.index - s.index;
								}));
			});
	})();
});
var V3 = xl((Y3) => {
	"use strict";
	b();
	var dd = Q();
	function vz(e, t) {
		return (e === t && (e !== 0 || 1 / e === 1 / t)) || (e !== e && t !== t);
	}
	var Ez = typeof Object.is == "function" ? Object.is : vz,
		yz = dd.useState,
		wz = dd.useEffect,
		Sz = dd.useLayoutEffect,
		Tz = dd.useDebugValue;
	function Cz(e, t) {
		var r = t(),
			o = yz({ inst: { value: r, getSnapshot: t } }),
			i = o[0].inst,
			a = o[1];
		return (
			Sz(
				function () {
					(i.value = r), (i.getSnapshot = t), Qy(i) && a({ inst: i });
				},
				[e, r, t],
			),
			wz(
				function () {
					return (
						Qy(i) && a({ inst: i }),
						e(function () {
							Qy(i) && a({ inst: i });
						})
					);
				},
				[e],
			),
			Tz(r),
			r
		);
	}
	function Qy(e) {
		var t = e.getSnapshot;
		e = e.value;
		try {
			var r = t();
			return !Ez(e, r);
		} catch {
			return !0;
		}
	}
	function Iz(e, t) {
		return t();
	}
	var _z =
		typeof window > "u" ||
		typeof window.document > "u" ||
		typeof window.document.createElement > "u"
			? Iz
			: Cz;
	Y3.useSyncExternalStore =
		dd.useSyncExternalStore !== void 0 ? dd.useSyncExternalStore : _z;
});
var Z3 = xl((Zce, X3) => {
	"use strict";
	b();
	X3.exports = V3();
});
var j3 = xl((q3) => {
	"use strict";
	b();
	var bh = Q(),
		Az = Z3();
	function kz(e, t) {
		return (e === t && (e !== 0 || 1 / e === 1 / t)) || (e !== e && t !== t);
	}
	var Lz = typeof Object.is == "function" ? Object.is : kz,
		Mz = Az.useSyncExternalStore,
		Pz = bh.useRef,
		Rz = bh.useEffect,
		Dz = bh.useMemo,
		Nz = bh.useDebugValue;
	q3.useSyncExternalStoreWithSelector = function (e, t, r, o, i) {
		var a = Pz(null);
		if (a.current === null) {
			var s = { hasValue: !1, value: null };
			a.current = s;
		} else s = a.current;
		a = Dz(
			function () {
				function d(h) {
					if (!u) {
						if (((u = !0), (f = h), (h = o(h)), i !== void 0 && s.hasValue)) {
							var y = s.value;
							if (i(y, h)) return (m = y);
						}
						return (m = h);
					}
					if (((y = m), Lz(f, h))) return y;
					var E = o(h);
					return i !== void 0 && i(y, E) ? y : ((f = h), (m = E));
				}
				var u = !1,
					f,
					m,
					g = r === void 0 ? null : r;
				return [
					function () {
						return d(t());
					},
					g === null
						? void 0
						: function () {
								return d(g());
							},
				];
			},
			[t, r, o, i],
		);
		var c = Mz(e, a[0], a[1]);
		return (
			Rz(
				function () {
					(s.hasValue = !0), (s.value = c);
				},
				[c],
			),
			Nz(c),
			c
		);
	};
});
var J3 = xl((Jce, Q3) => {
	"use strict";
	b();
	Q3.exports = j3();
});
var B0 = xl((fd, au) => {
	b();
	(function () {
		var e,
			t = "4.17.21",
			r = 200,
			o = "Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",
			i = "Expected a function",
			a = "Invalid `variable` option passed into `_.template`",
			s = "__lodash_hash_undefined__",
			c = 500,
			d = "__lodash_placeholder__",
			u = 1,
			f = 2,
			m = 4,
			g = 1,
			h = 2,
			y = 1,
			E = 2,
			T = 4,
			I = 8,
			P = 16,
			C = 32,
			k = 64,
			N = 128,
			D = 256,
			B = 512,
			F = 30,
			W = "...",
			G = 800,
			q = 16,
			ie = 1,
			te = 2,
			we = 3,
			X = 1 / 0,
			se = 9007199254740991,
			Pe = 17976931348623157e292,
			ke = NaN,
			fe = 4294967295,
			Y = fe - 1,
			K = fe >>> 1,
			ee = [
				["ary", N],
				["bind", y],
				["bindKey", E],
				["curry", I],
				["curryRight", P],
				["flip", B],
				["partial", C],
				["partialRight", k],
				["rearg", D],
			],
			le = "[object Arguments]",
			ce = "[object Array]",
			ue = "[object AsyncFunction]",
			ge = "[object Boolean]",
			Se = "[object Date]",
			Dt = "[object DOMException]",
			St = "[object Error]",
			_t = "[object Function]",
			Tt = "[object GeneratorFunction]",
			cr = "[object Map]",
			Do = "[object Number]",
			ia = "[object Null]",
			Or = "[object Object]",
			No = "[object Promise]",
			Eb = "[object Proxy]",
			al = "[object RegExp]",
			Cr = "[object Set]",
			kn = "[object String]",
			ll = "[object Symbol]",
			aa = "[object Undefined]",
			sl = "[object WeakMap]",
			yb = "[object WeakSet]",
			_d = "[object ArrayBuffer]",
			Ts = "[object DataView]",
			wb = "[object Float32Array]",
			Sb = "[object Float64Array]",
			Tb = "[object Int8Array]",
			Cb = "[object Int16Array]",
			Ib = "[object Int32Array]",
			_b = "[object Uint8Array]",
			Ab = "[object Uint8ClampedArray]",
			kb = "[object Uint16Array]",
			Lb = "[object Uint32Array]",
			pR = /\b__p \+= '';/g,
			fR = /\b(__p \+=) '' \+/g,
			gR = /(__e\(.*?\)|\b__t\)) \+\n'';/g,
			Tw = /&(?:amp|lt|gt|quot|#39);/g,
			Cw = /[&<>"']/g,
			hR = RegExp(Tw.source),
			bR = RegExp(Cw.source),
			xR = /<%-([\s\S]+?)%>/g,
			vR = /<%([\s\S]+?)%>/g,
			Iw = /<%=([\s\S]+?)%>/g,
			ER = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,
			yR = /^\w*$/,
			wR =
				/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,
			Mb = /[\\^$.*+?()[\]{}|]/g,
			SR = RegExp(Mb.source),
			Pb = /^\s+/,
			TR = /\s/,
			CR = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,
			IR = /\{\n\/\* \[wrapped with (.+)\] \*/,
			_R = /,? & /,
			AR = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,
			kR = /[()=,{}\[\]\/\s]/,
			LR = /\\(\\)?/g,
			MR = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,
			_w = /\w*$/,
			PR = /^[-+]0x[0-9a-f]+$/i,
			RR = /^0b[01]+$/i,
			DR = /^\[object .+?Constructor\]$/,
			NR = /^0o[0-7]+$/i,
			OR = /^(?:0|[1-9]\d*)$/,
			FR = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,
			Tu = /($^)/,
			BR = /['\n\r\u2028\u2029\\]/g,
			Cu = "\\ud800-\\udfff",
			zR = "\\u0300-\\u036f",
			$R = "\\ufe20-\\ufe2f",
			HR = "\\u20d0-\\u20ff",
			Aw = zR + $R + HR,
			kw = "\\u2700-\\u27bf",
			Lw = "a-z\\xdf-\\xf6\\xf8-\\xff",
			UR = "\\xac\\xb1\\xd7\\xf7",
			GR = "\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",
			WR = "\\u2000-\\u206f",
			KR =
				" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",
			Mw = "A-Z\\xc0-\\xd6\\xd8-\\xde",
			Pw = "\\ufe0e\\ufe0f",
			Rw = UR + GR + WR + KR,
			Rb = "['\u2019]",
			YR = "[" + Cu + "]",
			Dw = "[" + Rw + "]",
			Iu = "[" + Aw + "]",
			Nw = "\\d+",
			VR = "[" + kw + "]",
			Ow = "[" + Lw + "]",
			Fw = "[^" + Cu + Rw + Nw + kw + Lw + Mw + "]",
			Db = "\\ud83c[\\udffb-\\udfff]",
			XR = "(?:" + Iu + "|" + Db + ")",
			Bw = "[^" + Cu + "]",
			Nb = "(?:\\ud83c[\\udde6-\\uddff]){2}",
			Ob = "[\\ud800-\\udbff][\\udc00-\\udfff]",
			Cs = "[" + Mw + "]",
			zw = "\\u200d",
			$w = "(?:" + Ow + "|" + Fw + ")",
			ZR = "(?:" + Cs + "|" + Fw + ")",
			Hw = "(?:" + Rb + "(?:d|ll|m|re|s|t|ve))?",
			Uw = "(?:" + Rb + "(?:D|LL|M|RE|S|T|VE))?",
			Gw = XR + "?",
			Ww = "[" + Pw + "]?",
			qR = "(?:" + zw + "(?:" + [Bw, Nb, Ob].join("|") + ")" + Ww + Gw + ")*",
			jR = "\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",
			QR = "\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",
			Kw = Ww + Gw + qR,
			JR = "(?:" + [VR, Nb, Ob].join("|") + ")" + Kw,
			eD = "(?:" + [Bw + Iu + "?", Iu, Nb, Ob, YR].join("|") + ")",
			tD = RegExp(Rb, "g"),
			rD = RegExp(Iu, "g"),
			Fb = RegExp(Db + "(?=" + Db + ")|" + eD + Kw, "g"),
			oD = RegExp(
				[
					Cs + "?" + Ow + "+" + Hw + "(?=" + [Dw, Cs, "$"].join("|") + ")",
					ZR + "+" + Uw + "(?=" + [Dw, Cs + $w, "$"].join("|") + ")",
					Cs + "?" + $w + "+" + Hw,
					Cs + "+" + Uw,
					QR,
					jR,
					Nw,
					JR,
				].join("|"),
				"g",
			),
			nD = RegExp("[" + zw + Cu + Aw + Pw + "]"),
			iD = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,
			aD = [
				"Array",
				"Buffer",
				"DataView",
				"Date",
				"Error",
				"Float32Array",
				"Float64Array",
				"Function",
				"Int8Array",
				"Int16Array",
				"Int32Array",
				"Map",
				"Math",
				"Object",
				"Promise",
				"RegExp",
				"Set",
				"String",
				"Symbol",
				"TypeError",
				"Uint8Array",
				"Uint8ClampedArray",
				"Uint16Array",
				"Uint32Array",
				"WeakMap",
				"_",
				"clearTimeout",
				"isFinite",
				"parseInt",
				"setTimeout",
			],
			lD = -1,
			Nt = {};
		(Nt[wb] =
			Nt[Sb] =
			Nt[Tb] =
			Nt[Cb] =
			Nt[Ib] =
			Nt[_b] =
			Nt[Ab] =
			Nt[kb] =
			Nt[Lb] =
				!0),
			(Nt[le] =
				Nt[ce] =
				Nt[_d] =
				Nt[ge] =
				Nt[Ts] =
				Nt[Se] =
				Nt[St] =
				Nt[_t] =
				Nt[cr] =
				Nt[Do] =
				Nt[Or] =
				Nt[al] =
				Nt[Cr] =
				Nt[kn] =
				Nt[sl] =
					!1);
		var At = {};
		(At[le] =
			At[ce] =
			At[_d] =
			At[Ts] =
			At[ge] =
			At[Se] =
			At[wb] =
			At[Sb] =
			At[Tb] =
			At[Cb] =
			At[Ib] =
			At[cr] =
			At[Do] =
			At[Or] =
			At[al] =
			At[Cr] =
			At[kn] =
			At[ll] =
			At[_b] =
			At[Ab] =
			At[kb] =
			At[Lb] =
				!0),
			(At[St] = At[_t] = At[sl] = !1);
		var sD = {
				\u00C0: "A",
				\u00C1: "A",
				\u00C2: "A",
				\u00C3: "A",
				\u00C4: "A",
				\u00C5: "A",
				\u00E0: "a",
				\u00E1: "a",
				\u00E2: "a",
				\u00E3: "a",
				\u00E4: "a",
				\u00E5: "a",
				\u00C7: "C",
				\u00E7: "c",
				\u00D0: "D",
				\u00F0: "d",
				\u00C8: "E",
				\u00C9: "E",
				\u00CA: "E",
				\u00CB: "E",
				\u00E8: "e",
				\u00E9: "e",
				\u00EA: "e",
				\u00EB: "e",
				\u00CC: "I",
				\u00CD: "I",
				\u00CE: "I",
				\u00CF: "I",
				\u00EC: "i",
				\u00ED: "i",
				\u00EE: "i",
				\u00EF: "i",
				\u00D1: "N",
				\u00F1: "n",
				\u00D2: "O",
				\u00D3: "O",
				\u00D4: "O",
				\u00D5: "O",
				\u00D6: "O",
				\u00D8: "O",
				\u00F2: "o",
				\u00F3: "o",
				\u00F4: "o",
				\u00F5: "o",
				\u00F6: "o",
				\u00F8: "o",
				\u00D9: "U",
				\u00DA: "U",
				\u00DB: "U",
				\u00DC: "U",
				\u00F9: "u",
				\u00FA: "u",
				\u00FB: "u",
				\u00FC: "u",
				\u00DD: "Y",
				\u00FD: "y",
				\u00FF: "y",
				\u00C6: "Ae",
				\u00E6: "ae",
				\u00DE: "Th",
				\u00FE: "th",
				\u00DF: "ss",
				\u0100: "A",
				\u0102: "A",
				\u0104: "A",
				\u0101: "a",
				\u0103: "a",
				\u0105: "a",
				\u0106: "C",
				\u0108: "C",
				\u010A: "C",
				\u010C: "C",
				\u0107: "c",
				\u0109: "c",
				\u010B: "c",
				\u010D: "c",
				\u010E: "D",
				\u0110: "D",
				\u010F: "d",
				\u0111: "d",
				\u0112: "E",
				\u0114: "E",
				\u0116: "E",
				\u0118: "E",
				\u011A: "E",
				\u0113: "e",
				\u0115: "e",
				\u0117: "e",
				\u0119: "e",
				\u011B: "e",
				\u011C: "G",
				\u011E: "G",
				\u0120: "G",
				\u0122: "G",
				\u011D: "g",
				\u011F: "g",
				\u0121: "g",
				\u0123: "g",
				\u0124: "H",
				\u0126: "H",
				\u0125: "h",
				\u0127: "h",
				\u0128: "I",
				\u012A: "I",
				\u012C: "I",
				\u012E: "I",
				\u0130: "I",
				\u0129: "i",
				\u012B: "i",
				\u012D: "i",
				\u012F: "i",
				\u0131: "i",
				\u0134: "J",
				\u0135: "j",
				\u0136: "K",
				\u0137: "k",
				\u0138: "k",
				\u0139: "L",
				\u013B: "L",
				\u013D: "L",
				\u013F: "L",
				\u0141: "L",
				\u013A: "l",
				\u013C: "l",
				\u013E: "l",
				\u0140: "l",
				\u0142: "l",
				\u0143: "N",
				\u0145: "N",
				\u0147: "N",
				\u014A: "N",
				\u0144: "n",
				\u0146: "n",
				\u0148: "n",
				\u014B: "n",
				\u014C: "O",
				\u014E: "O",
				\u0150: "O",
				\u014D: "o",
				\u014F: "o",
				\u0151: "o",
				\u0154: "R",
				\u0156: "R",
				\u0158: "R",
				\u0155: "r",
				\u0157: "r",
				\u0159: "r",
				\u015A: "S",
				\u015C: "S",
				\u015E: "S",
				\u0160: "S",
				\u015B: "s",
				\u015D: "s",
				\u015F: "s",
				\u0161: "s",
				\u0162: "T",
				\u0164: "T",
				\u0166: "T",
				\u0163: "t",
				\u0165: "t",
				\u0167: "t",
				\u0168: "U",
				\u016A: "U",
				\u016C: "U",
				\u016E: "U",
				\u0170: "U",
				\u0172: "U",
				\u0169: "u",
				\u016B: "u",
				\u016D: "u",
				\u016F: "u",
				\u0171: "u",
				\u0173: "u",
				\u0174: "W",
				\u0175: "w",
				\u0176: "Y",
				\u0177: "y",
				\u0178: "Y",
				\u0179: "Z",
				\u017B: "Z",
				\u017D: "Z",
				\u017A: "z",
				\u017C: "z",
				\u017E: "z",
				\u0132: "IJ",
				\u0133: "ij",
				\u0152: "Oe",
				\u0153: "oe",
				\u0149: "'n",
				\u017F: "s",
			},
			cD = {
				"&": "&amp;",
				"<": "&lt;",
				">": "&gt;",
				'"': "&quot;",
				"'": "&#39;",
			},
			dD = {
				"&amp;": "&",
				"&lt;": "<",
				"&gt;": ">",
				"&quot;": '"',
				"&#39;": "'",
			},
			mD = {
				"\\": "\\",
				"'": "'",
				"\n": "n",
				"\r": "r",
				"\u2028": "u2028",
				"\u2029": "u2029",
			},
			uD = parseFloat,
			pD = parseInt,
			Yw =
				typeof global == "object" &&
				global &&
				global.Object === Object &&
				global,
			fD = typeof self == "object" && self && self.Object === Object && self,
			Ir = Yw || fD || Function("return this")(),
			Bb = typeof fd == "object" && fd && !fd.nodeType && fd,
			cl = Bb && typeof au == "object" && au && !au.nodeType && au,
			Vw = cl && cl.exports === Bb,
			zb = Vw && Yw.process,
			Jo = (function () {
				try {
					var $ = cl && cl.require && cl.require("util").types;
					return $ || (zb && zb.binding && zb.binding("util"));
				} catch {}
			})(),
			Xw = Jo && Jo.isArrayBuffer,
			Zw = Jo && Jo.isDate,
			qw = Jo && Jo.isMap,
			jw = Jo && Jo.isRegExp,
			Qw = Jo && Jo.isSet,
			Jw = Jo && Jo.isTypedArray;
		function Oo($, J, Z) {
			switch (Z.length) {
				case 0:
					return $.call(J);
				case 1:
					return $.call(J, Z[0]);
				case 2:
					return $.call(J, Z[0], Z[1]);
				case 3:
					return $.call(J, Z[0], Z[1], Z[2]);
			}
			return $.apply(J, Z);
		}
		function gD($, J, Z, ye) {
			for (var ze = -1, ut = $ == null ? 0 : $.length; ++ze < ut; ) {
				var br = $[ze];
				J(ye, br, Z(br), $);
			}
			return ye;
		}
		function en($, J) {
			for (
				var Z = -1, ye = $ == null ? 0 : $.length;
				++Z < ye && J($[Z], Z, $) !== !1;
			);
			return $;
		}
		function hD($, J) {
			for (var Z = $ == null ? 0 : $.length; Z-- && J($[Z], Z, $) !== !1; );
			return $;
		}
		function e1($, J) {
			for (var Z = -1, ye = $ == null ? 0 : $.length; ++Z < ye; )
				if (!J($[Z], Z, $)) return !1;
			return !0;
		}
		function la($, J) {
			for (
				var Z = -1, ye = $ == null ? 0 : $.length, ze = 0, ut = [];
				++Z < ye;
			) {
				var br = $[Z];
				J(br, Z, $) && (ut[ze++] = br);
			}
			return ut;
		}
		function _u($, J) {
			var Z = $ == null ? 0 : $.length;
			return !!Z && Is($, J, 0) > -1;
		}
		function $b($, J, Z) {
			for (var ye = -1, ze = $ == null ? 0 : $.length; ++ye < ze; )
				if (Z(J, $[ye])) return !0;
			return !1;
		}
		function Gt($, J) {
			for (
				var Z = -1, ye = $ == null ? 0 : $.length, ze = Array(ye);
				++Z < ye;
			)
				ze[Z] = J($[Z], Z, $);
			return ze;
		}
		function sa($, J) {
			for (var Z = -1, ye = J.length, ze = $.length; ++Z < ye; )
				$[ze + Z] = J[Z];
			return $;
		}
		function Hb($, J, Z, ye) {
			var ze = -1,
				ut = $ == null ? 0 : $.length;
			for (ye && ut && (Z = $[++ze]); ++ze < ut; ) Z = J(Z, $[ze], ze, $);
			return Z;
		}
		function bD($, J, Z, ye) {
			var ze = $ == null ? 0 : $.length;
			for (ye && ze && (Z = $[--ze]); ze--; ) Z = J(Z, $[ze], ze, $);
			return Z;
		}
		function Ub($, J) {
			for (var Z = -1, ye = $ == null ? 0 : $.length; ++Z < ye; )
				if (J($[Z], Z, $)) return !0;
			return !1;
		}
		var xD = Gb("length");
		function vD($) {
			return $.split("");
		}
		function ED($) {
			return $.match(AR) || [];
		}
		function t1($, J, Z) {
			var ye;
			return (
				Z($, function (ze, ut, br) {
					if (J(ze, ut, br)) return (ye = ut), !1;
				}),
				ye
			);
		}
		function Au($, J, Z, ye) {
			for (var ze = $.length, ut = Z + (ye ? 1 : -1); ye ? ut-- : ++ut < ze; )
				if (J($[ut], ut, $)) return ut;
			return -1;
		}
		function Is($, J, Z) {
			return J === J ? PD($, J, Z) : Au($, r1, Z);
		}
		function yD($, J, Z, ye) {
			for (var ze = Z - 1, ut = $.length; ++ze < ut; )
				if (ye($[ze], J)) return ze;
			return -1;
		}
		function r1($) {
			return $ !== $;
		}
		function o1($, J) {
			var Z = $ == null ? 0 : $.length;
			return Z ? Kb($, J) / Z : ke;
		}
		function Gb($) {
			return function (J) {
				return J == null ? e : J[$];
			};
		}
		function Wb($) {
			return function (J) {
				return $ == null ? e : $[J];
			};
		}
		function n1($, J, Z, ye, ze) {
			return (
				ze($, function (ut, br, Ct) {
					Z = ye ? ((ye = !1), ut) : J(Z, ut, br, Ct);
				}),
				Z
			);
		}
		function wD($, J) {
			var Z = $.length;
			for ($.sort(J); Z--; ) $[Z] = $[Z].value;
			return $;
		}
		function Kb($, J) {
			for (var Z, ye = -1, ze = $.length; ++ye < ze; ) {
				var ut = J($[ye]);
				ut !== e && (Z = Z === e ? ut : Z + ut);
			}
			return Z;
		}
		function Yb($, J) {
			for (var Z = -1, ye = Array($); ++Z < $; ) ye[Z] = J(Z);
			return ye;
		}
		function SD($, J) {
			return Gt(J, function (Z) {
				return [Z, $[Z]];
			});
		}
		function i1($) {
			return $ && $.slice(0, c1($) + 1).replace(Pb, "");
		}
		function Fo($) {
			return function (J) {
				return $(J);
			};
		}
		function Vb($, J) {
			return Gt(J, function (Z) {
				return $[Z];
			});
		}
		function Ad($, J) {
			return $.has(J);
		}
		function a1($, J) {
			for (var Z = -1, ye = $.length; ++Z < ye && Is(J, $[Z], 0) > -1; );
			return Z;
		}
		function l1($, J) {
			for (var Z = $.length; Z-- && Is(J, $[Z], 0) > -1; );
			return Z;
		}
		function TD($, J) {
			for (var Z = $.length, ye = 0; Z--; ) $[Z] === J && ++ye;
			return ye;
		}
		var CD = Wb(sD),
			ID = Wb(cD);
		function _D($) {
			return "\\" + mD[$];
		}
		function AD($, J) {
			return $ == null ? e : $[J];
		}
		function _s($) {
			return nD.test($);
		}
		function kD($) {
			return iD.test($);
		}
		function LD($) {
			for (var J, Z = []; !(J = $.next()).done; ) Z.push(J.value);
			return Z;
		}
		function Xb($) {
			var J = -1,
				Z = Array($.size);
			return (
				$.forEach(function (ye, ze) {
					Z[++J] = [ze, ye];
				}),
				Z
			);
		}
		function s1($, J) {
			return function (Z) {
				return $(J(Z));
			};
		}
		function ca($, J) {
			for (var Z = -1, ye = $.length, ze = 0, ut = []; ++Z < ye; ) {
				var br = $[Z];
				(br === J || br === d) && (($[Z] = d), (ut[ze++] = Z));
			}
			return ut;
		}
		function ku($) {
			var J = -1,
				Z = Array($.size);
			return (
				$.forEach(function (ye) {
					Z[++J] = ye;
				}),
				Z
			);
		}
		function MD($) {
			var J = -1,
				Z = Array($.size);
			return (
				$.forEach(function (ye) {
					Z[++J] = [ye, ye];
				}),
				Z
			);
		}
		function PD($, J, Z) {
			for (var ye = Z - 1, ze = $.length; ++ye < ze; )
				if ($[ye] === J) return ye;
			return -1;
		}
		function RD($, J, Z) {
			for (var ye = Z + 1; ye--; ) if ($[ye] === J) return ye;
			return ye;
		}
		function As($) {
			return _s($) ? ND($) : xD($);
		}
		function Ln($) {
			return _s($) ? OD($) : vD($);
		}
		function c1($) {
			for (var J = $.length; J-- && TR.test($.charAt(J)); );
			return J;
		}
		var DD = Wb(dD);
		function ND($) {
			for (var J = (Fb.lastIndex = 0); Fb.test($); ) ++J;
			return J;
		}
		function OD($) {
			return $.match(Fb) || [];
		}
		function FD($) {
			return $.match(oD) || [];
		}
		var BD = function $(J) {
				J = J == null ? Ir : da.defaults(Ir.Object(), J, da.pick(Ir, aD));
				var Z = J.Array,
					ye = J.Date,
					ze = J.Error,
					ut = J.Function,
					br = J.Math,
					Ct = J.Object,
					Zb = J.RegExp,
					zD = J.String,
					tn = J.TypeError,
					Lu = Z.prototype,
					$D = ut.prototype,
					ks = Ct.prototype,
					Mu = J["__core-js_shared__"],
					Pu = $D.toString,
					vt = ks.hasOwnProperty,
					HD = 0,
					d1 = (function () {
						var n = /[^.]+$/.exec((Mu && Mu.keys && Mu.keys.IE_PROTO) || "");
						return n ? "Symbol(src)_1." + n : "";
					})(),
					Ru = ks.toString,
					UD = Pu.call(Ct),
					GD = Ir._,
					WD = Zb(
						"^" +
							Pu.call(vt)
								.replace(Mb, "\\$&")
								.replace(
									/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,
									"$1.*?",
								) +
							"$",
					),
					Du = Vw ? J.Buffer : e,
					ma = J.Symbol,
					Nu = J.Uint8Array,
					m1 = Du ? Du.allocUnsafe : e,
					Ou = s1(Ct.getPrototypeOf, Ct),
					u1 = Ct.create,
					p1 = ks.propertyIsEnumerable,
					Fu = Lu.splice,
					f1 = ma ? ma.isConcatSpreadable : e,
					kd = ma ? ma.iterator : e,
					dl = ma ? ma.toStringTag : e,
					Bu = (function () {
						try {
							var n = gl(Ct, "defineProperty");
							return n({}, "", {}), n;
						} catch {}
					})(),
					KD = J.clearTimeout !== Ir.clearTimeout && J.clearTimeout,
					YD = ye && ye.now !== Ir.Date.now && ye.now,
					VD = J.setTimeout !== Ir.setTimeout && J.setTimeout,
					zu = br.ceil,
					$u = br.floor,
					qb = Ct.getOwnPropertySymbols,
					XD = Du ? Du.isBuffer : e,
					g1 = J.isFinite,
					ZD = Lu.join,
					qD = s1(Ct.keys, Ct),
					xr = br.max,
					Wr = br.min,
					jD = ye.now,
					QD = J.parseInt,
					h1 = br.random,
					JD = Lu.reverse,
					jb = gl(J, "DataView"),
					Ld = gl(J, "Map"),
					Qb = gl(J, "Promise"),
					Ls = gl(J, "Set"),
					Md = gl(J, "WeakMap"),
					Pd = gl(Ct, "create"),
					Hu = Md && new Md(),
					Ms = {},
					e6 = hl(jb),
					t6 = hl(Ld),
					r6 = hl(Qb),
					o6 = hl(Ls),
					n6 = hl(Md),
					Uu = ma ? ma.prototype : e,
					Rd = Uu ? Uu.valueOf : e,
					b1 = Uu ? Uu.toString : e;
				function A(n) {
					if (qt(n) && !He(n) && !(n instanceof rt)) {
						if (n instanceof rn) return n;
						if (vt.call(n, "__wrapped__")) return xS(n);
					}
					return new rn(n);
				}
				var Ps = (function () {
					function n() {}
					return function (l) {
						if (!Kt(l)) return {};
						if (u1) return u1(l);
						n.prototype = l;
						var p = new n();
						return (n.prototype = e), p;
					};
				})();
				function Gu() {}
				function rn(n, l) {
					(this.__wrapped__ = n),
						(this.__actions__ = []),
						(this.__chain__ = !!l),
						(this.__index__ = 0),
						(this.__values__ = e);
				}
				(A.templateSettings = {
					escape: xR,
					evaluate: vR,
					interpolate: Iw,
					variable: "",
					imports: { _: A },
				}),
					(A.prototype = Gu.prototype),
					(A.prototype.constructor = A),
					(rn.prototype = Ps(Gu.prototype)),
					(rn.prototype.constructor = rn);
				function rt(n) {
					(this.__wrapped__ = n),
						(this.__actions__ = []),
						(this.__dir__ = 1),
						(this.__filtered__ = !1),
						(this.__iteratees__ = []),
						(this.__takeCount__ = fe),
						(this.__views__ = []);
				}
				function i6() {
					var n = new rt(this.__wrapped__);
					return (
						(n.__actions__ = Eo(this.__actions__)),
						(n.__dir__ = this.__dir__),
						(n.__filtered__ = this.__filtered__),
						(n.__iteratees__ = Eo(this.__iteratees__)),
						(n.__takeCount__ = this.__takeCount__),
						(n.__views__ = Eo(this.__views__)),
						n
					);
				}
				function a6() {
					if (this.__filtered__) {
						var n = new rt(this);
						(n.__dir__ = -1), (n.__filtered__ = !0);
					} else (n = this.clone()), (n.__dir__ *= -1);
					return n;
				}
				function l6() {
					var n = this.__wrapped__.value(),
						l = this.__dir__,
						p = He(n),
						x = l < 0,
						S = p ? n.length : 0,
						L = v4(0, S, this.__views__),
						O = L.start,
						z = L.end,
						U = z - O,
						oe = x ? z : O - 1,
						ne = this.__iteratees__,
						de = ne.length,
						be = 0,
						Ce = Wr(U, this.__takeCount__);
					if (!p || (!x && S == U && Ce == U)) return H1(n, this.__actions__);
					var Ne = [];
					e: for (; U-- && be < Ce; ) {
						oe += l;
						for (var Ke = -1, Oe = n[oe]; ++Ke < de; ) {
							var Je = ne[Ke],
								it = Je.iteratee,
								$o = Je.type,
								io = it(Oe);
							if ($o == te) Oe = io;
							else if (!io) {
								if ($o == ie) continue e;
								break e;
							}
						}
						Ne[be++] = Oe;
					}
					return Ne;
				}
				(rt.prototype = Ps(Gu.prototype)), (rt.prototype.constructor = rt);
				function ml(n) {
					var l = -1,
						p = n == null ? 0 : n.length;
					for (this.clear(); ++l < p; ) {
						var x = n[l];
						this.set(x[0], x[1]);
					}
				}
				function s6() {
					(this.__data__ = Pd ? Pd(null) : {}), (this.size = 0);
				}
				function c6(n) {
					var l = this.has(n) && delete this.__data__[n];
					return (this.size -= l ? 1 : 0), l;
				}
				function d6(n) {
					var l = this.__data__;
					if (Pd) {
						var p = l[n];
						return p === s ? e : p;
					}
					return vt.call(l, n) ? l[n] : e;
				}
				function m6(n) {
					var l = this.__data__;
					return Pd ? l[n] !== e : vt.call(l, n);
				}
				function u6(n, l) {
					var p = this.__data__;
					return (
						(this.size += this.has(n) ? 0 : 1),
						(p[n] = Pd && l === e ? s : l),
						this
					);
				}
				(ml.prototype.clear = s6),
					(ml.prototype.delete = c6),
					(ml.prototype.get = d6),
					(ml.prototype.has = m6),
					(ml.prototype.set = u6);
				function wi(n) {
					var l = -1,
						p = n == null ? 0 : n.length;
					for (this.clear(); ++l < p; ) {
						var x = n[l];
						this.set(x[0], x[1]);
					}
				}
				function p6() {
					(this.__data__ = []), (this.size = 0);
				}
				function f6(n) {
					var l = this.__data__,
						p = Wu(l, n);
					if (p < 0) return !1;
					var x = l.length - 1;
					return p == x ? l.pop() : Fu.call(l, p, 1), --this.size, !0;
				}
				function g6(n) {
					var l = this.__data__,
						p = Wu(l, n);
					return p < 0 ? e : l[p][1];
				}
				function h6(n) {
					return Wu(this.__data__, n) > -1;
				}
				function b6(n, l) {
					var p = this.__data__,
						x = Wu(p, n);
					return x < 0 ? (++this.size, p.push([n, l])) : (p[x][1] = l), this;
				}
				(wi.prototype.clear = p6),
					(wi.prototype.delete = f6),
					(wi.prototype.get = g6),
					(wi.prototype.has = h6),
					(wi.prototype.set = b6);
				function Si(n) {
					var l = -1,
						p = n == null ? 0 : n.length;
					for (this.clear(); ++l < p; ) {
						var x = n[l];
						this.set(x[0], x[1]);
					}
				}
				function x6() {
					(this.size = 0),
						(this.__data__ = {
							hash: new ml(),
							map: new (Ld || wi)(),
							string: new ml(),
						});
				}
				function v6(n) {
					var l = rp(this, n).delete(n);
					return (this.size -= l ? 1 : 0), l;
				}
				function E6(n) {
					return rp(this, n).get(n);
				}
				function y6(n) {
					return rp(this, n).has(n);
				}
				function w6(n, l) {
					var p = rp(this, n),
						x = p.size;
					return p.set(n, l), (this.size += p.size == x ? 0 : 1), this;
				}
				(Si.prototype.clear = x6),
					(Si.prototype.delete = v6),
					(Si.prototype.get = E6),
					(Si.prototype.has = y6),
					(Si.prototype.set = w6);
				function ul(n) {
					var l = -1,
						p = n == null ? 0 : n.length;
					for (this.__data__ = new Si(); ++l < p; ) this.add(n[l]);
				}
				function S6(n) {
					return this.__data__.set(n, s), this;
				}
				function T6(n) {
					return this.__data__.has(n);
				}
				(ul.prototype.add = ul.prototype.push = S6), (ul.prototype.has = T6);
				function Mn(n) {
					var l = (this.__data__ = new wi(n));
					this.size = l.size;
				}
				function C6() {
					(this.__data__ = new wi()), (this.size = 0);
				}
				function I6(n) {
					var l = this.__data__,
						p = l.delete(n);
					return (this.size = l.size), p;
				}
				function _6(n) {
					return this.__data__.get(n);
				}
				function A6(n) {
					return this.__data__.has(n);
				}
				function k6(n, l) {
					var p = this.__data__;
					if (p instanceof wi) {
						var x = p.__data__;
						if (!Ld || x.length < r - 1)
							return x.push([n, l]), (this.size = ++p.size), this;
						p = this.__data__ = new Si(x);
					}
					return p.set(n, l), (this.size = p.size), this;
				}
				(Mn.prototype.clear = C6),
					(Mn.prototype.delete = I6),
					(Mn.prototype.get = _6),
					(Mn.prototype.has = A6),
					(Mn.prototype.set = k6);
				function x1(n, l) {
					var p = He(n),
						x = !p && bl(n),
						S = !p && !x && ha(n),
						L = !p && !x && !S && Os(n),
						O = p || x || S || L,
						z = O ? Yb(n.length, zD) : [],
						U = z.length;
					for (var oe in n)
						(l || vt.call(n, oe)) &&
							!(
								O &&
								(oe == "length" ||
									(S && (oe == "offset" || oe == "parent")) ||
									(L &&
										(oe == "buffer" ||
											oe == "byteLength" ||
											oe == "byteOffset")) ||
									_i(oe, U))
							) &&
							z.push(oe);
					return z;
				}
				function v1(n) {
					var l = n.length;
					return l ? n[cx(0, l - 1)] : e;
				}
				function L6(n, l) {
					return op(Eo(n), pl(l, 0, n.length));
				}
				function M6(n) {
					return op(Eo(n));
				}
				function Jb(n, l, p) {
					((p !== e && !Pn(n[l], p)) || (p === e && !(l in n))) && Ti(n, l, p);
				}
				function Dd(n, l, p) {
					var x = n[l];
					(!(vt.call(n, l) && Pn(x, p)) || (p === e && !(l in n))) &&
						Ti(n, l, p);
				}
				function Wu(n, l) {
					for (var p = n.length; p--; ) if (Pn(n[p][0], l)) return p;
					return -1;
				}
				function P6(n, l, p, x) {
					return (
						ua(n, function (S, L, O) {
							l(x, S, p(S), O);
						}),
						x
					);
				}
				function E1(n, l) {
					return n && ri(l, _r(l), n);
				}
				function R6(n, l) {
					return n && ri(l, wo(l), n);
				}
				function Ti(n, l, p) {
					l == "__proto__" && Bu
						? Bu(n, l, {
								configurable: !0,
								enumerable: !0,
								value: p,
								writable: !0,
							})
						: (n[l] = p);
				}
				function ex(n, l) {
					for (var p = -1, x = l.length, S = Z(x), L = n == null; ++p < x; )
						S[p] = L ? e : Dx(n, l[p]);
					return S;
				}
				function pl(n, l, p) {
					return (
						n === n &&
							(p !== e && (n = n <= p ? n : p),
							l !== e && (n = n >= l ? n : l)),
						n
					);
				}
				function on(n, l, p, x, S, L) {
					var O,
						z = l & u,
						U = l & f,
						oe = l & m;
					if ((p && (O = S ? p(n, x, S, L) : p(n)), O !== e)) return O;
					if (!Kt(n)) return n;
					var ne = He(n);
					if (ne) {
						if (((O = y4(n)), !z)) return Eo(n, O);
					} else {
						var de = Kr(n),
							be = de == _t || de == Tt;
						if (ha(n)) return W1(n, z);
						if (de == Or || de == le || (be && !S)) {
							if (((O = U || be ? {} : cS(n)), !z))
								return U ? d4(n, R6(O, n)) : c4(n, E1(O, n));
						} else {
							if (!At[de]) return S ? n : {};
							O = w4(n, de, z);
						}
					}
					L || (L = new Mn());
					var Ce = L.get(n);
					if (Ce) return Ce;
					L.set(n, O),
						BS(n)
							? n.forEach(function (Oe) {
									O.add(on(Oe, l, p, Oe, n, L));
								})
							: OS(n) &&
								n.forEach(function (Oe, Je) {
									O.set(Je, on(Oe, l, p, Je, n, L));
								});
					var Ne = oe ? (U ? Ex : vx) : U ? wo : _r,
						Ke = ne ? e : Ne(n);
					return (
						en(Ke || n, function (Oe, Je) {
							Ke && ((Je = Oe), (Oe = n[Je])),
								Dd(O, Je, on(Oe, l, p, Je, n, L));
						}),
						O
					);
				}
				function D6(n) {
					var l = _r(n);
					return function (p) {
						return y1(p, n, l);
					};
				}
				function y1(n, l, p) {
					var x = p.length;
					if (n == null) return !x;
					for (n = Ct(n); x--; ) {
						var S = p[x],
							L = l[S],
							O = n[S];
						if ((O === e && !(S in n)) || !L(O)) return !1;
					}
					return !0;
				}
				function w1(n, l, p) {
					if (typeof n != "function") throw new tn(i);
					return Hd(function () {
						n.apply(e, p);
					}, l);
				}
				function Nd(n, l, p, x) {
					var S = -1,
						L = _u,
						O = !0,
						z = n.length,
						U = [],
						oe = l.length;
					if (!z) return U;
					p && (l = Gt(l, Fo(p))),
						x
							? ((L = $b), (O = !1))
							: l.length >= r && ((L = Ad), (O = !1), (l = new ul(l)));
					e: for (; ++S < z; ) {
						var ne = n[S],
							de = p == null ? ne : p(ne);
						if (((ne = x || ne !== 0 ? ne : 0), O && de === de)) {
							for (var be = oe; be--; ) if (l[be] === de) continue e;
							U.push(ne);
						} else L(l, de, x) || U.push(ne);
					}
					return U;
				}
				var ua = Z1(ti),
					S1 = Z1(rx, !0);
				function N6(n, l) {
					var p = !0;
					return (
						ua(n, function (x, S, L) {
							return (p = !!l(x, S, L)), p;
						}),
						p
					);
				}
				function Ku(n, l, p) {
					for (var x = -1, S = n.length; ++x < S; ) {
						var L = n[x],
							O = l(L);
						if (O != null && (z === e ? O === O && !zo(O) : p(O, z)))
							var z = O,
								U = L;
					}
					return U;
				}
				function O6(n, l, p, x) {
					var S = n.length;
					for (
						p = Ue(p),
							p < 0 && (p = -p > S ? 0 : S + p),
							x = x === e || x > S ? S : Ue(x),
							x < 0 && (x += S),
							x = p > x ? 0 : $S(x);
						p < x;
					)
						n[p++] = l;
					return n;
				}
				function T1(n, l) {
					var p = [];
					return (
						ua(n, function (x, S, L) {
							l(x, S, L) && p.push(x);
						}),
						p
					);
				}
				function Fr(n, l, p, x, S) {
					var L = -1,
						O = n.length;
					for (p || (p = T4), S || (S = []); ++L < O; ) {
						var z = n[L];
						l > 0 && p(z)
							? l > 1
								? Fr(z, l - 1, p, x, S)
								: sa(S, z)
							: x || (S[S.length] = z);
					}
					return S;
				}
				var tx = q1(),
					C1 = q1(!0);
				function ti(n, l) {
					return n && tx(n, l, _r);
				}
				function rx(n, l) {
					return n && C1(n, l, _r);
				}
				function Yu(n, l) {
					return la(l, function (p) {
						return Ai(n[p]);
					});
				}
				function fl(n, l) {
					l = fa(l, n);
					for (var p = 0, x = l.length; n != null && p < x; ) n = n[oi(l[p++])];
					return p && p == x ? n : e;
				}
				function I1(n, l, p) {
					var x = l(n);
					return He(n) ? x : sa(x, p(n));
				}
				function oo(n) {
					return n == null
						? n === e
							? aa
							: ia
						: dl && dl in Ct(n)
							? x4(n)
							: M4(n);
				}
				function ox(n, l) {
					return n > l;
				}
				function F6(n, l) {
					return n != null && vt.call(n, l);
				}
				function B6(n, l) {
					return n != null && l in Ct(n);
				}
				function z6(n, l, p) {
					return n >= Wr(l, p) && n < xr(l, p);
				}
				function nx(n, l, p) {
					for (
						var x = p ? $b : _u,
							S = n[0].length,
							L = n.length,
							O = L,
							z = Z(L),
							U = 1 / 0,
							oe = [];
						O--;
					) {
						var ne = n[O];
						O && l && (ne = Gt(ne, Fo(l))),
							(U = Wr(ne.length, U)),
							(z[O] =
								!p && (l || (S >= 120 && ne.length >= 120))
									? new ul(O && ne)
									: e);
					}
					ne = n[0];
					var de = -1,
						be = z[0];
					e: for (; ++de < S && oe.length < U; ) {
						var Ce = ne[de],
							Ne = l ? l(Ce) : Ce;
						if (
							((Ce = p || Ce !== 0 ? Ce : 0), !(be ? Ad(be, Ne) : x(oe, Ne, p)))
						) {
							for (O = L; --O; ) {
								var Ke = z[O];
								if (!(Ke ? Ad(Ke, Ne) : x(n[O], Ne, p))) continue e;
							}
							be && be.push(Ne), oe.push(Ce);
						}
					}
					return oe;
				}
				function $6(n, l, p, x) {
					return (
						ti(n, function (S, L, O) {
							l(x, p(S), L, O);
						}),
						x
					);
				}
				function Od(n, l, p) {
					(l = fa(l, n)), (n = pS(n, l));
					var x = n == null ? n : n[oi(an(l))];
					return x == null ? e : Oo(x, n, p);
				}
				function _1(n) {
					return qt(n) && oo(n) == le;
				}
				function H6(n) {
					return qt(n) && oo(n) == _d;
				}
				function U6(n) {
					return qt(n) && oo(n) == Se;
				}
				function Fd(n, l, p, x, S) {
					return n === l
						? !0
						: n == null || l == null || (!qt(n) && !qt(l))
							? n !== n && l !== l
							: G6(n, l, p, x, Fd, S);
				}
				function G6(n, l, p, x, S, L) {
					var O = He(n),
						z = He(l),
						U = O ? ce : Kr(n),
						oe = z ? ce : Kr(l);
					(U = U == le ? Or : U), (oe = oe == le ? Or : oe);
					var ne = U == Or,
						de = oe == Or,
						be = U == oe;
					if (be && ha(n)) {
						if (!ha(l)) return !1;
						(O = !0), (ne = !1);
					}
					if (be && !ne)
						return (
							L || (L = new Mn()),
							O || Os(n) ? aS(n, l, p, x, S, L) : h4(n, l, U, p, x, S, L)
						);
					if (!(p & g)) {
						var Ce = ne && vt.call(n, "__wrapped__"),
							Ne = de && vt.call(l, "__wrapped__");
						if (Ce || Ne) {
							var Ke = Ce ? n.value() : n,
								Oe = Ne ? l.value() : l;
							return L || (L = new Mn()), S(Ke, Oe, p, x, L);
						}
					}
					return be ? (L || (L = new Mn()), b4(n, l, p, x, S, L)) : !1;
				}
				function W6(n) {
					return qt(n) && Kr(n) == cr;
				}
				function ix(n, l, p, x) {
					var S = p.length,
						L = S,
						O = !x;
					if (n == null) return !L;
					for (n = Ct(n); S--; ) {
						var z = p[S];
						if (O && z[2] ? z[1] !== n[z[0]] : !(z[0] in n)) return !1;
					}
					for (; ++S < L; ) {
						z = p[S];
						var U = z[0],
							oe = n[U],
							ne = z[1];
						if (O && z[2]) {
							if (oe === e && !(U in n)) return !1;
						} else {
							var de = new Mn();
							if (x) var be = x(oe, ne, U, n, l, de);
							if (!(be === e ? Fd(ne, oe, g | h, x, de) : be)) return !1;
						}
					}
					return !0;
				}
				function A1(n) {
					if (!Kt(n) || I4(n)) return !1;
					var l = Ai(n) ? WD : DR;
					return l.test(hl(n));
				}
				function K6(n) {
					return qt(n) && oo(n) == al;
				}
				function Y6(n) {
					return qt(n) && Kr(n) == Cr;
				}
				function V6(n) {
					return qt(n) && cp(n.length) && !!Nt[oo(n)];
				}
				function k1(n) {
					return typeof n == "function"
						? n
						: n == null
							? So
							: typeof n == "object"
								? He(n)
									? P1(n[0], n[1])
									: M1(n)
								: jS(n);
				}
				function ax(n) {
					if (!$d(n)) return qD(n);
					var l = [];
					for (var p in Ct(n)) vt.call(n, p) && p != "constructor" && l.push(p);
					return l;
				}
				function X6(n) {
					if (!Kt(n)) return L4(n);
					var l = $d(n),
						p = [];
					for (var x in n)
						(x == "constructor" && (l || !vt.call(n, x))) || p.push(x);
					return p;
				}
				function lx(n, l) {
					return n < l;
				}
				function L1(n, l) {
					var p = -1,
						x = yo(n) ? Z(n.length) : [];
					return (
						ua(n, function (S, L, O) {
							x[++p] = l(S, L, O);
						}),
						x
					);
				}
				function M1(n) {
					var l = wx(n);
					return l.length == 1 && l[0][2]
						? mS(l[0][0], l[0][1])
						: function (p) {
								return p === n || ix(p, n, l);
							};
				}
				function P1(n, l) {
					return Tx(n) && dS(l)
						? mS(oi(n), l)
						: function (p) {
								var x = Dx(p, n);
								return x === e && x === l ? Nx(p, n) : Fd(l, x, g | h);
							};
				}
				function Vu(n, l, p, x, S) {
					n !== l &&
						tx(
							l,
							function (L, O) {
								if ((S || (S = new Mn()), Kt(L))) Z6(n, l, O, p, Vu, x, S);
								else {
									var z = x ? x(Ix(n, O), L, O + "", n, l, S) : e;
									z === e && (z = L), Jb(n, O, z);
								}
							},
							wo,
						);
				}
				function Z6(n, l, p, x, S, L, O) {
					var z = Ix(n, p),
						U = Ix(l, p),
						oe = O.get(U);
					if (oe) {
						Jb(n, p, oe);
						return;
					}
					var ne = L ? L(z, U, p + "", n, l, O) : e,
						de = ne === e;
					if (de) {
						var be = He(U),
							Ce = !be && ha(U),
							Ne = !be && !Ce && Os(U);
						(ne = U),
							be || Ce || Ne
								? He(z)
									? (ne = z)
									: nr(z)
										? (ne = Eo(z))
										: Ce
											? ((de = !1), (ne = W1(U, !0)))
											: Ne
												? ((de = !1), (ne = K1(U, !0)))
												: (ne = [])
								: Ud(U) || bl(U)
									? ((ne = z),
										bl(z) ? (ne = HS(z)) : (!Kt(z) || Ai(z)) && (ne = cS(U)))
									: (de = !1);
					}
					de && (O.set(U, ne), S(ne, U, x, L, O), O.delete(U)), Jb(n, p, ne);
				}
				function R1(n, l) {
					var p = n.length;
					if (p) return (l += l < 0 ? p : 0), _i(l, p) ? n[l] : e;
				}
				function D1(n, l, p) {
					l.length
						? (l = Gt(l, function (L) {
								return He(L)
									? function (O) {
											return fl(O, L.length === 1 ? L[0] : L);
										}
									: L;
							}))
						: (l = [So]);
					var x = -1;
					l = Gt(l, Fo(Re()));
					var S = L1(n, function (L, O, z) {
						var U = Gt(l, function (oe) {
							return oe(L);
						});
						return { criteria: U, index: ++x, value: L };
					});
					return wD(S, function (L, O) {
						return s4(L, O, p);
					});
				}
				function q6(n, l) {
					return N1(n, l, function (p, x) {
						return Nx(n, x);
					});
				}
				function N1(n, l, p) {
					for (var x = -1, S = l.length, L = {}; ++x < S; ) {
						var O = l[x],
							z = fl(n, O);
						p(z, O) && Bd(L, fa(O, n), z);
					}
					return L;
				}
				function j6(n) {
					return function (l) {
						return fl(l, n);
					};
				}
				function sx(n, l, p, x) {
					var S = x ? yD : Is,
						L = -1,
						O = l.length,
						z = n;
					for (n === l && (l = Eo(l)), p && (z = Gt(n, Fo(p))); ++L < O; )
						for (
							var U = 0, oe = l[L], ne = p ? p(oe) : oe;
							(U = S(z, ne, U, x)) > -1;
						)
							z !== n && Fu.call(z, U, 1), Fu.call(n, U, 1);
					return n;
				}
				function O1(n, l) {
					for (var p = n ? l.length : 0, x = p - 1; p--; ) {
						var S = l[p];
						if (p == x || S !== L) {
							var L = S;
							_i(S) ? Fu.call(n, S, 1) : ux(n, S);
						}
					}
					return n;
				}
				function cx(n, l) {
					return n + $u(h1() * (l - n + 1));
				}
				function Q6(n, l, p, x) {
					for (var S = -1, L = xr(zu((l - n) / (p || 1)), 0), O = Z(L); L--; )
						(O[x ? L : ++S] = n), (n += p);
					return O;
				}
				function dx(n, l) {
					var p = "";
					if (!n || l < 1 || l > se) return p;
					do l % 2 && (p += n), (l = $u(l / 2)), l && (n += n);
					while (l);
					return p;
				}
				function Xe(n, l) {
					return _x(uS(n, l, So), n + "");
				}
				function J6(n) {
					return v1(Fs(n));
				}
				function e4(n, l) {
					var p = Fs(n);
					return op(p, pl(l, 0, p.length));
				}
				function Bd(n, l, p, x) {
					if (!Kt(n)) return n;
					l = fa(l, n);
					for (
						var S = -1, L = l.length, O = L - 1, z = n;
						z != null && ++S < L;
					) {
						var U = oi(l[S]),
							oe = p;
						if (U === "__proto__" || U === "constructor" || U === "prototype")
							return n;
						if (S != O) {
							var ne = z[U];
							(oe = x ? x(ne, U, z) : e),
								oe === e && (oe = Kt(ne) ? ne : _i(l[S + 1]) ? [] : {});
						}
						Dd(z, U, oe), (z = z[U]);
					}
					return n;
				}
				var F1 = Hu
						? function (n, l) {
								return Hu.set(n, l), n;
							}
						: So,
					t4 = Bu
						? function (n, l) {
								return Bu(n, "toString", {
									configurable: !0,
									enumerable: !1,
									value: Fx(l),
									writable: !0,
								});
							}
						: So;
				function r4(n) {
					return op(Fs(n));
				}
				function nn(n, l, p) {
					var x = -1,
						S = n.length;
					l < 0 && (l = -l > S ? 0 : S + l),
						(p = p > S ? S : p),
						p < 0 && (p += S),
						(S = l > p ? 0 : (p - l) >>> 0),
						(l >>>= 0);
					for (var L = Z(S); ++x < S; ) L[x] = n[x + l];
					return L;
				}
				function o4(n, l) {
					var p;
					return (
						ua(n, function (x, S, L) {
							return (p = l(x, S, L)), !p;
						}),
						!!p
					);
				}
				function Xu(n, l, p) {
					var x = 0,
						S = n == null ? x : n.length;
					if (typeof l == "number" && l === l && S <= K) {
						for (; x < S; ) {
							var L = (x + S) >>> 1,
								O = n[L];
							O !== null && !zo(O) && (p ? O <= l : O < l)
								? (x = L + 1)
								: (S = L);
						}
						return S;
					}
					return mx(n, l, So, p);
				}
				function mx(n, l, p, x) {
					var S = 0,
						L = n == null ? 0 : n.length;
					if (L === 0) return 0;
					l = p(l);
					for (
						var O = l !== l, z = l === null, U = zo(l), oe = l === e;
						S < L;
					) {
						var ne = $u((S + L) / 2),
							de = p(n[ne]),
							be = de !== e,
							Ce = de === null,
							Ne = de === de,
							Ke = zo(de);
						if (O) var Oe = x || Ne;
						else
							oe
								? (Oe = Ne && (x || be))
								: z
									? (Oe = Ne && be && (x || !Ce))
									: U
										? (Oe = Ne && be && !Ce && (x || !Ke))
										: Ce || Ke
											? (Oe = !1)
											: (Oe = x ? de <= l : de < l);
						Oe ? (S = ne + 1) : (L = ne);
					}
					return Wr(L, Y);
				}
				function B1(n, l) {
					for (var p = -1, x = n.length, S = 0, L = []; ++p < x; ) {
						var O = n[p],
							z = l ? l(O) : O;
						if (!p || !Pn(z, U)) {
							var U = z;
							L[S++] = O === 0 ? 0 : O;
						}
					}
					return L;
				}
				function z1(n) {
					return typeof n == "number" ? n : zo(n) ? ke : +n;
				}
				function Bo(n) {
					if (typeof n == "string") return n;
					if (He(n)) return Gt(n, Bo) + "";
					if (zo(n)) return b1 ? b1.call(n) : "";
					var l = n + "";
					return l == "0" && 1 / n == -X ? "-0" : l;
				}
				function pa(n, l, p) {
					var x = -1,
						S = _u,
						L = n.length,
						O = !0,
						z = [],
						U = z;
					if (p) (O = !1), (S = $b);
					else if (L >= r) {
						var oe = l ? null : f4(n);
						if (oe) return ku(oe);
						(O = !1), (S = Ad), (U = new ul());
					} else U = l ? [] : z;
					e: for (; ++x < L; ) {
						var ne = n[x],
							de = l ? l(ne) : ne;
						if (((ne = p || ne !== 0 ? ne : 0), O && de === de)) {
							for (var be = U.length; be--; ) if (U[be] === de) continue e;
							l && U.push(de), z.push(ne);
						} else S(U, de, p) || (U !== z && U.push(de), z.push(ne));
					}
					return z;
				}
				function ux(n, l) {
					return (
						(l = fa(l, n)), (n = pS(n, l)), n == null || delete n[oi(an(l))]
					);
				}
				function $1(n, l, p, x) {
					return Bd(n, l, p(fl(n, l)), x);
				}
				function Zu(n, l, p, x) {
					for (
						var S = n.length, L = x ? S : -1;
						(x ? L-- : ++L < S) && l(n[L], L, n);
					);
					return p
						? nn(n, x ? 0 : L, x ? L + 1 : S)
						: nn(n, x ? L + 1 : 0, x ? S : L);
				}
				function H1(n, l) {
					var p = n;
					return (
						p instanceof rt && (p = p.value()),
						Hb(
							l,
							function (x, S) {
								return S.func.apply(S.thisArg, sa([x], S.args));
							},
							p,
						)
					);
				}
				function px(n, l, p) {
					var x = n.length;
					if (x < 2) return x ? pa(n[0]) : [];
					for (var S = -1, L = Z(x); ++S < x; )
						for (var O = n[S], z = -1; ++z < x; )
							z != S && (L[S] = Nd(L[S] || O, n[z], l, p));
					return pa(Fr(L, 1), l, p);
				}
				function U1(n, l, p) {
					for (var x = -1, S = n.length, L = l.length, O = {}; ++x < S; ) {
						var z = x < L ? l[x] : e;
						p(O, n[x], z);
					}
					return O;
				}
				function fx(n) {
					return nr(n) ? n : [];
				}
				function gx(n) {
					return typeof n == "function" ? n : So;
				}
				function fa(n, l) {
					return He(n) ? n : Tx(n, l) ? [n] : bS(ht(n));
				}
				var n4 = Xe;
				function ga(n, l, p) {
					var x = n.length;
					return (p = p === e ? x : p), !l && p >= x ? n : nn(n, l, p);
				}
				var G1 =
					KD ||
					function (n) {
						return Ir.clearTimeout(n);
					};
				function W1(n, l) {
					if (l) return n.slice();
					var p = n.length,
						x = m1 ? m1(p) : new n.constructor(p);
					return n.copy(x), x;
				}
				function hx(n) {
					var l = new n.constructor(n.byteLength);
					return new Nu(l).set(new Nu(n)), l;
				}
				function i4(n, l) {
					var p = l ? hx(n.buffer) : n.buffer;
					return new n.constructor(p, n.byteOffset, n.byteLength);
				}
				function a4(n) {
					var l = new n.constructor(n.source, _w.exec(n));
					return (l.lastIndex = n.lastIndex), l;
				}
				function l4(n) {
					return Rd ? Ct(Rd.call(n)) : {};
				}
				function K1(n, l) {
					var p = l ? hx(n.buffer) : n.buffer;
					return new n.constructor(p, n.byteOffset, n.length);
				}
				function Y1(n, l) {
					if (n !== l) {
						var p = n !== e,
							x = n === null,
							S = n === n,
							L = zo(n),
							O = l !== e,
							z = l === null,
							U = l === l,
							oe = zo(l);
						if (
							(!z && !oe && !L && n > l) ||
							(L && O && U && !z && !oe) ||
							(x && O && U) ||
							(!p && U) ||
							!S
						)
							return 1;
						if (
							(!x && !L && !oe && n < l) ||
							(oe && p && S && !x && !L) ||
							(z && p && S) ||
							(!O && S) ||
							!U
						)
							return -1;
					}
					return 0;
				}
				function s4(n, l, p) {
					for (
						var x = -1,
							S = n.criteria,
							L = l.criteria,
							O = S.length,
							z = p.length;
						++x < O;
					) {
						var U = Y1(S[x], L[x]);
						if (U) {
							if (x >= z) return U;
							var oe = p[x];
							return U * (oe == "desc" ? -1 : 1);
						}
					}
					return n.index - l.index;
				}
				function V1(n, l, p, x) {
					for (
						var S = -1,
							L = n.length,
							O = p.length,
							z = -1,
							U = l.length,
							oe = xr(L - O, 0),
							ne = Z(U + oe),
							de = !x;
						++z < U;
					)
						ne[z] = l[z];
					for (; ++S < O; ) (de || S < L) && (ne[p[S]] = n[S]);
					for (; oe--; ) ne[z++] = n[S++];
					return ne;
				}
				function X1(n, l, p, x) {
					for (
						var S = -1,
							L = n.length,
							O = -1,
							z = p.length,
							U = -1,
							oe = l.length,
							ne = xr(L - z, 0),
							de = Z(ne + oe),
							be = !x;
						++S < ne;
					)
						de[S] = n[S];
					for (var Ce = S; ++U < oe; ) de[Ce + U] = l[U];
					for (; ++O < z; ) (be || S < L) && (de[Ce + p[O]] = n[S++]);
					return de;
				}
				function Eo(n, l) {
					var p = -1,
						x = n.length;
					for (l || (l = Z(x)); ++p < x; ) l[p] = n[p];
					return l;
				}
				function ri(n, l, p, x) {
					var S = !p;
					p || (p = {});
					for (var L = -1, O = l.length; ++L < O; ) {
						var z = l[L],
							U = x ? x(p[z], n[z], z, p, n) : e;
						U === e && (U = n[z]), S ? Ti(p, z, U) : Dd(p, z, U);
					}
					return p;
				}
				function c4(n, l) {
					return ri(n, Sx(n), l);
				}
				function d4(n, l) {
					return ri(n, lS(n), l);
				}
				function qu(n, l) {
					return function (p, x) {
						var S = He(p) ? gD : P6,
							L = l ? l() : {};
						return S(p, n, Re(x, 2), L);
					};
				}
				function Rs(n) {
					return Xe(function (l, p) {
						var x = -1,
							S = p.length,
							L = S > 1 ? p[S - 1] : e,
							O = S > 2 ? p[2] : e;
						for (
							L = n.length > 3 && typeof L == "function" ? (S--, L) : e,
								O && no(p[0], p[1], O) && ((L = S < 3 ? e : L), (S = 1)),
								l = Ct(l);
							++x < S;
						) {
							var z = p[x];
							z && n(l, z, x, L);
						}
						return l;
					});
				}
				function Z1(n, l) {
					return function (p, x) {
						if (p == null) return p;
						if (!yo(p)) return n(p, x);
						for (
							var S = p.length, L = l ? S : -1, O = Ct(p);
							(l ? L-- : ++L < S) && x(O[L], L, O) !== !1;
						);
						return p;
					};
				}
				function q1(n) {
					return function (l, p, x) {
						for (var S = -1, L = Ct(l), O = x(l), z = O.length; z--; ) {
							var U = O[n ? z : ++S];
							if (p(L[U], U, L) === !1) break;
						}
						return l;
					};
				}
				function m4(n, l, p) {
					var x = l & y,
						S = zd(n);
					function L() {
						var O = this && this !== Ir && this instanceof L ? S : n;
						return O.apply(x ? p : this, arguments);
					}
					return L;
				}
				function j1(n) {
					return function (l) {
						l = ht(l);
						var p = _s(l) ? Ln(l) : e,
							x = p ? p[0] : l.charAt(0),
							S = p ? ga(p, 1).join("") : l.slice(1);
						return x[n]() + S;
					};
				}
				function Ds(n) {
					return function (l) {
						return Hb(ZS(XS(l).replace(tD, "")), n, "");
					};
				}
				function zd(n) {
					return function () {
						var l = arguments;
						switch (l.length) {
							case 0:
								return new n();
							case 1:
								return new n(l[0]);
							case 2:
								return new n(l[0], l[1]);
							case 3:
								return new n(l[0], l[1], l[2]);
							case 4:
								return new n(l[0], l[1], l[2], l[3]);
							case 5:
								return new n(l[0], l[1], l[2], l[3], l[4]);
							case 6:
								return new n(l[0], l[1], l[2], l[3], l[4], l[5]);
							case 7:
								return new n(l[0], l[1], l[2], l[3], l[4], l[5], l[6]);
						}
						var p = Ps(n.prototype),
							x = n.apply(p, l);
						return Kt(x) ? x : p;
					};
				}
				function u4(n, l, p) {
					var x = zd(n);
					function S() {
						for (var L = arguments.length, O = Z(L), z = L, U = Ns(S); z--; )
							O[z] = arguments[z];
						var oe = L < 3 && O[0] !== U && O[L - 1] !== U ? [] : ca(O, U);
						if (((L -= oe.length), L < p))
							return rS(n, l, ju, S.placeholder, e, O, oe, e, e, p - L);
						var ne = this && this !== Ir && this instanceof S ? x : n;
						return Oo(ne, this, O);
					}
					return S;
				}
				function Q1(n) {
					return function (l, p, x) {
						var S = Ct(l);
						if (!yo(l)) {
							var L = Re(p, 3);
							(l = _r(l)),
								(p = function (z) {
									return L(S[z], z, S);
								});
						}
						var O = n(l, p, x);
						return O > -1 ? S[L ? l[O] : O] : e;
					};
				}
				function J1(n) {
					return Ii(function (l) {
						var p = l.length,
							x = p,
							S = rn.prototype.thru;
						for (n && l.reverse(); x--; ) {
							var L = l[x];
							if (typeof L != "function") throw new tn(i);
							if (S && !O && tp(L) == "wrapper") var O = new rn([], !0);
						}
						for (x = O ? x : p; ++x < p; ) {
							L = l[x];
							var z = tp(L),
								U = z == "wrapper" ? yx(L) : e;
							U &&
							Cx(U[0]) &&
							U[1] == (N | I | C | D) &&
							!U[4].length &&
							U[9] == 1
								? (O = O[tp(U[0])].apply(O, U[3]))
								: (O = L.length == 1 && Cx(L) ? O[z]() : O.thru(L));
						}
						return function () {
							var oe = arguments,
								ne = oe[0];
							if (O && oe.length == 1 && He(ne)) return O.plant(ne).value();
							for (var de = 0, be = p ? l[de].apply(this, oe) : ne; ++de < p; )
								be = l[de].call(this, be);
							return be;
						};
					});
				}
				function ju(n, l, p, x, S, L, O, z, U, oe) {
					var ne = l & N,
						de = l & y,
						be = l & E,
						Ce = l & (I | P),
						Ne = l & B,
						Ke = be ? e : zd(n);
					function Oe() {
						for (var Je = arguments.length, it = Z(Je), $o = Je; $o--; )
							it[$o] = arguments[$o];
						if (Ce)
							var io = Ns(Oe),
								Ho = TD(it, io);
						if (
							(x && (it = V1(it, x, S, Ce)),
							L && (it = X1(it, L, O, Ce)),
							(Je -= Ho),
							Ce && Je < oe)
						) {
							var ir = ca(it, io);
							return rS(n, l, ju, Oe.placeholder, p, it, ir, z, U, oe - Je);
						}
						var Rn = de ? p : this,
							Li = be ? Rn[n] : n;
						return (
							(Je = it.length),
							z ? (it = P4(it, z)) : Ne && Je > 1 && it.reverse(),
							ne && U < Je && (it.length = U),
							this && this !== Ir && this instanceof Oe && (Li = Ke || zd(Li)),
							Li.apply(Rn, it)
						);
					}
					return Oe;
				}
				function eS(n, l) {
					return function (p, x) {
						return $6(p, n, l(x), {});
					};
				}
				function Qu(n, l) {
					return function (p, x) {
						var S;
						if (p === e && x === e) return l;
						if ((p !== e && (S = p), x !== e)) {
							if (S === e) return x;
							typeof p == "string" || typeof x == "string"
								? ((p = Bo(p)), (x = Bo(x)))
								: ((p = z1(p)), (x = z1(x))),
								(S = n(p, x));
						}
						return S;
					};
				}
				function bx(n) {
					return Ii(function (l) {
						return (
							(l = Gt(l, Fo(Re()))),
							Xe(function (p) {
								var x = this;
								return n(l, function (S) {
									return Oo(S, x, p);
								});
							})
						);
					});
				}
				function Ju(n, l) {
					l = l === e ? " " : Bo(l);
					var p = l.length;
					if (p < 2) return p ? dx(l, n) : l;
					var x = dx(l, zu(n / As(l)));
					return _s(l) ? ga(Ln(x), 0, n).join("") : x.slice(0, n);
				}
				function p4(n, l, p, x) {
					var S = l & y,
						L = zd(n);
					function O() {
						for (
							var z = -1,
								U = arguments.length,
								oe = -1,
								ne = x.length,
								de = Z(ne + U),
								be = this && this !== Ir && this instanceof O ? L : n;
							++oe < ne;
						)
							de[oe] = x[oe];
						for (; U--; ) de[oe++] = arguments[++z];
						return Oo(be, S ? p : this, de);
					}
					return O;
				}
				function tS(n) {
					return function (l, p, x) {
						return (
							x && typeof x != "number" && no(l, p, x) && (p = x = e),
							(l = ki(l)),
							p === e ? ((p = l), (l = 0)) : (p = ki(p)),
							(x = x === e ? (l < p ? 1 : -1) : ki(x)),
							Q6(l, p, x, n)
						);
					};
				}
				function ep(n) {
					return function (l, p) {
						return (
							(typeof l == "string" && typeof p == "string") ||
								((l = ln(l)), (p = ln(p))),
							n(l, p)
						);
					};
				}
				function rS(n, l, p, x, S, L, O, z, U, oe) {
					var ne = l & I,
						de = ne ? O : e,
						be = ne ? e : O,
						Ce = ne ? L : e,
						Ne = ne ? e : L;
					(l |= ne ? C : k), (l &= ~(ne ? k : C)), l & T || (l &= ~(y | E));
					var Ke = [n, l, S, Ce, de, Ne, be, z, U, oe],
						Oe = p.apply(e, Ke);
					return Cx(n) && fS(Oe, Ke), (Oe.placeholder = x), gS(Oe, n, l);
				}
				function xx(n) {
					var l = br[n];
					return function (p, x) {
						if (
							((p = ln(p)), (x = x == null ? 0 : Wr(Ue(x), 292)), x && g1(p))
						) {
							var S = (ht(p) + "e").split("e"),
								L = l(S[0] + "e" + (+S[1] + x));
							return (
								(S = (ht(L) + "e").split("e")), +(S[0] + "e" + (+S[1] - x))
							);
						}
						return l(p);
					};
				}
				var f4 =
					Ls && 1 / ku(new Ls([, -0]))[1] == X
						? function (n) {
								return new Ls(n);
							}
						: $x;
				function oS(n) {
					return function (l) {
						var p = Kr(l);
						return p == cr ? Xb(l) : p == Cr ? MD(l) : SD(l, n(l));
					};
				}
				function Ci(n, l, p, x, S, L, O, z) {
					var U = l & E;
					if (!U && typeof n != "function") throw new tn(i);
					var oe = x ? x.length : 0;
					if (
						(oe || ((l &= ~(C | k)), (x = S = e)),
						(O = O === e ? O : xr(Ue(O), 0)),
						(z = z === e ? z : Ue(z)),
						(oe -= S ? S.length : 0),
						l & k)
					) {
						var ne = x,
							de = S;
						x = S = e;
					}
					var be = U ? e : yx(n),
						Ce = [n, l, p, x, S, ne, de, L, O, z];
					if (
						(be && k4(Ce, be),
						(n = Ce[0]),
						(l = Ce[1]),
						(p = Ce[2]),
						(x = Ce[3]),
						(S = Ce[4]),
						(z = Ce[9] = Ce[9] === e ? (U ? 0 : n.length) : xr(Ce[9] - oe, 0)),
						!z && l & (I | P) && (l &= ~(I | P)),
						!l || l == y)
					)
						var Ne = m4(n, l, p);
					else
						l == I || l == P
							? (Ne = u4(n, l, z))
							: (l == C || l == (y | C)) && !S.length
								? (Ne = p4(n, l, p, x))
								: (Ne = ju.apply(e, Ce));
					var Ke = be ? F1 : fS;
					return gS(Ke(Ne, Ce), n, l);
				}
				function nS(n, l, p, x) {
					return n === e || (Pn(n, ks[p]) && !vt.call(x, p)) ? l : n;
				}
				function iS(n, l, p, x, S, L) {
					return (
						Kt(n) && Kt(l) && (L.set(l, n), Vu(n, l, e, iS, L), L.delete(l)), n
					);
				}
				function g4(n) {
					return Ud(n) ? e : n;
				}
				function aS(n, l, p, x, S, L) {
					var O = p & g,
						z = n.length,
						U = l.length;
					if (z != U && !(O && U > z)) return !1;
					var oe = L.get(n),
						ne = L.get(l);
					if (oe && ne) return oe == l && ne == n;
					var de = -1,
						be = !0,
						Ce = p & h ? new ul() : e;
					for (L.set(n, l), L.set(l, n); ++de < z; ) {
						var Ne = n[de],
							Ke = l[de];
						if (x) var Oe = O ? x(Ke, Ne, de, l, n, L) : x(Ne, Ke, de, n, l, L);
						if (Oe !== e) {
							if (Oe) continue;
							be = !1;
							break;
						}
						if (Ce) {
							if (
								!Ub(l, function (Je, it) {
									if (!Ad(Ce, it) && (Ne === Je || S(Ne, Je, p, x, L)))
										return Ce.push(it);
								})
							) {
								be = !1;
								break;
							}
						} else if (!(Ne === Ke || S(Ne, Ke, p, x, L))) {
							be = !1;
							break;
						}
					}
					return L.delete(n), L.delete(l), be;
				}
				function h4(n, l, p, x, S, L, O) {
					switch (p) {
						case Ts:
							if (n.byteLength != l.byteLength || n.byteOffset != l.byteOffset)
								return !1;
							(n = n.buffer), (l = l.buffer);
						case _d:
							return !(
								n.byteLength != l.byteLength || !L(new Nu(n), new Nu(l))
							);
						case ge:
						case Se:
						case Do:
							return Pn(+n, +l);
						case St:
							return n.name == l.name && n.message == l.message;
						case al:
						case kn:
							return n == l + "";
						case cr:
							var z = Xb;
						case Cr:
							var U = x & g;
							if ((z || (z = ku), n.size != l.size && !U)) return !1;
							var oe = O.get(n);
							if (oe) return oe == l;
							(x |= h), O.set(n, l);
							var ne = aS(z(n), z(l), x, S, L, O);
							return O.delete(n), ne;
						case ll:
							if (Rd) return Rd.call(n) == Rd.call(l);
					}
					return !1;
				}
				function b4(n, l, p, x, S, L) {
					var O = p & g,
						z = vx(n),
						U = z.length,
						oe = vx(l),
						ne = oe.length;
					if (U != ne && !O) return !1;
					for (var de = U; de--; ) {
						var be = z[de];
						if (!(O ? be in l : vt.call(l, be))) return !1;
					}
					var Ce = L.get(n),
						Ne = L.get(l);
					if (Ce && Ne) return Ce == l && Ne == n;
					var Ke = !0;
					L.set(n, l), L.set(l, n);
					for (var Oe = O; ++de < U; ) {
						be = z[de];
						var Je = n[be],
							it = l[be];
						if (x) var $o = O ? x(it, Je, be, l, n, L) : x(Je, it, be, n, l, L);
						if (!($o === e ? Je === it || S(Je, it, p, x, L) : $o)) {
							Ke = !1;
							break;
						}
						Oe || (Oe = be == "constructor");
					}
					if (Ke && !Oe) {
						var io = n.constructor,
							Ho = l.constructor;
						io != Ho &&
							"constructor" in n &&
							"constructor" in l &&
							!(
								typeof io == "function" &&
								io instanceof io &&
								typeof Ho == "function" &&
								Ho instanceof Ho
							) &&
							(Ke = !1);
					}
					return L.delete(n), L.delete(l), Ke;
				}
				function Ii(n) {
					return _x(uS(n, e, yS), n + "");
				}
				function vx(n) {
					return I1(n, _r, Sx);
				}
				function Ex(n) {
					return I1(n, wo, lS);
				}
				var yx = Hu
					? function (n) {
							return Hu.get(n);
						}
					: $x;
				function tp(n) {
					for (
						var l = n.name + "", p = Ms[l], x = vt.call(Ms, l) ? p.length : 0;
						x--;
					) {
						var S = p[x],
							L = S.func;
						if (L == null || L == n) return S.name;
					}
					return l;
				}
				function Ns(n) {
					var l = vt.call(A, "placeholder") ? A : n;
					return l.placeholder;
				}
				function Re() {
					var n = A.iteratee || Bx;
					return (
						(n = n === Bx ? k1 : n),
						arguments.length ? n(arguments[0], arguments[1]) : n
					);
				}
				function rp(n, l) {
					var p = n.__data__;
					return C4(l) ? p[typeof l == "string" ? "string" : "hash"] : p.map;
				}
				function wx(n) {
					for (var l = _r(n), p = l.length; p--; ) {
						var x = l[p],
							S = n[x];
						l[p] = [x, S, dS(S)];
					}
					return l;
				}
				function gl(n, l) {
					var p = AD(n, l);
					return A1(p) ? p : e;
				}
				function x4(n) {
					var l = vt.call(n, dl),
						p = n[dl];
					try {
						n[dl] = e;
						var x = !0;
					} catch {}
					var S = Ru.call(n);
					return x && (l ? (n[dl] = p) : delete n[dl]), S;
				}
				var Sx = qb
						? function (n) {
								return n == null
									? []
									: ((n = Ct(n)),
										la(qb(n), function (l) {
											return p1.call(n, l);
										}));
							}
						: Hx,
					lS = qb
						? function (n) {
								for (var l = []; n; ) sa(l, Sx(n)), (n = Ou(n));
								return l;
							}
						: Hx,
					Kr = oo;
				((jb && Kr(new jb(new ArrayBuffer(1))) != Ts) ||
					(Ld && Kr(new Ld()) != cr) ||
					(Qb && Kr(Qb.resolve()) != No) ||
					(Ls && Kr(new Ls()) != Cr) ||
					(Md && Kr(new Md()) != sl)) &&
					(Kr = function (n) {
						var l = oo(n),
							p = l == Or ? n.constructor : e,
							x = p ? hl(p) : "";
						if (x)
							switch (x) {
								case e6:
									return Ts;
								case t6:
									return cr;
								case r6:
									return No;
								case o6:
									return Cr;
								case n6:
									return sl;
							}
						return l;
					});
				function v4(n, l, p) {
					for (var x = -1, S = p.length; ++x < S; ) {
						var L = p[x],
							O = L.size;
						switch (L.type) {
							case "drop":
								n += O;
								break;
							case "dropRight":
								l -= O;
								break;
							case "take":
								l = Wr(l, n + O);
								break;
							case "takeRight":
								n = xr(n, l - O);
								break;
						}
					}
					return { start: n, end: l };
				}
				function E4(n) {
					var l = n.match(IR);
					return l ? l[1].split(_R) : [];
				}
				function sS(n, l, p) {
					l = fa(l, n);
					for (var x = -1, S = l.length, L = !1; ++x < S; ) {
						var O = oi(l[x]);
						if (!(L = n != null && p(n, O))) break;
						n = n[O];
					}
					return L || ++x != S
						? L
						: ((S = n == null ? 0 : n.length),
							!!S && cp(S) && _i(O, S) && (He(n) || bl(n)));
				}
				function y4(n) {
					var l = n.length,
						p = new n.constructor(l);
					return (
						l &&
							typeof n[0] == "string" &&
							vt.call(n, "index") &&
							((p.index = n.index), (p.input = n.input)),
						p
					);
				}
				function cS(n) {
					return typeof n.constructor == "function" && !$d(n) ? Ps(Ou(n)) : {};
				}
				function w4(n, l, p) {
					var x = n.constructor;
					switch (l) {
						case _d:
							return hx(n);
						case ge:
						case Se:
							return new x(+n);
						case Ts:
							return i4(n, p);
						case wb:
						case Sb:
						case Tb:
						case Cb:
						case Ib:
						case _b:
						case Ab:
						case kb:
						case Lb:
							return K1(n, p);
						case cr:
							return new x();
						case Do:
						case kn:
							return new x(n);
						case al:
							return a4(n);
						case Cr:
							return new x();
						case ll:
							return l4(n);
					}
				}
				function S4(n, l) {
					var p = l.length;
					if (!p) return n;
					var x = p - 1;
					return (
						(l[x] = (p > 1 ? "& " : "") + l[x]),
						(l = l.join(p > 2 ? ", " : " ")),
						n.replace(
							CR,
							`{
/* [wrapped with ` +
								l +
								`] */
`,
						)
					);
				}
				function T4(n) {
					return He(n) || bl(n) || !!(f1 && n && n[f1]);
				}
				function _i(n, l) {
					var p = typeof n;
					return (
						(l = l ?? se),
						!!l &&
							(p == "number" || (p != "symbol" && OR.test(n))) &&
							n > -1 &&
							n % 1 == 0 &&
							n < l
					);
				}
				function no(n, l, p) {
					if (!Kt(p)) return !1;
					var x = typeof l;
					return (
						x == "number"
							? yo(p) && _i(l, p.length)
							: x == "string" && l in p
					)
						? Pn(p[l], n)
						: !1;
				}
				function Tx(n, l) {
					if (He(n)) return !1;
					var p = typeof n;
					return p == "number" ||
						p == "symbol" ||
						p == "boolean" ||
						n == null ||
						zo(n)
						? !0
						: yR.test(n) || !ER.test(n) || (l != null && n in Ct(l));
				}
				function C4(n) {
					var l = typeof n;
					return l == "string" ||
						l == "number" ||
						l == "symbol" ||
						l == "boolean"
						? n !== "__proto__"
						: n === null;
				}
				function Cx(n) {
					var l = tp(n),
						p = A[l];
					if (typeof p != "function" || !(l in rt.prototype)) return !1;
					if (n === p) return !0;
					var x = yx(p);
					return !!x && n === x[0];
				}
				function I4(n) {
					return !!d1 && d1 in n;
				}
				var _4 = Mu ? Ai : Ux;
				function $d(n) {
					var l = n && n.constructor,
						p = (typeof l == "function" && l.prototype) || ks;
					return n === p;
				}
				function dS(n) {
					return n === n && !Kt(n);
				}
				function mS(n, l) {
					return function (p) {
						return p == null ? !1 : p[n] === l && (l !== e || n in Ct(p));
					};
				}
				function A4(n) {
					var l = lp(n, function (x) {
							return p.size === c && p.clear(), x;
						}),
						p = l.cache;
					return l;
				}
				function k4(n, l) {
					var p = n[1],
						x = l[1],
						S = p | x,
						L = S < (y | E | N),
						O =
							(x == N && p == I) ||
							(x == N && p == D && n[7].length <= l[8]) ||
							(x == (N | D) && l[7].length <= l[8] && p == I);
					if (!(L || O)) return n;
					x & y && ((n[2] = l[2]), (S |= p & y ? 0 : T));
					var z = l[3];
					if (z) {
						var U = n[3];
						(n[3] = U ? V1(U, z, l[4]) : z), (n[4] = U ? ca(n[3], d) : l[4]);
					}
					return (
						(z = l[5]),
						z &&
							((U = n[5]),
							(n[5] = U ? X1(U, z, l[6]) : z),
							(n[6] = U ? ca(n[5], d) : l[6])),
						(z = l[7]),
						z && (n[7] = z),
						x & N && (n[8] = n[8] == null ? l[8] : Wr(n[8], l[8])),
						n[9] == null && (n[9] = l[9]),
						(n[0] = l[0]),
						(n[1] = S),
						n
					);
				}
				function L4(n) {
					var l = [];
					if (n != null) for (var p in Ct(n)) l.push(p);
					return l;
				}
				function M4(n) {
					return Ru.call(n);
				}
				function uS(n, l, p) {
					return (
						(l = xr(l === e ? n.length - 1 : l, 0)),
						function () {
							for (
								var x = arguments, S = -1, L = xr(x.length - l, 0), O = Z(L);
								++S < L;
							)
								O[S] = x[l + S];
							S = -1;
							for (var z = Z(l + 1); ++S < l; ) z[S] = x[S];
							return (z[l] = p(O)), Oo(n, this, z);
						}
					);
				}
				function pS(n, l) {
					return l.length < 2 ? n : fl(n, nn(l, 0, -1));
				}
				function P4(n, l) {
					for (var p = n.length, x = Wr(l.length, p), S = Eo(n); x--; ) {
						var L = l[x];
						n[x] = _i(L, p) ? S[L] : e;
					}
					return n;
				}
				function Ix(n, l) {
					if (
						!(l === "constructor" && typeof n[l] == "function") &&
						l != "__proto__"
					)
						return n[l];
				}
				var fS = hS(F1),
					Hd =
						VD ||
						function (n, l) {
							return Ir.setTimeout(n, l);
						},
					_x = hS(t4);
				function gS(n, l, p) {
					var x = l + "";
					return _x(n, S4(x, R4(E4(x), p)));
				}
				function hS(n) {
					var l = 0,
						p = 0;
					return function () {
						var x = jD(),
							S = q - (x - p);
						if (((p = x), S > 0)) {
							if (++l >= G) return arguments[0];
						} else l = 0;
						return n.apply(e, arguments);
					};
				}
				function op(n, l) {
					var p = -1,
						x = n.length,
						S = x - 1;
					for (l = l === e ? x : l; ++p < l; ) {
						var L = cx(p, S),
							O = n[L];
						(n[L] = n[p]), (n[p] = O);
					}
					return (n.length = l), n;
				}
				var bS = A4(function (n) {
					var l = [];
					return (
						n.charCodeAt(0) === 46 && l.push(""),
						n.replace(wR, function (p, x, S, L) {
							l.push(S ? L.replace(LR, "$1") : x || p);
						}),
						l
					);
				});
				function oi(n) {
					if (typeof n == "string" || zo(n)) return n;
					var l = n + "";
					return l == "0" && 1 / n == -X ? "-0" : l;
				}
				function hl(n) {
					if (n != null) {
						try {
							return Pu.call(n);
						} catch {}
						try {
							return n + "";
						} catch {}
					}
					return "";
				}
				function R4(n, l) {
					return (
						en(ee, function (p) {
							var x = "_." + p[0];
							l & p[1] && !_u(n, x) && n.push(x);
						}),
						n.sort()
					);
				}
				function xS(n) {
					if (n instanceof rt) return n.clone();
					var l = new rn(n.__wrapped__, n.__chain__);
					return (
						(l.__actions__ = Eo(n.__actions__)),
						(l.__index__ = n.__index__),
						(l.__values__ = n.__values__),
						l
					);
				}
				function D4(n, l, p) {
					(p ? no(n, l, p) : l === e) ? (l = 1) : (l = xr(Ue(l), 0));
					var x = n == null ? 0 : n.length;
					if (!x || l < 1) return [];
					for (var S = 0, L = 0, O = Z(zu(x / l)); S < x; )
						O[L++] = nn(n, S, (S += l));
					return O;
				}
				function N4(n) {
					for (
						var l = -1, p = n == null ? 0 : n.length, x = 0, S = [];
						++l < p;
					) {
						var L = n[l];
						L && (S[x++] = L);
					}
					return S;
				}
				function O4() {
					var n = arguments.length;
					if (!n) return [];
					for (var l = Z(n - 1), p = arguments[0], x = n; x--; )
						l[x - 1] = arguments[x];
					return sa(He(p) ? Eo(p) : [p], Fr(l, 1));
				}
				var F4 = Xe(function (n, l) {
						return nr(n) ? Nd(n, Fr(l, 1, nr, !0)) : [];
					}),
					B4 = Xe(function (n, l) {
						var p = an(l);
						return (
							nr(p) && (p = e), nr(n) ? Nd(n, Fr(l, 1, nr, !0), Re(p, 2)) : []
						);
					}),
					z4 = Xe(function (n, l) {
						var p = an(l);
						return nr(p) && (p = e), nr(n) ? Nd(n, Fr(l, 1, nr, !0), e, p) : [];
					});
				function $4(n, l, p) {
					var x = n == null ? 0 : n.length;
					return x
						? ((l = p || l === e ? 1 : Ue(l)), nn(n, l < 0 ? 0 : l, x))
						: [];
				}
				function H4(n, l, p) {
					var x = n == null ? 0 : n.length;
					return x
						? ((l = p || l === e ? 1 : Ue(l)),
							(l = x - l),
							nn(n, 0, l < 0 ? 0 : l))
						: [];
				}
				function U4(n, l) {
					return n && n.length ? Zu(n, Re(l, 3), !0, !0) : [];
				}
				function G4(n, l) {
					return n && n.length ? Zu(n, Re(l, 3), !0) : [];
				}
				function W4(n, l, p, x) {
					var S = n == null ? 0 : n.length;
					return S
						? (p && typeof p != "number" && no(n, l, p) && ((p = 0), (x = S)),
							O6(n, l, p, x))
						: [];
				}
				function vS(n, l, p) {
					var x = n == null ? 0 : n.length;
					if (!x) return -1;
					var S = p == null ? 0 : Ue(p);
					return S < 0 && (S = xr(x + S, 0)), Au(n, Re(l, 3), S);
				}
				function ES(n, l, p) {
					var x = n == null ? 0 : n.length;
					if (!x) return -1;
					var S = x - 1;
					return (
						p !== e && ((S = Ue(p)), (S = p < 0 ? xr(x + S, 0) : Wr(S, x - 1))),
						Au(n, Re(l, 3), S, !0)
					);
				}
				function yS(n) {
					var l = n == null ? 0 : n.length;
					return l ? Fr(n, 1) : [];
				}
				function K4(n) {
					var l = n == null ? 0 : n.length;
					return l ? Fr(n, X) : [];
				}
				function Y4(n, l) {
					var p = n == null ? 0 : n.length;
					return p ? ((l = l === e ? 1 : Ue(l)), Fr(n, l)) : [];
				}
				function V4(n) {
					for (var l = -1, p = n == null ? 0 : n.length, x = {}; ++l < p; ) {
						var S = n[l];
						x[S[0]] = S[1];
					}
					return x;
				}
				function wS(n) {
					return n && n.length ? n[0] : e;
				}
				function X4(n, l, p) {
					var x = n == null ? 0 : n.length;
					if (!x) return -1;
					var S = p == null ? 0 : Ue(p);
					return S < 0 && (S = xr(x + S, 0)), Is(n, l, S);
				}
				function Z4(n) {
					var l = n == null ? 0 : n.length;
					return l ? nn(n, 0, -1) : [];
				}
				var q4 = Xe(function (n) {
						var l = Gt(n, fx);
						return l.length && l[0] === n[0] ? nx(l) : [];
					}),
					j4 = Xe(function (n) {
						var l = an(n),
							p = Gt(n, fx);
						return (
							l === an(p) ? (l = e) : p.pop(),
							p.length && p[0] === n[0] ? nx(p, Re(l, 2)) : []
						);
					}),
					Q4 = Xe(function (n) {
						var l = an(n),
							p = Gt(n, fx);
						return (
							(l = typeof l == "function" ? l : e),
							l && p.pop(),
							p.length && p[0] === n[0] ? nx(p, e, l) : []
						);
					});
				function J4(n, l) {
					return n == null ? "" : ZD.call(n, l);
				}
				function an(n) {
					var l = n == null ? 0 : n.length;
					return l ? n[l - 1] : e;
				}
				function eN(n, l, p) {
					var x = n == null ? 0 : n.length;
					if (!x) return -1;
					var S = x;
					return (
						p !== e && ((S = Ue(p)), (S = S < 0 ? xr(x + S, 0) : Wr(S, x - 1))),
						l === l ? RD(n, l, S) : Au(n, r1, S, !0)
					);
				}
				function tN(n, l) {
					return n && n.length ? R1(n, Ue(l)) : e;
				}
				var rN = Xe(SS);
				function SS(n, l) {
					return n && n.length && l && l.length ? sx(n, l) : n;
				}
				function oN(n, l, p) {
					return n && n.length && l && l.length ? sx(n, l, Re(p, 2)) : n;
				}
				function nN(n, l, p) {
					return n && n.length && l && l.length ? sx(n, l, e, p) : n;
				}
				var iN = Ii(function (n, l) {
					var p = n == null ? 0 : n.length,
						x = ex(n, l);
					return (
						O1(
							n,
							Gt(l, function (S) {
								return _i(S, p) ? +S : S;
							}).sort(Y1),
						),
						x
					);
				});
				function aN(n, l) {
					var p = [];
					if (!(n && n.length)) return p;
					var x = -1,
						S = [],
						L = n.length;
					for (l = Re(l, 3); ++x < L; ) {
						var O = n[x];
						l(O, x, n) && (p.push(O), S.push(x));
					}
					return O1(n, S), p;
				}
				function Ax(n) {
					return n == null ? n : JD.call(n);
				}
				function lN(n, l, p) {
					var x = n == null ? 0 : n.length;
					return x
						? (p && typeof p != "number" && no(n, l, p)
								? ((l = 0), (p = x))
								: ((l = l == null ? 0 : Ue(l)), (p = p === e ? x : Ue(p))),
							nn(n, l, p))
						: [];
				}
				function sN(n, l) {
					return Xu(n, l);
				}
				function cN(n, l, p) {
					return mx(n, l, Re(p, 2));
				}
				function dN(n, l) {
					var p = n == null ? 0 : n.length;
					if (p) {
						var x = Xu(n, l);
						if (x < p && Pn(n[x], l)) return x;
					}
					return -1;
				}
				function mN(n, l) {
					return Xu(n, l, !0);
				}
				function uN(n, l, p) {
					return mx(n, l, Re(p, 2), !0);
				}
				function pN(n, l) {
					var p = n == null ? 0 : n.length;
					if (p) {
						var x = Xu(n, l, !0) - 1;
						if (Pn(n[x], l)) return x;
					}
					return -1;
				}
				function fN(n) {
					return n && n.length ? B1(n) : [];
				}
				function gN(n, l) {
					return n && n.length ? B1(n, Re(l, 2)) : [];
				}
				function hN(n) {
					var l = n == null ? 0 : n.length;
					return l ? nn(n, 1, l) : [];
				}
				function bN(n, l, p) {
					return n && n.length
						? ((l = p || l === e ? 1 : Ue(l)), nn(n, 0, l < 0 ? 0 : l))
						: [];
				}
				function xN(n, l, p) {
					var x = n == null ? 0 : n.length;
					return x
						? ((l = p || l === e ? 1 : Ue(l)),
							(l = x - l),
							nn(n, l < 0 ? 0 : l, x))
						: [];
				}
				function vN(n, l) {
					return n && n.length ? Zu(n, Re(l, 3), !1, !0) : [];
				}
				function EN(n, l) {
					return n && n.length ? Zu(n, Re(l, 3)) : [];
				}
				var yN = Xe(function (n) {
						return pa(Fr(n, 1, nr, !0));
					}),
					wN = Xe(function (n) {
						var l = an(n);
						return nr(l) && (l = e), pa(Fr(n, 1, nr, !0), Re(l, 2));
					}),
					SN = Xe(function (n) {
						var l = an(n);
						return (
							(l = typeof l == "function" ? l : e), pa(Fr(n, 1, nr, !0), e, l)
						);
					});
				function TN(n) {
					return n && n.length ? pa(n) : [];
				}
				function CN(n, l) {
					return n && n.length ? pa(n, Re(l, 2)) : [];
				}
				function IN(n, l) {
					return (
						(l = typeof l == "function" ? l : e),
						n && n.length ? pa(n, e, l) : []
					);
				}
				function kx(n) {
					if (!(n && n.length)) return [];
					var l = 0;
					return (
						(n = la(n, function (p) {
							if (nr(p)) return (l = xr(p.length, l)), !0;
						})),
						Yb(l, function (p) {
							return Gt(n, Gb(p));
						})
					);
				}
				function TS(n, l) {
					if (!(n && n.length)) return [];
					var p = kx(n);
					return l == null
						? p
						: Gt(p, function (x) {
								return Oo(l, e, x);
							});
				}
				var _N = Xe(function (n, l) {
						return nr(n) ? Nd(n, l) : [];
					}),
					AN = Xe(function (n) {
						return px(la(n, nr));
					}),
					kN = Xe(function (n) {
						var l = an(n);
						return nr(l) && (l = e), px(la(n, nr), Re(l, 2));
					}),
					LN = Xe(function (n) {
						var l = an(n);
						return (l = typeof l == "function" ? l : e), px(la(n, nr), e, l);
					}),
					MN = Xe(kx);
				function PN(n, l) {
					return U1(n || [], l || [], Dd);
				}
				function RN(n, l) {
					return U1(n || [], l || [], Bd);
				}
				var DN = Xe(function (n) {
					var l = n.length,
						p = l > 1 ? n[l - 1] : e;
					return (p = typeof p == "function" ? (n.pop(), p) : e), TS(n, p);
				});
				function CS(n) {
					var l = A(n);
					return (l.__chain__ = !0), l;
				}
				function NN(n, l) {
					return l(n), n;
				}
				function np(n, l) {
					return l(n);
				}
				var ON = Ii(function (n) {
					var l = n.length,
						p = l ? n[0] : 0,
						x = this.__wrapped__,
						S = function (L) {
							return ex(L, n);
						};
					return l > 1 ||
						this.__actions__.length ||
						!(x instanceof rt) ||
						!_i(p)
						? this.thru(S)
						: ((x = x.slice(p, +p + (l ? 1 : 0))),
							x.__actions__.push({ func: np, args: [S], thisArg: e }),
							new rn(x, this.__chain__).thru(function (L) {
								return l && !L.length && L.push(e), L;
							}));
				});
				function FN() {
					return CS(this);
				}
				function BN() {
					return new rn(this.value(), this.__chain__);
				}
				function zN() {
					this.__values__ === e && (this.__values__ = zS(this.value()));
					var n = this.__index__ >= this.__values__.length,
						l = n ? e : this.__values__[this.__index__++];
					return { done: n, value: l };
				}
				function $N() {
					return this;
				}
				function HN(n) {
					for (var l, p = this; p instanceof Gu; ) {
						var x = xS(p);
						(x.__index__ = 0),
							(x.__values__ = e),
							l ? (S.__wrapped__ = x) : (l = x);
						var S = x;
						p = p.__wrapped__;
					}
					return (S.__wrapped__ = n), l;
				}
				function UN() {
					var n = this.__wrapped__;
					if (n instanceof rt) {
						var l = n;
						return (
							this.__actions__.length && (l = new rt(this)),
							(l = l.reverse()),
							l.__actions__.push({ func: np, args: [Ax], thisArg: e }),
							new rn(l, this.__chain__)
						);
					}
					return this.thru(Ax);
				}
				function GN() {
					return H1(this.__wrapped__, this.__actions__);
				}
				var WN = qu(function (n, l, p) {
					vt.call(n, p) ? ++n[p] : Ti(n, p, 1);
				});
				function KN(n, l, p) {
					var x = He(n) ? e1 : N6;
					return p && no(n, l, p) && (l = e), x(n, Re(l, 3));
				}
				function YN(n, l) {
					var p = He(n) ? la : T1;
					return p(n, Re(l, 3));
				}
				var VN = Q1(vS),
					XN = Q1(ES);
				function ZN(n, l) {
					return Fr(ip(n, l), 1);
				}
				function qN(n, l) {
					return Fr(ip(n, l), X);
				}
				function jN(n, l, p) {
					return (p = p === e ? 1 : Ue(p)), Fr(ip(n, l), p);
				}
				function IS(n, l) {
					var p = He(n) ? en : ua;
					return p(n, Re(l, 3));
				}
				function _S(n, l) {
					var p = He(n) ? hD : S1;
					return p(n, Re(l, 3));
				}
				var QN = qu(function (n, l, p) {
					vt.call(n, p) ? n[p].push(l) : Ti(n, p, [l]);
				});
				function JN(n, l, p, x) {
					(n = yo(n) ? n : Fs(n)), (p = p && !x ? Ue(p) : 0);
					var S = n.length;
					return (
						p < 0 && (p = xr(S + p, 0)),
						dp(n) ? p <= S && n.indexOf(l, p) > -1 : !!S && Is(n, l, p) > -1
					);
				}
				var eO = Xe(function (n, l, p) {
						var x = -1,
							S = typeof l == "function",
							L = yo(n) ? Z(n.length) : [];
						return (
							ua(n, function (O) {
								L[++x] = S ? Oo(l, O, p) : Od(O, l, p);
							}),
							L
						);
					}),
					tO = qu(function (n, l, p) {
						Ti(n, p, l);
					});
				function ip(n, l) {
					var p = He(n) ? Gt : L1;
					return p(n, Re(l, 3));
				}
				function rO(n, l, p, x) {
					return n == null
						? []
						: (He(l) || (l = l == null ? [] : [l]),
							(p = x ? e : p),
							He(p) || (p = p == null ? [] : [p]),
							D1(n, l, p));
				}
				var oO = qu(
					function (n, l, p) {
						n[p ? 0 : 1].push(l);
					},
					function () {
						return [[], []];
					},
				);
				function nO(n, l, p) {
					var x = He(n) ? Hb : n1,
						S = arguments.length < 3;
					return x(n, Re(l, 4), p, S, ua);
				}
				function iO(n, l, p) {
					var x = He(n) ? bD : n1,
						S = arguments.length < 3;
					return x(n, Re(l, 4), p, S, S1);
				}
				function aO(n, l) {
					var p = He(n) ? la : T1;
					return p(n, sp(Re(l, 3)));
				}
				function lO(n) {
					var l = He(n) ? v1 : J6;
					return l(n);
				}
				function sO(n, l, p) {
					(p ? no(n, l, p) : l === e) ? (l = 1) : (l = Ue(l));
					var x = He(n) ? L6 : e4;
					return x(n, l);
				}
				function cO(n) {
					var l = He(n) ? M6 : r4;
					return l(n);
				}
				function dO(n) {
					if (n == null) return 0;
					if (yo(n)) return dp(n) ? As(n) : n.length;
					var l = Kr(n);
					return l == cr || l == Cr ? n.size : ax(n).length;
				}
				function mO(n, l, p) {
					var x = He(n) ? Ub : o4;
					return p && no(n, l, p) && (l = e), x(n, Re(l, 3));
				}
				var uO = Xe(function (n, l) {
						if (n == null) return [];
						var p = l.length;
						return (
							p > 1 && no(n, l[0], l[1])
								? (l = [])
								: p > 2 && no(l[0], l[1], l[2]) && (l = [l[0]]),
							D1(n, Fr(l, 1), [])
						);
					}),
					ap =
						YD ||
						function () {
							return Ir.Date.now();
						};
				function pO(n, l) {
					if (typeof l != "function") throw new tn(i);
					return (
						(n = Ue(n)),
						function () {
							if (--n < 1) return l.apply(this, arguments);
						}
					);
				}
				function AS(n, l, p) {
					return (
						(l = p ? e : l),
						(l = n && l == null ? n.length : l),
						Ci(n, N, e, e, e, e, l)
					);
				}
				function kS(n, l) {
					var p;
					if (typeof l != "function") throw new tn(i);
					return (
						(n = Ue(n)),
						function () {
							return (
								--n > 0 && (p = l.apply(this, arguments)), n <= 1 && (l = e), p
							);
						}
					);
				}
				var Lx = Xe(function (n, l, p) {
						var x = y;
						if (p.length) {
							var S = ca(p, Ns(Lx));
							x |= C;
						}
						return Ci(n, x, l, p, S);
					}),
					LS = Xe(function (n, l, p) {
						var x = y | E;
						if (p.length) {
							var S = ca(p, Ns(LS));
							x |= C;
						}
						return Ci(l, x, n, p, S);
					});
				function MS(n, l, p) {
					l = p ? e : l;
					var x = Ci(n, I, e, e, e, e, e, l);
					return (x.placeholder = MS.placeholder), x;
				}
				function PS(n, l, p) {
					l = p ? e : l;
					var x = Ci(n, P, e, e, e, e, e, l);
					return (x.placeholder = PS.placeholder), x;
				}
				function RS(n, l, p) {
					var x,
						S,
						L,
						O,
						z,
						U,
						oe = 0,
						ne = !1,
						de = !1,
						be = !0;
					if (typeof n != "function") throw new tn(i);
					(l = ln(l) || 0),
						Kt(p) &&
							((ne = !!p.leading),
							(de = "maxWait" in p),
							(L = de ? xr(ln(p.maxWait) || 0, l) : L),
							(be = "trailing" in p ? !!p.trailing : be));
					function Ce(ir) {
						var Rn = x,
							Li = S;
						return (x = S = e), (oe = ir), (O = n.apply(Li, Rn)), O;
					}
					function Ne(ir) {
						return (oe = ir), (z = Hd(Je, l)), ne ? Ce(ir) : O;
					}
					function Ke(ir) {
						var Rn = ir - U,
							Li = ir - oe,
							QS = l - Rn;
						return de ? Wr(QS, L - Li) : QS;
					}
					function Oe(ir) {
						var Rn = ir - U,
							Li = ir - oe;
						return U === e || Rn >= l || Rn < 0 || (de && Li >= L);
					}
					function Je() {
						var ir = ap();
						if (Oe(ir)) return it(ir);
						z = Hd(Je, Ke(ir));
					}
					function it(ir) {
						return (z = e), be && x ? Ce(ir) : ((x = S = e), O);
					}
					function $o() {
						z !== e && G1(z), (oe = 0), (x = U = S = z = e);
					}
					function io() {
						return z === e ? O : it(ap());
					}
					function Ho() {
						var ir = ap(),
							Rn = Oe(ir);
						if (((x = arguments), (S = this), (U = ir), Rn)) {
							if (z === e) return Ne(U);
							if (de) return G1(z), (z = Hd(Je, l)), Ce(U);
						}
						return z === e && (z = Hd(Je, l)), O;
					}
					return (Ho.cancel = $o), (Ho.flush = io), Ho;
				}
				var fO = Xe(function (n, l) {
						return w1(n, 1, l);
					}),
					gO = Xe(function (n, l, p) {
						return w1(n, ln(l) || 0, p);
					});
				function hO(n) {
					return Ci(n, B);
				}
				function lp(n, l) {
					if (typeof n != "function" || (l != null && typeof l != "function"))
						throw new tn(i);
					var p = function () {
						var x = arguments,
							S = l ? l.apply(this, x) : x[0],
							L = p.cache;
						if (L.has(S)) return L.get(S);
						var O = n.apply(this, x);
						return (p.cache = L.set(S, O) || L), O;
					};
					return (p.cache = new (lp.Cache || Si)()), p;
				}
				lp.Cache = Si;
				function sp(n) {
					if (typeof n != "function") throw new tn(i);
					return function () {
						var l = arguments;
						switch (l.length) {
							case 0:
								return !n.call(this);
							case 1:
								return !n.call(this, l[0]);
							case 2:
								return !n.call(this, l[0], l[1]);
							case 3:
								return !n.call(this, l[0], l[1], l[2]);
						}
						return !n.apply(this, l);
					};
				}
				function bO(n) {
					return kS(2, n);
				}
				var xO = n4(function (n, l) {
						l =
							l.length == 1 && He(l[0])
								? Gt(l[0], Fo(Re()))
								: Gt(Fr(l, 1), Fo(Re()));
						var p = l.length;
						return Xe(function (x) {
							for (var S = -1, L = Wr(x.length, p); ++S < L; )
								x[S] = l[S].call(this, x[S]);
							return Oo(n, this, x);
						});
					}),
					Mx = Xe(function (n, l) {
						var p = ca(l, Ns(Mx));
						return Ci(n, C, e, l, p);
					}),
					DS = Xe(function (n, l) {
						var p = ca(l, Ns(DS));
						return Ci(n, k, e, l, p);
					}),
					vO = Ii(function (n, l) {
						return Ci(n, D, e, e, e, l);
					});
				function EO(n, l) {
					if (typeof n != "function") throw new tn(i);
					return (l = l === e ? l : Ue(l)), Xe(n, l);
				}
				function yO(n, l) {
					if (typeof n != "function") throw new tn(i);
					return (
						(l = l == null ? 0 : xr(Ue(l), 0)),
						Xe(function (p) {
							var x = p[l],
								S = ga(p, 0, l);
							return x && sa(S, x), Oo(n, this, S);
						})
					);
				}
				function wO(n, l, p) {
					var x = !0,
						S = !0;
					if (typeof n != "function") throw new tn(i);
					return (
						Kt(p) &&
							((x = "leading" in p ? !!p.leading : x),
							(S = "trailing" in p ? !!p.trailing : S)),
						RS(n, l, { leading: x, maxWait: l, trailing: S })
					);
				}
				function SO(n) {
					return AS(n, 1);
				}
				function TO(n, l) {
					return Mx(gx(l), n);
				}
				function CO() {
					if (!arguments.length) return [];
					var n = arguments[0];
					return He(n) ? n : [n];
				}
				function IO(n) {
					return on(n, m);
				}
				function _O(n, l) {
					return (l = typeof l == "function" ? l : e), on(n, m, l);
				}
				function AO(n) {
					return on(n, u | m);
				}
				function kO(n, l) {
					return (l = typeof l == "function" ? l : e), on(n, u | m, l);
				}
				function LO(n, l) {
					return l == null || y1(n, l, _r(l));
				}
				function Pn(n, l) {
					return n === l || (n !== n && l !== l);
				}
				var MO = ep(ox),
					PO = ep(function (n, l) {
						return n >= l;
					}),
					bl = _1(
						(function () {
							return arguments;
						})(),
					)
						? _1
						: function (n) {
								return qt(n) && vt.call(n, "callee") && !p1.call(n, "callee");
							},
					He = Z.isArray,
					RO = Xw ? Fo(Xw) : H6;
				function yo(n) {
					return n != null && cp(n.length) && !Ai(n);
				}
				function nr(n) {
					return qt(n) && yo(n);
				}
				function DO(n) {
					return n === !0 || n === !1 || (qt(n) && oo(n) == ge);
				}
				var ha = XD || Ux,
					NO = Zw ? Fo(Zw) : U6;
				function OO(n) {
					return qt(n) && n.nodeType === 1 && !Ud(n);
				}
				function FO(n) {
					if (n == null) return !0;
					if (
						yo(n) &&
						(He(n) ||
							typeof n == "string" ||
							typeof n.splice == "function" ||
							ha(n) ||
							Os(n) ||
							bl(n))
					)
						return !n.length;
					var l = Kr(n);
					if (l == cr || l == Cr) return !n.size;
					if ($d(n)) return !ax(n).length;
					for (var p in n) if (vt.call(n, p)) return !1;
					return !0;
				}
				function BO(n, l) {
					return Fd(n, l);
				}
				function zO(n, l, p) {
					p = typeof p == "function" ? p : e;
					var x = p ? p(n, l) : e;
					return x === e ? Fd(n, l, e, p) : !!x;
				}
				function Px(n) {
					if (!qt(n)) return !1;
					var l = oo(n);
					return (
						l == St ||
						l == Dt ||
						(typeof n.message == "string" &&
							typeof n.name == "string" &&
							!Ud(n))
					);
				}
				function $O(n) {
					return typeof n == "number" && g1(n);
				}
				function Ai(n) {
					if (!Kt(n)) return !1;
					var l = oo(n);
					return l == _t || l == Tt || l == ue || l == Eb;
				}
				function NS(n) {
					return typeof n == "number" && n == Ue(n);
				}
				function cp(n) {
					return typeof n == "number" && n > -1 && n % 1 == 0 && n <= se;
				}
				function Kt(n) {
					var l = typeof n;
					return n != null && (l == "object" || l == "function");
				}
				function qt(n) {
					return n != null && typeof n == "object";
				}
				var OS = qw ? Fo(qw) : W6;
				function HO(n, l) {
					return n === l || ix(n, l, wx(l));
				}
				function UO(n, l, p) {
					return (p = typeof p == "function" ? p : e), ix(n, l, wx(l), p);
				}
				function GO(n) {
					return FS(n) && n != +n;
				}
				function WO(n) {
					if (_4(n)) throw new ze(o);
					return A1(n);
				}
				function KO(n) {
					return n === null;
				}
				function YO(n) {
					return n == null;
				}
				function FS(n) {
					return typeof n == "number" || (qt(n) && oo(n) == Do);
				}
				function Ud(n) {
					if (!qt(n) || oo(n) != Or) return !1;
					var l = Ou(n);
					if (l === null) return !0;
					var p = vt.call(l, "constructor") && l.constructor;
					return typeof p == "function" && p instanceof p && Pu.call(p) == UD;
				}
				var Rx = jw ? Fo(jw) : K6;
				function VO(n) {
					return NS(n) && n >= -se && n <= se;
				}
				var BS = Qw ? Fo(Qw) : Y6;
				function dp(n) {
					return typeof n == "string" || (!He(n) && qt(n) && oo(n) == kn);
				}
				function zo(n) {
					return typeof n == "symbol" || (qt(n) && oo(n) == ll);
				}
				var Os = Jw ? Fo(Jw) : V6;
				function XO(n) {
					return n === e;
				}
				function ZO(n) {
					return qt(n) && Kr(n) == sl;
				}
				function qO(n) {
					return qt(n) && oo(n) == yb;
				}
				var jO = ep(lx),
					QO = ep(function (n, l) {
						return n <= l;
					});
				function zS(n) {
					if (!n) return [];
					if (yo(n)) return dp(n) ? Ln(n) : Eo(n);
					if (kd && n[kd]) return LD(n[kd]());
					var l = Kr(n),
						p = l == cr ? Xb : l == Cr ? ku : Fs;
					return p(n);
				}
				function ki(n) {
					if (!n) return n === 0 ? n : 0;
					if (((n = ln(n)), n === X || n === -X)) {
						var l = n < 0 ? -1 : 1;
						return l * Pe;
					}
					return n === n ? n : 0;
				}
				function Ue(n) {
					var l = ki(n),
						p = l % 1;
					return l === l ? (p ? l - p : l) : 0;
				}
				function $S(n) {
					return n ? pl(Ue(n), 0, fe) : 0;
				}
				function ln(n) {
					if (typeof n == "number") return n;
					if (zo(n)) return ke;
					if (Kt(n)) {
						var l = typeof n.valueOf == "function" ? n.valueOf() : n;
						n = Kt(l) ? l + "" : l;
					}
					if (typeof n != "string") return n === 0 ? n : +n;
					n = i1(n);
					var p = RR.test(n);
					return p || NR.test(n)
						? pD(n.slice(2), p ? 2 : 8)
						: PR.test(n)
							? ke
							: +n;
				}
				function HS(n) {
					return ri(n, wo(n));
				}
				function JO(n) {
					return n ? pl(Ue(n), -se, se) : n === 0 ? n : 0;
				}
				function ht(n) {
					return n == null ? "" : Bo(n);
				}
				var e8 = Rs(function (n, l) {
						if ($d(l) || yo(l)) {
							ri(l, _r(l), n);
							return;
						}
						for (var p in l) vt.call(l, p) && Dd(n, p, l[p]);
					}),
					US = Rs(function (n, l) {
						ri(l, wo(l), n);
					}),
					mp = Rs(function (n, l, p, x) {
						ri(l, wo(l), n, x);
					}),
					t8 = Rs(function (n, l, p, x) {
						ri(l, _r(l), n, x);
					}),
					r8 = Ii(ex);
				function o8(n, l) {
					var p = Ps(n);
					return l == null ? p : E1(p, l);
				}
				var n8 = Xe(function (n, l) {
						n = Ct(n);
						var p = -1,
							x = l.length,
							S = x > 2 ? l[2] : e;
						for (S && no(l[0], l[1], S) && (x = 1); ++p < x; )
							for (var L = l[p], O = wo(L), z = -1, U = O.length; ++z < U; ) {
								var oe = O[z],
									ne = n[oe];
								(ne === e || (Pn(ne, ks[oe]) && !vt.call(n, oe))) &&
									(n[oe] = L[oe]);
							}
						return n;
					}),
					i8 = Xe(function (n) {
						return n.push(e, iS), Oo(GS, e, n);
					});
				function a8(n, l) {
					return t1(n, Re(l, 3), ti);
				}
				function l8(n, l) {
					return t1(n, Re(l, 3), rx);
				}
				function s8(n, l) {
					return n == null ? n : tx(n, Re(l, 3), wo);
				}
				function c8(n, l) {
					return n == null ? n : C1(n, Re(l, 3), wo);
				}
				function d8(n, l) {
					return n && ti(n, Re(l, 3));
				}
				function m8(n, l) {
					return n && rx(n, Re(l, 3));
				}
				function u8(n) {
					return n == null ? [] : Yu(n, _r(n));
				}
				function p8(n) {
					return n == null ? [] : Yu(n, wo(n));
				}
				function Dx(n, l, p) {
					var x = n == null ? e : fl(n, l);
					return x === e ? p : x;
				}
				function f8(n, l) {
					return n != null && sS(n, l, F6);
				}
				function Nx(n, l) {
					return n != null && sS(n, l, B6);
				}
				var g8 = eS(function (n, l, p) {
						l != null && typeof l.toString != "function" && (l = Ru.call(l)),
							(n[l] = p);
					}, Fx(So)),
					h8 = eS(function (n, l, p) {
						l != null && typeof l.toString != "function" && (l = Ru.call(l)),
							vt.call(n, l) ? n[l].push(p) : (n[l] = [p]);
					}, Re),
					b8 = Xe(Od);
				function _r(n) {
					return yo(n) ? x1(n) : ax(n);
				}
				function wo(n) {
					return yo(n) ? x1(n, !0) : X6(n);
				}
				function x8(n, l) {
					var p = {};
					return (
						(l = Re(l, 3)),
						ti(n, function (x, S, L) {
							Ti(p, l(x, S, L), x);
						}),
						p
					);
				}
				function v8(n, l) {
					var p = {};
					return (
						(l = Re(l, 3)),
						ti(n, function (x, S, L) {
							Ti(p, S, l(x, S, L));
						}),
						p
					);
				}
				var E8 = Rs(function (n, l, p) {
						Vu(n, l, p);
					}),
					GS = Rs(function (n, l, p, x) {
						Vu(n, l, p, x);
					}),
					y8 = Ii(function (n, l) {
						var p = {};
						if (n == null) return p;
						var x = !1;
						(l = Gt(l, function (L) {
							return (L = fa(L, n)), x || (x = L.length > 1), L;
						})),
							ri(n, Ex(n), p),
							x && (p = on(p, u | f | m, g4));
						for (var S = l.length; S--; ) ux(p, l[S]);
						return p;
					});
				function w8(n, l) {
					return WS(n, sp(Re(l)));
				}
				var S8 = Ii(function (n, l) {
					return n == null ? {} : q6(n, l);
				});
				function WS(n, l) {
					if (n == null) return {};
					var p = Gt(Ex(n), function (x) {
						return [x];
					});
					return (
						(l = Re(l)),
						N1(n, p, function (x, S) {
							return l(x, S[0]);
						})
					);
				}
				function T8(n, l, p) {
					l = fa(l, n);
					var x = -1,
						S = l.length;
					for (S || ((S = 1), (n = e)); ++x < S; ) {
						var L = n == null ? e : n[oi(l[x])];
						L === e && ((x = S), (L = p)), (n = Ai(L) ? L.call(n) : L);
					}
					return n;
				}
				function C8(n, l, p) {
					return n == null ? n : Bd(n, l, p);
				}
				function I8(n, l, p, x) {
					return (
						(x = typeof x == "function" ? x : e), n == null ? n : Bd(n, l, p, x)
					);
				}
				var KS = oS(_r),
					YS = oS(wo);
				function _8(n, l, p) {
					var x = He(n),
						S = x || ha(n) || Os(n);
					if (((l = Re(l, 4)), p == null)) {
						var L = n && n.constructor;
						S
							? (p = x ? new L() : [])
							: Kt(n)
								? (p = Ai(L) ? Ps(Ou(n)) : {})
								: (p = {});
					}
					return (
						(S ? en : ti)(n, function (O, z, U) {
							return l(p, O, z, U);
						}),
						p
					);
				}
				function A8(n, l) {
					return n == null ? !0 : ux(n, l);
				}
				function k8(n, l, p) {
					return n == null ? n : $1(n, l, gx(p));
				}
				function L8(n, l, p, x) {
					return (
						(x = typeof x == "function" ? x : e),
						n == null ? n : $1(n, l, gx(p), x)
					);
				}
				function Fs(n) {
					return n == null ? [] : Vb(n, _r(n));
				}
				function M8(n) {
					return n == null ? [] : Vb(n, wo(n));
				}
				function P8(n, l, p) {
					return (
						p === e && ((p = l), (l = e)),
						p !== e && ((p = ln(p)), (p = p === p ? p : 0)),
						l !== e && ((l = ln(l)), (l = l === l ? l : 0)),
						pl(ln(n), l, p)
					);
				}
				function R8(n, l, p) {
					return (
						(l = ki(l)),
						p === e ? ((p = l), (l = 0)) : (p = ki(p)),
						(n = ln(n)),
						z6(n, l, p)
					);
				}
				function D8(n, l, p) {
					if (
						(p && typeof p != "boolean" && no(n, l, p) && (l = p = e),
						p === e &&
							(typeof l == "boolean"
								? ((p = l), (l = e))
								: typeof n == "boolean" && ((p = n), (n = e))),
						n === e && l === e
							? ((n = 0), (l = 1))
							: ((n = ki(n)), l === e ? ((l = n), (n = 0)) : (l = ki(l))),
						n > l)
					) {
						var x = n;
						(n = l), (l = x);
					}
					if (p || n % 1 || l % 1) {
						var S = h1();
						return Wr(n + S * (l - n + uD("1e-" + ((S + "").length - 1))), l);
					}
					return cx(n, l);
				}
				var N8 = Ds(function (n, l, p) {
					return (l = l.toLowerCase()), n + (p ? VS(l) : l);
				});
				function VS(n) {
					return Ox(ht(n).toLowerCase());
				}
				function XS(n) {
					return (n = ht(n)), n && n.replace(FR, CD).replace(rD, "");
				}
				function O8(n, l, p) {
					(n = ht(n)), (l = Bo(l));
					var x = n.length;
					p = p === e ? x : pl(Ue(p), 0, x);
					var S = p;
					return (p -= l.length), p >= 0 && n.slice(p, S) == l;
				}
				function F8(n) {
					return (n = ht(n)), n && bR.test(n) ? n.replace(Cw, ID) : n;
				}
				function B8(n) {
					return (n = ht(n)), n && SR.test(n) ? n.replace(Mb, "\\$&") : n;
				}
				var z8 = Ds(function (n, l, p) {
						return n + (p ? "-" : "") + l.toLowerCase();
					}),
					$8 = Ds(function (n, l, p) {
						return n + (p ? " " : "") + l.toLowerCase();
					}),
					H8 = j1("toLowerCase");
				function U8(n, l, p) {
					(n = ht(n)), (l = Ue(l));
					var x = l ? As(n) : 0;
					if (!l || x >= l) return n;
					var S = (l - x) / 2;
					return Ju($u(S), p) + n + Ju(zu(S), p);
				}
				function G8(n, l, p) {
					(n = ht(n)), (l = Ue(l));
					var x = l ? As(n) : 0;
					return l && x < l ? n + Ju(l - x, p) : n;
				}
				function W8(n, l, p) {
					(n = ht(n)), (l = Ue(l));
					var x = l ? As(n) : 0;
					return l && x < l ? Ju(l - x, p) + n : n;
				}
				function K8(n, l, p) {
					return (
						p || l == null ? (l = 0) : l && (l = +l),
						QD(ht(n).replace(Pb, ""), l || 0)
					);
				}
				function Y8(n, l, p) {
					return (
						(p ? no(n, l, p) : l === e) ? (l = 1) : (l = Ue(l)), dx(ht(n), l)
					);
				}
				function V8() {
					var n = arguments,
						l = ht(n[0]);
					return n.length < 3 ? l : l.replace(n[1], n[2]);
				}
				var X8 = Ds(function (n, l, p) {
					return n + (p ? "_" : "") + l.toLowerCase();
				});
				function Z8(n, l, p) {
					return (
						p && typeof p != "number" && no(n, l, p) && (l = p = e),
						(p = p === e ? fe : p >>> 0),
						p
							? ((n = ht(n)),
								n &&
								(typeof l == "string" || (l != null && !Rx(l))) &&
								((l = Bo(l)), !l && _s(n))
									? ga(Ln(n), 0, p)
									: n.split(l, p))
							: []
					);
				}
				var q8 = Ds(function (n, l, p) {
					return n + (p ? " " : "") + Ox(l);
				});
				function j8(n, l, p) {
					return (
						(n = ht(n)),
						(p = p == null ? 0 : pl(Ue(p), 0, n.length)),
						(l = Bo(l)),
						n.slice(p, p + l.length) == l
					);
				}
				function Q8(n, l, p) {
					var x = A.templateSettings;
					p && no(n, l, p) && (l = e), (n = ht(n)), (l = mp({}, l, x, nS));
					var S = mp({}, l.imports, x.imports, nS),
						L = _r(S),
						O = Vb(S, L),
						z,
						U,
						oe = 0,
						ne = l.interpolate || Tu,
						de = "__p += '",
						be = Zb(
							(l.escape || Tu).source +
								"|" +
								ne.source +
								"|" +
								(ne === Iw ? MR : Tu).source +
								"|" +
								(l.evaluate || Tu).source +
								"|$",
							"g",
						),
						Ce =
							"//# sourceURL=" +
							(vt.call(l, "sourceURL")
								? (l.sourceURL + "").replace(/\s/g, " ")
								: "lodash.templateSources[" + ++lD + "]") +
							`
`;
					n.replace(be, function (Oe, Je, it, $o, io, Ho) {
						return (
							it || (it = $o),
							(de += n.slice(oe, Ho).replace(BR, _D)),
							Je &&
								((z = !0),
								(de +=
									`' +
__e(` +
									Je +
									`) +
'`)),
							io &&
								((U = !0),
								(de +=
									`';
` +
									io +
									`;
__p += '`)),
							it &&
								(de +=
									`' +
((__t = (` +
									it +
									`)) == null ? '' : __t) +
'`),
							(oe = Ho + Oe.length),
							Oe
						);
					}),
						(de += `';
`);
					var Ne = vt.call(l, "variable") && l.variable;
					if (!Ne)
						de =
							`with (obj) {
` +
							de +
							`
}
`;
					else if (kR.test(Ne)) throw new ze(a);
					(de = (U ? de.replace(pR, "") : de)
						.replace(fR, "$1")
						.replace(gR, "$1;")),
						(de =
							"function(" +
							(Ne || "obj") +
							`) {
` +
							(Ne
								? ""
								: `obj || (obj = {});
`) +
							"var __t, __p = ''" +
							(z ? ", __e = _.escape" : "") +
							(U
								? `, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`
								: `;
`) +
							de +
							`return __p
}`);
					var Ke = qS(function () {
						return ut(L, Ce + "return " + de).apply(e, O);
					});
					if (((Ke.source = de), Px(Ke))) throw Ke;
					return Ke;
				}
				function J8(n) {
					return ht(n).toLowerCase();
				}
				function e7(n) {
					return ht(n).toUpperCase();
				}
				function t7(n, l, p) {
					if (((n = ht(n)), n && (p || l === e))) return i1(n);
					if (!n || !(l = Bo(l))) return n;
					var x = Ln(n),
						S = Ln(l),
						L = a1(x, S),
						O = l1(x, S) + 1;
					return ga(x, L, O).join("");
				}
				function r7(n, l, p) {
					if (((n = ht(n)), n && (p || l === e))) return n.slice(0, c1(n) + 1);
					if (!n || !(l = Bo(l))) return n;
					var x = Ln(n),
						S = l1(x, Ln(l)) + 1;
					return ga(x, 0, S).join("");
				}
				function o7(n, l, p) {
					if (((n = ht(n)), n && (p || l === e))) return n.replace(Pb, "");
					if (!n || !(l = Bo(l))) return n;
					var x = Ln(n),
						S = a1(x, Ln(l));
					return ga(x, S).join("");
				}
				function n7(n, l) {
					var p = F,
						x = W;
					if (Kt(l)) {
						var S = "separator" in l ? l.separator : S;
						(p = "length" in l ? Ue(l.length) : p),
							(x = "omission" in l ? Bo(l.omission) : x);
					}
					n = ht(n);
					var L = n.length;
					if (_s(n)) {
						var O = Ln(n);
						L = O.length;
					}
					if (p >= L) return n;
					var z = p - As(x);
					if (z < 1) return x;
					var U = O ? ga(O, 0, z).join("") : n.slice(0, z);
					if (S === e) return U + x;
					if ((O && (z += U.length - z), Rx(S))) {
						if (n.slice(z).search(S)) {
							var oe,
								ne = U;
							for (
								S.global || (S = Zb(S.source, ht(_w.exec(S)) + "g")),
									S.lastIndex = 0;
								(oe = S.exec(ne));
							)
								var de = oe.index;
							U = U.slice(0, de === e ? z : de);
						}
					} else if (n.indexOf(Bo(S), z) != z) {
						var be = U.lastIndexOf(S);
						be > -1 && (U = U.slice(0, be));
					}
					return U + x;
				}
				function i7(n) {
					return (n = ht(n)), n && hR.test(n) ? n.replace(Tw, DD) : n;
				}
				var a7 = Ds(function (n, l, p) {
						return n + (p ? " " : "") + l.toUpperCase();
					}),
					Ox = j1("toUpperCase");
				function ZS(n, l, p) {
					return (
						(n = ht(n)),
						(l = p ? e : l),
						l === e ? (kD(n) ? FD(n) : ED(n)) : n.match(l) || []
					);
				}
				var qS = Xe(function (n, l) {
						try {
							return Oo(n, e, l);
						} catch (p) {
							return Px(p) ? p : new ze(p);
						}
					}),
					l7 = Ii(function (n, l) {
						return (
							en(l, function (p) {
								(p = oi(p)), Ti(n, p, Lx(n[p], n));
							}),
							n
						);
					});
				function s7(n) {
					var l = n == null ? 0 : n.length,
						p = Re();
					return (
						(n = l
							? Gt(n, function (x) {
									if (typeof x[1] != "function") throw new tn(i);
									return [p(x[0]), x[1]];
								})
							: []),
						Xe(function (x) {
							for (var S = -1; ++S < l; ) {
								var L = n[S];
								if (Oo(L[0], this, x)) return Oo(L[1], this, x);
							}
						})
					);
				}
				function c7(n) {
					return D6(on(n, u));
				}
				function Fx(n) {
					return function () {
						return n;
					};
				}
				function d7(n, l) {
					return n == null || n !== n ? l : n;
				}
				var m7 = J1(),
					u7 = J1(!0);
				function So(n) {
					return n;
				}
				function Bx(n) {
					return k1(typeof n == "function" ? n : on(n, u));
				}
				function p7(n) {
					return M1(on(n, u));
				}
				function f7(n, l) {
					return P1(n, on(l, u));
				}
				var g7 = Xe(function (n, l) {
						return function (p) {
							return Od(p, n, l);
						};
					}),
					h7 = Xe(function (n, l) {
						return function (p) {
							return Od(n, p, l);
						};
					});
				function zx(n, l, p) {
					var x = _r(l),
						S = Yu(l, x);
					p == null &&
						!(Kt(l) && (S.length || !x.length)) &&
						((p = l), (l = n), (n = this), (S = Yu(l, _r(l))));
					var L = !(Kt(p) && "chain" in p) || !!p.chain,
						O = Ai(n);
					return (
						en(S, function (z) {
							var U = l[z];
							(n[z] = U),
								O &&
									(n.prototype[z] = function () {
										var oe = this.__chain__;
										if (L || oe) {
											var ne = n(this.__wrapped__),
												de = (ne.__actions__ = Eo(this.__actions__));
											return (
												de.push({ func: U, args: arguments, thisArg: n }),
												(ne.__chain__ = oe),
												ne
											);
										}
										return U.apply(n, sa([this.value()], arguments));
									});
						}),
						n
					);
				}
				function b7() {
					return Ir._ === this && (Ir._ = GD), this;
				}
				function $x() {}
				function x7(n) {
					return (
						(n = Ue(n)),
						Xe(function (l) {
							return R1(l, n);
						})
					);
				}
				var v7 = bx(Gt),
					E7 = bx(e1),
					y7 = bx(Ub);
				function jS(n) {
					return Tx(n) ? Gb(oi(n)) : j6(n);
				}
				function w7(n) {
					return function (l) {
						return n == null ? e : fl(n, l);
					};
				}
				var S7 = tS(),
					T7 = tS(!0);
				function Hx() {
					return [];
				}
				function Ux() {
					return !1;
				}
				function C7() {
					return {};
				}
				function I7() {
					return "";
				}
				function _7() {
					return !0;
				}
				function A7(n, l) {
					if (((n = Ue(n)), n < 1 || n > se)) return [];
					var p = fe,
						x = Wr(n, fe);
					(l = Re(l)), (n -= fe);
					for (var S = Yb(x, l); ++p < n; ) l(p);
					return S;
				}
				function k7(n) {
					return He(n) ? Gt(n, oi) : zo(n) ? [n] : Eo(bS(ht(n)));
				}
				function L7(n) {
					var l = ++HD;
					return ht(n) + l;
				}
				var M7 = Qu(function (n, l) {
						return n + l;
					}, 0),
					P7 = xx("ceil"),
					R7 = Qu(function (n, l) {
						return n / l;
					}, 1),
					D7 = xx("floor");
				function N7(n) {
					return n && n.length ? Ku(n, So, ox) : e;
				}
				function O7(n, l) {
					return n && n.length ? Ku(n, Re(l, 2), ox) : e;
				}
				function F7(n) {
					return o1(n, So);
				}
				function B7(n, l) {
					return o1(n, Re(l, 2));
				}
				function z7(n) {
					return n && n.length ? Ku(n, So, lx) : e;
				}
				function $7(n, l) {
					return n && n.length ? Ku(n, Re(l, 2), lx) : e;
				}
				var H7 = Qu(function (n, l) {
						return n * l;
					}, 1),
					U7 = xx("round"),
					G7 = Qu(function (n, l) {
						return n - l;
					}, 0);
				function W7(n) {
					return n && n.length ? Kb(n, So) : 0;
				}
				function K7(n, l) {
					return n && n.length ? Kb(n, Re(l, 2)) : 0;
				}
				return (
					(A.after = pO),
					(A.ary = AS),
					(A.assign = e8),
					(A.assignIn = US),
					(A.assignInWith = mp),
					(A.assignWith = t8),
					(A.at = r8),
					(A.before = kS),
					(A.bind = Lx),
					(A.bindAll = l7),
					(A.bindKey = LS),
					(A.castArray = CO),
					(A.chain = CS),
					(A.chunk = D4),
					(A.compact = N4),
					(A.concat = O4),
					(A.cond = s7),
					(A.conforms = c7),
					(A.constant = Fx),
					(A.countBy = WN),
					(A.create = o8),
					(A.curry = MS),
					(A.curryRight = PS),
					(A.debounce = RS),
					(A.defaults = n8),
					(A.defaultsDeep = i8),
					(A.defer = fO),
					(A.delay = gO),
					(A.difference = F4),
					(A.differenceBy = B4),
					(A.differenceWith = z4),
					(A.drop = $4),
					(A.dropRight = H4),
					(A.dropRightWhile = U4),
					(A.dropWhile = G4),
					(A.fill = W4),
					(A.filter = YN),
					(A.flatMap = ZN),
					(A.flatMapDeep = qN),
					(A.flatMapDepth = jN),
					(A.flatten = yS),
					(A.flattenDeep = K4),
					(A.flattenDepth = Y4),
					(A.flip = hO),
					(A.flow = m7),
					(A.flowRight = u7),
					(A.fromPairs = V4),
					(A.functions = u8),
					(A.functionsIn = p8),
					(A.groupBy = QN),
					(A.initial = Z4),
					(A.intersection = q4),
					(A.intersectionBy = j4),
					(A.intersectionWith = Q4),
					(A.invert = g8),
					(A.invertBy = h8),
					(A.invokeMap = eO),
					(A.iteratee = Bx),
					(A.keyBy = tO),
					(A.keys = _r),
					(A.keysIn = wo),
					(A.map = ip),
					(A.mapKeys = x8),
					(A.mapValues = v8),
					(A.matches = p7),
					(A.matchesProperty = f7),
					(A.memoize = lp),
					(A.merge = E8),
					(A.mergeWith = GS),
					(A.method = g7),
					(A.methodOf = h7),
					(A.mixin = zx),
					(A.negate = sp),
					(A.nthArg = x7),
					(A.omit = y8),
					(A.omitBy = w8),
					(A.once = bO),
					(A.orderBy = rO),
					(A.over = v7),
					(A.overArgs = xO),
					(A.overEvery = E7),
					(A.overSome = y7),
					(A.partial = Mx),
					(A.partialRight = DS),
					(A.partition = oO),
					(A.pick = S8),
					(A.pickBy = WS),
					(A.property = jS),
					(A.propertyOf = w7),
					(A.pull = rN),
					(A.pullAll = SS),
					(A.pullAllBy = oN),
					(A.pullAllWith = nN),
					(A.pullAt = iN),
					(A.range = S7),
					(A.rangeRight = T7),
					(A.rearg = vO),
					(A.reject = aO),
					(A.remove = aN),
					(A.rest = EO),
					(A.reverse = Ax),
					(A.sampleSize = sO),
					(A.set = C8),
					(A.setWith = I8),
					(A.shuffle = cO),
					(A.slice = lN),
					(A.sortBy = uO),
					(A.sortedUniq = fN),
					(A.sortedUniqBy = gN),
					(A.split = Z8),
					(A.spread = yO),
					(A.tail = hN),
					(A.take = bN),
					(A.takeRight = xN),
					(A.takeRightWhile = vN),
					(A.takeWhile = EN),
					(A.tap = NN),
					(A.throttle = wO),
					(A.thru = np),
					(A.toArray = zS),
					(A.toPairs = KS),
					(A.toPairsIn = YS),
					(A.toPath = k7),
					(A.toPlainObject = HS),
					(A.transform = _8),
					(A.unary = SO),
					(A.union = yN),
					(A.unionBy = wN),
					(A.unionWith = SN),
					(A.uniq = TN),
					(A.uniqBy = CN),
					(A.uniqWith = IN),
					(A.unset = A8),
					(A.unzip = kx),
					(A.unzipWith = TS),
					(A.update = k8),
					(A.updateWith = L8),
					(A.values = Fs),
					(A.valuesIn = M8),
					(A.without = _N),
					(A.words = ZS),
					(A.wrap = TO),
					(A.xor = AN),
					(A.xorBy = kN),
					(A.xorWith = LN),
					(A.zip = MN),
					(A.zipObject = PN),
					(A.zipObjectDeep = RN),
					(A.zipWith = DN),
					(A.entries = KS),
					(A.entriesIn = YS),
					(A.extend = US),
					(A.extendWith = mp),
					zx(A, A),
					(A.add = M7),
					(A.attempt = qS),
					(A.camelCase = N8),
					(A.capitalize = VS),
					(A.ceil = P7),
					(A.clamp = P8),
					(A.clone = IO),
					(A.cloneDeep = AO),
					(A.cloneDeepWith = kO),
					(A.cloneWith = _O),
					(A.conformsTo = LO),
					(A.deburr = XS),
					(A.defaultTo = d7),
					(A.divide = R7),
					(A.endsWith = O8),
					(A.eq = Pn),
					(A.escape = F8),
					(A.escapeRegExp = B8),
					(A.every = KN),
					(A.find = VN),
					(A.findIndex = vS),
					(A.findKey = a8),
					(A.findLast = XN),
					(A.findLastIndex = ES),
					(A.findLastKey = l8),
					(A.floor = D7),
					(A.forEach = IS),
					(A.forEachRight = _S),
					(A.forIn = s8),
					(A.forInRight = c8),
					(A.forOwn = d8),
					(A.forOwnRight = m8),
					(A.get = Dx),
					(A.gt = MO),
					(A.gte = PO),
					(A.has = f8),
					(A.hasIn = Nx),
					(A.head = wS),
					(A.identity = So),
					(A.includes = JN),
					(A.indexOf = X4),
					(A.inRange = R8),
					(A.invoke = b8),
					(A.isArguments = bl),
					(A.isArray = He),
					(A.isArrayBuffer = RO),
					(A.isArrayLike = yo),
					(A.isArrayLikeObject = nr),
					(A.isBoolean = DO),
					(A.isBuffer = ha),
					(A.isDate = NO),
					(A.isElement = OO),
					(A.isEmpty = FO),
					(A.isEqual = BO),
					(A.isEqualWith = zO),
					(A.isError = Px),
					(A.isFinite = $O),
					(A.isFunction = Ai),
					(A.isInteger = NS),
					(A.isLength = cp),
					(A.isMap = OS),
					(A.isMatch = HO),
					(A.isMatchWith = UO),
					(A.isNaN = GO),
					(A.isNative = WO),
					(A.isNil = YO),
					(A.isNull = KO),
					(A.isNumber = FS),
					(A.isObject = Kt),
					(A.isObjectLike = qt),
					(A.isPlainObject = Ud),
					(A.isRegExp = Rx),
					(A.isSafeInteger = VO),
					(A.isSet = BS),
					(A.isString = dp),
					(A.isSymbol = zo),
					(A.isTypedArray = Os),
					(A.isUndefined = XO),
					(A.isWeakMap = ZO),
					(A.isWeakSet = qO),
					(A.join = J4),
					(A.kebabCase = z8),
					(A.last = an),
					(A.lastIndexOf = eN),
					(A.lowerCase = $8),
					(A.lowerFirst = H8),
					(A.lt = jO),
					(A.lte = QO),
					(A.max = N7),
					(A.maxBy = O7),
					(A.mean = F7),
					(A.meanBy = B7),
					(A.min = z7),
					(A.minBy = $7),
					(A.stubArray = Hx),
					(A.stubFalse = Ux),
					(A.stubObject = C7),
					(A.stubString = I7),
					(A.stubTrue = _7),
					(A.multiply = H7),
					(A.nth = tN),
					(A.noConflict = b7),
					(A.noop = $x),
					(A.now = ap),
					(A.pad = U8),
					(A.padEnd = G8),
					(A.padStart = W8),
					(A.parseInt = K8),
					(A.random = D8),
					(A.reduce = nO),
					(A.reduceRight = iO),
					(A.repeat = Y8),
					(A.replace = V8),
					(A.result = T8),
					(A.round = U7),
					(A.runInContext = $),
					(A.sample = lO),
					(A.size = dO),
					(A.snakeCase = X8),
					(A.some = mO),
					(A.sortedIndex = sN),
					(A.sortedIndexBy = cN),
					(A.sortedIndexOf = dN),
					(A.sortedLastIndex = mN),
					(A.sortedLastIndexBy = uN),
					(A.sortedLastIndexOf = pN),
					(A.startCase = q8),
					(A.startsWith = j8),
					(A.subtract = G7),
					(A.sum = W7),
					(A.sumBy = K7),
					(A.template = Q8),
					(A.times = A7),
					(A.toFinite = ki),
					(A.toInteger = Ue),
					(A.toLength = $S),
					(A.toLower = J8),
					(A.toNumber = ln),
					(A.toSafeInteger = JO),
					(A.toString = ht),
					(A.toUpper = e7),
					(A.trim = t7),
					(A.trimEnd = r7),
					(A.trimStart = o7),
					(A.truncate = n7),
					(A.unescape = i7),
					(A.uniqueId = L7),
					(A.upperCase = a7),
					(A.upperFirst = Ox),
					(A.each = IS),
					(A.eachRight = _S),
					(A.first = wS),
					zx(
						A,
						(function () {
							var n = {};
							return (
								ti(A, function (l, p) {
									vt.call(A.prototype, p) || (n[p] = l);
								}),
								n
							);
						})(),
						{ chain: !1 },
					),
					(A.VERSION = t),
					en(
						[
							"bind",
							"bindKey",
							"curry",
							"curryRight",
							"partial",
							"partialRight",
						],
						function (n) {
							A[n].placeholder = A;
						},
					),
					en(["drop", "take"], function (n, l) {
						(rt.prototype[n] = function (p) {
							p = p === e ? 1 : xr(Ue(p), 0);
							var x = this.__filtered__ && !l ? new rt(this) : this.clone();
							return (
								x.__filtered__
									? (x.__takeCount__ = Wr(p, x.__takeCount__))
									: x.__views__.push({
											size: Wr(p, fe),
											type: n + (x.__dir__ < 0 ? "Right" : ""),
										}),
								x
							);
						}),
							(rt.prototype[n + "Right"] = function (p) {
								return this.reverse()[n](p).reverse();
							});
					}),
					en(["filter", "map", "takeWhile"], function (n, l) {
						var p = l + 1,
							x = p == ie || p == we;
						rt.prototype[n] = function (S) {
							var L = this.clone();
							return (
								L.__iteratees__.push({ iteratee: Re(S, 3), type: p }),
								(L.__filtered__ = L.__filtered__ || x),
								L
							);
						};
					}),
					en(["head", "last"], function (n, l) {
						var p = "take" + (l ? "Right" : "");
						rt.prototype[n] = function () {
							return this[p](1).value()[0];
						};
					}),
					en(["initial", "tail"], function (n, l) {
						var p = "drop" + (l ? "" : "Right");
						rt.prototype[n] = function () {
							return this.__filtered__ ? new rt(this) : this[p](1);
						};
					}),
					(rt.prototype.compact = function () {
						return this.filter(So);
					}),
					(rt.prototype.find = function (n) {
						return this.filter(n).head();
					}),
					(rt.prototype.findLast = function (n) {
						return this.reverse().find(n);
					}),
					(rt.prototype.invokeMap = Xe(function (n, l) {
						return typeof n == "function"
							? new rt(this)
							: this.map(function (p) {
									return Od(p, n, l);
								});
					})),
					(rt.prototype.reject = function (n) {
						return this.filter(sp(Re(n)));
					}),
					(rt.prototype.slice = function (n, l) {
						n = Ue(n);
						var p = this;
						return p.__filtered__ && (n > 0 || l < 0)
							? new rt(p)
							: (n < 0 ? (p = p.takeRight(-n)) : n && (p = p.drop(n)),
								l !== e &&
									((l = Ue(l)), (p = l < 0 ? p.dropRight(-l) : p.take(l - n))),
								p);
					}),
					(rt.prototype.takeRightWhile = function (n) {
						return this.reverse().takeWhile(n).reverse();
					}),
					(rt.prototype.toArray = function () {
						return this.take(fe);
					}),
					ti(rt.prototype, function (n, l) {
						var p = /^(?:filter|find|map|reject)|While$/.test(l),
							x = /^(?:head|last)$/.test(l),
							S = A[x ? "take" + (l == "last" ? "Right" : "") : l],
							L = x || /^find/.test(l);
						S &&
							(A.prototype[l] = function () {
								var O = this.__wrapped__,
									z = x ? [1] : arguments,
									U = O instanceof rt,
									oe = z[0],
									ne = U || He(O),
									de = function (Je) {
										var it = S.apply(A, sa([Je], z));
										return x && be ? it[0] : it;
									};
								ne &&
									p &&
									typeof oe == "function" &&
									oe.length != 1 &&
									(U = ne = !1);
								var be = this.__chain__,
									Ce = !!this.__actions__.length,
									Ne = L && !be,
									Ke = U && !Ce;
								if (!L && ne) {
									O = Ke ? O : new rt(this);
									var Oe = n.apply(O, z);
									return (
										Oe.__actions__.push({ func: np, args: [de], thisArg: e }),
										new rn(Oe, be)
									);
								}
								return Ne && Ke
									? n.apply(this, z)
									: ((Oe = this.thru(de)),
										Ne ? (x ? Oe.value()[0] : Oe.value()) : Oe);
							});
					}),
					en(
						["pop", "push", "shift", "sort", "splice", "unshift"],
						function (n) {
							var l = Lu[n],
								p = /^(?:push|sort|unshift)$/.test(n) ? "tap" : "thru",
								x = /^(?:pop|shift)$/.test(n);
							A.prototype[n] = function () {
								var S = arguments;
								if (x && !this.__chain__) {
									var L = this.value();
									return l.apply(He(L) ? L : [], S);
								}
								return this[p](function (O) {
									return l.apply(He(O) ? O : [], S);
								});
							};
						},
					),
					ti(rt.prototype, function (n, l) {
						var p = A[l];
						if (p) {
							var x = p.name + "";
							vt.call(Ms, x) || (Ms[x] = []), Ms[x].push({ name: l, func: p });
						}
					}),
					(Ms[ju(e, E).name] = [{ name: "wrapper", func: e }]),
					(rt.prototype.clone = i6),
					(rt.prototype.reverse = a6),
					(rt.prototype.value = l6),
					(A.prototype.at = ON),
					(A.prototype.chain = FN),
					(A.prototype.commit = BN),
					(A.prototype.next = zN),
					(A.prototype.plant = HN),
					(A.prototype.reverse = UN),
					(A.prototype.toJSON = A.prototype.valueOf = A.prototype.value = GN),
					(A.prototype.first = A.prototype.head),
					kd && (A.prototype[kd] = $N),
					A
				);
			},
			da = BD();
		typeof define == "function" && typeof define.amd == "object" && define.amd
			? ((Ir._ = da),
				define(function () {
					return da;
				}))
			: cl
				? (((cl.exports = da)._ = da), (Bb._ = da))
				: (Ir._ = da);
	}).call(fd);
});
b();
var vb = w(Q(), 1);
b();
var Jf = w(Q(), 1);
b();
b();
b();
b();
var ar = w(Q(), 1);
b();
var e9 = 0;
function G_(e, t) {
	let r = `atom${++e9}`,
		o = { toString: () => r };
	return (
		typeof e == "function"
			? (o.read = e)
			: ((o.init = e),
				(o.read = (i) => i(o)),
				(o.write = (i, a, s) => a(o, typeof s == "function" ? s(i(o)) : s))),
		t && (o.write = t),
		o
	);
}
var Pa = Symbol(),
	fE = (e) => !!e[Pa],
	Hf = (e) => !e[Pa].c,
	bm = (e) => {
		var t;
		let { b: r, c: o } = e[Pa];
		o && (o(), (t = r9.get(r)) == null || t());
	},
	Gf = (e, t) => {
		let r = e[Pa].o,
			o = t[Pa].o;
		return r === o || e === o || (fE(r) && Gf(r, t));
	},
	gE = (e, t) => {
		let r = { b: e, o: t, c: null },
			o = new Promise((i) => {
				(r.c = () => {
					(r.c = null), i();
				}),
					t.finally(r.c);
			});
		return (o[Pa] = r), o;
	},
	t9 = (e) => gE(e[Pa].b, e[Pa].o),
	r9 = new WeakMap();
var Uf = (e) => "init" in e,
	xm = "r",
	Wf = "w",
	vm = "c",
	Kf = "s",
	W_ = "h",
	o9 = "n",
	n9 = "l",
	i9 = "a",
	a9 = "m",
	K_ = (e) => {
		let t = new WeakMap(),
			r = new WeakMap(),
			o = new Map(),
			i,
			a;
		if (
			((_ && _.MODE) !== "production" && ((i = new Set()), (a = new Set())), e)
		)
			for (let [Y, K] of e) {
				let ee = { v: K, r: 0, y: !0, d: new Map() };
				(_ && _.MODE) !== "production" &&
					(Object.freeze(ee),
					Uf(Y) ||
						console.warn(
							"Found initial value for derived atom which can cause unexpected behavior",
							Y,
						)),
					t.set(Y, ee);
			}
		let s = new WeakMap(),
			c = (Y, K, ee) => {
				let le = s.get(K);
				le || ((le = new Map()), s.set(K, le)),
					ee.then(() => {
						le.get(Y) === ee && (le.delete(Y), le.size || s.delete(K));
					}),
					le.set(Y, ee);
			},
			d = (Y) => {
				let K = new Set(),
					ee = s.get(Y);
				return (
					ee &&
						(s.delete(Y),
						ee.forEach((le, ce) => {
							bm(le), K.add(ce);
						})),
					K
				);
			},
			u = new WeakMap(),
			f = (Y) => {
				let K = u.get(Y);
				return K || ((K = new Map()), u.set(Y, K)), K;
			},
			m = (Y, K) => {
				if (Y) {
					let ee = f(Y),
						le = ee.get(K);
					return (
						le ||
							((le = m(Y.p, K)),
							le && "p" in le && Hf(le.p) && (le = void 0),
							le && ee.set(K, le)),
						le
					);
				}
				return t.get(K);
			},
			g = (Y, K, ee) => {
				if (((_ && _.MODE) !== "production" && Object.freeze(ee), Y))
					f(Y).set(K, ee);
				else {
					let le = t.get(K);
					t.set(K, ee), o.has(K) || o.set(K, le);
				}
			},
			h = (Y, K = new Map(), ee) => {
				if (!ee) return K;
				let le = new Map(),
					ce = !1;
				return (
					ee.forEach((ue) => {
						var ge;
						let Se = ((ge = m(Y, ue)) == null ? void 0 : ge.r) || 0;
						le.set(ue, Se), K.get(ue) !== Se && (ce = !0);
					}),
					K.size === le.size && !ce ? K : le
				);
			},
			y = (Y, K, ee, le, ce) => {
				let ue = m(Y, K);
				if (ue) {
					if (ce && (!("p" in ue) || !Gf(ue.p, ce))) return ue;
					"p" in ue && bm(ue.p);
				}
				let ge = { v: ee, r: ue?.r || 0, y: !0, d: h(Y, ue?.d, le) },
					Se = !ue?.y;
				return (
					!ue || !("v" in ue) || !Object.is(ue.v, ee)
						? ((Se = !0),
							++ge.r,
							ge.d.has(K) && (ge.d = new Map(ge.d).set(K, ge.r)))
						: ge.d !== ue.d &&
							(ge.d.size !== ue.d.size ||
								!Array.from(ge.d.keys()).every((Dt) => ue.d.has(Dt))) &&
							((Se = !0),
							Promise.resolve().then(() => {
								X(Y);
							})),
					ue && !Se ? ue : (g(Y, K, ge), ge)
				);
			},
			E = (Y, K, ee, le, ce) => {
				let ue = m(Y, K);
				if (ue) {
					if (ce && (!("p" in ue) || !Gf(ue.p, ce))) return ue;
					"p" in ue && bm(ue.p);
				}
				let ge = { e: ee, r: (ue?.r || 0) + 1, y: !0, d: h(Y, ue?.d, le) };
				return g(Y, K, ge), ge;
			},
			T = (Y, K, ee, le) => {
				let ce = m(Y, K);
				if (ce && "p" in ce) {
					if (Gf(ce.p, ee) && !Hf(ce.p)) return ce.y ? ce : { ...ce, y: !0 };
					bm(ce.p);
				}
				c(Y, K, ee);
				let ue = { p: ee, r: (ce?.r || 0) + 1, y: !0, d: h(Y, ce?.d, le) };
				return g(Y, K, ue), ue;
			},
			I = (Y, K, ee, le) => {
				if (ee instanceof Promise) {
					let ce = gE(
						ee,
						ee
							.then((ue) => {
								y(Y, K, ue, le, ce);
							})
							.catch((ue) => {
								if (ue instanceof Promise)
									return fE(ue)
										? ue.then(() => {
												C(Y, K, !0);
											})
										: ue;
								E(Y, K, ue, le, ce);
							}),
					);
					return T(Y, K, ce, le);
				}
				return y(Y, K, ee, le);
			},
			P = (Y, K) => {
				let ee = m(Y, K);
				if (ee) {
					let le = { ...ee, y: !1 };
					g(Y, K, le);
				} else
					(_ && _.MODE) !== "production" &&
						console.warn("[Bug] could not invalidate non existing atom", K);
			},
			C = (Y, K, ee) => {
				if (!ee) {
					let ce = m(Y, K);
					if (ce) {
						if (ce.y && "p" in ce && !Hf(ce.p)) return ce;
						if (
							(ce.d.forEach((ue, ge) => {
								if (ge !== K)
									if (!r.has(ge)) C(Y, ge);
									else {
										let Se = m(Y, ge);
										Se && !Se.y && C(Y, ge);
									}
							}),
							Array.from(ce.d).every(([ue, ge]) => {
								let Se = m(Y, ue);
								return Se && !("p" in Se) && Se.r === ge;
							}))
						)
							return ce.y ? ce : { ...ce, y: !0 };
					}
				}
				let le = new Set();
				try {
					let ce = K.read((ue) => {
						le.add(ue);
						let ge = ue === K ? m(Y, ue) : C(Y, ue);
						if (ge) {
							if ("e" in ge) throw ge.e;
							if ("p" in ge) throw ge.p;
							return ge.v;
						}
						if (Uf(ue)) return ue.init;
						throw new Error("no atom init");
					});
					return I(Y, K, ce, le);
				} catch (ce) {
					if (ce instanceof Promise) {
						let ue = fE(ce) && Hf(ce) ? t9(ce) : gE(ce, ce);
						return T(Y, K, ue, le);
					}
					return E(Y, K, ce, le);
				}
			},
			k = (Y, K) => C(K, Y),
			N = (Y, K) => {
				let ee = r.get(K);
				return ee || (ee = ie(Y, K)), ee;
			},
			D = (Y, K) => !K.l.size && (!K.t.size || (K.t.size === 1 && K.t.has(Y))),
			B = (Y, K) => {
				let ee = r.get(K);
				ee && D(K, ee) && te(Y, K);
			},
			F = (Y, K) => {
				let ee = r.get(K);
				ee?.t.forEach((le) => {
					le !== K && (P(Y, le), F(Y, le));
				});
			},
			W = (Y, K, ee) => {
				let le = !0,
					ce = (Se, Dt) => {
						let St = C(Y, Se);
						if ("e" in St) throw St.e;
						if ("p" in St) {
							if (Dt?.unstable_promise)
								return St.p.then(() => {
									let _t = m(Y, Se);
									return _t && "p" in _t && _t.p === St.p
										? new Promise((Tt) => setTimeout(Tt)).then(() => ce(Se, Dt))
										: ce(Se, Dt);
								});
							throw (
								((_ && _.MODE) !== "production" &&
									console.info(
										"Reading pending atom state in write operation. We throw a promise for now.",
										Se,
									),
								St.p)
							);
						}
						if ("v" in St) return St.v;
						throw (
							((_ && _.MODE) !== "production" &&
								console.warn(
									"[Bug] no value found while reading atom in write operation. This is probably a bug.",
									Se,
								),
							new Error("no value found"))
						);
					},
					ue = (Se, Dt) => {
						let St;
						if (Se === K) {
							if (!Uf(Se)) throw new Error("atom not writable");
							d(Se).forEach((Do) => {
								Do !== Y && I(Do, Se, Dt);
							});
							let Tt = m(Y, Se),
								cr = I(Y, Se, Dt);
							Tt !== cr && F(Y, Se);
						} else St = W(Y, Se, Dt);
						return le || X(Y), St;
					},
					ge = K.write(ce, ue, ee);
				return (le = !1), ge;
			},
			G = (Y, K, ee) => {
				let le = W(ee, Y, K);
				return X(ee), le;
			},
			q = (Y) => !!Y.write,
			ie = (Y, K, ee) => {
				let le = { t: new Set(ee && [ee]), l: new Set() };
				if (
					(r.set(K, le),
					(_ && _.MODE) !== "production" && a.add(K),
					C(void 0, K).d.forEach((ue, ge) => {
						let Se = r.get(ge);
						Se ? Se.t.add(K) : ge !== K && ie(Y, ge, K);
					}),
					q(K) && K.onMount)
				) {
					let ue = (Se) => G(K, Se, Y),
						ge = K.onMount(ue);
					(Y = void 0), ge && (le.u = ge);
				}
				return le;
			},
			te = (Y, K) => {
				var ee;
				let le = (ee = r.get(K)) == null ? void 0 : ee.u;
				le && le(), r.delete(K), (_ && _.MODE) !== "production" && a.delete(K);
				let ce = m(Y, K);
				ce
					? ("p" in ce && bm(ce.p),
						ce.d.forEach((ue, ge) => {
							if (ge !== K) {
								let Se = r.get(ge);
								Se && (Se.t.delete(K), D(ge, Se) && te(Y, ge));
							}
						}))
					: (_ && _.MODE) !== "production" &&
						console.warn("[Bug] could not find atom state to unmount", K);
			},
			we = (Y, K, ee, le) => {
				let ce = new Set(ee.d.keys());
				le?.forEach((ue, ge) => {
					if (ce.has(ge)) {
						ce.delete(ge);
						return;
					}
					let Se = r.get(ge);
					Se && (Se.t.delete(K), D(ge, Se) && te(Y, ge));
				}),
					ce.forEach((ue) => {
						let ge = r.get(ue);
						ge ? ge.t.add(K) : r.has(K) && ie(Y, ue, K);
					});
			},
			X = (Y) => {
				if (Y) {
					f(Y).forEach((ee, le) => {
						let ce = t.get(le);
						if (ee !== ce) {
							let ue = r.get(le);
							ue?.l.forEach((ge) => ge(Y));
						}
					});
					return;
				}
				for (; o.size; ) {
					let K = Array.from(o);
					o.clear(),
						K.forEach(([ee, le]) => {
							let ce = m(void 0, ee);
							if (
								(ce && ce.d !== le?.d && we(void 0, ee, ce, le?.d),
								le && !le.y && ce?.y)
							)
								return;
							let ue = r.get(ee);
							ue?.l.forEach((ge) => ge());
						});
				}
				(_ && _.MODE) !== "production" && i.forEach((K) => K());
			},
			se = (Y) => {
				f(Y).forEach((ee, le) => {
					let ce = t.get(le);
					(!ce ||
						ee.r > ce.r ||
						ee.y !== ce.y ||
						(ee.r === ce.r && ee.d !== ce.d)) &&
						(t.set(le, ee), ee.d !== ce?.d && we(Y, le, ee, ce?.d));
				});
			},
			Pe = (Y, K) => {
				K && se(K), X(void 0);
			},
			ke = (Y, K, ee) => {
				let ce = N(ee, Y).l;
				return (
					ce.add(K),
					() => {
						ce.delete(K), B(ee, Y);
					}
				);
			},
			fe = (Y, K) => {
				for (let [ee, le] of Y) Uf(ee) && (I(K, ee, le), F(K, ee));
				X(K);
			};
		return (_ && _.MODE) !== "production"
			? {
					[xm]: k,
					[Wf]: G,
					[vm]: Pe,
					[Kf]: ke,
					[W_]: fe,
					[o9]: (Y) => (
						i.add(Y),
						() => {
							i.delete(Y);
						}
					),
					[n9]: () => a.values(),
					[i9]: (Y) => t.get(Y),
					[a9]: (Y) => r.get(Y),
				}
			: { [xm]: k, [Wf]: G, [vm]: Pe, [Kf]: ke, [W_]: fe };
	},
	Y_ = (e) => {
		let t = K_(e),
			r = (s) => {
				let c = t[xm](s);
				if ("e" in c) throw c.e;
				if (!("p" in c)) return c.v;
			},
			o = (s) =>
				new Promise((c, d) => {
					let u = t[xm](s);
					"e" in u ? d(u.e) : "p" in u ? c(u.p.then(() => o(s))) : c(u.v);
				});
		return {
			get: r,
			asyncGet: o,
			set: (s, c) => t[Wf](s, c),
			sub: (s, c) => t[Kf](s, c),
			SECRET_INTERNAL_store: t,
		};
	},
	V_ = (e, t) => ({ s: t ? t(e).SECRET_INTERNAL_store : K_(e) }),
	pE = new Map(),
	hE = (e) => (pE.has(e) || pE.set(e, (0, ar.createContext)(V_())), pE.get(e)),
	Yf = ({
		children: e,
		initialValues: t,
		scope: r,
		unstable_createStore: o,
		unstable_enableVersionedWrite: i,
	}) => {
		let [a, s] = (0, ar.useState)({});
		(0, ar.useEffect)(() => {
			let u = c.current;
			u.w && (u.s[vm](null, a), delete a.p, (u.v = a));
		}, [a]);
		let c = (0, ar.useRef)();
		if (!c.current) {
			let u = V_(t, o);
			if (i) {
				let f = 0;
				(u.w = (m) => {
					s((g) => {
						let h = f ? g : { p: g };
						return m(h), h;
					});
				}),
					(u.v = a),
					(u.r = (m) => {
						++f, m(), --f;
					});
			}
			c.current = u;
		}
		let d = hE(r);
		return (0, ar.createElement)(d.Provider, { value: c.current }, e);
	};
function xt(e, t) {
	return G_(e, t);
}
function Em(e, t) {
	let r = hE(t),
		o = (0, ar.useContext)(r),
		{ s: i, v: a } = o,
		s = (g) => {
			let h = i[xm](e, g);
			if ((_ && _.MODE) !== "production" && !h.y)
				throw new Error("should not be invalidated");
			if ("e" in h) throw h.e;
			if ("p" in h) throw h.p;
			if ("v" in h) return h.v;
			throw new Error("no atom value");
		},
		[[c, d, u], f] = (0, ar.useReducer)(
			(g, h) => {
				let y = s(h);
				return Object.is(g[1], y) && g[2] === e ? g : [h, y, e];
			},
			a,
			(g) => {
				let h = s(g);
				return [g, h, e];
			},
		),
		m = d;
	return (
		u !== e && (f(c), (m = s(c))),
		(0, ar.useEffect)(() => {
			let { v: g } = o;
			g && i[vm](e, g);
			let h = i[Kf](e, f, g);
			return f(g), h;
		}, [i, e, o]),
		(0, ar.useEffect)(() => {
			i[vm](e, c);
		}),
		(0, ar.useDebugValue)(m),
		m
	);
}
function Wi(e, t) {
	let r = hE(t),
		{ s: o, w: i } = (0, ar.useContext)(r);
	return (0, ar.useCallback)(
		(s) => {
			if ((_ && _.MODE) !== "production" && !("write" in e))
				throw new Error("not writable atom");
			let c = (d) => o[Wf](e, s, d);
			return i ? i(c) : c();
		},
		[o, i, e],
	);
}
function Ge(e, t) {
	return (
		"scope" in e &&
			(console.warn(
				"atom.scope is deprecated. Please do useAtom(atom, scope) instead.",
			),
			(t = e.scope)),
		[Em(e, t), Wi(e, t)]
	);
}
var l9 = w(Q(), 1),
	lt = Symbol(),
	zr = Y_();
var s9 = JS({
	"./locales/ar-SA.json": () => import("./excalidraw-assets/ar-SA-MV5ZQ2W5.js"),
	"./locales/az-AZ.json": () => import("./excalidraw-assets/az-AZ-BK6PNAXT.js"),
	"./locales/bg-BG.json": () => import("./excalidraw-assets/bg-BG-GCTBXIHZ.js"),
	"./locales/bn-BD.json": () => import("./excalidraw-assets/bn-BD-QTMQMM2A.js"),
	"./locales/ca-ES.json": () => import("./excalidraw-assets/ca-ES-CJKR7U4D.js"),
	"./locales/cs-CZ.json": () => import("./excalidraw-assets/cs-CZ-E6RD7VRF.js"),
	"./locales/da-DK.json": () => import("./excalidraw-assets/da-DK-GA7WAOB4.js"),
	"./locales/de-DE.json": () => import("./excalidraw-assets/de-DE-WQGVYODE.js"),
	"./locales/el-GR.json": () => import("./excalidraw-assets/el-GR-JRKZ7DCA.js"),
	"./locales/en.json": () => import("./excalidraw-assets/en-QYCCPVJI.js"),
	"./locales/es-ES.json": () => import("./excalidraw-assets/es-ES-NNAEPTPN.js"),
	"./locales/eu-ES.json": () => import("./excalidraw-assets/eu-ES-UXVZRSMJ.js"),
	"./locales/fa-IR.json": () => import("./excalidraw-assets/fa-IR-FFXQODN6.js"),
	"./locales/fi-FI.json": () => import("./excalidraw-assets/fi-FI-FVRWY4PK.js"),
	"./locales/fr-FR.json": () => import("./excalidraw-assets/fr-FR-YRAHLNH4.js"),
	"./locales/gl-ES.json": () => import("./excalidraw-assets/gl-ES-O3MFXO2J.js"),
	"./locales/he-IL.json": () => import("./excalidraw-assets/he-IL-UQHONTOV.js"),
	"./locales/hi-IN.json": () => import("./excalidraw-assets/hi-IN-QGM3FMHS.js"),
	"./locales/hu-HU.json": () => import("./excalidraw-assets/hu-HU-FW4UHMDU.js"),
	"./locales/id-ID.json": () => import("./excalidraw-assets/id-ID-QOMISFYK.js"),
	"./locales/it-IT.json": () => import("./excalidraw-assets/it-IT-NXPSTWVC.js"),
	"./locales/ja-JP.json": () => import("./excalidraw-assets/ja-JP-Z7I24KT4.js"),
	"./locales/kaa.json": () => import("./excalidraw-assets/kaa-TXMSCJDQ.js"),
	"./locales/kab-KAB.json": () =>
		import("./excalidraw-assets/kab-KAB-RJXRUTDO.js"),
	"./locales/kk-KZ.json": () => import("./excalidraw-assets/kk-KZ-JXPULSST.js"),
	"./locales/km-KH.json": () => import("./excalidraw-assets/km-KH-WRGO6AYW.js"),
	"./locales/ko-KR.json": () => import("./excalidraw-assets/ko-KR-GAYOVASS.js"),
	"./locales/ku-TR.json": () => import("./excalidraw-assets/ku-TR-DJF4NWRZ.js"),
	"./locales/lt-LT.json": () => import("./excalidraw-assets/lt-LT-QQGY3S4X.js"),
	"./locales/lv-LV.json": () => import("./excalidraw-assets/lv-LV-H55DY45V.js"),
	"./locales/mr-IN.json": () => import("./excalidraw-assets/mr-IN-QYT2ELER.js"),
	"./locales/my-MM.json": () => import("./excalidraw-assets/my-MM-RRPBSH5R.js"),
	"./locales/nb-NO.json": () => import("./excalidraw-assets/nb-NO-AMX3MAHH.js"),
	"./locales/nl-NL.json": () => import("./excalidraw-assets/nl-NL-LZSLKN37.js"),
	"./locales/nn-NO.json": () => import("./excalidraw-assets/nn-NO-WWXPMJY7.js"),
	"./locales/oc-FR.json": () => import("./excalidraw-assets/oc-FR-GPZCMCGX.js"),
	"./locales/pa-IN.json": () => import("./excalidraw-assets/pa-IN-L5H3H4OA.js"),
	"./locales/percentages.json": () =>
		import("./excalidraw-assets/percentages-L6Y3A3ZS.js"),
	"./locales/pl-PL.json": () => import("./excalidraw-assets/pl-PL-SYTLCLU7.js"),
	"./locales/pt-BR.json": () => import("./excalidraw-assets/pt-BR-BJOSVXBP.js"),
	"./locales/pt-PT.json": () => import("./excalidraw-assets/pt-PT-QHWDKICL.js"),
	"./locales/ro-RO.json": () => import("./excalidraw-assets/ro-RO-AVSXCJHH.js"),
	"./locales/ru-RU.json": () => import("./excalidraw-assets/ru-RU-5Z6AY4FG.js"),
	"./locales/si-LK.json": () => import("./excalidraw-assets/si-LK-OMROCHR3.js"),
	"./locales/sk-SK.json": () => import("./excalidraw-assets/sk-SK-TLXIBWPH.js"),
	"./locales/sl-SI.json": () => import("./excalidraw-assets/sl-SI-JELDMWCI.js"),
	"./locales/sv-SE.json": () => import("./excalidraw-assets/sv-SE-2FAONS47.js"),
	"./locales/ta-IN.json": () => import("./excalidraw-assets/ta-IN-XN7DVSDK.js"),
	"./locales/th-TH.json": () => import("./excalidraw-assets/th-TH-VCIYWJPR.js"),
	"./locales/tr-TR.json": () => import("./excalidraw-assets/tr-TR-6QL6T7SM.js"),
	"./locales/uk-UA.json": () => import("./excalidraw-assets/uk-UA-Y6YRBHAO.js"),
	"./locales/vi-VN.json": () => import("./excalidraw-assets/vi-VN-34I6LTAE.js"),
	"./locales/zh-CN.json": () => import("./excalidraw-assets/zh-CN-TBLIBDU7.js"),
	"./locales/zh-HK.json": () => import("./excalidraw-assets/zh-HK-MDAU5TWB.js"),
	"./locales/zh-TW.json": () => import("./excalidraw-assets/zh-TW-DOGEFI3C.js"),
});
var c9 = 85,
	si = { code: "en", label: "English" },
	Tc = [
		si,
		...[
			{
				code: "ar-SA",
				label: "\u0627\u0644\u0639\u0631\u0628\u064A\u0629",
				rtl: !0,
			},
			{
				code: "bg-BG",
				label: "\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438",
			},
			{ code: "ca-ES", label: "Catal\xE0" },
			{ code: "cs-CZ", label: "\u010Cesky" },
			{ code: "de-DE", label: "Deutsch" },
			{
				code: "el-GR",
				label: "\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",
			},
			{ code: "es-ES", label: "Espa\xF1ol" },
			{ code: "eu-ES", label: "Euskara" },
			{ code: "fa-IR", label: "\u0641\u0627\u0631\u0633\u06CC", rtl: !0 },
			{ code: "fi-FI", label: "Suomi" },
			{ code: "fr-FR", label: "Fran\xE7ais" },
			{ code: "gl-ES", label: "Galego" },
			{ code: "he-IL", label: "\u05E2\u05D1\u05E8\u05D9\u05EA", rtl: !0 },
			{ code: "hi-IN", label: "\u0939\u093F\u0928\u094D\u0926\u0940" },
			{ code: "hu-HU", label: "Magyar" },
			{ code: "id-ID", label: "Bahasa Indonesia" },
			{ code: "it-IT", label: "Italiano" },
			{ code: "ja-JP", label: "\u65E5\u672C\u8A9E" },
			{ code: "kab-KAB", label: "Taqbaylit" },
			{
				code: "kk-KZ",
				label: "\u049A\u0430\u0437\u0430\u049B \u0442\u0456\u043B\u0456",
			},
			{ code: "ko-KR", label: "\uD55C\uAD6D\uC5B4" },
			{ code: "ku-TR", label: "Kurd\xEE" },
			{ code: "lt-LT", label: "Lietuvi\u0173" },
			{ code: "lv-LV", label: "Latvie\u0161u" },
			{ code: "my-MM", label: "Burmese" },
			{ code: "nb-NO", label: "Norsk bokm\xE5l" },
			{ code: "nl-NL", label: "Nederlands" },
			{ code: "nn-NO", label: "Norsk nynorsk" },
			{ code: "oc-FR", label: "Occitan" },
			{ code: "pa-IN", label: "\u0A2A\u0A70\u0A1C\u0A3E\u0A2C\u0A40" },
			{ code: "pl-PL", label: "Polski" },
			{ code: "pt-BR", label: "Portugu\xEAs Brasileiro" },
			{ code: "pt-PT", label: "Portugu\xEAs" },
			{ code: "ro-RO", label: "Rom\xE2n\u0103" },
			{ code: "ru-RU", label: "\u0420\u0443\u0441\u0441\u043A\u0438\u0439" },
			{ code: "sk-SK", label: "Sloven\u010Dina" },
			{ code: "sv-SE", label: "Svenska" },
			{ code: "sl-SI", label: "Sloven\u0161\u010Dina" },
			{ code: "tr-TR", label: "T\xFCrk\xE7e" },
			{
				code: "uk-UA",
				label: "\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",
			},
			{ code: "zh-CN", label: "\u7B80\u4F53\u4E2D\u6587" },
			{ code: "zh-TW", label: "\u7E41\u9AD4\u4E2D\u6587" },
			{ code: "vi-VN", label: "Ti\u1EBFng Vi\u1EC7t" },
			{ code: "mr-IN", label: "\u092E\u0930\u093E\u0920\u0940" },
		]
			.filter((e) => tT[e.code] >= c9)
			.sort((e, t) => (e.label > t.label ? 1 : -1)),
	],
	Xf = "__test__";
_.DEV &&
	Tc.unshift(
		{ code: Xf, label: "test language" },
		{ code: `${Xf}.rtl`, label: "\u202Atest language (rtl)\u202C", rtl: !0 },
	);
var Sc = si,
	Vf = {},
	Zf = async (e) => {
		if (
			((Sc = e),
			(document.documentElement.dir = Sc.rtl ? "rtl" : "ltr"),
			(document.documentElement.lang = Sc.code),
			e.code.startsWith(Xf))
		)
			Vf = {};
		else
			try {
				Vf = await s9(`./locales/${Sc.code}.json`);
			} catch (t) {
				console.error(`Failed to load language ${e.code}:`, t.message),
					(Vf = Gx);
			}
		zr.set(Z_, e.code);
	},
	ci = () => Sc,
	X_ = (e, t) => {
		for (let r = 0; r < t.length; ++r) {
			let o = t[r];
			if (e[o] === void 0) return;
			e = e[o];
		}
		if (typeof e == "string") return e;
	},
	v = (e, t, r) => {
		if (Sc.code.startsWith(Xf))
			return `\u202A[[${t ? `${e}(${JSON.stringify(t).slice(1, -1)})` : e}]]\u202C`;
		let o = e.split("."),
			i = X_(Vf, o) || X_(Gx, o) || r;
		if (i === void 0) {
			let a = `Can't find translation for ${e}`;
			if (_.PROD) return console.warn(a), "";
			throw new Error(a);
		}
		if (t) for (let a in t) i = i.replace(`{{${a}}}`, String(t[a]));
		return i;
	},
	Z_ = xt(si.code),
	lr = () => {
		let e = Em(Z_, lt);
		return { t: v, langCode: e };
	};
var jf = w(Q(), 1);
b();
var q_ = w(Q(), 1);
var qf = w(M(), 1),
	d9 = ({
		size: e = "1em",
		circleWidth: t = 8,
		synchronized: r = !1,
		className: o = "",
	}) => {
		let a = -(q_.default.useRef(Date.now()).current % 1600);
		return (0, qf.jsx)("div", {
			className: `Spinner ${o}`,
			children: (0, qf.jsx)("svg", {
				viewBox: "0 0 100 100",
				style: { width: e, height: e, "--spinner-delay": r ? `${a}ms` : 0 },
				children: (0, qf.jsx)("circle", {
					cx: "50",
					cy: "50",
					r: 50 - t / 2,
					strokeWidth: t,
					fill: "none",
					strokeMiterlimit: "10",
				}),
			}),
		});
	},
	$r = d9;
var Cc = w(M(), 1),
	Qf = ({ delay: e, theme: t }) => {
		let [r, o] = (0, jf.useState)(!!e);
		return (
			(0, jf.useEffect)(() => {
				if (!e) return;
				let i = setTimeout(() => {
					o(!1);
				}, e);
				return () => clearTimeout(i);
			}, [e]),
			r
				? null
				: (0, Cc.jsxs)("div", {
						className: j("LoadingMessage", {
							"LoadingMessage--dark": t === $e.DARK,
						}),
						children: [
							(0, Cc.jsx)("div", { children: (0, Cc.jsx)($r, {}) }),
							(0, Cc.jsx)("div", {
								className: "LoadingMessage-text",
								children: v("labels.loadingScene"),
							}),
						],
					})
		);
	};
var Q_ = w(M(), 1),
	j_ = (e) => {
		let [t, r] = (0, Jf.useState)(!0);
		return (
			(0, Jf.useEffect)(() => {
				let o = async () => {
						await Zf(i), r(!1);
					},
					i = Tc.find((a) => a.code === e.langCode) || si;
				o();
			}, [e.langCode]),
			t ? (0, Q_.jsx)(Qf, { theme: e.theme }) : e.children
		);
	};
b();
var hr = w(Q(), 1),
	il = w(Gn(), 1);
b();
b();
b();
var Wn = w(Q(), 1);
var fn = w(M(), 1),
	Te = Wn.default.forwardRef((e, t) => {
		let { id: r } = dr(),
			o = Wn.default.useRef(null);
		Wn.default.useImperativeHandle(t, () => o.current);
		let i = `ToolIcon_size_${e.size}`,
			[a, s] = (0, Wn.useState)(!1),
			c = (0, Wn.useRef)(!0),
			d = async (f) => {
				let m = "onClick" in e && e.onClick?.(f);
				if (Vs(m))
					try {
						s(!0), await m;
					} catch (g) {
						if (g instanceof Qs) console.warn(g);
						else throw g;
					} finally {
						c.current && s(!1);
					}
			};
		(0, Wn.useEffect)(
			() => (
				(c.current = !0),
				() => {
					c.current = !1;
				}
			),
			[],
		);
		let u = (0, Wn.useRef)(null);
		if (e.type === "button" || e.type === "icon" || e.type === "submit") {
			let f = e.type === "icon" ? "button" : e.type;
			return (0, fn.jsxs)("button", {
				className: j(
					"ToolIcon_type_button",
					i,
					e.className,
					e.visible && !e.hidden
						? "ToolIcon_type_button--show"
						: "ToolIcon_type_button--hide",
					{
						ToolIcon: !e.hidden,
						"ToolIcon--selected": e.selected,
						"ToolIcon--plain": e.type === "icon",
					},
				),
				style: e.style,
				"data-testid": e["data-testid"],
				hidden: e.hidden,
				title: e.title,
				"aria-label": e["aria-label"],
				type: f,
				onClick: d,
				ref: o,
				disabled: a || e.isLoading || !!e.disabled,
				children: [
					(e.icon || e.label) &&
						(0, fn.jsxs)("div", {
							className: "ToolIcon__icon",
							"aria-hidden": "true",
							"aria-disabled": !!e.disabled,
							children: [
								e.icon || e.label,
								e.keyBindingLabel &&
									(0, fn.jsx)("span", {
										className: "ToolIcon__keybinding",
										children: e.keyBindingLabel,
									}),
								e.isLoading && (0, fn.jsx)($r, {}),
							],
						}),
					e.showAriaLabel &&
						(0, fn.jsxs)("div", {
							className: "ToolIcon__label",
							children: [e["aria-label"], " ", a && (0, fn.jsx)($r, {})],
						}),
					e.children,
				],
			});
		}
		return (0, fn.jsxs)("label", {
			className: j("ToolIcon", e.className),
			title: e.title,
			onPointerDown: (f) => {
				(u.current = f.pointerType || null),
					e.onPointerDown?.({ pointerType: f.pointerType || null });
			},
			onPointerUp: () => {
				requestAnimationFrame(() => {
					u.current = null;
				});
			},
			children: [
				(0, fn.jsx)("input", {
					className: `ToolIcon_type_radio ${i}`,
					type: "radio",
					name: e.name,
					"aria-label": e["aria-label"],
					"aria-keyshortcuts": e["aria-keyshortcuts"],
					"data-testid": e["data-testid"],
					id: `${r}-${e.id}`,
					onChange: () => {
						e.onChange?.({ pointerType: u.current });
					},
					checked: e.checked,
					ref: o,
				}),
				(0, fn.jsxs)("div", {
					className: "ToolIcon__icon",
					children: [
						e.icon,
						e.keyBindingLabel &&
							(0, fn.jsx)("span", {
								className: "ToolIcon__keybinding",
								children: e.keyBindingLabel,
							}),
					],
				}),
			],
		});
	});
Te.defaultProps = { visible: !0, className: "", size: "medium" };
Te.displayName = "ToolButton";
var tA = w(M(), 1),
	m9 = (e, t, r) => {
		let o = r.scene.getNonDeletedElementsMap(),
			i = new Set(
				Le(
					e.filter((a) => Ye(a)),
					t,
				).map((a) => a.id),
			);
		return {
			elements: e.map((a) =>
				t.selectedElementIds[a.id]
					? (a.boundElements &&
							a.boundElements.forEach((s) => {
								let c = r.scene.getNonDeletedElementsMap().get(s.id);
								c &&
									qe(c) &&
									(me(c, {
										startBinding:
											a.id === c.startBinding?.elementId
												? null
												: c.startBinding,
										endBinding:
											a.id === c.endBinding?.elementId ? null : c.endBinding,
									}),
									Ui(c, o, c.points));
							}),
						Me(a, { isDeleted: !0 }))
					: a.frameId && i.has(a.frameId)
						? Me(a, { isDeleted: !0 })
						: co(a) && t.selectedElementIds[a.containerId]
							? Me(a, { isDeleted: !0 })
							: a,
			),
			appState: { ...t, selectedElementIds: {}, selectedGroupIds: {} },
		};
	},
	eA = (e, t) => {
		if (e.editingGroupId) {
			let r = Vt(Ve(t), e.editingGroupId);
			if (r.length) return { ...e, selectedElementIds: { [r[0].id]: !0 } };
		}
		return e;
	},
	ym = re({
		name: "deleteSelectedElements",
		label: "labels.delete",
		icon: Uo,
		trackEvent: { category: "element", action: "delete" },
		perform: (e, t, r, o) => {
			if (t.editingLinearElement) {
				let {
						elementId: s,
						selectedPointsIndices: c,
						startBindingElement: d,
						endBindingElement: u,
					} = t.editingLinearElement,
					f = o.scene.getNonDeletedElementsMap(),
					m = De.getElement(s, f);
				if (!m || c == null) return !1;
				if (m.points.length < 2) {
					let h = e.map((E) => (E.id === m.id ? Me(E, { isDeleted: !0 }) : E)),
						y = eA(t, h);
					return {
						elements: h,
						appState: { ...y, editingLinearElement: null },
						storeAction: H.CAPTURE,
					};
				}
				let g = {
					startBindingElement: c?.includes(0) ? null : d,
					endBindingElement: c?.includes(m.points.length - 1) ? null : u,
				};
				return (
					De.deletePoints(m, c, f, t.zoom),
					{
						elements: e,
						appState: {
							...t,
							editingLinearElement: {
								...t.editingLinearElement,
								...g,
								selectedPointsIndices: c?.[0] > 0 ? [c[0] - 1] : [0],
							},
						},
						storeAction: H.CAPTURE,
					}
				);
			}
			let { elements: i, appState: a } = m9(e, t, o);
			return (
				pf(
					i,
					e.filter(({ id: s }) => t.selectedElementIds[s]),
				),
				(a = eA(a, i)),
				{
					elements: i,
					appState: {
						...a,
						activeTool: Yt(t, { type: "selection" }),
						multiElement: null,
						activeEmbeddable: null,
					},
					storeAction: bt(Ve(e), t) ? H.CAPTURE : H.NONE,
				}
			);
		},
		keyTest: (e, t, r) =>
			(e.key === R.BACKSPACE || e.key === R.DELETE) && !e[R.CTRL_OR_CMD],
		PanelComponent: ({ elements: e, appState: t, updateData: r }) =>
			(0, tA.jsx)(Te, {
				type: "button",
				icon: Uo,
				title: v("labels.delete"),
				"aria-label": v("labels.delete"),
				onClick: () => r(null),
				visible: bt(Ve(e), t),
			}),
	});
b();
b();
var bE = (e, t) => e.frameId === t || e.id === t,
	oA = (e, t, r) => {
		let o = [],
			i = [],
			a = null,
			s = -1,
			c = Fe(
				r ||
					Le(e, t, {
						includeBoundTextElement: !0,
						includeElementsInFrames: !0,
					}),
			);
		for (; ++s < e.length; ) {
			let d = e[s];
			c.get(d.id)
				? (i.length && ((o = o.concat(i)), (i = [])), o.push(s), (a = s + 1))
				: d.isDeleted && a === s
					? ((a = s + 1), i.push(s))
					: (i = []);
		}
		return o;
	},
	u9 = (e) => {
		let t = 0;
		return e.reduce(
			(r, o, i) => (
				i > 0 && e[i - 1] !== o - 1 && (t = ++t),
				(r[t] || (r[t] = [])).push(o),
				r
			),
			[],
		);
	},
	rA = (e, t, r) => {
		if ("containerId" in e && e.containerId) {
			let o = Un.getScene(e).getElement(e.containerId);
			if (o)
				return r === "left"
					? Math.min(t.indexOf(o), t.indexOf(e))
					: Math.max(t.indexOf(o), t.indexOf(e));
		} else {
			let o = e.boundElements?.find((i) => i.type !== "arrow")?.id;
			if (o) {
				let i = Un.getScene(e).getElement(o);
				if (i)
					return r === "left"
						? Math.min(t.indexOf(i), t.indexOf(e))
						: Math.max(t.indexOf(i), t.indexOf(e));
			}
		}
	},
	p9 = (e, t) => {
		let r = -1,
			o = -1;
		return (
			e.forEach((i, a) => {
				bE(i, t) && (r === -1 && (r = a), (o = a));
			}),
			r === -1 ? [] : e.slice(r, o + 1)
		);
	},
	f9 = (e, t, r, o, i) => {
		let a = t[r],
			s = (m) =>
				m.isDeleted
					? !1
					: i
						? m.frameId === i
						: e.editingGroupId
							? m.groupIds.includes(e.editingGroupId)
							: !0,
			c =
				o === "left"
					? lv(t, (m) => s(m), Math.max(0, r - 1))
					: av(t, (m) => s(m), r + 1),
			d = t[c];
		if (!d) return -1;
		if (e.editingGroupId) {
			if (a?.groupIds.join("") === d?.groupIds.join(""))
				return rA(d, t, o) ?? c;
			if (!d?.groupIds.includes(e.editingGroupId)) return -1;
		}
		if (!i && (d.frameId || Ye(d))) {
			let m = p9(t, d.frameId || d.id);
			return o === "left" ? t.indexOf(m[0]) : t.indexOf(m[m.length - 1]);
		}
		if (!d.groupIds.length) return rA(d, t, o) ?? c;
		let u = e.editingGroupId
				? d.groupIds[d.groupIds.indexOf(e.editingGroupId) - 1]
				: d.groupIds[d.groupIds.length - 1],
			f = Vt(t, u);
		return f.length
			? o === "left"
				? t.indexOf(f[0])
				: t.indexOf(f[f.length - 1])
			: c;
	},
	nA = (e, t) =>
		t.reduce((r, o) => {
			let i = e[o];
			return r.set(i.id, i), r;
		}, new Map()),
	iA = (e, t, r) => {
		let o = oA(e, t),
			i = nA(e, o),
			a = u9(o);
		r === "right" && (a = a.reverse());
		let s = new Set(o.filter((c) => Ye(e[c])).map((c) => e[c].id));
		return (
			a.forEach((c, d) => {
				let u = c[0],
					f = c[c.length - 1],
					m = r === "left" ? u : f,
					g = c.some((P) => {
						let C = e[P];
						return C.frameId && s.has(C.frameId);
					})
						? null
						: e[m]?.frameId,
					h = f9(t, e, m, r, g);
				if (h === -1 || m === h) return;
				let y = r === "left" ? e.slice(0, h) : e.slice(0, u),
					E = e.slice(u, f + 1),
					T = r === "left" ? e.slice(h, u) : e.slice(f + 1, h + 1),
					I = r === "left" ? e.slice(f + 1) : e.slice(h + 1);
				e = r === "left" ? [...y, ...E, ...T, ...I] : [...y, ...T, ...E, ...I];
			}),
			Yo(e, i),
			e
		);
	},
	aA = (e, t, r, o, i) => {
		let a = oA(e, t, i),
			s = nA(e, a),
			c = [],
			d,
			u;
		if (r === "left") {
			if (o) d = av(e, (y) => bE(y, o));
			else if (t.editingGroupId) {
				let y = Vt(e, t.editingGroupId);
				if (!y.length) return e;
				d = e.indexOf(y[0]);
			} else d = 0;
			u = a[a.length - 1];
		} else {
			if (o) u = lv(e, (y) => bE(y, o));
			else if (t.editingGroupId) {
				let y = Vt(e, t.editingGroupId);
				if (!y.length) return e;
				u = e.indexOf(y[y.length - 1]);
			} else u = e.length - 1;
			d = a[0];
		}
		d === -1 && (d = 0);
		for (let y = d; y < u + 1; y++) a.includes(y) || c.push(e[y]);
		let f = Array.from(s.values()),
			m = e.slice(0, d),
			g = e.slice(u + 1),
			h = r === "left" ? [...m, ...f, ...c, ...g] : [...m, ...c, ...f, ...g];
		return Yo(h, s), h;
	};
function lA(e, t, r, o) {
	let i = Fe(
			Le(e, t, { includeBoundTextElement: !0, includeElementsInFrames: !0 }),
		),
		a = { regularElements: [], frameChildren: new Map() },
		s = new Set();
	for (let u of e) i.has(u.id) && Ye(u) && s.add(u.id);
	for (let u of e)
		if (i.has(u.id))
			if (Ye(u) || (u.frameId && s.has(u.frameId))) a.regularElements.push(u);
			else if (!u.frameId) a.regularElements.push(u);
			else {
				let f = a.frameChildren.get(u.frameId) || [];
				f.push(u), a.frameChildren.set(u.frameId, f);
			}
	let c = e,
		d = Array.from(a.frameChildren.entries());
	for (let [u, f] of d) c = o(e, t, r, u, f);
	return o(c, t, r, null, a.regularElements);
}
var sA = (e, t) => iA(e, t, "left"),
	cA = (e, t) => iA(e, t, "right"),
	dA = (e, t) => lA(e, t, "left", aA),
	mA = (e, t) => lA(e, t, "right", aA);
var wm = w(M(), 1),
	xE = re({
		name: "sendBackward",
		label: "labels.sendBackward",
		keywords: ["move down", "zindex", "layer"],
		icon: gv,
		trackEvent: { category: "element" },
		perform: (e, t) => ({
			elements: sA(e, t),
			appState: t,
			storeAction: H.CAPTURE,
		}),
		keyPriority: 40,
		keyTest: (e) =>
			e[R.CTRL_OR_CMD] && !e.shiftKey && e.code === Be.BRACKET_LEFT,
		PanelComponent: ({ updateData: e, appState: t }) =>
			(0, wm.jsx)("button", {
				type: "button",
				className: "zIndexButton",
				onClick: () => e(null),
				title: `${v("labels.sendBackward")} \u2014 ${V("CtrlOrCmd+[")}`,
				children: gv,
			}),
	}),
	vE = re({
		name: "bringForward",
		label: "labels.bringForward",
		keywords: ["move up", "zindex", "layer"],
		icon: fv,
		trackEvent: { category: "element" },
		perform: (e, t) => ({
			elements: cA(e, t),
			appState: t,
			storeAction: H.CAPTURE,
		}),
		keyPriority: 40,
		keyTest: (e) =>
			e[R.CTRL_OR_CMD] && !e.shiftKey && e.code === Be.BRACKET_RIGHT,
		PanelComponent: ({ updateData: e, appState: t }) =>
			(0, wm.jsx)("button", {
				type: "button",
				className: "zIndexButton",
				onClick: () => e(null),
				title: `${v("labels.bringForward")} \u2014 ${V("CtrlOrCmd+]")}`,
				children: fv,
			}),
	}),
	EE = re({
		name: "sendToBack",
		label: "labels.sendToBack",
		keywords: ["move down", "zindex", "layer"],
		icon: bv,
		trackEvent: { category: "element" },
		perform: (e, t) => ({
			elements: dA(e, t),
			appState: t,
			storeAction: H.CAPTURE,
		}),
		keyTest: (e) =>
			Dn
				? e[R.CTRL_OR_CMD] && e.altKey && e.code === Be.BRACKET_LEFT
				: e[R.CTRL_OR_CMD] && e.shiftKey && e.code === Be.BRACKET_LEFT,
		PanelComponent: ({ updateData: e, appState: t }) =>
			(0, wm.jsx)("button", {
				type: "button",
				className: "zIndexButton",
				onClick: () => e(null),
				title: `${v("labels.sendToBack")} \u2014 ${Dn ? V("CtrlOrCmd+Alt+[") : V("CtrlOrCmd+Shift+[")}`,
				children: bv,
			}),
	}),
	yE = re({
		name: "bringToFront",
		label: "labels.bringToFront",
		keywords: ["move up", "zindex", "layer"],
		icon: hv,
		trackEvent: { category: "element" },
		perform: (e, t) => ({
			elements: mA(e, t),
			appState: t,
			storeAction: H.CAPTURE,
		}),
		keyTest: (e) =>
			Dn
				? e[R.CTRL_OR_CMD] && e.altKey && e.code === Be.BRACKET_RIGHT
				: e[R.CTRL_OR_CMD] && e.shiftKey && e.code === Be.BRACKET_RIGHT,
		PanelComponent: ({ updateData: e, appState: t }) =>
			(0, wm.jsx)("button", {
				type: "button",
				className: "zIndexButton",
				onClick: (r) => e(null),
				title: `${v("labels.bringToFront")} \u2014 ${Dn ? V("CtrlOrCmd+Alt+]") : V("CtrlOrCmd+Shift+]")}`,
				children: hv,
			}),
	});
b();
var wE = re({
	name: "selectAll",
	label: "labels.selectAll",
	icon: M2,
	trackEvent: { category: "canvas" },
	viewMode: !1,
	perform: (e, t, r, o) => {
		if (t.editingLinearElement) return !1;
		let i = wc(
			e.filter((a) => !a.isDeleted && !(Ee(a) && a.containerId) && !a.locked),
		).reduce((a, s) => ((a[s.id] = !0), a), {});
		return {
			appState: {
				...t,
				...Mr({ editingGroupId: null, selectedElementIds: i }, Ve(e), t, o),
				selectedLinearElement:
					Object.keys(i).length === 1 && at(e[0]) ? new De(e[0]) : null,
			},
			storeAction: H.CAPTURE,
		};
	},
	keyTest: (e) => e[R.CTRL_OR_CMD] && e.key === R.A,
});
b();
b();
var g9 = (e) => {
		let t = e.slice(),
			r = new Set(),
			o = (a) => {
				let s = a[0]?.groupIds?.join(""),
					c = [a[0]],
					d = [];
				for (let u of a.slice(1))
					u.groupIds?.join("") === s ? c.push(u) : d.push(u);
				return d.length ? [...c, ...o(d)] : c;
			},
			i = new Map();
		return (
			t.forEach((a, s) => {
				if (!i.has(a.id))
					if (a.groupIds?.length) {
						let c = a.groupIds[a.groupIds.length - 1],
							d = t.slice(s).filter((u) => {
								let f = u?.groupIds?.some((m) => m === c);
								return f && i.set(u.id, !0), f;
							});
						for (let u of o(d)) r.add(u);
					} else r.add(a);
			}),
			r.size !== e.length
				? (console.error(
						"normalizeGroupElementOrder: lost some elements... bailing!",
					),
					e)
				: [...r]
		);
	},
	h9 = (e) => {
		let t = KT(e),
			r = e.slice(),
			o = new Set();
		return (
			r.forEach((i, a) => {
				i &&
					(i.boundElements?.length
						? (o.add(i),
							(r[a] = null),
							i.boundElements.forEach((s) => {
								let c = t.get(s.id);
								c && s.type === "text" && (o.add(c[0]), (r[c[1]] = null));
							}))
						: (i.type === "text" &&
								i.containerId &&
								t
									.get(i.containerId)?.[0]
									.boundElements?.find((c) => c.id === i.id)) ||
							(o.add(i), (r[a] = null)));
			}),
			o.size !== e.length
				? (console.error(
						"normalizeBoundElementsOrder: lost some elements... bailing!",
					),
					e)
				: [...o]
		);
	},
	uA = (e) => h9(g9(e));
var pA = w(M(), 1),
	SE = re({
		name: "duplicateSelection",
		label: "labels.duplicateSelection",
		icon: rm,
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => {
			if (t.editingLinearElement)
				try {
					let i = De.duplicateSelectedPoints(
						t,
						o.scene.getNonDeletedElementsMap(),
					);
					return { elements: e, appState: i, storeAction: H.CAPTURE };
				} catch {
					return !1;
				}
			return { ...b9(e, t), storeAction: H.CAPTURE };
		},
		keyTest: (e) => e[R.CTRL_OR_CMD] && e.key === R.D,
		PanelComponent: ({ elements: e, appState: t, updateData: r }) =>
			(0, pA.jsx)(Te, {
				type: "button",
				icon: rm,
				title: `${v("labels.duplicateSelection")} \u2014 ${V("CtrlOrCmd+D")}`,
				"aria-label": v("labels.duplicateSelection"),
				onClick: () => r(null),
				visible: bt(Ve(e), t),
			}),
	}),
	b9 = (e, t) => {
		let r = uA(e),
			o = new Map(),
			i = [],
			a = [],
			s = new Map(),
			c = new Map(),
			d = (P) => {
				let C = rf(t.editingGroupId, o, P, {
					x: P.x + Vx / 2,
					y: P.y + Vx / 2,
				});
				return c.set(C.id, C), s.set(P.id, C.id), a.push(P), i.push(C), C;
			},
			u = Fe(
				Le(r, t, { includeBoundTextElement: !0, includeElementsInFrames: !0 }),
			),
			f = new Map(),
			m = (P) => {
				for (let C of P) f.set(C.id, !0);
				return P;
			},
			g = [],
			h = -1;
		for (; ++h < r.length; ) {
			let P = r[h];
			if (f.get(P.id)) continue;
			let C = ot(P, Fe(e)),
				k = Ye(P);
			if (u.get(P.id)) {
				if (P.groupIds.length || C || k) {
					let N = aC(t, P);
					if (N) {
						let D = Vt(r, N).flatMap((B) =>
							Ye(B) ? [...ka(e, B.id), B] : [B],
						);
						g.push(...m([...D, ...D.map((B) => d(B))]));
						continue;
					}
					if (C) {
						g.push(...m([P, C, d(P), d(C)]));
						continue;
					}
					if (k) {
						let D = ka(r, P.id);
						g.push(...m([...D, P, ...D.map((B) => d(B)), d(P)]));
						continue;
					}
				}
				(!P.frameId || !u.has(P.frameId)) && g.push(...m([P, d(P)]));
			} else g.push(...m([P]));
		}
		let y = [],
			E = new Map();
		for (h = g.length; --h >= 0; ) {
			let P = g[h];
			E.get(P.id) || (E.set(P.id, !0), y.push(P));
		}
		let T = Yo(y.reverse(), Fe(i));
		Nf(g, a, s), uf(g, a, s), Af(T, a, s);
		let I = wc(i);
		return {
			elements: T,
			appState: {
				...t,
				...Mr(
					{
						editingGroupId: t.editingGroupId,
						selectedElementIds: I.reduce(
							(P, C) => (co(C) || (P[C.id] = !0), P),
							{},
						),
					},
					Ve(T),
					t,
					null,
				),
			},
		};
	};
b();
var vn = w(Q(), 1);
b();
var x9 = new Set(["command_palette", "export"]),
	We = (e, t, r, o) => {
		try {
			if (
				typeof window > "u" ||
				_.VITE_WORKER_ID ||
				_.VITE_APP_ENABLE_TRACKING !== "true" ||
				!x9.has(e) ||
				_.DEV
			)
				return;
			_.PROD ||
				console.info("trackEvent", {
					category: e,
					action: t,
					label: r,
					value: o,
				}),
				window.sa_event &&
					window.sa_event(t, { category: e, label: r, value: o });
		} catch (i) {
			console.error("error during analytics", i);
		}
	};
b();
b();
var fA = w(Q(), 1);
var gA = w(M(), 1),
	eg = (0, fA.forwardRef)((e, t) => {
		let {
			title: r,
			className: o,
			testId: i,
			active: a,
			standalone: s,
			icon: c,
			onClick: d,
		} = e;
		return (0, gA.jsx)(
			"button",
			{
				type: "button",
				ref: t,
				title: r,
				"data-testid": i,
				className: j(o, { standalone: s, active: a }),
				onClick: d,
				children: c,
			},
			r,
		);
	});
var Ic = w(M(), 1),
	gn = (e) =>
		(0, Ic.jsx)("div", {
			className: "buttonList",
			children: e.options.map((t) =>
				e.type === "button"
					? (0, Ic.jsx)(
							eg,
							{
								icon: t.icon,
								title: t.text,
								testId: t.testId,
								active: t.active ?? e.value === t.value,
								onClick: (r) => e.onClick(t.value, r),
							},
							t.text,
						)
					: (0, Ic.jsxs)(
							"label",
							{
								className: j({ active: e.value === t.value }),
								title: t.text,
								children: [
									(0, Ic.jsx)("input", {
										type: "radio",
										name: e.group,
										onChange: () => e.onChange(t.value),
										checked: e.value === t.value,
										"data-testid": t.testId,
									}),
									t.icon,
								],
							},
							t.text,
						),
			),
		});
b();
b();
var tg = w(M(), 1),
	hA = ({ onChange: e, type: t, activeColor: r, topPicks: o }) => {
		let i;
		return (
			t === "elementStroke" && (i = up),
			t === "elementBackground" && (i = pp),
			t === "canvasBackground" && (i = fp),
			o && (i = o),
			i
				? (0, tg.jsx)("div", {
						className: "color-picker__top-picks",
						children: i.map((a) =>
							(0, tg.jsx)(
								"button",
								{
									className: j("color-picker__button", {
										active: a === r,
										"is-transparent": a === "transparent" || !a,
									}),
									style: { "--swatch-color": a },
									type: "button",
									title: a,
									onClick: () => e(a),
									"data-testid": `color-top-pick-${a}`,
									children: (0, tg.jsx)("div", {
										className: "color-picker__button-outline",
									}),
								},
								a,
							),
						),
					})
				: (console.error("Invalid type for TopPicks"), null)
		);
	};
b();
var bA = w(M(), 1),
	rg = () =>
		(0, bA.jsx)("div", {
			style: {
				width: 1,
				height: "1rem",
				backgroundColor: "var(--default-border-color)",
				margin: "0 auto",
			},
		});
b();
var Da = w(Q(), 1);
b();
var og = w(Q(), 1);
b();
var Ra = ({ palette: e, color: t }) => {
		for (let [r, o] of Object.entries(e))
			if (Array.isArray(o)) {
				let i = o.indexOf(t);
				if (i > -1) return { colorName: r, shade: i };
			} else if (o === t) return { colorName: r, shade: null };
		return null;
	},
	Sm = [
		["q", "w", "e", "r", "t"],
		["a", "s", "d", "f", "g"],
		["z", "x", "c", "v", "b"],
	].flat(),
	TE = ({ color: e, palette: t }) => !Object.values(t).flat().includes(e),
	vA = (e, t, r) => {
		let o = {
				elementBackground: "backgroundColor",
				elementStroke: "strokeColor",
			},
			i = e.filter((s) => {
				if (s.isDeleted) return !1;
				let c = s[o[t]];
				return TE({ color: c, palette: r });
			}),
			a = new Map();
		return (
			i.forEach((s) => {
				let c = s[o[t]];
				a.has(c) ? a.set(c, a.get(c) + 1) : a.set(c, 1);
			}),
			[...a.entries()]
				.sort((s, c) => c[1] - s[1])
				.map((s) => s[0])
				.slice(0, rT)
		);
	},
	hn = xt(null),
	xA = (e, t, r) =>
		(e * 299 + t * 587 + r * 114) / 1e3 >= 160 ? "black" : "white",
	EA = (e, t) => {
		if (t) {
			let a = new Option().style;
			if (((a.color = e), a.color)) {
				let s = a.color
						.replace(/^(rgb|rgba)\(/, "")
						.replace(/\)$/, "")
						.replace(/\s/g, "")
						.split(","),
					c = parseInt(s[0]),
					d = parseInt(s[1]),
					u = parseInt(s[2]);
				return xA(c, d, u);
			}
		}
		if (e === "transparent") return "black";
		let r = parseInt(e.substring(1, 3), 16),
			o = parseInt(e.substring(3, 5), 16),
			i = parseInt(e.substring(5, 7), 16);
		return xA(r, o, i);
	};
b();
var yA = w(M(), 1),
	v9 = ({ color: e, keyLabel: t, isCustomColor: r = !1, isShade: o = !1 }) =>
		(0, yA.jsxs)("div", {
			className: "color-picker__button__hotkey-label",
			style: { color: EA(e, r) },
			children: [o && "\u21E7", t],
		}),
	_c = v9;
var Ki = w(M(), 1),
	wA = ({ hex: e, onChange: t, palette: r }) => {
		let o = Ra({ color: e || "transparent", palette: r }),
			[i, a] = Ge(hn),
			s = (0, og.useRef)(null);
		if (
			((0, og.useEffect)(() => {
				s.current && i === "shades" && s.current.focus();
			}, [o, i]),
			o)
		) {
			let { colorName: c, shade: d } = o,
				u = r[c];
			if (Array.isArray(u))
				return (0, Ki.jsx)("div", {
					className: "color-picker-content--default shades",
					children: u.map((f, m) =>
						(0, Ki.jsxs)(
							"button",
							{
								ref: m === d && i === "shades" ? s : void 0,
								tabIndex: -1,
								type: "button",
								className: j(
									"color-picker__button color-picker__button--large",
									{ active: m === d },
								),
								"aria-label": "Shade",
								title: `${c} - ${m + 1}`,
								style: f ? { "--swatch-color": f } : void 0,
								onClick: () => {
									t(f), a("shades");
								},
								children: [
									(0, Ki.jsx)("div", {
										className: "color-picker__button-outline",
									}),
									(0, Ki.jsx)(_c, { color: f, keyLabel: m + 1, isShade: !0 }),
								],
							},
							m,
						),
					),
				});
		}
		return (0, Ki.jsxs)("div", {
			className: "color-picker-content--default",
			style: { position: "relative" },
			tabIndex: -1,
			children: [
				(0, Ki.jsx)("button", {
					type: "button",
					tabIndex: -1,
					className:
						"color-picker__button color-picker__button--large color-picker__button--no-focus-visible",
				}),
				(0, Ki.jsx)("div", {
					tabIndex: -1,
					style: {
						position: "absolute",
						top: 0,
						left: 0,
						right: 0,
						bottom: 0,
						display: "flex",
						alignItems: "center",
						justifyContent: "center",
						textAlign: "center",
						fontSize: "0.75rem",
					},
					children: v("colorPicker.noShades"),
				}),
			],
		});
	};
b();
var ng = w(Q(), 1);
var Ac = w(M(), 1),
	E9 = ({ palette: e, color: t, onChange: r, label: o, activeShade: i }) => {
		let a = Ra({ color: t || "transparent", palette: e }),
			[s, c] = Ge(hn),
			d = (0, ng.useRef)(null);
		return (
			(0, ng.useEffect)(() => {
				d.current && s === "baseColors" && d.current.focus();
			}, [a?.colorName, s]),
			(0, Ac.jsx)("div", {
				className: "color-picker-content--default",
				children: Object.entries(e).map(([u, f], m) => {
					let g = (Array.isArray(f) ? f[i] : f) || "transparent",
						h = Sm[m],
						y = v(`colors.${u.replace(/\d+/, "")}`, null, "");
					return (0, Ac.jsxs)(
						"button",
						{
							ref: a?.colorName === u ? d : void 0,
							tabIndex: -1,
							type: "button",
							className: j("color-picker__button color-picker__button--large", {
								active: a?.colorName === u,
								"is-transparent": g === "transparent" || !g,
							}),
							onClick: () => {
								r(g), c("baseColors");
							},
							title: `${y}${g.startsWith("#") ? ` ${g}` : ""} \u2014 ${h}`,
							"aria-label": `${y} \u2014 ${h}`,
							style: g ? { "--swatch-color": g } : void 0,
							"data-testid": `color-${u}`,
							children: [
								(0, Ac.jsx)("div", {
									className: "color-picker__button-outline",
								}),
								(0, Ac.jsx)(_c, { color: g, keyLabel: h }),
							],
						},
						u,
					);
				}),
			})
		);
	},
	SA = E9;
b();
var ig = w(Q(), 1);
var kc = w(M(), 1),
	TA = ({ colors: e, color: t, onChange: r, label: o }) => {
		let [i, a] = Ge(hn),
			s = (0, ig.useRef)(null);
		return (
			(0, ig.useEffect)(() => {
				s.current && s.current.focus();
			}, [t, i]),
			(0, kc.jsx)("div", {
				className: "color-picker-content--default",
				children: e.map((c, d) =>
					(0, kc.jsxs)(
						"button",
						{
							ref: t === c ? s : void 0,
							tabIndex: -1,
							type: "button",
							className: j("color-picker__button color-picker__button--large", {
								active: t === c,
								"is-transparent": c === "transparent" || !c,
							}),
							onClick: () => {
								r(c), a("custom");
							},
							title: c,
							"aria-label": o,
							style: { "--swatch-color": c },
							children: [
								(0, kc.jsx)("div", {
									className: "color-picker__button-outline",
								}),
								(0, kc.jsx)(_c, {
									color: c,
									keyLabel: d + 1,
									isCustomColor: !0,
								}),
							],
						},
						d,
					),
				),
			})
		);
	};
b();
var CE = (e, t, r) => {
		let o = Math.ceil(r / vl);
		switch (((t = t ?? -1), e)) {
			case "ArrowLeft": {
				let i = t - 1;
				return i < 0 ? r - 1 : i;
			}
			case "ArrowRight":
				return (t + 1) % r;
			case "ArrowDown": {
				let i = t + vl;
				return i >= r ? t % vl : i;
			}
			case "ArrowUp": {
				let i = t - vl,
					a = i < 0 ? vl * o + i : i;
				return a >= r ? void 0 : a;
			}
		}
	},
	y9 = ({
		e,
		colorObj: t,
		onChange: r,
		palette: o,
		customColors: i,
		setActiveColorPickerSection: a,
		activeShade: s,
	}) => {
		if (
			t?.shade != null &&
			["Digit1", "Digit2", "Digit3", "Digit4", "Digit5"].includes(e.code) &&
			e.shiftKey
		) {
			let c = Number(e.code.slice(-1)) - 1;
			return r(o[t.colorName][c]), a("shades"), !0;
		}
		if (["1", "2", "3", "4", "5"].includes(e.key) && i[Number(e.key) - 1])
			return r(i[Number(e.key) - 1]), a("custom"), !0;
		if (Sm.includes(e.key)) {
			let c = Sm.indexOf(e.key),
				d = Object.keys(o)[c],
				u = o[d],
				f = Array.isArray(u) ? u[s] : u;
			return r(f), a("baseColors"), !0;
		}
		return !1;
	},
	CA = ({
		event: e,
		activeColorPickerSection: t,
		palette: r,
		color: o,
		onChange: i,
		customColors: a,
		setActiveColorPickerSection: s,
		updateData: c,
		activeShade: d,
		onEyeDropperToggle: u,
		onEscape: f,
	}) => {
		if (e[R.CTRL_OR_CMD]) return !1;
		if (e.key === R.ESCAPE) return f(e), !0;
		if (e.key === R.ALT) return u(!0), !0;
		if (e.key === R.I) return u(), !0;
		let m = Ra({ color: o, palette: r });
		if (e.key === R.TAB) {
			let g = {
					custom: !!a.length,
					baseColors: !0,
					shades: m?.shade != null,
					hex: !0,
				},
				h = Object.entries(g).reduce((P, [C, k]) => (k && P.push(C), P), []),
				y = h.indexOf(t),
				E = e.shiftKey ? -1 : 1,
				T = y + E > h.length - 1 ? 0 : y + E < 0 ? h.length - 1 : y + E,
				I = h[T];
			return (
				I && s(I),
				I === "custom"
					? i(a[0])
					: I === "baseColors" &&
						(Object.entries(r).find(([C, k]) =>
							Array.isArray(k) ? k.includes(o) : k === o ? C : null,
						) ||
							i(Mi.black)),
				e.preventDefault(),
				e.stopPropagation(),
				!0
			);
		}
		if (
			y9({
				e,
				colorObj: m,
				onChange: i,
				palette: r,
				customColors: a,
				setActiveColorPickerSection: s,
				activeShade: d,
			})
		)
			return !0;
		if (t === "shades" && m) {
			let { shade: g } = m,
				h = CE(e.key, g, vl);
			if (h !== void 0) return i(r[m.colorName][h]), !0;
		}
		if (t === "baseColors" && m) {
			let { colorName: g } = m,
				h = Object.keys(r),
				y = h.indexOf(g),
				E = CE(e.key, y, h.length);
			if (E !== void 0) {
				let T = h[E],
					I = r[T];
				return i(Array.isArray(I) ? I[d] : I), !0;
			}
		}
		if (t === "custom") {
			let g = a.indexOf(o),
				h = CE(e.key, g, a.length);
			if (h !== void 0) {
				let y = a[h];
				return i(y), !0;
			}
		}
		return !1;
	};
b();
var IA = w(M(), 1),
	w9 = ({ children: e }) =>
		(0, IA.jsx)("div", { className: "color-picker__heading", children: e }),
	Lc = w9;
var Vo = w(M(), 1),
	_A = ({
		color: e,
		onChange: t,
		label: r,
		type: o,
		elements: i,
		palette: a,
		updateData: s,
		children: c,
		onEyeDropperToggle: d,
		onEscape: u,
	}) => {
		let [f] = Da.default.useState(() =>
				o === "canvasBackground" ? [] : vA(i, o, a),
			),
			[m, g] = Ge(hn),
			h = Ra({ color: e, palette: a });
		(0, Da.useEffect)(() => {
			if (!m) {
				let I = TE({ color: e, palette: a }),
					P = I && !f.includes(e);
				g(
					P ? "hex" : I ? "custom" : h?.shade != null ? "shades" : "baseColors",
				);
			}
		}, [m, e, a, g, h, f]);
		let [y, E] = (0, Da.useState)(
			h?.shade ?? (o === "elementBackground" ? nT : oT),
		);
		(0, Da.useEffect)(() => {
			h?.shade != null && E(h.shade);
			let I = (P) => {
				P.key === R.ALT && d(!1);
			};
			return (
				document.addEventListener("keyup", I, { capture: !0 }),
				() => {
					document.removeEventListener("keyup", I, { capture: !0 });
				}
			);
		}, [h, d]);
		let T = Da.default.useRef(null);
		return (0, Vo.jsx)("div", {
			role: "dialog",
			"aria-modal": "true",
			"aria-label": v("labels.colorPicker"),
			children: (0, Vo.jsxs)("div", {
				ref: T,
				onKeyDown: (I) => {
					CA({
						event: I,
						activeColorPickerSection: m,
						palette: a,
						color: e,
						onChange: t,
						onEyeDropperToggle: d,
						customColors: f,
						setActiveColorPickerSection: g,
						updateData: s,
						activeShade: y,
						onEscape: u,
					}) && (I.preventDefault(), I.stopPropagation());
				},
				className: "color-picker-content properties-content",
				tabIndex: -1,
				children: [
					!!f.length &&
						(0, Vo.jsxs)("div", {
							children: [
								(0, Vo.jsx)(Lc, {
									children: v("colorPicker.mostUsedCustomColors"),
								}),
								(0, Vo.jsx)(TA, {
									colors: f,
									color: e,
									label: v("colorPicker.mostUsedCustomColors"),
									onChange: t,
								}),
							],
						}),
					(0, Vo.jsxs)("div", {
						children: [
							(0, Vo.jsx)(Lc, { children: v("colorPicker.colors") }),
							(0, Vo.jsx)(SA, {
								color: e,
								label: r,
								palette: a,
								onChange: t,
								activeShade: y,
							}),
						],
					}),
					(0, Vo.jsxs)("div", {
						children: [
							(0, Vo.jsx)(Lc, { children: v("colorPicker.shades") }),
							(0, Vo.jsx)(wA, { hex: e, onChange: t, palette: a }),
						],
					}),
					c,
				],
			}),
		});
	};
b();
b();
function je() {
	return (
		(je = Object.assign
			? Object.assign.bind()
			: function (e) {
					for (var t = 1; t < arguments.length; t++) {
						var r = arguments[t];
						for (var o in r) ({}).hasOwnProperty.call(r, o) && (e[o] = r[o]);
					}
					return e;
				}),
		je.apply(null, arguments)
	);
}
var Qe = w(Q());
b();
function mr(e, t, { checkForDefaultPrevented: r = !0 } = {}) {
	return function (i) {
		if ((e?.(i), r === !1 || !i.defaultPrevented)) return t?.(i);
	};
}
b();
var AA = w(Q());
function S9(e, t) {
	typeof e == "function" ? e(t) : e != null && (e.current = t);
}
function IE(...e) {
	return (t) => e.forEach((r) => S9(r, t));
}
function Hr(...e) {
	return (0, AA.useCallback)(IE(...e), e);
}
b();
var Kn = w(Q());
function di(e, t = []) {
	let r = [];
	function o(a, s) {
		let c = (0, Kn.createContext)(s),
			d = r.length;
		r = [...r, s];
		function u(m) {
			let { scope: g, children: h, ...y } = m,
				E = g?.[e][d] || c,
				T = (0, Kn.useMemo)(() => y, Object.values(y));
			return (0, Kn.createElement)(E.Provider, { value: T }, h);
		}
		function f(m, g) {
			let h = g?.[e][d] || c,
				y = (0, Kn.useContext)(h);
			if (y) return y;
			if (s !== void 0) return s;
			throw new Error(`\`${m}\` must be used within \`${a}\``);
		}
		return (u.displayName = a + "Provider"), [u, f];
	}
	let i = () => {
		let a = r.map((s) => (0, Kn.createContext)(s));
		return function (c) {
			let d = c?.[e] || a;
			return (0, Kn.useMemo)(
				() => ({ [`__scope${e}`]: { ...c, [e]: d } }),
				[c, d],
			);
		};
	};
	return (i.scopeName = e), [o, T9(i, ...t)];
}
function T9(...e) {
	let t = e[0];
	if (e.length === 1) return t;
	let r = () => {
		let o = e.map((i) => ({ useScope: i(), scopeName: i.scopeName }));
		return function (a) {
			let s = o.reduce((c, { useScope: d, scopeName: u }) => {
				let m = d(a)[`__scope${u}`];
				return { ...c, ...m };
			}, {});
			return (0, Kn.useMemo)(() => ({ [`__scope${t.scopeName}`]: s }), [s]);
		};
	};
	return (r.scopeName = t.scopeName), r;
}
b();
var sr = w(Q());
b();
var Mc = w(Q()),
	kA = w(Gn());
b();
var Xt = w(Q());
var Na = (0, Xt.forwardRef)((e, t) => {
	let { children: r, ...o } = e,
		i = Xt.Children.toArray(r),
		a = i.find(I9);
	if (a) {
		let s = a.props.children,
			c = i.map((d) =>
				d === a
					? Xt.Children.count(s) > 1
						? Xt.Children.only(null)
						: (0, Xt.isValidElement)(s)
							? s.props.children
							: null
					: d,
			);
		return (0, Xt.createElement)(
			_E,
			je({}, o, { ref: t }),
			(0, Xt.isValidElement)(s) ? (0, Xt.cloneElement)(s, void 0, c) : null,
		);
	}
	return (0, Xt.createElement)(_E, je({}, o, { ref: t }), r);
});
Na.displayName = "Slot";
var _E = (0, Xt.forwardRef)((e, t) => {
	let { children: r, ...o } = e;
	return (0, Xt.isValidElement)(r)
		? (0, Xt.cloneElement)(r, { ..._9(o, r.props), ref: IE(t, r.ref) })
		: Xt.Children.count(r) > 1
			? Xt.Children.only(null)
			: null;
});
_E.displayName = "SlotClone";
var C9 = ({ children: e }) => (0, Xt.createElement)(Xt.Fragment, null, e);
function I9(e) {
	return (0, Xt.isValidElement)(e) && e.type === C9;
}
function _9(e, t) {
	let r = { ...t };
	for (let o in t) {
		let i = e[o],
			a = t[o];
		/^on[A-Z]/.test(o)
			? i && a
				? (r[o] = (...c) => {
						a(...c), i(...c);
					})
				: i && (r[o] = i)
			: o === "style"
				? (r[o] = { ...i, ...a })
				: o === "className" && (r[o] = [i, a].filter(Boolean).join(" "));
	}
	return { ...e, ...r };
}
var A9 = [
		"a",
		"button",
		"div",
		"h2",
		"h3",
		"img",
		"label",
		"li",
		"nav",
		"ol",
		"p",
		"span",
		"svg",
		"ul",
	],
	Qt = A9.reduce((e, t) => {
		let r = (0, Mc.forwardRef)((o, i) => {
			let { asChild: a, ...s } = o,
				c = a ? Na : t;
			return (
				(0, Mc.useEffect)(() => {
					window[Symbol.for("radix-ui")] = !0;
				}, []),
				(0, Mc.createElement)(c, je({}, s, { ref: i }))
			);
		});
		return (r.displayName = `Primitive.${t}`), { ...e, [t]: r };
	}, {});
function LA(e, t) {
	e && (0, kA.flushSync)(() => e.dispatchEvent(t));
}
b();
var Pc = w(Q());
function uo(e) {
	let t = (0, Pc.useRef)(e);
	return (
		(0, Pc.useEffect)(() => {
			t.current = e;
		}),
		(0, Pc.useMemo)(
			() =>
				(...r) => {
					var o;
					return (o = t.current) === null || o === void 0
						? void 0
						: o.call(t, ...r);
				},
			[],
		)
	);
}
b();
var MA = w(Q());
function PA(e, t = globalThis?.document) {
	let r = uo(e);
	(0, MA.useEffect)(() => {
		let o = (i) => {
			i.key === "Escape" && r(i);
		};
		return (
			t.addEventListener("keydown", o),
			() => t.removeEventListener("keydown", o)
		);
	}, [r, t]);
}
var AE = "dismissableLayer.update",
	k9 = "dismissableLayer.pointerDownOutside",
	L9 = "dismissableLayer.focusOutside",
	RA,
	M9 = (0, sr.createContext)({
		layers: new Set(),
		layersWithOutsidePointerEventsDisabled: new Set(),
		branches: new Set(),
	}),
	NA = (0, sr.forwardRef)((e, t) => {
		var r;
		let {
				disableOutsidePointerEvents: o = !1,
				onEscapeKeyDown: i,
				onPointerDownOutside: a,
				onFocusOutside: s,
				onInteractOutside: c,
				onDismiss: d,
				...u
			} = e,
			f = (0, sr.useContext)(M9),
			[m, g] = (0, sr.useState)(null),
			h =
				(r = m?.ownerDocument) !== null && r !== void 0
					? r
					: globalThis?.document,
			[, y] = (0, sr.useState)({}),
			E = Hr(t, (F) => g(F)),
			T = Array.from(f.layers),
			[I] = [...f.layersWithOutsidePointerEventsDisabled].slice(-1),
			P = T.indexOf(I),
			C = m ? T.indexOf(m) : -1,
			k = f.layersWithOutsidePointerEventsDisabled.size > 0,
			N = C >= P,
			D = P9((F) => {
				let W = F.target,
					G = [...f.branches].some((q) => q.contains(W));
				!N || G || (a?.(F), c?.(F), F.defaultPrevented || d?.());
			}, h),
			B = R9((F) => {
				let W = F.target;
				[...f.branches].some((q) => q.contains(W)) ||
					(s?.(F), c?.(F), F.defaultPrevented || d?.());
			}, h);
		return (
			PA((F) => {
				C === f.layers.size - 1 &&
					(i?.(F), !F.defaultPrevented && d && (F.preventDefault(), d()));
			}, h),
			(0, sr.useEffect)(() => {
				if (m)
					return (
						o &&
							(f.layersWithOutsidePointerEventsDisabled.size === 0 &&
								((RA = h.body.style.pointerEvents),
								(h.body.style.pointerEvents = "none")),
							f.layersWithOutsidePointerEventsDisabled.add(m)),
						f.layers.add(m),
						DA(),
						() => {
							o &&
								f.layersWithOutsidePointerEventsDisabled.size === 1 &&
								(h.body.style.pointerEvents = RA);
						}
					);
			}, [m, h, o, f]),
			(0, sr.useEffect)(
				() => () => {
					m &&
						(f.layers.delete(m),
						f.layersWithOutsidePointerEventsDisabled.delete(m),
						DA());
				},
				[m, f],
			),
			(0, sr.useEffect)(() => {
				let F = () => y({});
				return (
					document.addEventListener(AE, F),
					() => document.removeEventListener(AE, F)
				);
			}, []),
			(0, sr.createElement)(
				Qt.div,
				je({}, u, {
					ref: E,
					style: {
						pointerEvents: k ? (N ? "auto" : "none") : void 0,
						...e.style,
					},
					onFocusCapture: mr(e.onFocusCapture, B.onFocusCapture),
					onBlurCapture: mr(e.onBlurCapture, B.onBlurCapture),
					onPointerDownCapture: mr(
						e.onPointerDownCapture,
						D.onPointerDownCapture,
					),
				}),
			)
		);
	});
function P9(e, t = globalThis?.document) {
	let r = uo(e),
		o = (0, sr.useRef)(!1),
		i = (0, sr.useRef)(() => {});
	return (
		(0, sr.useEffect)(() => {
			let a = (c) => {
					if (c.target && !o.current) {
						let u = function () {
								OA(k9, r, d, { discrete: !0 });
							},
							d = { originalEvent: c };
						c.pointerType === "touch"
							? (t.removeEventListener("click", i.current),
								(i.current = u),
								t.addEventListener("click", i.current, { once: !0 }))
							: u();
					}
					o.current = !1;
				},
				s = window.setTimeout(() => {
					t.addEventListener("pointerdown", a);
				}, 0);
			return () => {
				window.clearTimeout(s),
					t.removeEventListener("pointerdown", a),
					t.removeEventListener("click", i.current);
			};
		}, [t, r]),
		{ onPointerDownCapture: () => (o.current = !0) }
	);
}
function R9(e, t = globalThis?.document) {
	let r = uo(e),
		o = (0, sr.useRef)(!1);
	return (
		(0, sr.useEffect)(() => {
			let i = (a) => {
				a.target &&
					!o.current &&
					OA(L9, r, { originalEvent: a }, { discrete: !1 });
			};
			return (
				t.addEventListener("focusin", i),
				() => t.removeEventListener("focusin", i)
			);
		}, [t, r]),
		{
			onFocusCapture: () => (o.current = !0),
			onBlurCapture: () => (o.current = !1),
		}
	);
}
function DA() {
	let e = new CustomEvent(AE);
	document.dispatchEvent(e);
}
function OA(e, t, r, { discrete: o }) {
	let i = r.originalEvent.target,
		a = new CustomEvent(e, { bubbles: !1, cancelable: !0, detail: r });
	t && i.addEventListener(e, t, { once: !0 }),
		o ? LA(i, a) : i.dispatchEvent(a);
}
b();
var BA = w(Q()),
	kE = 0;
function zA() {
	(0, BA.useEffect)(() => {
		var e, t;
		let r = document.querySelectorAll("[data-radix-focus-guard]");
		return (
			document.body.insertAdjacentElement(
				"afterbegin",
				(e = r[0]) !== null && e !== void 0 ? e : FA(),
			),
			document.body.insertAdjacentElement(
				"beforeend",
				(t = r[1]) !== null && t !== void 0 ? t : FA(),
			),
			kE++,
			() => {
				kE === 1 &&
					document
						.querySelectorAll("[data-radix-focus-guard]")
						.forEach((o) => o.remove()),
					kE--;
			}
		);
	}, []);
}
function FA() {
	let e = document.createElement("span");
	return (
		e.setAttribute("data-radix-focus-guard", ""),
		(e.tabIndex = 0),
		(e.style.cssText =
			"outline: none; opacity: 0; position: fixed; pointer-events: none"),
		e
	);
}
b();
var ko = w(Q());
var LE = "focusScope.autoFocusOnMount",
	ME = "focusScope.autoFocusOnUnmount",
	$A = { bubbles: !1, cancelable: !0 };
var WA = (0, ko.forwardRef)((e, t) => {
	let {
			loop: r = !1,
			trapped: o = !1,
			onMountAutoFocus: i,
			onUnmountAutoFocus: a,
			...s
		} = e,
		[c, d] = (0, ko.useState)(null),
		u = uo(i),
		f = uo(a),
		m = (0, ko.useRef)(null),
		g = Hr(t, (E) => d(E)),
		h = (0, ko.useRef)({
			paused: !1,
			pause() {
				this.paused = !0;
			},
			resume() {
				this.paused = !1;
			},
		}).current;
	(0, ko.useEffect)(() => {
		if (o) {
			let E = function (I) {
					if (h.paused || !c) return;
					let P = I.target;
					c.contains(P) ? (m.current = P) : Yl(m.current, { select: !0 });
				},
				T = function (I) {
					h.paused ||
						!c ||
						c.contains(I.relatedTarget) ||
						Yl(m.current, { select: !0 });
				};
			return (
				document.addEventListener("focusin", E),
				document.addEventListener("focusout", T),
				() => {
					document.removeEventListener("focusin", E),
						document.removeEventListener("focusout", T);
				}
			);
		}
	}, [o, c, h.paused]),
		(0, ko.useEffect)(() => {
			if (c) {
				UA.add(h);
				let E = document.activeElement;
				if (!c.contains(E)) {
					let I = new CustomEvent(LE, $A);
					c.addEventListener(LE, u),
						c.dispatchEvent(I),
						I.defaultPrevented ||
							(D9(z9(KA(c)), { select: !0 }),
							document.activeElement === E && Yl(c));
				}
				return () => {
					c.removeEventListener(LE, u),
						setTimeout(() => {
							let I = new CustomEvent(ME, $A);
							c.addEventListener(ME, f),
								c.dispatchEvent(I),
								I.defaultPrevented || Yl(E ?? document.body, { select: !0 }),
								c.removeEventListener(ME, f),
								UA.remove(h);
						}, 0);
				};
			}
		}, [c, u, f, h]);
	let y = (0, ko.useCallback)(
		(E) => {
			if ((!r && !o) || h.paused) return;
			let T = E.key === "Tab" && !E.altKey && !E.ctrlKey && !E.metaKey,
				I = document.activeElement;
			if (T && I) {
				let P = E.currentTarget,
					[C, k] = N9(P);
				C && k
					? !E.shiftKey && I === k
						? (E.preventDefault(), r && Yl(C, { select: !0 }))
						: E.shiftKey &&
							I === C &&
							(E.preventDefault(), r && Yl(k, { select: !0 }))
					: I === P && E.preventDefault();
			}
		},
		[r, o, h.paused],
	);
	return (0, ko.createElement)(
		Qt.div,
		je({ tabIndex: -1 }, s, { ref: g, onKeyDown: y }),
	);
});
function D9(e, { select: t = !1 } = {}) {
	let r = document.activeElement;
	for (let o of e)
		if ((Yl(o, { select: t }), document.activeElement !== r)) return;
}
function N9(e) {
	let t = KA(e),
		r = HA(t, e),
		o = HA(t.reverse(), e);
	return [r, o];
}
function KA(e) {
	let t = [],
		r = document.createTreeWalker(e, NodeFilter.SHOW_ELEMENT, {
			acceptNode: (o) => {
				let i = o.tagName === "INPUT" && o.type === "hidden";
				return o.disabled || o.hidden || i
					? NodeFilter.FILTER_SKIP
					: o.tabIndex >= 0
						? NodeFilter.FILTER_ACCEPT
						: NodeFilter.FILTER_SKIP;
			},
		});
	for (; r.nextNode(); ) t.push(r.currentNode);
	return t;
}
function HA(e, t) {
	for (let r of e) if (!O9(r, { upTo: t })) return r;
}
function O9(e, { upTo: t }) {
	if (getComputedStyle(e).visibility === "hidden") return !0;
	for (; e; ) {
		if (t !== void 0 && e === t) return !1;
		if (getComputedStyle(e).display === "none") return !0;
		e = e.parentElement;
	}
	return !1;
}
function F9(e) {
	return e instanceof HTMLInputElement && "select" in e;
}
function Yl(e, { select: t = !1 } = {}) {
	if (e && e.focus) {
		let r = document.activeElement;
		e.focus({ preventScroll: !0 }), e !== r && F9(e) && t && e.select();
	}
}
var UA = B9();
function B9() {
	let e = [];
	return {
		add(t) {
			let r = e[0];
			t !== r && r?.pause(), (e = GA(e, t)), e.unshift(t);
		},
		remove(t) {
			var r;
			(e = GA(e, t)), (r = e[0]) === null || r === void 0 || r.resume();
		},
	};
}
function GA(e, t) {
	let r = [...e],
		o = r.indexOf(t);
	return o !== -1 && r.splice(o, 1), r;
}
function z9(e) {
	return e.filter((t) => t.tagName !== "A");
}
b();
var ag = w(Q());
b();
var YA = w(Q()),
	xn = globalThis?.document ? YA.useLayoutEffect : () => {};
var $9 = ag.useId || (() => {}),
	H9 = 0;
function Rc(e) {
	let [t, r] = ag.useState($9());
	return (
		xn(() => {
			e || r((o) => o ?? String(H9++));
		}, [e]),
		e || (t ? `radix-${t}` : "")
	);
}
b();
var Ft = w(Q());
b();
b();
b();
function Xl(e) {
	return e.split("-")[0];
}
function Cm(e) {
	return e.split("-")[1];
}
function Nc(e) {
	return ["top", "bottom"].includes(Xl(e)) ? "x" : "y";
}
function RE(e) {
	return e === "y" ? "height" : "width";
}
function VA(e, t, r) {
	let { reference: o, floating: i } = e,
		a = o.x + o.width / 2 - i.width / 2,
		s = o.y + o.height / 2 - i.height / 2,
		c = Nc(t),
		d = RE(c),
		u = o[d] / 2 - i[d] / 2,
		f = c === "x",
		m;
	switch (Xl(t)) {
		case "top":
			m = { x: a, y: o.y - i.height };
			break;
		case "bottom":
			m = { x: a, y: o.y + o.height };
			break;
		case "right":
			m = { x: o.x + o.width, y: s };
			break;
		case "left":
			m = { x: o.x - i.width, y: s };
			break;
		default:
			m = { x: o.x, y: o.y };
	}
	switch (Cm(t)) {
		case "start":
			m[c] -= u * (r && f ? -1 : 1);
			break;
		case "end":
			m[c] += u * (r && f ? -1 : 1);
	}
	return m;
}
var jA = async (e, t, r) => {
	let {
			placement: o = "bottom",
			strategy: i = "absolute",
			middleware: a = [],
			platform: s,
		} = r,
		c = await (s.isRTL == null ? void 0 : s.isRTL(t)),
		d = await s.getElementRects({ reference: e, floating: t, strategy: i }),
		{ x: u, y: f } = VA(d, o, c),
		m = o,
		g = {},
		h = 0;
	for (let y = 0; y < a.length; y++) {
		let { name: E, fn: T } = a[y],
			{
				x: I,
				y: P,
				data: C,
				reset: k,
			} = await T({
				x: u,
				y: f,
				initialPlacement: o,
				placement: m,
				strategy: i,
				middlewareData: g,
				rects: d,
				platform: s,
				elements: { reference: e, floating: t },
			});
		(u = I ?? u),
			(f = P ?? f),
			(g = { ...g, [E]: { ...g[E], ...C } }),
			k &&
				h <= 50 &&
				(h++,
				typeof k == "object" &&
					(k.placement && (m = k.placement),
					k.rects &&
						(d =
							k.rects === !0
								? await s.getElementRects({
										reference: e,
										floating: t,
										strategy: i,
									})
								: k.rects),
					({ x: u, y: f } = VA(d, m, c))),
				(y = -1));
	}
	return { x: u, y: f, placement: m, strategy: i, middlewareData: g };
};
function QA(e) {
	return typeof e != "number"
		? (function (t) {
				return { top: 0, right: 0, bottom: 0, left: 0, ...t };
			})(e)
		: { top: e, right: e, bottom: e, left: e };
}
function Tm(e) {
	return {
		...e,
		top: e.y,
		left: e.x,
		right: e.x + e.width,
		bottom: e.y + e.height,
	};
}
async function Dc(e, t) {
	var r;
	t === void 0 && (t = {});
	let { x: o, y: i, platform: a, rects: s, elements: c, strategy: d } = e,
		{
			boundary: u = "clippingAncestors",
			rootBoundary: f = "viewport",
			elementContext: m = "floating",
			altBoundary: g = !1,
			padding: h = 0,
		} = t,
		y = QA(h),
		E = c[g ? (m === "floating" ? "reference" : "floating") : m],
		T = Tm(
			await a.getClippingRect({
				element:
					(r = await (a.isElement == null ? void 0 : a.isElement(E))) == null ||
					r
						? E
						: E.contextElement ||
							(await (a.getDocumentElement == null
								? void 0
								: a.getDocumentElement(c.floating))),
				boundary: u,
				rootBoundary: f,
				strategy: d,
			}),
		),
		I = Tm(
			a.convertOffsetParentRelativeRectToViewportRelativeRect
				? await a.convertOffsetParentRelativeRectToViewportRelativeRect({
						rect:
							m === "floating" ? { ...s.floating, x: o, y: i } : s.reference,
						offsetParent: await (a.getOffsetParent == null
							? void 0
							: a.getOffsetParent(c.floating)),
						strategy: d,
					})
				: s[m],
		);
	return {
		top: T.top - I.top + y.top,
		bottom: I.bottom - T.bottom + y.bottom,
		left: T.left - I.left + y.left,
		right: I.right - T.right + y.right,
	};
}
var U9 = Math.min,
	Vl = Math.max;
function PE(e, t, r) {
	return Vl(e, U9(t, r));
}
var sg = (e) => ({
		name: "arrow",
		options: e,
		async fn(t) {
			let { element: r, padding: o = 0 } = e ?? {},
				{ x: i, y: a, placement: s, rects: c, platform: d } = t;
			if (r == null) return {};
			let u = QA(o),
				f = { x: i, y: a },
				m = Nc(s),
				g = Cm(s),
				h = RE(m),
				y = await d.getDimensions(r),
				E = m === "y" ? "top" : "left",
				T = m === "y" ? "bottom" : "right",
				I = c.reference[h] + c.reference[m] - f[m] - c.floating[h],
				P = f[m] - c.reference[m],
				C = await (d.getOffsetParent == null ? void 0 : d.getOffsetParent(r)),
				k = C ? (m === "y" ? C.clientHeight || 0 : C.clientWidth || 0) : 0;
			k === 0 && (k = c.floating[h]);
			let N = I / 2 - P / 2,
				D = u[E],
				B = k - y[h] - u[T],
				F = k / 2 - y[h] / 2 + N,
				W = PE(D, F, B),
				G =
					(g === "start" ? u[E] : u[T]) > 0 &&
					F !== W &&
					c.reference[h] <= c.floating[h];
			return {
				[m]: f[m] - (G ? (F < D ? D - F : B - F) : 0),
				data: { [m]: W, centerOffset: F - W },
			};
		},
	}),
	G9 = { left: "right", right: "left", bottom: "top", top: "bottom" };
function lg(e) {
	return e.replace(/left|right|bottom|top/g, (t) => G9[t]);
}
function W9(e, t, r) {
	r === void 0 && (r = !1);
	let o = Cm(e),
		i = Nc(e),
		a = RE(i),
		s =
			i === "x"
				? o === (r ? "end" : "start")
					? "right"
					: "left"
				: o === "start"
					? "bottom"
					: "top";
	return (
		t.reference[a] > t.floating[a] && (s = lg(s)), { main: s, cross: lg(s) }
	);
}
var K9 = { start: "end", end: "start" };
function XA(e) {
	return e.replace(/start|end/g, (t) => K9[t]);
}
var JA = ["top", "right", "bottom", "left"],
	BY = JA.reduce((e, t) => e.concat(t, t + "-start", t + "-end"), []);
var DE = function (e) {
	return (
		e === void 0 && (e = {}),
		{
			name: "flip",
			options: e,
			async fn(t) {
				var r;
				let {
						placement: o,
						middlewareData: i,
						rects: a,
						initialPlacement: s,
						platform: c,
						elements: d,
					} = t,
					{
						mainAxis: u = !0,
						crossAxis: f = !0,
						fallbackPlacements: m,
						fallbackStrategy: g = "bestFit",
						flipAlignment: h = !0,
						...y
					} = e,
					E = Xl(o),
					T =
						m ||
						(E === s || !h
							? [lg(s)]
							: (function (F) {
									let W = lg(F);
									return [XA(F), W, XA(W)];
								})(s)),
					I = [s, ...T],
					P = await Dc(t, y),
					C = [],
					k = ((r = i.flip) == null ? void 0 : r.overflows) || [];
				if ((u && C.push(P[E]), f)) {
					let { main: F, cross: W } = W9(
						o,
						a,
						await (c.isRTL == null ? void 0 : c.isRTL(d.floating)),
					);
					C.push(P[F], P[W]);
				}
				if (
					((k = [...k, { placement: o, overflows: C }]),
					!C.every((F) => F <= 0))
				) {
					var N, D;
					let F =
							((N = (D = i.flip) == null ? void 0 : D.index) != null ? N : 0) +
							1,
						W = I[F];
					if (W)
						return {
							data: { index: F, overflows: k },
							reset: { placement: W },
						};
					let G = "bottom";
					switch (g) {
						case "bestFit": {
							var B;
							let q =
								(B = k
									.map((ie) => [
										ie,
										ie.overflows
											.filter((te) => te > 0)
											.reduce((te, we) => te + we, 0),
									])
									.sort((ie, te) => ie[1] - te[1])[0]) == null
									? void 0
									: B[0].placement;
							q && (G = q);
							break;
						}
						case "initialPlacement":
							G = s;
					}
					if (o !== G) return { reset: { placement: G } };
				}
				return {};
			},
		}
	);
};
function ZA(e, t) {
	return {
		top: e.top - t.height,
		right: e.right - t.width,
		bottom: e.bottom - t.height,
		left: e.left - t.width,
	};
}
function qA(e) {
	return JA.some((t) => e[t] >= 0);
}
var NE = function (e) {
		let { strategy: t = "referenceHidden", ...r } = e === void 0 ? {} : e;
		return {
			name: "hide",
			async fn(o) {
				let { rects: i } = o;
				switch (t) {
					case "referenceHidden": {
						let a = ZA(
							await Dc(o, { ...r, elementContext: "reference" }),
							i.reference,
						);
						return {
							data: { referenceHiddenOffsets: a, referenceHidden: qA(a) },
						};
					}
					case "escaped": {
						let a = ZA(await Dc(o, { ...r, altBoundary: !0 }), i.floating);
						return { data: { escapedOffsets: a, escaped: qA(a) } };
					}
					default:
						return {};
				}
			},
		};
	},
	OE = function (e) {
		return (
			e === void 0 && (e = 0),
			{
				name: "offset",
				options: e,
				async fn(t) {
					let { x: r, y: o } = t,
						i = await (async function (a, s) {
							let { placement: c, platform: d, elements: u } = a,
								f = await (d.isRTL == null ? void 0 : d.isRTL(u.floating)),
								m = Xl(c),
								g = Cm(c),
								h = Nc(c) === "x",
								y = ["left", "top"].includes(m) ? -1 : 1,
								E = f && h ? -1 : 1,
								T = typeof s == "function" ? s(a) : s,
								{
									mainAxis: I,
									crossAxis: P,
									alignmentAxis: C,
								} = typeof T == "number"
									? { mainAxis: T, crossAxis: 0, alignmentAxis: null }
									: { mainAxis: 0, crossAxis: 0, alignmentAxis: null, ...T };
							return (
								g && typeof C == "number" && (P = g === "end" ? -1 * C : C),
								h ? { x: P * E, y: I * y } : { x: I * y, y: P * E }
							);
						})(t, e);
					return { x: r + i.x, y: o + i.y, data: i };
				},
			}
		);
	};
function ek(e) {
	return e === "x" ? "y" : "x";
}
var FE = function (e) {
		return (
			e === void 0 && (e = {}),
			{
				name: "shift",
				options: e,
				async fn(t) {
					let { x: r, y: o, placement: i } = t,
						{
							mainAxis: a = !0,
							crossAxis: s = !1,
							limiter: c = {
								fn: (T) => {
									let { x: I, y: P } = T;
									return { x: I, y: P };
								},
							},
							...d
						} = e,
						u = { x: r, y: o },
						f = await Dc(t, d),
						m = Nc(Xl(i)),
						g = ek(m),
						h = u[m],
						y = u[g];
					if (a) {
						let T = m === "y" ? "bottom" : "right";
						h = PE(h + f[m === "y" ? "top" : "left"], h, h - f[T]);
					}
					if (s) {
						let T = g === "y" ? "bottom" : "right";
						y = PE(y + f[g === "y" ? "top" : "left"], y, y - f[T]);
					}
					let E = c.fn({ ...t, [m]: h, [g]: y });
					return { ...E, data: { x: E.x - r, y: E.y - o } };
				},
			}
		);
	},
	BE = function (e) {
		return (
			e === void 0 && (e = {}),
			{
				options: e,
				fn(t) {
					let { x: r, y: o, placement: i, rects: a, middlewareData: s } = t,
						{ offset: c = 0, mainAxis: d = !0, crossAxis: u = !0 } = e,
						f = { x: r, y: o },
						m = Nc(i),
						g = ek(m),
						h = f[m],
						y = f[g],
						E = typeof c == "function" ? c({ ...a, placement: i }) : c,
						T =
							typeof E == "number"
								? { mainAxis: E, crossAxis: 0 }
								: { mainAxis: 0, crossAxis: 0, ...E };
					if (d) {
						let N = m === "y" ? "height" : "width",
							D = a.reference[m] - a.floating[N] + T.mainAxis,
							B = a.reference[m] + a.reference[N] - T.mainAxis;
						h < D ? (h = D) : h > B && (h = B);
					}
					if (u) {
						var I, P, C, k;
						let N = m === "y" ? "width" : "height",
							D = ["top", "left"].includes(Xl(i)),
							B =
								a.reference[g] -
								a.floating[N] +
								(D && (I = (P = s.offset) == null ? void 0 : P[g]) != null
									? I
									: 0) +
								(D ? 0 : T.crossAxis),
							F =
								a.reference[g] +
								a.reference[N] +
								(D
									? 0
									: (C = (k = s.offset) == null ? void 0 : k[g]) != null
										? C
										: 0) -
								(D ? T.crossAxis : 0);
						y < B ? (y = B) : y > F && (y = F);
					}
					return { [m]: h, [g]: y };
				},
			}
		);
	},
	zE = function (e) {
		return (
			e === void 0 && (e = {}),
			{
				name: "size",
				options: e,
				async fn(t) {
					let { placement: r, rects: o, platform: i, elements: a } = t,
						{ apply: s, ...c } = e,
						d = await Dc(t, c),
						u = Xl(r),
						f = Cm(r),
						m,
						g;
					u === "top" || u === "bottom"
						? ((m = u),
							(g =
								f ===
								((await (i.isRTL == null ? void 0 : i.isRTL(a.floating)))
									? "start"
									: "end")
									? "left"
									: "right"))
						: ((g = u), (m = f === "end" ? "top" : "bottom"));
					let h = Vl(d.left, 0),
						y = Vl(d.right, 0),
						E = Vl(d.top, 0),
						T = Vl(d.bottom, 0),
						I = {
							availableHeight:
								o.floating.height -
								(["left", "right"].includes(r)
									? 2 * (E !== 0 || T !== 0 ? E + T : Vl(d.top, d.bottom))
									: d[m]),
							availableWidth:
								o.floating.width -
								(["top", "bottom"].includes(r)
									? 2 * (h !== 0 || y !== 0 ? h + y : Vl(d.left, d.right))
									: d[g]),
						},
						P = await i.getDimensions(a.floating);
					s?.({ ...t, ...I });
					let C = await i.getDimensions(a.floating);
					return P.width !== C.width || P.height !== C.height
						? { reset: { rects: !0 } }
						: {};
				},
			}
		);
	};
function ak(e) {
	return e && e.document && e.location && e.alert && e.setInterval;
}
function Xi(e) {
	if (e == null) return window;
	if (!ak(e)) {
		let t = e.ownerDocument;
		return (t && t.defaultView) || window;
	}
	return e;
}
function _m(e) {
	return Xi(e).getComputedStyle(e);
}
function Yi(e) {
	return ak(e) ? "" : e ? (e.nodeName || "").toLowerCase() : "";
}
function lk() {
	let e = navigator.userAgentData;
	return e != null && e.brands
		? e.brands.map((t) => t.brand + "/" + t.version).join(" ")
		: navigator.userAgent;
}
function mi(e) {
	return e instanceof Xi(e).HTMLElement;
}
function Fa(e) {
	return e instanceof Xi(e).Element;
}
function HE(e) {
	return typeof ShadowRoot > "u"
		? !1
		: e instanceof Xi(e).ShadowRoot || e instanceof ShadowRoot;
}
function mg(e) {
	let { overflow: t, overflowX: r, overflowY: o } = _m(e);
	return /auto|scroll|overlay|hidden/.test(t + o + r);
}
function Y9(e) {
	return ["table", "td", "th"].includes(Yi(e));
}
function tk(e) {
	let t = /firefox/i.test(lk()),
		r = _m(e);
	return (
		r.transform !== "none" ||
		r.perspective !== "none" ||
		r.contain === "paint" ||
		["transform", "perspective"].includes(r.willChange) ||
		(t && r.willChange === "filter") ||
		(t && !!r.filter && r.filter !== "none")
	);
}
function sk() {
	return !/^((?!chrome|android).)*safari/i.test(lk());
}
var rk = Math.min,
	Im = Math.max,
	cg = Math.round;
function Vi(e, t, r) {
	var o, i, a, s;
	t === void 0 && (t = !1), r === void 0 && (r = !1);
	let c = e.getBoundingClientRect(),
		d = 1,
		u = 1;
	t &&
		mi(e) &&
		((d = (e.offsetWidth > 0 && cg(c.width) / e.offsetWidth) || 1),
		(u = (e.offsetHeight > 0 && cg(c.height) / e.offsetHeight) || 1));
	let f = Fa(e) ? Xi(e) : window,
		m = !sk() && r,
		g =
			(c.left +
				(m &&
				(o = (i = f.visualViewport) == null ? void 0 : i.offsetLeft) != null
					? o
					: 0)) /
			d,
		h =
			(c.top +
				(m &&
				(a = (s = f.visualViewport) == null ? void 0 : s.offsetTop) != null
					? a
					: 0)) /
			u,
		y = c.width / d,
		E = c.height / u;
	return {
		width: y,
		height: E,
		top: h,
		right: g + y,
		bottom: h + E,
		left: g,
		x: g,
		y: h,
	};
}
function Oa(e) {
	return ((t = e),
	(t instanceof Xi(t).Node ? e.ownerDocument : e.document) || window.document)
		.documentElement;
	var t;
}
function ug(e) {
	return Fa(e)
		? { scrollLeft: e.scrollLeft, scrollTop: e.scrollTop }
		: { scrollLeft: e.pageXOffset, scrollTop: e.pageYOffset };
}
function ck(e) {
	return Vi(Oa(e)).left + ug(e).scrollLeft;
}
function V9(e, t, r) {
	let o = mi(t),
		i = Oa(t),
		a = Vi(
			e,
			o &&
				(function (d) {
					let u = Vi(d);
					return (
						cg(u.width) !== d.offsetWidth || cg(u.height) !== d.offsetHeight
					);
				})(t),
			r === "fixed",
		),
		s = { scrollLeft: 0, scrollTop: 0 },
		c = { x: 0, y: 0 };
	if (o || (!o && r !== "fixed"))
		if (((Yi(t) !== "body" || mg(i)) && (s = ug(t)), mi(t))) {
			let d = Vi(t, !0);
			(c.x = d.x + t.clientLeft), (c.y = d.y + t.clientTop);
		} else i && (c.x = ck(i));
	return {
		x: a.left + s.scrollLeft - c.x,
		y: a.top + s.scrollTop - c.y,
		width: a.width,
		height: a.height,
	};
}
function dk(e) {
	return Yi(e) === "html"
		? e
		: e.assignedSlot || e.parentNode || (HE(e) ? e.host : null) || Oa(e);
}
function ok(e) {
	return mi(e) && getComputedStyle(e).position !== "fixed"
		? e.offsetParent
		: null;
}
function $E(e) {
	let t = Xi(e),
		r = ok(e);
	for (; r && Y9(r) && getComputedStyle(r).position === "static"; ) r = ok(r);
	return r &&
		(Yi(r) === "html" ||
			(Yi(r) === "body" && getComputedStyle(r).position === "static" && !tk(r)))
		? t
		: r ||
				(function (o) {
					let i = dk(o);
					for (
						HE(i) && (i = i.host);
						mi(i) && !["html", "body"].includes(Yi(i));
					) {
						if (tk(i)) return i;
						i = i.parentNode;
					}
					return null;
				})(e) ||
				t;
}
function nk(e) {
	if (mi(e)) return { width: e.offsetWidth, height: e.offsetHeight };
	let t = Vi(e);
	return { width: t.width, height: t.height };
}
function mk(e) {
	let t = dk(e);
	return ["html", "body", "#document"].includes(Yi(t))
		? e.ownerDocument.body
		: mi(t) && mg(t)
			? t
			: mk(t);
}
function dg(e, t) {
	var r;
	t === void 0 && (t = []);
	let o = mk(e),
		i = o === ((r = e.ownerDocument) == null ? void 0 : r.body),
		a = Xi(o),
		s = i ? [a].concat(a.visualViewport || [], mg(o) ? o : []) : o,
		c = t.concat(s);
	return i ? c : c.concat(dg(s));
}
function ik(e, t, r) {
	return t === "viewport"
		? Tm(
				(function (o, i) {
					let a = Xi(o),
						s = Oa(o),
						c = a.visualViewport,
						d = s.clientWidth,
						u = s.clientHeight,
						f = 0,
						m = 0;
					if (c) {
						(d = c.width), (u = c.height);
						let g = sk();
						(g || (!g && i === "fixed")) &&
							((f = c.offsetLeft), (m = c.offsetTop));
					}
					return { width: d, height: u, x: f, y: m };
				})(e, r),
			)
		: Fa(t)
			? (function (o, i) {
					let a = Vi(o, !1, i === "fixed"),
						s = a.top + o.clientTop,
						c = a.left + o.clientLeft;
					return {
						top: s,
						left: c,
						x: c,
						y: s,
						right: c + o.clientWidth,
						bottom: s + o.clientHeight,
						width: o.clientWidth,
						height: o.clientHeight,
					};
				})(t, r)
			: Tm(
					(function (o) {
						var i;
						let a = Oa(o),
							s = ug(o),
							c = (i = o.ownerDocument) == null ? void 0 : i.body,
							d = Im(
								a.scrollWidth,
								a.clientWidth,
								c ? c.scrollWidth : 0,
								c ? c.clientWidth : 0,
							),
							u = Im(
								a.scrollHeight,
								a.clientHeight,
								c ? c.scrollHeight : 0,
								c ? c.clientHeight : 0,
							),
							f = -s.scrollLeft + ck(o),
							m = -s.scrollTop;
						return (
							_m(c || a).direction === "rtl" &&
								(f += Im(a.clientWidth, c ? c.clientWidth : 0) - d),
							{ width: d, height: u, x: f, y: m }
						);
					})(Oa(e)),
				);
}
function X9(e) {
	let t = dg(e),
		r = ["absolute", "fixed"].includes(_m(e).position) && mi(e) ? $E(e) : e;
	return Fa(r)
		? t.filter(
				(o) =>
					Fa(o) &&
					(function (i, a) {
						let s = a.getRootNode == null ? void 0 : a.getRootNode();
						if (i.contains(a)) return !0;
						if (s && HE(s)) {
							let c = a;
							do {
								if (c && i === c) return !0;
								c = c.parentNode || c.host;
							} while (c);
						}
						return !1;
					})(o, r) &&
					Yi(o) !== "body",
			)
		: [];
}
var Z9 = {
	getClippingRect: function (e) {
		let { element: t, boundary: r, rootBoundary: o, strategy: i } = e,
			a = [...(r === "clippingAncestors" ? X9(t) : [].concat(r)), o],
			s = a[0],
			c = a.reduce(
				(d, u) => {
					let f = ik(t, u, i);
					return (
						(d.top = Im(f.top, d.top)),
						(d.right = rk(f.right, d.right)),
						(d.bottom = rk(f.bottom, d.bottom)),
						(d.left = Im(f.left, d.left)),
						d
					);
				},
				ik(t, s, i),
			);
		return {
			width: c.right - c.left,
			height: c.bottom - c.top,
			x: c.left,
			y: c.top,
		};
	},
	convertOffsetParentRelativeRectToViewportRelativeRect: function (e) {
		let { rect: t, offsetParent: r, strategy: o } = e,
			i = mi(r),
			a = Oa(r);
		if (r === a) return t;
		let s = { scrollLeft: 0, scrollTop: 0 },
			c = { x: 0, y: 0 };
		if (
			(i || (!i && o !== "fixed")) &&
			((Yi(r) !== "body" || mg(a)) && (s = ug(r)), mi(r))
		) {
			let d = Vi(r, !0);
			(c.x = d.x + r.clientLeft), (c.y = d.y + r.clientTop);
		}
		return { ...t, x: t.x - s.scrollLeft + c.x, y: t.y - s.scrollTop + c.y };
	},
	isElement: Fa,
	getDimensions: nk,
	getOffsetParent: $E,
	getDocumentElement: Oa,
	getElementRects: (e) => {
		let { reference: t, floating: r, strategy: o } = e;
		return { reference: V9(t, $E(r), o), floating: { ...nk(r), x: 0, y: 0 } };
	},
	getClientRects: (e) => Array.from(e.getClientRects()),
	isRTL: (e) => _m(e).direction === "rtl",
};
function uk(e, t, r, o) {
	o === void 0 && (o = {});
	let {
			ancestorScroll: i = !0,
			ancestorResize: a = !0,
			elementResize: s = !0,
			animationFrame: c = !1,
		} = o,
		d = i && !c,
		u = a && !c,
		f = d || u ? [...(Fa(e) ? dg(e) : []), ...dg(t)] : [];
	f.forEach((y) => {
		d && y.addEventListener("scroll", r, { passive: !0 }),
			u && y.addEventListener("resize", r);
	});
	let m,
		g = null;
	if (s) {
		let y = !0;
		(g = new ResizeObserver(() => {
			y || r(), (y = !1);
		})),
			Fa(e) && !c && g.observe(e),
			g.observe(t);
	}
	let h = c ? Vi(e) : null;
	return (
		c &&
			(function y() {
				let E = Vi(e);
				!h ||
					(E.x === h.x &&
						E.y === h.y &&
						E.width === h.width &&
						E.height === h.height) ||
					r(),
					(h = E),
					(m = requestAnimationFrame(y));
			})(),
		r(),
		() => {
			var y;
			f.forEach((E) => {
				d && E.removeEventListener("scroll", r),
					u && E.removeEventListener("resize", r);
			}),
				(y = g) == null || y.disconnect(),
				(g = null),
				c && cancelAnimationFrame(m);
		}
	);
}
var pk = (e, t, r) => jA(e, t, { platform: Z9, ...r });
var Ur = w(Q()),
	pg = w(Q()),
	fk = w(Gn()),
	UE = typeof document < "u" ? pg.useLayoutEffect : pg.useEffect;
function GE(e, t) {
	if (e === t) return !0;
	if (typeof e != typeof t) return !1;
	if (typeof e == "function" && e.toString() === t.toString()) return !0;
	let r, o, i;
	if (e && t && typeof e == "object") {
		if (Array.isArray(e)) {
			if (((r = e.length), r != t.length)) return !1;
			for (o = r; o-- !== 0; ) if (!GE(e[o], t[o])) return !1;
			return !0;
		}
		if (((i = Object.keys(e)), (r = i.length), r !== Object.keys(t).length))
			return !1;
		for (o = r; o-- !== 0; )
			if (!Object.prototype.hasOwnProperty.call(t, i[o])) return !1;
		for (o = r; o-- !== 0; ) {
			let a = i[o];
			if (!(a === "_owner" && e.$$typeof) && !GE(e[a], t[a])) return !1;
		}
		return !0;
	}
	return e !== e && t !== t;
}
function q9(e) {
	let t = Ur.useRef(e);
	return (
		UE(() => {
			t.current = e;
		}),
		t
	);
}
function gk(e) {
	let {
			middleware: t,
			placement: r = "bottom",
			strategy: o = "absolute",
			whileElementsMounted: i,
		} = e === void 0 ? {} : e,
		a = Ur.useRef(null),
		s = Ur.useRef(null),
		c = q9(i),
		d = Ur.useRef(null),
		[u, f] = Ur.useState({
			x: null,
			y: null,
			strategy: o,
			placement: r,
			middlewareData: {},
		}),
		[m, g] = Ur.useState(t);
	GE(
		m?.map((C) => {
			let { options: k } = C;
			return k;
		}),
		t?.map((C) => {
			let { options: k } = C;
			return k;
		}),
	) || g(t);
	let h = Ur.useCallback(() => {
		!a.current ||
			!s.current ||
			pk(a.current, s.current, {
				middleware: m,
				placement: r,
				strategy: o,
			}).then((C) => {
				y.current &&
					fk.flushSync(() => {
						f(C);
					});
			});
	}, [m, r, o]);
	UE(() => {
		y.current && h();
	}, [h]);
	let y = Ur.useRef(!1);
	UE(
		() => (
			(y.current = !0),
			() => {
				y.current = !1;
			}
		),
		[],
	);
	let E = Ur.useCallback(() => {
			if (
				(typeof d.current == "function" && (d.current(), (d.current = null)),
				a.current && s.current)
			)
				if (c.current) {
					let C = c.current(a.current, s.current, h);
					d.current = C;
				} else h();
		}, [h, c]),
		T = Ur.useCallback(
			(C) => {
				(a.current = C), E();
			},
			[E],
		),
		I = Ur.useCallback(
			(C) => {
				(s.current = C), E();
			},
			[E],
		),
		P = Ur.useMemo(() => ({ reference: a, floating: s }), []);
	return Ur.useMemo(
		() => ({ ...u, update: h, refs: P, reference: T, floating: I }),
		[u, h, P, T, I],
	);
}
var hk = (e) => {
	let { element: t, padding: r } = e;
	function o(i) {
		return Object.prototype.hasOwnProperty.call(i, "current");
	}
	return {
		name: "arrow",
		options: e,
		fn(i) {
			return o(t)
				? t.current != null
					? sg({ element: t.current, padding: r }).fn(i)
					: {}
				: t
					? sg({ element: t, padding: r }).fn(i)
					: {};
		},
	};
};
b();
var Am = w(Q());
var j9 = (0, Am.forwardRef)((e, t) => {
		let { children: r, width: o = 10, height: i = 5, ...a } = e;
		return (0, Am.createElement)(
			Qt.svg,
			je({}, a, {
				ref: t,
				width: o,
				height: i,
				viewBox: "0 0 30 10",
				preserveAspectRatio: "none",
			}),
			e.asChild
				? r
				: (0, Am.createElement)("polygon", { points: "0,0 30,0 15,10" }),
		);
	}),
	bk = j9;
b();
var xk = w(Q());
function vk(e) {
	let [t, r] = (0, xk.useState)(void 0);
	return (
		xn(() => {
			if (e) {
				r({ width: e.offsetWidth, height: e.offsetHeight });
				let o = new ResizeObserver((i) => {
					if (!Array.isArray(i) || !i.length) return;
					let a = i[0],
						s,
						c;
					if ("borderBoxSize" in a) {
						let d = a.borderBoxSize,
							u = Array.isArray(d) ? d[0] : d;
						(s = u.inlineSize), (c = u.blockSize);
					} else (s = e.offsetWidth), (c = e.offsetHeight);
					r({ width: s, height: c });
				});
				return o.observe(e, { box: "border-box" }), () => o.unobserve(e);
			} else r(void 0);
		}, [e]),
		t
	);
}
var Ek = "Popper",
	[WE, KE] = di(Ek),
	[Q9, yk] = WE(Ek),
	J9 = (e) => {
		let { __scopePopper: t, children: r } = e,
			[o, i] = (0, Ft.useState)(null);
		return (0, Ft.createElement)(
			Q9,
			{ scope: t, anchor: o, onAnchorChange: i },
			r,
		);
	},
	eF = "PopperAnchor",
	tF = (0, Ft.forwardRef)((e, t) => {
		let { __scopePopper: r, virtualRef: o, ...i } = e,
			a = yk(eF, r),
			s = (0, Ft.useRef)(null),
			c = Hr(t, s);
		return (
			(0, Ft.useEffect)(() => {
				a.onAnchorChange(o?.current || s.current);
			}),
			o ? null : (0, Ft.createElement)(Qt.div, je({}, i, { ref: c }))
		);
	}),
	fg = "PopperContent",
	[rF, oF] = WE(fg),
	[nF, iF] = WE(fg, { hasParent: !1, positionUpdateFns: new Set() }),
	aF = (0, Ft.forwardRef)((e, t) => {
		var r, o, i, a, s, c, d, u;
		let {
				__scopePopper: f,
				side: m = "bottom",
				sideOffset: g = 0,
				align: h = "center",
				alignOffset: y = 0,
				arrowPadding: E = 0,
				collisionBoundary: T = [],
				collisionPadding: I = 0,
				sticky: P = "partial",
				hideWhenDetached: C = !1,
				avoidCollisions: k = !0,
				onPlaced: N,
				...D
			} = e,
			B = yk(fg, f),
			[F, W] = (0, Ft.useState)(null),
			G = Hr(t, (aa) => W(aa)),
			[q, ie] = (0, Ft.useState)(null),
			te = vk(q),
			we = (r = te?.width) !== null && r !== void 0 ? r : 0,
			X = (o = te?.height) !== null && o !== void 0 ? o : 0,
			se = m + (h !== "center" ? "-" + h : ""),
			Pe =
				typeof I == "number"
					? I
					: { top: 0, right: 0, bottom: 0, left: 0, ...I },
			ke = Array.isArray(T) ? T : [T],
			fe = ke.length > 0,
			Y = { padding: Pe, boundary: ke.filter(mF), altBoundary: fe },
			{
				reference: K,
				floating: ee,
				strategy: le,
				x: ce,
				y: ue,
				placement: ge,
				middlewareData: Se,
				update: Dt,
			} = gk({
				strategy: "fixed",
				placement: se,
				whileElementsMounted: uk,
				middleware: [
					uF(),
					OE({ mainAxis: g + X, alignmentAxis: y }),
					k
						? FE({
								mainAxis: !0,
								crossAxis: !1,
								limiter: P === "partial" ? BE() : void 0,
								...Y,
							})
						: void 0,
					q ? hk({ element: q, padding: E }) : void 0,
					k ? DE({ ...Y }) : void 0,
					zE({
						...Y,
						apply: ({
							elements: aa,
							availableWidth: sl,
							availableHeight: yb,
						}) => {
							aa.floating.style.setProperty(
								"--radix-popper-available-width",
								`${sl}px`,
							),
								aa.floating.style.setProperty(
									"--radix-popper-available-height",
									`${yb}px`,
								);
						},
					}),
					pF({ arrowWidth: we, arrowHeight: X }),
					C ? NE({ strategy: "referenceHidden" }) : void 0,
				].filter(dF),
			});
		xn(() => {
			K(B.anchor);
		}, [K, B.anchor]);
		let St = ce !== null && ue !== null,
			[_t, Tt] = wk(ge),
			cr = uo(N);
		xn(() => {
			St && cr?.();
		}, [St, cr]);
		let Do = (i = Se.arrow) === null || i === void 0 ? void 0 : i.x,
			ia = (a = Se.arrow) === null || a === void 0 ? void 0 : a.y,
			Or =
				((s = Se.arrow) === null || s === void 0 ? void 0 : s.centerOffset) !==
				0,
			[No, Eb] = (0, Ft.useState)();
		xn(() => {
			F && Eb(window.getComputedStyle(F).zIndex);
		}, [F]);
		let { hasParent: al, positionUpdateFns: Cr } = iF(fg, f),
			kn = !al;
		(0, Ft.useLayoutEffect)(() => {
			if (!kn)
				return (
					Cr.add(Dt),
					() => {
						Cr.delete(Dt);
					}
				);
		}, [kn, Cr, Dt]),
			xn(() => {
				kn &&
					St &&
					Array.from(Cr)
						.reverse()
						.forEach((aa) => requestAnimationFrame(aa));
			}, [kn, St, Cr]);
		let ll = {
			"data-side": _t,
			"data-align": Tt,
			...D,
			ref: G,
			style: {
				...D.style,
				animation: St ? void 0 : "none",
				opacity:
					(c = Se.hide) !== null && c !== void 0 && c.referenceHidden
						? 0
						: void 0,
			},
		};
		return (0, Ft.createElement)(
			"div",
			{
				ref: ee,
				"data-radix-popper-content-wrapper": "",
				style: {
					position: le,
					left: 0,
					top: 0,
					transform: St
						? `translate3d(${Math.round(ce)}px, ${Math.round(ue)}px, 0)`
						: "translate3d(0, -200%, 0)",
					minWidth: "max-content",
					zIndex: No,
					"--radix-popper-transform-origin": [
						(d = Se.transformOrigin) === null || d === void 0 ? void 0 : d.x,
						(u = Se.transformOrigin) === null || u === void 0 ? void 0 : u.y,
					].join(" "),
				},
				dir: e.dir,
			},
			(0, Ft.createElement)(
				rF,
				{
					scope: f,
					placedSide: _t,
					onArrowChange: ie,
					arrowX: Do,
					arrowY: ia,
					shouldHideArrow: Or,
				},
				kn
					? (0, Ft.createElement)(
							nF,
							{ scope: f, hasParent: !0, positionUpdateFns: Cr },
							(0, Ft.createElement)(Qt.div, ll),
						)
					: (0, Ft.createElement)(Qt.div, ll),
			),
		);
	}),
	lF = "PopperArrow",
	sF = { top: "bottom", right: "left", bottom: "top", left: "right" },
	cF = (0, Ft.forwardRef)(function (t, r) {
		let { __scopePopper: o, ...i } = t,
			a = oF(lF, o),
			s = sF[a.placedSide];
		return (0, Ft.createElement)(
			"span",
			{
				ref: a.onArrowChange,
				style: {
					position: "absolute",
					left: a.arrowX,
					top: a.arrowY,
					[s]: 0,
					transformOrigin: {
						top: "",
						right: "0 0",
						bottom: "center 0",
						left: "100% 0",
					}[a.placedSide],
					transform: {
						top: "translateY(100%)",
						right: "translateY(50%) rotate(90deg) translateX(-50%)",
						bottom: "rotate(180deg)",
						left: "translateY(50%) rotate(-90deg) translateX(50%)",
					}[a.placedSide],
					visibility: a.shouldHideArrow ? "hidden" : void 0,
				},
			},
			(0, Ft.createElement)(
				bk,
				je({}, i, { ref: r, style: { ...i.style, display: "block" } }),
			),
		);
	});
function dF(e) {
	return e !== void 0;
}
function mF(e) {
	return e !== null;
}
var uF = () => ({
		name: "anchorCssProperties",
		fn(e) {
			let { rects: t, elements: r } = e,
				{ width: o, height: i } = t.reference;
			return (
				r.floating.style.setProperty("--radix-popper-anchor-width", `${o}px`),
				r.floating.style.setProperty("--radix-popper-anchor-height", `${i}px`),
				{}
			);
		},
	}),
	pF = (e) => ({
		name: "transformOrigin",
		options: e,
		fn(t) {
			var r, o, i, a, s;
			let { placement: c, rects: d, middlewareData: u } = t,
				m =
					((r = u.arrow) === null || r === void 0 ? void 0 : r.centerOffset) !==
					0,
				g = m ? 0 : e.arrowWidth,
				h = m ? 0 : e.arrowHeight,
				[y, E] = wk(c),
				T = { start: "0%", center: "50%", end: "100%" }[E],
				I =
					((o = (i = u.arrow) === null || i === void 0 ? void 0 : i.x) !==
						null && o !== void 0
						? o
						: 0) +
					g / 2,
				P =
					((a = (s = u.arrow) === null || s === void 0 ? void 0 : s.y) !==
						null && a !== void 0
						? a
						: 0) +
					h / 2,
				C = "",
				k = "";
			return (
				y === "bottom"
					? ((C = m ? T : `${I}px`), (k = `${-h}px`))
					: y === "top"
						? ((C = m ? T : `${I}px`), (k = `${d.floating.height + h}px`))
						: y === "right"
							? ((C = `${-h}px`), (k = m ? T : `${P}px`))
							: y === "left" &&
								((C = `${d.floating.width + h}px`), (k = m ? T : `${P}px`)),
				{ data: { x: C, y: k } }
			);
		},
	});
function wk(e) {
	let [t, r = "center"] = e.split("-");
	return [t, r];
}
var Sk = J9,
	Tk = tF,
	Ck = aF,
	Ik = cF;
b();
var gg = w(Q()),
	_k = w(Gn());
var Ak = (0, gg.forwardRef)((e, t) => {
	var r;
	let {
		container: o = globalThis == null ||
		(r = globalThis.document) === null ||
		r === void 0
			? void 0
			: r.body,
		...i
	} = e;
	return o
		? _k.default.createPortal(
				(0, gg.createElement)(Qt.div, je({}, i, { ref: t })),
				o,
			)
		: null;
});
b();
var Xr = w(Q()),
	kk = w(Gn());
function fF(e, t) {
	return (0, Xr.useReducer)((r, o) => {
		let i = t[r][o];
		return i ?? r;
	}, e);
}
var Oc = (e) => {
	let { present: t, children: r } = e,
		o = gF(t),
		i =
			typeof r == "function"
				? r({ present: o.isPresent })
				: Xr.Children.only(r),
		a = Hr(o.ref, i.ref);
	return typeof r == "function" || o.isPresent
		? (0, Xr.cloneElement)(i, { ref: a })
		: null;
};
Oc.displayName = "Presence";
function gF(e) {
	let [t, r] = (0, Xr.useState)(),
		o = (0, Xr.useRef)({}),
		i = (0, Xr.useRef)(e),
		a = (0, Xr.useRef)("none"),
		s = e ? "mounted" : "unmounted",
		[c, d] = fF(s, {
			mounted: { UNMOUNT: "unmounted", ANIMATION_OUT: "unmountSuspended" },
			unmountSuspended: { MOUNT: "mounted", ANIMATION_END: "unmounted" },
			unmounted: { MOUNT: "mounted" },
		});
	return (
		(0, Xr.useEffect)(() => {
			let u = hg(o.current);
			a.current = c === "mounted" ? u : "none";
		}, [c]),
		xn(() => {
			let u = o.current,
				f = i.current;
			if (f !== e) {
				let g = a.current,
					h = hg(u);
				e
					? d("MOUNT")
					: h === "none" || u?.display === "none"
						? d("UNMOUNT")
						: d(f && g !== h ? "ANIMATION_OUT" : "UNMOUNT"),
					(i.current = e);
			}
		}, [e, d]),
		xn(() => {
			if (t) {
				let u = (m) => {
						let h = hg(o.current).includes(m.animationName);
						m.target === t && h && (0, kk.flushSync)(() => d("ANIMATION_END"));
					},
					f = (m) => {
						m.target === t && (a.current = hg(o.current));
					};
				return (
					t.addEventListener("animationstart", f),
					t.addEventListener("animationcancel", u),
					t.addEventListener("animationend", u),
					() => {
						t.removeEventListener("animationstart", f),
							t.removeEventListener("animationcancel", u),
							t.removeEventListener("animationend", u);
					}
				);
			} else d("ANIMATION_END");
		}, [t, d]),
		{
			isPresent: ["mounted", "unmountSuspended"].includes(c),
			ref: (0, Xr.useCallback)((u) => {
				u && (o.current = getComputedStyle(u)), r(u);
			}, []),
		}
	);
}
function hg(e) {
	return e?.animationName || "none";
}
b();
var Ba = w(Q());
function Fc({ prop: e, defaultProp: t, onChange: r = () => {} }) {
	let [o, i] = hF({ defaultProp: t, onChange: r }),
		a = e !== void 0,
		s = a ? e : o,
		c = uo(r),
		d = (0, Ba.useCallback)(
			(u) => {
				if (a) {
					let m = typeof u == "function" ? u(e) : u;
					m !== e && c(m);
				} else i(u);
			},
			[a, e, i, c],
		);
	return [s, d];
}
function hF({ defaultProp: e, onChange: t }) {
	let r = (0, Ba.useState)(e),
		[o] = r,
		i = (0, Ba.useRef)(o),
		a = uo(t);
	return (
		(0, Ba.useEffect)(() => {
			i.current !== o && (a(o), (i.current = o));
		}, [o, i, a]),
		r
	);
}
b();
var bF = function (e) {
		if (typeof document > "u") return null;
		var t = Array.isArray(e) ? e[0] : e;
		return t.ownerDocument.body;
	},
	Bc = new WeakMap(),
	bg = new WeakMap(),
	xg = {},
	YE = 0,
	Lk = function (e) {
		return e && (e.host || Lk(e.parentNode));
	},
	xF = function (e, t) {
		return t
			.map(function (r) {
				if (e.contains(r)) return r;
				var o = Lk(r);
				return o && e.contains(o)
					? o
					: (console.error(
							"aria-hidden",
							r,
							"in not contained inside",
							e,
							". Doing nothing",
						),
						null);
			})
			.filter(function (r) {
				return !!r;
			});
	},
	vF = function (e, t, r, o) {
		var i = xF(t, Array.isArray(e) ? e : [e]);
		xg[r] || (xg[r] = new WeakMap());
		var a = xg[r],
			s = [],
			c = new Set(),
			d = new Set(i),
			u = function (m) {
				!m || c.has(m) || (c.add(m), u(m.parentNode));
			};
		i.forEach(u);
		var f = function (m) {
			!m ||
				d.has(m) ||
				Array.prototype.forEach.call(m.children, function (g) {
					if (c.has(g)) f(g);
					else
						try {
							var h = g.getAttribute(o),
								y = h !== null && h !== "false",
								E = (Bc.get(g) || 0) + 1,
								T = (a.get(g) || 0) + 1;
							Bc.set(g, E),
								a.set(g, T),
								s.push(g),
								E === 1 && y && bg.set(g, !0),
								T === 1 && g.setAttribute(r, "true"),
								y || g.setAttribute(o, "true");
						} catch (I) {
							console.error("aria-hidden: cannot operate on ", g, I);
						}
				});
		};
		return (
			f(t),
			c.clear(),
			YE++,
			function () {
				s.forEach(function (m) {
					var g = Bc.get(m) - 1,
						h = a.get(m) - 1;
					Bc.set(m, g),
						a.set(m, h),
						g || (bg.has(m) || m.removeAttribute(o), bg.delete(m)),
						h || m.removeAttribute(r);
				}),
					YE--,
					YE ||
						((Bc = new WeakMap()),
						(Bc = new WeakMap()),
						(bg = new WeakMap()),
						(xg = {}));
			}
		);
	},
	Mk = function (e, t, r) {
		r === void 0 && (r = "data-aria-hidden");
		var o = Array.from(Array.isArray(e) ? e : [e]),
			i = t || bF(e);
		return i
			? (o.push.apply(o, Array.from(i.querySelectorAll("[aria-live]"))),
				vF(o, i, r, "aria-hidden"))
			: function () {
					return null;
				};
	};
b();
b();
b();
var Lo = function () {
	return (
		(Lo =
			Object.assign ||
			function (t) {
				for (var r, o = 1, i = arguments.length; o < i; o++) {
					r = arguments[o];
					for (var a in r)
						Object.prototype.hasOwnProperty.call(r, a) && (t[a] = r[a]);
				}
				return t;
			}),
		Lo.apply(this, arguments)
	);
};
function vg(e, t) {
	var r = {};
	for (var o in e)
		Object.prototype.hasOwnProperty.call(e, o) &&
			t.indexOf(o) < 0 &&
			(r[o] = e[o]);
	if (e != null && typeof Object.getOwnPropertySymbols == "function")
		for (var i = 0, o = Object.getOwnPropertySymbols(e); i < o.length; i++)
			t.indexOf(o[i]) < 0 &&
				Object.prototype.propertyIsEnumerable.call(e, o[i]) &&
				(r[o[i]] = e[o[i]]);
	return r;
}
function Pk(e, t, r) {
	if (r || arguments.length === 2)
		for (var o = 0, i = t.length, a; o < i; o++)
			(a || !(o in t)) &&
				(a || (a = Array.prototype.slice.call(t, 0, o)), (a[o] = t[o]));
	return e.concat(a || Array.prototype.slice.call(t));
}
var Tg = w(Q());
b();
var Zr = w(Q());
b();
var Zl = "right-scroll-bar-position",
	ql = "width-before-scroll-bar",
	VE = "with-scroll-bars-hidden",
	XE = "--removed-body-scroll-bar-size";
b();
b();
function Eg(e, t) {
	return typeof e == "function" ? e(t) : e && (e.current = t), e;
}
b();
var Rk = w(Q());
function Dk(e, t) {
	var r = (0, Rk.useState)(function () {
		return {
			value: e,
			callback: t,
			facade: {
				get current() {
					return r.value;
				},
				set current(o) {
					var i = r.value;
					i !== o && ((r.value = o), r.callback(o, i));
				},
			},
		};
	})[0];
	return (r.callback = t), r.facade;
}
b();
var yg = w(Q());
var EF = typeof window < "u" ? yg.useLayoutEffect : yg.useEffect,
	Nk = new WeakMap();
function ZE(e, t) {
	var r = Dk(t || null, function (o) {
		return e.forEach(function (i) {
			return Eg(i, o);
		});
	});
	return (
		EF(
			function () {
				var o = Nk.get(r);
				if (o) {
					var i = new Set(o),
						a = new Set(e),
						s = r.current;
					i.forEach(function (c) {
						a.has(c) || Eg(c, null);
					}),
						a.forEach(function (c) {
							i.has(c) || Eg(c, s);
						});
				}
				Nk.set(r, e);
			},
			[e],
		),
		r
	);
}
b();
b();
b();
function yF(e) {
	return e;
}
function wF(e, t) {
	t === void 0 && (t = yF);
	var r = [],
		o = !1,
		i = {
			read: function () {
				if (o)
					throw new Error(
						"Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.",
					);
				return r.length ? r[r.length - 1] : e;
			},
			useMedium: function (a) {
				var s = t(a, o);
				return (
					r.push(s),
					function () {
						r = r.filter(function (c) {
							return c !== s;
						});
					}
				);
			},
			assignSyncMedium: function (a) {
				for (o = !0; r.length; ) {
					var s = r;
					(r = []), s.forEach(a);
				}
				r = {
					push: function (c) {
						return a(c);
					},
					filter: function () {
						return r;
					},
				};
			},
			assignMedium: function (a) {
				o = !0;
				var s = [];
				if (r.length) {
					var c = r;
					(r = []), c.forEach(a), (s = r);
				}
				var d = function () {
						var f = s;
						(s = []), f.forEach(a);
					},
					u = function () {
						return Promise.resolve().then(d);
					};
				u(),
					(r = {
						push: function (f) {
							s.push(f), u();
						},
						filter: function (f) {
							return (s = s.filter(f)), r;
						},
					});
			},
		};
	return i;
}
function qE(e) {
	e === void 0 && (e = {});
	var t = wF(null);
	return (t.options = Lo({ async: !0, ssr: !1 }, e)), t;
}
b();
var Ok = w(Q()),
	Fk = function (e) {
		var t = e.sideCar,
			r = vg(e, ["sideCar"]);
		if (!t)
			throw new Error(
				"Sidecar: please provide `sideCar` property to import the right car",
			);
		var o = t.read();
		if (!o) throw new Error("Sidecar medium not found");
		return Ok.createElement(o, Lo({}, r));
	};
Fk.isSideCarExport = !0;
function jE(e, t) {
	return e.useMedium(t), Fk;
}
var wg = qE();
var QE = function () {},
	km = Zr.forwardRef(function (e, t) {
		var r = Zr.useRef(null),
			o = Zr.useState({
				onScrollCapture: QE,
				onWheelCapture: QE,
				onTouchMoveCapture: QE,
			}),
			i = o[0],
			a = o[1],
			s = e.forwardProps,
			c = e.children,
			d = e.className,
			u = e.removeScrollBar,
			f = e.enabled,
			m = e.shards,
			g = e.sideCar,
			h = e.noIsolation,
			y = e.inert,
			E = e.allowPinchZoom,
			T = e.as,
			I = T === void 0 ? "div" : T,
			P = vg(e, [
				"forwardProps",
				"children",
				"className",
				"removeScrollBar",
				"enabled",
				"shards",
				"sideCar",
				"noIsolation",
				"inert",
				"allowPinchZoom",
				"as",
			]),
			C = g,
			k = ZE([r, t]),
			N = Lo(Lo({}, P), i);
		return Zr.createElement(
			Zr.Fragment,
			null,
			f &&
				Zr.createElement(C, {
					sideCar: wg,
					removeScrollBar: u,
					shards: m,
					noIsolation: h,
					inert: y,
					setCallbacks: a,
					allowPinchZoom: !!E,
					lockRef: r,
				}),
			s
				? Zr.cloneElement(Zr.Children.only(c), Lo(Lo({}, N), { ref: k }))
				: Zr.createElement(I, Lo({}, N, { className: d, ref: k }), c),
		);
	});
km.defaultProps = { enabled: !0, removeScrollBar: !0, inert: !1 };
km.classNames = { fullWidth: ql, zeroRight: Zl };
b();
b();
var Bt = w(Q());
b();
b();
var $c = w(Q());
b();
b();
b();
var $k = w(Q());
b();
b();
var Bk;
var zk = function () {
	if (Bk) return Bk;
	if (typeof __webpack_nonce__ < "u") return __webpack_nonce__;
};
function SF() {
	if (!document) return null;
	var e = document.createElement("style");
	e.type = "text/css";
	var t = zk();
	return t && e.setAttribute("nonce", t), e;
}
function TF(e, t) {
	e.styleSheet
		? (e.styleSheet.cssText = t)
		: e.appendChild(document.createTextNode(t));
}
function CF(e) {
	var t = document.head || document.getElementsByTagName("head")[0];
	t.appendChild(e);
}
var JE = function () {
	var e = 0,
		t = null;
	return {
		add: function (r) {
			e == 0 && (t = SF()) && (TF(t, r), CF(t)), e++;
		},
		remove: function () {
			e--, !e && t && (t.parentNode && t.parentNode.removeChild(t), (t = null));
		},
	};
};
var ey = function () {
	var e = JE();
	return function (t, r) {
		$k.useEffect(
			function () {
				return (
					e.add(t),
					function () {
						e.remove();
					}
				);
			},
			[t && r],
		);
	};
};
var Lm = function () {
	var e = ey(),
		t = function (r) {
			var o = r.styles,
				i = r.dynamic;
			return e(o, i), null;
		};
	return t;
};
b();
var IF = { left: 0, top: 0, right: 0, gap: 0 },
	ty = function (e) {
		return parseInt(e || "", 10) || 0;
	},
	_F = function (e) {
		var t = window.getComputedStyle(document.body),
			r = t[e === "padding" ? "paddingLeft" : "marginLeft"],
			o = t[e === "padding" ? "paddingTop" : "marginTop"],
			i = t[e === "padding" ? "paddingRight" : "marginRight"];
		return [ty(r), ty(o), ty(i)];
	},
	ry = function (e) {
		if ((e === void 0 && (e = "margin"), typeof window > "u")) return IF;
		var t = _F(e),
			r = document.documentElement.clientWidth,
			o = window.innerWidth;
		return {
			left: t[0],
			top: t[1],
			right: t[2],
			gap: Math.max(0, o - r + t[2] - t[0]),
		};
	};
var AF = Lm(),
	zc = "data-scroll-locked",
	kF = function (e, t, r, o) {
		var i = e.left,
			a = e.top,
			s = e.right,
			c = e.gap;
		return (
			r === void 0 && (r = "margin"),
			`
  .`
				.concat(
					VE,
					` {
   overflow: hidden `,
				)
				.concat(
					o,
					`;
   padding-right: `,
				)
				.concat(c, "px ")
				.concat(
					o,
					`;
  }
  body[`,
				)
				.concat(
					zc,
					`] {
    overflow: hidden `,
				)
				.concat(
					o,
					`;
    overscroll-behavior: contain;
    `,
				)
				.concat(
					[
						t && "position: relative ".concat(o, ";"),
						r === "margin" &&
							`
    padding-left: `
								.concat(
									i,
									`px;
    padding-top: `,
								)
								.concat(
									a,
									`px;
    padding-right: `,
								)
								.concat(
									s,
									`px;
    margin-left:0;
    margin-top:0;
    margin-right: `,
								)
								.concat(c, "px ")
								.concat(
									o,
									`;
    `,
								),
						r === "padding" &&
							"padding-right: ".concat(c, "px ").concat(o, ";"),
					]
						.filter(Boolean)
						.join(""),
					`
  }
  
  .`,
				)
				.concat(
					Zl,
					` {
    right: `,
				)
				.concat(c, "px ")
				.concat(
					o,
					`;
  }
  
  .`,
				)
				.concat(
					ql,
					` {
    margin-right: `,
				)
				.concat(c, "px ")
				.concat(
					o,
					`;
  }
  
  .`,
				)
				.concat(Zl, " .")
				.concat(
					Zl,
					` {
    right: 0 `,
				)
				.concat(
					o,
					`;
  }
  
  .`,
				)
				.concat(ql, " .")
				.concat(
					ql,
					` {
    margin-right: 0 `,
				)
				.concat(
					o,
					`;
  }
  
  body[`,
				)
				.concat(
					zc,
					`] {
    `,
				)
				.concat(XE, ": ")
				.concat(
					c,
					`px;
  }
`,
				)
		);
	},
	Hk = function () {
		var e = parseInt(document.body.getAttribute(zc) || "0", 10);
		return isFinite(e) ? e : 0;
	},
	LF = function () {
		$c.useEffect(function () {
			return (
				document.body.setAttribute(zc, (Hk() + 1).toString()),
				function () {
					var e = Hk() - 1;
					e <= 0
						? document.body.removeAttribute(zc)
						: document.body.setAttribute(zc, e.toString());
				}
			);
		}, []);
	},
	oy = function (e) {
		var t = e.noRelative,
			r = e.noImportant,
			o = e.gapMode,
			i = o === void 0 ? "margin" : o;
		LF();
		var a = $c.useMemo(
			function () {
				return ry(i);
			},
			[i],
		);
		return $c.createElement(AF, {
			styles: kF(a, !t, i, r ? "" : "!important"),
		});
	};
b();
var ny = !1;
if (typeof window < "u")
	try {
		(Mm = Object.defineProperty({}, "passive", {
			get: function () {
				return (ny = !0), !0;
			},
		})),
			window.addEventListener("test", Mm, Mm),
			window.removeEventListener("test", Mm, Mm);
	} catch {
		ny = !1;
	}
var Mm,
	jl = ny ? { passive: !1 } : !1;
b();
var MF = function (e) {
		return e.tagName === "TEXTAREA";
	},
	Uk = function (e, t) {
		var r = window.getComputedStyle(e);
		return (
			r[t] !== "hidden" &&
			!(r.overflowY === r.overflowX && !MF(e) && r[t] === "visible")
		);
	},
	PF = function (e) {
		return Uk(e, "overflowY");
	},
	RF = function (e) {
		return Uk(e, "overflowX");
	},
	iy = function (e, t) {
		var r = t;
		do {
			typeof ShadowRoot < "u" && r instanceof ShadowRoot && (r = r.host);
			var o = Gk(e, r);
			if (o) {
				var i = Wk(e, r),
					a = i[1],
					s = i[2];
				if (a > s) return !0;
			}
			r = r.parentNode;
		} while (r && r !== document.body);
		return !1;
	},
	DF = function (e) {
		var t = e.scrollTop,
			r = e.scrollHeight,
			o = e.clientHeight;
		return [t, r, o];
	},
	NF = function (e) {
		var t = e.scrollLeft,
			r = e.scrollWidth,
			o = e.clientWidth;
		return [t, r, o];
	},
	Gk = function (e, t) {
		return e === "v" ? PF(t) : RF(t);
	},
	Wk = function (e, t) {
		return e === "v" ? DF(t) : NF(t);
	},
	OF = function (e, t) {
		return e === "h" && t === "rtl" ? -1 : 1;
	},
	Kk = function (e, t, r, o, i) {
		var a = OF(e, window.getComputedStyle(t).direction),
			s = a * o,
			c = r.target,
			d = t.contains(c),
			u = !1,
			f = s > 0,
			m = 0,
			g = 0;
		do {
			var h = Wk(e, c),
				y = h[0],
				E = h[1],
				T = h[2],
				I = E - T - a * y;
			(y || I) && Gk(e, c) && ((m += I), (g += y)), (c = c.parentNode);
		} while ((!d && c !== document.body) || (d && (t.contains(c) || t === c)));
		return (
			((f && ((i && m === 0) || (!i && s > m))) ||
				(!f && ((i && g === 0) || (!i && -s > g)))) &&
				(u = !0),
			u
		);
	};
var Sg = function (e) {
		return "changedTouches" in e
			? [e.changedTouches[0].clientX, e.changedTouches[0].clientY]
			: [0, 0];
	},
	Yk = function (e) {
		return [e.deltaX, e.deltaY];
	},
	Vk = function (e) {
		return e && "current" in e ? e.current : e;
	},
	FF = function (e, t) {
		return e[0] === t[0] && e[1] === t[1];
	},
	BF = function (e) {
		return `
  .block-interactivity-`
			.concat(
				e,
				` {pointer-events: none;}
  .allow-interactivity-`,
			)
			.concat(
				e,
				` {pointer-events: all;}
`,
			);
	},
	zF = 0,
	Hc = [];
function Xk(e) {
	var t = Bt.useRef([]),
		r = Bt.useRef([0, 0]),
		o = Bt.useRef(),
		i = Bt.useState(zF++)[0],
		a = Bt.useState(function () {
			return Lm();
		})[0],
		s = Bt.useRef(e);
	Bt.useEffect(
		function () {
			s.current = e;
		},
		[e],
	),
		Bt.useEffect(
			function () {
				if (e.inert) {
					document.body.classList.add("block-interactivity-".concat(i));
					var E = Pk([e.lockRef.current], (e.shards || []).map(Vk), !0).filter(
						Boolean,
					);
					return (
						E.forEach(function (T) {
							return T.classList.add("allow-interactivity-".concat(i));
						}),
						function () {
							document.body.classList.remove("block-interactivity-".concat(i)),
								E.forEach(function (T) {
									return T.classList.remove("allow-interactivity-".concat(i));
								});
						}
					);
				}
			},
			[e.inert, e.lockRef.current, e.shards],
		);
	var c = Bt.useCallback(function (E, T) {
			if ("touches" in E && E.touches.length === 2)
				return !s.current.allowPinchZoom;
			var I = Sg(E),
				P = r.current,
				C = "deltaX" in E ? E.deltaX : P[0] - I[0],
				k = "deltaY" in E ? E.deltaY : P[1] - I[1],
				N,
				D = E.target,
				B = Math.abs(C) > Math.abs(k) ? "h" : "v";
			if ("touches" in E && B === "h" && D.type === "range") return !1;
			var F = iy(B, D);
			if (!F) return !0;
			if ((F ? (N = B) : ((N = B === "v" ? "h" : "v"), (F = iy(B, D))), !F))
				return !1;
			if (
				(!o.current && "changedTouches" in E && (C || k) && (o.current = N), !N)
			)
				return !0;
			var W = o.current || N;
			return Kk(W, T, E, W === "h" ? C : k, !0);
		}, []),
		d = Bt.useCallback(function (E) {
			var T = E;
			if (!(!Hc.length || Hc[Hc.length - 1] !== a)) {
				var I = "deltaY" in T ? Yk(T) : Sg(T),
					P = t.current.filter(function (N) {
						return N.name === T.type && N.target === T.target && FF(N.delta, I);
					})[0];
				if (P && P.should) {
					T.cancelable && T.preventDefault();
					return;
				}
				if (!P) {
					var C = (s.current.shards || [])
							.map(Vk)
							.filter(Boolean)
							.filter(function (N) {
								return N.contains(T.target);
							}),
						k = C.length > 0 ? c(T, C[0]) : !s.current.noIsolation;
					k && T.cancelable && T.preventDefault();
				}
			}
		}, []),
		u = Bt.useCallback(function (E, T, I, P) {
			var C = { name: E, delta: T, target: I, should: P };
			t.current.push(C),
				setTimeout(function () {
					t.current = t.current.filter(function (k) {
						return k !== C;
					});
				}, 1);
		}, []),
		f = Bt.useCallback(function (E) {
			(r.current = Sg(E)), (o.current = void 0);
		}, []),
		m = Bt.useCallback(function (E) {
			u(E.type, Yk(E), E.target, c(E, e.lockRef.current));
		}, []),
		g = Bt.useCallback(function (E) {
			u(E.type, Sg(E), E.target, c(E, e.lockRef.current));
		}, []);
	Bt.useEffect(function () {
		return (
			Hc.push(a),
			e.setCallbacks({
				onScrollCapture: m,
				onWheelCapture: m,
				onTouchMoveCapture: g,
			}),
			document.addEventListener("wheel", d, jl),
			document.addEventListener("touchmove", d, jl),
			document.addEventListener("touchstart", f, jl),
			function () {
				(Hc = Hc.filter(function (E) {
					return E !== a;
				})),
					document.removeEventListener("wheel", d, jl),
					document.removeEventListener("touchmove", d, jl),
					document.removeEventListener("touchstart", f, jl);
			}
		);
	}, []);
	var h = e.removeScrollBar,
		y = e.inert;
	return Bt.createElement(
		Bt.Fragment,
		null,
		y ? Bt.createElement(a, { styles: BF(i) }) : null,
		h ? Bt.createElement(oy, { gapMode: "margin" }) : null,
	);
}
var Zk = jE(wg, Xk);
var qk = Tg.forwardRef(function (e, t) {
	return Tg.createElement(km, Lo({}, e, { ref: t, sideCar: Zk }));
});
qk.classNames = km.classNames;
var ay = qk;
var jk = "Popover",
	[Qk, SZ] = di(jk, [KE]),
	Cg = KE(),
	[$F, Uc] = Qk(jk),
	HF = (e) => {
		let {
				__scopePopover: t,
				children: r,
				open: o,
				defaultOpen: i,
				onOpenChange: a,
				modal: s = !1,
			} = e,
			c = Cg(t),
			d = (0, Qe.useRef)(null),
			[u, f] = (0, Qe.useState)(!1),
			[m = !1, g] = Fc({ prop: o, defaultProp: i, onChange: a });
		return (0, Qe.createElement)(
			Sk,
			c,
			(0, Qe.createElement)(
				$F,
				{
					scope: t,
					contentId: Rc(),
					triggerRef: d,
					open: m,
					onOpenChange: g,
					onOpenToggle: (0, Qe.useCallback)(() => g((h) => !h), [g]),
					hasCustomAnchor: u,
					onCustomAnchorAdd: (0, Qe.useCallback)(() => f(!0), []),
					onCustomAnchorRemove: (0, Qe.useCallback)(() => f(!1), []),
					modal: s,
				},
				r,
			),
		);
	};
var UF = "PopoverTrigger",
	GF = (0, Qe.forwardRef)((e, t) => {
		let { __scopePopover: r, ...o } = e,
			i = Uc(UF, r),
			a = Cg(r),
			s = Hr(t, i.triggerRef),
			c = (0, Qe.createElement)(
				Qt.button,
				je(
					{
						type: "button",
						"aria-haspopup": "dialog",
						"aria-expanded": i.open,
						"aria-controls": i.contentId,
						"data-state": t5(i.open),
					},
					o,
					{ ref: s, onClick: mr(e.onClick, i.onOpenToggle) },
				),
			);
		return i.hasCustomAnchor
			? c
			: (0, Qe.createElement)(Tk, je({ asChild: !0 }, a), c);
	}),
	Jk = "PopoverPortal",
	[WF, KF] = Qk(Jk, { forceMount: void 0 }),
	YF = (e) => {
		let { __scopePopover: t, forceMount: r, children: o, container: i } = e,
			a = Uc(Jk, t);
		return (0, Qe.createElement)(
			WF,
			{ scope: t, forceMount: r },
			(0, Qe.createElement)(
				Oc,
				{ present: r || a.open },
				(0, Qe.createElement)(Ak, { asChild: !0, container: i }, o),
			),
		);
	},
	Pm = "PopoverContent",
	VF = (0, Qe.forwardRef)((e, t) => {
		let r = KF(Pm, e.__scopePopover),
			{ forceMount: o = r.forceMount, ...i } = e,
			a = Uc(Pm, e.__scopePopover);
		return (0, Qe.createElement)(
			Oc,
			{ present: o || a.open },
			a.modal
				? (0, Qe.createElement)(XF, je({}, i, { ref: t }))
				: (0, Qe.createElement)(ZF, je({}, i, { ref: t })),
		);
	}),
	XF = (0, Qe.forwardRef)((e, t) => {
		let r = Uc(Pm, e.__scopePopover),
			o = (0, Qe.useRef)(null),
			i = Hr(t, o),
			a = (0, Qe.useRef)(!1);
		return (
			(0, Qe.useEffect)(() => {
				let s = o.current;
				if (s) return Mk(s);
			}, []),
			(0, Qe.createElement)(
				ay,
				{ as: Na, allowPinchZoom: !0 },
				(0, Qe.createElement)(
					e5,
					je({}, e, {
						ref: i,
						trapFocus: r.open,
						disableOutsidePointerEvents: !0,
						onCloseAutoFocus: mr(e.onCloseAutoFocus, (s) => {
							var c;
							s.preventDefault(),
								a.current ||
									(c = r.triggerRef.current) === null ||
									c === void 0 ||
									c.focus();
						}),
						onPointerDownOutside: mr(
							e.onPointerDownOutside,
							(s) => {
								let c = s.detail.originalEvent,
									d = c.button === 0 && c.ctrlKey === !0,
									u = c.button === 2 || d;
								a.current = u;
							},
							{ checkForDefaultPrevented: !1 },
						),
						onFocusOutside: mr(e.onFocusOutside, (s) => s.preventDefault(), {
							checkForDefaultPrevented: !1,
						}),
					}),
				),
			)
		);
	}),
	ZF = (0, Qe.forwardRef)((e, t) => {
		let r = Uc(Pm, e.__scopePopover),
			o = (0, Qe.useRef)(!1);
		return (0, Qe.createElement)(
			e5,
			je({}, e, {
				ref: t,
				trapFocus: !1,
				disableOutsidePointerEvents: !1,
				onCloseAutoFocus: (i) => {
					var a;
					if (
						((a = e.onCloseAutoFocus) === null || a === void 0 || a.call(e, i),
						!i.defaultPrevented)
					) {
						var s;
						o.current ||
							(s = r.triggerRef.current) === null ||
							s === void 0 ||
							s.focus(),
							i.preventDefault();
					}
					o.current = !1;
				},
				onInteractOutside: (i) => {
					var a, s;
					(a = e.onInteractOutside) === null || a === void 0 || a.call(e, i),
						i.defaultPrevented || (o.current = !0);
					let c = i.target;
					((s = r.triggerRef.current) === null || s === void 0
						? void 0
						: s.contains(c)) && i.preventDefault();
				},
			}),
		);
	}),
	e5 = (0, Qe.forwardRef)((e, t) => {
		let {
				__scopePopover: r,
				trapFocus: o,
				onOpenAutoFocus: i,
				onCloseAutoFocus: a,
				disableOutsidePointerEvents: s,
				onEscapeKeyDown: c,
				onPointerDownOutside: d,
				onFocusOutside: u,
				onInteractOutside: f,
				...m
			} = e,
			g = Uc(Pm, r),
			h = Cg(r);
		return (
			zA(),
			(0, Qe.createElement)(
				WA,
				{
					asChild: !0,
					loop: !0,
					trapped: o,
					onMountAutoFocus: i,
					onUnmountAutoFocus: a,
				},
				(0, Qe.createElement)(
					NA,
					{
						asChild: !0,
						disableOutsidePointerEvents: s,
						onInteractOutside: f,
						onEscapeKeyDown: c,
						onPointerDownOutside: d,
						onFocusOutside: u,
						onDismiss: () => g.onOpenChange(!1),
					},
					(0, Qe.createElement)(
						Ck,
						je(
							{ "data-state": t5(g.open), role: "dialog", id: g.contentId },
							h,
							m,
							{
								ref: t,
								style: {
									...m.style,
									"--radix-popover-content-transform-origin":
										"var(--radix-popper-transform-origin)",
								},
							},
						),
					),
				),
			)
		);
	});
var qF = (0, Qe.forwardRef)((e, t) => {
	let { __scopePopover: r, ...o } = e,
		i = Cg(r);
	return (0, Qe.createElement)(Ik, je({}, i, o, { ref: t }));
});
function t5(e) {
	return e ? "open" : "closed";
}
var Gc = HF;
var Wc = GF,
	r5 = YF,
	Ig = VF;
var _g = qF;
var f5 = w(Q(), 1);
b();
var Yn = w(Q(), 1);
b();
var kg = w(Q(), 1),
	i5 = w(Gn(), 1);
b();
var ly = w(Q(), 1),
	sy = ly.default.createContext(null),
	mt = () => ly.default.useContext(sy);
b();
var Dm = w(Q(), 1);
var Ag = (e) => {
	let [t, r] = (0, Dm.useState)(null),
		o = et(),
		{ theme: i } = mt(),
		{ container: a } = dr();
	return (
		(0, Dm.useLayoutEffect)(() => {
			t &&
				((t.className = ""),
				t.classList.add("excalidraw", ...(e?.className?.split(/\s+/) || [])),
				t.classList.toggle("excalidraw--mobile", o.editor.isMobile),
				t.classList.toggle("theme--dark", i === $e.DARK));
		}, [t, i, o.editor.isMobile, e?.className]),
		(0, Dm.useLayoutEffect)(() => {
			let s = e?.parentSelector
				? a?.querySelector(e.parentSelector)
				: document.body;
			if (!s) return;
			let c = document.createElement("div");
			return (
				s.appendChild(c),
				r(c),
				() => {
					s.removeChild(c);
				}
			);
		}, [a, e?.parentSelector]),
		t
	);
};
b();
var o5 = w(Q(), 1);
function Kc(e, t, r) {
	(0, o5.useEffect)(() => {
		function o(i) {
			let a = i;
			if (!e.current) return;
			let s = r?.(a, e.current);
			if (s === !0) return;
			if (s === !1) return t(a);
			e.current.contains(a.target) ||
				!document.documentElement.contains(a.target) ||
				a.target.closest("[data-radix-portal]") ||
				(a.target === document.documentElement &&
					document.body.style.pointerEvents === "none") ||
				a.target.closest("[data-prevent-outside-click]") ||
				t(a);
		}
		return (
			document.addEventListener("pointerdown", o),
			document.addEventListener("touchstart", o),
			() => {
				document.removeEventListener("pointerdown", o),
					document.removeEventListener("touchstart", o);
			}
		);
	}, [e, t, r]);
}
b();
var n5 = w(Q(), 1),
	za = (e) => {
		let t = (0, n5.useRef)(e);
		return Object.assign(t.current, e), t.current;
	};
var l5 = w(M(), 1),
	$a = xt(null),
	a5 = ({ onCancel: e, onChange: t, onSelect: r, colorPickerType: o }) => {
		let i = Ag({
				className: "excalidraw-eye-dropper-backdrop",
				parentSelector: ".excalidraw-eye-dropper-container",
			}),
			a = mt(),
			s = Ha(),
			c = Jt(),
			d = Le(s, a),
			u = za({
				app: c,
				onCancel: e,
				onChange: t,
				onSelect: r,
				selectedElements: d,
			}),
			{ container: f } = dr();
		(0, kg.useEffect)(() => {
			let g = m.current;
			if (!g || !c.canvas || !i) return;
			let h = !1,
				y = c.canvas.getContext("2d"),
				E = ({ clientX: D, clientY: B }) => {
					let F = y.getImageData(
						(D - a.offsetLeft) * window.devicePixelRatio,
						(B - a.offsetTop) * window.devicePixelRatio,
						1,
						1,
					).data;
					return lT(F[0], F[1], F[2]);
				},
				T = ({ clientX: D, clientY: B, altKey: F }) => {
					(g.style.top = `${B + 20}px`), (g.style.left = `${D + 20}px`);
					let W = E({ clientX: D, clientY: B });
					h && u.onChange(o, W, u.selectedElements, { altKey: F }),
						(g.style.background = W);
				},
				I = () => {
					u.onCancel();
				},
				P = (D, B) => {
					u.onSelect(D, B);
				},
				C = (D) => {
					(h = !0), D.stopImmediatePropagation();
				},
				k = (D) => {
					(h = !1),
						f?.focus(),
						D.stopImmediatePropagation(),
						D.preventDefault(),
						P(E(D), D);
				},
				N = (D) => {
					D.key === R.ESCAPE &&
						(D.preventDefault(), D.stopImmediatePropagation(), I());
				};
			return (
				(i.tabIndex = -1),
				i.focus(),
				T({
					clientX: u.app.lastViewportPosition.x,
					clientY: u.app.lastViewportPosition.y,
					altKey: !1,
				}),
				i.addEventListener("keydown", N),
				i.addEventListener("pointerdown", C),
				i.addEventListener("pointerup", k),
				window.addEventListener("pointermove", T, { passive: !0 }),
				window.addEventListener("blur", I),
				() => {
					(h = !1),
						i.removeEventListener("keydown", N),
						i.removeEventListener("pointerdown", C),
						i.removeEventListener("pointerup", k),
						window.removeEventListener("pointermove", T),
						window.removeEventListener("blur", I);
				}
			);
		}, [u, c.canvas, i, o, f, a.offsetLeft, a.offsetTop]);
		let m = (0, kg.useRef)(null);
		return (
			Kc(
				m,
				() => {
					e();
				},
				(g) =>
					!!g.target.closest(
						".excalidraw-eye-dropper-trigger, .excalidraw-eye-dropper-backdrop",
					),
			),
			i
				? (0, i5.createPortal)(
						(0, l5.jsx)("div", {
							ref: m,
							className: "excalidraw-eye-dropper-preview",
						}),
						i,
					)
				: null
		);
	};
var ui = w(M(), 1),
	s5 = ({ color: e, onChange: t, label: r, colorPickerType: o }) => {
		let i = et(),
			[a, s] = (0, Yn.useState)(e),
			[c, d] = Ge(hn);
		(0, Yn.useEffect)(() => {
			s(e);
		}, [e]);
		let u = (0, Yn.useCallback)(
				(y) => {
					let E = y.toLowerCase(),
						T = c5(E);
					T && t(T), s(E);
				},
				[t],
			),
			f = (0, Yn.useRef)(null),
			m = (0, Yn.useRef)(null);
		(0, Yn.useEffect)(() => {
			f.current && f.current.focus();
		}, [c]);
		let [g, h] = Ge($a, lt);
		return (
			(0, Yn.useEffect)(
				() => () => {
					h(null);
				},
				[h],
			),
			(0, ui.jsxs)("div", {
				className: "color-picker__input-label",
				children: [
					(0, ui.jsx)("div", {
						className: "color-picker__input-hash",
						children: "#",
					}),
					(0, ui.jsx)("input", {
						ref: c === "hex" ? f : void 0,
						style: { border: 0, padding: 0 },
						spellCheck: !1,
						className: "color-picker-input",
						"aria-label": r,
						onChange: (y) => {
							u(y.target.value);
						},
						value: (a || "").replace(/^#/, ""),
						onBlur: () => {
							s(e);
						},
						tabIndex: -1,
						onFocus: () => d("hex"),
						onKeyDown: (y) => {
							y.key !== R.TAB &&
								(y.key === R.ESCAPE && m.current?.focus(), y.stopPropagation());
						},
					}),
					!i.editor.isMobile &&
						(0, ui.jsxs)(ui.Fragment, {
							children: [
								(0, ui.jsx)("div", {
									style: {
										width: "1px",
										height: "1.25rem",
										backgroundColor: "var(--default-border-color)",
									},
								}),
								(0, ui.jsx)("div", {
									ref: m,
									className: j("excalidraw-eye-dropper-trigger", {
										selected: g,
									}),
									onClick: () =>
										h((y) =>
											y
												? null
												: {
														keepOpenOnAlt: !1,
														onSelect: (E) => t(E),
														colorPickerType: o,
													},
										),
									title: `${v("labels.eyeDropper")} \u2014 ${R.I.toLocaleUpperCase()} or ${V("Alt")} `,
									children: w2,
								}),
							],
						}),
				],
			})
		);
	};
b();
var u5 = w(Q(), 1);
b();
var d5 = w(Q(), 1);
var m5 = w(M(), 1),
	yr = d5.default.forwardRef(
		({ children: e, padding: t, className: r, style: o }, i) =>
			(0, m5.jsx)("div", {
				className: j("Island", r),
				style: { "--padding": t, ...o },
				ref: i,
				children: e,
			}),
	);
var Yc = w(M(), 1),
	Lg = u5.default.forwardRef(
		(
			{
				className: e,
				container: t,
				children: r,
				style: o,
				onClose: i,
				onKeyDown: a,
				onFocusOutside: s,
				onPointerLeave: c,
				onPointerDownOutside: d,
			},
			u,
		) => {
			let f = et();
			return (0, Yc.jsx)(r5, {
				container: t,
				children: (0, Yc.jsxs)(Ig, {
					ref: u,
					className: j("focus-visible-none", e),
					"data-prevent-outside-click": !0,
					side:
						f.editor.isMobile && !f.viewport.isLandscape ? "bottom" : "right",
					align:
						f.editor.isMobile && !f.viewport.isLandscape ? "center" : "start",
					alignOffset: -16,
					sideOffset: 20,
					style: { zIndex: "var(--zIndex-popup)" },
					onPointerLeave: c,
					onKeyDown: a,
					onFocusOutside: s,
					onPointerDownOutside: d,
					onCloseAutoFocus: (m) => {
						m.stopPropagation(),
							m.preventDefault(),
							t && !zT(document.activeElement) && t.focus(),
							i();
					},
					children: [
						(0, Yc.jsx)(yr, { padding: 3, style: o, children: r }),
						(0, Yc.jsx)(_g, {
							width: 20,
							height: 10,
							style: {
								fill: "var(--popup-bg-color)",
								filter: "drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)",
							},
						}),
					],
				}),
			});
		},
	);
var qr = w(M(), 1),
	p5 = (e) => {
		let t = new Option().style;
		return (t.color = e), !!t.color;
	},
	c5 = (e) => (Il(e) ? e : p5(`#${e}`) ? `#${e}` : p5(e) ? e : null),
	jF = ({
		type: e,
		color: t,
		onChange: r,
		label: o,
		elements: i,
		palette: a = Mi,
		updateData: s,
	}) => {
		let { container: c } = dr(),
			[, d] = Ge(hn),
			[u, f] = Ge($a, lt),
			m = (0, qr.jsxs)("div", {
				children: [
					(0, qr.jsx)(Lc, { children: v("colorPicker.hexCode") }),
					(0, qr.jsx)(s5, {
						color: t,
						label: o,
						onChange: (y) => {
							r(y);
						},
						colorPickerType: e,
					}),
				],
			}),
			g = (0, f5.useRef)(null),
			h = () => {
				g.current?.querySelector(".color-picker-content")?.focus();
			};
		return (0, qr.jsx)(Lg, {
			container: c,
			style: { maxWidth: "13rem" },
			onFocusOutside: (y) => {
				h(), y.preventDefault();
			},
			onPointerDownOutside: (y) => {
				u && y.preventDefault();
			},
			onClose: () => {
				s({ openPopup: null }), d(null);
			},
			children: a
				? (0, qr.jsx)(_A, {
						palette: a,
						color: t,
						onChange: (y) => {
							r(y);
						},
						onEyeDropperToggle: (y) => {
							f((E) =>
								y
									? ((E = E || {
											keepOpenOnAlt: !0,
											onSelect: r,
											colorPickerType: e,
										}),
										(E.keepOpenOnAlt = !0),
										E)
									: y === !1 || E
										? null
										: { keepOpenOnAlt: !1, onSelect: r, colorPickerType: e },
							);
						},
						onEscape: (y) => {
							u ? f(null) : s({ openPopup: null });
						},
						label: o,
						type: e,
						elements: i,
						updateData: s,
						children: m,
					})
				: m,
		});
	},
	QF = ({ label: e, color: t, type: r }) =>
		(0, qr.jsx)(Wc, {
			type: "button",
			className: j("color-picker__button active-color properties-trigger", {
				"is-transparent": t === "transparent" || !t,
			}),
			"aria-label": e,
			style: t ? { "--swatch-color": t } : void 0,
			title:
				r === "elementStroke"
					? v("labels.showStroke")
					: v("labels.showBackground"),
			children: (0, qr.jsx)("div", {
				className: "color-picker__button-outline",
			}),
		}),
	Nm = ({
		type: e,
		color: t,
		onChange: r,
		label: o,
		elements: i,
		palette: a = Mi,
		topPicks: s,
		updateData: c,
		appState: d,
	}) =>
		(0, qr.jsx)("div", {
			children: (0, qr.jsxs)("div", {
				role: "dialog",
				"aria-modal": "true",
				className: "color-picker-container",
				children: [
					(0, qr.jsx)(hA, {
						activeColor: t,
						onChange: r,
						type: e,
						topPicks: s,
					}),
					(0, qr.jsx)(rg, {}),
					(0, qr.jsxs)(Gc, {
						open: d.openPopup === e,
						onOpenChange: (u) => {
							c({ openPopup: u ? e : null });
						},
						children: [
							(0, qr.jsx)(QF, { color: t, label: o, type: e }),
							d.openPopup === e &&
								(0, qr.jsx)(jF, {
									type: e,
									color: t,
									onChange: r,
									label: o,
									elements: i,
									palette: a,
									updateData: c,
								}),
						],
					}),
				],
			}),
		});
b();
var Ga = w(Q(), 1);
b();
var Ua = w(Q(), 1);
var g5 = w(Gn(), 1);
var h5 = w(M(), 1),
	Mg = ({
		children: e,
		left: t,
		top: r,
		onCloseRequest: o,
		fitInViewport: i = !1,
		offsetLeft: a = 0,
		offsetTop: s = 0,
		viewportWidth: c = window.innerWidth,
		viewportHeight: d = window.innerHeight,
	}) => {
		let u = (0, Ua.useRef)(null);
		(0, Ua.useEffect)(() => {
			let m = u.current;
			if (!m) return;
			m.contains(document.activeElement) || m.focus();
			let g = (h) => {
				if (h.key === R.TAB) {
					let y = Qd(m),
						{ activeElement: E } = document,
						T = y.findIndex((I) => I === E);
					E === m
						? (h.shiftKey ? y[y.length - 1]?.focus() : y[0].focus(),
							h.preventDefault(),
							h.stopImmediatePropagation())
						: T === 0 && h.shiftKey
							? (y[y.length - 1]?.focus(),
								h.preventDefault(),
								h.stopImmediatePropagation())
							: T === y.length - 1 &&
								!h.shiftKey &&
								(y[0]?.focus(),
								h.preventDefault(),
								h.stopImmediatePropagation());
				}
			};
			return (
				m.addEventListener("keydown", g),
				() => m.removeEventListener("keydown", g)
			);
		}, []);
		let f = (0, Ua.useRef)(null);
		return (
			(0, Ua.useLayoutEffect)(() => {
				if (i && u.current && r != null && t != null) {
					let m = u.current,
						{ width: g, height: h } = m.getBoundingClientRect();
					if (f.current?.top === r && f.current?.left === t) return;
					(f.current = { top: r, left: t }),
						g >= c
							? ((m.style.width = `${c}px`),
								(m.style.left = "0px"),
								(m.style.overflowX = "scroll"))
							: t + g - a > c
								? (m.style.left = `${c - g - 10}px`)
								: (m.style.left = `${t}px`),
						h >= d
							? ((m.style.height = `${d - 20}px`),
								(m.style.top = "10px"),
								(m.style.overflowY = "scroll"))
							: r + h - s > d
								? (m.style.top = `${d - h}px`)
								: (m.style.top = `${r}px`);
				}
			}, [r, t, i, c, d, a, s]),
			(0, Ua.useEffect)(() => {
				if (o) {
					let m = (g) => {
						u.current?.contains(g.target) ||
							(0, g5.unstable_batchedUpdates)(() => o(g));
					};
					return (
						document.addEventListener("pointerdown", m, !1),
						() => document.removeEventListener("pointerdown", m, !1)
					);
				}
			}, [o]),
			(0, h5.jsx)("div", {
				className: "popover",
				ref: u,
				tabIndex: -1,
				children: e,
			})
		);
	};
var po = w(M(), 1);
function JF({ options: e, value: t, label: r, onChange: o, onClose: i }) {
	let a = Ga.default.useRef(),
		s = Ga.default.useRef(),
		c = Ga.default.useRef(null);
	return (
		Ga.default.useEffect(() => {
			s.current ? s.current.focus() : c.current && c.current.focus();
		}, []),
		(0, po.jsx)("div", {
			className: "picker",
			role: "dialog",
			"aria-modal": "true",
			"aria-label": r,
			onKeyDown: (u) => {
				let f = e.find((m) => m.keyBinding === u.key.toLowerCase());
				if (!(u.metaKey || u.altKey || u.ctrlKey) && f) {
					let m = e.indexOf(f);
					c.current.children[m].focus(), u.preventDefault();
				} else if (u.key === R.TAB)
					setTimeout(() => {
						let m = s.current,
							g = document.activeElement;
						m !== g && i();
					}, 0);
				else if (Rl(u.key)) {
					let { activeElement: m } = document,
						g = ci().rtl,
						h = Array.prototype.indexOf.call(c.current.children, m);
					if (h !== -1) {
						let y = e.length,
							E = h;
						switch (u.key) {
							case g ? R.ARROW_LEFT : R.ARROW_RIGHT:
							case R.ARROW_DOWN: {
								E = (h + 1) % y;
								break;
							}
							case g ? R.ARROW_RIGHT : R.ARROW_LEFT:
							case R.ARROW_UP: {
								E = (y + h - 1) % y;
								break;
							}
						}
						c.current.children[E].focus();
					}
					u.preventDefault();
				} else
					(u.key === R.ESCAPE || u.key === R.ENTER) &&
						(u.preventDefault(), i());
				u.nativeEvent.stopImmediatePropagation(), u.stopPropagation();
			},
			children: (0, po.jsx)("div", {
				className: "picker-content",
				ref: c,
				children: e.map((u, f) =>
					(0, po.jsxs)(
						"button",
						{
							type: "button",
							className: j("picker-option", { active: t === u.value }),
							onClick: (m) => {
								m.currentTarget.focus(), o(u.value);
							},
							title: `${u.text} ${u.keyBinding && `\u2014 ${u.keyBinding.toUpperCase()}`}`,
							"aria-label": u.text || "none",
							"aria-keyshortcuts": u.keyBinding || void 0,
							ref: (m) => {
								m && f === 0 && (a.current = m),
									m && u.value === t && (s.current = m);
							},
							onFocus: () => {
								o(u.value);
							},
							children: [
								u.icon,
								u.keyBinding &&
									(0, po.jsx)("span", {
										className: "picker-keybinding",
										children: u.keyBinding,
									}),
							],
						},
						u.text,
					),
				),
			}),
		})
	);
}
function cy({ value: e, label: t, options: r, onChange: o, group: i = "" }) {
	let [a, s] = Ga.default.useState(!1),
		c = Ga.default.useRef(null),
		d = ci().rtl;
	return (0, po.jsxs)("div", {
		children: [
			(0, po.jsx)("button", {
				name: i,
				type: "button",
				className: a ? "active" : "",
				"aria-label": t,
				onClick: () => s(!a),
				ref: c,
				children: r.find((u) => u.value === e)?.icon,
			}),
			(0, po.jsx)(Ga.default.Suspense, {
				fallback: "",
				children: a
					? (0, po.jsxs)(po.Fragment, {
							children: [
								(0, po.jsx)(Mg, {
									onCloseRequest: (u) => u.target !== c.current && s(!1),
									...(d ? { right: 5.5 } : { left: -5.5 }),
									children: (0, po.jsx)(JF, {
										options: r.filter((u) => u.showInPicker !== !1),
										value: e,
										label: t,
										onChange: o,
										onClose: () => {
											s(!1), c.current?.focus();
										},
									}),
								}),
								(0, po.jsx)("div", { className: "picker-triangle" }),
							],
						})
					: null,
			}),
		],
	});
}
b();
var Xc = w(Q(), 1);
b();
var wr = w(Q(), 1);
b();
var b5 = w(Q(), 1);
var Rg = w(M(), 1),
	Pg = b5.default.forwardRef(
		({ className: e, placeholder: t, onChange: r }, o) =>
			(0, Rg.jsxs)("div", {
				className: j("QuickSearch__wrapper", e),
				children: [
					Go,
					(0, Rg.jsx)("input", {
						ref: o,
						className: "QuickSearch__input",
						type: "text",
						placeholder: t,
						onChange: (i) => r(i.target.value.trim().toLowerCase()),
					}),
				],
			}),
	);
b();
var x5 = w(Q(), 1);
var dy = w(M(), 1),
	Dg = ({ className: e, placeholder: t, children: r }) => {
		let o = !x5.Children.count(r);
		return (0, dy.jsx)("div", {
			className: j("ScrollableList__wrapper", e),
			role: "menu",
			children: o ? (0, dy.jsx)("div", { className: "empty", children: t }) : r,
		});
	};
b();
var Ng = w(M(), 1),
	v5 = ({ children: e, className: t = "", style: r, title: o }) =>
		(0, Ng.jsxs)("div", {
			className: `dropdown-menu-group ${t}`,
			style: r,
			children: [
				o &&
					(0, Ng.jsx)("p", {
						className: "dropdown-menu-group-title",
						children: o,
					}),
				e,
			],
		}),
	Om = v5;
v5.displayName = "DropdownMenuGroup";
b();
var Hg = w(Q(), 1);
b();
var Og = w(Q(), 1);
var my = Og.default.createContext({}),
	Fg = (e = "", t = !1, r = !1) =>
		`dropdown-menu-item dropdown-menu-item-base ${e}
  ${t ? "dropdown-menu-item--selected" : ""} ${r ? "dropdown-menu-item--hovered" : ""}`.trim(),
	Bg = (e, t) => {
		let r = (0, Og.useContext)(my);
		return wa(e, (o) => {
			let i = new CustomEvent("menu.itemSelect", {
				bubbles: !0,
				cancelable: !0,
			});
			t?.(i), i.defaultPrevented || r.onSelect?.(i);
		});
	};
b();
var Wa = w(M(), 1),
	eB = ({ textStyle: e, icon: t, shortcut: r, children: o }) => {
		let i = et();
		return (0, Wa.jsxs)(Wa.Fragment, {
			children: [
				t &&
					(0, Wa.jsx)("div", {
						className: "dropdown-menu-item__icon",
						children: t,
					}),
				(0, Wa.jsx)("div", {
					style: e,
					className: "dropdown-menu-item__text",
					children: o,
				}),
				r &&
					!i.editor.isMobile &&
					(0, Wa.jsx)("div", {
						className: "dropdown-menu-item__shortcut",
						children: r,
					}),
			],
		});
	},
	zg = eB;
var $g = w(M(), 1),
	uy = ({
		icon: e,
		value: t,
		order: r,
		children: o,
		shortcut: i,
		className: a,
		hovered: s,
		selected: c,
		textStyle: d,
		onSelect: u,
		onClick: f,
		...m
	}) => {
		let g = Bg(f, u),
			h = (0, Hg.useRef)(null);
		return (
			(0, Hg.useEffect)(() => {
				s &&
					(r === 0
						? h.current?.scrollIntoView({ block: "end" })
						: h.current?.scrollIntoView({ block: "nearest" }));
			}, [s, r]),
			(0, $g.jsx)("button", {
				...m,
				ref: h,
				value: t,
				onClick: g,
				className: Fg(a, c, s),
				title: m.title ?? m["aria-label"],
				children: (0, $g.jsx)(zg, {
					textStyle: d,
					icon: e,
					shortcut: i,
					children: o,
				}),
			})
		);
	};
uy.displayName = "DropdownMenuItem";
var Vc = { GREEN: "green", RED: "red", BLUE: "blue" },
	Ug = ({ type: e = Vc.BLUE, children: t }) => {
		let { theme: r } = pi(),
			o = {
				display: "inline-flex",
				marginLeft: "auto",
				padding: "2px 4px",
				borderRadius: 6,
				fontSize: 9,
				fontFamily: "Cascadia, monospace",
				border: r === $e.LIGHT ? "1.5px solid white" : "none",
			};
		switch (e) {
			case Vc.GREEN:
				Object.assign(o, {
					backgroundColor: "var(--background-color-badge)",
					color: "var(--color-badge)",
				});
				break;
			case Vc.RED:
				Object.assign(o, { backgroundColor: "pink", color: "darkred" });
				break;
			case Vc.BLUE:
			default:
				Object.assign(o, {
					background: "var(--color-promo)",
					color: "var(--color-surface-lowest)",
				});
		}
		return (0, $g.jsx)("div", {
			className: "DropDownMenuItemBadge",
			style: o,
			children: t,
		});
	};
Ug.displayName = "DropdownMenuItemBadge";
uy.Badge = Ug;
var fo = uy;
b();
var E5 = ({
	event: e,
	inputRef: t,
	hoveredFont: r,
	filteredFonts: o,
	onClose: i,
	onSelect: a,
	onHover: s,
}) => {
	if (!e[R.CTRL_OR_CMD] && e.shiftKey && e.key.toLowerCase() === R.F)
		return t.current?.focus(), !0;
	if (e.key === R.ESCAPE) return i(), !0;
	if (e.key === R.ENTER) return r?.value && a(r.value), !0;
	if (e.key === R.ARROW_DOWN)
		return r?.next ? s(r.next.value) : o[0]?.value && s(o[0].value), !0;
	if (e.key === R.ARROW_UP)
		return (
			r?.prev
				? s(r.prev.value)
				: o[o.length - 1]?.value && s(o[o.length - 1].value),
			!0
		);
};
var Zi = w(M(), 1),
	y5 = wr.default.memo(
		({
			selectedFontFamily: e,
			hoveredFontFamily: t,
			onSelect: r,
			onHover: o,
			onLeave: i,
			onOpen: a,
			onClose: s,
		}) => {
			let { container: c } = dr(),
				{ fonts: d } = Jt(),
				{ showDeprecatedFonts: u } = fi(),
				[f, m] = (0, wr.useState)(""),
				g = (0, wr.useRef)(null),
				h = (0, wr.useMemo)(
					() =>
						Array.from(Bi.registered.entries())
							.filter(([F, { metadata: W }]) => !W.serverSide && !W.fallback)
							.map(([F, { metadata: W, fontFaces: G }]) => {
								let q = {
									value: F,
									icon: W.icon ?? Up,
									text: G[0]?.fontFace?.family ?? "Unknown",
								};
								return (
									W.deprecated &&
										Object.assign(q, {
											deprecated: W.deprecated,
											badge: {
												type: Vc.RED,
												placeholder: v("fontList.badge.old"),
											},
										}),
									q
								);
							})
							.sort((F, W) =>
								F.text.toLowerCase() > W.text.toLowerCase() ? 1 : -1,
							),
					[],
				),
				y = (0, wr.useMemo)(() => new Set(d.getSceneFamilies()), [e]),
				E = (0, wr.useMemo)(() => h.filter((F) => y.has(F.value)), [h, y]),
				T = (0, wr.useMemo)(
					() => h.filter((F) => !y.has(F.value) && (u || !F.deprecated)),
					[h, y, u],
				),
				I = (0, wr.useMemo)(
					() =>
						YT([...E, ...T].filter((F) => F.text?.toLowerCase().includes(f))),
					[E, T, f],
				),
				P = (0, wr.useMemo)(() => {
					let F;
					return (
						t
							? (F = I.find((W) => W.value === t))
							: e && (F = I.find((W) => W.value === e)),
						!F && f && (I[0]?.value ? o(I[0].value) : i()),
						F
					);
				}, [t, e, f, I, o, i]),
				C = (0, wr.useCallback)(
					(F) => {
						E5({
							event: F,
							inputRef: g,
							hoveredFont: P,
							filteredFonts: I,
							onSelect: r,
							onHover: o,
							onClose: s,
						}) && (F.preventDefault(), F.stopPropagation());
					},
					[P, I, r, o, s],
				);
			(0, wr.useEffect)(
				() => (
					a(),
					() => {
						s();
					}
				),
				[],
			);
			let k = (0, wr.useMemo)(() => I.filter((F) => y.has(F.value)), [I, y]),
				N = (0, wr.useMemo)(() => I.filter((F) => !y.has(F.value)), [I, y]),
				D = (F, W) =>
					(0, Zi.jsxs)(
						fo,
						{
							icon: F.icon,
							value: F.value,
							order: W,
							textStyle: { fontFamily: wl({ fontFamily: F.value }) },
							hovered: F.value === P?.value,
							selected: F.value === e,
							tabIndex: F.value === e ? 0 : -1,
							onClick: (G) => {
								r(Number(G.currentTarget.value) || G.currentTarget.value);
							},
							onMouseMove: () => {
								P?.value !== F.value && o(F.value);
							},
							children: [
								F.text,
								F.badge &&
									(0, Zi.jsx)(Ug, {
										type: F.badge.type,
										children: F.badge.placeholder,
									}),
							],
						},
						F.value,
					),
				B = [];
			return (
				k.length &&
					B.push(
						(0, Zi.jsx)(
							Om,
							{ title: v("fontList.sceneFonts"), children: k.map(D) },
							"group_1",
						),
					),
				N.length &&
					B.push(
						(0, Zi.jsx)(
							Om,
							{
								title: v("fontList.availableFonts"),
								children: N.map((F, W) => D(F, W + k.length)),
							},
							"group_2",
						),
					),
				(0, Zi.jsxs)(Lg, {
					className: "properties-content",
					container: c,
					style: { width: "15rem" },
					onClose: s,
					onPointerLeave: i,
					onKeyDown: C,
					children: [
						(0, Zi.jsx)(Pg, {
							ref: g,
							placeholder: v("quickSearch.placeholder"),
							onChange: Sl(m, 20),
						}),
						(0, Zi.jsx)(Dg, {
							className: "dropdown-menu fonts manual-hover",
							placeholder: v("fontList.empty"),
							children: B.length ? B : null,
						}),
					],
				})
			);
		},
		(e, t) =>
			e.selectedFontFamily === t.selectedFontFamily &&
			e.hoveredFontFamily === t.hoveredFontFamily,
	);
b();
var w5 = w(Q(), 1);
var Gg = w(M(), 1),
	S5 = ({ selectedFontFamily: e }) => {
		let t = (0, w5.useMemo)(() => !!(e && !T5(e)), [e]);
		return (0, Gg.jsx)(Wc, {
			asChild: !0,
			children: (0, Gg.jsx)("div", {
				children: (0, Gg.jsx)(eg, {
					standalone: !0,
					icon: SC,
					title: v("labels.showFonts"),
					className: "properties-trigger",
					testId: "font-family-show-fonts",
					active: t,
					onClick: () => {},
				}),
			}),
		});
	};
var Ka = w(M(), 1),
	C5 = [
		{
			value: Ri.Excalifont,
			icon: Op,
			text: v("labels.handDrawn"),
			testId: "font-family-hand-drawn",
		},
		{
			value: Ri.Nunito,
			icon: Up,
			text: v("labels.normal"),
			testId: "font-family-normal",
		},
		{
			value: Ri["Comic Shanns"],
			icon: d2,
			text: v("labels.code"),
			testId: "font-family-code",
		},
	],
	tB = new Set(C5.map((e) => e.value)),
	T5 = (e) => (e ? tB.has(e) : !1),
	I5 = Xc.default.memo(
		({
			isOpened: e,
			selectedFontFamily: t,
			hoveredFontFamily: r,
			onSelect: o,
			onHover: i,
			onLeave: a,
			onPopupChange: s,
		}) => {
			let c = (0, Xc.useMemo)(() => C5, []),
				d = (0, Xc.useCallback)(
					(u) => {
						u && o(u);
					},
					[o],
				);
			return (0, Ka.jsxs)("div", {
				role: "dialog",
				"aria-modal": "true",
				className: "FontPicker__container",
				children: [
					(0, Ka.jsx)(gn, { type: "button", options: c, value: t, onClick: d }),
					(0, Ka.jsx)(rg, {}),
					(0, Ka.jsxs)(Gc, {
						open: e,
						onOpenChange: s,
						children: [
							(0, Ka.jsx)(S5, { selectedFontFamily: t }),
							e &&
								(0, Ka.jsx)(y5, {
									selectedFontFamily: t,
									hoveredFontFamily: r,
									onSelect: d,
									onHover: i,
									onLeave: a,
									onOpen: () => s(!0),
									onClose: () => s(!1),
								}),
						],
					}),
				],
			});
		},
		(e, t) =>
			e.isOpened === t.isOpened &&
			e.selectedFontFamily === t.selectedFontFamily &&
			e.hoveredFontFamily === t.hoveredFontFamily,
	);
var Ie = w(M(), 1),
	A5 = 0.1,
	go = (e, t, r, o = !1) => {
		let i = Fe(Le(e, t, { includeBoundTextElement: o }));
		return e.map((a) =>
			i.get(a.id) || a.id === t.editingTextElement?.id ? r(a) : a,
		);
	},
	ho = function (e, t, r, o, i) {
		let a = t.editingTextElement,
			s = Ve(e),
			c = null;
		return (
			a && (c = r(a)),
			c ||
				(bt(s, t)
					? (c =
							$_(o === !0 ? s : s.filter((u) => o(u)), t, r) ??
							(typeof i == "function" ? i(!0) : i))
					: (c = typeof i == "function" ? i(!1) : i)),
			c
		);
	},
	rB = (e, t) =>
		co(t) || !t.autoResize
			? t
			: me(
					t,
					{
						x:
							e.textAlign === "left"
								? e.x
								: e.x +
									(e.width - t.width) / (e.textAlign === "center" ? 2 : 1),
						y: e.y + (e.height - t.height) / 2,
					},
					!1,
				),
	py = (e, t, r, o, i) => {
		let a = new Set();
		return {
			elements: go(
				e,
				t,
				(s) => {
					if (Ee(s)) {
						let c = o(s);
						a.add(c);
						let d = Me(s, { fontSize: c });
						return (
							jt(
								d,
								r.scene.getContainerElement(s),
								r.scene.getNonDeletedElementsMap(),
							),
							(d = rB(s, d)),
							d
						);
					}
					return s;
				},
				!0,
			),
			appState: {
				...t,
				currentItemFontSize:
					a.size === 1 ? [...a][0] : (i ?? t.currentItemFontSize),
			},
			storeAction: H.CAPTURE,
		};
	},
	oB = re({
		name: "changeStrokeColor",
		label: "labels.stroke",
		trackEvent: !1,
		perform: (e, t, r) => ({
			...(r.currentItemStrokeColor && {
				elements: go(
					e,
					t,
					(o) =>
						fm(o.type) ? Me(o, { strokeColor: r.currentItemStrokeColor }) : o,
					!0,
				),
			}),
			appState: { ...t, ...r },
			storeAction: r.currentItemStrokeColor ? H.CAPTURE : H.NONE,
		}),
		PanelComponent: ({
			elements: e,
			appState: t,
			updateData: r,
			appProps: o,
		}) =>
			(0, Ie.jsxs)(Ie.Fragment, {
				children: [
					(0, Ie.jsx)("h3", {
						"aria-hidden": "true",
						children: v("labels.stroke"),
					}),
					(0, Ie.jsx)(Nm, {
						topPicks: up,
						palette: iT,
						type: "elementStroke",
						label: v("labels.stroke"),
						color: ho(e, t, (i) => i.strokeColor, !0, t.currentItemStrokeColor),
						onChange: (i) => r({ currentItemStrokeColor: i }),
						elements: e,
						appState: t,
						updateData: r,
					}),
				],
			}),
	}),
	nB = re({
		name: "changeBackgroundColor",
		label: "labels.changeBackground",
		trackEvent: !1,
		perform: (e, t, r) => ({
			...(r.currentItemBackgroundColor && {
				elements: go(e, t, (o) =>
					Me(o, { backgroundColor: r.currentItemBackgroundColor }),
				),
			}),
			appState: { ...t, ...r },
			storeAction: r.currentItemBackgroundColor ? H.CAPTURE : H.NONE,
		}),
		PanelComponent: ({
			elements: e,
			appState: t,
			updateData: r,
			appProps: o,
		}) =>
			(0, Ie.jsxs)(Ie.Fragment, {
				children: [
					(0, Ie.jsx)("h3", {
						"aria-hidden": "true",
						children: v("labels.background"),
					}),
					(0, Ie.jsx)(Nm, {
						topPicks: pp,
						palette: aT,
						type: "elementBackground",
						label: v("labels.background"),
						color: ho(
							e,
							t,
							(i) => i.backgroundColor,
							!0,
							t.currentItemBackgroundColor,
						),
						onChange: (i) => r({ currentItemBackgroundColor: i }),
						elements: e,
						appState: t,
						updateData: r,
					}),
				],
			}),
	}),
	iB = re({
		name: "changeFillStyle",
		label: "labels.fill",
		trackEvent: !1,
		perform: (e, t, r, o) => (
			We(
				"element",
				"changeFillStyle",
				`${r} (${o.device.editor.isMobile ? "mobile" : "desktop"})`,
			),
			{
				elements: go(e, t, (i) => Me(i, { fillStyle: r })),
				appState: { ...t, currentItemFillStyle: r },
				storeAction: H.CAPTURE,
			}
		),
		PanelComponent: ({ elements: e, appState: t, updateData: r }) => {
			let o = Le(e, t),
				i = o.length > 0 && o.every((a) => a.fillStyle === "zigzag");
			return (0, Ie.jsxs)("fieldset", {
				children: [
					(0, Ie.jsx)("legend", { children: v("labels.fill") }),
					(0, Ie.jsx)(gn, {
						type: "button",
						options: [
							{
								value: "hachure",
								text: `${i ? v("labels.zigzag") : v("labels.hachure")} (${V("Alt-Click")})`,
								icon: i ? zC : $C,
								active: i ? !0 : void 0,
								testId: "fill-hachure",
							},
							{
								value: "cross-hatch",
								text: v("labels.crossHatch"),
								icon: HC,
								testId: "fill-cross-hatch",
							},
							{
								value: "solid",
								text: v("labels.solid"),
								icon: UC,
								testId: "fill-solid",
							},
						],
						value: ho(
							e,
							t,
							(a) => a.fillStyle,
							(a) => a.hasOwnProperty("fillStyle"),
							(a) => (a ? null : t.currentItemFillStyle),
						),
						onClick: (a, s) => {
							let c =
								s.altKey &&
								a === "hachure" &&
								o.every((d) => d.fillStyle === "hachure")
									? "zigzag"
									: a;
							r(c);
						},
					}),
				],
			});
		},
	}),
	aB = re({
		name: "changeStrokeWidth",
		label: "labels.strokeWidth",
		trackEvent: !1,
		perform: (e, t, r) => ({
			elements: go(e, t, (o) => Me(o, { strokeWidth: r })),
			appState: { ...t, currentItemStrokeWidth: r },
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r }) =>
			(0, Ie.jsxs)("fieldset", {
				children: [
					(0, Ie.jsx)("legend", { children: v("labels.strokeWidth") }),
					(0, Ie.jsx)(gn, {
						group: "stroke-width",
						options: [
							{
								value: Tp.thin,
								text: v("labels.thin"),
								icon: Iv,
								testId: "strokeWidth-thin",
							},
							{
								value: Tp.bold,
								text: v("labels.bold"),
								icon: GC,
								testId: "strokeWidth-bold",
							},
							{
								value: Tp.extraBold,
								text: v("labels.extraBold"),
								icon: WC,
								testId: "strokeWidth-extraBold",
							},
						],
						value: ho(
							e,
							t,
							(o) => o.strokeWidth,
							(o) => o.hasOwnProperty("strokeWidth"),
							(o) => (o ? null : t.currentItemStrokeWidth),
						),
						onChange: (o) => r(o),
					}),
				],
			}),
	}),
	lB = re({
		name: "changeSloppiness",
		label: "labels.sloppiness",
		trackEvent: !1,
		perform: (e, t, r) => ({
			elements: go(e, t, (o) => Me(o, { seed: tm(), roughness: r })),
			appState: { ...t, currentItemRoughness: r },
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r }) =>
			(0, Ie.jsxs)("fieldset", {
				children: [
					(0, Ie.jsx)("legend", { children: v("labels.sloppiness") }),
					(0, Ie.jsx)(gn, {
						group: "sloppiness",
						options: [
							{ value: 0, text: v("labels.architect"), icon: VC },
							{ value: 1, text: v("labels.artist"), icon: XC },
							{ value: 2, text: v("labels.cartoonist"), icon: ZC },
						],
						value: ho(
							e,
							t,
							(o) => o.roughness,
							(o) => o.hasOwnProperty("roughness"),
							(o) => (o ? null : t.currentItemRoughness),
						),
						onChange: (o) => r(o),
					}),
				],
			}),
	}),
	$Q = re({
		name: "changeStrokeStyle",
		label: "labels.strokeStyle",
		trackEvent: !1,
		perform: (e, t, r) => ({
			elements: go(e, t, (o) => Me(o, { strokeStyle: r })),
			appState: { ...t, currentItemStrokeStyle: r },
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r }) =>
			(0, Ie.jsxs)("fieldset", {
				children: [
					(0, Ie.jsx)("legend", { children: v("labels.strokeStyle") }),
					(0, Ie.jsx)(gn, {
						group: "strokeStyle",
						options: [
							{ value: "solid", text: v("labels.strokeStyle_solid"), icon: Iv },
							{
								value: "dashed",
								text: v("labels.strokeStyle_dashed"),
								icon: KC,
							},
							{
								value: "dotted",
								text: v("labels.strokeStyle_dotted"),
								icon: YC,
							},
						],
						value: ho(
							e,
							t,
							(o) => o.strokeStyle,
							(o) => o.hasOwnProperty("strokeStyle"),
							(o) => (o ? null : t.currentItemStrokeStyle),
						),
						onChange: (o) => r(o),
					}),
				],
			}),
	}),
	sB = re({
		name: "changeOpacity",
		label: "labels.opacity",
		trackEvent: !1,
		perform: (e, t, r) => ({
			elements: go(e, t, (o) => Me(o, { opacity: r }), !0),
			appState: { ...t, currentItemOpacity: r },
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r }) =>
			(0, Ie.jsxs)("label", {
				className: "control-label",
				children: [
					v("labels.opacity"),
					(0, Ie.jsx)("input", {
						type: "range",
						min: "0",
						max: "100",
						step: "10",
						onChange: (o) => r(+o.target.value),
						value:
							ho(e, t, (o) => o.opacity, !0, t.currentItemOpacity) ?? void 0,
					}),
				],
			}),
	}),
	cB = re({
		name: "changeFontSize",
		label: "labels.fontSize",
		trackEvent: !1,
		perform: (e, t, r, o) => py(e, t, o, () => r, r),
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, Ie.jsxs)("fieldset", {
				children: [
					(0, Ie.jsx)("legend", { children: v("labels.fontSize") }),
					(0, Ie.jsx)(gn, {
						group: "font-size",
						options: [
							{
								value: 16,
								text: v("labels.small"),
								icon: a2,
								testId: "fontSize-small",
							},
							{
								value: 20,
								text: v("labels.medium"),
								icon: l2,
								testId: "fontSize-medium",
							},
							{
								value: 28,
								text: v("labels.large"),
								icon: s2,
								testId: "fontSize-large",
							},
							{
								value: 36,
								text: v("labels.veryLarge"),
								icon: c2,
								testId: "fontSize-veryLarge",
							},
						],
						value: ho(
							e,
							t,
							(i) => {
								if (Ee(i)) return i.fontSize;
								let a = ot(i, o.scene.getNonDeletedElementsMap());
								return a ? a.fontSize : null;
							},
							(i) =>
								Ee(i) || ot(i, o.scene.getNonDeletedElementsMap()) !== null,
							(i) => (i ? null : t.currentItemFontSize || zs),
						),
						onChange: (i) => r(i),
					}),
				],
			}),
	}),
	fy = re({
		name: "decreaseFontSize",
		label: "labels.decreaseFontSize",
		icon: Pl,
		trackEvent: !1,
		perform: (e, t, r, o) =>
			py(e, t, o, (i) => Math.round((1 / (1 + A5)) * i.fontSize)),
		keyTest: (e) =>
			e[R.CTRL_OR_CMD] &&
			e.shiftKey &&
			(e.key === R.CHEVRON_LEFT || e.key === R.COMMA),
	}),
	gy = re({
		name: "increaseFontSize",
		label: "labels.increaseFontSize",
		icon: Pl,
		trackEvent: !1,
		perform: (e, t, r, o) =>
			py(e, t, o, (i) => Math.round(i.fontSize * (1 + A5))),
		keyTest: (e) =>
			e[R.CTRL_OR_CMD] &&
			e.shiftKey &&
			(e.key === R.CHEVRON_RIGHT || e.key === R.PERIOD),
	}),
	dB = re({
		name: "changeFontFamily",
		label: "labels.fontFamily",
		trackEvent: !1,
		perform: (e, t, r, o) => {
			let { cachedElements: i, resetAll: a, resetContainers: s, ...c } = r;
			if (a)
				return {
					elements: go(
						e,
						t,
						(E) => {
							let T = i?.get(E.id);
							return T ? Me(E, { ...T }) : E;
						},
						!0,
					),
					appState: { ...t, ...c },
					storeAction: H.UPDATE,
				};
			let { currentItemFontFamily: d, currentHoveredFontFamily: u } = r,
				f = H.NONE,
				m,
				g = !1;
			if (d) (m = d), (f = H.CAPTURE);
			else if (u) {
				(m = u), (f = H.NONE);
				let y = Le(e, t, { includeBoundTextElement: !0 }).filter((E) => Ee(E));
				if (y.length > 200) g = !0;
				else {
					let E = 0,
						T = 0;
					for (; E < y.length && T < 5e3; ) {
						let I = y[E];
						(T += I?.originalText.length || 0), E++;
					}
					T > 5e3 && (g = !0);
				}
			}
			let h = { appState: { ...t, ...c }, storeAction: f };
			if (m && !g) {
				let y = new Map(),
					E = new Set(),
					T = !1,
					I = Array.from(Bi.loadedFontsCache.values()),
					P = Object.entries(Ri).find(([N, D]) => D === m)?.[0];
				u && P && I.some((N) => N.startsWith(P)) && (T = !0),
					Object.assign(h, {
						elements: go(
							e,
							t,
							(N) => {
								if (Ee(N) && (N.fontFamily !== m || d)) {
									let D = Me(N, { fontFamily: m, lineHeight: zi(m) }),
										B = i?.get(N.containerId || "") || {},
										F = o.scene.getContainerElement(N);
									return (
										s && F && B && me(F, { ...B }, !1),
										T || (E = new Set([...E, ...Array.from(D.originalText)])),
										y.set(D, F),
										D
									);
								}
								return N;
							},
							!0,
						),
					});
				let C = `10px ${wl({ fontFamily: m })}`,
					k = Array.from(E.values()).join();
				if (T || window.document.fonts.check(C, k))
					for (let [N, D] of y)
						jt(N, D, o.scene.getNonDeletedElementsMap(), !1);
				else
					window.document.fonts.load(C, k).then((N) => {
						for (let [D, B] of y) {
							let F = o.scene.getElement(D.id),
								W = B ? o.scene.getElement(B.id) : null;
							F && jt(F, W, o.scene.getNonDeletedElementsMap(), !1);
						}
						o.fonts.onLoaded(N);
					});
			}
			return h;
		},
		PanelComponent: ({ elements: e, appState: t, app: r, updateData: o }) => {
			let i = (0, vn.useRef)(new Map()),
				a = (0, vn.useRef)(null),
				[s, c] = (0, vn.useState)({}),
				d = (0, vn.useRef)(!0),
				u = (0, vn.useMemo)(() => {
					let f = (m, g) =>
						ho(
							m,
							t,
							(h) => {
								if (Ee(h)) return h.fontFamily;
								let y = ot(h, g);
								return y ? y.fontFamily : null;
							},
							(h) => Ee(h) || ot(h, g) !== null,
							(h) => (h ? null : t.currentItemFontFamily || $s),
						);
					return s.openPopup === "fontFamily" && t.openPopup === "fontFamily"
						? f(Array.from(i.current?.values() ?? []), i.current)
						: !s.openPopup && t.openPopup !== "fontFamily"
							? f(e, r.scene.getNonDeletedElementsMap())
							: a.current;
				}, [s.openPopup, t, e, r.scene]);
			return (
				(0, vn.useEffect)(() => {
					a.current = u;
				}, [u]),
				(0, vn.useEffect)(() => {
					Object.keys(s).length && (o(s), c({}));
				}, [s]),
				(0, vn.useEffect)(
					() => (
						(d.current = !1),
						() => {
							d.current = !0;
						}
					),
					[],
				),
				(0, Ie.jsxs)("fieldset", {
					children: [
						(0, Ie.jsx)("legend", { children: v("labels.fontFamily") }),
						(0, Ie.jsx)(I5, {
							isOpened: t.openPopup === "fontFamily",
							selectedFontFamily: u,
							hoveredFontFamily: t.currentHoveredFontFamily,
							onSelect: (f) => {
								c({
									openPopup: null,
									currentHoveredFontFamily: null,
									currentItemFontFamily: f,
								}),
									i.current.clear();
							},
							onHover: (f) => {
								c({
									currentHoveredFontFamily: f,
									cachedElements: new Map(i.current),
									resetContainers: !0,
								});
							},
							onLeave: () => {
								c({
									currentHoveredFontFamily: null,
									cachedElements: new Map(i.current),
									resetAll: !0,
								});
							},
							onPopupChange: (f) => {
								if (f) {
									i.current.clear();
									let { editingTextElement: m } = t;
									if (m?.type === "text") {
										let g = r.scene.getElement(m.id);
										i.current.set(m.id, Me(g || m, {}, !0));
									} else {
										let g = Le(e, t, { includeBoundTextElement: !0 });
										for (let h of g) i.current.set(h.id, Me(h, {}, !0));
									}
									c({ openPopup: "fontFamily" });
								} else {
									let m = {
										openPopup: null,
										currentHoveredFontFamily: null,
										cachedElements: new Map(i.current),
										resetAll: !0,
									};
									d.current ? o({ ...s, ...m }) : c(m), i.current.clear();
								}
							},
						}),
					],
				})
			);
		},
	}),
	mB = re({
		name: "changeTextAlign",
		label: "Change text alignment",
		trackEvent: !1,
		perform: (e, t, r, o) => ({
			elements: go(
				e,
				t,
				(i) => {
					if (Ee(i)) {
						let a = Me(i, { textAlign: r });
						return (
							jt(
								a,
								o.scene.getContainerElement(i),
								o.scene.getNonDeletedElementsMap(),
							),
							a
						);
					}
					return i;
				},
				!0,
			),
			appState: { ...t, currentItemTextAlign: r },
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) => {
			let i = o.scene.getNonDeletedElementsMap();
			return (0, Ie.jsxs)("fieldset", {
				children: [
					(0, Ie.jsx)("legend", { children: v("labels.textAlign") }),
					(0, Ie.jsx)(gn, {
						group: "text-align",
						options: [
							{
								value: "left",
								text: v("labels.left"),
								icon: m2,
								testId: "align-left",
							},
							{
								value: "center",
								text: v("labels.center"),
								icon: u2,
								testId: "align-horizontal-center",
							},
							{
								value: "right",
								text: v("labels.right"),
								icon: p2,
								testId: "align-right",
							},
						],
						value: ho(
							e,
							t,
							(a) => {
								if (Ee(a)) return a.textAlign;
								let s = ot(a, i);
								return s ? s.textAlign : null;
							},
							(a) => Ee(a) || ot(a, i) !== null,
							(a) => (a ? null : t.currentItemTextAlign),
						),
						onChange: (a) => r(a),
					}),
				],
			});
		},
	}),
	uB = re({
		name: "changeVerticalAlign",
		label: "Change vertical alignment",
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => ({
			elements: go(
				e,
				t,
				(i) => {
					if (Ee(i)) {
						let a = Me(i, { verticalAlign: r });
						return (
							jt(
								a,
								o.scene.getContainerElement(i),
								o.scene.getNonDeletedElementsMap(),
							),
							a
						);
					}
					return i;
				},
				!0,
			),
			appState: { ...t },
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, Ie.jsx)("fieldset", {
				children: (0, Ie.jsx)(gn, {
					group: "text-align",
					options: [
						{
							value: sn.TOP,
							text: v("labels.alignTop"),
							icon: (0, Ie.jsx)(f2, { theme: t.theme }),
							testId: "align-top",
						},
						{
							value: sn.MIDDLE,
							text: v("labels.centerVertically"),
							icon: (0, Ie.jsx)(h2, { theme: t.theme }),
							testId: "align-middle",
						},
						{
							value: sn.BOTTOM,
							text: v("labels.alignBottom"),
							icon: (0, Ie.jsx)(g2, { theme: t.theme }),
							testId: "align-bottom",
						},
					],
					value: ho(
						e,
						t,
						(i) => {
							if (Ee(i) && i.containerId) return i.verticalAlign;
							let a = ot(i, o.scene.getNonDeletedElementsMap());
							return a ? a.verticalAlign : null;
						},
						(i) => Ee(i) || ot(i, o.scene.getNonDeletedElementsMap()) !== null,
						(i) => (i ? null : sn.MIDDLE),
					),
					onChange: (i) => r(i),
				}),
			}),
	}),
	HQ = re({
		name: "changeRoundness",
		label: "Change edge roundness",
		trackEvent: !1,
		perform: (e, t, r) => ({
			elements: go(e, t, (o) =>
				qe(o)
					? o
					: Me(o, {
							roundness:
								r === "round"
									? {
											type: js(o.type)
												? To.ADAPTIVE_RADIUS
												: To.PROPORTIONAL_RADIUS,
										}
									: null,
						}),
			),
			appState: { ...t, currentItemRoundness: r },
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r }) => {
			let i = $f(Ve(e), t).some((a) => a.roundness?.type === To.LEGACY);
			return (0, Ie.jsxs)("fieldset", {
				children: [
					(0, Ie.jsx)("legend", { children: v("labels.edges") }),
					(0, Ie.jsx)(gn, {
						group: "edges",
						options: [
							{ value: "sharp", text: v("labels.sharp"), icon: qC },
							{ value: "round", text: v("labels.round"), icon: jC },
						],
						value: ho(
							e,
							t,
							(a) => (i ? null : a.roundness ? "round" : "sharp"),
							(a) => !Lt(a) && a.hasOwnProperty("roundness"),
							(a) => (a ? null : t.currentItemRoundness),
						),
						onChange: (a) => r(a),
					}),
				],
			});
		},
	}),
	_5 = (e) => [
		{
			value: null,
			text: v("labels.arrowhead_none"),
			keyBinding: "q",
			icon: QC,
		},
		{
			value: "arrow",
			text: v("labels.arrowhead_arrow"),
			keyBinding: "w",
			icon: (0, Ie.jsx)(JC, { flip: e }),
		},
		{
			value: "bar",
			text: v("labels.arrowhead_bar"),
			keyBinding: "e",
			icon: (0, Ie.jsx)(t2, { flip: e }),
		},
		{
			value: "dot",
			text: v("labels.arrowhead_circle"),
			keyBinding: null,
			icon: (0, Ie.jsx)(_v, { flip: e }),
			showInPicker: !1,
		},
		{
			value: "circle",
			text: v("labels.arrowhead_circle"),
			keyBinding: "r",
			icon: (0, Ie.jsx)(_v, { flip: e }),
			showInPicker: !1,
		},
		{
			value: "circle_outline",
			text: v("labels.arrowhead_circle_outline"),
			keyBinding: null,
			icon: (0, Ie.jsx)(e2, { flip: e }),
			showInPicker: !1,
		},
		{
			value: "triangle",
			text: v("labels.arrowhead_triangle"),
			icon: (0, Ie.jsx)(r2, { flip: e }),
			keyBinding: "t",
		},
		{
			value: "triangle_outline",
			text: v("labels.arrowhead_triangle_outline"),
			icon: (0, Ie.jsx)(o2, { flip: e }),
			keyBinding: null,
			showInPicker: !1,
		},
		{
			value: "diamond",
			text: v("labels.arrowhead_diamond"),
			icon: (0, Ie.jsx)(n2, { flip: e }),
			keyBinding: null,
			showInPicker: !1,
		},
		{
			value: "diamond_outline",
			text: v("labels.arrowhead_diamond_outline"),
			icon: (0, Ie.jsx)(i2, { flip: e }),
			keyBinding: null,
			showInPicker: !1,
		},
	],
	UQ = re({
		name: "changeArrowhead",
		label: "Change arrowheads",
		trackEvent: !1,
		perform: (e, t, r) => ({
			elements: go(e, t, (o) => {
				if (at(o)) {
					let { position: i, type: a } = r;
					if (i === "start") return Me(o, { startArrowhead: a });
					if (i === "end") return Me(o, { endArrowhead: a });
				}
				return o;
			}),
			appState: {
				...t,
				[r.position === "start"
					? "currentItemStartArrowhead"
					: "currentItemEndArrowhead"]: r.type,
			},
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r }) => {
			let o = ci().rtl;
			return (0, Ie.jsxs)("fieldset", {
				children: [
					(0, Ie.jsx)("legend", { children: v("labels.arrowheads") }),
					(0, Ie.jsxs)("div", {
						className: "iconSelectList buttonList",
						children: [
							(0, Ie.jsx)(cy, {
								label: "arrowhead_start",
								options: _5(!o),
								value: ho(
									e,
									t,
									(i) =>
										at(i) && bc(i.type)
											? i.startArrowhead
											: t.currentItemStartArrowhead,
									!0,
									t.currentItemStartArrowhead,
								),
								onChange: (i) => r({ position: "start", type: i }),
							}),
							(0, Ie.jsx)(cy, {
								label: "arrowhead_end",
								group: "arrowheads",
								options: _5(!!o),
								value: ho(
									e,
									t,
									(i) =>
										at(i) && bc(i.type)
											? i.endArrowhead
											: t.currentItemEndArrowhead,
									!0,
									t.currentItemEndArrowhead,
								),
								onChange: (i) => r({ position: "end", type: i }),
							}),
						],
					}),
				],
			});
		},
	}),
	GQ = re({
		name: "changeArrowType",
		label: "Change arrow types",
		trackEvent: !1,
		perform: (e, t, r, o) => ({
			elements: go(e, t, (i) => {
				if (!Lt(i)) return i;
				let a = Me(i, {
					roundness: r === Ar.round ? { type: To.PROPORTIONAL_RADIUS } : null,
					elbowed: r === Ar.elbow,
					points:
						r === Ar.elbow || i.elbowed
							? [i.points[0], i.points[i.points.length - 1]]
							: i.points,
				});
				if (qe(a)) {
					let s = o.scene.getNonDeletedElementsMap();
					o.dismissLinearEditor();
					let c = De.getPointAtIndexGlobalCoordinates(a, 0, s),
						d = De.getPointAtIndexGlobalCoordinates(a, -1, s),
						u = !a.startBinding && Ia(ya(c), e, s, t.zoom, !0),
						f = !a.endBinding && Ia(ya(d), e, s, t.zoom, !0),
						m = u || (a.startBinding && s.get(a.startBinding.elementId)),
						g = f || (a.endBinding && s.get(a.endBinding.elementId)),
						h = u ? Pv(c, d, u, s) : c,
						y = f ? Pv(d, c, f, s) : d;
					u && $i(a, u, "start", s),
						f && $i(a, f, "end", s),
						Ui(
							a,
							s,
							[h, y].map((E) => pe(E[0] - a.x, E[1] - a.y)),
							Ws(0, 0),
							{
								...(m && a.startBinding
									? {
											startBinding: {
												...a.startBinding,
												...Rv(a, m, "start", s),
											},
										}
									: {}),
								...(g && a.endBinding
									? { endBinding: { ...a.endBinding, ...Rv(a, g, "end", s) } }
									: {}),
							},
						);
				}
				return a;
			}),
			appState: { ...t, currentItemArrowType: r },
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r }) =>
			(0, Ie.jsxs)("fieldset", {
				children: [
					(0, Ie.jsx)("legend", { children: v("labels.arrowtypes") }),
					(0, Ie.jsx)(gn, {
						group: "arrowtypes",
						options: [
							{
								value: Ar.sharp,
								text: v("labels.arrowtype_sharp"),
								icon: G2,
								testId: "sharp-arrow",
							},
							{
								value: Ar.round,
								text: v("labels.arrowtype_round"),
								icon: K2,
								testId: "round-arrow",
							},
							{
								value: Ar.elbow,
								text: v("labels.arrowtype_elbowed"),
								icon: W2,
								testId: "elbow-arrow",
							},
						],
						value: ho(
							e,
							t,
							(o) =>
								Lt(o)
									? o.elbowed
										? Ar.elbow
										: o.roundness
											? Ar.round
											: Ar.sharp
									: null,
							(o) => Lt(o),
							(o) => (o ? null : t.currentItemArrowType),
						),
						onChange: (o) => r(o),
					}),
				],
			}),
	});
b();
b();
var qi = ({ viewportX: e, viewportY: t, nextZoom: r }, o) => {
	let i = e - o.offsetLeft,
		a = t - o.offsetTop,
		s = o.zoom.value,
		c = o.scrollX + (i - i / s),
		d = o.scrollY + (a - a / s),
		u = -(i - i / r),
		f = -(a - a / r);
	return { scrollX: c + u, scrollY: d + f, zoom: { value: r } };
};
b();
var k5 = w(Q(), 1),
	L5 = w(M(), 1),
	Zc = () => {
		let e = document.querySelector(".excalidraw-tooltip");
		if (e) return e;
		let t = document.createElement("div");
		return (
			document.body.appendChild(t), t.classList.add("excalidraw-tooltip"), t
		);
	},
	hy = (e, t, r = "bottom") => {
		let o = e.getBoundingClientRect(),
			i = window.innerWidth,
			a = window.innerHeight,
			s = 5,
			c = t.left + t.width / 2 - o.width / 2;
		c < 0 ? (c = s) : c + o.width >= i && (c = i - o.width - s);
		let d;
		r === "bottom"
			? ((d = t.top + t.height + s),
				d + o.height >= a && (d = t.top - o.height - s))
			: ((d = t.top - o.height - s), d < 0 && (d = t.top + t.height + s)),
			Object.assign(e.style, { top: `${d}px`, left: `${c}px` });
	},
	pB = (e, t, r, o) => {
		t.classList.add("excalidraw-tooltip--visible"),
			(t.style.minWidth = o ? "50ch" : "10ch"),
			(t.style.maxWidth = o ? "50ch" : "15ch"),
			(t.textContent = r);
		let i = e.getBoundingClientRect();
		hy(t, i);
	},
	Xo = ({ children: e, label: t, long: r = !1, style: o, disabled: i }) => (
		(0, k5.useEffect)(
			() => () => Zc().classList.remove("excalidraw-tooltip--visible"),
			[],
		),
		i
			? null
			: (0, L5.jsx)("div", {
					className: "excalidraw-tooltip-wrapper",
					onPointerEnter: (a) => pB(a.currentTarget, Zc(), t, r),
					onPointerLeave: () =>
						Zc().classList.remove("excalidraw-tooltip--visible"),
					style: o,
					children: e,
				})
	);
var Jl = w(M(), 1),
	fB = re({
		name: "changeViewBackgroundColor",
		label: "labels.canvasBackground",
		paletteName: "Change canvas background color",
		trackEvent: !1,
		predicate: (e, t, r, o) =>
			!!o.props.UIOptions.canvasActions.changeViewBackgroundColor &&
			!t.viewModeEnabled,
		perform: (e, t, r) => ({
			appState: { ...t, ...r },
			storeAction: r.viewBackgroundColor ? H.CAPTURE : H.NONE,
		}),
		PanelComponent: ({
			elements: e,
			appState: t,
			updateData: r,
			appProps: o,
		}) =>
			(0, Jl.jsx)(Nm, {
				palette: null,
				topPicks: fp,
				label: v("labels.canvasBackground"),
				type: "canvasBackground",
				color: t.viewBackgroundColor,
				onChange: (i) => r({ viewBackgroundColor: i }),
				"data-testid": "canvas-background-picker",
				elements: e,
				appState: t,
				updateData: r,
			}),
	}),
	ji = re({
		name: "clearCanvas",
		label: "labels.clearCanvas",
		paletteName: "Clear canvas",
		icon: Uo,
		trackEvent: { category: "canvas" },
		predicate: (e, t, r, o) =>
			!!o.props.UIOptions.canvasActions.clearCanvas &&
			!t.viewModeEnabled &&
			t.openDialog?.name !== "elementLinkSelector",
		perform: (e, t, r, o) => (
			o.imageCache.clear(),
			{
				elements: e.map((i) => Me(i, { isDeleted: !0 })),
				appState: {
					...ec(),
					files: {},
					theme: t.theme,
					penMode: t.penMode,
					penDetected: t.penDetected,
					exportBackground: t.exportBackground,
					exportEmbedScene: t.exportEmbedScene,
					gridSize: t.gridSize,
					gridStep: t.gridStep,
					gridModeEnabled: t.gridModeEnabled,
					stats: t.stats,
					pasteDialog: t.pasteDialog,
					activeTool:
						t.activeTool.type === "image"
							? { ...t.activeTool, type: "selection" }
							: t.activeTool,
				},
				storeAction: H.CAPTURE,
			}
		),
	}),
	Wg = re({
		name: "zoomIn",
		label: "buttons.zoomIn",
		viewMode: !0,
		icon: cv,
		trackEvent: { category: "canvas" },
		perform: (e, t, r, o) => ({
			appState: {
				...t,
				...qi(
					{
						viewportX: t.width / 2 + t.offsetLeft,
						viewportY: t.height / 2 + t.offsetTop,
						nextZoom: li(t.zoom.value + Hs),
					},
					t,
				),
				userToFollow: null,
			},
			storeAction: H.NONE,
		}),
		PanelComponent: ({ updateData: e, appState: t }) =>
			(0, Jl.jsx)(Te, {
				type: "button",
				className: "zoom-in-button zoom-button",
				icon: cv,
				title: `${v("buttons.zoomIn")} \u2014 ${V("CtrlOrCmd++")}`,
				"aria-label": v("buttons.zoomIn"),
				disabled: t.zoom.value >= Zx,
				onClick: () => {
					e(null);
				},
			}),
		keyTest: (e) =>
			(e.code === Be.EQUAL || e.code === Be.NUM_ADD) &&
			(e[R.CTRL_OR_CMD] || e.shiftKey),
	}),
	Kg = re({
		name: "zoomOut",
		label: "buttons.zoomOut",
		icon: dv,
		viewMode: !0,
		trackEvent: { category: "canvas" },
		perform: (e, t, r, o) => ({
			appState: {
				...t,
				...qi(
					{
						viewportX: t.width / 2 + t.offsetLeft,
						viewportY: t.height / 2 + t.offsetTop,
						nextZoom: li(t.zoom.value - Hs),
					},
					t,
				),
				userToFollow: null,
			},
			storeAction: H.NONE,
		}),
		PanelComponent: ({ updateData: e, appState: t }) =>
			(0, Jl.jsx)(Te, {
				type: "button",
				className: "zoom-out-button zoom-button",
				icon: dv,
				title: `${v("buttons.zoomOut")} \u2014 ${V("CtrlOrCmd+-")}`,
				"aria-label": v("buttons.zoomOut"),
				disabled: t.zoom.value <= Xx,
				onClick: () => {
					e(null);
				},
			}),
		keyTest: (e) =>
			(e.code === Be.MINUS || e.code === Be.NUM_SUBTRACT) &&
			(e[R.CTRL_OR_CMD] || e.shiftKey),
	}),
	Yg = re({
		name: "resetZoom",
		label: "buttons.resetZoom",
		icon: TC,
		viewMode: !0,
		trackEvent: { category: "canvas" },
		perform: (e, t, r, o) => ({
			appState: {
				...t,
				...qi(
					{
						viewportX: t.width / 2 + t.offsetLeft,
						viewportY: t.height / 2 + t.offsetTop,
						nextZoom: li(1),
					},
					t,
				),
				userToFollow: null,
			},
			storeAction: H.NONE,
		}),
		PanelComponent: ({ updateData: e, appState: t }) =>
			(0, Jl.jsx)(Xo, {
				label: v("buttons.resetZoom"),
				style: { height: "100%" },
				children: (0, Jl.jsxs)(Te, {
					type: "button",
					className: "reset-zoom-button zoom-button",
					title: v("buttons.resetZoom"),
					"aria-label": v("buttons.resetZoom"),
					onClick: () => {
						e(null);
					},
					children: [(t.zoom.value * 100).toFixed(0), "%"],
				}),
			}),
		keyTest: (e) =>
			(e.code === Be.ZERO || e.code === Be.NUM_ZERO) &&
			(e[R.CTRL_OR_CMD] || e.shiftKey),
	}),
	gB = (e, t, r = 1) => {
		let [o, i, a, s] = e,
			c = a - o,
			d = t.width / c,
			u = s - i,
			f = t.height / u,
			g = Math.min(d, f) * kr(r, 0.1, 1);
		return Math.min(g, 1);
	},
	M5 = ({
		bounds: e,
		appState: t,
		canvasOffsets: r,
		fitToViewport: o = !1,
		viewportZoomFactor: i = 1,
		minZoom: a = -1 / 0,
		maxZoom: s = 1 / 0,
	}) => {
		i = kr(i, Xx, Zx);
		let [c, d, u, f] = e,
			m = (c + u) / 2,
			g = (d + f) / 2,
			h = r?.left ?? 0,
			y = r?.top ?? 0,
			E = r?.right ?? 0,
			T = r?.bottom ?? 0,
			I = t.width - h - E,
			P = t.height - y - T,
			C;
		if (o) {
			let D = u - c,
				B = f - d;
			C = Math.min(I / D, P / B) * i;
		} else C = gB(e, { width: I, height: P }, i);
		let k = li(kr(OT(C, Hs, "floor"), a, s)),
			N = H_({
				scenePoint: { x: m, y: g },
				viewportDimensions: { width: t.width, height: t.height },
				offsets: r,
				zoom: { value: k },
			});
		return {
			appState: {
				...t,
				scrollX: N.scrollX,
				scrollY: N.scrollY,
				zoom: { value: k },
			},
			storeAction: H.NONE,
		};
	},
	Fm = ({
		canvasOffsets: e,
		targetElements: t,
		appState: r,
		fitToViewport: o,
		viewportZoomFactor: i,
		minZoom: a,
		maxZoom: s,
	}) => {
		let c = yt(Ve(t));
		return M5({
			canvasOffsets: e,
			bounds: c,
			appState: r,
			fitToViewport: o,
			viewportZoomFactor: i,
			minZoom: a,
			maxZoom: s,
		});
	},
	vJ = re({
		name: "zoomToFitSelectionInViewport",
		label: "labels.zoomToFitViewport",
		icon: qp,
		trackEvent: { category: "canvas" },
		perform: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t);
			return Fm({
				targetElements: i.length ? i : e,
				appState: { ...t, userToFollow: null },
				fitToViewport: !1,
				canvasOffsets: o.getEditorUIOffsets(),
			});
		},
		keyTest: (e) =>
			e.code === Be.TWO && e.shiftKey && !e.altKey && !e[R.CTRL_OR_CMD],
	}),
	EJ = re({
		name: "zoomToFitSelection",
		label: "helpDialog.zoomToSelection",
		icon: qp,
		trackEvent: { category: "canvas" },
		perform: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t);
			return Fm({
				targetElements: i.length ? i : e,
				appState: { ...t, userToFollow: null },
				fitToViewport: !0,
				canvasOffsets: o.getEditorUIOffsets(),
			});
		},
		keyTest: (e) =>
			e.code === Be.THREE && e.shiftKey && !e.altKey && !e[R.CTRL_OR_CMD],
	}),
	hB = re({
		name: "zoomToFit",
		label: "helpDialog.zoomToFit",
		icon: qp,
		viewMode: !0,
		trackEvent: { category: "canvas" },
		perform: (e, t, r, o) =>
			Fm({
				targetElements: e,
				appState: { ...t, userToFollow: null },
				fitToViewport: !1,
				canvasOffsets: o.getEditorUIOffsets(),
			}),
		keyTest: (e) =>
			e.code === Be.ONE && e.shiftKey && !e.altKey && !e[R.CTRL_OR_CMD],
	}),
	Ql = re({
		name: "toggleTheme",
		label: (e, t) =>
			t.theme === $e.DARK ? "buttons.lightMode" : "buttons.darkMode",
		keywords: ["toggle", "dark", "light", "mode", "theme"],
		icon: (e) => (e.theme === $e.LIGHT ? om : nm),
		viewMode: !0,
		trackEvent: { category: "canvas" },
		perform: (e, t, r) => ({
			appState: {
				...t,
				theme: r || (t.theme === $e.LIGHT ? $e.DARK : $e.LIGHT),
			},
			storeAction: H.NONE,
		}),
		keyTest: (e) => e.altKey && e.shiftKey && e.code === Be.D,
		predicate: (e, t, r, o) => !!o.props.UIOptions.canvasActions.toggleTheme,
	}),
	yJ = re({
		name: "toggleEraserTool",
		label: "toolBar.eraser",
		trackEvent: { category: "toolbar" },
		perform: (e, t) => {
			let r;
			return (
				dn(t)
					? (r = Yt(t, {
							...(t.activeTool.lastActiveTool || { type: "selection" }),
							lastActiveToolBeforeEraser: null,
						}))
					: (r = Yt(t, {
							type: "eraser",
							lastActiveToolBeforeEraser: t.activeTool,
						})),
				{
					appState: {
						...t,
						selectedElementIds: {},
						selectedGroupIds: {},
						activeEmbeddable: null,
						activeTool: r,
					},
					storeAction: H.CAPTURE,
				}
			);
		},
		keyTest: (e) => e.key === R.E,
	}),
	P5 = re({
		name: "toggleHandTool",
		label: "toolBar.hand",
		paletteName: "Toggle hand tool",
		trackEvent: { category: "toolbar" },
		icon: Wp,
		viewMode: !1,
		perform: (e, t, r, o) => {
			let i;
			return (
				Fi(t)
					? (i = Yt(t, {
							...(t.activeTool.lastActiveTool || { type: "selection" }),
							lastActiveToolBeforeEraser: null,
						}))
					: ((i = Yt(t, {
							type: "hand",
							lastActiveToolBeforeEraser: t.activeTool,
						})),
						ft(o.interactiveCanvas, pt.GRAB)),
				{
					appState: {
						...t,
						selectedElementIds: {},
						selectedGroupIds: {},
						activeEmbeddable: null,
						activeTool: i,
					},
					storeAction: H.CAPTURE,
				}
			);
		},
		keyTest: (e) => !e.altKey && !e[R.CTRL_OR_CMD] && e.key === R.H,
	});
b();
var R5 = w(M(), 1),
	Zo = re({
		name: "finalize",
		label: "",
		trackEvent: !1,
		perform: (e, t, r, o) => {
			let { interactiveCanvas: i, focusContainer: a, scene: s } = o,
				c = s.getNonDeletedElementsMap();
			if (t.editingLinearElement) {
				let {
						elementId: g,
						startBindingElement: h,
						endBindingElement: y,
					} = t.editingLinearElement,
					E = De.getElement(g, c);
				if (E)
					return (
						Ni(E) && df(E, h, y, c, s),
						{
							elements:
								E.points.length < 2 || Wl(E)
									? e.filter((T) => T.id !== E.id)
									: void 0,
							appState: {
								...t,
								cursorButton: "up",
								editingLinearElement: null,
							},
							storeAction: H.CAPTURE,
						}
					);
			}
			let d = e,
				u = t.pendingImageElementId && s.getElement(t.pendingImageElementId);
			u && me(u, { isDeleted: !0 }, !1),
				window.document.activeElement instanceof HTMLElement && a();
			let f = t.multiElement
				? t.multiElement
				: t.newElement?.type === "freedraw"
					? t.newElement
					: null;
			if (f) {
				if (f.type !== "freedraw" && t.lastPointerDownWith !== "touch") {
					let { points: h, lastCommittedPoint: y } = f;
					(!y || h[h.length - 1] !== y) &&
						me(f, { points: f.points.slice(0, -1) });
				}
				Wl(f) && (d = d.filter((h) => h.id !== f.id));
				let g = lm(f.points, t.zoom.value);
				if ((f.type === "line" || f.type === "freedraw") && g) {
					let h = f.points,
						y = h[0];
					me(f, {
						points: h.map((E, T) => (T === h.length - 1 ? pe(y[0], y[1]) : E)),
					});
				}
				if (Ni(f) && !g && f.points.length > 1) {
					let [h, y] = De.getPointAtIndexGlobalCoordinates(f, -1, Fe(e));
					cm(f, t, { x: h, y }, c, e);
				}
			}
			((!t.activeTool.locked && t.activeTool.type !== "freedraw") || !f) &&
				mn(i);
			let m;
			return (
				t.activeTool.type === "eraser"
					? (m = Yt(t, {
							...(t.activeTool.lastActiveTool || { type: "selection" }),
							lastActiveToolBeforeEraser: null,
						}))
					: (m = Yt(t, { type: "selection" })),
				{
					elements: d,
					appState: {
						...t,
						cursorButton: "up",
						activeTool:
							(t.activeTool.locked || t.activeTool.type === "freedraw") && f
								? t.activeTool
								: m,
						activeEmbeddable: null,
						newElement: null,
						selectionElement: null,
						multiElement: null,
						editingTextElement: null,
						startBoundElement: null,
						suggestedBindings: [],
						selectedElementIds:
							f && !t.activeTool.locked && t.activeTool.type !== "freedraw"
								? { ...t.selectedElementIds, [f.id]: !0 }
								: t.selectedElementIds,
						selectedLinearElement:
							f && at(f) ? new De(f) : t.selectedLinearElement,
						pendingImageElementId: null,
					},
					storeAction: H.CAPTURE,
				}
			);
		},
		keyTest: (e, t) =>
			(e.key === R.ESCAPE &&
				(t.editingLinearElement !== null ||
					(!t.newElement && t.multiElement === null))) ||
			((e.key === R.ESCAPE || e.key === R.ENTER) && t.multiElement !== null),
		PanelComponent: ({ appState: e, updateData: t, data: r }) =>
			(0, R5.jsx)(Te, {
				type: "button",
				icon: DC,
				title: v("buttons.done"),
				"aria-label": v("buttons.done"),
				onClick: t,
				visible: e.multiElement != null,
				size: r?.size || "medium",
				style: { pointerEvents: "all" },
			}),
	});
b();
b();
var D5 = w(Q(), 1);
var Bm = w(M(), 1),
	N5 = (e) => {
		let { id: t } = dr(),
			[r, o] = (0, D5.useState)(e.value),
			i = (s) => {
				e.ignoreFocus || GT(s.target);
				let c = s.target.value;
				c !== e.value && e.onChange(c);
			},
			a = (s) => {
				if (s.key === R.ENTER) {
					if (
						(s.preventDefault(), s.nativeEvent.isComposing || s.keyCode === 229)
					)
						return;
					s.currentTarget.blur();
				}
			};
		return (0, Bm.jsxs)("div", {
			className: "ProjectName",
			children: [
				(0, Bm.jsx)("label", {
					className: "ProjectName-label",
					htmlFor: "filename",
					children: `${e.label}:`,
				}),
				(0, Bm.jsx)("input", {
					type: "text",
					className: "TextInput",
					onBlur: i,
					onKeyDown: a,
					id: `${t}-filename`,
					value: r,
					onChange: (s) => o(s.target.value),
				}),
			],
		});
	};
b();
var qc = w(M(), 1),
	F5 = (e) => {
		let t =
			e.title ||
			(e.value === $e.DARK ? v("buttons.lightMode") : v("buttons.darkMode"));
		return (0, qc.jsx)(Te, {
			type: "icon",
			icon: e.value === $e.LIGHT ? O5.MOON : O5.SUN,
			title: t,
			"aria-label": t,
			onClick: () => e.onChange(e.value === $e.DARK ? $e.LIGHT : $e.DARK),
			"data-testid": "toggle-dark-mode",
		});
	},
	O5 = {
		SUN: (0, qc.jsx)("svg", {
			width: "512",
			height: "512",
			className: "rtl-mirror",
			viewBox: "0 0 512 512",
			children: (0, qc.jsx)("path", {
				fill: "currentColor",
				d: "M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z",
			}),
		}),
		MOON: (0, qc.jsx)("svg", {
			width: "512",
			height: "512",
			className: "rtl-mirror",
			viewBox: "0 0 512 512",
			children: (0, qc.jsx)("path", {
				fill: "currentColor",
				d: "M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z",
			}),
		}),
	};
b();
var es = (e, { selectedElementIds: t }, r) => {
		e = Ve(e);
		let o = r && bt(e, { selectedElementIds: t }),
			i = null,
			a = o
				? Le(e, { selectedElementIds: t }, { includeBoundTextElement: !0 })
				: e;
		return (
			o &&
				(a.length === 1 && Ye(a[0])
					? ((i = a[0]), (a = Df(e, i)))
					: a.length > 1 &&
						(a = Le(
							e,
							{ selectedElementIds: t },
							{ includeBoundTextElement: !0, includeElementsInFrames: !0 },
						))),
			{ exportingFrame: i, exportedElements: _o(a) }
		);
	},
	ts = async (
		e,
		t,
		r,
		o,
		{
			exportBackground: i,
			exportPadding: a = ba,
			viewBackgroundColor: s,
			name: c = r.name || PT,
			fileHandle: d = null,
			exportingFrame: u = null,
		},
	) => {
		if (t.length === 0) throw new Error(v("alerts.cannotExportEmptyCanvas"));
		if (e === "svg" || e === "clipboard-svg") {
			let m = If(
				t,
				{
					exportBackground: i,
					exportWithDarkMode: r.exportWithDarkMode,
					viewBackgroundColor: s,
					exportPadding: a,
					exportScale: r.exportScale,
					exportEmbedScene: r.exportEmbedScene && e === "svg",
				},
				o,
				{ exportingFrame: u },
			);
			if (e === "svg")
				return Ov(
					m.then((g) => new Blob([g.outerHTML], { type: vr.svg })),
					{
						description: "Export to SVG",
						name: c,
						extension: r.exportEmbedScene ? "excalidraw.svg" : "svg",
						fileHandle: d,
					},
				);
			if (e === "clipboard-svg") {
				let g = await m.then((h) => h.outerHTML);
				try {
					await Aa(g);
				} catch {
					throw new Error(v("errors.copyToSystemClipboardFailed"));
				}
				return;
			}
		}
		let f = HI(t, r, o, {
			exportBackground: i,
			viewBackgroundColor: s,
			exportPadding: a,
			exportingFrame: u,
		});
		if (e === "png") {
			let m = Hi(f);
			return (
				r.exportEmbedScene &&
					(m = m.then((g) =>
						import("./excalidraw-assets/image-QE4H3IIT.js").then(
							({ encodePngMetadata: h }) =>
								h({ blob: g, metadata: Uv(t, r, o, "local") }),
						),
					)),
				Ov(m, {
					description: "Export to PNG",
					name: c,
					extension: "png",
					fileHandle: d,
				})
			);
		} else if (e === "clipboard")
			try {
				let m = Hi(f);
				await VI(m);
			} catch (m) {
				throw (
					(console.warn(m),
					m.name === "CANVAS_POSSIBLY_TOO_BIG"
						? new Error(v("canvasError.canvasTooBig"))
						: Pi && m.name === "TypeError"
							? new Error(`${v("alerts.couldNotCopyToClipboard")}

${v("hints.firefox_clipboard_write")}`)
							: new Error(v("alerts.couldNotCopyToClipboard")))
				);
			}
		else throw new Error("Unsupported export type");
	};
b();
var B5 = async (e, t, r, o) => {
	let { exportBackground: i, viewBackgroundColor: a, fileHandle: s } = t,
		c = wI(s);
	if (!s || !SI(c))
		throw new Error(
			"fileHandle should exist and should be of type svg or png when resaving",
		);
	t = { ...t, exportEmbedScene: !0 };
	let { exportedElements: d, exportingFrame: u } = es(e, t, !1);
	return (
		await ts(c, d, t, r, {
			exportBackground: i,
			viewBackgroundColor: a,
			name: o,
			fileHandle: s,
			exportingFrame: u,
		}),
		{ fileHandle: s }
	);
};
b();
var zm = w(M(), 1),
	$m = ({ children: e, checked: t, onChange: r, className: o }) =>
		(0, zm.jsxs)("div", {
			className: j("Checkbox", o, { "is-checked": t }),
			onClick: (i) => {
				r(!t, i), i.currentTarget.querySelector(".Checkbox-box").focus();
			},
			children: [
				(0, zm.jsx)("button", {
					type: "button",
					className: "Checkbox-box",
					role: "checkbox",
					"aria-checked": t,
					children: kC,
				}),
				(0, zm.jsx)("div", { className: "Checkbox-label", children: e }),
			],
		});
var Mo = w(M(), 1),
	by = re({
		name: "changeProjectName",
		label: "labels.fileTitle",
		trackEvent: !1,
		perform: (e, t, r) => ({
			appState: { ...t, name: r },
			storeAction: H.NONE,
		}),
		PanelComponent: ({
			appState: e,
			updateData: t,
			appProps: r,
			data: o,
			app: i,
		}) =>
			(0, Mo.jsx)(N5, {
				label: v("labels.fileTitle"),
				value: i.getName(),
				onChange: (a) => t(a),
				ignoreFocus: o?.ignoreFocus ?? !1,
			}),
	}),
	z5 = re({
		name: "changeExportScale",
		label: "imageExportDialog.scale",
		trackEvent: { category: "export", action: "scale" },
		perform: (e, t, r) => ({
			appState: { ...t, exportScale: r },
			storeAction: H.NONE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r }) => {
			let o = Ve(e),
				a = bt(o, t) ? Le(o, t) : o;
			return (0, Mo.jsx)(Mo.Fragment, {
				children: wp.map((s) => {
					let [c, d] = UI(a, ba, s),
						u = `${v("imageExportDialog.label.scale")} ${s}x (${c}x${d})`;
					return (0, Mo.jsx)(
						Te,
						{
							size: "small",
							type: "radio",
							icon: `${s}x`,
							name: "export-canvas-scale",
							title: u,
							"aria-label": u,
							id: "export-canvas-scale",
							checked: s === t.exportScale,
							onChange: () => r(s),
						},
						s,
					);
				}),
			});
		},
	}),
	xy = re({
		name: "changeExportBackground",
		label: "imageExportDialog.label.withBackground",
		trackEvent: { category: "export", action: "toggleBackground" },
		perform: (e, t, r) => ({
			appState: { ...t, exportBackground: r },
			storeAction: H.NONE,
		}),
		PanelComponent: ({ appState: e, updateData: t }) =>
			(0, Mo.jsx)($m, {
				checked: e.exportBackground,
				onChange: (r) => t(r),
				children: v("imageExportDialog.label.withBackground"),
			}),
	}),
	Vg = re({
		name: "changeExportEmbedScene",
		label: "imageExportDialog.tooltip.embedScene",
		trackEvent: { category: "export", action: "embedScene" },
		perform: (e, t, r) => ({
			appState: { ...t, exportEmbedScene: r },
			storeAction: H.NONE,
		}),
		PanelComponent: ({ appState: e, updateData: t }) =>
			(0, Mo.jsxs)($m, {
				checked: e.exportEmbedScene,
				onChange: (r) => t(r),
				children: [
					v("imageExportDialog.label.embedScene"),
					(0, Mo.jsx)(Xo, {
						label: v("imageExportDialog.tooltip.embedScene"),
						long: !0,
						children: (0, Mo.jsx)("div", {
							className: "excalidraw-tooltip-icon",
							children: NC,
						}),
					}),
				],
			}),
	}),
	Xg = re({
		name: "saveToActiveFile",
		label: "buttons.save",
		icon: Ml,
		trackEvent: { category: "export" },
		predicate: (e, t, r, o) =>
			!!o.props.UIOptions.canvasActions.saveToActiveFile &&
			!!t.fileHandle &&
			!t.viewModeEnabled,
		perform: async (e, t, r, o) => {
			let i = !!t.fileHandle;
			try {
				let { fileHandle: a } = gf(t.fileHandle)
					? await B5(e, t, o.files, o.getName())
					: await vf(e, t, o.files, o.getName());
				return {
					storeAction: H.NONE,
					appState: {
						...t,
						fileHandle: a,
						toast: i
							? {
									message: a?.name
										? v("toast.fileSavedToFilename").replace(
												"{filename}",
												`"${a.name}"`,
											)
										: v("toast.fileSaved"),
								}
							: null,
					},
				};
			} catch (a) {
				return (
					a?.name !== "AbortError" ? console.error(a) : console.warn(a),
					{ storeAction: H.NONE }
				);
			}
		},
		keyTest: (e) => e.key === R.S && e[R.CTRL_OR_CMD] && !e.shiftKey,
	}),
	Hm = re({
		name: "saveFileToDisk",
		label: "exportDialog.disk_title",
		icon: Ml,
		viewMode: !0,
		trackEvent: { category: "export" },
		perform: async (e, t, r, o) => {
			try {
				let { fileHandle: i } = await vf(
					e,
					{ ...t, fileHandle: null },
					o.files,
					o.getName(),
				);
				return {
					storeAction: H.NONE,
					appState: {
						...t,
						openDialog: null,
						fileHandle: i,
						toast: { message: v("toast.fileSaved") },
					},
				};
			} catch (i) {
				return (
					i?.name !== "AbortError" ? console.error(i) : console.warn(i),
					{ storeAction: H.NONE }
				);
			}
		},
		keyTest: (e) => e.key === R.S && e.shiftKey && e[R.CTRL_OR_CMD],
		PanelComponent: ({ updateData: e }) =>
			(0, Mo.jsx)(Te, {
				type: "button",
				icon: MC,
				title: v("buttons.saveAs"),
				"aria-label": v("buttons.saveAs"),
				showAriaLabel: et().editor.isMobile,
				hidden: !fc,
				onClick: () => e(null),
				"data-testid": "save-as-button",
			}),
	}),
	jc = re({
		name: "loadScene",
		label: "buttons.load",
		trackEvent: { category: "export" },
		predicate: (e, t, r, o) =>
			!!o.props.UIOptions.canvasActions.loadScene && !t.viewModeEnabled,
		perform: async (e, t, r, o) => {
			try {
				let { elements: i, appState: a, files: s } = await Gv(t, e);
				return { elements: i, appState: a, files: s, storeAction: H.CAPTURE };
			} catch (i) {
				return i?.name === "AbortError"
					? (console.warn(i), !1)
					: {
							elements: e,
							appState: { ...t, errorMessage: i.message },
							files: o.files,
							storeAction: H.NONE,
						};
			}
		},
		keyTest: (e) => e[R.CTRL_OR_CMD] && e.key === R.O,
	}),
	$5 = re({
		name: "exportWithDarkMode",
		label: "imageExportDialog.label.darkMode",
		trackEvent: { category: "export", action: "toggleTheme" },
		perform: (e, t, r) => ({
			appState: { ...t, exportWithDarkMode: r },
			storeAction: H.NONE,
		}),
		PanelComponent: ({ appState: e, updateData: t }) =>
			(0, Mo.jsx)("div", {
				style: {
					display: "flex",
					justifyContent: "flex-end",
					marginTop: "-45px",
					marginBottom: "10px",
				},
				children: (0, Mo.jsx)(F5, {
					value: e.exportWithDarkMode ? $e.DARK : $e.LIGHT,
					onChange: (r) => {
						t(r === $e.DARK);
					},
					title: v("imageExportDialog.label.darkMode"),
				}),
			}),
	});
b();
var H5 = "{}",
	vy = re({
		name: "copyStyles",
		label: "labels.copyStyles",
		icon: kv,
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => {
			let i = [],
				a = e.find((s) => t.selectedElementIds[s.id]);
			if ((i.push(a), a && Ao(a))) {
				let s = ot(a, o.scene.getNonDeletedElementsMap());
				i.push(s);
			}
			return (
				a && (H5 = JSON.stringify(i)),
				{
					appState: { ...t, toast: { message: v("toast.copyStyles") } },
					storeAction: H.NONE,
				}
			);
		},
		keyTest: (e) => e[R.CTRL_OR_CMD] && e.altKey && e.code === Be.C,
	}),
	Ey = re({
		name: "pasteStyles",
		label: "labels.pasteStyles",
		icon: kv,
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => {
			let i = JSON.parse(H5),
				a = i[0],
				s = i[1];
			if (!tC(a)) return { elements: e, storeAction: H.NONE };
			let c = Le(e, t, { includeBoundTextElement: !0 }),
				d = c.map((u) => u.id);
			return {
				elements: e.map((u) => {
					if (d.includes(u.id)) {
						let f = a;
						if ((Ee(u) && u.containerId && (f = s), !f)) return u;
						let m = Me(u, {
							backgroundColor: f?.backgroundColor,
							strokeWidth: f?.strokeWidth,
							strokeColor: f?.strokeColor,
							strokeStyle: f?.strokeStyle,
							fillStyle: f?.fillStyle,
							opacity: f?.opacity,
							roughness: f?.roughness,
							roundness: f.roundness
								? rC(f.roundness.type, u)
									? f.roundness
									: oC(u)
								: null,
						});
						if (Ee(m)) {
							let g = f.fontSize || zs,
								h = f.fontFamily || $s;
							m = Me(m, {
								fontSize: g,
								fontFamily: h,
								textAlign: f.textAlign || bp,
								lineHeight: f.lineHeight || zi(h),
							});
							let y = null;
							m.containerId &&
								(y = c.find((E) => Ee(m) && E.id === m.containerId) || null),
								jt(m, y, o.scene.getNonDeletedElementsMap());
						}
						return (
							m.type === "arrow" &&
								Lt(f) &&
								(m = Me(m, {
									startArrowhead: f.startArrowhead,
									endArrowhead: f.endArrowhead,
								})),
							Ye(u) &&
								(m = Me(m, {
									roundness: null,
									backgroundColor: "transparent",
								})),
							m
						);
					}
					return u;
				}),
				storeAction: H.CAPTURE,
			};
		},
		keyTest: (e) => e[R.CTRL_OR_CMD] && e.altKey && e.code === Be.V,
	});
b();
var yy = w(M(), 1),
	bB = re({
		name: "toggleCanvasMenu",
		label: "buttons.menu",
		trackEvent: { category: "menu" },
		perform: (e, t) => ({
			appState: { ...t, openMenu: t.openMenu === "canvas" ? null : "canvas" },
			storeAction: H.NONE,
		}),
		PanelComponent: ({ appState: e, updateData: t }) =>
			(0, yy.jsx)(Te, {
				type: "button",
				icon: Fp,
				"aria-label": v("buttons.menu"),
				onClick: t,
				selected: e.openMenu === "canvas",
			}),
	}),
	xB = re({
		name: "toggleEditMenu",
		label: "buttons.edit",
		trackEvent: { category: "menu" },
		perform: (e, t) => ({
			appState: { ...t, openMenu: t.openMenu === "shape" ? null : "shape" },
			storeAction: H.NONE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r }) =>
			(0, yy.jsx)(Te, {
				visible: yc(t, Ve(e)),
				type: "button",
				icon: PC,
				"aria-label": v("buttons.edit"),
				onClick: r,
				selected: t.openMenu === "shape",
			}),
	}),
	rs = re({
		name: "toggleShortcuts",
		label: "welcomeScreen.defaults.helpHint",
		icon: IC,
		viewMode: !0,
		trackEvent: { category: "menu", action: "toggleHelpDialog" },
		perform: (e, t, r, { focusContainer: o }) => (
			t.openDialog?.name === "help" && o(),
			{
				appState: {
					...t,
					openDialog: t.openDialog?.name === "help" ? null : { name: "help" },
				},
				storeAction: H.NONE,
			}
		),
		keyTest: (e) => e.key === R.QUESTION_MARK,
	});
b();
var os = w(M(), 1),
	vB = (e) => {
		if (e.length >= 2) {
			let t = e[0].groupIds;
			for (let r of t) if (e.reduce((o, i) => o && tc(i, r), !0)) return !0;
		}
		return !1;
	},
	U5 = (e, t, r) => {
		let o = r.scene.getSelectedElements({
			selectedElementIds: t.selectedElementIds,
			includeBoundTextElement: !0,
		});
		return o.length >= 2 && !vB(o);
	},
	wy = re({
		name: "group",
		label: "labels.group",
		icon: (e) => (0, os.jsx)(Tv, { theme: e.theme }),
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => {
			let i = o.scene.getSelectedElements({
				selectedElementIds: t.selectedElementIds,
				includeBoundTextElement: !0,
			});
			if (i.length < 2)
				return { appState: t, elements: e, storeAction: H.NONE };
			let a = Fn(t);
			if (a.length === 1) {
				let T = a[0],
					I = new Set(Vt(e, T).map((k) => k.id)),
					P = new Set(i.map((k) => k.id));
				if (new Set([...Array.from(I), ...Array.from(P)]).size === I.size)
					return { appState: t, elements: e, storeAction: H.NONE };
			}
			let s = [...e];
			new Set(i.map((T) => T.frameId)).size > 1 &&
				ZI(i).forEach((I, P) => {
					Pf(I, o.scene.getNonDeletedElementsMap());
				});
			let d = Sa(),
				u = Fe(i);
			s = s.map((T) =>
				u.get(T.id)
					? Me(T, { groupIds: dC(T.groupIds, d, t.editingGroupId) })
					: T,
			);
			let f = Vt(s, d),
				m = f[f.length - 1],
				g = s.lastIndexOf(m),
				h = s.slice(g + 1),
				y = s.slice(0, g).filter((T) => !tc(T, d)),
				E = Yo([...y, ...f, ...h], Fe(f));
			return {
				appState: { ...t, ...iC(d, { ...t, selectedGroupIds: {} }, Ve(s)) },
				elements: E,
				storeAction: H.CAPTURE,
			};
		},
		predicate: (e, t, r, o) => U5(e, t, o),
		keyTest: (e) => !e.shiftKey && e[R.CTRL_OR_CMD] && e.key === R.G,
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, os.jsx)(Te, {
				hidden: !U5(e, t, o),
				type: "button",
				icon: (0, os.jsx)(Tv, { theme: t.theme }),
				onClick: () => r(null),
				title: `${v("labels.group")} \u2014 ${V("CtrlOrCmd+G")}`,
				"aria-label": v("labels.group"),
				visible: bt(Ve(e), t),
			}),
	}),
	Sy = re({
		name: "ungroup",
		label: "labels.ungroup",
		icon: (e) => (0, os.jsx)(Cv, { theme: e.theme }),
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => {
			let i = Fn(t),
				a = Fe(e);
			if (i.length === 0)
				return { appState: t, elements: e, storeAction: H.NONE };
			let s = [...e],
				c = [];
			s = s.map((g) => {
				co(g) && c.push(g.id);
				let h = mC(g.groupIds, t.selectedGroupIds);
				return h.length === g.groupIds.length ? g : Me(g, { groupIds: h });
			});
			let d = Mr(t, Ve(s), t, null),
				u = o.scene.getSelectedElements(t),
				f = new Set(u.filter((g) => g.frameId).map((g) => g.frameId));
			return (
				qI(e)
					.filter((g) => f.has(g.id))
					.forEach((g) => {
						g && (s = Rf(s, hc(s, g, t, a), g, o));
					}),
				(d.selectedElementIds = Object.entries(d.selectedElementIds).reduce(
					(g, [h, y]) => (y && !c.includes(h) && (g[h] = !0), g),
					{},
				)),
				{ appState: { ...t, ...d }, elements: s, storeAction: H.CAPTURE }
			);
		},
		keyTest: (e) =>
			e.shiftKey && e[R.CTRL_OR_CMD] && e.key === R.G.toUpperCase(),
		predicate: (e, t) => Fn(t).length > 0,
		PanelComponent: ({ elements: e, appState: t, updateData: r }) =>
			(0, os.jsx)(Te, {
				type: "button",
				hidden: Fn(t).length === 0,
				icon: (0, os.jsx)(Cv, { theme: t.theme }),
				onClick: () => r(null),
				title: `${v("labels.ungroup")} \u2014 ${V("CtrlOrCmd+Shift+G")}`,
				"aria-label": v("labels.ungroup"),
				visible: bt(Ve(e), t),
			}),
	});
b();
b();
b();
var Zg = (e, t, r, o, i, a, s) => {
	e.beginPath(),
		e.moveTo(t + a, r),
		e.lineTo(t + o - a, r),
		e.quadraticCurveTo(t + o, r, t + o, r + a),
		e.lineTo(t + o, r + i - a),
		e.quadraticCurveTo(t + o, r + i, t + o - a, r + i),
		e.lineTo(t + a, r + i),
		e.quadraticCurveTo(t, r + i, t, r + i - a),
		e.lineTo(t, r + a),
		e.quadraticCurveTo(t, r, t + a, r),
		e.closePath(),
		e.fill(),
		s && (e.strokeStyle = s),
		e.stroke();
};
b();
function EB(e) {
	let t = 0;
	if (e.length === 0) return t;
	for (let r = 0; r < e.length; r++) {
		let o = e.charCodeAt(r);
		t = (t << 5) - t + o;
	}
	return t;
}
var ns = (e, t) => `hsl(${(Math.abs(EB(t?.id || e)) % 37) * 10}, 100%, 83%)`,
	G5 = (e) => {
		let t = e?.trim()?.codePointAt(0);
		return (t ? String.fromCodePoint(t) : "?").toUpperCase();
	},
	W5 = ({
		context: e,
		renderConfig: t,
		appState: r,
		normalizedWidth: o,
		normalizedHeight: i,
	}) => {
		for (let [a, s] of t.remotePointerViewportCoords) {
			let { x: c, y: d } = s,
				u = r.collaborators.get(a);
			(c -= r.offsetLeft), (d -= r.offsetTop);
			let f = 11,
				m = 14,
				g = c < 0 || c > o - f || d < 0 || d > i - m;
			(c = Math.max(c, 0)),
				(c = Math.min(c, o - f)),
				(d = Math.max(d, 0)),
				(d = Math.min(d, i - m));
			let h = ns(a, u);
			e.save(), (e.strokeStyle = h), (e.fillStyle = h);
			let y = t.remotePointerUserStates.get(a),
				E = g || y === "idle" || y === "away";
			E && (e.globalAlpha = 0.3),
				t.remotePointerButton.get(a) === "down" &&
					(e.beginPath(),
					e.arc(c, d, 15, 0, 2 * Math.PI, !1),
					(e.lineWidth = 3),
					(e.strokeStyle = "#ffffff88"),
					e.stroke(),
					e.closePath(),
					e.beginPath(),
					e.arc(c, d, 15, 0, 2 * Math.PI, !1),
					(e.lineWidth = 1),
					(e.strokeStyle = h),
					e.stroke(),
					e.closePath());
			let T = r.theme === $e.DARK ? "#2f6330" : gT,
				I = u?.isSpeaking;
			I &&
				((e.fillStyle = T),
				(e.strokeStyle = T),
				(e.lineWidth = 10),
				(e.lineJoin = "round"),
				e.beginPath(),
				e.moveTo(c, d),
				e.lineTo(c + 0, d + 14),
				e.lineTo(c + 4, d + 9),
				e.lineTo(c + 11, d + 8),
				e.closePath(),
				e.stroke(),
				e.fill()),
				(e.fillStyle = Yd),
				(e.strokeStyle = Yd),
				(e.lineWidth = 6),
				(e.lineJoin = "round"),
				e.beginPath(),
				e.moveTo(c, d),
				e.lineTo(c + 0, d + 14),
				e.lineTo(c + 4, d + 9),
				e.lineTo(c + 11, d + 8),
				e.closePath(),
				e.stroke(),
				e.fill(),
				(e.fillStyle = h),
				(e.strokeStyle = h),
				(e.lineWidth = 2),
				(e.lineJoin = "round"),
				e.beginPath(),
				E
					? (e.moveTo(c - 1, d - 1),
						e.lineTo(c - 1, d + 15),
						e.lineTo(c + 5, d + 10),
						e.lineTo(c + 12, d + 9),
						e.closePath(),
						e.fill())
					: (e.moveTo(c, d),
						e.lineTo(c + 0, d + 14),
						e.lineTo(c + 4, d + 9),
						e.lineTo(c + 11, d + 8),
						e.closePath(),
						e.fill(),
						e.stroke());
			let P = t.remotePointerUsernames.get(a) || "";
			if (!g && P) {
				e.font = "600 12px sans-serif";
				let C = (I ? c + 0 : c) + f / 2,
					k = (I ? d + 0 : d) + m + 2,
					N = 5,
					D = 3,
					B = e.measureText(P),
					F = B.actualBoundingBoxDescent + B.actualBoundingBoxAscent,
					W = Math.max(F, 12),
					G = C - 1,
					q = k - 1,
					ie = B.width + 2 + N * 2 + 2,
					te = W + 2 + D * 2 + 2;
				if (
					(e.roundRect
						? (e.beginPath(),
							e.roundRect(G, q, ie, te, 8),
							(e.fillStyle = h),
							e.fill(),
							(e.strokeStyle = Yd),
							e.stroke(),
							I &&
								(e.beginPath(),
								e.roundRect(G - 2, q - 2, ie + 4, te + 4, 8),
								(e.strokeStyle = T),
								e.stroke()))
						: Zg(e, G, q, ie, te, 8, Yd),
					(e.fillStyle = fT),
					e.fillText(
						P,
						C + N + 1,
						k + D + B.actualBoundingBoxAscent + Math.floor((W - F) / 2) + 2,
					),
					I)
				) {
					e.fillStyle = T;
					let we = 8,
						X = 8,
						se = 5;
					e.fillRect(G + ie + X, q + (te / 2 - we / 2), 2, we),
						e.fillRect(G + ie + X + se, q + (te / 2 - (we * 2) / 2), 2, we * 2),
						e.fillRect(G + ie + X + se * 2, q + (te / 2 - we / 2), 2, we);
				}
			}
			e.restore(), e.closePath();
		}
	};
b();
var K5 = w(Q(), 1);
var Ty = w(M(), 1),
	Cy = ({ color: e, onClick: t, name: r, src: o, className: i }) => {
		let a = G5(r),
			[s, c] = (0, K5.useState)(!1),
			d = !s && o,
			u = d ? void 0 : { background: e };
		return (0, Ty.jsx)("div", {
			className: j("Avatar", i),
			style: u,
			onClick: t,
			children: d
				? (0, Ty.jsx)("img", {
						className: "Avatar-img",
						src: o,
						alt: a,
						referrerPolicy: "no-referrer",
						onError: () => c(!0),
					})
				: a,
		});
	};
var jr = w(M(), 1),
	yB = re({
		name: "goToCollaborator",
		label: "Go to a collaborator",
		viewMode: !0,
		trackEvent: { category: "collab" },
		perform: (e, t, r) =>
			!r.socketId || t.userToFollow?.socketId === r.socketId || r.isCurrentUser
				? { appState: { ...t, userToFollow: null }, storeAction: H.NONE }
				: {
						appState: {
							...t,
							userToFollow: {
								socketId: r.socketId,
								username: r.username || "",
							},
							openMenu: t.openMenu === "canvas" ? null : t.openMenu,
						},
						storeAction: H.NONE,
					},
		PanelComponent: ({ updateData: e, data: t, appState: r }) => {
			let { socketId: o, collaborator: i, withName: a, isBeingFollowed: s } = t,
				c = ns(o, i),
				d = j({
					"is-followed": s,
					"is-current-user": i.isCurrentUser === !0,
					"is-speaking": i.isSpeaking,
					"is-in-call": i.isInCall,
					"is-muted": i.isMuted,
				}),
				u = i.isInCall
					? i.isSpeaking
						? (0, jr.jsxs)("div", {
								className:
									"UserList__collaborator-status-icon-speaking-indicator",
								title: v("userList.hint.isSpeaking"),
								children: [
									(0, jr.jsx)("div", {}),
									(0, jr.jsx)("div", {}),
									(0, jr.jsx)("div", {}),
								],
							})
						: i.isMuted
							? (0, jr.jsx)("div", {
									className:
										"UserList__collaborator-status-icon-microphone-muted",
									title: v("userList.hint.micMuted"),
									children: L2,
								})
							: (0, jr.jsx)("div", {
									title: v("userList.hint.inCall"),
									children: k2,
								})
					: null;
			return a
				? (0, jr.jsxs)("div", {
						className: `dropdown-menu-item dropdown-menu-item-base UserList__collaborator ${d}`,
						style: { "--avatar-size": "1.5rem" },
						onClick: () => e(i),
						children: [
							(0, jr.jsx)(Cy, {
								color: c,
								onClick: () => {},
								name: i.username || "",
								src: i.avatarUrl,
								className: d,
							}),
							(0, jr.jsx)("div", {
								className: "UserList__collaborator-name",
								children: i.username,
							}),
							(0, jr.jsxs)("div", {
								className: "UserList__collaborator-status-icons",
								"aria-hidden": !0,
								children: [
									s &&
										(0, jr.jsx)("div", {
											className:
												"UserList__collaborator-status-icon-is-followed",
											title: v("userList.hint.followStatus"),
											children: sc,
										}),
									u,
								],
							}),
						],
					})
				: (0, jr.jsxs)("div", {
						className: `UserList__collaborator UserList__collaborator--avatar-only ${d}`,
						children: [
							(0, jr.jsx)(Cy, {
								color: c,
								onClick: () => {
									e(i);
								},
								name: i.username || "",
								src: i.avatarUrl,
								className: d,
							}),
							u &&
								(0, jr.jsx)("div", {
									className: "UserList__collaborator-status-icon",
									children: u,
								}),
						],
					});
		},
	});
b();
var Iy = re({
	name: "addToLibrary",
	trackEvent: { category: "element" },
	perform: (e, t, r, o) => {
		let i = o.scene.getSelectedElements({
			selectedElementIds: t.selectedElementIds,
			includeBoundTextElement: !0,
			includeElementsInFrames: !0,
		});
		for (let a of Cp)
			if (i.some((s) => s.type === a))
				return {
					storeAction: H.NONE,
					appState: {
						...t,
						errorMessage: v(`errors.libraryElementTypeError.${a}`),
					},
				};
		return o.library
			.getLatestLibrary()
			.then((a) =>
				o.library.setLibrary([
					{
						id: Sa(),
						status: "unpublished",
						elements: i.map(dc),
						created: Date.now(),
					},
					...a,
				]),
			)
			.then(() => ({
				storeAction: H.NONE,
				appState: { ...t, toast: { message: v("toast.addedToLibrary") } },
			}))
			.catch((a) => ({
				storeAction: H.NONE,
				appState: { ...t, errorMessage: a.message },
			}));
	},
	label: "labels.addToLibrary",
});
b();
b();
var Y5 = (e, t, r) => {
		let o = Dp(e, t),
			i = Wo(e);
		return o.flatMap((a) => {
			let s = wB(a, i, r);
			return a.map((c) => Me(c, { x: c.x + s.x, y: c.y + s.y }));
		});
	},
	wB = (e, t, { axis: r, position: o }) => {
		let i = Wo(e),
			[a, s] = r === "x" ? ["minX", "maxX"] : ["minY", "maxY"],
			c = { x: 0, y: 0 };
		return o === "start"
			? { ...c, [r]: t[a] - i[a] }
			: o === "end"
				? { ...c, [r]: t[s] - i[s] }
				: { ...c, [r]: (t[a] + t[s]) / 2 - (i[a] + i[s]) / 2 };
	};
var is = w(M(), 1),
	En = (e, t, r, o) => {
		let i = o.scene.getSelectedElements(t);
		return i.length > 1 && !i.some((a) => Ye(a));
	},
	Qc = (e, t, r, o) => {
		let i = r.scene.getSelectedElements(t),
			a = Fe(e),
			s = Y5(i, a, o),
			c = Fe(s);
		return ai(
			e.map((d) => c.get(d.id) || d),
			t,
			r,
		);
	},
	SB = re({
		name: "alignTop",
		label: "labels.alignTop",
		icon: xv,
		trackEvent: { category: "element" },
		predicate: En,
		perform: (e, t, r, o) => ({
			appState: t,
			elements: Qc(e, t, o, { position: "start", axis: "y" }),
			storeAction: H.CAPTURE,
		}),
		keyTest: (e) => e[R.CTRL_OR_CMD] && e.shiftKey && e.key === R.ARROW_UP,
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, is.jsx)(Te, {
				hidden: !En(e, t, null, o),
				type: "button",
				icon: xv,
				onClick: () => r(null),
				title: `${v("labels.alignTop")} \u2014 ${V("CtrlOrCmd+Shift+Up")}`,
				"aria-label": v("labels.alignTop"),
				visible: bt(Ve(e), t),
			}),
	}),
	TB = re({
		name: "alignBottom",
		label: "labels.alignBottom",
		icon: vv,
		trackEvent: { category: "element" },
		predicate: En,
		perform: (e, t, r, o) => ({
			appState: t,
			elements: Qc(e, t, o, { position: "end", axis: "y" }),
			storeAction: H.CAPTURE,
		}),
		keyTest: (e) => e[R.CTRL_OR_CMD] && e.shiftKey && e.key === R.ARROW_DOWN,
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, is.jsx)(Te, {
				hidden: !En(e, t, null, o),
				type: "button",
				icon: vv,
				onClick: () => r(null),
				title: `${v("labels.alignBottom")} \u2014 ${V("CtrlOrCmd+Shift+Down")}`,
				"aria-label": v("labels.alignBottom"),
				visible: bt(Ve(e), t),
			}),
	}),
	CB = re({
		name: "alignLeft",
		label: "labels.alignLeft",
		icon: Ev,
		trackEvent: { category: "element" },
		predicate: En,
		perform: (e, t, r, o) => ({
			appState: t,
			elements: Qc(e, t, o, { position: "start", axis: "x" }),
			storeAction: H.CAPTURE,
		}),
		keyTest: (e) => e[R.CTRL_OR_CMD] && e.shiftKey && e.key === R.ARROW_LEFT,
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, is.jsx)(Te, {
				hidden: !En(e, t, null, o),
				type: "button",
				icon: Ev,
				onClick: () => r(null),
				title: `${v("labels.alignLeft")} \u2014 ${V("CtrlOrCmd+Shift+Left")}`,
				"aria-label": v("labels.alignLeft"),
				visible: bt(Ve(e), t),
			}),
	}),
	IB = re({
		name: "alignRight",
		label: "labels.alignRight",
		icon: yv,
		trackEvent: { category: "element" },
		predicate: En,
		perform: (e, t, r, o) => ({
			appState: t,
			elements: Qc(e, t, o, { position: "end", axis: "x" }),
			storeAction: H.CAPTURE,
		}),
		keyTest: (e) => e[R.CTRL_OR_CMD] && e.shiftKey && e.key === R.ARROW_RIGHT,
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, is.jsx)(Te, {
				hidden: !En(e, t, null, o),
				type: "button",
				icon: yv,
				onClick: () => r(null),
				title: `${v("labels.alignRight")} \u2014 ${V("CtrlOrCmd+Shift+Right")}`,
				"aria-label": v("labels.alignRight"),
				visible: bt(Ve(e), t),
			}),
	}),
	_B = re({
		name: "alignVerticallyCentered",
		label: "labels.centerVertically",
		icon: wv,
		trackEvent: { category: "element" },
		predicate: En,
		perform: (e, t, r, o) => ({
			appState: t,
			elements: Qc(e, t, o, { position: "center", axis: "y" }),
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, is.jsx)(Te, {
				hidden: !En(e, t, null, o),
				type: "button",
				icon: wv,
				onClick: () => r(null),
				title: v("labels.centerVertically"),
				"aria-label": v("labels.centerVertically"),
				visible: bt(Ve(e), t),
			}),
	}),
	AB = re({
		name: "alignHorizontallyCentered",
		label: "labels.centerHorizontally",
		icon: Sv,
		trackEvent: { category: "element" },
		predicate: En,
		perform: (e, t, r, o) => ({
			appState: t,
			elements: Qc(e, t, o, { position: "center", axis: "x" }),
			storeAction: H.CAPTURE,
		}),
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, is.jsx)(Te, {
				hidden: !En(e, t, null, o),
				type: "button",
				icon: Sv,
				onClick: () => r(null),
				title: v("labels.centerHorizontally"),
				"aria-label": v("labels.centerHorizontally"),
				visible: bt(Ve(e), t),
			}),
	});
b();
b();
var V5 = (e, t, r) => {
	let [o, i, a, s] =
			r.axis === "x"
				? ["minX", "midX", "maxX", "width"]
				: ["minY", "midY", "maxY", "height"],
		c = Wo(e),
		d = Dp(e, t)
			.map((g) => [g, Wo(g)])
			.sort((g, h) => g[1][i] - h[1][i]),
		u = 0;
	for (let g of d) u += g[1][s];
	let f = (c[s] - u) / (d.length - 1);
	if (f < 0) {
		let g = d.findIndex((T) => T[1][o] === c[o]),
			h = d.findIndex((T) => T[1][a] === c[a]),
			y = (d[h][1][i] - d[g][1][i]) / (d.length - 1),
			E = d[g][1][i];
		return d.flatMap(([T, I], P) => {
			let C = { x: 0, y: 0 };
			return (
				P !== g && P !== h && ((E += y), (C[r.axis] = E - I[i])),
				T.map((k) => Me(k, { x: k.x + C.x, y: k.y + C.y }))
			);
		});
	}
	let m = c[o];
	return d.flatMap(([g, h]) => {
		let y = { x: 0, y: 0 };
		return (
			(y[r.axis] = m - h[o]),
			(m += f),
			(m += h[s]),
			g.map((E) => Me(E, { x: E.x + y.x, y: E.y + y.y }))
		);
	});
};
var _y = w(M(), 1),
	X5 = (e, t) => {
		let r = t.scene.getSelectedElements(e);
		return r.length > 1 && !r.some((o) => Ye(o));
	},
	Z5 = (e, t, r, o) => {
		let i = r.scene.getSelectedElements(t),
			a = V5(i, r.scene.getNonDeletedElementsMap(), o),
			s = Fe(a);
		return ai(
			e.map((c) => s.get(c.id) || c),
			t,
			r,
		);
	},
	kB = re({
		name: "distributeHorizontally",
		label: "labels.distributeHorizontally",
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => ({
			appState: t,
			elements: Z5(e, t, o, { space: "between", axis: "x" }),
			storeAction: H.CAPTURE,
		}),
		keyTest: (e) => !e[R.CTRL_OR_CMD] && e.altKey && e.code === Be.H,
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, _y.jsx)(Te, {
				hidden: !X5(t, o),
				type: "button",
				icon: FC,
				onClick: () => r(null),
				title: `${v("labels.distributeHorizontally")} \u2014 ${V("Alt+H")}`,
				"aria-label": v("labels.distributeHorizontally"),
				visible: bt(Ve(e), t),
			}),
	}),
	LB = re({
		name: "distributeVertically",
		label: "labels.distributeVertically",
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => ({
			appState: t,
			elements: Z5(e, t, o, { space: "between", axis: "y" }),
			storeAction: H.CAPTURE,
		}),
		keyTest: (e) => !e[R.CTRL_OR_CMD] && e.altKey && e.code === Be.V,
		PanelComponent: ({ elements: e, appState: t, updateData: r, app: o }) =>
			(0, _y.jsx)(Te, {
				hidden: !X5(t, o),
				type: "button",
				icon: BC,
				onClick: () => r(null),
				title: `${v("labels.distributeVertically")} \u2014 ${V("Alt+V")}`,
				"aria-label": v("labels.distributeVertically"),
				visible: bt(Ve(e), t),
			}),
	});
b();
var Ay = re({
		name: "flipHorizontal",
		label: "labels.flipHorizontal",
		icon: D2,
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => ({
			elements: ai(
				q5(e, o.scene.getNonDeletedElementsMap(), t, "horizontal", o),
				t,
				o,
			),
			appState: t,
			storeAction: H.CAPTURE,
		}),
		keyTest: (e) => e.shiftKey && e.code === Be.H,
	}),
	ky = re({
		name: "flipVertical",
		label: "labels.flipVertical",
		icon: R2,
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => ({
			elements: ai(
				q5(e, o.scene.getNonDeletedElementsMap(), t, "vertical", o),
				t,
				o,
			),
			appState: t,
			storeAction: H.CAPTURE,
		}),
		keyTest: (e) => e.shiftKey && e.code === Be.V && !e[R.CTRL_OR_CMD],
	}),
	q5 = (e, t, r, o, i) => {
		let a = Le(Ve(e), r, {
				includeBoundTextElement: !0,
				includeElementsInFrames: !0,
			}),
			s = MB(a, t, r, o, i),
			c = Fe(s);
		return e.map((d) => c.get(d.id) || d);
	},
	MB = (e, t, r, o, i) => {
		if (e.every((h) => Lt(h) && (h.startBinding || h.endBinding)))
			return e.map((h) => {
				let y = h;
				return Me(y, {
					startArrowhead: y.endArrowhead,
					endArrowhead: y.startArrowhead,
				});
			});
		let { midX: a, midY: s } = Wo(e);
		O_(e, t, "nw", i.scene, {
			flipByX: o === "horizontal",
			flipByY: o === "vertical",
			shouldResizeFromCenter: !0,
			shouldMaintainAspectRatio: !0,
		}),
			Ol(
				e.filter(at),
				t,
				i.scene.getNonDeletedElements(),
				i.scene,
				Nl(r),
				[],
				r.zoom,
			);
		let { elbowArrows: c, otherElements: d } = e.reduce(
				(h, y) =>
					qe(y)
						? { ...h, elbowArrows: h.elbowArrows.concat(y) }
						: { ...h, otherElements: h.otherElements.concat(y) },
				{ elbowArrows: [], otherElements: [] },
			),
			{ midX: u, midY: f } = Wo(e),
			[m, g] = [a - u, s - f];
		return (
			d.forEach((h) => me(h, { x: h.x + m, y: h.y + g })),
			c.forEach((h) =>
				Ui(h, t, h.points, void 0, void 0, { informMutation: !1 }),
			),
			e
		);
	};
b();
var Jc = re({
		name: "copy",
		label: "labels.copy",
		icon: rm,
		trackEvent: { category: "element" },
		perform: async (e, t, r, o) => {
			let i = o.scene.getSelectedElements({
				selectedElementIds: t.selectedElementIds,
				includeBoundTextElement: !0,
				includeElementsInFrames: !0,
			});
			try {
				await KI(i, o.files, r);
			} catch (a) {
				return {
					storeAction: H.NONE,
					appState: { ...t, errorMessage: a.message },
				};
			}
			return { storeAction: H.NONE };
		},
		keyTest: void 0,
	}),
	Ly = re({
		name: "paste",
		label: "labels.paste",
		trackEvent: { category: "element" },
		perform: async (e, t, r, o) => {
			let i;
			try {
				i = await YI();
			} catch (a) {
				return a.name === "AbortError" || a.name === "NotAllowedError"
					? !1
					: (console.error(`actionPaste ${a.name}: ${a.message}`),
						Pi
							? {
									storeAction: H.NONE,
									appState: {
										...t,
										errorMessage: v("hints.firefox_clipboard_write"),
									},
								}
							: {
									storeAction: H.NONE,
									appState: {
										...t,
										errorMessage: v("errors.asyncPasteFailedOnRead"),
									},
								});
			}
			try {
				o.pasteFromClipboard(WI({ types: i }));
			} catch (a) {
				return (
					console.error(a),
					{
						storeAction: H.NONE,
						appState: {
							...t,
							errorMessage: v("errors.asyncPasteFailedOnParse"),
						},
					}
				);
			}
			return { storeAction: H.NONE };
		},
		keyTest: void 0,
	}),
	qg = re({
		name: "cut",
		label: "labels.cut",
		icon: x2,
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => (
			Jc.perform(e, t, r, o), ym.perform(e, t, null, o)
		),
		keyTest: (e) => e[R.CTRL_OR_CMD] && e.key === R.X,
	}),
	jg = re({
		name: "copyAsSvg",
		label: "labels.copyAsSvg",
		icon: N2,
		trackEvent: { category: "element" },
		perform: async (e, t, r, o) => {
			if (!o.canvas) return { storeAction: H.NONE };
			let { exportedElements: i, exportingFrame: a } = es(e, t, !0);
			try {
				await ts("clipboard-svg", i, t, o.files, {
					...t,
					exportingFrame: a,
					name: o.getName(),
				});
				let s = o.scene.getSelectedElements({
					selectedElementIds: t.selectedElementIds,
					includeBoundTextElement: !0,
					includeElementsInFrames: !0,
				});
				return {
					appState: {
						toast: {
							message: v("toast.copyToClipboardAsSvg", {
								exportSelection: s.length
									? v("toast.selection")
									: v("toast.canvas"),
								exportColorScheme: t.exportWithDarkMode
									? v("buttons.darkMode")
									: v("buttons.lightMode"),
							}),
						},
					},
					storeAction: H.NONE,
				};
			} catch (s) {
				return (
					console.error(s),
					{ appState: { errorMessage: s.message }, storeAction: H.NONE }
				);
			}
		},
		predicate: (e) => Yv && e.length > 0,
		keywords: ["svg", "clipboard", "copy"],
	}),
	Qg = re({
		name: "copyAsPng",
		label: "labels.copyAsPng",
		icon: O2,
		trackEvent: { category: "element" },
		perform: async (e, t, r, o) => {
			if (!o.canvas) return { storeAction: H.NONE };
			let i = o.scene.getSelectedElements({
					selectedElementIds: t.selectedElementIds,
					includeBoundTextElement: !0,
					includeElementsInFrames: !0,
				}),
				{ exportedElements: a, exportingFrame: s } = es(e, t, !0);
			try {
				return (
					await ts("clipboard", a, t, o.files, {
						...t,
						exportingFrame: s,
						name: o.getName(),
					}),
					{
						appState: {
							...t,
							toast: {
								message: v("toast.copyToClipboardAsPng", {
									exportSelection: i.length
										? v("toast.selection")
										: v("toast.canvas"),
									exportColorScheme: t.exportWithDarkMode
										? v("buttons.darkMode")
										: v("buttons.lightMode"),
								}),
							},
						},
						storeAction: H.NONE,
					}
				);
			} catch (c) {
				return (
					console.error(c),
					{ appState: { ...t, errorMessage: c.message }, storeAction: H.NONE }
				);
			}
		},
		predicate: (e) => gc && e.length > 0,
		keyTest: (e) => e.code === Be.C && e.altKey && e.shiftKey,
		keywords: ["png", "clipboard", "copy"],
	}),
	Jg = re({
		name: "copyText",
		label: "labels.copyText",
		trackEvent: { category: "element" },
		perform: (e, t, r, o) => {
			let i = o.scene.getSelectedElements({
				selectedElementIds: t.selectedElementIds,
				includeBoundTextElement: !0,
			});
			try {
				Aa(oE(i));
			} catch {
				throw new Error(v("errors.copyToSystemClipboardFailed"));
			}
			return { storeAction: H.NONE };
		},
		predicate: (e, t, r, o) =>
			Yv &&
			o.scene
				.getSelectedElements({
					selectedElementIds: t.selectedElementIds,
					includeBoundTextElement: !0,
				})
				.some(Ee),
		keywords: ["text", "clipboard", "copy"],
	});
b();
var eh = re({
	name: "gridMode",
	icon: H2,
	keywords: ["snap"],
	label: "labels.toggleGrid",
	viewMode: !0,
	trackEvent: { category: "canvas", predicate: (e) => e.gridModeEnabled },
	perform(e, t) {
		return {
			appState: {
				...t,
				gridModeEnabled: !this.checked(t),
				objectsSnapModeEnabled: !1,
			},
			storeAction: H.NONE,
		};
	},
	checked: (e) => e.gridModeEnabled,
	predicate: (e, t, r) => r.gridModeEnabled === void 0,
	keyTest: (e) => e[R.CTRL_OR_CMD] && e.code === Be.QUOTE,
});
b();
var ed = re({
	name: "zenMode",
	label: "buttons.zenMode",
	icon: B2,
	paletteName: "Toggle zen mode",
	viewMode: !0,
	trackEvent: { category: "canvas", predicate: (e) => !e.zenModeEnabled },
	perform(e, t) {
		return {
			appState: { ...t, zenModeEnabled: !this.checked(t) },
			storeAction: H.NONE,
		};
	},
	checked: (e) => e.zenModeEnabled,
	predicate: (e, t, r) => typeof r.zenModeEnabled > "u",
	keyTest: (e) => !e[R.CTRL_OR_CMD] && e.altKey && e.code === Be.Z,
});
b();
var My = re({
	name: "objectsSnapMode",
	label: "buttons.objectsSnapMode",
	icon: F2,
	viewMode: !1,
	trackEvent: {
		category: "canvas",
		predicate: (e) => !e.objectsSnapModeEnabled,
	},
	perform(e, t) {
		return {
			appState: {
				...t,
				objectsSnapModeEnabled: !this.checked(t),
				gridModeEnabled: !1,
			},
			storeAction: H.NONE,
		};
	},
	checked: (e) => e.objectsSnapModeEnabled,
	predicate: (e, t, r) => typeof r.objectsSnapModeEnabled > "u",
	keyTest: (e) => !e[R.CTRL_OR_CMD] && e.altKey && e.code === Be.S,
});
b();
var td = re({
	name: "stats",
	label: "stats.fullTitle",
	icon: P2,
	paletteName: "Toggle stats",
	viewMode: !0,
	trackEvent: { category: "menu" },
	keywords: ["edit", "attributes", "customize"],
	perform(e, t) {
		return {
			appState: { ...t, stats: { ...t.stats, open: !this.checked(t) } },
			storeAction: H.NONE,
		};
	},
	checked: (e) => e.stats.open,
	keyTest: (e) => !e[R.CTRL_OR_CMD] && e.altKey && e.code === Be.SLASH,
});
b();
var Py = re({
		name: "unbindText",
		label: "labels.unbindText",
		trackEvent: { category: "element" },
		predicate: (e, t, r, o) =>
			o.scene.getSelectedElements(t).some((a) => Ao(a)),
		perform: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t),
				a = o.scene.getNonDeletedElementsMap();
			return (
				i.forEach((s) => {
					let c = ot(s, a);
					if (c) {
						let { width: d, height: u } = Ko(
								c.originalText,
								Lr(c),
								c.lineHeight,
							),
							f = p_(s.id);
						u_(s.id);
						let { x: m, y: g } = Of(s, c, a);
						me(c, {
							containerId: null,
							width: d,
							height: u,
							text: c.originalText,
							x: m,
							y: g,
						}),
							me(s, {
								boundElements: s.boundElements?.filter((h) => h.id !== c.id),
								height: f || s.height,
							});
					}
				}),
				{ elements: e, appState: t, storeAction: H.CAPTURE }
			);
		},
	}),
	Ry = re({
		name: "bindText",
		label: "labels.bindText",
		trackEvent: { category: "element" },
		predicate: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t);
			if (i.length === 2) {
				let a = Ee(i[0]) || Ee(i[1]),
					s;
				if (
					(Oi(i[0]) ? (s = i[0]) : Oi(i[1]) && (s = i[1]),
					a && s && ot(s, o.scene.getNonDeletedElementsMap()) === null)
				)
					return !0;
			}
			return !1;
		},
		perform: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t),
				a,
				s;
			Ee(i[0]) && Oi(i[1])
				? ((a = i[0]), (s = i[1]))
				: ((a = i[1]), (s = i[0])),
				me(a, {
					containerId: s.id,
					verticalAlign: sn.MIDDLE,
					textAlign: Vd.CENTER,
					autoResize: !0,
				}),
				me(s, {
					boundElements: (s.boundElements || []).concat({
						type: "text",
						id: a.id,
					}),
				});
			let c = s.height;
			return (
				jt(a, s, o.scene.getNonDeletedElementsMap()),
				gm(s.id, c),
				{
					elements: PB(e, s, a),
					appState: { ...t, selectedElementIds: { [s.id]: !0 } },
					storeAction: H.CAPTURE,
				}
			);
		},
	}),
	PB = (e, t, r) => {
		let o = e.slice(),
			i = o.findIndex((s) => s.id === r.id);
		o.splice(i, 1);
		let a = o.findIndex((s) => s.id === t.id);
		return o.splice(a + 1, 0, r), Yo(o, Fe([t, r])), o;
	},
	RB = (e, t, r) => {
		let o = e.slice(),
			i = o.findIndex((s) => s.id === t.id);
		o.splice(i, 1);
		let a = o.findIndex((s) => s.id === r.id);
		return o.splice(a, 0, t), Yo(o, Fe([t, r])), o;
	},
	j5 = re({
		name: "wrapTextInContainer",
		label: "labels.createContainerFromText",
		trackEvent: { category: "element" },
		predicate: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t),
				a = i.every((s) => Ee(s));
			return i.length > 0 && a;
		},
		perform: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t),
				a = e.slice(),
				s = {};
			for (let c of i)
				if (Ee(c)) {
					let d = $n({
						type: "rectangle",
						backgroundColor: t.currentItemBackgroundColor,
						boundElements: [
							...(c.boundElements || []),
							{ id: c.id, type: "text" },
						],
						angle: c.angle,
						fillStyle: t.currentItemFillStyle,
						strokeColor: t.currentItemStrokeColor,
						roughness: t.currentItemRoughness,
						strokeWidth: t.currentItemStrokeWidth,
						strokeStyle: t.currentItemStrokeStyle,
						roundness:
							t.currentItemRoundness === "round"
								? {
										type: js("rectangle")
											? To.ADAPTIVE_RADIUS
											: To.PROPORTIONAL_RADIUS,
									}
								: null,
						opacity: 100,
						locked: !1,
						x: c.x - Qx,
						y: c.y - Qx,
						width: xc(c.width, "rectangle"),
						height: xc(c.height, "rectangle"),
						groupIds: c.groupIds,
						frameId: c.frameId,
					});
					if (c.boundElements?.length) {
						let u = c.boundElements
							.filter((m) => m.type === "arrow")
							.map((m) => m.id);
						a.filter((m) => u.includes(m.id)).forEach((m) => {
							let g = m.startBinding,
								h = m.endBinding;
							g?.elementId === c.id && (g = { ...g, elementId: d.id }),
								h?.elementId === c.id && (h = { ...h, elementId: d.id }),
								(g || h) && me(m, { startBinding: g, endBinding: h }, !1);
						});
					}
					me(
						c,
						{
							containerId: d.id,
							verticalAlign: sn.MIDDLE,
							boundElements: null,
							textAlign: Vd.CENTER,
							autoResize: !0,
						},
						!1,
					),
						jt(c, d, o.scene.getNonDeletedElementsMap()),
						(a = RB([...a, d], d, c)),
						(s[d.id] = !0);
				}
			return {
				elements: a,
				appState: { ...t, selectedElementIds: s },
				storeAction: H.CAPTURE,
			};
		},
	});
b();
b();
var Vn = w(Q(), 1);
var gi = w(M(), 1),
	Oy = 380,
	DB = 42,
	Dy = 5,
	Q5 = 85,
	NB = 500,
	Ny = !1,
	th = new Map(),
	J5 = ({
		element: e,
		elementsMap: t,
		setAppState: r,
		onLinkOpen: o,
		setToast: i,
		updateEmbedValidationStatus: a,
	}) => {
		let s = pi(),
			c = fi(),
			d = et(),
			u = e.link || "",
			[f, m] = (0, Vn.useState)(u),
			g = (0, Vn.useRef)(null),
			h = s.showHyperlinkPopup === "editor",
			y = (0, Vn.useCallback)(() => {
				if (!g.current) return;
				let C = Bn(g.current.value) || null;
				if ((!e.link && C && We("hyperlink", "create"), so(e))) {
					if (
						(s.activeEmbeddable?.element === e && r({ activeEmbeddable: null }),
						!C)
					) {
						me(e, { link: null }), a(e, !1);
						return;
					}
					if (!pc(C, c.validateEmbeddable))
						C && i({ message: v("toast.unableToEmbed"), closable: !0 }),
							e.link && th.set(e.id, e.link),
							me(e, { link: C }),
							a(e, !1);
					else {
						let { width: k, height: N } = e,
							D = Fl(C);
						D?.error instanceof URIError &&
							i({ message: v("toast.unrecognizedLinkFormat"), closable: !0 });
						let B = D ? D.intrinsicSize.w / D.intrinsicSize.h : 1,
							F = th.get(e.id) !== e.link;
						me(e, {
							...(F
								? {
										width: D?.type === "video" ? (k > N ? k : N * B) : k,
										height: D?.type === "video" && k > N ? k / B : N,
									}
								: {}),
							link: C,
						}),
							a(e, !0),
							th.has(e.id) && th.delete(e.id);
					}
				} else me(e, { link: C });
			}, [e, i, c.validateEmbeddable, s.activeEmbeddable, r, a]);
		(0, Vn.useLayoutEffect)(
			() => () => {
				y();
			},
			[y],
		),
			(0, Vn.useEffect)(() => {
				let C = null;
				g &&
					g.current &&
					!(d.viewport.isMobile || d.isTouchScreen) &&
					g.current.select();
				let k = (N) => {
					if (h) return;
					C && clearTimeout(C),
						FB(e, t, s, pe(N.clientX, N.clientY)) &&
							(C = window.setTimeout(() => {
								r({ showHyperlinkPopup: !1 });
							}, NB));
				};
				return (
					window.addEventListener("pointermove", k, !1),
					() => {
						window.removeEventListener("pointermove", k, !1),
							C && clearTimeout(C);
					}
				);
			}, [s, e, h, r, t, d.viewport.isMobile, d.isTouchScreen]);
		let E = (0, Vn.useCallback)(() => {
				We("hyperlink", "delete"),
					me(e, { link: null }),
					r({ showHyperlinkPopup: !1 });
			}, [r, e]),
			T = () => {
				We("hyperlink", "edit", "popup-ui"),
					r({ showHyperlinkPopup: "editor" });
			},
			{ x: I, y: P } = e3(e, s, t);
		return s.contextMenu ||
			s.selectedElementsAreBeingDragged ||
			s.resizingElement ||
			s.isRotating ||
			s.openMenu ||
			s.viewModeEnabled
			? null
			: (0, gi.jsxs)("div", {
					className: "excalidraw-hyperlinkContainer",
					style: { top: `${P}px`, left: `${I}px`, width: Oy, padding: Dy },
					children: [
						h
							? (0, gi.jsx)("input", {
									className: j("excalidraw-hyperlinkContainer-input"),
									placeholder: v("labels.link.hint"),
									ref: g,
									value: f,
									onChange: (C) => m(C.target.value),
									autoFocus: !0,
									onKeyDown: (C) => {
										C.stopPropagation(),
											C[R.CTRL_OR_CMD] && C.key === R.K && C.preventDefault(),
											(C.key === R.ENTER || C.key === R.ESCAPE) &&
												(y(), r({ showHyperlinkPopup: "info" }));
									},
								})
							: e.link
								? (0, gi.jsx)("a", {
										href: Bn(e.link || ""),
										className: "excalidraw-hyperlinkContainer-link",
										target: Np(e.link) ? "_self" : "_blank",
										onClick: (C) => {
											if (e.link && o) {
												let k = Lp("excalidraw-link", C.nativeEvent);
												o({ ...e, link: Bn(e.link) }, k),
													k.defaultPrevented && C.preventDefault();
											}
										},
										rel: "noopener noreferrer",
										children: e.link,
									})
								: (0, gi.jsx)("div", {
										className: "excalidraw-hyperlinkContainer-link",
										children: v("labels.link.empty"),
									}),
						(0, gi.jsxs)("div", {
							className: "excalidraw-hyperlinkContainer__buttons",
							children: [
								!h &&
									(0, gi.jsx)(Te, {
										type: "button",
										title: v("buttons.edit"),
										"aria-label": v("buttons.edit"),
										label: v("buttons.edit"),
										onClick: T,
										className: "excalidraw-hyperlinkContainer--edit",
										icon: Op,
									}),
								(0, gi.jsx)(Te, {
									type: "button",
									title: v("labels.linkToElement"),
									"aria-label": v("labels.linkToElement"),
									label: v("labels.linkToElement"),
									onClick: () => {
										r({
											openDialog: {
												name: "elementLinkSelector",
												sourceElementId: e.id,
											},
										});
									},
									icon: Qp,
								}),
								u &&
									!so(e) &&
									(0, gi.jsx)(Te, {
										type: "button",
										title: v("buttons.remove"),
										"aria-label": v("buttons.remove"),
										label: v("buttons.remove"),
										onClick: E,
										className: "excalidraw-hyperlinkContainer--remove",
										icon: Uo,
									}),
							],
						}),
					],
				});
	},
	e3 = (e, t, r) => {
		let [o, i] = mo(e, r),
			{ x: a, y: s } = lo({ sceneX: o + e.width / 2, sceneY: i }, t),
			c = a - t.offsetLeft - Oy / 2,
			d = s - t.offsetTop - Q5;
		return { x: c, y: d };
	},
	Fy = (e, t) => {
		let r = Le(e, t);
		return so(r[0])
			? "labels.link.editEmbed"
			: r[0]?.link
				? "labels.link.edit"
				: "labels.link.create";
	},
	Um = null,
	t3 = (e, t, r) => {
		Um && clearTimeout(Um), (Um = window.setTimeout(() => OB(e, t, r), ST));
	},
	OB = (e, t, r) => {
		if (!e.link) return;
		let o = Zc();
		o.classList.add("excalidraw-tooltip--visible"),
			(o.style.maxWidth = "20rem"),
			(o.textContent = zl(e.link) ? v("labels.link.goToElement") : e.link);
		let [i, a, s, c] = mo(e, r),
			[d, u, f, m] = OI([i, a, s, c], e.angle, t),
			g = lo({ sceneX: d, sceneY: u }, t);
		hy(o, { left: g.x, top: g.y, width: f, height: m }, "top"),
			We("hyperlink", "tooltip", "link-icon"),
			(Ny = !0);
	},
	By = () => {
		Um && clearTimeout(Um),
			Ny && ((Ny = !1), Zc().classList.remove("excalidraw-tooltip--visible"));
	},
	FB = (e, t, r, [o, i]) => {
		let { x: a, y: s } = Ot({ clientX: o, clientY: i }, r),
			c = 15 / r.zoom.value;
		if (tI(a, s, e, t)) return !1;
		let [d, u, f] = mo(e, t);
		if (a >= d && a <= f && s >= u - Q5 && s <= u) return !1;
		let { x: m, y: g } = e3(e, r, t);
		return !(
			o >= m - c &&
			o <= m + Oy + Dy * 2 + c &&
			i >= g - c &&
			i <= g + c + Dy * 2 + DB
		);
	};
var r3 = w(M(), 1),
	Gm = re({
		name: "hyperlink",
		label: (e, t) => Fy(e, t),
		icon: im,
		perform: (e, t) =>
			t.showHyperlinkPopup === "editor"
				? !1
				: {
						elements: e,
						appState: { ...t, showHyperlinkPopup: "editor", openMenu: null },
						storeAction: H.CAPTURE,
					},
		trackEvent: { category: "hyperlink", action: "click" },
		keyTest: (e) => e[R.CTRL_OR_CMD] && e.key === R.K,
		predicate: (e, t) => Le(e, t).length === 1,
		PanelComponent: ({ elements: e, appState: t, updateData: r }) => {
			let o = Le(e, t);
			return (0, r3.jsx)(Te, {
				type: "button",
				icon: im,
				"aria-label": v(Fy(e, t)),
				title: `${so(e[0]) ? v("labels.link.labelEmbed") : v("labels.link.label")} - ${V("CtrlOrCmd+K")}`,
				onClick: () => r(null),
				selected: o.length === 1 && !!o[0].link,
			});
		},
	});
b();
var zy = (e) => e.every((t) => !t.locked),
	$y = re({
		name: "toggleElementLock",
		label: (e, t, r) => {
			let o = r.scene.getSelectedElements({
				selectedElementIds: t.selectedElementIds,
				includeBoundTextElement: !1,
			});
			return o.length === 1 && !Ye(o[0])
				? o[0].locked
					? "labels.elementLock.unlock"
					: "labels.elementLock.lock"
				: zy(o)
					? "labels.elementLock.lockAll"
					: "labels.elementLock.unlockAll";
		},
		icon: (e, t) => {
			let r = Le(t, e);
			return zy(r) ? oc : Ll;
		},
		trackEvent: { category: "element" },
		predicate: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t);
			return i.length > 0 && !i.some((a) => a.locked && a.frameId);
		},
		perform: (e, t, r, o) => {
			let i = o.scene.getSelectedElements({
				selectedElementIds: t.selectedElementIds,
				includeBoundTextElement: !0,
				includeElementsInFrames: !0,
			});
			if (!i.length) return !1;
			let a = zy(i),
				s = Fe(i);
			return {
				elements: e.map((c) => (s.has(c.id) ? Me(c, { locked: a }) : c)),
				appState: {
					...t,
					selectedLinearElement: a ? null : t.selectedLinearElement,
				},
				storeAction: H.CAPTURE,
			};
		},
		keyTest: (e, t, r, o) =>
			e.key.toLocaleLowerCase() === R.L &&
			e[R.CTRL_OR_CMD] &&
			e.shiftKey &&
			o.scene.getSelectedElements({
				selectedElementIds: t.selectedElementIds,
				includeBoundTextElement: !1,
			}).length > 0,
	}),
	o3 = re({
		name: "unlockAllElements",
		paletteName: "Unlock all elements",
		trackEvent: { category: "canvas" },
		viewMode: !1,
		icon: Ll,
		predicate: (e, t) => Le(e, t).length === 0 && e.some((o) => o.locked),
		perform: (e, t) => {
			let r = e.filter((o) => o.locked);
			return {
				elements: e.map((o) => (o.locked ? Me(o, { locked: !1 }) : o)),
				appState: {
					...t,
					selectedElementIds: Object.fromEntries(r.map((o) => [o.id, !0])),
				},
				storeAction: H.CAPTURE,
			};
		},
		label: "labels.elementLock.unlockAll",
	});
b();
b();
var wn = w(Q(), 1);
b();
var hh = w(Q(), 1);
b();
var rh = w(Q(), 1),
	n3 = () => {
		let [e, t] = (0, rh.useState)(null),
			r = (0, rh.useCallback)((o) => t(o), []);
		return [e, r];
	};
b();
var i3 = w(Gn(), 1);
var a3 = w(Q(), 1),
	Wm = w(M(), 1),
	l3 = (e) => {
		let { closeOnClickOutside: t = !0 } = e,
			r = Ag({ className: "excalidraw-modal-container" }),
			o = (0, a3.useRef)(
				document.body.classList.contains("excalidraw-animations-disabled"),
			);
		if (!r) return null;
		let i = (a) => {
			a.key === R.ESCAPE &&
				(a.nativeEvent.stopImmediatePropagation(),
				a.stopPropagation(),
				e.onCloseRequest());
		};
		return (0, i3.createPortal)(
			(0, Wm.jsxs)("div", {
				className: j("Modal", e.className, {
					"animations-disabled": o.current,
				}),
				role: "dialog",
				"aria-modal": "true",
				onKeyDown: i,
				"aria-labelledby": e.labelledBy,
				"data-prevent-outside-click": !0,
				children: [
					(0, Wm.jsx)("div", {
						className: "Modal__background",
						onClick: t ? e.onCloseRequest : void 0,
					}),
					(0, Wm.jsx)("div", {
						className: "Modal__content",
						style: { "--max-width": `${e.maxWidth}px` },
						tabIndex: 0,
						children: e.children,
					}),
				],
			}),
			r,
		);
	};
b();
var jo = w(Q(), 1);
b();
var od = w(Q(), 1);
b();
var oh = w(Q(), 1);
var Hy = xt(new Map()),
	s3 = async (e) =>
		await pm({
			elements: e,
			appState: { exportBackground: !1, viewBackgroundColor: Mi.white },
			files: null,
			renderEmbeddables: !1,
			skipInliningFonts: !0,
		}),
	c3 = (e, t, r) => {
		let [o, i] = (0, oh.useState)();
		return (
			(0, oh.useEffect)(() => {
				if (t)
					if (e) {
						let a = r.get(e);
						a
							? i(a)
							: (async () => {
									let s = await s3(t);
									s.querySelector(".style-fonts")?.remove(),
										s && (r.set(e, s), i(s));
								})();
					} else
						(async () => {
							let a = await s3(t);
							i(a);
						})();
			}, [e, t, r, i]),
			o
		);
	},
	nh = () => {
		let [e] = Ge(Hy, lt);
		return {
			clearLibraryCache: () => e.clear(),
			deleteItemsFromLibraryCache: (o) => {
				o.forEach((i) => e.delete(i));
			},
			svgCache: e,
		};
	};
b();
var ih = class {
	jobs = [];
	running = !1;
	tick() {
		if (this.running) return;
		let t = this.jobs.shift();
		t
			? ((this.running = !0),
				t.promise.resolve(
					em(t.jobFactory, ...t.args).finally(() => {
						(this.running = !1), this.tick();
					}),
				))
			: (this.running = !1);
	}
	push(t, ...r) {
		let o = Ap();
		return (
			this.jobs.push({ jobFactory: t, promise: o, args: r }), this.tick(), o
		);
	}
};
var m3 = new pn(),
	as = xt({ status: "loaded", isInitialized: !1, libraryItems: [] }),
	Km = (e) => _o(e),
	BB = (e, t) =>
		!e.find((r) =>
			r.elements.length !== t.elements.length
				? !1
				: r.elements.every(
						(o, i) =>
							o.id === t.elements[i].id &&
							o.versionNonce === t.elements[i].versionNonce,
					),
		),
	u3 = (e, t) => {
		let r = [];
		for (let o of t) BB(e, o) && r.push(o);
		return [...r, ...e];
	},
	p3 = (e, t) => {
		let r = Fe(t),
			o = { deletedItems: new Map(), addedItems: new Map() };
		for (let a of e) r.has(a.id) || o.deletedItems.set(a.id, a);
		let i = Fe(e);
		for (let a of t) i.has(a.id) || o.addedItems.set(a.id, a);
		return o;
	},
	Uy = class {
		currLibraryItems = [];
		prevLibraryItems = Km(this.currLibraryItems);
		app;
		constructor(t) {
			this.app = t;
		}
		updateQueue = [];
		getLastUpdateTask = () => this.updateQueue[this.updateQueue.length - 1];
		notifyListeners = () => {
			if (this.updateQueue.length > 0)
				zr.set(as, (t) => ({
					status: "loading",
					libraryItems: this.currLibraryItems,
					isInitialized: t.isInitialized,
				}));
			else {
				zr.set(as, {
					status: "loaded",
					libraryItems: this.currLibraryItems,
					isInitialized: !0,
				});
				try {
					let t = this.prevLibraryItems;
					this.prevLibraryItems = Km(this.currLibraryItems);
					let r = Km(this.currLibraryItems);
					this.app.props.onLibraryChange?.(r), m3.trigger(p3(t, r), r);
				} catch (t) {
					console.error(t);
				}
			}
		};
		destroy = () => {
			(this.updateQueue = []),
				(this.currLibraryItems = []),
				zr.set(Hy, new Map());
		};
		resetLibrary = () => this.setLibrary([]);
		getLatestLibrary = () =>
			new Promise(async (t) => {
				try {
					let r = await (this.getLastUpdateTask() || this.currLibraryItems);
					this.updateQueue.length > 0 ? t(this.getLatestLibrary()) : t(Km(r));
				} catch {
					return t(this.currLibraryItems);
				}
			});
		updateLibrary = async ({
			libraryItems: t,
			prompt: r = !1,
			merge: o = !1,
			openLibraryMenu: i = !1,
			defaultStatus: a = "unpublished",
		}) => (
			i && this.app.setState({ openSidebar: { name: Vr.name, tab: Xd } }),
			this.setLibrary(
				() =>
					new Promise(async (s, c) => {
						try {
							let d = await (typeof t == "function" && !(t instanceof Blob)
									? t(this.currLibraryItems)
									: t),
								u;
							d instanceof Blob ? (u = await $v(d, a)) : (u = dm(d, a)),
								!r ||
								window.confirm(
									v("alerts.confirmAddLibrary", { numShapes: u.length }),
								)
									? (r && this.app.focusContainer(),
										s(o ? u3(this.currLibraryItems, u) : u))
									: c(new Qs());
						} catch (d) {
							c(d);
						}
					}),
			)
		);
		setLibrary = (t) => {
			let r = new Promise(async (o, i) => {
				try {
					await this.getLastUpdateTask(),
						typeof t == "function" && (t = t(this.currLibraryItems)),
						(this.currLibraryItems = Km(await t)),
						o(this.currLibraryItems);
				} catch (a) {
					i(a);
				}
			})
				.catch((o) => {
					if (o.name === "AbortError")
						return (
							console.warn("Library update aborted by user"),
							this.currLibraryItems
						);
					throw o;
				})
				.finally(() => {
					(this.updateQueue = this.updateQueue.filter((o) => o !== r)),
						this.notifyListeners();
				});
			return this.updateQueue.push(r), this.notifyListeners(), r;
		};
	},
	f3 = Uy,
	sh = (e) => {
		let r = Math.ceil(Math.sqrt(e.length)),
			o = [],
			i = (h) =>
				e.slice(h * r, h * r + r).reduce((E, T) => {
					let { height: I } = Wo(T.elements);
					return Math.max(E, I);
				}, 0),
			a = (h) => {
				let y = 0,
					E = 0,
					T = 0;
				for (let I of e) {
					if ((y % r === 0 && (E = 0), E === h)) {
						let { width: P } = Wo(I.elements);
						T = Math.max(T, P);
					}
					y++, E++;
				}
				return T;
			},
			s = 0,
			c = 0,
			d = 0,
			u = 0,
			f = 0,
			m = 0,
			g = 0;
		for (let h of e) {
			f && f % r === 0 && ((c += d + 50), (s = 0), (m = 0), g++),
				m === 0 && (d = i(g)),
				(u = a(m));
			let { minX: y, minY: E, width: T, height: I } = Wo(h.elements),
				P = (u - T) / 2,
				C = (d - I) / 2;
			o.push(
				...h.elements.map((k) => ({
					...k,
					x: k.x + s + P - y,
					y: k.y + c + C - E,
				})),
			),
				(s += u + 50),
				f++,
				m++;
		}
		return o;
	},
	Gy = () => {
		let e =
				new URLSearchParams(window.location.hash.slice(1)).get(yp.addLibrary) ||
				new URLSearchParams(window.location.search).get(Ep.addLibrary),
			t = e
				? new URLSearchParams(window.location.hash.slice(1)).get("token")
				: null;
		return e ? { libraryUrl: e, idToken: t } : null;
	},
	rd = class e {
		static queue = new ih();
		static async getLibraryItems(t, r, o = !0) {
			let i = () =>
				new Promise(async (a, s) => {
					try {
						let c = await t.load({ source: r });
						a(dm(c?.libraryItems || [], "published"));
					} catch (c) {
						s(c);
					}
				});
			return o ? e.queue.push(i) : i();
		}
		static run = async (t, r) => {
			let o = new e(t);
			return e.queue.push(() => r(o));
		};
		adapter;
		constructor(t) {
			this.adapter = t;
		}
		getLibraryItems(t) {
			return e.getLibraryItems(this.adapter, t, !1);
		}
	},
	Ym = 0,
	ah = 0,
	lh = (e) =>
		mE(
			e
				.map((t) => `${t.id}:${dE(t.elements)}`)
				.sort()
				.join(),
		),
	d3 = async (e, t) => {
		try {
			return (
				ah++,
				await rd.run(e, async (r) => {
					let o = Fe(await r.getLibraryItems("save"));
					for (let [c] of t.deletedItems) o.delete(c);
					let i = [];
					for (let [c, d] of t.addedItems) o.has(c) ? o.set(c, d) : i.push(d);
					let a = i.concat(Array.from(o.values())),
						s = lh(a);
					return s !== Ym && (await e.save({ libraryItems: a })), (Ym = s), a;
				})
			);
		} finally {
			ah--;
		}
	},
	zB = (e) => {
		let { excalidrawAPI: t } = e,
			r = (0, od.useRef)(e);
		r.current = e;
		let o = (0, od.useRef)(!1);
		(0, od.useEffect)(() => {
			if (!t) return;
			o.current = !1;
			let i = async ({ libraryUrl: c, idToken: d }) => {
					let u = new Promise(async (m, g) => {
							try {
								let y = await (await fetch(decodeURIComponent(c))).blob();
								m(y);
							} catch (h) {
								g(h);
							}
						}),
						f = d !== t.id;
					await (f && document.hidden
						? new Promise((m) => {
								window.addEventListener("focus", () => m(), { once: !0 });
							})
						: null);
					try {
						await t.updateLibrary({
							libraryItems: u,
							prompt: f,
							merge: !0,
							defaultStatus: "published",
							openLibraryMenu: !0,
						});
					} catch (m) {
						throw m;
					} finally {
						if (window.location.hash.includes(yp.addLibrary)) {
							let m = new URLSearchParams(window.location.hash.slice(1));
							m.delete(yp.addLibrary),
								window.history.replaceState({}, Wd, `#${m.toString()}`);
						} else if (window.location.search.includes(Ep.addLibrary)) {
							let m = new URLSearchParams(window.location.search);
							m.delete(Ep.addLibrary),
								window.history.replaceState({}, Wd, `?${m.toString()}`);
						}
					}
				},
				a = (c) => {
					c.preventDefault();
					let d = Gy();
					d &&
						(c.stopImmediatePropagation(),
						window.history.replaceState({}, "", c.oldURL),
						i(d));
				},
				s = Gy();
			if (
				(s && i(s),
				"getInitialLibraryItems" in r.current &&
					r.current.getInitialLibraryItems &&
					(console.warn(
						"useHandleLibrar `opts.getInitialLibraryItems` is deprecated. Use `opts.adapter` instead.",
					),
					Promise.resolve(r.current.getInitialLibraryItems())
						.then((c) => {
							t.updateLibrary({ libraryItems: c, merge: !0 });
						})
						.catch((c) => {
							console.error(
								`UseHandeLibrary getInitialLibraryItems failed: ${c?.message}`,
							);
						})),
				"adapter" in r.current && r.current.adapter)
			) {
				let c = r.current.adapter,
					d = r.current.migrationAdapter,
					u = Ap();
				d
					? u.resolve(
							em(d.load)
								.then(async (f) => {
									let m = null;
									try {
										if (!f) return rd.getLibraryItems(c, "load");
										m = dm(f.libraryItems || [], "published");
										let g = await d3(c, p3([], m));
										try {
											await d.clear();
										} catch (h) {
											console.error(
												`couldn't delete legacy library data: ${h.message}`,
											);
										}
										return g;
									} catch (g) {
										return (
											console.error(
												`couldn't migrate legacy library data: ${g.message}`,
											),
											m
										);
									}
								})
								.catch(
									(f) => (
										console.error(
											`error during library migration: ${f.message}`,
										),
										rd.getLibraryItems(c, "load")
									),
								),
						)
					: u.resolve(em(rd.getLibraryItems, c, "load")),
					t
						.updateLibrary({
							libraryItems: u.then((f) => {
								let m = f || [];
								return (Ym = lh(m)), m;
							}),
							merge: !0,
						})
						.finally(() => {
							o.current = !0;
						});
			}
			return (
				window.addEventListener("hashchange", a),
				() => {
					window.removeEventListener("hashchange", a);
				}
			);
		}, [t]),
			(0, od.useEffect)(() => {
				let i = m3.on(async (s, c) => {
						let d = o.current,
							u = ("adapter" in r.current && r.current.adapter) || null;
						try {
							u && Ym !== lh(c) && (await d3(u, s));
						} catch (f) {
							console.error(`couldn't persist library update: ${f.message}`, s),
								d &&
									r.current.excalidrawAPI &&
									r.current.excalidrawAPI.updateScene({
										appState: { errorMessage: v("errors.saveLibraryError") },
									});
						}
					}),
					a = (s) => {
						ah && WT(s);
					};
				return (
					window.addEventListener("beforeunload", a),
					() => {
						window.removeEventListener("beforeunload", a),
							i(),
							(Ym = 0),
							(ah = 0);
					}
				);
			}, []);
	};
b();
var Qr = w(Q(), 1);
b();
var Wy = w(Q(), 1);
var Ky = w(M(), 1),
	$B = (0, Wy.forwardRef)(
		(
			{
				children: e,
				gap: t,
				align: r,
				justifyContent: o,
				className: i,
				style: a,
			},
			s,
		) =>
			(0, Ky.jsx)("div", {
				className: j("Stack Stack_horizontal", i),
				style: { "--gap": t, alignItems: r, justifyContent: o, ...a },
				ref: s,
				children: e,
			}),
	),
	HB = (0, Wy.forwardRef)(
		(
			{
				children: e,
				gap: t,
				align: r,
				justifyContent: o,
				className: i,
				style: a,
			},
			s,
		) =>
			(0, Ky.jsx)("div", {
				className: j("Stack Stack_vertical", i),
				style: { "--gap": t, justifyItems: r, justifyContent: o, ...a },
				ref: s,
				children: e,
			}),
	),
	Pr = { Row: $B, Col: HB };
b();
b();
var h3 = w(M(), 1),
	UB = ({ theme: e, id: t, libraryReturnUrl: r }) => {
		let o = r || window.location.origin + window.location.pathname;
		return (0, h3.jsx)("a", {
			className: "library-menu-browse-button",
			href: `${_.VITE_APP_LIBRARY_URL}?target=${window.name || "_blank"}&referrer=${o}&useHash=true&token=${t}&theme=${e}&version=${Sp.excalidrawLibrary}`,
			target: "_excalidraw_libraries",
			children: v("labels.libraries"),
		});
	},
	g3 = UB;
var dh = w(M(), 1),
	ch = ({
		libraryReturnUrl: e,
		theme: t,
		id: r,
		style: o,
		children: i,
		className: a,
	}) =>
		(0, dh.jsxs)("div", {
			className: j("library-menu-control-buttons", a),
			style: o,
			children: [(0, dh.jsx)(g3, { id: r, libraryReturnUrl: e, theme: t }), i],
		});
b();
var ld = w(Q(), 1);
b();
var Vm = w(Q(), 1);
var GB = /({{[\w-]+}})|(<[\w-]+>)|(<\/[\w-]+>)/g,
	WB = /{{([\w-]+)}}/,
	KB = /<([\w-]+)>/,
	YB = /<\/([\w-]+)>/,
	VB = (e, t) => {
		let r = [{ name: "", children: [] }];
		return (
			e
				.split(GB)
				.filter(Boolean)
				.forEach((o) => {
					let i = o.match(KB),
						a = o.match(YB),
						s = o.match(WB);
					if (i !== null) {
						let c = i[1];
						t.hasOwnProperty(c)
							? r.push({ name: c, children: [] })
							: console.warn(
									`Trans: missed to pass in prop ${c} for interpolating ${e}`,
								);
					} else if (a !== null)
						if (a[1] === r[r.length - 1].name) {
							let d = r.pop(),
								u = Vm.default.createElement(
									Vm.default.Fragment,
									{},
									...d.children,
								),
								f = t[d.name];
							typeof f == "function" && r[r.length - 1].children.push(f(u));
						} else
							console.warn(
								`Trans: unexpected end tag ${o} for interpolating ${e}`,
							);
					else if (s !== null) {
						let c = s[1];
						t.hasOwnProperty(c)
							? r[r.length - 1].children.push(t[c])
							: console.warn(
									`Trans: key ${c} not in props for interpolating ${e}`,
								);
					} else r[r.length - 1].children.push(o);
				}),
			r.length !== 1 &&
				console.warn(`Trans: stack not empty for interpolating ${e}`),
			r[0].children
		);
	},
	XB = ({ i18nKey: e, children: t, ...r }) => {
		let { t: o } = lr();
		return Vm.default.createElement(Vm.default.Fragment, {}, ...VB(o(e), r));
	},
	bo = XB;
b();
var Yy = w(Gn(), 1);
b();
var ls = w(M(), 1),
	ZB = ({
		label: e,
		onClick: t,
		className: r,
		children: o,
		actionType: i,
		type: a = "button",
		isLoading: s,
		...c
	}) => {
		let d = i ? `Dialog__action-button--${i}` : "";
		return (0, ls.jsxs)("button", {
			className: j("Dialog__action-button", d, r),
			type: a,
			"aria-label": e,
			onClick: t,
			...c,
			children: [
				o &&
					(0, ls.jsx)("div", {
						style: s ? { visibility: "hidden" } : {},
						children: o,
					}),
				(0, ls.jsx)("div", {
					style: s ? { visibility: "hidden" } : {},
					children: e,
				}),
				s &&
					(0, ls.jsx)("div", {
						style: { position: "absolute", inset: 0 },
						children: (0, ls.jsx)($r, {}),
					}),
			],
		});
	},
	Qi = ZB;
var nd = w(M(), 1),
	qB = (e) => {
		let {
				onConfirm: t,
				onCancel: r,
				children: o,
				confirmText: i = v("buttons.confirm"),
				cancelText: a = v("buttons.cancel"),
				className: s = "",
				...c
			} = e,
			d = tt(),
			u = Wi(id, lt),
			{ container: f } = dr();
		return (0, nd.jsxs)(er, {
			onCloseRequest: r,
			size: "small",
			...c,
			className: `confirm-dialog ${s}`,
			children: [
				o,
				(0, nd.jsxs)("div", {
					className: "confirm-dialog-buttons",
					children: [
						(0, nd.jsx)(Qi, {
							label: a,
							onClick: () => {
								d({ openMenu: null }),
									u(!1),
									(0, Yy.flushSync)(() => {
										r();
									}),
									f?.focus();
							},
						}),
						(0, nd.jsx)(Qi, {
							label: i,
							onClick: () => {
								d({ openMenu: null }),
									u(!1),
									(0, Yy.flushSync)(() => {
										t();
									}),
									f?.focus();
							},
							actionType: "danger",
						}),
					],
				}),
			],
		});
	},
	mh = qB;
b();
var qo = w(Q(), 1);
b();
var hi = class {
	static has(t) {
		try {
			return !!window.localStorage.getItem(t);
		} catch (r) {
			return console.warn(`localStorage.getItem error: ${r.message}`), !1;
		}
	}
	static get(t) {
		try {
			let r = window.localStorage.getItem(t);
			return r ? JSON.parse(r) : null;
		} catch (r) {
			return console.warn(`localStorage.getItem error: ${r.message}`), null;
		}
	}
	static set = (t, r) => {
		try {
			return window.localStorage.setItem(t, JSON.stringify(r)), !0;
		} catch (o) {
			return console.warn(`localStorage.setItem error: ${o.message}`), !1;
		}
	};
	static delete = (t) => {
		try {
			window.localStorage.removeItem(t);
		} catch (r) {
			console.warn(`localStorage.removeItem error: ${r.message}`);
		}
	};
};
var _e = w(M(), 1),
	jB = async (e) => {
		let o = Math.round(8),
			i = Math.max(Math.round(128 / 64), 2),
			a = HT(e, 6),
			s = document.createElement("canvas");
		(s.width = a[0].length * 128 + (a[0].length + 1) * (o * 2) - o * 2),
			(s.height = a.length * 128 + (a.length + 1) * (o * 2) - o * 2);
		let c = s.getContext("2d");
		(c.fillStyle = Yr.white), c.fillRect(0, 0, s.width, s.height);
		for (let [d, u] of e.entries()) {
			let f = await $l({
					elements: u.elements,
					files: null,
					maxWidthOrHeight: 128,
				}),
				{ width: m, height: g } = f,
				h = Math.floor(d / 6) * (128 + o * 2),
				y = (d % 6) * (128 + o * 2);
			c.drawImage(f, y + (128 - m) / 2 + o, h + (128 - g) / 2 + o),
				(c.lineWidth = i),
				(c.strokeStyle = Yr.gray[4]),
				c.strokeRect(y + o / 2, h + o / 2, 128 + o, 128 + o);
		}
		return await mm(new File([await Hi(s)], "preview", { type: vr.png }), {
			outputType: vr.jpg,
			maxWidthOrHeight: 5e3,
		});
	},
	QB = ({ libItem: e, appState: t, index: r, onChange: o, onRemove: i }) => {
		let a = (0, qo.useRef)(null),
			s = (0, qo.useRef)(null);
		return (
			(0, qo.useEffect)(() => {
				let c = a.current;
				c &&
					(async () => {
						let d = await pm({
							elements: e.elements,
							appState: {
								...t,
								viewBackgroundColor: Yr.white,
								exportBackground: !0,
							},
							files: null,
							skipInliningFonts: !0,
						});
						c.innerHTML = d.outerHTML;
					})();
			}, [e.elements, t]),
			(0, _e.jsxs)("div", {
				className: "single-library-item",
				children: [
					e.status === "published" &&
						(0, _e.jsx)("span", {
							className: "single-library-item-status",
							children: v("labels.statusPublished"),
						}),
					(0, _e.jsx)("div", { ref: a, className: "single-library-item__svg" }),
					(0, _e.jsx)(Te, {
						"aria-label": v("buttons.remove"),
						type: "button",
						icon: un,
						className: "single-library-item--remove",
						onClick: i.bind(null, e.id),
						title: v("buttons.remove"),
					}),
					(0, _e.jsxs)("div", {
						style: {
							display: "flex",
							margin: "0.8rem 0",
							width: "100%",
							fontSize: "14px",
							fontWeight: 500,
							flexDirection: "column",
						},
						children: [
							(0, _e.jsxs)("label", {
								style: {
									display: "flex",
									justifyContent: "space-between",
									flexDirection: "column",
								},
								children: [
									(0, _e.jsxs)("div", {
										style: { padding: "0.5em 0" },
										children: [
											(0, _e.jsx)("span", {
												style: { fontWeight: 500, color: Yr.gray[6] },
												children: v("publishDialog.itemName"),
											}),
											(0, _e.jsx)("span", {
												"aria-hidden": "true",
												className: "required",
												children: "*",
											}),
										],
									}),
									(0, _e.jsx)("input", {
										type: "text",
										ref: s,
										style: { width: "80%", padding: "0.2rem" },
										defaultValue: e.name,
										placeholder: "Item name",
										onChange: (c) => {
											o(c.target.value, r);
										},
									}),
								],
							}),
							(0, _e.jsx)("span", { className: "error", children: e.error }),
						],
					}),
				],
			})
		);
	},
	JB = ({
		onClose: e,
		libraryItems: t,
		appState: r,
		onSuccess: o,
		onError: i,
		updateItemsInStorage: a,
		onRemove: s,
	}) => {
		let [c, d] = (0, qo.useState)({
				authorName: "",
				githubHandle: "",
				name: "",
				description: "",
				twitterHandle: "",
				website: "",
			}),
			[u, f] = (0, qo.useState)(!1);
		(0, qo.useEffect)(() => {
			let C = hi.get(xa.PUBLISH_LIBRARY);
			C && d(C);
		}, []);
		let [m, g] = (0, qo.useState)(t.slice());
		(0, qo.useEffect)(() => {
			g(t.slice());
		}, [t]);
		let h = (C) => {
				d({ ...c, [C.target.name]: C.target.value });
			},
			y = async (C) => {
				C.preventDefault(), f(!0);
				let k = [],
					N = !1;
				if (
					(m.forEach((q) => {
						let ie = "";
						q.name || ((ie = v("publishDialog.errors.required")), (N = !0)),
							k.push({ ...q, error: ie });
					}),
					N)
				) {
					g(k), f(!1);
					return;
				}
				let D = await jB(m),
					B = {
						type: bT.excalidrawLibrary,
						version: Sp.excalidrawLibrary,
						source: xT,
						libraryItems: m,
					},
					F = JSON.stringify(B, null, 2),
					W = new Blob([F], { type: "application/json" }),
					G = new FormData();
				G.append("excalidrawLib", W),
					G.append("previewImage", D),
					G.append("previewImageType", D.type),
					G.append("title", c.name),
					G.append("authorName", c.authorName),
					G.append("githubHandle", c.githubHandle),
					G.append("name", c.name),
					G.append("description", c.description),
					G.append("twitterHandle", c.twitterHandle),
					G.append("website", c.website),
					fetch(`${_.VITE_APP_LIBRARY_BACKEND}/submit`, {
						method: "post",
						body: G,
					})
						.then(
							(q) =>
								q.ok
									? q.json().then(({ url: ie }) => {
											hi.delete(xa.PUBLISH_LIBRARY),
												o({ url: ie, authorName: c.authorName, items: m });
										})
									: q
											.json()
											.catch(() => {
												throw new Error(q.statusText || "something went wrong");
											})
											.then((ie) => {
												throw new Error(
													ie.message || q.statusText || "something went wrong",
												);
											}),
							(q) => {
								console.error(q), i(q), f(!1);
							},
						)
						.catch((q) => {
							console.error(q), i(q), f(!1);
						});
			},
			E = () => {
				let C = [];
				return (
					m.forEach((k, N) => {
						C.push(
							(0, _e.jsx)(
								"div",
								{
									className: "single-library-item-wrapper",
									children: (0, _e.jsx)(QB, {
										libItem: k,
										appState: r,
										index: N,
										onChange: (D, B) => {
											let F = m.slice();
											(F[B].name = D), g(F);
										},
										onRemove: s,
									}),
								},
								N,
							),
						);
					}),
					(0, _e.jsx)("div", {
						className: "selected-library-items",
						children: C,
					})
				);
			},
			T = (0, qo.useCallback)(() => {
				a(m), hi.set(xa.PUBLISH_LIBRARY, c), e();
			}, [m, e, a, c]),
			I = !!t.length,
			P = t.some((C) => C.status === "published");
		return (0, _e.jsx)(er, {
			onCloseRequest: T,
			title: v("publishDialog.title"),
			className: "publish-library",
			children: I
				? (0, _e.jsxs)("form", {
						onSubmit: y,
						children: [
							(0, _e.jsx)("div", {
								className: "publish-library-note",
								children: (0, _e.jsx)(bo, {
									i18nKey: "publishDialog.noteDescription",
									link: (C) =>
										(0, _e.jsx)("a", {
											href: "https://libraries.excalidraw.com",
											target: "_blank",
											rel: "noopener noreferrer",
											children: C,
										}),
								}),
							}),
							(0, _e.jsx)("span", {
								className: "publish-library-note",
								children: (0, _e.jsx)(bo, {
									i18nKey: "publishDialog.noteGuidelines",
									link: (C) =>
										(0, _e.jsx)("a", {
											href: "https://github.com/excalidraw/excalidraw-libraries#guidelines",
											target: "_blank",
											rel: "noopener noreferrer",
											children: C,
										}),
								}),
							}),
							(0, _e.jsx)("div", {
								className: "publish-library-note",
								children: v("publishDialog.noteItems"),
							}),
							P &&
								(0, _e.jsx)("span", {
									className: "publish-library-note publish-library-warning",
									children: v("publishDialog.republishWarning"),
								}),
							E(),
							(0, _e.jsxs)("div", {
								className: "publish-library__fields",
								children: [
									(0, _e.jsxs)("label", {
										children: [
											(0, _e.jsxs)("div", {
												children: [
													(0, _e.jsx)("span", {
														children: v("publishDialog.libraryName"),
													}),
													(0, _e.jsx)("span", {
														"aria-hidden": "true",
														className: "required",
														children: "*",
													}),
												],
											}),
											(0, _e.jsx)("input", {
												type: "text",
												name: "name",
												required: !0,
												value: c.name,
												onChange: h,
												placeholder: v("publishDialog.placeholder.libraryName"),
											}),
										],
									}),
									(0, _e.jsxs)("label", {
										style: { alignItems: "flex-start" },
										children: [
											(0, _e.jsxs)("div", {
												children: [
													(0, _e.jsx)("span", {
														children: v("publishDialog.libraryDesc"),
													}),
													(0, _e.jsx)("span", {
														"aria-hidden": "true",
														className: "required",
														children: "*",
													}),
												],
											}),
											(0, _e.jsx)("textarea", {
												name: "description",
												rows: 4,
												required: !0,
												value: c.description,
												onChange: h,
												placeholder: v("publishDialog.placeholder.libraryDesc"),
											}),
										],
									}),
									(0, _e.jsxs)("label", {
										children: [
											(0, _e.jsxs)("div", {
												children: [
													(0, _e.jsx)("span", {
														children: v("publishDialog.authorName"),
													}),
													(0, _e.jsx)("span", {
														"aria-hidden": "true",
														className: "required",
														children: "*",
													}),
												],
											}),
											(0, _e.jsx)("input", {
												type: "text",
												name: "authorName",
												required: !0,
												value: c.authorName,
												onChange: h,
												placeholder: v("publishDialog.placeholder.authorName"),
											}),
										],
									}),
									(0, _e.jsxs)("label", {
										children: [
											(0, _e.jsx)("span", {
												children: v("publishDialog.githubUsername"),
											}),
											(0, _e.jsx)("input", {
												type: "text",
												name: "githubHandle",
												value: c.githubHandle,
												onChange: h,
												placeholder: v(
													"publishDialog.placeholder.githubHandle",
												),
											}),
										],
									}),
									(0, _e.jsxs)("label", {
										children: [
											(0, _e.jsx)("span", {
												children: v("publishDialog.twitterUsername"),
											}),
											(0, _e.jsx)("input", {
												type: "text",
												name: "twitterHandle",
												value: c.twitterHandle,
												onChange: h,
												placeholder: v(
													"publishDialog.placeholder.twitterHandle",
												),
											}),
										],
									}),
									(0, _e.jsxs)("label", {
										children: [
											(0, _e.jsx)("span", {
												children: v("publishDialog.website"),
											}),
											(0, _e.jsx)("input", {
												type: "text",
												name: "website",
												pattern: "https?://.+",
												title: v("publishDialog.errors.website"),
												value: c.website,
												onChange: h,
												placeholder: v("publishDialog.placeholder.website"),
											}),
										],
									}),
									(0, _e.jsx)("span", {
										className: "publish-library-note",
										children: (0, _e.jsx)(bo, {
											i18nKey: "publishDialog.noteLicense",
											link: (C) =>
												(0, _e.jsx)("a", {
													href: "https://github.com/excalidraw/excalidraw-libraries/blob/main/LICENSE",
													target: "_blank",
													rel: "noopener noreferrer",
													children: C,
												}),
										}),
									}),
								],
							}),
							(0, _e.jsxs)("div", {
								className: "publish-library__buttons",
								children: [
									(0, _e.jsx)(Qi, {
										label: v("buttons.cancel"),
										onClick: T,
										"data-testid": "cancel-clear-canvas-button",
									}),
									(0, _e.jsx)(Qi, {
										type: "submit",
										label: v("buttons.submit"),
										actionType: "primary",
										isLoading: u,
									}),
								],
							}),
						],
					})
				: (0, _e.jsx)("p", {
						style: { padding: "1em", textAlign: "center", fontWeight: 500 },
						children: v("publishDialog.atleastOneLibItem"),
					}),
		});
	},
	b3 = JB;
b();
b();
var E3 = w(M(), 1),
	x3 = ({ className: e = "", children: t, onToggle: r, title: o, ...i }) => {
		let a = et(),
			s = j(`dropdown-menu-button ${e}`, "zen-mode-transition", {
				"dropdown-menu-button--mobile": a.editor.isMobile,
			}).trim();
		return (0, E3.jsx)("button", {
			"data-prevent-outside-click": !0,
			className: s,
			onClick: r,
			type: "button",
			"data-testid": "dropdown-menu-button",
			title: o,
			...i,
			children: t,
		});
	},
	v3 = x3;
x3.displayName = "DropdownMenuTrigger";
b();
var S3 = w(M(), 1),
	y3 = () =>
		(0, S3.jsx)("div", {
			style: {
				height: "1px",
				backgroundColor: "var(--default-border-color)",
				margin: ".5rem 0",
			},
		}),
	w3 = y3;
y3.displayName = "DropdownMenuSeparator";
b();
var uh = w(Q(), 1);
var Xm = w(M(), 1),
	T3 = ({
		children: e,
		onClickOutside: t,
		className: r = "",
		onSelect: o,
		style: i,
	}) => {
		let a = et(),
			s = (0, uh.useRef)(null),
			c = za({ onClickOutside: t });
		Kc(s, () => {
			c.onClickOutside?.();
		}),
			(0, uh.useEffect)(() => {
				let u = (m) => {
						m.key === R.ESCAPE &&
							(m.stopImmediatePropagation(), c.onClickOutside?.());
					},
					f = { capture: !0 };
				return (
					document.addEventListener("keydown", u, f),
					() => {
						document.removeEventListener("keydown", u, f);
					}
				);
			}, [c]);
		let d = j(`dropdown-menu ${r}`, {
			"dropdown-menu--mobile": a.editor.isMobile,
		}).trim();
		return (0, Xm.jsx)(my.Provider, {
			value: { onSelect: o },
			children: (0, Xm.jsx)("div", {
				ref: s,
				className: d,
				style: i,
				"data-testid": "dropdown-menu",
				children: a.editor.isMobile
					? (0, Xm.jsx)(Pr.Col, {
							className: "dropdown-menu-container",
							children: e,
						})
					: (0, Xm.jsx)(yr, {
							className: "dropdown-menu-container",
							padding: 2,
							style: { zIndex: 2 },
							children: e,
						}),
			}),
		});
	};
T3.displayName = "DropdownMenuContent";
var C3 = T3;
b();
var Vy = w(M(), 1),
	I3 = ({
		icon: e,
		shortcut: t,
		href: r,
		children: o,
		onSelect: i,
		className: a = "",
		selected: s,
		rel: c = "noreferrer",
		...d
	}) => {
		let u = Bg(d.onClick, i);
		return (0, Vy.jsx)("a", {
			...d,
			href: r,
			target: "_blank",
			rel: "noreferrer",
			className: Fg(a, s),
			title: d.title ?? d["aria-label"],
			onClick: u,
			children: (0, Vy.jsx)(zg, { icon: e, shortcut: t, children: o }),
		});
	},
	ad = I3;
I3.displayName = "DropdownMenuItemLink";
b();
var A3 = w(M(), 1),
	ez = ({ children: e, className: t = "", selected: r, ...o }) =>
		(0, A3.jsx)("div", {
			...o,
			className:
				`dropdown-menu-item-base dropdown-menu-item-custom ${t} ${r ? "dropdown-menu-item--selected" : ""}`.trim(),
			children: e,
		}),
	_3 = ez;
b();
var Zm = w(Q(), 1),
	k3 = (e) => {
		let t = Zm.default.Children.toArray(e).find(
			(r) =>
				Zm.default.isValidElement(r) &&
				typeof r.type != "string" &&
				r?.type.displayName &&
				r.type.displayName === "DropdownMenuTrigger",
		);
		return t || null;
	},
	L3 = (e) => {
		let t = Zm.default.Children.toArray(e).find(
			(r) =>
				Zm.default.isValidElement(r) &&
				typeof r.type != "string" &&
				r?.type.displayName &&
				r.type.displayName === "DropdownMenuContent",
		);
		return t || null;
	};
var ph = w(M(), 1),
	Ji = ({ children: e, open: t }) => {
		let r = k3(e),
			o = L3(e);
		return (0, ph.jsxs)(ph.Fragment, { children: [r, t && o] });
	};
Ji.Trigger = v3;
Ji.Content = C3;
Ji.Item = fo;
Ji.ItemLink = ad;
Ji.ItemCustom = _3;
Ji.Group = Om;
Ji.Separator = w3;
var gt = Ji;
Ji.displayName = "DropdownMenu";
var ur = w(M(), 1),
	tz = (e, t) => e.filter((r) => t.includes(r.id)),
	rz = ({
		setAppState: e,
		selectedItems: t,
		library: r,
		onRemoveFromLibrary: o,
		resetLibrary: i,
		onSelectItems: a,
		appState: s,
		className: c,
	}) => {
		let [d] = Ge(as, lt),
			[u, f] = Ge(id, lt),
			m = () => {
				let G = t.length
						? v("alerts.removeItemsFromsLibrary", { count: t.length })
						: v("alerts.resetLibrary"),
					q = t.length
						? v("confirmDialog.removeItemsFromLib")
						: v("confirmDialog.resetLibrary");
				return (0, ur.jsx)(mh, {
					onConfirm: () => {
						t.length ? o() : i(), h(!1);
					},
					onCancel: () => {
						h(!1);
					},
					title: q,
					children: (0, ur.jsx)("p", { children: G }),
				});
			},
			[g, h] = (0, ld.useState)(!1),
			y = !!t.length,
			E = y ? d.libraryItems.filter((G) => t.includes(G.id)) : d.libraryItems,
			T = y ? v("buttons.remove") : v("buttons.resetLibrary"),
			[I, P] = (0, ld.useState)(!1),
			[C, k] = (0, ld.useState)(null),
			N = (0, ld.useCallback)(
				() =>
					(0, ur.jsxs)(er, {
						onCloseRequest: () => k(null),
						title: v("publishSuccessDialog.title"),
						className: "publish-library-success",
						size: "small",
						children: [
							(0, ur.jsx)("p", {
								children: (0, ur.jsx)(bo, {
									i18nKey: "publishSuccessDialog.content",
									authorName: C.authorName,
									link: (G) =>
										(0, ur.jsx)("a", {
											href: C?.url,
											target: "_blank",
											rel: "noopener noreferrer",
											children: G,
										}),
								}),
							}),
							(0, ur.jsx)(Te, {
								type: "button",
								title: v("buttons.close"),
								"aria-label": v("buttons.close"),
								label: v("buttons.close"),
								onClick: () => k(null),
								"data-testid": "publish-library-success-close",
								className: "publish-library-success-close",
							}),
						],
					}),
				[k, C],
			),
			D = (G, q) => {
				P(!1), k({ url: G.url, authorName: G.authorName });
				let ie = q.slice();
				ie.forEach((te) => {
					t.includes(te.id) && (te.status = "published");
				}),
					r.setLibrary(ie);
			},
			B = async () => {
				try {
					await r.updateLibrary({
						libraryItems: ff({ description: "Excalidraw library files" }),
						merge: !0,
						openLibraryMenu: !0,
					});
				} catch (G) {
					if (G?.name === "AbortError") {
						console.warn(G);
						return;
					}
					e({ errorMessage: v("errors.importLibraryError") });
				}
			},
			F = async () => {
				let G = y ? E : await r.getLatestLibrary();
				PI(G)
					.catch(_p)
					.catch((q) => {
						e({ errorMessage: q.message });
					});
			},
			W = () =>
				(0, ur.jsxs)(gt, {
					open: u,
					children: [
						(0, ur.jsx)(gt.Trigger, { onToggle: () => f(!u), children: bC }),
						(0, ur.jsxs)(gt.Content, {
							onClickOutside: () => f(!1),
							onSelect: () => f(!1),
							className: "library-menu",
							children: [
								!y &&
									(0, ur.jsx)(gt.Item, {
										onSelect: B,
										icon: ic,
										"data-testid": "lib-dropdown--load",
										children: v("buttons.load"),
									}),
								!!E.length &&
									(0, ur.jsx)(gt.Item, {
										onSelect: F,
										icon: Ml,
										"data-testid": "lib-dropdown--export",
										children: v("buttons.export"),
									}),
								!!E.length &&
									(0, ur.jsx)(gt.Item, {
										onSelect: () => h(!0),
										icon: Uo,
										children: T,
									}),
								y &&
									(0, ur.jsx)(gt.Item, {
										icon: b2,
										onSelect: () => P(!0),
										"data-testid": "lib-dropdown--remove",
										children: v("buttons.publishLibrary"),
									}),
							],
						}),
					],
				});
		return (0, ur.jsxs)("div", {
			className: j("library-menu-dropdown-container", c),
			children: [
				W(),
				t.length > 0 &&
					(0, ur.jsx)("div", {
						className: "library-actions-counter",
						children: t.length,
					}),
				g && m(),
				I &&
					(0, ur.jsx)(b3, {
						onClose: () => P(!1),
						libraryItems: tz(d.libraryItems, t),
						appState: s,
						onSuccess: (G) => D(G, d.libraryItems),
						onError: (G) => window.alert(G),
						updateItemsInStorage: () => r.setLibrary(d.libraryItems),
						onRemove: (G) => a(t.filter((q) => q !== G)),
					}),
				C && N(),
			],
		});
	},
	Xy = ({ selectedItems: e, onSelectItems: t, className: r }) => {
		let { library: o } = Jt(),
			{ clearLibraryCache: i, deleteItemsFromLibraryCache: a } = nh(),
			s = mt(),
			c = tt(),
			[d] = Ge(as, lt),
			u = async (m) => {
				let g = m.filter((h) => !e.includes(h.id));
				o.setLibrary(g).catch(() => {
					c({ errorMessage: v("alerts.errorRemovingFromLibrary") });
				}),
					a(e),
					t([]);
			};
		return (0, ur.jsx)(rz, {
			appState: s,
			setAppState: c,
			selectedItems: e,
			onSelectItems: t,
			library: o,
			onRemoveFromLibrary: () => u(d.libraryItems),
			resetLibrary: () => {
				o.resetLibrary(), i();
			},
			className: r,
		});
	};
b();
var sd = w(Q(), 1);
b();
var Ya = w(Q(), 1);
var ss = w(M(), 1),
	M3 = (0, Ya.memo)(
		({
			id: e,
			elements: t,
			isPending: r,
			onClick: o,
			selected: i,
			onToggle: a,
			onDrag: s,
			svgCache: c,
		}) => {
			let d = (0, Ya.useRef)(null),
				u = c3(e, t, c);
			(0, Ya.useEffect)(() => {
				let y = d.current;
				if (y)
					return (
						u && (y.innerHTML = u.outerHTML),
						() => {
							y.innerHTML = "";
						}
					);
			}, [u]);
			let [f, m] = (0, Ya.useState)(!1),
				g = et().editor.isMobile,
				h =
					r &&
					(0, ss.jsx)("div", {
						className: "library-unit__adder",
						children: hC,
					});
			return (0, ss.jsxs)("div", {
				className: j("library-unit", {
					"library-unit__active": t,
					"library-unit--hover": t && f,
					"library-unit--selected": i,
					"library-unit--skeleton": !u,
				}),
				onMouseEnter: () => m(!0),
				onMouseLeave: () => m(!1),
				children: [
					(0, ss.jsx)("div", {
						className: j("library-unit__dragger", {
							"library-unit__pulse": !!r,
						}),
						ref: d,
						draggable: !!t,
						onClick:
							t || r
								? (y) => {
										e && y.shiftKey ? a(e, y) : o(e);
									}
								: void 0,
						onDragStart: (y) => {
							if (!e) {
								y.preventDefault();
								return;
							}
							m(!1), s(e, y);
						},
					}),
					h,
					e &&
						t &&
						(f || g || i) &&
						(0, ss.jsx)($m, {
							checked: i,
							onChange: (y, E) => a(e, E),
							className: "library-unit__checkbox",
						}),
				],
			});
		},
	),
	P3 = () =>
		(0, ss.jsx)("div", { className: "library-unit library-unit--skeleton" });
b();
var fh = w(Q(), 1);
function oz() {
	return [!1, (0, fh.useCallback)((t) => t(), [])];
}
var R3 = fh.default.useTransition || oz;
var cs = w(M(), 1),
	Zy = ({ children: e }) =>
		(0, cs.jsx)("div", {
			className: "library-menu-items-container__grid",
			children: e,
		}),
	gh = (0, sd.memo)(
		({
			items: e,
			onItemSelectToggle: t,
			onItemDrag: r,
			isItemSelected: o,
			onClick: i,
			svgCache: a,
			itemsRenderedPerBatch: s,
		}) => {
			let [, c] = R3(),
				[d, u] = (0, sd.useState)(0);
			return (
				(0, sd.useEffect)(() => {
					d < e.length &&
						c(() => {
							u(d + s);
						});
				}, [d, e.length, c, s]),
				(0, cs.jsx)(cs.Fragment, {
					children: e.map((f, m) =>
						m < d
							? (0, cs.jsx)(
									M3,
									{
										elements: f?.elements,
										isPending: !f?.id && !!f?.elements,
										onClick: i,
										svgCache: a,
										id: f?.id,
										selected: o(f.id),
										onToggle: t,
										onDrag: r,
									},
									f?.id ?? m,
								)
							: (0, cs.jsx)(P3, {}, m),
					),
				})
			);
		},
	);
b();
var D3 = w(Q(), 1);
var N3 = w(Jx(), 1),
	nz = xt(0),
	O3 = (e) => {
		let [t, r] = Ge(nz);
		return (
			(0, D3.useEffect)(() => {
				let { current: o } = e;
				if (!o) return;
				let i = (0, N3.default)(() => {
					let { scrollTop: a } = o;
					r(a);
				}, 200);
				return (
					o.addEventListener("scroll", i),
					() => {
						i.cancel(), o.removeEventListener("scroll", i);
					}
				);
			}, [e, r]),
			t
		);
	};
var zt = w(M(), 1),
	iz = 17,
	az = 64;
function qy({
	isLoading: e,
	libraryItems: t,
	onAddToLibrary: r,
	onInsertLibraryItems: o,
	pendingElements: i,
	theme: a,
	id: s,
	libraryReturnUrl: c,
	onSelectItems: d,
	selectedItems: u,
}) {
	let f = (0, Qr.useRef)(null),
		m = O3(f);
	(0, Qr.useEffect)(() => {
		m > 0 && f.current?.scrollTo(0, m);
	}, []);
	let { svgCache: g } = nh(),
		h = (0, Qr.useMemo)(() => t.filter((G) => G.status !== "published"), [t]),
		y = (0, Qr.useMemo)(() => t.filter((G) => G.status === "published"), [t]),
		E = !t.length && !i.length,
		T = !i.length && !h.length && !y.length,
		[I, P] = (0, Qr.useState)(null),
		C = (0, Qr.useCallback)(
			(G, q) => {
				let ie = !u.includes(G),
					te = [...h, ...y];
				if (ie) {
					if (q.shiftKey && I) {
						let we = te.findIndex((ke) => ke.id === I),
							X = te.findIndex((ke) => ke.id === G);
						if (we === -1 || X === -1) {
							d([...u, G]);
							return;
						}
						let se = Fe(u),
							Pe = te.reduce(
								(ke, fe, Y) => (
									((Y >= we && Y <= X) || se.has(fe.id)) && ke.push(fe.id), ke
								),
								[],
							);
						d(Pe);
					} else d([...u, G]);
					P(G);
				} else P(null), d(u.filter((we) => we !== G));
			},
			[I, d, y, u, h],
		),
		k = (0, Qr.useCallback)(
			(G) => {
				let q;
				return (
					u.includes(G)
						? (q = t.filter((ie) => u.includes(ie.id)))
						: (q = t.filter((ie) => ie.id === G)),
					q.map((ie) => ({
						...ie,
						elements: of(ie.elements, { randomizeSeed: !0 }),
					}))
				);
			},
			[t, u],
		),
		N = (0, Qr.useCallback)(
			(G, q) => {
				q.dataTransfer.setData(vr.excalidrawlib, Wv(k(G)));
			},
			[k],
		),
		D = (0, Qr.useCallback)((G) => (G ? u.includes(G) : !1), [u]),
		B = (0, Qr.useCallback)(() => {
			r(i);
		}, [i, r]),
		F = (0, Qr.useCallback)(
			(G) => {
				G && o(k(G));
			},
			[k, o],
		),
		W = g.size >= t.length ? az : iz;
	return (0, zt.jsxs)("div", {
		className: "library-menu-items-container",
		style:
			i.length || h.length || y.length
				? { justifyContent: "flex-start" }
				: { borderBottom: 0 },
		children: [
			!T &&
				(0, zt.jsx)(Xy, {
					selectedItems: u,
					onSelectItems: d,
					className: "library-menu-dropdown-container--in-heading",
				}),
			(0, zt.jsxs)(Pr.Col, {
				className: "library-menu-items-container__items",
				align: "start",
				gap: 1,
				style: { flex: y.length > 0 ? 1 : "0 1 auto", marginBottom: 0 },
				ref: f,
				children: [
					(0, zt.jsxs)(zt.Fragment, {
						children: [
							!T &&
								(0, zt.jsx)("div", {
									className: "library-menu-items-container__header",
									children: v("labels.personalLib"),
								}),
							e &&
								(0, zt.jsx)("div", {
									style: {
										position: "absolute",
										top: "var(--container-padding-y)",
										right: "var(--container-padding-x)",
										transform: "translateY(50%)",
									},
									children: (0, zt.jsx)($r, {}),
								}),
							!i.length && !h.length
								? (0, zt.jsxs)("div", {
										className: "library-menu-items__no-items",
										children: [
											(0, zt.jsx)("div", {
												className: "library-menu-items__no-items__label",
												children: v("library.noItems"),
											}),
											(0, zt.jsx)("div", {
												className: "library-menu-items__no-items__hint",
												children:
													y.length > 0
														? v("library.hint_emptyPrivateLibrary")
														: v("library.hint_emptyLibrary"),
											}),
										],
									})
								: (0, zt.jsxs)(Zy, {
										children: [
											i.length > 0 &&
												(0, zt.jsx)(gh, {
													itemsRenderedPerBatch: W,
													items: [{ id: null, elements: i }],
													onItemSelectToggle: C,
													onItemDrag: N,
													onClick: B,
													isItemSelected: D,
													svgCache: g,
												}),
											(0, zt.jsx)(gh, {
												itemsRenderedPerBatch: W,
												items: h,
												onItemSelectToggle: C,
												onItemDrag: N,
												onClick: F,
												isItemSelected: D,
												svgCache: g,
											}),
										],
									}),
						],
					}),
					(0, zt.jsxs)(zt.Fragment, {
						children: [
							(y.length > 0 || i.length > 0 || h.length > 0) &&
								(0, zt.jsx)("div", {
									className:
										"library-menu-items-container__header library-menu-items-container__header--excal",
									children: v("labels.excalidrawLib"),
								}),
							y.length > 0
								? (0, zt.jsx)(Zy, {
										children: (0, zt.jsx)(gh, {
											itemsRenderedPerBatch: W,
											items: y,
											onItemSelectToggle: C,
											onItemDrag: N,
											onClick: F,
											isItemSelected: D,
											svgCache: g,
										}),
									})
								: h.length > 0
									? (0, zt.jsx)("div", {
											style: {
												margin: "1rem 0",
												display: "flex",
												flexDirection: "column",
												alignItems: "center",
												justifyContent: "center",
												width: "100%",
												fontSize: ".9rem",
											},
											children: v("library.noItems"),
										})
									: null,
						],
					}),
					E &&
						(0, zt.jsx)(ch, {
							style: { padding: "16px 0", width: "100%" },
							id: s,
							libraryReturnUrl: c,
							theme: a,
							children: (0, zt.jsx)(Xy, { selectedItems: u, onSelectItems: d }),
						}),
				],
			}),
		],
	});
}
var yn = w(M(), 1),
	id = xt(!1),
	F3 = ({ children: e }) =>
		(0, yn.jsx)("div", { className: "layer-ui__library", children: e }),
	lz = ({
		onInsertLibraryItems: e,
		pendingElements: t,
		onAddToLibrary: r,
		setAppState: o,
		libraryReturnUrl: i,
		library: a,
		id: s,
		theme: c,
		selectedItems: d,
		onSelectItems: u,
	}) => {
		let [f] = Ge(as, lt),
			m = (0, jo.useCallback)(
				(y) => {
					(async (T, I) => {
						We("element", "addToLibrary", "ui");
						for (let C of Cp)
							if (T.some((k) => k.type === C))
								return o({
									errorMessage: v(`errors.libraryElementTypeError.${C}`),
								});
						let P = [
							{
								status: "unpublished",
								elements: T,
								id: Sa(),
								created: Date.now(),
							},
							...I,
						];
						r(),
							a.setLibrary(P).catch(() => {
								o({ errorMessage: v("alerts.errorAddingToLibrary") });
							});
					})(y, f.libraryItems);
				},
				[r, a, o, f.libraryItems],
			),
			g = (0, jo.useMemo)(() => f.libraryItems, [f]);
		if (f.status === "loading" && !f.isInitialized)
			return (0, yn.jsx)(F3, {
				children: (0, yn.jsx)("div", {
					className: "layer-ui__library-message",
					children: (0, yn.jsxs)("div", {
						children: [
							(0, yn.jsx)($r, { size: "2em" }),
							(0, yn.jsx)("span", {
								children: v("labels.libraryLoadingMessage"),
							}),
						],
					}),
				}),
			});
		let h = f.libraryItems.length > 0 || t.length > 0;
		return (0, yn.jsxs)(F3, {
			children: [
				(0, yn.jsx)(qy, {
					isLoading: f.status === "loading",
					libraryItems: g,
					onAddToLibrary: m,
					onInsertLibraryItems: e,
					pendingElements: t,
					id: s,
					libraryReturnUrl: i,
					theme: c,
					onSelectItems: u,
					selectedItems: d,
				}),
				h &&
					(0, yn.jsx)(ch, {
						className: "library-menu-control-buttons--at-bottom",
						style: { padding: "16px 12px 0 12px" },
						id: s,
						libraryReturnUrl: i,
						theme: c,
					}),
			],
		});
	},
	sz = (e, t) => {
		let r = () =>
				Le(t, e, { includeBoundTextElement: !0, includeElementsInFrames: !0 }),
			o = (0, jo.useRef)(r()),
			i = (0, jo.useRef)(e),
			a = (0, jo.useRef)(t);
		return (
			(!Er(e.selectedElementIds, i.current.selectedElementIds) ||
				!Er(t, a.current)) &&
				((o.current = r()), (i.current = e), (a.current = t)),
			o.current
		);
	},
	B3 = () => {
		let { library: e, id: t, onInsertElements: r } = Jt(),
			o = fi(),
			i = mt(),
			a = tt(),
			s = Ha(),
			[c, d] = (0, jo.useState)([]),
			u = (0, jo.useMemo)(() => e, [e]),
			f = sz(i, s),
			m = (0, jo.useCallback)(
				(h) => {
					r(sh(h));
				},
				[r],
			),
			g = (0, jo.useCallback)(() => {
				a({
					selectedElementIds: {},
					selectedGroupIds: {},
					activeEmbeddable: null,
				});
			}, [a]);
		return (0, yn.jsx)(lz, {
			pendingElements: f,
			onInsertLibraryItems: m,
			onAddToLibrary: g,
			setAppState: a,
			libraryReturnUrl: o.libraryReturnUrl,
			library: u,
			id: t,
			theme: i.theme,
			selectedItems: c,
			onSelectItems: d,
		});
	};
var Va = w(M(), 1);
function cz(e) {
	if (e && typeof e == "number") return e;
	switch (e) {
		case "small":
			return 550;
		case "wide":
			return 1024;
		case "regular":
		default:
			return 800;
	}
}
var er = (e) => {
	let [t, r] = n3(),
		[o] = (0, hh.useState)(document.activeElement),
		{ id: i } = dr(),
		a = et().viewport.isMobile;
	(0, hh.useEffect)(() => {
		if (!t) return;
		let u = Qd(t);
		setTimeout(() => {
			u.length > 0 && e.autofocus !== !1 && (u[1] || u[0]).focus();
		});
		let f = (m) => {
			if (m.key === R.TAB) {
				let g = Qd(t),
					{ activeElement: h } = document,
					y = g.findIndex((E) => E === h);
				y === 0 && m.shiftKey
					? (g[g.length - 1].focus(), m.preventDefault())
					: y === g.length - 1 &&
						!m.shiftKey &&
						(g[0].focus(), m.preventDefault());
			}
		};
		return (
			t.addEventListener("keydown", f),
			() => t.removeEventListener("keydown", f)
		);
	}, [t, e.autofocus]);
	let s = tt(),
		c = Wi(id, lt),
		d = () => {
			s({ openMenu: null }), c(!1), o.focus(), e.onCloseRequest();
		};
	return (0, Va.jsx)(l3, {
		className: j("Dialog", e.className, { "Dialog--fullscreen": a }),
		labelledBy: "dialog-title",
		maxWidth: cz(e.size),
		onCloseRequest: d,
		closeOnClickOutside: e.closeOnClickOutside,
		children: (0, Va.jsxs)(yr, {
			ref: r,
			children: [
				e.title &&
					(0, Va.jsx)("h2", {
						id: `${i}-dialog-title`,
						className: "Dialog__title",
						children: (0, Va.jsx)("span", {
							className: "Dialog__titleContent",
							children: e.title,
						}),
					}),
				a &&
					(0, Va.jsx)("button", {
						className: "Dialog__close",
						onClick: d,
						title: v("buttons.close"),
						"aria-label": v("buttons.close"),
						type: "button",
						children: un,
					}),
				(0, Va.jsx)("div", {
					className: "Dialog__content",
					children: e.children,
				}),
			],
		}),
	});
};
b();
var bi = w(Q(), 1);
b();
var z3 = w(M(), 1),
	Qo = ({
		type: e = "button",
		onSelect: t,
		selected: r,
		children: o,
		className: i = "",
		...a
	}) =>
		(0, z3.jsx)("button", {
			onClick: wa(a.onClick, (s) => {
				t();
			}),
			type: e,
			className: j("excalidraw-button", i, { selected: r }),
			...a,
			children: o,
		});
var ds = w(M(), 1),
	cd = (0, bi.forwardRef)(
		(
			{
				onChange: e,
				label: t,
				fullWidth: r,
				placeholder: o,
				readonly: i,
				selectOnRender: a,
				onKeyDown: s,
				isRedacted: c = !1,
				icon: d,
				className: u,
				...f
			},
			m,
		) => {
			let g = (0, bi.useRef)(null);
			(0, bi.useImperativeHandle)(m, () => g.current),
				(0, bi.useLayoutEffect)(() => {
					a && (g.current?.focus(), g.current?.select());
				}, [a]);
			let [h, y] = (0, bi.useState)(!1);
			return (0, ds.jsxs)("div", {
				className: j("ExcTextField", u, {
					"ExcTextField--fullWidth": r,
					"ExcTextField--hasIcon": !!d,
				}),
				onClick: () => {
					g.current?.focus();
				},
				children: [
					d,
					t &&
						(0, ds.jsx)("div", {
							className: "ExcTextField__label",
							children: t,
						}),
					(0, ds.jsxs)("div", {
						className: j("ExcTextField__input", {
							"ExcTextField__input--readonly": i,
						}),
						children: [
							(0, ds.jsx)("input", {
								className: j({
									"is-redacted": "value" in f && f.value && c && !h,
								}),
								readOnly: i,
								value: "value" in f ? f.value : void 0,
								defaultValue: "defaultValue" in f ? f.defaultValue : void 0,
								placeholder: o,
								ref: g,
								onChange: (E) => e?.(E.target.value),
								onKeyDown: s,
							}),
							c &&
								(0, ds.jsx)(Qo, {
									onSelect: () => y(!h),
									style: { border: 0, userSelect: "none" },
									children: h ? C2 : sc,
								}),
						],
					}),
				],
			});
		},
	);
b();
var dz = {
		toggleTheme: [V("Shift+Alt+D")],
		saveScene: [V("CtrlOrCmd+S")],
		loadScene: [V("CtrlOrCmd+O")],
		clearCanvas: [V("CtrlOrCmd+Delete")],
		imageExport: [V("CtrlOrCmd+Shift+E")],
		commandPalette: [V("CtrlOrCmd+/"), V("CtrlOrCmd+Shift+P")],
		cut: [V("CtrlOrCmd+X")],
		copy: [V("CtrlOrCmd+C")],
		paste: [V("CtrlOrCmd+V")],
		copyStyles: [V("CtrlOrCmd+Alt+C")],
		pasteStyles: [V("CtrlOrCmd+Alt+V")],
		selectAll: [V("CtrlOrCmd+A")],
		deleteSelectedElements: [V("Delete")],
		duplicateSelection: [V("CtrlOrCmd+D"), V(`Alt+${v("helpDialog.drag")}`)],
		sendBackward: [V("CtrlOrCmd+[")],
		bringForward: [V("CtrlOrCmd+]")],
		sendToBack: [Dn ? V("CtrlOrCmd+Alt+[") : V("CtrlOrCmd+Shift+[")],
		bringToFront: [Dn ? V("CtrlOrCmd+Alt+]") : V("CtrlOrCmd+Shift+]")],
		copyAsPng: [V("Shift+Alt+C")],
		group: [V("CtrlOrCmd+G")],
		ungroup: [V("CtrlOrCmd+Shift+G")],
		gridMode: [V("CtrlOrCmd+'")],
		zenMode: [V("Alt+Z")],
		objectsSnapMode: [V("Alt+S")],
		stats: [V("Alt+/")],
		addToLibrary: [],
		flipHorizontal: [V("Shift+H")],
		flipVertical: [V("Shift+V")],
		viewMode: [V("Alt+R")],
		hyperlink: [V("CtrlOrCmd+K")],
		toggleElementLock: [V("CtrlOrCmd+Shift+L")],
		resetZoom: [V("CtrlOrCmd+0")],
		zoomOut: [V("CtrlOrCmd+-")],
		zoomIn: [V("CtrlOrCmd++")],
		zoomToFitSelection: [V("Shift+3")],
		zoomToFit: [V("Shift+1")],
		zoomToFitSelectionInViewport: [V("Shift+2")],
		toggleEraserTool: [V("E")],
		toggleHandTool: [V("H")],
		setFrameAsActiveTool: [V("F")],
		saveFileToDisk: [V("CtrlOrCmd+S")],
		saveToActiveFile: [V("CtrlOrCmd+S")],
		toggleShortcuts: [V("?")],
		searchMenu: [V("CtrlOrCmd+F")],
	},
	tr = (e, t = 0) => {
		let r = dz[e];
		return r && r.length > 0 ? r[t] || r[0] : "";
	};
var xL = w(U3(), 1);
b();
var mz = "\\u0300-\\u036f",
	uz = "\\ufe20-\\ufe2f",
	pz = "\\u20d0-\\u20ff",
	fz = mz + uz + pz,
	gz = `[${fz}]`,
	hz = RegExp(gz, "g"),
	bz = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,
	xz = {
		\u00C0: "A",
		\u00C1: "A",
		\u00C2: "A",
		\u00C3: "A",
		\u00C4: "A",
		\u00C5: "A",
		\u00E0: "a",
		\u00E1: "a",
		\u00E2: "a",
		\u00E3: "a",
		\u00E4: "a",
		\u00E5: "a",
		\u00C7: "C",
		\u00E7: "c",
		\u00D0: "D",
		\u00F0: "d",
		\u00C8: "E",
		\u00C9: "E",
		\u00CA: "E",
		\u00CB: "E",
		\u00E8: "e",
		\u00E9: "e",
		\u00EA: "e",
		\u00EB: "e",
		\u00CC: "I",
		\u00CD: "I",
		\u00CE: "I",
		\u00CF: "I",
		\u00EC: "i",
		\u00ED: "i",
		\u00EE: "i",
		\u00EF: "i",
		\u00D1: "N",
		\u00F1: "n",
		\u00D2: "O",
		\u00D3: "O",
		\u00D4: "O",
		\u00D5: "O",
		\u00D6: "O",
		\u00D8: "O",
		\u00F2: "o",
		\u00F3: "o",
		\u00F4: "o",
		\u00F5: "o",
		\u00F6: "o",
		\u00F8: "o",
		\u00D9: "U",
		\u00DA: "U",
		\u00DB: "U",
		\u00DC: "U",
		\u00F9: "u",
		\u00FA: "u",
		\u00FB: "u",
		\u00FC: "u",
		\u00DD: "Y",
		\u00FD: "y",
		\u00FF: "y",
		\u00C6: "E",
		\u00E6: "e",
		\u00DE: "T",
		\u00FE: "t",
		\u00DF: "s",
		\u0100: "A",
		\u0102: "A",
		\u0104: "A",
		\u0101: "a",
		\u0103: "a",
		\u0105: "a",
		\u0106: "C",
		\u0108: "C",
		\u010A: "C",
		\u010C: "C",
		\u0107: "c",
		\u0109: "c",
		\u010B: "c",
		\u010D: "c",
		\u010E: "D",
		\u0110: "D",
		\u010F: "d",
		\u0111: "d",
		\u0112: "E",
		\u0114: "E",
		\u0116: "E",
		\u0118: "E",
		\u011A: "E",
		\u0113: "e",
		\u0115: "e",
		\u0117: "e",
		\u0119: "e",
		\u011B: "e",
		\u011C: "G",
		\u011E: "G",
		\u0120: "G",
		\u0122: "G",
		\u011D: "g",
		\u011F: "g",
		\u0121: "g",
		\u0123: "g",
		\u0124: "H",
		\u0126: "H",
		\u0125: "h",
		\u0127: "h",
		\u0128: "I",
		\u012A: "I",
		\u012C: "I",
		\u012E: "I",
		\u0130: "I",
		\u0129: "i",
		\u012B: "i",
		\u012D: "i",
		\u012F: "i",
		\u0131: "i",
		\u0134: "J",
		\u0135: "j",
		\u0136: "K",
		\u0137: "k",
		\u0138: "k",
		\u0139: "L",
		\u013B: "L",
		\u013D: "L",
		\u013F: "L",
		\u0141: "L",
		\u013A: "l",
		\u013C: "l",
		\u013E: "l",
		\u0140: "l",
		\u0142: "l",
		\u0143: "N",
		\u0145: "N",
		\u0147: "N",
		\u014A: "N",
		\u0144: "n",
		\u0146: "n",
		\u0148: "n",
		\u014B: "n",
		\u014C: "O",
		\u014E: "O",
		\u0150: "O",
		\u014D: "o",
		\u014F: "o",
		\u0151: "o",
		\u0154: "R",
		\u0156: "R",
		\u0158: "R",
		\u0155: "r",
		\u0157: "r",
		\u0159: "r",
		\u015A: "S",
		\u015C: "S",
		\u015E: "S",
		\u0160: "S",
		\u015B: "s",
		\u015D: "s",
		\u015F: "s",
		\u0161: "s",
		\u0162: "T",
		\u0164: "T",
		\u0166: "T",
		\u0163: "t",
		\u0165: "t",
		\u0167: "t",
		\u0168: "U",
		\u016A: "U",
		\u016C: "U",
		\u016E: "U",
		\u0170: "U",
		\u0172: "U",
		\u0169: "u",
		\u016B: "u",
		\u016D: "u",
		\u016F: "u",
		\u0171: "u",
		\u0173: "u",
		\u0174: "W",
		\u0175: "w",
		\u0176: "Y",
		\u0177: "y",
		\u0178: "Y",
		\u0179: "Z",
		\u017B: "Z",
		\u017D: "Z",
		\u017A: "z",
		\u017C: "z",
		\u017E: "z",
		\u0132: "I",
		\u0133: "i",
		\u0152: "E",
		\u0153: "e",
		\u0149: "n",
		\u017F: "s",
	},
	jy = (e) => e.replace(bz, (t) => xz[t] || t).replace(hz, "");
b();
var G3 = w(M(), 1),
	Xa = ({ icon: e }) =>
		(0, G3.jsx)("span", {
			style: {
				width: "1em",
				margin: "0 0.5ex 0 0.5ex",
				display: "inline-block",
				lineHeight: 0,
				verticalAlign: "middle",
			},
			children: e,
		});
b();
var cL = w(Q(), 1);
b();
var xh = w(Q(), 1);
b();
var qm = w(Q());
b();
b();
var W3 = (e) => {
		let t,
			r = new Set(),
			o = (f, m) => {
				let g = typeof f == "function" ? f(t) : f;
				if (!Object.is(g, t)) {
					let h = t;
					(t =
						(m ?? (typeof g != "object" || g === null))
							? g
							: Object.assign({}, t, g)),
						r.forEach((y) => y(t, h));
				}
			},
			i = () => t,
			d = {
				setState: o,
				getState: i,
				getInitialState: () => u,
				subscribe: (f) => (r.add(f), () => r.delete(f)),
				destroy: () => {
					(_ ? _.MODE : void 0) !== "production" &&
						console.warn(
							"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.",
						),
						r.clear();
				},
			},
			u = (t = e(o, i, d));
		return d;
	},
	K3 = (e) => (e ? W3(e) : W3);
var rL = w(Q(), 1),
	oL = w(J3(), 1),
	{ useDebugValue: Oz } = rL.default,
	{ useSyncExternalStoreWithSelector: Fz } = oL.default,
	eL = !1,
	Bz = (e) => e;
function zz(e, t = Bz, r) {
	(_ ? _.MODE : void 0) !== "production" &&
		r &&
		!eL &&
		(console.warn(
			"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937",
		),
		(eL = !0));
	let o = Fz(
		e.subscribe,
		e.getState,
		e.getServerState || e.getInitialState,
		t,
		r,
	);
	return Oz(o), o;
}
var tL = (e) => {
		(_ ? _.MODE : void 0) !== "production" &&
			typeof e != "function" &&
			console.warn(
				"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.",
			);
		let t = typeof e == "function" ? K3(e) : e,
			r = (o, i) => zz(t, o, i);
		return Object.assign(r, t), r;
	},
	nL = (e) => (e ? tL(e) : tL);
var iL,
	aL,
	lL =
		typeof window < "u" &&
		(((iL = window.document) != null && iL.createElement) ||
			((aL = window.navigator) == null ? void 0 : aL.product) === "ReactNative")
			? qm.default.useLayoutEffect
			: qm.default.useEffect;
function Xn() {
	let e = nL((t) => ({ current: new Array(), version: 0, set: t }));
	return {
		In: ({ children: t }) => {
			let r = e((i) => i.set),
				o = e((i) => i.version);
			return (
				lL(() => {
					r((i) => ({ version: i.version + 1 }));
				}, []),
				lL(
					() => (
						r(({ current: i }) => ({ current: [...i, t] })),
						() => r(({ current: i }) => ({ current: i.filter((a) => a !== t) }))
					),
					[t, o],
				),
				null
			);
		},
		Out: () => {
			let t = e((r) => r.current);
			return qm.default.createElement(qm.default.Fragment, null, t);
		},
	};
}
var Jy = xh.default.createContext(null),
	Mt = () => xh.default.useContext(Jy),
	sL = () =>
		xh.default.useMemo(
			() => ({
				MainMenuTunnel: Xn(),
				WelcomeScreenMenuHintTunnel: Xn(),
				WelcomeScreenToolbarHintTunnel: Xn(),
				WelcomeScreenHelpHintTunnel: Xn(),
				WelcomeScreenCenterTunnel: Xn(),
				FooterCenterTunnel: Xn(),
				DefaultSidebarTriggerTunnel: Xn(),
				DefaultSidebarTabTriggersTunnel: Xn(),
				OverwriteConfirmDialogTunnel: Xn(),
				TTDDialogTriggerTunnel: Xn(),
				jotaiScope: Symbol(),
			}),
			[],
		);
var Ae = w(M(), 1),
	e0 = (e, t) => {
		let r = t[0]?.type || null;
		for (let o of t)
			if (o.type !== r) {
				r = null;
				break;
			}
		return (
			(fm(e.activeTool.type) &&
				e.activeTool.type !== "image" &&
				r !== "image" &&
				r !== "frame" &&
				r !== "magicframe") ||
			t.some((o) => fm(o.type))
		);
	},
	t0 = (e, t) => La(e.activeTool.type) || t.some((r) => La(r.type)),
	vh = ({ appState: e, elementsMap: t, renderAction: r }) => {
		let o = $f(t, e),
			i = !1;
		o.length === 2 && (Ao(o[0]) || Ao(o[1])) && (i = !0);
		let a = !!(e.editingTextElement || e.newElement),
			s = et(),
			c = document.documentElement.getAttribute("dir") === "rtl",
			d =
				(La(e.activeTool.type) && !Il(e.currentItemBackgroundColor)) ||
				o.some((g) => La(g.type) && !Il(g.backgroundColor)),
			u = o.length === 1 || i,
			f = !e.editingLinearElement && o.length === 1 && at(o[0]) && !qe(o[0]),
			m = !e.croppingElementId && o.length === 1 && ct(o[0]);
		return (0, Ae.jsxs)("div", {
			className: "panelColumn",
			children: [
				(0, Ae.jsx)("div", { children: e0(e, o) && r("changeStrokeColor") }),
				t0(e, o) &&
					(0, Ae.jsx)("div", { children: r("changeBackgroundColor") }),
				d && r("changeFillStyle"),
				(Zv(e.activeTool.type) || o.some((g) => Zv(g.type))) &&
					r("changeStrokeWidth"),
				(e.activeTool.type === "freedraw" ||
					o.some((g) => g.type === "freedraw")) &&
					r("changeStrokeShape"),
				(qv(e.activeTool.type) || o.some((g) => qv(g.type))) &&
					(0, Ae.jsxs)(Ae.Fragment, {
						children: [r("changeStrokeStyle"), r("changeSloppiness")],
					}),
				(jv(e.activeTool.type) || o.some((g) => jv(g.type))) &&
					(0, Ae.jsx)(Ae.Fragment, { children: r("changeRoundness") }),
				(Qv(e.activeTool.type) || o.some((g) => Qv(g.type))) &&
					(0, Ae.jsx)(Ae.Fragment, { children: r("changeArrowType") }),
				(e.activeTool.type === "text" || o.some(Ee)) &&
					(0, Ae.jsxs)(Ae.Fragment, {
						children: [
							r("changeFontFamily"),
							r("changeFontSize"),
							(e.activeTool.type === "text" || w_(o, t)) &&
								r("changeTextAlign"),
						],
					}),
				y_(o, t) && r("changeVerticalAlign"),
				(bc(e.activeTool.type) || o.some((g) => bc(g.type))) &&
					(0, Ae.jsx)(Ae.Fragment, { children: r("changeArrowhead") }),
				r("changeOpacity"),
				(0, Ae.jsxs)("fieldset", {
					children: [
						(0, Ae.jsx)("legend", { children: v("labels.layers") }),
						(0, Ae.jsxs)("div", {
							className: "buttonList",
							children: [
								r("sendToBack"),
								r("sendBackward"),
								r("bringForward"),
								r("bringToFront"),
							],
						}),
					],
				}),
				o.length > 1 &&
					!i &&
					(0, Ae.jsxs)("fieldset", {
						children: [
							(0, Ae.jsx)("legend", { children: v("labels.align") }),
							(0, Ae.jsxs)("div", {
								className: "buttonList",
								children: [
									c
										? (0, Ae.jsxs)(Ae.Fragment, {
												children: [
													r("alignRight"),
													r("alignHorizontallyCentered"),
													r("alignLeft"),
												],
											})
										: (0, Ae.jsxs)(Ae.Fragment, {
												children: [
													r("alignLeft"),
													r("alignHorizontallyCentered"),
													r("alignRight"),
												],
											}),
									o.length > 2 && r("distributeHorizontally"),
									(0, Ae.jsx)("div", {
										style: { flexBasis: "100%", height: 0 },
									}),
									(0, Ae.jsxs)("div", {
										style: {
											display: "flex",
											flexWrap: "wrap",
											gap: ".5rem",
											marginTop: "-0.5rem",
										},
										children: [
											r("alignTop"),
											r("alignVerticallyCentered"),
											r("alignBottom"),
											o.length > 2 && r("distributeVertically"),
										],
									}),
								],
							}),
						],
					}),
				!a &&
					o.length > 0 &&
					(0, Ae.jsxs)("fieldset", {
						children: [
							(0, Ae.jsx)("legend", { children: v("labels.actions") }),
							(0, Ae.jsxs)("div", {
								className: "buttonList",
								children: [
									!s.editor.isMobile && r("duplicateSelection"),
									!s.editor.isMobile && r("deleteSelectedElements"),
									r("group"),
									r("ungroup"),
									u && r("hyperlink"),
									m && r("cropEditor"),
									f && r("toggleLinearEditor"),
									r("_custom"),
								],
							}),
						],
					}),
			],
		});
	},
	Eh = ({ activeTool: e, appState: t, app: r, UIOptions: o }) => {
		let [i, a] = (0, cL.useState)(!1),
			s = e.type === "frame",
			c = e.type === "laser",
			d = e.type === "embeddable",
			{ TTDDialogTriggerTunnel: u } = Mt();
		return (0, Ae.jsxs)(Ae.Fragment, {
			children: [
				sf.map(
					({ value: f, icon: m, key: g, numericKey: h, fillable: y }, E) => {
						if (o.tools?.[f] === !1) return null;
						let T = v(`toolBar.${f}`),
							I = g && Ea(typeof g == "string" ? g : g[0]),
							P = I ? `${I} ${v("helpDialog.or")} ${h}` : `${h}`;
						return (0, Ae.jsx)(
							Te,
							{
								className: j("Shape", { fillable: y }),
								type: "radio",
								icon: m,
								checked: e.type === f,
								name: "editor-current-shape",
								title: `${Ea(T)} \u2014 ${P}`,
								keyBindingLabel: h || I,
								"aria-label": Ea(T),
								"aria-keyshortcuts": P,
								"data-testid": `toolbar-${f}`,
								onPointerDown: ({ pointerType: C }) => {
									!t.penDetected && C === "pen" && r.togglePenMode(!0);
								},
								onChange: ({ pointerType: C }) => {
									t.activeTool.type !== f && We("toolbar", f, "ui"),
										f === "image"
											? r.setActiveTool({
													type: f,
													insertOnCanvasDirectly: C !== "mouse",
												})
											: r.setActiveTool({ type: f });
								},
							},
							f,
						);
					},
				),
				(0, Ae.jsx)("div", { className: "App-toolbar__divider" }),
				(0, Ae.jsxs)(gt, {
					open: i,
					children: [
						(0, Ae.jsxs)(gt.Trigger, {
							className: j("App-toolbar__extra-tools-trigger", {
								"App-toolbar__extra-tools-trigger--selected":
									s || d || (c && !r.props.isCollaborating),
							}),
							onToggle: () => a(!i),
							title: v("toolBar.extraTools"),
							children: [
								S2,
								r.props.aiEnabled !== !1 &&
									(0, Ae.jsx)("div", {
										style: {
											display: "inline-flex",
											marginLeft: "auto",
											padding: "2px 4px",
											borderRadius: 6,
											fontSize: 8,
											fontFamily: "Cascadia, monospace",
											position: "absolute",
											background: "var(--color-promo)",
											color: "var(--color-surface-lowest)",
											bottom: 3,
											right: 4,
										},
										children: "AI",
									}),
							],
						}),
						(0, Ae.jsxs)(gt.Content, {
							onClickOutside: () => a(!1),
							onSelect: () => a(!1),
							className: "App-toolbar__extra-tools-dropdown",
							children: [
								(0, Ae.jsx)(gt.Item, {
									onSelect: () => r.setActiveTool({ type: "frame" }),
									icon: Kp,
									shortcut: R.F.toLocaleUpperCase(),
									"data-testid": "toolbar-frame",
									selected: s,
									children: v("toolBar.frame"),
								}),
								(0, Ae.jsx)(gt.Item, {
									onSelect: () => r.setActiveTool({ type: "embeddable" }),
									icon: CC,
									"data-testid": "toolbar-embeddable",
									selected: d,
									children: v("toolBar.embeddable"),
								}),
								(0, Ae.jsx)(gt.Item, {
									onSelect: () => r.setActiveTool({ type: "laser" }),
									icon: Vp,
									"data-testid": "toolbar-laser",
									selected: c,
									shortcut: R.K.toLocaleUpperCase(),
									children: v("toolBar.laser"),
								}),
								(0, Ae.jsx)("div", {
									style: { margin: "6px 0", fontSize: 14, fontWeight: 600 },
									children: "Generate",
								}),
								r.props.aiEnabled !== !1 && (0, Ae.jsx)(u.Out, {}),
								(0, Ae.jsx)(gt.Item, {
									onSelect: () =>
										r.setOpenDialog({ name: "ttd", tab: "mermaid" }),
									icon: Yp,
									"data-testid": "toolbar-embeddable",
									children: v("toolBar.mermaidToExcalidraw"),
								}),
								r.props.aiEnabled !== !1 &&
									r.plugins.diagramToCode &&
									(0, Ae.jsx)(Ae.Fragment, {
										children: (0, Ae.jsxs)(gt.Item, {
											onSelect: () => r.onMagicframeToolSelect(),
											icon: Xp,
											"data-testid": "toolbar-magicframe",
											children: [
												v("toolBar.magicframe"),
												(0, Ae.jsx)(gt.Item.Badge, { children: "AI" }),
											],
										}),
									}),
							],
						}),
					],
				}),
			],
		});
	},
	dL = ({ renderAction: e, zoom: t }) =>
		(0, Ae.jsx)(Pr.Col, {
			gap: 1,
			className: Nn.ZOOM_ACTIONS,
			children: (0, Ae.jsxs)(Pr.Row, {
				align: "center",
				children: [e("zoomOut"), e("resetZoom"), e("zoomIn")],
			}),
		}),
	mL = ({ renderAction: e, className: t }) =>
		(0, Ae.jsxs)("div", {
			className: `undo-redo-buttons ${t}`,
			children: [
				(0, Ae.jsx)("div", {
					className: "undo-button-container",
					children: (0, Ae.jsx)(Xo, {
						label: v("buttons.undo"),
						children: e("undo"),
					}),
				}),
				(0, Ae.jsx)("div", {
					className: "redo-button-container",
					children: (0, Ae.jsxs)(Xo, {
						label: v("buttons.redo"),
						children: [" ", e("redo")],
					}),
				}),
			],
		}),
	uL = ({ actionManager: e, showExitZenModeBtn: t }) =>
		(0, Ae.jsx)("button", {
			type: "button",
			className: j("disable-zen-mode", { "disable-zen-mode--visible": t }),
			onClick: () => e.executeAction(ed),
			children: v("buttons.exitZenMode"),
		}),
	pL = ({ renderAction: e, className: t }) =>
		(0, Ae.jsx)("div", {
			className: `finalize-button ${t}`,
			children: e("finalize", { size: "small" }),
		});
b();
var fL = w(Q(), 1),
	r0 = (e) => {
		let t = (0, fL.useRef)({ userFn: e });
		return (
			(t.current.userFn = e),
			t.current.stableFn ||
				(t.current.stableFn = (...r) => t.current.userFn(...r)),
			t.current.stableFn
		);
	};
b();
var yh = w(M(), 1),
	ms = xt(null),
	gL = () => {
		let [e, t] = Ge(ms, lt),
			r = pr();
		return e && e === "clearCanvas"
			? (0, yh.jsx)(mh, {
					onConfirm: () => {
						r.executeAction(ji), t(null);
					},
					onCancel: () => t(null),
					title: v("clearCanvasDialog.title"),
					children: (0, yh.jsxs)("p", {
						className: "clear-canvas__content",
						children: [" ", v("alerts.clearReset")],
					}),
				})
			: null;
	};
var o0 = {};
eT(o0, { toggleTheme: () => $z });
b();
var $z = {
	...Ql,
	category: "App",
	label: "Toggle theme",
	perform: ({ actionManager: e }) => {
		e.executeAction(Ql, "commandPalette");
	},
};
b();
var wh = re({
		name: "copyElementLink",
		label: "labels.copyElementLink",
		icon: ac,
		trackEvent: { category: "element" },
		perform: async (e, t, r, o) => {
			let i = Le(e, t);
			try {
				if (window.location) {
					let a = Tf(i, t);
					return a
						? (await Aa(
								o.props.generateLinkForSelection
									? o.props.generateLinkForSelection(a.id, a.type)
									: Sf(a.id, a.type),
							),
							{
								appState: {
									toast: {
										message: v("toast.elementLinkCopied"),
										closable: !0,
									},
								},
								storeAction: H.NONE,
							})
						: { appState: t, elements: e, app: o, storeAction: H.NONE };
				}
			} catch (a) {
				console.error(a);
			}
			return { appState: t, elements: e, app: o, storeAction: H.NONE };
		},
		predicate: (e, t) => Cf(Le(e, t)),
	}),
	hL = re({
		name: "linkToElement",
		label: "labels.linkToElement",
		icon: Qp,
		perform: (e, t, r, o) => {
			let i = Le(e, t);
			return i.length !== 1 || !Cf(i)
				? { elements: e, appState: t, app: o, storeAction: H.NONE }
				: {
						appState: {
							...t,
							openDialog: {
								name: "elementLinkSelector",
								sourceElementId: Le(e, t)[0].id,
							},
						},
						storeAction: H.CAPTURE,
					};
		},
		predicate: (e, t, r, o) => {
			let i = Le(e, t);
			return (
				t.openDialog?.name !== "elementLinkSelector" && i.length === 1 && Cf(i)
			);
		},
		trackEvent: !1,
	});
var It = w(M(), 1),
	Hz = xt(null),
	Zt = {
		app: "App",
		export: "Export",
		tools: "Tools",
		editor: "Editor",
		elements: "Elements",
		links: "Links",
	},
	Uz = (e) => {
		switch (e) {
			case Zt.app:
				return 1;
			case Zt.export:
				return 2;
			case Zt.editor:
				return 3;
			case Zt.tools:
				return 4;
			case Zt.elements:
				return 5;
			case Zt.links:
				return 6;
			default:
				return 10;
		}
	},
	Sh = ({ shortcut: e, className: t, children: r }) => {
		let o = e.replace("++", "+$").split("+");
		return (0, It.jsxs)("div", {
			className: j("shortcut", t),
			children: [
				o.map((i, a) =>
					(0, It.jsx)(
						"div",
						{
							className: "shortcut-wrapper",
							children: (0, It.jsx)("div", {
								className: "shortcut-key",
								children: i === "$" ? "+" : i,
							}),
						},
						i,
					),
				),
				(0, It.jsx)("div", { className: "shortcut-desc", children: r }),
			],
		});
	},
	vL = (e) =>
		!e.altKey &&
		e[R.CTRL_OR_CMD] &&
		((e.shiftKey && e.key.toLowerCase() === R.P) || e.key === R.SLASH),
	_me = Object.assign(
		(e) => {
			let t = mt(),
				r = tt();
			return (
				(0, wn.useEffect)(() => {
					let o = (i) => {
						vL(i) &&
							(i.preventDefault(),
							i.stopPropagation(),
							r((a) => {
								let s =
									a.openDialog?.name === "commandPalette"
										? null
										: { name: "commandPalette" };
								return (
									s && We("command_palette", "open", "shortcut"),
									{ openDialog: s }
								);
							}));
					};
					return (
						window.addEventListener("keydown", o, { capture: !0 }),
						() => window.removeEventListener("keydown", o, { capture: !0 })
					);
				}, [r]),
				t.openDialog?.name !== "commandPalette"
					? null
					: (0, It.jsx)(Gz, { ...e })
			);
		},
		{ defaultItems: o0 },
	);
function Gz({ customCommandPaletteItems: e }) {
	let t = Jt(),
		r = mt(),
		o = tt(),
		i = fi(),
		a = pr(),
		[s, c] = Ge(Hz),
		[d, u] = (0, wn.useState)(null),
		f = (0, wn.useRef)(null),
		m = za({ uiAppState: r, customCommandPaletteItems: e, appProps: i });
	(0, wn.useEffect)(() => {
		let { uiAppState: D, customCommandPaletteItems: B, appProps: F } = m,
			W = (te) => {
				let we = "";
				return (
					te.label &&
						(typeof te.label == "function"
							? (we = v(te.label(t.scene.getNonDeletedElements(), D, t)))
							: (we = v(te.label))),
					we
				);
			},
			G = (te) =>
				typeof te.icon == "function"
					? te.icon(D, t.scene.getNonDeletedElements())
					: te.icon,
			q = [],
			ie = (te, we, X) => {
				let se = {
					label: W(te),
					icon: G(te),
					category: we,
					shortcut: tr(te.name),
					keywords: te.keywords,
					predicate: te.predicate,
					viewMode: te.viewMode,
					perform: () => {
						a.executeAction(te, "commandPalette");
					},
				};
				return X ? X(se, te) : se;
			};
		if (D && t.scene && a) {
			let te = [
					a.actions.group,
					a.actions.ungroup,
					a.actions.cut,
					a.actions.copy,
					a.actions.deleteSelectedElements,
					a.actions.copyStyles,
					a.actions.pasteStyles,
					a.actions.bringToFront,
					a.actions.bringForward,
					a.actions.sendBackward,
					a.actions.sendToBack,
					a.actions.alignTop,
					a.actions.alignBottom,
					a.actions.alignLeft,
					a.actions.alignRight,
					a.actions.alignVerticallyCentered,
					a.actions.alignHorizontallyCentered,
					a.actions.duplicateSelection,
					a.actions.flipHorizontal,
					a.actions.flipVertical,
					a.actions.zoomToFitSelection,
					a.actions.zoomToFitSelectionInViewport,
					a.actions.increaseFontSize,
					a.actions.decreaseFontSize,
					a.actions.toggleLinearEditor,
					a.actions.cropEditor,
					Gm,
					wh,
					hL,
				].map((fe) =>
					ie(fe, Zt.elements, (Y, K) => ({
						...Y,
						predicate: K.predicate
							? K.predicate
							: (ee, le, ce, ue) => Le(ee, le).length > 0,
					})),
				),
				we = [a.actions.toggleHandTool, a.actions.setFrameAsActiveTool].map(
					(fe) => ie(fe, Zt.tools),
				),
				X = [
					a.actions.undo,
					a.actions.redo,
					a.actions.zoomIn,
					a.actions.zoomOut,
					a.actions.resetZoom,
					a.actions.zoomToFit,
					a.actions.zenMode,
					a.actions.viewMode,
					a.actions.gridMode,
					a.actions.objectsSnapMode,
					a.actions.toggleShortcuts,
					a.actions.selectAll,
					a.actions.toggleElementLock,
					a.actions.unlockAllElements,
					a.actions.stats,
				].map((fe) => ie(fe, Zt.editor)),
				se = [
					a.actions.saveToActiveFile,
					a.actions.saveFileToDisk,
					a.actions.copyAsPng,
					a.actions.copyAsSvg,
				].map((fe) => ie(fe, Zt.export));
			q = [
				...te,
				...X,
				{
					label: W(ji),
					icon: G(ji),
					shortcut: tr(ji.name),
					category: Zt.editor,
					keywords: ["delete", "destroy"],
					viewMode: !1,
					perform: () => {
						zr.set(ms, "clearCanvas");
					},
				},
				{
					label: v("buttons.exportImage"),
					category: Zt.export,
					icon: $p,
					shortcut: tr("imageExport"),
					keywords: [
						"export",
						"image",
						"png",
						"jpeg",
						"svg",
						"clipboard",
						"picture",
					],
					perform: () => {
						o({ openDialog: { name: "imageExport" } });
					},
				},
				...se,
			];
			let Pe = [
					{
						label: v("toolBar.library"),
						category: Zt.app,
						icon: rc,
						viewMode: !1,
						perform: () => {
							D.openSidebar
								? o({ openSidebar: null })
								: o({ openSidebar: { name: Vr.name, tab: Vr.defaultTab } });
						},
					},
					{
						label: v("search.title"),
						category: Zt.app,
						icon: Go,
						viewMode: !0,
						perform: () => {
							a.executeAction(jm);
						},
					},
					{
						label: v("labels.changeStroke"),
						keywords: ["color", "outline"],
						category: Zt.elements,
						icon: zp,
						viewMode: !1,
						predicate: (fe, Y) => {
							let K = Le(fe, Y);
							return K.length > 0 && e0(Y, K);
						},
						perform: () => {
							o((fe) => ({
								openMenu: fe.openMenu === "shape" ? null : "shape",
								openPopup: "elementStroke",
							}));
						},
					},
					{
						label: v("labels.changeBackground"),
						keywords: ["color", "fill"],
						icon: zp,
						category: Zt.elements,
						viewMode: !1,
						predicate: (fe, Y) => {
							let K = Le(fe, Y);
							return K.length > 0 && t0(Y, K);
						},
						perform: () => {
							o((fe) => ({
								openMenu: fe.openMenu === "shape" ? null : "shape",
								openPopup: "elementBackground",
							}));
						},
					},
					{
						label: v("labels.canvasBackground"),
						keywords: ["color"],
						icon: zp,
						category: Zt.editor,
						viewMode: !1,
						perform: () => {
							o((fe) => ({
								openMenu: fe.openMenu === "canvas" ? null : "canvas",
								openPopup: "canvasBackground",
							}));
						},
					},
					...sf.reduce((fe, Y) => {
						let { value: K, icon: ee, key: le, numericKey: ce } = Y;
						if (F.UIOptions.tools?.[K] === !1) return fe;
						let ge = (le && Ea(typeof le == "string" ? le : le[0])) || ce,
							Se = {
								label: v(`toolBar.${K}`),
								category: Zt.tools,
								shortcut: ge,
								icon: ee,
								keywords: ["toolbar"],
								viewMode: !1,
								perform: ({ event: Dt }) => {
									K === "image"
										? t.setActiveTool({
												type: K,
												insertOnCanvasDirectly: Dt.type === "keydown",
											})
										: t.setActiveTool({ type: K });
								},
							};
						return fe.push(Se), fe;
					}, []),
					...we,
					{
						label: v("toolBar.lock"),
						category: Zt.tools,
						icon: D.activeTool.locked ? oc : Ll,
						shortcut: R.Q.toLocaleUpperCase(),
						viewMode: !1,
						perform: () => {
							t.toggleLock();
						},
					},
					{
						label: `${v("labels.textToDiagram")}...`,
						category: Zt.tools,
						icon: _2,
						viewMode: !1,
						predicate: F.aiEnabled,
						perform: () => {
							o((fe) => ({
								...fe,
								openDialog: { name: "ttd", tab: "text-to-diagram" },
							}));
						},
					},
					{
						label: `${v("toolBar.mermaidToExcalidraw")}...`,
						category: Zt.tools,
						icon: Yp,
						viewMode: !1,
						predicate: F.aiEnabled,
						perform: () => {
							o((fe) => ({
								...fe,
								openDialog: { name: "ttd", tab: "mermaid" },
							}));
						},
					},
				],
				ke = [...q, ...Pe, ...(B || [])].map((fe) => ({
					...fe,
					icon: fe.icon || Zp,
					order: fe.order ?? Uz(fe.category),
					haystack: `${jy(fe.label.toLocaleLowerCase())} ${fe.keywords?.join(" ") || ""}`,
				}));
			u(ke), c(ke.find((fe) => fe.label === s?.label) ?? null);
		}
	}, [m, t, a, u, s?.label, c, o]);
	let [g, h] = (0, wn.useState)(""),
		[y, E] = (0, wn.useState)(null),
		[T, I] = (0, wn.useState)({}),
		P = (D) => {
			o({ openDialog: null }, D), h("");
		},
		C = (D, B) => {
			r.openDialog?.name === "commandPalette" &&
				(B.stopPropagation(),
				B.preventDefault(),
				document.body.classList.add("excalidraw-animations-disabled"),
				P(() => {
					D.perform({ actionManager: a, event: B }),
						c(D),
						requestAnimationFrame(() => {
							document.body.classList.remove("excalidraw-animations-disabled");
						});
				}));
		},
		k = r0((D) =>
			D.viewMode === !1 && r.viewModeEnabled
				? !1
				: typeof D.predicate == "function"
					? D.predicate(t.scene.getNonDeletedElements(), r, i, t)
					: D.predicate === void 0 || D.predicate,
		),
		N = r0((D) => {
			let B = ii(D.target) || vL(D) || D.key === R.ESCAPE;
			if (
				B &&
				D.key !== R.ARROW_UP &&
				D.key !== R.ARROW_DOWN &&
				D.key !== R.ENTER
			)
				return;
			let F = Object.values(T).flat(),
				W = s && !g && k(s);
			if (D.key === R.ARROW_UP) {
				D.preventDefault();
				let G = F.findIndex((te) => te.label === y?.label);
				if (W) {
					if (G === 0) {
						E(s);
						return;
					}
					if (y === s) {
						let te = F[F.length - 1];
						te && E(te);
						return;
					}
				}
				let q;
				G === -1
					? (q = F.length - 1)
					: (q = G === 0 ? F.length - 1 : (G - 1) % F.length);
				let ie = F[q];
				ie && E(ie);
				return;
			}
			if (D.key === R.ARROW_DOWN) {
				D.preventDefault();
				let G = F.findIndex((te) => te.label === y?.label);
				if (W) {
					if (!y || G === F.length - 1) {
						E(s);
						return;
					}
					if (y === s) {
						let te = F[0];
						te && E(te);
						return;
					}
				}
				let q = (G + 1) % F.length,
					ie = F[q];
				ie && E(ie);
				return;
			}
			if (
				(D.key === R.ENTER &&
					y &&
					setTimeout(() => {
						C(y, D);
					}),
				!B)
			) {
				if ((D.stopPropagation(), /^[a-zA-Z0-9]$/.test(D.key))) {
					f?.current?.focus();
					return;
				}
				D.preventDefault();
			}
		});
	return (
		(0, wn.useEffect)(
			() => (
				window.addEventListener("keydown", N, { capture: !0 }),
				() => window.removeEventListener("keydown", N, { capture: !0 })
			),
			[N],
		),
		(0, wn.useEffect)(() => {
			if (!d) return;
			let D = (G) => {
					let q = {};
					for (let ie of G)
						q[ie.category] ? q[ie.category].push(ie) : (q[ie.category] = [ie]);
					return q;
				},
				B = d.filter(k).sort((G, q) => G.order - q.order),
				F = !g && s && k(s);
			if (!g) {
				I(D(F ? B.filter((G) => G.label !== s?.label) : B)),
					E(F ? s : B[0] || null);
				return;
			}
			let W = jy(g.toLocaleLowerCase().replace(/[<>_| -]/g, ""));
			(B = xL.default
				.filter(W, B, { extract: (G) => G.haystack })
				.sort((G, q) => q.score - G.score)
				.map((G) => G.original)),
				I(D(B)),
				E(B[0] ?? null);
		}, [g, d, k, s]),
		(0, It.jsxs)(er, {
			onCloseRequest: () => P(),
			closeOnClickOutside: !0,
			title: !1,
			size: 720,
			autofocus: !0,
			className: "command-palette-dialog",
			children: [
				(0, It.jsx)(cd, {
					value: g,
					placeholder: v("commandPalette.search.placeholder"),
					onChange: (D) => {
						h(D);
					},
					selectOnRender: !0,
					ref: f,
				}),
				!t.device.viewport.isMobile &&
					(0, It.jsxs)("div", {
						className: "shortcuts-wrapper",
						children: [
							(0, It.jsx)(Sh, {
								shortcut: "\u2191\u2193",
								children: v("commandPalette.shortcuts.select"),
							}),
							(0, It.jsx)(Sh, {
								shortcut: "\u21B5",
								children: v("commandPalette.shortcuts.confirm"),
							}),
							(0, It.jsx)(Sh, {
								shortcut: V("Esc"),
								children: v("commandPalette.shortcuts.close"),
							}),
						],
					}),
				(0, It.jsxs)("div", {
					className: "commands",
					children: [
						s &&
							!g &&
							(0, It.jsxs)("div", {
								className: "command-category",
								children: [
									(0, It.jsxs)("div", {
										className: "command-category-title",
										children: [
											v("commandPalette.recents"),
											(0, It.jsx)("div", {
												className: "icon",
												style: { marginLeft: "6px" },
												children: A2,
											}),
										],
									}),
									(0, It.jsx)(bL, {
										command: s,
										isSelected: s.label === y?.label,
										onClick: (D) => C(s, D),
										disabled: !k(s),
										onMouseMove: () => E(s),
										showShortcut: !t.device.viewport.isMobile,
										appState: r,
									}),
								],
							}),
						Object.keys(T).length > 0
							? Object.keys(T).map((D, B) =>
									(0, It.jsxs)(
										"div",
										{
											className: "command-category",
											children: [
												(0, It.jsx)("div", {
													className: "command-category-title",
													children: D,
												}),
												T[D].map((F) =>
													(0, It.jsx)(
														bL,
														{
															command: F,
															isSelected: F.label === y?.label,
															onClick: (W) => C(F, W),
															onMouseMove: () => E(F),
															showShortcut: !t.device.viewport.isMobile,
															appState: r,
														},
														F.label,
													),
												),
											],
										},
										D,
									),
								)
							: d
								? (0, It.jsxs)("div", {
										className: "no-match",
										children: [
											(0, It.jsx)("div", { className: "icon", children: Go }),
											" ",
											v("commandPalette.search.noMatch"),
										],
									})
								: null,
					],
				}),
			],
		})
	);
}
var bL = ({
	command: e,
	isSelected: t,
	disabled: r,
	onMouseMove: o,
	onClick: i,
	showShortcut: a,
	appState: s,
}) => {
	let c = () => {};
	return (0, It.jsxs)("div", {
		className: j("command-item", { "item-selected": t, "item-disabled": r }),
		ref: (d) => {
			t && !r && d?.scrollIntoView?.({ block: "nearest" });
		},
		onClick: r ? c : i,
		onMouseMove: r ? c : o,
		title: r ? v("commandPalette.itemNotAvailable") : "",
		children: [
			(0, It.jsxs)("div", {
				className: "name",
				children: [
					e.icon &&
						(0, It.jsx)(Xa, {
							icon: typeof e.icon == "function" ? e.icon(s) : e.icon,
						}),
					e.label,
				],
			}),
			a && e.shortcut && (0, It.jsx)(Sh, { shortcut: e.shortcut }),
		],
	});
};
var EL = w(M(), 1),
	n0 = re({
		name: "toggleLinearEditor",
		category: Zt.elements,
		label: (e, t, r) =>
			r.scene.getSelectedElements({
				selectedElementIds: t.selectedElementIds,
			})[0]?.type === "arrow"
				? "labels.lineEditor.editArrow"
				: "labels.lineEditor.edit",
		keywords: ["line"],
		trackEvent: { category: "element" },
		predicate: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t);
			return !!(
				!t.editingLinearElement &&
				i.length === 1 &&
				at(i[0]) &&
				!qe(i[0])
			);
		},
		perform(e, t, r, o) {
			let i = o.scene.getSelectedElements({
					selectedElementIds: t.selectedElementIds,
					includeBoundTextElement: !0,
				})[0],
				a = t.editingLinearElement?.elementId === i.id ? null : new De(i);
			return {
				appState: { ...t, editingLinearElement: a },
				storeAction: H.CAPTURE,
			};
		},
		PanelComponent: ({ appState: e, updateData: t, app: r }) => {
			let o = r.scene.getSelectedElements({
					selectedElementIds: e.selectedElementIds,
				})[0],
				i = v(
					o.type === "arrow"
						? "labels.lineEditor.editArrow"
						: "labels.lineEditor.edit",
				);
			return (0, EL.jsx)(Te, {
				type: "button",
				icon: U2,
				title: i,
				"aria-label": i,
				onClick: () => t(null),
			});
		},
	});
b();
var jm = re({
	name: "searchMenu",
	icon: Go,
	keywords: ["search", "find"],
	label: "search.title",
	viewMode: !0,
	trackEvent: {
		category: "search_menu",
		action: "toggle",
		predicate: (e) => e.gridModeEnabled,
	},
	perform(e, t, r, o) {
		if (t.openSidebar?.name === Vr.name && t.openSidebar.tab === Di) {
			let i = o.excalidrawContainerValue.container?.querySelector(
				`.${Nn.SEARCH_MENU_INPUT_WRAPPER} input`,
			);
			return i?.matches(":focus")
				? { appState: { ...t, openSidebar: null }, storeAction: H.NONE }
				: (i?.focus(), i?.select(), !1);
		}
		return {
			appState: {
				...t,
				openSidebar: { name: Vr.name, tab: Di },
				openDialog: null,
			},
			storeAction: H.NONE,
		};
	},
	checked: (e) => e.gridModeEnabled,
	predicate: (e, t, r) => r.gridModeEnabled === void 0,
	keyTest: (e) => e[R.CTRL_OR_CMD] && e.key === R.F,
});
b();
var yL = w(M(), 1),
	i0 = re({
		name: "cropEditor",
		label: "helpDialog.cropStart",
		icon: Lv,
		viewMode: !0,
		trackEvent: { category: "menu" },
		keywords: ["image", "crop"],
		perform(e, t, r, o) {
			let i = o.scene.getSelectedElements({
				selectedElementIds: t.selectedElementIds,
				includeBoundTextElement: !0,
			})[0];
			return {
				appState: { ...t, isCropping: !1, croppingElementId: i.id },
				storeAction: H.CAPTURE,
			};
		},
		predicate: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t);
			return !!(!t.croppingElementId && i.length === 1 && ct(i[0]));
		},
		PanelComponent: ({ appState: e, updateData: t, app: r }) => {
			let o = v("helpDialog.cropStart");
			return (0, yL.jsx)(Te, {
				type: "button",
				icon: Lv,
				title: o,
				"aria-label": o,
				onClick: () => t(null),
			});
		},
	});
b();
b();
var us = class {
		constructor(t = !0, r = !0) {
			this.isUndoStackEmpty = t;
			this.isRedoStackEmpty = r;
		}
	},
	Qm = class e {
		onHistoryChangedEmitter = new pn();
		undoStack = [];
		redoStack = [];
		get isUndoStackEmpty() {
			return this.undoStack.length === 0;
		}
		get isRedoStackEmpty() {
			return this.redoStack.length === 0;
		}
		clear() {
			(this.undoStack.length = 0), (this.redoStack.length = 0);
		}
		record(t, r) {
			let o = a0.create(r, t);
			o.isEmpty() ||
				(this.undoStack.push(o.inverse()),
				o.elementsChange.isEmpty() || (this.redoStack.length = 0),
				this.onHistoryChangedEmitter.trigger(
					new us(this.isUndoStackEmpty, this.isRedoStackEmpty),
				));
		}
		undo(t, r, o) {
			return this.perform(
				t,
				r,
				o,
				() => e.pop(this.undoStack),
				(i) => e.push(this.redoStack, i, t),
			);
		}
		redo(t, r, o) {
			return this.perform(
				t,
				r,
				o,
				() => e.pop(this.redoStack),
				(i) => e.push(this.undoStack, i, t),
			);
		}
		perform(t, r, o, i, a) {
			try {
				let s = i();
				if (s === null) return;
				let c = t,
					d = r,
					u = !1;
				for (; s; ) {
					try {
						[c, d, u] = s.applyTo(c, d, o);
					} finally {
						a(s);
					}
					if (u) break;
					s = i();
				}
				return [c, d];
			} finally {
				this.onHistoryChangedEmitter.trigger(
					new us(this.isUndoStackEmpty, this.isRedoStackEmpty),
				);
			}
		}
		static pop(t) {
			if (!t.length) return null;
			let r = t.pop();
			return r !== void 0 ? r : null;
		}
		static push(t, r, o) {
			let i = r.inverse().applyLatestChanges(o);
			return t.push(i);
		}
	},
	a0 = class e {
		constructor(t, r) {
			this.appStateChange = t;
			this.elementsChange = r;
		}
		static create(t, r) {
			return new e(t, r);
		}
		inverse() {
			return new e(
				this.appStateChange.inverse(),
				this.elementsChange.inverse(),
			);
		}
		applyTo(t, r, o) {
			let [i, a] = this.elementsChange.applyTo(t, o.elements),
				[s, c] = this.appStateChange.applyTo(r, i);
			return [i, s, a || c];
		}
		applyLatestChanges(t) {
			let r = this.elementsChange.applyLatestChanges(t);
			return e.create(this.appStateChange, r);
		}
		isEmpty() {
			return this.appStateChange.isEmpty() && this.elementsChange.isEmpty();
		}
	};
b();
var Th = w(Q(), 1),
	l0 = (e, t) => {
		let [r, o] = (0, Th.useState)(t);
		return (
			(0, Th.useEffect)(() => {
				let i = e.on((a) => {
					o(a);
				});
				return () => {
					i();
				};
			}, [e]),
			r
		);
	};
var s0 = w(M(), 1),
	wL = (e, t, r) => {
		if (
			!t.multiElement &&
			!t.resizingElement &&
			!t.editingTextElement &&
			!t.newElement &&
			!t.selectedElementsAreBeingDragged &&
			!t.selectionElement &&
			!e.flowChartCreator.isCreatingChart
		) {
			let o = r();
			if (!o) return { storeAction: H.NONE };
			let [i, a] = o,
				s = Array.from(i.values());
			return { appState: a, elements: s, storeAction: H.UPDATE };
		}
		return { storeAction: H.NONE };
	},
	SL = (e, t) => ({
		name: "undo",
		label: "buttons.undo",
		icon: uv,
		trackEvent: { category: "history" },
		viewMode: !1,
		perform: (r, o, i, a) => wL(a, o, () => e.undo(Fe(r), o, t.snapshot)),
		keyTest: (r) => r[R.CTRL_OR_CMD] && nf(r, R.Z) && !r.shiftKey,
		PanelComponent: ({ updateData: r, data: o }) => {
			let { isUndoStackEmpty: i } = l0(
				e.onHistoryChangedEmitter,
				new us(e.isUndoStackEmpty, e.isRedoStackEmpty),
			);
			return (0, s0.jsx)(Te, {
				type: "button",
				icon: uv,
				"aria-label": v("buttons.undo"),
				onClick: r,
				size: o?.size || "medium",
				disabled: i,
				"data-testid": "button-undo",
			});
		},
	}),
	TL = (e, t) => ({
		name: "redo",
		label: "buttons.redo",
		icon: pv,
		trackEvent: { category: "history" },
		viewMode: !1,
		perform: (r, o, i, a) => wL(a, o, () => e.redo(Fe(r), o, t.snapshot)),
		keyTest: (r) =>
			(r[R.CTRL_OR_CMD] && r.shiftKey && nf(r, R.Z)) ||
			(gp && r.ctrlKey && !r.shiftKey && nf(r, R.Y)),
		PanelComponent: ({ updateData: r, data: o }) => {
			let { isRedoStackEmpty: i } = l0(
				e.onHistoryChangedEmitter,
				new us(e.isUndoStackEmpty, e.isRedoStackEmpty),
			);
			return (0, s0.jsx)(Te, {
				type: "button",
				icon: pv,
				"aria-label": v("buttons.redo"),
				onClick: r,
				size: o?.size || "medium",
				disabled: i,
				"data-testid": "button-redo",
			});
		},
	});
b();
var d0 = w(M(), 1),
	c0 = (e, t, r, o, i, a) => {
		if (e.trackEvent)
			try {
				typeof e.trackEvent == "object" &&
					(!e.trackEvent.predicate || e.trackEvent.predicate(r, o, a)) &&
					We(
						e.trackEvent.category,
						e.trackEvent.action || e.name,
						`${t} (${i.device.editor.isMobile ? "mobile" : "desktop"})`,
					);
			} catch (s) {
				console.error("error while logging action:", s);
			}
	},
	Ch = class {
		actions = {};
		updater;
		getAppState;
		getElementsIncludingDeleted;
		app;
		constructor(t, r, o, i) {
			(this.updater = (a) => {
				if (Vs(a)) a.then((s) => t(s));
				else return t(a);
			}),
				(this.getAppState = r),
				(this.getElementsIncludingDeleted = o),
				(this.app = i);
		}
		registerAction(t) {
			this.actions[t.name] = t;
		}
		registerAll(t) {
			t.forEach((r) => this.registerAction(r));
		}
		handleKeyDown(t) {
			let r = this.app.props.UIOptions.canvasActions,
				o = Object.values(this.actions)
					.sort((d, u) => (u.keyPriority || 0) - (d.keyPriority || 0))
					.filter(
						(d) =>
							(d.name in r ? r[d.name] : !0) &&
							d.keyTest &&
							d.keyTest(
								t,
								this.getAppState(),
								this.getElementsIncludingDeleted(),
								this.app,
							),
					);
			if (o.length !== 1)
				return (
					o.length > 1 &&
						console.warn(
							"Canceling as multiple actions match this shortcut",
							o,
						),
					!1
				);
			let i = o[0];
			if (this.getAppState().viewModeEnabled && i.viewMode !== !0) return !1;
			let a = this.getElementsIncludingDeleted(),
				s = this.getAppState(),
				c = null;
			return (
				c0(i, "keyboard", s, a, this.app, null),
				t.preventDefault(),
				t.stopPropagation(),
				this.updater(o[0].perform(a, s, c, this.app)),
				!0
			);
		}
		executeAction(t, r = "api", o = null) {
			let i = this.getElementsIncludingDeleted(),
				a = this.getAppState();
			c0(t, r, a, i, this.app, o), this.updater(t.perform(i, a, o, this.app));
		}
		renderAction = (t, r) => {
			let o = this.app.props.UIOptions.canvasActions,
				i = (a) => {
					let s = a.PanelComponent;
					s.displayName = "PanelComponent";
					let c = this.getElementsIncludingDeleted(),
						d = this.getAppState(),
						u = (f) => {
							c0(a, "ui", d, c, this.app, f),
								this.updater(
									a.perform(
										this.getElementsIncludingDeleted(),
										this.getAppState(),
										f,
										this.app,
									),
								);
						};
					return (0, d0.jsx)(
						s,
						{
							elements: this.getElementsIncludingDeleted(),
							appState: this.getAppState(),
							updateData: u,
							appProps: this.app.props,
							app: this.app,
							data: r,
						},
						a.name,
					);
				};
			return this.actions[t] &&
				"PanelComponent" in this.actions[t] &&
				(!(t in o) || o[t])
				? i(this.actions[t])
				: t === "_custom"
					? Object.keys(this.actions)
							.filter((a) => this.actions[a].custom)
							.map((a) => {
								let s = this.actions[a];
								return (
									s.PanelComponent ||
										(s.PanelComponent = ({
											elements: c,
											appState: d,
											updateData: u,
										}) =>
											(0, d0.jsx)(
												Te,
												{
													type: "button",
													icon: s.icon,
													title: s.label,
													"aria-label": s.label,
													onClick: () => u(null),
													visible:
														typeof s.visible == "function"
															? s.visible(c, d)
															: s.visible,
												},
												s.name,
											)),
									i(s)
								);
							})
					: null;
		};
		isActionEnabled = (t) => {
			let r = this.getElementsIncludingDeleted(),
				o = this.getAppState();
			return !t.predicate || t.predicate(r, o, this.app.props, this.app);
		};
	};
b();
var m0 = (e) => {
		let t = Array.from(e.values());
		return { x: CL(t, (r) => r.x) / t.length, y: CL(t, (r) => r.y) / t.length };
	},
	u0 = ([e, t]) => Math.hypot(e.x - t.x, e.y - t.y),
	CL = (e, t) => e.reduce((r, o) => r + t(o), 0);
b();
var IL = w(Q(), 1),
	ea = w(M(), 1),
	Sr = "separator",
	_L = IL.default.memo(
		({ actionManager: e, items: t, top: r, left: o, onClose: i }) => {
			let a = pi(),
				s = Ha(),
				c = t.reduce(
					(d, u) => (
						u &&
							(u === Sr ||
								!u.predicate ||
								u.predicate(s, a, e.app.props, e.app)) &&
							d.push(u),
						d
					),
					[],
				);
			return (0, ea.jsx)(Mg, {
				onCloseRequest: () => {
					i();
				},
				top: r,
				left: o,
				fitInViewport: !0,
				offsetLeft: a.offsetLeft,
				offsetTop: a.offsetTop,
				viewportWidth: a.width,
				viewportHeight: a.height,
				children: (0, ea.jsx)("ul", {
					className: "context-menu",
					onContextMenu: (d) => d.preventDefault(),
					children: c.map((d, u) => {
						if (d === Sr)
							return !c[u - 1] || c[u - 1] === Sr
								? null
								: (0, ea.jsx)(
										"hr",
										{ className: "context-menu-item-separator" },
										u,
									);
						let f = d.name,
							m = "";
						return (
							d.label &&
								(typeof d.label == "function"
									? (m = v(d.label(s, a, e.app)))
									: (m = v(d.label))),
							(0, ea.jsx)(
								"li",
								{
									"data-testid": f,
									onClick: () => {
										i(() => {
											e.executeAction(d, "contextMenu");
										});
									},
									children: (0, ea.jsxs)("button", {
										type: "button",
										className: j("context-menu-item", {
											dangerous: f === "deleteSelectedElements",
											checkmark: d.checked?.(a),
										}),
										children: [
											(0, ea.jsx)("div", {
												className: "context-menu-item__label",
												children: m,
											}),
											(0, ea.jsx)("kbd", {
												className: "context-menu-item__shortcut",
												children: f ? tr(f) : "",
											}),
										],
									}),
								},
								u,
							)
						);
					}),
				}),
			});
		},
	);
b();
var bP = w(Q(), 1);
b();
var Ih = w(Q(), 1);
var md = w(M(), 1),
	AL = ({ children: e, onClose: t }) => {
		let [r, o] = (0, Ih.useState)(!!e),
			{ container: i } = dr(),
			a = Ih.default.useCallback(() => {
				o(!1), t && t(), i?.focus();
			}, [t, i]);
		return (0, md.jsx)(md.Fragment, {
			children:
				r &&
				(0, md.jsx)(er, {
					size: "small",
					onCloseRequest: a,
					title: v("errorDialog.title"),
					children: (0, md.jsx)("div", {
						style: { whiteSpace: "pre-wrap" },
						children: e,
					}),
				}),
		});
	};
b();
var Po = w(Q(), 1);
b();
var Jm = w(M(), 1),
	_h = function ({ onChange: e, value: t, choices: r, name: o }) {
		return (0, Jm.jsx)("div", {
			className: "RadioGroup",
			children: r.map((i) =>
				(0, Jm.jsxs)(
					"div",
					{
						className: j("RadioGroup__choice", { active: i.value === t }),
						title: i.ariaLabel,
						children: [
							(0, Jm.jsx)("input", {
								name: o,
								type: "radio",
								checked: i.value === t,
								onChange: () => e(i.value),
								"aria-label": i.ariaLabel,
							}),
							i.label,
						],
					},
					String(i.value),
				),
			),
		});
	};
b();
var p0 = w(M(), 1),
	eu = ({ title: e, name: t, checked: r, onChange: o, disabled: i = !1 }) =>
		(0, p0.jsx)("div", {
			className: j("Switch", { toggled: r, disabled: i }),
			children: (0, p0.jsx)("input", {
				name: t,
				id: t,
				title: e,
				type: "checkbox",
				checked: r,
				disabled: i,
				onChange: () => o(!r),
				onKeyDown: (a) => {
					a.key === " " && o(!r);
				},
			}),
		});
b();
var Ah = w(Q(), 1);
var ps = w(M(), 1),
	Za = (0, Ah.forwardRef)(
		(
			{
				children: e,
				icon: t,
				onClick: r,
				label: o,
				variant: i = "filled",
				color: a = "primary",
				size: s = "medium",
				fullWidth: c,
				className: d,
				status: u,
			},
			f,
		) => {
			let [m, g] = (0, Ah.useState)(!1),
				h = async (E) => {
					let T = r?.(E);
					if (Vs(T)) {
						let I = window.setTimeout(() => {
							g(!0);
						}, 50);
						try {
							await T;
						} catch (P) {
							if (P instanceof Qs) console.warn(P);
							else throw P;
						} finally {
							clearTimeout(I), g(!1);
						}
					}
				},
				y = m ? "loading" : u;
			return (
				(a = y === "success" ? "success" : a),
				(0, ps.jsx)("button", {
					className: j(
						"ExcButton",
						`ExcButton--color-${a}`,
						`ExcButton--variant-${i}`,
						`ExcButton--size-${s}`,
						`ExcButton--status-${y}`,
						{ "ExcButton--fullWidth": c },
						d,
					),
					onClick: h,
					type: "button",
					"aria-label": o,
					ref: f,
					disabled: y === "loading" || y === "success",
					children: (0, ps.jsxs)("div", {
						className: "ExcButton__contents",
						children: [
							y === "loading"
								? (0, ps.jsx)($r, { className: "ExcButton__statusIcon" })
								: y === "success" &&
									(0, ps.jsx)("div", {
										className: "ExcButton__statusIcon",
										children: E2,
									}),
							t &&
								(0, ps.jsx)("div", {
									className: "ExcButton__icon",
									"aria-hidden": !0,
									children: t,
								}),
							i !== "icon" && (e ?? o),
						],
					}),
				})
			);
		},
	);
b();
var ud = w(Q(), 1),
	Wz = 2e3,
	kL = () => {
		let [e, t] = (0, ud.useState)(null),
			r = (0, ud.useRef)(0),
			o = () => {
				clearTimeout(r.current),
					t("success"),
					(r.current = window.setTimeout(() => {
						t(null);
					}, Wz));
			},
			i = (0, ud.useCallback)(() => {
				t(null);
			}, []);
		return { copyStatus: e, resetCopyStatus: i, onCopy: o };
	};
var nt = w(M(), 1),
	Kz = "filter" in document.createElement("canvas").getContext("2d"),
	Yz = () =>
		(0, nt.jsxs)("div", {
			children: [
				(0, nt.jsx)("h3", { children: v("canvasError.cannotShowPreview") }),
				(0, nt.jsx)("p", {
					children: (0, nt.jsx)("span", {
						children: v("canvasError.canvasTooBig"),
					}),
				}),
				(0, nt.jsxs)("em", {
					children: ["(", v("canvasError.canvasTooBigTip"), ")"],
				}),
			],
		}),
	Vz = ({
		appStateSnapshot: e,
		elementsSnapshot: t,
		files: r,
		actionManager: o,
		onExportImage: i,
		name: a,
	}) => {
		let s = bt(t, e),
			[c, d] = (0, Po.useState)(a),
			[u, f] = (0, Po.useState)(s),
			[m, g] = (0, Po.useState)(e.exportBackground),
			[h, y] = (0, Po.useState)(e.exportWithDarkMode),
			[E, T] = (0, Po.useState)(e.exportEmbedScene),
			[I, P] = (0, Po.useState)(e.exportScale),
			C = (0, Po.useRef)(null),
			[k, N] = (0, Po.useState)(null),
			{ onCopy: D, copyStatus: B, resetCopyStatus: F } = kL();
		(0, Po.useEffect)(() => {
			F();
		}, [c, m, h, I, E, F]);
		let { exportedElements: W, exportingFrame: G } = es(t, e, u);
		return (
			(0, Po.useEffect)(() => {
				let q = C.current;
				if (!q) return;
				let ie = q.offsetWidth,
					te = q.offsetHeight;
				ie &&
					$l({
						elements: W,
						appState: {
							...e,
							name: c,
							exportBackground: m,
							exportWithDarkMode: h,
							exportScale: I,
							exportEmbedScene: E,
						},
						files: r,
						exportPadding: ba,
						maxWidthOrHeight: Math.max(ie, te),
						exportingFrame: G,
					})
						.then(
							(we) => (
								N(null),
								Hi(we)
									.then(() => {
										q.replaceChildren(we);
									})
									.catch((X) => {
										throw X.name === "CANVAS_POSSIBLY_TOO_BIG"
											? new Error(v("canvasError.canvasTooBig"))
											: X;
									})
							),
						)
						.catch((we) => {
							console.error(we), N(we);
						});
			}, [e, r, W, G, c, m, h, I, E]),
			(0, nt.jsxs)("div", {
				className: "ImageExportModal",
				children: [
					(0, nt.jsx)("h3", { children: v("imageExportDialog.header") }),
					(0, nt.jsxs)("div", {
						className: "ImageExportModal__preview",
						children: [
							(0, nt.jsx)("div", {
								className: "ImageExportModal__preview__canvas",
								ref: C,
								children: k && (0, nt.jsx)(Yz, {}),
							}),
							(0, nt.jsx)("div", {
								className: "ImageExportModal__preview__filename",
								children:
									!fc &&
									(0, nt.jsx)("input", {
										type: "text",
										className: "TextInput",
										value: c,
										style: { width: "30ch" },
										onChange: (q) => {
											d(q.target.value),
												o.executeAction(by, "ui", q.target.value);
										},
									}),
							}),
						],
					}),
					(0, nt.jsxs)("div", {
						className: "ImageExportModal__settings",
						children: [
							(0, nt.jsx)("h3", { children: v("imageExportDialog.header") }),
							s &&
								(0, nt.jsx)(tu, {
									label: v("imageExportDialog.label.onlySelected"),
									name: "exportOnlySelected",
									children: (0, nt.jsx)(eu, {
										name: "exportOnlySelected",
										checked: u,
										onChange: (q) => {
											f(q);
										},
									}),
								}),
							(0, nt.jsx)(tu, {
								label: v("imageExportDialog.label.withBackground"),
								name: "exportBackgroundSwitch",
								children: (0, nt.jsx)(eu, {
									name: "exportBackgroundSwitch",
									checked: m,
									onChange: (q) => {
										g(q), o.executeAction(xy, "ui", q);
									},
								}),
							}),
							Kz &&
								(0, nt.jsx)(tu, {
									label: v("imageExportDialog.label.darkMode"),
									name: "exportDarkModeSwitch",
									children: (0, nt.jsx)(eu, {
										name: "exportDarkModeSwitch",
										checked: h,
										onChange: (q) => {
											y(q), o.executeAction($5, "ui", q);
										},
									}),
								}),
							(0, nt.jsx)(tu, {
								label: v("imageExportDialog.label.embedScene"),
								tooltip: v("imageExportDialog.tooltip.embedScene"),
								name: "exportEmbedSwitch",
								children: (0, nt.jsx)(eu, {
									name: "exportEmbedSwitch",
									checked: E,
									onChange: (q) => {
										T(q), o.executeAction(Vg, "ui", q);
									},
								}),
							}),
							(0, nt.jsx)(tu, {
								label: v("imageExportDialog.label.scale"),
								name: "exportScale",
								children: (0, nt.jsx)(_h, {
									name: "exportScale",
									value: I,
									onChange: (q) => {
										P(q), o.executeAction(z5, "ui", q);
									},
									choices: wp.map((q) => ({ value: q, label: `${q}\xD7` })),
								}),
							}),
							(0, nt.jsxs)("div", {
								className: "ImageExportModal__settings__buttons",
								children: [
									(0, nt.jsx)(Za, {
										className: "ImageExportModal__settings__buttons__button",
										label: v("imageExportDialog.title.exportToPng"),
										onClick: () => i(vp.png, W, { exportingFrame: G }),
										icon: Av,
										children: v("imageExportDialog.button.exportToPng"),
									}),
									(0, nt.jsx)(Za, {
										className: "ImageExportModal__settings__buttons__button",
										label: v("imageExportDialog.title.exportToSvg"),
										onClick: () => i(vp.svg, W, { exportingFrame: G }),
										icon: Av,
										children: v("imageExportDialog.button.exportToSvg"),
									}),
									(gc || Pi) &&
										(0, nt.jsx)(Za, {
											className: "ImageExportModal__settings__buttons__button",
											label: v("imageExportDialog.title.copyPngToClipboard"),
											status: B,
											onClick: async () => {
												await i(vp.clipboard, W, { exportingFrame: G }), D();
											},
											icon: ac,
											children: v(
												"imageExportDialog.button.copyPngToClipboard",
											),
										}),
								],
							}),
						],
					}),
				],
			})
		);
	},
	tu = ({ label: e, children: t, tooltip: r, name: o }) =>
		(0, nt.jsxs)("div", {
			className: "ImageExportModal__settings__setting",
			title: e,
			children: [
				(0, nt.jsxs)("label", {
					htmlFor: o,
					className: "ImageExportModal__settings__setting__label",
					children: [
						e,
						r && (0, nt.jsx)(Xo, { label: r, long: !0, children: v2 }),
					],
				}),
				(0, nt.jsx)("div", {
					className: "ImageExportModal__settings__setting__content",
					children: t,
				}),
			],
		}),
	LL = ({
		elements: e,
		appState: t,
		files: r,
		actionManager: o,
		onExportImage: i,
		onCloseRequest: a,
		name: s,
	}) => {
		let [{ appStateSnapshot: c, elementsSnapshot: d }] = (0, Po.useState)(
			() => ({ appStateSnapshot: _o(t), elementsSnapshot: _o(e) }),
		);
		return (0, nt.jsx)(er, {
			onCloseRequest: a,
			size: "wide",
			title: !1,
			children: (0, nt.jsx)(Vz, {
				elementsSnapshot: d,
				appStateSnapshot: c,
				files: r,
				actionManager: o,
				onExportImage: i,
				name: s,
			}),
		});
	};
b();
var ML = w(M(), 1),
	kh = ({ children: e, side: t, className: r }) =>
		(0, ML.jsx)("div", {
			className: j("FixedSideContainer", `FixedSideContainer_side_${t}`, r),
			children: e,
		});
b();
b();
var pd = 100,
	fs = 100,
	h0 = (e) => {
		switch (e) {
			case R.ARROW_UP:
				return "up";
			case R.ARROW_DOWN:
				return "down";
			case R.ARROW_RIGHT:
				return "right";
			case R.ARROW_LEFT:
				return "left";
			default:
				return "right";
		}
	},
	PL = (e, t, r, o) => {
		let i = [...r.values()].reduce((a, s) => {
			let c;
			if (
				qe(s) &&
				(c = s[e === "predecessors" ? "startBinding" : "endBinding"]) &&
				s[e === "predecessors" ? "endBinding" : "startBinding"]?.elementId ===
					t.id
			) {
				let d = r.get(c.elementId);
				if (!d) return a;
				Jd(sv(d), "not an ExcalidrawBindableElement");
				let u = e === "predecessors" ? s.points[s.points.length - 1] : [0, 0],
					f = mI(t, aI(t), [u[0] + s.x, u[1] + s.y]);
				a.push({ relative: d, heading: f });
			}
			return a;
		}, []);
		switch (o) {
			case "up":
				return i.filter((a) => sm(a.heading, dI)).map((a) => a.relative);
			case "down":
				return i.filter((a) => sm(a.heading, sI)).map((a) => a.relative);
			case "right":
				return i.filter((a) => sm(a.heading, lI)).map((a) => a.relative);
			case "left":
				return i.filter((a) => sm(a.heading, cI)).map((a) => a.relative);
		}
	},
	f0 = (e, t, r) => PL("successors", e, t, r),
	g0 = (e, t, r) => PL("predecessors", e, t, r),
	Xz = (e, t, r) => {
		let o = fs + e.width;
		if (r === "up" || r === "down") {
			let c = pd + e.height,
				d = e.x,
				u = e.x + e.width;
			if (t.every((f) => f.x + f.width < d || f.x > u))
				return { x: 0, y: c * (r === "up" ? -1 : 1) };
		} else if (r === "right" || r === "left") {
			let c = e.y,
				d = e.y + e.height;
			if (t.every((u) => u.y + u.height < c || u.y > d))
				return { x: (fs + e.width) * (r === "left" ? -1 : 1), y: 0 };
		}
		if (r === "up" || r === "down") {
			let c = pd + e.height,
				d = (t.length === 0, c),
				u =
					t.length === 0
						? 0
						: (t.length + 1) % 2 === 0
							? ((t.length + 1) / 2) * o
							: (t.length / 2) * o * -1;
			return r === "up" ? { x: u, y: d * -1 } : { x: u, y: d };
		}
		let i = pd + e.height,
			a = (t.length === 0, fs + e.width),
			s =
				t.length === 0
					? 0
					: (t.length + 1) % 2 === 0
						? ((t.length + 1) / 2) * i
						: (t.length / 2) * i * -1;
		return r === "left" ? { x: a * -1, y: s } : { x: a, y: s };
	},
	Zz = (e, t, r, o) => {
		let i = f0(e, t, o),
			a = g0(e, t, o),
			s = Xz(e, [...i, ...a], o),
			c = $n({
				type: e.type,
				x: e.x + s.x,
				y: e.y + s.y,
				width: e.width,
				height: e.height,
				roundness: e.roundness,
				roughness: e.roughness,
				backgroundColor: e.backgroundColor,
				strokeColor: e.strokeColor,
				strokeWidth: e.strokeWidth,
			});
		Jd(kl(c), "not an ExcalidrawFlowchartNodeElement");
		let d = RL(e, c, t, o, r);
		return { nextNode: c, bindingArrow: d };
	},
	qz = (e, t, r, o, i) => {
		let a = [];
		for (let s = 0; s < i; s++) {
			let c, d;
			if (o === "left" || o === "right") {
				let m = pd * (i - 1) + i * e.height,
					g = e.y + e.height / 2 - m / 2,
					h = fs + e.width;
				o === "left" && (h *= -1), (c = e.x + h);
				let y = (pd + e.height) * s;
				d = g + y;
			} else {
				let m = fs * (i - 1) + i * e.width,
					g = e.x + e.width / 2 - m / 2,
					h = pd + e.height;
				o === "up" && (h *= -1), (d = e.y + h);
				let y = (fs + e.width) * s;
				c = g + y;
			}
			let u = $n({
				type: e.type,
				x: c,
				y: d,
				width: e.width,
				height: e.height,
				roundness: e.roundness,
				roughness: e.roughness,
				backgroundColor: e.backgroundColor,
				strokeColor: e.strokeColor,
				strokeWidth: e.strokeWidth,
			});
			Jd(kl(u), "not an ExcalidrawFlowchartNodeElement");
			let f = RL(e, u, t, o, r);
			a.push(u), a.push(f);
		}
		return a;
	},
	RL = (e, t, r, o, i) => {
		let a, s;
		switch (o) {
			case "up": {
				(a = e.x + e.width / 2), (s = e.y - 6);
				break;
			}
			case "down": {
				(a = e.x + e.width / 2), (s = e.y + e.height + 6);
				break;
			}
			case "right": {
				(a = e.x + e.width + 6), (s = e.y + e.height / 2);
				break;
			}
			case "left": {
				(a = e.x - 6), (s = e.y + e.height / 2);
				break;
			}
		}
		let d, u;
		switch (o) {
			case "up": {
				(d = t.x + t.width / 2 - a), (u = t.y + t.height - s + 6);
				break;
			}
			case "down": {
				(d = t.x + t.width / 2 - a), (u = t.y - s - 6);
				break;
			}
			case "right": {
				(d = t.x - a - 6), (u = t.y - s + t.height / 2);
				break;
			}
			case "left": {
				(d = t.x + t.width - a + 6), (u = t.y - s + t.height / 2);
				break;
			}
		}
		let f = cc({
			type: "arrow",
			x: a,
			y: s,
			startArrowhead: i.currentItemStartArrowhead,
			endArrowhead: i.currentItemEndArrowhead,
			strokeColor: i.currentItemStrokeColor,
			strokeStyle: i.currentItemStrokeStyle,
			strokeWidth: i.currentItemStrokeWidth,
			points: [pe(0, 0), pe(d, u)],
			elbowed: !0,
		});
		$i(f, e, "start", r), $i(f, t, "end", r);
		let m = new Map();
		return (
			m.set(e.id, e),
			m.set(t.id, t),
			m.set(f.id, f),
			De.movePoints(f, [{ index: 1, point: f.points[1] }], r, void 0, {
				changedElements: m,
			}),
			f
		);
	},
	Lh = class {
		isExploring = !1;
		sameLevelNodes = [];
		sameLevelIndex = 0;
		direction = null;
		visitedNodes = new Set();
		clear() {
			(this.isExploring = !1),
				(this.sameLevelNodes = []),
				(this.sameLevelIndex = 0),
				(this.direction = null),
				this.visitedNodes.clear();
		}
		exploreByDirection(t, r, o) {
			if (!sv(t)) return null;
			if (
				(o !== this.direction && this.clear(),
				this.visitedNodes.has(t.id) || this.visitedNodes.add(t.id),
				this.isExploring &&
					o === this.direction &&
					this.sameLevelNodes.length > 1)
			)
				return (
					(this.sameLevelIndex =
						(this.sameLevelIndex + 1) % this.sameLevelNodes.length),
					this.sameLevelNodes[this.sameLevelIndex].id
				);
			let i = [...f0(t, r, o), ...g0(t, r, o)];
			if (i.length > 0)
				return (
					(this.sameLevelIndex = 0),
					(this.isExploring = !0),
					(this.sameLevelNodes = i),
					(this.direction = o),
					this.visitedNodes.add(i[0].id),
					i[0].id
				);
			if (o === this.direction || !this.isExploring) {
				this.isExploring || this.visitedNodes.add(t.id);
				let s = ["up", "right", "down", "left"]
					.filter((c) => c !== o)
					.map((c) => [...f0(t, r, c), ...g0(t, r, c)])
					.flat()
					.filter((c) => !this.visitedNodes.has(c.id));
				for (let c of s)
					if (!this.visitedNodes.has(c.id))
						return (
							this.visitedNodes.add(c.id),
							(this.isExploring = !0),
							(this.direction = o),
							c.id
						);
			}
			return null;
		}
	},
	Mh = class {
		isCreatingChart = !1;
		numberOfNodes = 0;
		direction = "right";
		pendingNodes = null;
		createNodes(t, r, o, i) {
			if (i !== this.direction) {
				let { nextNode: a, bindingArrow: s } = Zz(t, r, o, i);
				(this.numberOfNodes = 1),
					(this.isCreatingChart = !0),
					(this.direction = i),
					(this.pendingNodes = [a, s]);
			} else {
				this.numberOfNodes += 1;
				let a = qz(t, r, o, i, this.numberOfNodes);
				(this.isCreatingChart = !0),
					(this.direction = i),
					(this.pendingNodes = a);
			}
			if (t.frameId) {
				let a = r.get(t.frameId);
				Jd(a && QT(a), "not an ExcalidrawFrameElement"),
					a &&
						this.pendingNodes.every((s) => XI([s], a, r) || kf(s, a, r)) &&
						(this.pendingNodes = this.pendingNodes.map((s) =>
							me(s, { frameId: t.frameId }, !1),
						));
			}
		}
		clear() {
			(this.isCreatingChart = !1),
				(this.pendingNodes = null),
				(this.direction = null),
				(this.numberOfNodes = 0);
		}
	},
	DL = (e, t) => {
		for (let [, r] of t)
			if (
				r.type === "arrow" &&
				(r.startBinding?.elementId === e.id || r.endBinding?.elementId === e.id)
			)
				return !0;
		return !1;
	};
var b0 = w(M(), 1),
	jz = ({ appState: e, isMobile: t, device: r, app: o }) => {
		let {
				activeTool: i,
				isResizing: a,
				isRotating: s,
				lastPointerDownWith: c,
			} = e,
			d = e.multiElement !== null;
		if (
			e.openSidebar?.name === Vr.name &&
			e.openSidebar.tab === Di &&
			e.searchMatches?.length
		)
			return v("hints.dismissSearch");
		if (e.openSidebar && !r.editor.canFitSidebar) return null;
		if (dn(e)) return v("hints.eraserRevert");
		if (i.type === "arrow" || i.type === "line")
			return d
				? v("hints.linearElementMulti")
				: i.type === "arrow"
					? v("hints.arrowTool", { arrowShortcut: V("A") })
					: v("hints.linearElement");
		if (i.type === "freedraw") return v("hints.freeDraw");
		if (i.type === "text") return v("hints.text");
		if (i.type === "embeddable") return v("hints.embeddable");
		if (e.activeTool.type === "image" && e.pendingImageElementId)
			return v("hints.placeImage");
		let u = o.scene.getSelectedElements(e);
		if (a && c === "mouse" && u.length === 1) {
			let f = u[0];
			return at(f) && f.points.length === 2
				? v("hints.lockAngle")
				: ct(f)
					? v("hints.resizeImage")
					: v("hints.resize");
		}
		if (s && c === "mouse") return v("hints.rotate");
		if (u.length === 1 && Ee(u[0])) return v("hints.text_selected");
		if (e.editingTextElement) return v("hints.text_editing");
		if (e.croppingElementId) return v("hints.leaveCropEditor");
		if (u.length === 1 && ct(u[0])) return v("hints.enterCropEditor");
		if (i.type === "selection") {
			if (
				e.selectionElement &&
				!u.length &&
				!e.editingTextElement &&
				!e.editingLinearElement
			)
				return v("hints.deepBoxSelect");
			if (Hl(o) && e.selectedElementsAreBeingDragged)
				return v("hints.disableSnapping");
			if (!u.length && !t) return v("hints.canvasPanning");
			if (u.length === 1) {
				if (at(u[0]))
					return e.editingLinearElement
						? e.editingLinearElement.selectedPointsIndices
							? v("hints.lineEditor_pointSelected")
							: v("hints.lineEditor_nothingSelected")
						: v("hints.lineEditor_info");
				if (!e.newElement && !e.selectedElementsAreBeingDragged && Oi(u[0]))
					return kl(u[0])
						? DL(u[0], o.scene.getNonDeletedElementsMap())
							? [v("hints.bindTextToElement"), v("hints.createFlowchart")]
							: [v("hints.bindTextToElement"), v("hints.createFlowchart")]
						: v("hints.bindTextToElement");
			}
		}
		return null;
	},
	Ph = ({ appState: e, isMobile: t, device: r, app: o }) => {
		let i = jz({ appState: e, isMobile: t, device: r, app: o });
		if (!i) return null;
		let a = Array.isArray(i)
			? i.map((s) => V(s).replace(/\. ?$/, "")).join(". ")
			: V(i);
		return (0, b0.jsx)("div", {
			className: "HintViewer",
			children: (0, b0.jsx)("span", { children: a }),
		});
	};
b();
var ru = w(M(), 1),
	Qz = "medium",
	NL = { CHECKED: oc, UNCHECKED: Ll },
	Rh = (e) =>
		(0, ru.jsxs)("label", {
			className: j("ToolIcon ToolIcon__lock", `ToolIcon_size_${Qz}`, {
				"is-mobile": e.isMobile,
			}),
			title: `${e.title} \u2014 Q`,
			children: [
				(0, ru.jsx)("input", {
					className: "ToolIcon_type_checkbox",
					type: "checkbox",
					name: e.name,
					onChange: e.onChange,
					checked: e.checked,
					"aria-label": e.title,
					"data-testid": "toolbar-lock",
				}),
				(0, ru.jsx)("div", {
					className: "ToolIcon__icon",
					children: e.checked ? NL.CHECKED : NL.UNCHECKED,
				}),
			],
		});
b();
b();
var gs = w(M(), 1),
	qa = ({ heading: e, children: t, ...r }) => {
		let { id: o } = dr(),
			i = (0, gs.jsx)("h2", {
				className: "visually-hidden",
				id: `${o}-${e}-title`,
				children: v(`headings.${e}`),
			});
		return (0, gs.jsx)("section", {
			...r,
			"aria-labelledby": `${o}-${e}-title`,
			children:
				typeof t == "function"
					? t(i)
					: (0, gs.jsxs)(gs.Fragment, { children: [i, t] }),
		});
	};
b();
var Zn = 4,
	xi = 6,
	OL = "rgba(0,0,0,0.3)",
	FL = (e, t, r, o) => {
		if (!e.length) return { horizontal: null, vertical: null };
		let [i, a, s, c] = yt(e),
			d = t / o.zoom.value,
			u = r / o.zoom.value,
			f = t - d,
			m = r - u,
			g = {
				top: parseInt(qd("sat")) || 0,
				bottom: parseInt(qd("sab")) || 0,
				left: parseInt(qd("sal")) || 0,
				right: parseInt(qd("sar")) || 0,
			},
			h = ci().rtl,
			y = -o.scrollX + f / 2 + g.left,
			E = -o.scrollY + m / 2 + g.top,
			T = y + d - g.right,
			I = E + u - g.bottom,
			P = Math.min(i, y),
			C = Math.min(a, E),
			k = Math.max(s, T),
			N = Math.max(c, I);
		return {
			horizontal:
				y === P && T === k
					? null
					: {
							x: Math.max(g.left, Zn) + ((y - P) / (k - P)) * t,
							y: r - xi - Math.max(Zn, g.bottom),
							width:
								((T - y) / (k - P)) * t - Math.max(Zn * 2, g.left + g.right),
							height: xi,
						},
			vertical:
				E === C && I === N
					? null
					: {
							x: h ? Math.max(g.left, Zn) : t - xi - Math.max(g.right, Zn),
							y: ((E - C) / (N - C)) * r + Math.max(g.top, Zn),
							width: xi,
							height:
								((I - E) / (N - C)) * r - Math.max(Zn * 2, g.top + g.bottom),
						},
		};
	},
	x0 = (e, t, r) => {
		let [o, i] = [e.horizontal, e.vertical].map(
			(s) =>
				s != null &&
				s.x <= t &&
				t <= s.x + s.width &&
				s.y <= r &&
				r <= s.y + s.height,
		);
		return { isOverEither: o || i, isOverHorizontal: o, isOverVertical: i };
	};
b();
var ou = w(M(), 1),
	Jz = "medium",
	Dh = (e) =>
		e.penDetected
			? (0, ou.jsxs)("label", {
					className: j("ToolIcon ToolIcon__penMode", `ToolIcon_size_${Jz}`, {
						"is-mobile": e.isMobile,
					}),
					title: `${e.title}`,
					children: [
						(0, ou.jsx)("input", {
							className: "ToolIcon_type_checkbox",
							type: "checkbox",
							name: e.name,
							onChange: e.onChange,
							checked: e.checked,
							"aria-label": e.title,
						}),
						(0, ou.jsx)("div", { className: "ToolIcon__icon", children: wC }),
					],
				})
			: null;
b();
var BL = w(M(), 1),
	Nh = (e) =>
		(0, BL.jsx)(Te, {
			className: j("Shape", { fillable: !1 }),
			type: "radio",
			icon: Wp,
			name: "editor-current-shape",
			checked: e.checked,
			title: `${e.title} \u2014 H`,
			keyBindingLabel: e.isMobile ? void 0 : R.H.toLocaleUpperCase(),
			"aria-label": `${e.title} \u2014 H`,
			"aria-keyshortcuts": R.H,
			"data-testid": "toolbar-hand",
			onChange: () => e.onChange?.(),
		});
var Et = w(M(), 1),
	zL = ({
		appState: e,
		elements: t,
		actionManager: r,
		setAppState: o,
		onLockToggle: i,
		onHandToolToggle: a,
		onPenModeToggle: s,
		renderTopRightUI: c,
		renderCustomStats: d,
		renderSidebars: u,
		device: f,
		renderWelcomeScreen: m,
		UIOptions: g,
		app: h,
	}) => {
		let {
				WelcomeScreenCenterTunnel: y,
				MainMenuTunnel: E,
				DefaultSidebarTriggerTunnel: T,
			} = Mt(),
			I = () =>
				(0, Et.jsxs)(kh, {
					side: "top",
					className: "App-top-bar",
					children: [
						m && (0, Et.jsx)(y.Out, {}),
						(0, Et.jsx)(qa, {
							heading: "shapes",
							children: (C) =>
								(0, Et.jsx)(Pr.Col, {
									gap: 4,
									align: "center",
									children: (0, Et.jsxs)(Pr.Row, {
										gap: 1,
										className: "App-toolbar-container",
										children: [
											(0, Et.jsxs)(yr, {
												padding: 1,
												className: "App-toolbar App-toolbar--mobile",
												children: [
													C,
													(0, Et.jsx)(Pr.Row, {
														gap: 1,
														children: (0, Et.jsx)(Eh, {
															appState: e,
															activeTool: e.activeTool,
															UIOptions: g,
															app: h,
														}),
													}),
												],
											}),
											c && c(!0, e),
											(0, Et.jsxs)("div", {
												className: "mobile-misc-tools-container",
												children: [
													!e.viewModeEnabled &&
														e.openDialog?.name !== "elementLinkSelector" &&
														(0, Et.jsx)(T.Out, {}),
													(0, Et.jsx)(Dh, {
														checked: e.penMode,
														onChange: () => s(null),
														title: v("toolBar.penMode"),
														isMobile: !0,
														penDetected: e.penDetected,
													}),
													(0, Et.jsx)(Rh, {
														checked: e.activeTool.locked,
														onChange: i,
														title: v("toolBar.lock"),
														isMobile: !0,
													}),
													(0, Et.jsx)(Nh, {
														checked: Fi(e),
														onChange: () => a(),
														title: v("toolBar.hand"),
														isMobile: !0,
													}),
												],
											}),
										],
									}),
								}),
						}),
						(0, Et.jsx)(Ph, { appState: e, isMobile: !0, device: f, app: h }),
					],
				}),
			P = () =>
				e.viewModeEnabled || e.openDialog?.name === "elementLinkSelector"
					? (0, Et.jsx)("div", {
							className: "App-toolbar-content",
							children: (0, Et.jsx)(E.Out, {}),
						})
					: (0, Et.jsxs)("div", {
							className: "App-toolbar-content",
							children: [
								(0, Et.jsx)(E.Out, {}),
								r.renderAction("toggleEditMenu"),
								r.renderAction("undo"),
								r.renderAction("redo"),
								r.renderAction(
									e.multiElement ? "finalize" : "duplicateSelection",
								),
								r.renderAction("deleteSelectedElements"),
							],
						});
		return (0, Et.jsxs)(Et.Fragment, {
			children: [
				u(),
				!e.viewModeEnabled &&
					e.openDialog?.name !== "elementLinkSelector" &&
					I(),
				(0, Et.jsx)("div", {
					className: "App-bottom-bar",
					style: {
						marginBottom: xi + Zn * 2,
						marginLeft: xi + Zn * 2,
						marginRight: xi + Zn * 2,
					},
					children: (0, Et.jsxs)(yr, {
						padding: 0,
						children: [
							e.openMenu === "shape" &&
							!e.viewModeEnabled &&
							e.openDialog?.name !== "elementLinkSelector" &&
							yc(e, t)
								? (0, Et.jsx)(qa, {
										className: "App-mobile-menu",
										heading: "selectedShapeActions",
										children: (0, Et.jsx)(vh, {
											appState: e,
											elementsMap: h.scene.getNonDeletedElementsMap(),
											renderAction: r.renderAction,
										}),
									})
								: null,
							(0, Et.jsxs)("footer", {
								className: "App-toolbar",
								children: [
									P(),
									e.scrolledOutside &&
										!e.openMenu &&
										!e.openSidebar &&
										(0, Et.jsx)("button", {
											type: "button",
											className: "scroll-back-to-content",
											onClick: () => {
												o((C) => ({ ...Kl(t, C) }));
											},
											children: v("buttons.scrollBackToContent"),
										}),
								],
							}),
						],
					}),
				}),
			],
		});
	};
b();
var Qa = w(Q(), 1);
var ja = w(M(), 1),
	$L = (e) => {
		let t = (0, Qa.useRef)(null),
			[r, o] = (0, Qa.useState)(null);
		return (
			(0, Qa.useLayoutEffect)(() => {
				if (!e.spreadsheet) return;
				let i = GI(e.chartType, e.spreadsheet, 0, 0);
				o(i);
				let a,
					s = t.current;
				return (
					(async () => (
						(a = await If(
							i,
							{ exportBackground: !1, viewBackgroundColor: Yr.white },
							null,
							{ skipInliningFonts: !0 },
						)),
						a.querySelector(".style-fonts")?.remove(),
						s.replaceChildren(),
						s.appendChild(a),
						e.selected && s.parentNode.focus()
					))(),
					() => {
						s.replaceChildren();
					}
				);
			}, [e.spreadsheet, e.chartType, e.selected]),
			(0, ja.jsx)("button", {
				type: "button",
				className: "ChartPreview",
				onClick: () => {
					r && e.onClick(e.chartType, r);
				},
				children: (0, ja.jsx)("div", { ref: t }),
			})
		);
	},
	HL = ({ setAppState: e, appState: t, onClose: r }) => {
		let { onInsertElements: o } = Jt(),
			i = Qa.default.useCallback(() => {
				r && r();
			}, [r]),
			a = (s, c) => {
				o(c),
					We("paste", "chart", s),
					e({ currentChartType: s, pasteDialog: { shown: !1, data: null } });
			};
		return (0, ja.jsx)(er, {
			size: "small",
			onCloseRequest: i,
			title: v("labels.pasteCharts"),
			className: "PasteChartDialog",
			autofocus: !1,
			children: (0, ja.jsxs)("div", {
				className: "container",
				children: [
					(0, ja.jsx)($L, {
						chartType: "bar",
						spreadsheet: t.pasteDialog.data,
						selected: t.currentChartType === "bar",
						onClick: a,
					}),
					(0, ja.jsx)($L, {
						chartType: "line",
						spreadsheet: t.pasteDialog.data,
						selected: t.currentChartType === "line",
						onClick: a,
					}),
				],
			}),
		});
	};
b();
var UL = w(Q(), 1);
var ae = w(M(), 1),
	e$ = () =>
		(0, ae.jsxs)("div", {
			className: "HelpDialog__header",
			children: [
				(0, ae.jsxs)("a", {
					className: "HelpDialog__btn",
					href: "https://docs.excalidraw.com",
					target: "_blank",
					rel: "noopener noreferrer",
					children: [
						(0, ae.jsx)("div", {
							className: "HelpDialog__link-icon",
							children: mv,
						}),
						v("helpDialog.documentation"),
					],
				}),
				(0, ae.jsxs)("a", {
					className: "HelpDialog__btn",
					href: "https://plus.excalidraw.com/blog",
					target: "_blank",
					rel: "noopener noreferrer",
					children: [
						(0, ae.jsx)("div", {
							className: "HelpDialog__link-icon",
							children: mv,
						}),
						v("helpDialog.blog"),
					],
				}),
				(0, ae.jsxs)("a", {
					className: "HelpDialog__btn",
					href: "https://github.com/excalidraw/excalidraw/issues",
					target: "_blank",
					rel: "noopener noreferrer",
					children: [
						(0, ae.jsx)("div", {
							className: "HelpDialog__link-icon",
							children: Bp,
						}),
						v("helpDialog.github"),
					],
				}),
				(0, ae.jsxs)("a", {
					className: "HelpDialog__btn",
					href: "https://youtube.com/@excalidraw",
					target: "_blank",
					rel: "noopener noreferrer",
					children: [
						(0, ae.jsx)("div", {
							className: "HelpDialog__link-icon",
							children: $2,
						}),
						"YouTube",
					],
				}),
			],
		}),
	t$ = (e) =>
		(0, ae.jsxs)(ae.Fragment, {
			children: [
				(0, ae.jsx)("h3", { children: e.title }),
				(0, ae.jsx)("div", {
					className: "HelpDialog__islands-container",
					children: e.children,
				}),
			],
		}),
	v0 = (e) =>
		(0, ae.jsxs)("div", {
			className: `HelpDialog__island ${e.className}`,
			children: [
				(0, ae.jsx)("h4", {
					className: "HelpDialog__island-title",
					children: e.caption,
				}),
				(0, ae.jsx)("div", {
					className: "HelpDialog__island-content",
					children: e.children,
				}),
			],
		});
function* r$(e, t) {
	let r = !0;
	for (let o of e) r || (yield t), (r = !1), yield o;
}
var o$ = (e) => e.replace(/\b[a-z]\b/, (t) => t.toUpperCase()),
	he = ({ label: e, shortcuts: t, isOr: r = !0 }) => {
		let o = t.map((i) =>
			(i.endsWith("++")
				? [...i.slice(0, -2).split("+"), "+"]
				: i.split("+")
			).map((s) => (0, ae.jsx)(n$, { children: o$(s) }, s)),
		);
		return (0, ae.jsxs)("div", {
			className: "HelpDialog__shortcut",
			children: [
				(0, ae.jsx)("div", { children: e }),
				(0, ae.jsx)("div", {
					className: "HelpDialog__key-container",
					children: [...r$(o, r ? v("helpDialog.or") : null)],
				}),
			],
		});
	},
	n$ = (e) => (0, ae.jsx)("kbd", { className: "HelpDialog__key", ...e }),
	GL = ({ onClose: e }) => {
		let t = UL.default.useCallback(() => {
			e && e();
		}, [e]);
		return (0, ae.jsx)(ae.Fragment, {
			children: (0, ae.jsxs)(er, {
				onCloseRequest: t,
				title: v("helpDialog.title"),
				className: "HelpDialog",
				children: [
					(0, ae.jsx)(e$, {}),
					(0, ae.jsxs)(t$, {
						title: v("helpDialog.shortcuts"),
						children: [
							(0, ae.jsxs)(v0, {
								className: "HelpDialog__island--tools",
								caption: v("helpDialog.tools"),
								children: [
									(0, ae.jsx)(he, {
										label: v("toolBar.hand"),
										shortcuts: [R.H],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.selection"),
										shortcuts: [R.V, R[1]],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.rectangle"),
										shortcuts: [R.R, R[2]],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.diamond"),
										shortcuts: [R.D, R[3]],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.ellipse"),
										shortcuts: [R.O, R[4]],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.arrow"),
										shortcuts: [R.A, R[5]],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.line"),
										shortcuts: [R.L, R[6]],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.freedraw"),
										shortcuts: [R.P, R[7]],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.text"),
										shortcuts: [R.T, R[8]],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.image"),
										shortcuts: [R[9]],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.eraser"),
										shortcuts: [R.E, R[0]],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.frame"),
										shortcuts: [R.F],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.laser"),
										shortcuts: [R.K],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.eyeDropper"),
										shortcuts: [R.I, "Shift+S", "Shift+G"],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.editLineArrowPoints"),
										shortcuts: [V("CtrlOrCmd+Enter")],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.editText"),
										shortcuts: [V("Enter")],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.textNewLine"),
										shortcuts: [V("Enter"), V("Shift+Enter")],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.textFinish"),
										shortcuts: [V("Esc"), V("CtrlOrCmd+Enter")],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.curvedArrow"),
										shortcuts: [
											"A",
											v("helpDialog.click"),
											v("helpDialog.click"),
											v("helpDialog.click"),
										],
										isOr: !1,
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.curvedLine"),
										shortcuts: [
											"L",
											v("helpDialog.click"),
											v("helpDialog.click"),
											v("helpDialog.click"),
										],
										isOr: !1,
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.cropStart"),
										shortcuts: [v("helpDialog.doubleClick"), V("Enter")],
										isOr: !0,
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.cropFinish"),
										shortcuts: [V("Enter"), V("Escape")],
										isOr: !0,
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.lock"),
										shortcuts: [R.Q],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.preventBinding"),
										shortcuts: [V("CtrlOrCmd")],
									}),
									(0, ae.jsx)(he, {
										label: v("toolBar.link"),
										shortcuts: [V("CtrlOrCmd+K")],
									}),
								],
							}),
							(0, ae.jsxs)(v0, {
								className: "HelpDialog__island--view",
								caption: v("helpDialog.view"),
								children: [
									(0, ae.jsx)(he, {
										label: v("buttons.zoomIn"),
										shortcuts: [V("CtrlOrCmd++")],
									}),
									(0, ae.jsx)(he, {
										label: v("buttons.zoomOut"),
										shortcuts: [V("CtrlOrCmd+-")],
									}),
									(0, ae.jsx)(he, {
										label: v("buttons.resetZoom"),
										shortcuts: [V("CtrlOrCmd+0")],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.zoomToFit"),
										shortcuts: ["Shift+1"],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.zoomToSelection"),
										shortcuts: ["Shift+2"],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.movePageUpDown"),
										shortcuts: ["PgUp/PgDn"],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.movePageLeftRight"),
										shortcuts: ["Shift+PgUp/PgDn"],
									}),
									(0, ae.jsx)(he, {
										label: v("buttons.zenMode"),
										shortcuts: [V("Alt+Z")],
									}),
									(0, ae.jsx)(he, {
										label: v("buttons.objectsSnapMode"),
										shortcuts: [V("Alt+S")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.toggleGrid"),
										shortcuts: [V("CtrlOrCmd+'")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.viewMode"),
										shortcuts: [V("Alt+R")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.toggleTheme"),
										shortcuts: [V("Alt+Shift+D")],
									}),
									(0, ae.jsx)(he, {
										label: v("stats.fullTitle"),
										shortcuts: [V("Alt+/")],
									}),
									(0, ae.jsx)(he, {
										label: v("search.title"),
										shortcuts: [tr("searchMenu")],
									}),
									(0, ae.jsx)(he, {
										label: v("commandPalette.title"),
										shortcuts: Pi
											? [tr("commandPalette")]
											: [tr("commandPalette"), tr("commandPalette", 1)],
									}),
								],
							}),
							(0, ae.jsxs)(v0, {
								className: "HelpDialog__island--editor",
								caption: v("helpDialog.editor"),
								children: [
									(0, ae.jsx)(he, {
										label: v("helpDialog.createFlowchart"),
										shortcuts: [V("CtrlOrCmd+Arrow Key")],
										isOr: !0,
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.navigateFlowchart"),
										shortcuts: [V("Alt+Arrow Key")],
										isOr: !0,
									}),
									(0, ae.jsx)(he, {
										label: v("labels.moveCanvas"),
										shortcuts: [
											V(`Space+${v("helpDialog.drag")}`),
											V(`Wheel+${v("helpDialog.drag")}`),
										],
										isOr: !0,
									}),
									(0, ae.jsx)(he, {
										label: v("buttons.clearReset"),
										shortcuts: [V("CtrlOrCmd+Delete")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.delete"),
										shortcuts: [V("Delete")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.cut"),
										shortcuts: [V("CtrlOrCmd+X")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.copy"),
										shortcuts: [V("CtrlOrCmd+C")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.paste"),
										shortcuts: [V("CtrlOrCmd+V")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.pasteAsPlaintext"),
										shortcuts: [V("CtrlOrCmd+Shift+V")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.selectAll"),
										shortcuts: [V("CtrlOrCmd+A")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.multiSelect"),
										shortcuts: [V(`Shift+${v("helpDialog.click")}`)],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.deepSelect"),
										shortcuts: [V(`CtrlOrCmd+${v("helpDialog.click")}`)],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.deepBoxSelect"),
										shortcuts: [V(`CtrlOrCmd+${v("helpDialog.drag")}`)],
									}),
									(gc || Pi) &&
										(0, ae.jsx)(he, {
											label: v("labels.copyAsPng"),
											shortcuts: [V("Shift+Alt+C")],
										}),
									(0, ae.jsx)(he, {
										label: v("labels.copyStyles"),
										shortcuts: [V("CtrlOrCmd+Alt+C")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.pasteStyles"),
										shortcuts: [V("CtrlOrCmd+Alt+V")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.sendToBack"),
										shortcuts: [
											Dn ? V("CtrlOrCmd+Alt+[") : V("CtrlOrCmd+Shift+["),
										],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.bringToFront"),
										shortcuts: [
											Dn ? V("CtrlOrCmd+Alt+]") : V("CtrlOrCmd+Shift+]"),
										],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.sendBackward"),
										shortcuts: [V("CtrlOrCmd+[")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.bringForward"),
										shortcuts: [V("CtrlOrCmd+]")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.alignTop"),
										shortcuts: [V("CtrlOrCmd+Shift+Up")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.alignBottom"),
										shortcuts: [V("CtrlOrCmd+Shift+Down")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.alignLeft"),
										shortcuts: [V("CtrlOrCmd+Shift+Left")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.alignRight"),
										shortcuts: [V("CtrlOrCmd+Shift+Right")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.duplicateSelection"),
										shortcuts: [
											V("CtrlOrCmd+D"),
											V(`Alt+${v("helpDialog.drag")}`),
										],
									}),
									(0, ae.jsx)(he, {
										label: v("helpDialog.toggleElementLock"),
										shortcuts: [V("CtrlOrCmd+Shift+L")],
									}),
									(0, ae.jsx)(he, {
										label: v("buttons.undo"),
										shortcuts: [V("CtrlOrCmd+Z")],
									}),
									(0, ae.jsx)(he, {
										label: v("buttons.redo"),
										shortcuts: gp
											? [V("CtrlOrCmd+Y"), V("CtrlOrCmd+Shift+Z")]
											: [V("CtrlOrCmd+Shift+Z")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.group"),
										shortcuts: [V("CtrlOrCmd+G")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.ungroup"),
										shortcuts: [V("CtrlOrCmd+Shift+G")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.flipHorizontal"),
										shortcuts: [V("Shift+H")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.flipVertical"),
										shortcuts: [V("Shift+V")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.showStroke"),
										shortcuts: [V("S")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.showBackground"),
										shortcuts: [V("G")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.showFonts"),
										shortcuts: [V("Shift+F")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.decreaseFontSize"),
										shortcuts: [V("CtrlOrCmd+Shift+<")],
									}),
									(0, ae.jsx)(he, {
										label: v("labels.increaseFontSize"),
										shortcuts: [V("CtrlOrCmd+Shift+>")],
									}),
								],
							}),
						],
					}),
				],
			}),
		});
	};
b();
var hs = w(Q(), 1);
var Rr = w(M(), 1),
	i$ = 4,
	a$ = 8,
	l$ = ({ shouldWrap: e, children: t, username: r }) =>
		e
			? (0, Rr.jsx)(Xo, { label: r || "Unknown user", children: t })
			: (0, Rr.jsx)(Rr.Fragment, { children: t }),
	E0 = ({
		actionManager: e,
		collaborator: t,
		socketId: r,
		withName: o = !1,
		shouldWrapWithTooltip: i = !1,
		isBeingFollowed: a,
	}) => {
		let s = { socketId: r, collaborator: t, withName: o, isBeingFollowed: a },
			c = e.renderAction("goToCollaborator", s);
		return (0, Rr.jsx)(
			l$,
			{ username: t.username, shouldWrap: i, children: c },
			r,
		);
	},
	s$ = [
		"avatarUrl",
		"id",
		"socketId",
		"username",
		"isInCall",
		"isSpeaking",
		"isMuted",
	],
	Oh = hs.default.memo(
		({ className: e, mobile: t, collaborators: r, userToFollow: o }) => {
			let i = pr(),
				a = new Map();
			r.forEach((E, T) => {
				let I = E.id || T;
				a.set(I, { ...E, socketId: T });
			});
			let s = Array.from(a.values()).filter((E) => E.username?.trim()),
				[c, d] = hs.default.useState(""),
				u = s.filter((E) => E.username?.toLowerCase().includes(c)),
				f = hs.default.useRef(null);
			(0, hs.useLayoutEffect)(() => {
				if (f.current) {
					let E = (I) => {
						let P = Math.max(1, Math.min(8, Math.floor(I / 38)));
						g(P);
					};
					if ((E(f.current.clientWidth), !Gd)) return;
					let T = new ResizeObserver((I) => {
						for (let P of I) {
							let { width: C } = P.contentRect;
							E(C);
						}
					});
					return (
						T.observe(f.current),
						() => {
							T.disconnect();
						}
					);
				}
			}, []);
			let [m, g] = hs.default.useState(i$),
				y = s
					.slice(0, m - 1)
					.map((E) =>
						E0({
							actionManager: i,
							collaborator: E,
							socketId: E.socketId,
							shouldWrapWithTooltip: !0,
							isBeingFollowed: E.socketId === o,
						}),
					);
			return t
				? (0, Rr.jsx)("div", {
						className: j("UserList UserList_mobile", e),
						children: s.map((E) =>
							E0({
								actionManager: i,
								collaborator: E,
								socketId: E.socketId,
								shouldWrapWithTooltip: !0,
								isBeingFollowed: E.socketId === o,
							}),
						),
					})
				: (0, Rr.jsx)("div", {
						className: "UserList__wrapper",
						ref: f,
						children: (0, Rr.jsxs)("div", {
							className: j("UserList", e),
							style: { "--max-avatars": m },
							children: [
								y,
								s.length > m - 1 &&
									(0, Rr.jsxs)(Gc, {
										children: [
											(0, Rr.jsxs)(Wc, {
												className: "UserList__more",
												children: ["+", s.length - m + 1],
											}),
											(0, Rr.jsx)(Ig, {
												style: { zIndex: 2, width: "15rem", textAlign: "left" },
												align: "end",
												sideOffset: 10,
												children: (0, Rr.jsxs)(yr, {
													padding: 2,
													children: [
														s.length >= a$ &&
															(0, Rr.jsx)(Pg, {
																placeholder: v("quickSearch.placeholder"),
																onChange: d,
															}),
														(0, Rr.jsx)(Dg, {
															className:
																"dropdown-menu UserList__collaborators",
															placeholder: v("userList.empty"),
															children:
																u.length > 0
																	? [
																			(0, Rr.jsx)("div", {
																				className: "hint",
																				children: v("userList.hint.text"),
																			}),
																			u.map((E) =>
																				E0({
																					actionManager: i,
																					collaborator: E,
																					socketId: E.socketId,
																					withName: !0,
																					isBeingFollowed: E.socketId === o,
																				}),
																			),
																		]
																	: [],
														}),
														(0, Rr.jsx)(_g, {
															width: 20,
															height: 10,
															style: {
																fill: "var(--popup-bg-color)",
																filter:
																	"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)",
															},
														}),
													],
												}),
											}),
										],
									}),
							],
						}),
					});
		},
		(e, t) => {
			if (
				e.collaborators.size !== t.collaborators.size ||
				e.mobile !== t.mobile ||
				e.className !== t.className ||
				e.userToFollow !== t.userToFollow
			)
				return !1;
			let r = t.collaborators.keys();
			for (let [o, i] of e.collaborators) {
				let a = t.collaborators.get(o);
				if (!a || o !== r.next().value || !Er(i, a, s$)) return !1;
			}
			return !0;
		},
	);
b();
var KL = w(Q(), 1);
b();
var WL = w(M(), 1),
	y0 = ({ children: e, color: t }) =>
		(0, WL.jsx)("div", {
			className: "Card",
			style: {
				"--card-color": t === "primary" ? "var(--color-primary)" : Yr[t][7],
				"--card-color-darker":
					t === "primary" ? "var(--color-primary-darker)" : Yr[t][8],
				"--card-color-darkest":
					t === "primary" ? "var(--color-primary-darkest)" : Yr[t][9],
			},
			children: e,
		});
var Tr = w(M(), 1),
	c$ = ({
		elements: e,
		appState: t,
		setAppState: r,
		files: o,
		actionManager: i,
		exportOpts: a,
		canvas: s,
		onCloseRequest: c,
	}) => {
		let { onExportToBackend: d } = a;
		return (0, Tr.jsx)("div", {
			className: "ExportDialog ExportDialog--json",
			children: (0, Tr.jsxs)("div", {
				className: "ExportDialog-cards",
				children: [
					a.saveFileToDisk &&
						(0, Tr.jsxs)(y0, {
							color: "lime",
							children: [
								(0, Tr.jsx)("div", { className: "Card-icon", children: RC }),
								(0, Tr.jsx)("h2", { children: v("exportDialog.disk_title") }),
								(0, Tr.jsxs)("div", {
									className: "Card-details",
									children: [
										v("exportDialog.disk_details"),
										!fc && i.renderAction("changeProjectName"),
									],
								}),
								(0, Tr.jsx)(Te, {
									className: "Card-button",
									type: "button",
									title: v("exportDialog.disk_button"),
									"aria-label": v("exportDialog.disk_button"),
									showAriaLabel: !0,
									onClick: () => {
										i.executeAction(Hm, "ui");
									},
								}),
							],
						}),
					d &&
						(0, Tr.jsxs)(y0, {
							color: "pink",
							children: [
								(0, Tr.jsx)("div", { className: "Card-icon", children: im }),
								(0, Tr.jsx)("h2", { children: v("exportDialog.link_title") }),
								(0, Tr.jsx)("div", {
									className: "Card-details",
									children: v("exportDialog.link_details"),
								}),
								(0, Tr.jsx)(Te, {
									className: "Card-button",
									type: "button",
									title: v("exportDialog.link_button"),
									"aria-label": v("exportDialog.link_button"),
									showAriaLabel: !0,
									onClick: async () => {
										try {
											We("export", "link", `ui (${VT()})`),
												await d(e, t, o),
												c();
										} catch (u) {
											r({ errorMessage: u.message });
										}
									},
								}),
							],
						}),
					a.renderCustomUI && a.renderCustomUI(e, t, o, s),
				],
			}),
		});
	},
	YL = ({
		elements: e,
		appState: t,
		files: r,
		actionManager: o,
		exportOpts: i,
		canvas: a,
		setAppState: s,
	}) => {
		let c = KL.default.useCallback(() => {
			s({ openDialog: null });
		}, [s]);
		return (0, Tr.jsx)(Tr.Fragment, {
			children:
				t.openDialog?.name === "jsonExport" &&
				(0, Tr.jsx)(er, {
					onCloseRequest: c,
					title: v("buttons.export"),
					children: (0, Tr.jsx)(c$, {
						elements: e,
						appState: t,
						setAppState: s,
						files: r,
						actionManager: o,
						onCloseRequest: c,
						exportOpts: i,
						canvas: a,
					}),
				}),
		});
	};
b();
b();
var XL = w(M(), 1),
	VL = (e) =>
		(0, XL.jsx)("button", {
			className: "help-icon",
			onClick: e.onClick,
			type: "button",
			title: `${v("helpDialog.title")} \u2014 ?`,
			"aria-label": v("helpDialog.title"),
			children: nc,
		});
var xo = w(M(), 1),
	ZL = ({
		appState: e,
		actionManager: t,
		showExitZenModeBtn: r,
		renderWelcomeScreen: o,
	}) => {
		let { FooterCenterTunnel: i, WelcomeScreenHelpHintTunnel: a } = Mt(),
			s = et(),
			c = !e.viewModeEnabled && e.multiElement && s.isTouchScreen;
		return (0, xo.jsxs)("footer", {
			role: "contentinfo",
			className: "layer-ui__wrapper__footer App-menu App-menu_bottom",
			children: [
				(0, xo.jsx)("div", {
					className: j("layer-ui__wrapper__footer-left zen-mode-transition", {
						"layer-ui__wrapper__footer-left--transition-left": e.zenModeEnabled,
					}),
					children: (0, xo.jsx)(Pr.Col, {
						gap: 2,
						children: (0, xo.jsxs)(qa, {
							heading: "canvasActions",
							children: [
								(0, xo.jsx)(dL, { renderAction: t.renderAction, zoom: e.zoom }),
								!e.viewModeEnabled &&
									(0, xo.jsx)(mL, {
										renderAction: t.renderAction,
										className: j("zen-mode-transition", {
											"layer-ui__wrapper__footer-left--transition-bottom":
												e.zenModeEnabled,
										}),
									}),
								c &&
									(0, xo.jsx)(pL, {
										renderAction: t.renderAction,
										className: j("zen-mode-transition", {
											"layer-ui__wrapper__footer-left--transition-left":
												e.zenModeEnabled,
										}),
									}),
							],
						}),
					}),
				}),
				(0, xo.jsx)(i.Out, {}),
				(0, xo.jsx)("div", {
					className: j("layer-ui__wrapper__footer-right zen-mode-transition", {
						"transition-right": e.zenModeEnabled,
					}),
					children: (0, xo.jsxs)("div", {
						style: { position: "relative" },
						children: [
							o && (0, xo.jsx)(a.Out, {}),
							(0, xo.jsx)(VL, { onClick: () => t.executeAction(rs) }),
						],
					}),
				}),
				(0, xo.jsx)(uL, { actionManager: t, showExitZenModeBtn: r }),
			],
		});
	},
	qL = ZL;
ZL.displayName = "Footer";
b();
var fr = w(Q(), 1);
b();
var jL = w(Q(), 1),
	Fh = jL.default.createContext({});
b();
var QL = w(Q(), 1);
var bs = w(M(), 1),
	w0 = ({ children: e, className: t }) => {
		let r = et(),
			o = (0, QL.useContext)(Fh),
			i = !!(r.editor.canFitSidebar && o.shouldRenderDockButton);
		return (0, bs.jsxs)("div", {
			className: j("sidebar__header", t),
			"data-testid": "sidebar-header",
			children: [
				e,
				(0, bs.jsxs)("div", {
					className: "sidebar__header__buttons",
					children: [
						i &&
							(0, bs.jsx)(Xo, {
								label: v("labels.sidebarLock"),
								children: (0, bs.jsx)(Qo, {
									onSelect: () => o.onDock?.(!o.docked),
									selected: !!o.docked,
									className: "sidebar__dock",
									"data-testid": "sidebar-dock",
									"aria-label": v("labels.sidebarLock"),
									children: xC,
								}),
							}),
						(0, bs.jsx)(Qo, {
							"data-testid": "sidebar-close",
							className: "sidebar__close",
							onSelect: o.onCloseRequest,
							"aria-label": v("buttons.close"),
							children: un,
						}),
					],
				}),
			],
		});
	};
w0.displayName = "SidebarHeader";
b();
var xs = w(M(), 1),
	S0 = ({
		name: e,
		tab: t,
		icon: r,
		title: o,
		children: i,
		onToggle: a,
		className: s,
		style: c,
	}) => {
		let d = tt(),
			u = mt();
		return (0, xs.jsxs)("label", {
			title: o,
			className: "sidebar-trigger__label-element",
			children: [
				(0, xs.jsx)("input", {
					className: "ToolIcon_type_checkbox",
					type: "checkbox",
					onChange: (f) => {
						document
							.querySelector(".layer-ui__wrapper")
							?.classList.remove("animate");
						let m = f.target.checked;
						d({ openSidebar: m ? { name: e, tab: t } : null }), a?.(m);
					},
					checked: u.openSidebar?.name === e,
					"aria-label": o,
					"aria-keyshortcuts": "0",
				}),
				(0, xs.jsxs)("div", {
					className: j("sidebar-trigger", s),
					style: c,
					children: [
						r && (0, xs.jsx)("div", { children: r }),
						i &&
							(0, xs.jsx)("div", {
								className: "sidebar-trigger__label",
								children: i,
							}),
					],
				}),
			],
		});
	};
S0.displayName = "SidebarTrigger";
b();
b();
var Dr = w(Q());
b();
var Pt = w(Q());
b();
var qn = w(Q());
function JL(e) {
	let t = e + "CollectionProvider",
		[r, o] = di(t),
		[i, a] = r(t, { collectionRef: { current: null }, itemMap: new Map() }),
		s = (h) => {
			let { scope: y, children: E } = h,
				T = qn.default.useRef(null),
				I = qn.default.useRef(new Map()).current;
			return qn.default.createElement(
				i,
				{ scope: y, itemMap: I, collectionRef: T },
				E,
			);
		},
		c = e + "CollectionSlot",
		d = qn.default.forwardRef((h, y) => {
			let { scope: E, children: T } = h,
				I = a(c, E),
				P = Hr(y, I.collectionRef);
			return qn.default.createElement(Na, { ref: P }, T);
		}),
		u = e + "CollectionItemSlot",
		f = "data-radix-collection-item",
		m = qn.default.forwardRef((h, y) => {
			let { scope: E, children: T, ...I } = h,
				P = qn.default.useRef(null),
				C = Hr(y, P),
				k = a(u, E);
			return (
				qn.default.useEffect(
					() => (
						k.itemMap.set(P, { ref: P, ...I }), () => void k.itemMap.delete(P)
					),
				),
				qn.default.createElement(Na, { [f]: "", ref: C }, T)
			);
		});
	function g(h) {
		let y = a(e + "CollectionConsumer", h);
		return qn.default.useCallback(() => {
			let T = y.collectionRef.current;
			if (!T) return [];
			let I = Array.from(T.querySelectorAll(`[${f}]`));
			return Array.from(y.itemMap.values()).sort(
				(k, N) => I.indexOf(k.ref.current) - I.indexOf(N.ref.current),
			);
		}, [y.collectionRef, y.itemMap]);
	}
	return [{ Provider: s, Slot: d, ItemSlot: m }, g, o];
}
b();
var nu = w(Q()),
	d$ = (0, nu.createContext)(void 0);
function Bh(e) {
	let t = (0, nu.useContext)(d$);
	return e || t || "ltr";
}
var T0 = "rovingFocusGroup.onEntryFocus",
	m$ = { bubbles: !1, cancelable: !0 },
	I0 = "RovingFocusGroup",
	[C0, eM, u$] = JL(I0),
	[p$, _0] = di(I0, [u$]),
	[f$, g$] = p$(I0),
	h$ = (0, Pt.forwardRef)((e, t) =>
		(0, Pt.createElement)(
			C0.Provider,
			{ scope: e.__scopeRovingFocusGroup },
			(0, Pt.createElement)(
				C0.Slot,
				{ scope: e.__scopeRovingFocusGroup },
				(0, Pt.createElement)(b$, je({}, e, { ref: t })),
			),
		),
	),
	b$ = (0, Pt.forwardRef)((e, t) => {
		let {
				__scopeRovingFocusGroup: r,
				orientation: o,
				loop: i = !1,
				dir: a,
				currentTabStopId: s,
				defaultCurrentTabStopId: c,
				onCurrentTabStopIdChange: d,
				onEntryFocus: u,
				...f
			} = e,
			m = (0, Pt.useRef)(null),
			g = Hr(t, m),
			h = Bh(a),
			[y = null, E] = Fc({ prop: s, defaultProp: c, onChange: d }),
			[T, I] = (0, Pt.useState)(!1),
			P = uo(u),
			C = eM(r),
			k = (0, Pt.useRef)(!1),
			[N, D] = (0, Pt.useState)(0);
		return (
			(0, Pt.useEffect)(() => {
				let B = m.current;
				if (B)
					return B.addEventListener(T0, P), () => B.removeEventListener(T0, P);
			}, [P]),
			(0, Pt.createElement)(
				f$,
				{
					scope: r,
					orientation: o,
					dir: h,
					loop: i,
					currentTabStopId: y,
					onItemFocus: (0, Pt.useCallback)((B) => E(B), [E]),
					onItemShiftTab: (0, Pt.useCallback)(() => I(!0), []),
					onFocusableItemAdd: (0, Pt.useCallback)(() => D((B) => B + 1), []),
					onFocusableItemRemove: (0, Pt.useCallback)(() => D((B) => B - 1), []),
				},
				(0, Pt.createElement)(
					Qt.div,
					je({ tabIndex: T || N === 0 ? -1 : 0, "data-orientation": o }, f, {
						ref: g,
						style: { outline: "none", ...e.style },
						onMouseDown: mr(e.onMouseDown, () => {
							k.current = !0;
						}),
						onFocus: mr(e.onFocus, (B) => {
							let F = !k.current;
							if (B.target === B.currentTarget && F && !T) {
								let W = new CustomEvent(T0, m$);
								if ((B.currentTarget.dispatchEvent(W), !W.defaultPrevented)) {
									let G = C().filter((X) => X.focusable),
										q = G.find((X) => X.active),
										ie = G.find((X) => X.id === y),
										we = [q, ie, ...G]
											.filter(Boolean)
											.map((X) => X.ref.current);
									tM(we);
								}
							}
							k.current = !1;
						}),
						onBlur: mr(e.onBlur, () => I(!1)),
					}),
				),
			)
		);
	}),
	x$ = "RovingFocusGroupItem",
	v$ = (0, Pt.forwardRef)((e, t) => {
		let {
				__scopeRovingFocusGroup: r,
				focusable: o = !0,
				active: i = !1,
				tabStopId: a,
				...s
			} = e,
			c = Rc(),
			d = a || c,
			u = g$(x$, r),
			f = u.currentTabStopId === d,
			m = eM(r),
			{ onFocusableItemAdd: g, onFocusableItemRemove: h } = u;
		return (
			(0, Pt.useEffect)(() => {
				if (o) return g(), () => h();
			}, [o, g, h]),
			(0, Pt.createElement)(
				C0.ItemSlot,
				{ scope: r, id: d, focusable: o, active: i },
				(0, Pt.createElement)(
					Qt.span,
					je({ tabIndex: f ? 0 : -1, "data-orientation": u.orientation }, s, {
						ref: t,
						onMouseDown: mr(e.onMouseDown, (y) => {
							o ? u.onItemFocus(d) : y.preventDefault();
						}),
						onFocus: mr(e.onFocus, () => u.onItemFocus(d)),
						onKeyDown: mr(e.onKeyDown, (y) => {
							if (y.key === "Tab" && y.shiftKey) {
								u.onItemShiftTab();
								return;
							}
							if (y.target !== y.currentTarget) return;
							let E = w$(y, u.orientation, u.dir);
							if (E !== void 0) {
								y.preventDefault();
								let I = m()
									.filter((P) => P.focusable)
									.map((P) => P.ref.current);
								if (E === "last") I.reverse();
								else if (E === "prev" || E === "next") {
									E === "prev" && I.reverse();
									let P = I.indexOf(y.currentTarget);
									I = u.loop ? S$(I, P + 1) : I.slice(P + 1);
								}
								setTimeout(() => tM(I));
							}
						}),
					}),
				),
			)
		);
	}),
	E$ = {
		ArrowLeft: "prev",
		ArrowUp: "prev",
		ArrowRight: "next",
		ArrowDown: "next",
		PageUp: "first",
		Home: "first",
		PageDown: "last",
		End: "last",
	};
function y$(e, t) {
	return t !== "rtl"
		? e
		: e === "ArrowLeft"
			? "ArrowRight"
			: e === "ArrowRight"
				? "ArrowLeft"
				: e;
}
function w$(e, t, r) {
	let o = y$(e.key, r);
	if (
		!(t === "vertical" && ["ArrowLeft", "ArrowRight"].includes(o)) &&
		!(t === "horizontal" && ["ArrowUp", "ArrowDown"].includes(o))
	)
		return E$[o];
}
function tM(e) {
	let t = document.activeElement;
	for (let r of e)
		if (r === t || (r.focus(), document.activeElement !== t)) return;
}
function S$(e, t) {
	return e.map((r, o) => e[(t + o) % e.length]);
}
var rM = h$,
	oM = v$;
var nM = "Tabs",
	[T$, $be] = di(nM, [_0]),
	iM = _0(),
	[C$, A0] = T$(nM),
	I$ = (0, Dr.forwardRef)((e, t) => {
		let {
				__scopeTabs: r,
				value: o,
				onValueChange: i,
				defaultValue: a,
				orientation: s = "horizontal",
				dir: c,
				activationMode: d = "automatic",
				...u
			} = e,
			f = Bh(c),
			[m, g] = Fc({ prop: o, onChange: i, defaultProp: a });
		return (0, Dr.createElement)(
			C$,
			{
				scope: r,
				baseId: Rc(),
				value: m,
				onValueChange: g,
				orientation: s,
				dir: f,
				activationMode: d,
			},
			(0, Dr.createElement)(
				Qt.div,
				je({ dir: f, "data-orientation": s }, u, { ref: t }),
			),
		);
	}),
	_$ = "TabsList",
	A$ = (0, Dr.forwardRef)((e, t) => {
		let { __scopeTabs: r, loop: o = !0, ...i } = e,
			a = A0(_$, r),
			s = iM(r);
		return (0, Dr.createElement)(
			rM,
			je({ asChild: !0 }, s, {
				orientation: a.orientation,
				dir: a.dir,
				loop: o,
			}),
			(0, Dr.createElement)(
				Qt.div,
				je({ role: "tablist", "aria-orientation": a.orientation }, i, {
					ref: t,
				}),
			),
		);
	}),
	k$ = "TabsTrigger",
	L$ = (0, Dr.forwardRef)((e, t) => {
		let { __scopeTabs: r, value: o, disabled: i = !1, ...a } = e,
			s = A0(k$, r),
			c = iM(r),
			d = aM(s.baseId, o),
			u = lM(s.baseId, o),
			f = o === s.value;
		return (0, Dr.createElement)(
			oM,
			je({ asChild: !0 }, c, { focusable: !i, active: f }),
			(0, Dr.createElement)(
				Qt.button,
				je(
					{
						type: "button",
						role: "tab",
						"aria-selected": f,
						"aria-controls": u,
						"data-state": f ? "active" : "inactive",
						"data-disabled": i ? "" : void 0,
						disabled: i,
						id: d,
					},
					a,
					{
						ref: t,
						onMouseDown: mr(e.onMouseDown, (m) => {
							!i && m.button === 0 && m.ctrlKey === !1
								? s.onValueChange(o)
								: m.preventDefault();
						}),
						onKeyDown: mr(e.onKeyDown, (m) => {
							[" ", "Enter"].includes(m.key) && s.onValueChange(o);
						}),
						onFocus: mr(e.onFocus, () => {
							let m = s.activationMode !== "manual";
							!f && !i && m && s.onValueChange(o);
						}),
					},
				),
			),
		);
	}),
	M$ = "TabsContent",
	P$ = (0, Dr.forwardRef)((e, t) => {
		let { __scopeTabs: r, value: o, forceMount: i, children: a, ...s } = e,
			c = A0(M$, r),
			d = aM(c.baseId, o),
			u = lM(c.baseId, o),
			f = o === c.value,
			m = (0, Dr.useRef)(f);
		return (
			(0, Dr.useEffect)(() => {
				let g = requestAnimationFrame(() => (m.current = !1));
				return () => cancelAnimationFrame(g);
			}, []),
			(0, Dr.createElement)(Oc, { present: i || f }, ({ present: g }) =>
				(0, Dr.createElement)(
					Qt.div,
					je(
						{
							"data-state": f ? "active" : "inactive",
							"data-orientation": c.orientation,
							role: "tabpanel",
							"aria-labelledby": d,
							hidden: !g,
							id: u,
							tabIndex: 0,
						},
						s,
						{
							ref: t,
							style: {
								...e.style,
								animationDuration: m.current ? "0s" : void 0,
							},
						},
					),
					g && a,
				),
			)
		);
	});
function aM(e, t) {
	return `${e}-trigger-${t}`;
}
function lM(e, t) {
	return `${e}-content-${t}`;
}
var zh = I$,
	$h = A$,
	Hh = L$,
	Uh = P$;
var sM = w(M(), 1),
	k0 = ({ children: e, ...t }) =>
		(0, sM.jsx)($h, { className: "sidebar-triggers", ...t, children: e });
k0.displayName = "SidebarTabTriggers";
b();
var L0 = w(M(), 1),
	M0 = ({ children: e, tab: t, onSelect: r, ...o }) =>
		(0, L0.jsx)(Hh, {
			value: t,
			asChild: !0,
			onSelect: r,
			children: (0, L0.jsx)("button", {
				type: "button",
				className: "excalidraw-button sidebar-tab-trigger",
				...o,
				children: e,
			}),
		});
M0.displayName = "SidebarTabTrigger";
b();
var cM = w(M(), 1),
	P0 = ({ children: e, ...t }) => {
		let r = mt(),
			o = tt();
		if (!r.openSidebar) return null;
		let { name: i } = r.openSidebar;
		return (0, cM.jsx)(zh, {
			className: "sidebar-tabs-root",
			value: r.openSidebar.tab,
			onValueChange: (a) =>
				o((s) => ({
					...s,
					openSidebar: { ...s.openSidebar, name: i, tab: a },
				})),
			...t,
			children: e,
		});
	};
P0.displayName = "SidebarTabs";
b();
var dM = w(M(), 1),
	R0 = ({ tab: e, children: t, ...r }) =>
		(0, dM.jsx)(Uh, { ...r, value: e, "data-testid": e, children: t });
R0.displayName = "SidebarTab";
var D0 = w(M(), 1),
	uM = w(Q(), 1),
	iu = xt(!1),
	mM = (0, fr.forwardRef)(
		({ name: e, children: t, onDock: r, docked: o, className: i, ...a }, s) => {
			_.DEV &&
				r &&
				o == null &&
				console.warn(
					"Sidebar: `docked` must be set when `onDock` is supplied for the sidebar to be user-dockable. To hide this message, either pass `docked` or remove `onDock`",
				);
			let c = tt(),
				d = Wi(iu, lt);
			(0, fr.useLayoutEffect)(
				() => (
					d(!!o),
					() => {
						d(!1);
					}
				),
				[d, o],
			);
			let u = (0, fr.useRef)({});
			(u.current.onCloseRequest = () => {
				c({ openSidebar: null });
			}),
				(u.current.onDock = (h) => r?.(h)),
				(u.current = Ys(u.current, {
					docked: o,
					shouldRenderDockButton: !!r && o != null,
				}));
			let f = (0, fr.useRef)(null);
			(0, fr.useImperativeHandle)(s, () => f.current);
			let m = et(),
				g = (0, fr.useCallback)(() => {
					document.querySelector(".Dialog") || c({ openSidebar: null });
				}, [c]);
			return (
				Kc(
					f,
					(0, fr.useCallback)(
						(h) => {
							h.target.closest(".sidebar-trigger") ||
								((!o || !m.editor.canFitSidebar) && g());
						},
						[g, o, m.editor.canFitSidebar],
					),
				),
				(0, fr.useEffect)(() => {
					let h = (y) => {
						y.key === R.ESCAPE && (!o || !m.editor.canFitSidebar) && g();
					};
					return (
						document.addEventListener("keydown", h),
						() => {
							document.removeEventListener("keydown", h);
						}
					);
				}, [g, o, m.editor.canFitSidebar]),
				(0, D0.jsx)(yr, {
					...a,
					className: j("sidebar", { "sidebar--docked": o }, i),
					ref: f,
					children: (0, D0.jsx)(Fh.Provider, { value: u.current, children: t }),
				})
			);
		},
	);
mM.displayName = "SidebarInner";
var Sn = Object.assign(
	(0, fr.forwardRef)((e, t) => {
		let r = mt(),
			{ onStateChange: o } = e,
			i = (0, fr.useRef)(r.openSidebar);
		(0, fr.useEffect)(() => {
			((!r.openSidebar && i?.current?.name === e.name) ||
				(r.openSidebar?.name === e.name && i?.current?.name !== e.name) ||
				i.current?.name === e.name) &&
				r.openSidebar !== i.current &&
				o?.(r.openSidebar?.name !== e.name ? null : r.openSidebar),
				(i.current = r.openSidebar);
		}, [r.openSidebar, o, e.name]);
		let [a, s] = (0, fr.useState)(!1);
		return (
			(0, fr.useLayoutEffect)(() => (s(!0), () => s(!1)), []),
			a && r.openSidebar?.name === e.name
				? (0, uM.createElement)(mM, { ...e, ref: t, key: e.name })
				: null
		);
	}),
	{
		Header: w0,
		TabTriggers: k0,
		TabTrigger: M0,
		Tabs: P0,
		Tab: R0,
		Trigger: S0,
	},
);
Sn.displayName = "Sidebar";
b();
var O0 = {};
eT(O0, {
	ChangeCanvasBackground: () => TM,
	ClearCanvas: () => wM,
	CommandPalette: () => vM,
	Export: () => CM,
	Help: () => yM,
	LiveCollaborationTrigger: () => _M,
	LoadScene: () => hM,
	SaveAsImage: () => xM,
	SaveToActiveFile: () => bM,
	SearchMenu: () => EM,
	Socials: () => IM,
	ToggleTheme: () => SM,
});
b();
b();
var N0 = xt({ active: !1 });
async function pM({ title: e, description: t, actionLabel: r, color: o }) {
	return new Promise((i) => {
		zr.set(N0, {
			active: !0,
			onConfirm: () => i(!0),
			onClose: () => i(!1),
			onReject: () => i(!1),
			title: e,
			description: t,
			actionLabel: r,
			color: o,
		});
	});
}
b();
var ta = w(M(), 1),
	fM = ({
		value: e,
		shortcut: t,
		onChange: r,
		choices: o,
		children: i,
		name: a,
	}) => {
		let s = et();
		return (0, ta.jsxs)(ta.Fragment, {
			children: [
				(0, ta.jsxs)("div", {
					className: "dropdown-menu-item-base dropdown-menu-item-bare",
					children: [
						(0, ta.jsx)("label", {
							className: "dropdown-menu-item__text",
							htmlFor: a,
							children: i,
						}),
						(0, ta.jsx)(_h, { name: a, value: e, onChange: r, choices: o }),
					],
				}),
				t &&
					!s.editor.isMobile &&
					(0, ta.jsx)("div", {
						className:
							"dropdown-menu-item__shortcut dropdown-menu-item__shortcut--orphaned",
						children: t,
					}),
			],
		});
	};
fM.displayName = "DropdownMenuItemContentRadio";
var gM = fM;
var $t = w(M(), 1),
	hM = () => {
		let { t: e } = lr(),
			t = pr(),
			r = Ha();
		return t.isActionEnabled(jc)
			? (0, $t.jsx)(fo, {
					icon: ic,
					onSelect: async () => {
						(!r.length ||
							(await pM({
								title: e("overwriteConfirm.modal.loadFromFile.title"),
								actionLabel: e("overwriteConfirm.modal.loadFromFile.button"),
								color: "warning",
								description: (0, $t.jsx)(bo, {
									i18nKey: "overwriteConfirm.modal.loadFromFile.description",
									bold: (i) => (0, $t.jsx)("strong", { children: i }),
									br: () => (0, $t.jsx)("br", {}),
								}),
							}))) &&
							t.executeAction(jc);
					},
					"data-testid": "load-button",
					shortcut: tr("loadScene"),
					"aria-label": e("buttons.load"),
					children: e("buttons.load"),
				})
			: null;
	};
hM.displayName = "LoadScene";
var bM = () => {
	let { t: e } = lr(),
		t = pr();
	return t.isActionEnabled(Xg)
		? (0, $t.jsx)(fo, {
				shortcut: tr("saveScene"),
				"data-testid": "save-button",
				onSelect: () => t.executeAction(Xg),
				icon: LC,
				"aria-label": `${e("buttons.save")}`,
				children: `${e("buttons.save")}`,
			})
		: null;
};
bM.displayName = "SaveToActiveFile";
var xM = () => {
	let e = tt(),
		{ t } = lr();
	return (0, $t.jsx)(fo, {
		icon: $p,
		"data-testid": "image-export-button",
		onSelect: () => e({ openDialog: { name: "imageExport" } }),
		shortcut: tr("imageExport"),
		"aria-label": t("buttons.exportImage"),
		children: t("buttons.exportImage"),
	});
};
xM.displayName = "SaveAsImage";
var vM = (e) => {
	let t = tt(),
		{ t: r } = lr();
	return (0, $t.jsx)(fo, {
		icon: Zp,
		"data-testid": "command-palette-button",
		onSelect: () => {
			We("command_palette", "open", "menu"),
				t({ openDialog: { name: "commandPalette" } });
		},
		shortcut: tr("commandPalette"),
		"aria-label": r("commandPalette.title"),
		className: e?.className,
		children: r("commandPalette.title"),
	});
};
vM.displayName = "CommandPalette";
var EM = (e) => {
	let { t } = lr(),
		r = pr();
	return (0, $t.jsx)(fo, {
		icon: Go,
		"data-testid": "search-menu-button",
		onSelect: () => {
			r.executeAction(jm);
		},
		shortcut: tr("searchMenu"),
		"aria-label": t("search.title"),
		className: e?.className,
		children: t("search.title"),
	});
};
EM.displayName = "SearchMenu";
var yM = () => {
	let { t: e } = lr(),
		t = pr();
	return (0, $t.jsx)(fo, {
		"data-testid": "help-menu-item",
		icon: nc,
		onSelect: () => t.executeAction(rs),
		shortcut: "?",
		"aria-label": e("helpDialog.title"),
		children: e("helpDialog.title"),
	});
};
yM.displayName = "Help";
var wM = () => {
	let { t: e } = lr(),
		t = Wi(ms, lt);
	return pr().isActionEnabled(ji)
		? (0, $t.jsx)(fo, {
				icon: Uo,
				onSelect: () => t("clearCanvas"),
				"data-testid": "clear-canvas-button",
				"aria-label": e("buttons.clearReset"),
				children: e("buttons.clearReset"),
			})
		: null;
};
wM.displayName = "ClearCanvas";
var SM = (e) => {
	let { t } = lr(),
		r = mt(),
		o = pr(),
		i = tr("toggleTheme");
	return o.isActionEnabled(Ql)
		? e?.allowSystemTheme
			? (0, $t.jsx)(gM, {
					name: "theme",
					value: e.theme,
					onChange: (a) => e.onSelect(a),
					choices: [
						{
							value: $e.LIGHT,
							label: nm,
							ariaLabel: `${t("buttons.lightMode")} - ${i}`,
						},
						{
							value: $e.DARK,
							label: om,
							ariaLabel: `${t("buttons.darkMode")} - ${i}`,
						},
						{ value: "system", label: z2, ariaLabel: t("buttons.systemMode") },
					],
					children: t("labels.theme"),
				})
			: (0, $t.jsx)(fo, {
					onSelect: (a) => {
						if ((a.preventDefault(), e?.onSelect))
							e.onSelect(r.theme === $e.DARK ? $e.LIGHT : $e.DARK);
						else return o.executeAction(Ql);
					},
					icon: r.theme === $e.DARK ? nm : om,
					"data-testid": "toggle-dark-mode",
					shortcut: i,
					"aria-label":
						r.theme === $e.DARK
							? t("buttons.lightMode")
							: t("buttons.darkMode"),
					children:
						r.theme === $e.DARK
							? t("buttons.lightMode")
							: t("buttons.darkMode"),
				})
		: null;
};
SM.displayName = "ToggleTheme";
var TM = () => {
	let { t: e } = lr(),
		t = mt(),
		r = pr(),
		o = fi();
	return t.viewModeEnabled ||
		!o.UIOptions.canvasActions.changeViewBackgroundColor
		? null
		: (0, $t.jsxs)("div", {
				style: { marginTop: "0.5rem" },
				children: [
					(0, $t.jsx)("div", {
						"data-testid": "canvas-background-label",
						style: { fontSize: ".75rem", marginBottom: ".5rem" },
						children: e("labels.canvasBackground"),
					}),
					(0, $t.jsx)("div", {
						style: { padding: "0 0.625rem" },
						children: r.renderAction("changeViewBackgroundColor"),
					}),
				],
			});
};
TM.displayName = "ChangeCanvasBackground";
var CM = () => {
	let { t: e } = lr(),
		t = tt();
	return (0, $t.jsx)(fo, {
		icon: Ml,
		onSelect: () => {
			t({ openDialog: { name: "jsonExport" } });
		},
		"data-testid": "json-export-button",
		"aria-label": e("buttons.export"),
		children: e("buttons.export"),
	});
};
CM.displayName = "Export";
var IM = () => {
	let { t: e } = lr();
	return (0, $t.jsxs)($t.Fragment, {
		children: [
			(0, $t.jsx)(ad, {
				icon: Bp,
				href: "https://github.com/excalidraw/excalidraw",
				"aria-label": "GitHub",
				children: "GitHub",
			}),
			(0, $t.jsx)(ad, {
				icon: AC,
				href: "https://x.com/excalidraw",
				"aria-label": "X",
				children: e("labels.followUs"),
			}),
			(0, $t.jsx)(ad, {
				icon: _C,
				href: "https://discord.gg/UexuTaE",
				"aria-label": "Discord",
				children: e("labels.discordChat"),
			}),
		],
	});
};
IM.displayName = "Socials";
var _M = ({ onSelect: e, isCollaborating: t }) => {
	let { t: r } = lr();
	return (0, $t.jsx)(fo, {
		"data-testid": "collab-button",
		icon: Hp,
		className: j({ "active-collab": t }),
		onSelect: e,
		children: r("labels.liveCollaboration"),
	});
};
_M.displayName = "LiveCollaborationTrigger";
b();
var Gh = w(Q(), 1);
var AM = w(M(), 1),
	ra = (e, t) => {
		let r = xt(0),
			o = (i) => {
				let { jotaiScope: a } = Mt(),
					[, s] = Ge(r, a),
					c = (0, Gh.useRef)({ preferHost: !1, counter: 0 });
				return (
					(0, Gh.useLayoutEffect)(() => {
						let d = c.current;
						return (
							s((u) => {
								let f = u + 1;
								return (d.counter = f), f;
							}),
							() => {
								s((u) => {
									let f = u - 1;
									return (d.counter = f), f || (d.preferHost = !1), f;
								});
							}
						);
					}, [s]),
					i.__fallback || (c.current.preferHost = !0),
					(!c.current.counter && i.__fallback && c.current.preferHost) ||
					(c.current.counter > 1 && i.__fallback)
						? null
						: (0, AM.jsx)(t, { ...i })
				);
			};
		return (o.displayName = e), o;
	};
var oa = w(M(), 1),
	R$ = Object.assign(
		ra("MainMenu", ({ children: e, onSelect: t }) => {
			let { MainMenuTunnel: r } = Mt(),
				o = et(),
				i = mt(),
				a = tt(),
				s = o.editor.isMobile ? void 0 : () => a({ openMenu: null });
			return (0, oa.jsx)(r.In, {
				children: (0, oa.jsxs)(gt, {
					open: i.openMenu === "canvas",
					children: [
						(0, oa.jsx)(gt.Trigger, {
							onToggle: () => {
								a({ openMenu: i.openMenu === "canvas" ? null : "canvas" });
							},
							"data-testid": "main-menu-trigger",
							className: "main-menu-trigger",
							children: Fp,
						}),
						(0, oa.jsxs)(gt.Content, {
							onClickOutside: s,
							onSelect: wa(t, () => {
								a({ openMenu: null });
							}),
							children: [
								e,
								o.editor.isMobile &&
									i.collaborators.size > 0 &&
									(0, oa.jsxs)("fieldset", {
										className: "UserList-Wrapper",
										children: [
											(0, oa.jsx)("legend", {
												children: v("labels.collaborators"),
											}),
											(0, oa.jsx)(Oh, {
												mobile: !0,
												collaborators: i.collaborators,
												userToFollow: i.userToFollow?.socketId || null,
											}),
										],
									}),
							],
						}),
					],
				}),
			});
		}),
		{
			Trigger: gt.Trigger,
			Item: gt.Item,
			ItemLink: gt.ItemLink,
			ItemCustom: gt.ItemCustom,
			Group: gt.Group,
			Separator: gt.Separator,
			DefaultItems: O0,
		},
	),
	Jr = R$;
b();
b();
var na = w(M(), 1),
	Wh = ({ title: e, children: t, actionLabel: r, onClick: o }) =>
		(0, na.jsxs)("div", {
			className: "OverwriteConfirm__Actions__Action",
			children: [
				(0, na.jsx)("h4", { children: e }),
				(0, na.jsx)("div", {
					className: "OverwriteConfirm__Actions__Action__content",
					children: t,
				}),
				(0, na.jsx)(Za, {
					variant: "outlined",
					color: "muted",
					label: r,
					size: "large",
					fullWidth: !0,
					onClick: o,
				}),
			],
		}),
	D$ = () => {
		let { t: e } = lr(),
			t = pr(),
			r = tt();
		return (0, na.jsx)(Wh, {
			title: e("overwriteConfirm.action.exportToImage.title"),
			actionLabel: e("overwriteConfirm.action.exportToImage.button"),
			onClick: () => {
				t.executeAction(Vg, "ui", !0),
					r({ openDialog: { name: "imageExport" } });
			},
			children: e("overwriteConfirm.action.exportToImage.description"),
		});
	},
	N$ = () => {
		let { t: e } = lr(),
			t = pr();
		return (0, na.jsx)(Wh, {
			title: e("overwriteConfirm.action.saveToDisk.title"),
			actionLabel: e("overwriteConfirm.action.saveToDisk.button"),
			onClick: () => {
				t.executeAction(Hm, "ui");
			},
			children: e("overwriteConfirm.action.saveToDisk.description"),
		});
	},
	F0 = Object.assign(
		({ children: e }) =>
			(0, na.jsx)("div", {
				className: "OverwriteConfirm__Actions",
				children: e,
			}),
		{ ExportToImage: D$, SaveToDisk: N$ },
	);
var Tn = w(M(), 1),
	Kh = Object.assign(
		ra("OverwriteConfirmDialog", ({ children: e }) => {
			let { OverwriteConfirmDialogTunnel: t } = Mt(),
				[r, o] = Ge(N0, lt);
			if (!r.active) return null;
			let i = () => {
					r.onClose(), o((s) => ({ ...s, active: !1 }));
				},
				a = () => {
					r.onConfirm(), o((s) => ({ ...s, active: !1 }));
				};
			return (0, Tn.jsx)(t.In, {
				children: (0, Tn.jsx)(er, {
					onCloseRequest: i,
					title: !1,
					size: 916,
					children: (0, Tn.jsxs)("div", {
						className: "OverwriteConfirm",
						children: [
							(0, Tn.jsx)("h3", { children: r.title }),
							(0, Tn.jsxs)("div", {
								className: `OverwriteConfirm__Description OverwriteConfirm__Description--color-${r.color}`,
								children: [
									(0, Tn.jsx)("div", {
										className: "OverwriteConfirm__Description__icon",
										children: y2,
									}),
									(0, Tn.jsx)("div", { children: r.description }),
									(0, Tn.jsx)("div", {
										className: "OverwriteConfirm__Description__spacer",
									}),
									(0, Tn.jsx)(Za, {
										color: r.color,
										size: "large",
										label: r.actionLabel,
										onClick: a,
									}),
								],
							}),
							(0, Tn.jsx)(F0, { children: e }),
						],
					}),
				}),
			});
		}),
		{ Actions: F0, Action: Wh },
	);
b();
b();
var Gr = w(Q(), 1);
var LM = w(B0(), 1);
var rr = w(M(), 1),
	O$ = xt(""),
	z0 = xt(null),
	F$ = 350,
	MM = () => {
		let e = Jt(),
			t = tt(),
			r = (0, Gr.useRef)(null),
			[o, i] = Ge(O$, lt),
			a = o.trim(),
			[s, c] = (0, Gr.useState)(!1),
			[d, u] = (0, Gr.useState)({ nonce: null, items: [] }),
			f = (0, Gr.useRef)(null),
			m = (0, Gr.useRef)(void 0),
			[g, h] = Ge(z0, lt),
			y = e.scene.getNonDeletedElementsMap();
		(0, Gr.useEffect)(() => {
			s ||
				((a !== f.current || e.scene.getSceneNonce() !== m.current) &&
					((f.current = null),
					kM(a, e, (C, k) => {
						u({ nonce: tm(), items: C }),
							(f.current = a),
							(m.current = e.scene.getSceneNonce()),
							t({
								searchMatches: C.map((N) => ({
									id: N.textElement.id,
									focus: !1,
									matchedLines: N.matchedLines,
								})),
							});
					})));
		}, [s, a, y, e, t, h, m]);
		let E = () => {
				d.items.length > 0 &&
					h((C) => (C === null ? 0 : (C + 1) % d.items.length));
			},
			T = () => {
				d.items.length > 0 &&
					h((C) => (C === null ? 0 : C - 1 < 0 ? d.items.length - 1 : C - 1));
			};
		(0, Gr.useEffect)(() => {
			t((C) => ({
				searchMatches: C.searchMatches.map((k, N) =>
					N === g ? { ...k, focus: !0 } : { ...k, focus: !1 },
				),
			}));
		}, [g, t]),
			(0, Gr.useEffect)(() => {
				if (d.items.length > 0 && g !== null) {
					let C = d.items[g];
					if (C) {
						let k = e.state.zoom.value,
							N = Hn({
								text: C.searchQuery,
								x: C.textElement.x + (C.matchedLines[0]?.offsetX ?? 0),
								y: C.textElement.y + (C.matchedLines[0]?.offsetY ?? 0),
								width: C.matchedLines[0]?.width,
								height: C.matchedLines[0]?.height,
								fontSize: C.textElement.fontSize,
								fontFamily: C.textElement.fontFamily,
							}),
							D = 14,
							B = C.textElement.fontSize,
							F = B * k < D;
						if (
							!vc(
								[N],
								e.canvas.width / window.devicePixelRatio,
								e.canvas.height / window.devicePixelRatio,
								{
									offsetLeft: e.state.offsetLeft,
									offsetTop: e.state.offsetTop,
									scrollX: e.state.scrollX,
									scrollY: e.state.scrollY,
									zoom: e.state.zoom,
								},
								e.scene.getNonDeletedElementsMap(),
								e.getEditorUIOffsets(),
							) ||
							F
						) {
							let W;
							F
								? B >= D
									? (W = { fitToContent: !0 })
									: (W = { fitToViewport: !0, maxZoom: cn(D / B, 1) })
								: (W = { fitToContent: !0 }),
								e.scrollToContent(N, {
									animate: !0,
									duration: 300,
									...W,
									canvasOffsets: e.getEditorUIOffsets(),
								});
						}
					}
				}
			}, [g, d, e]),
			(0, Gr.useEffect)(
				() => () => {
					h(null),
						(f.current = null),
						(m.current = void 0),
						t({ searchMatches: [] }),
						c(!1);
				},
				[t, h],
			);
		let I = za({ goToNextItem: E, goToPreviousItem: T, searchMatches: d });
		(0, Gr.useEffect)(() => {
			let C = (k) => {
				if (k.key === R.ESCAPE && !e.state.openDialog && !e.state.openPopup) {
					k.preventDefault(), k.stopPropagation(), t({ openSidebar: null });
					return;
				}
				k[R.CTRL_OR_CMD] &&
					k.key === R.F &&
					(k.preventDefault(),
					k.stopPropagation(),
					r.current?.matches(":focus")
						? t({ openSidebar: null })
						: (e.state.openDialog && t({ openDialog: null }),
							r.current?.focus(),
							r.current?.select())),
					k.target instanceof HTMLElement &&
						k.target.closest(".layer-ui__search") &&
						I.searchMatches.items.length &&
						(k.key === R.ENTER && (k.stopPropagation(), I.goToNextItem()),
						k.key === R.ARROW_UP
							? (k.stopPropagation(), I.goToPreviousItem())
							: k.key === R.ARROW_DOWN &&
								(k.stopPropagation(), I.goToNextItem()));
			};
			return kt(window, "keydown", C, { capture: !0, passive: !1 });
		}, [t, I, e]);
		let P = `${d.items.length} ${d.items.length === 1 ? v("search.singleResult") : v("search.multipleResults")}`;
		return (0, rr.jsxs)("div", {
			className: "layer-ui__search",
			children: [
				(0, rr.jsx)("div", {
					className: "layer-ui__search-header",
					children: (0, rr.jsx)(cd, {
						className: Nn.SEARCH_MENU_INPUT_WRAPPER,
						value: o,
						ref: r,
						placeholder: v("search.placeholder"),
						icon: Go,
						onChange: (C) => {
							i(C), c(!0);
							let k = C.trim();
							kM(k, e, (N, D) => {
								u({ nonce: tm(), items: N }),
									h(D),
									(f.current = k),
									(m.current = e.scene.getSceneNonce()),
									t({
										searchMatches: N.map((B) => ({
											id: B.textElement.id,
											focus: !1,
											matchedLines: B.matchedLines,
										})),
									}),
									c(!1);
							});
						},
						selectOnRender: !0,
					}),
				}),
				(0, rr.jsxs)("div", {
					className: "layer-ui__search-count",
					children: [
						d.items.length > 0 &&
							(0, rr.jsxs)(rr.Fragment, {
								children: [
									g !== null && g > -1
										? (0, rr.jsxs)("div", { children: [g + 1, " / ", P] })
										: (0, rr.jsx)("div", { children: P }),
									(0, rr.jsxs)("div", {
										className: "result-nav",
										children: [
											(0, rr.jsx)(Qo, {
												onSelect: () => {
													E();
												},
												className: "result-nav-btn",
												children: jp,
											}),
											(0, rr.jsx)(Qo, {
												onSelect: () => {
													T();
												},
												className: "result-nav-btn",
												children: V2,
											}),
										],
									}),
								],
							}),
						d.items.length === 0 &&
							a &&
							f.current &&
							(0, rr.jsx)("div", {
								style: { margin: "1rem auto" },
								children: v("search.noMatch"),
							}),
					],
				}),
				(0, rr.jsx)(H$, {
					matches: d,
					onItemClick: h,
					focusIndex: g,
					searchQuery: a,
				}),
			],
		});
	},
	B$ = (e) => {
		let t = [
			e.preview.moreBefore ? "..." : "",
			e.preview.previewText.slice(0, e.preview.indexInSearchQuery),
			e.preview.previewText.slice(
				e.preview.indexInSearchQuery,
				e.preview.indexInSearchQuery + e.searchQuery.length,
			),
			e.preview.previewText.slice(
				e.preview.indexInSearchQuery + e.searchQuery.length,
			),
			e.preview.moreAfter ? "..." : "",
		];
		return (0, rr.jsx)("div", {
			tabIndex: -1,
			className: j("layer-ui__result-item", { active: e.highlighted }),
			onClick: e.onClick,
			ref: (r) => {
				e.highlighted &&
					r?.scrollIntoView({ behavior: "auto", block: "nearest" });
			},
			children: (0, rr.jsx)("div", {
				className: "preview-text",
				children: t.flatMap((r, o) =>
					(0, rr.jsx)(
						Gr.Fragment,
						{ children: o === 2 ? (0, rr.jsx)("b", { children: r }) : r },
						o,
					),
				),
			}),
		});
	},
	z$ = (e) =>
		(0, rr.jsx)("div", {
			className: "layer-ui__search-result-container",
			children: e.matches.items.map((t, r) =>
				(0, rr.jsx)(
					B$,
					{
						searchQuery: e.searchQuery,
						preview: t.preview,
						highlighted: r === e.focusIndex,
						onClick: () => e.onItemClick(r),
					},
					t.textElement.id + t.index,
				),
			),
		}),
	$$ = (e, t) =>
		e.matches.nonce === t.matches.nonce && e.focusIndex === t.focusIndex,
	H$ = (0, Gr.memo)(z$, $$),
	U$ = (e, t, r) => {
		let a = e.slice(0, t),
			s = a.split(/\s+/),
			c = a.endsWith(" "),
			d = s.length - 2 - 1 - (c ? 0 : 1),
			u = s.slice(d <= 0 ? 0 : d).join(" ") + (c ? " " : ""),
			f = 20;
		u = u.length > f ? u.slice(-f) : u;
		let m = e.slice(t + r.length),
			g = m.split(/\s+/),
			h = !m.startsWith(" "),
			y = h ? 6 : 5,
			E = (h ? "" : " ") + g.slice(0, y).join(" ");
		return {
			indexInSearchQuery: u.length,
			previewText: u + r + E,
			moreBefore: d > 0,
			moreAfter: g.length > y,
		};
	},
	G$ = (e, t) => {
		let r = e.split(`
`),
			o = [],
			i = 0;
		for (let a = 0; a < r.length; a++) {
			let s = r[a],
				c = r[a + 1];
			if (c) {
				let d = t.indexOf(c, i);
				if (d > s.length + i) {
					let u = d - (s.length + i);
					for (; u > 0; ) (s += " "), u--;
				}
			}
			o.push(s), (i = i + s.length);
		}
		return o.join(`
`);
	},
	W$ = (e, t, r) => {
		let i = G$(e.text, e.originalText).split(`
`),
			a = [],
			s = 0,
			c = 0;
		for (let m of i) {
			let g = s,
				h = g + m.length - 1;
			a.push({ line: m, startIndex: g, endIndex: h, lineNumber: c }),
				(s = h + 1),
				c++;
		}
		let d = r,
			u = e.originalText.slice(r, r + t.length),
			f = [];
		for (let m of a) {
			if (u === "") break;
			if (d >= m.startIndex && d <= m.endIndex) {
				let g = m.endIndex + 1 - d,
					h = m.line.slice(0, d - m.startIndex),
					y = u.slice(0, g);
				u = u.slice(g);
				let E = Ko(h, Lr(e), e.lineHeight, !0);
				if (
					(h === "" && (E.width = 0),
					e.textAlign !== "left" && m.line.length > 0)
				) {
					let k = Ko(m.line, Lr(e), e.lineHeight, !0),
						N =
							e.textAlign === "center"
								? (e.width - k.width) / 2
								: e.width - k.width;
					E.width += N;
				}
				let { width: T, height: I } = Ko(y, Lr(e), e.lineHeight),
					P = E.width,
					C = m.lineNumber * E.height;
				f.push({ offsetX: P, offsetY: C, width: T, height: I }), (d += g);
			}
		}
		return f;
	},
	K$ = (e) => e.replace(/[.*+?^${}()|[\]\\-]/g, "\\$&"),
	kM = (0, LM.debounce)((e, t, r) => {
		if (!e || e === "") {
			r([], null);
			return;
		}
		let i = t.scene.getNonDeletedElements().filter((u) => Ee(u));
		i.sort((u, f) => u.y - f.y);
		let a = [],
			s = new RegExp(K$(e), "gi");
		for (let u of i) {
			let f = null,
				m = u.originalText;
			for (; (f = s.exec(m)) !== null; ) {
				let g = U$(m, f.index, e),
					h = W$(u, e, f.index);
				h.length > 0 &&
					a.push({
						textElement: u,
						searchQuery: e,
						preview: g,
						index: f.index,
						matchedLines: h,
					});
			}
		}
		let c = new Set(t.visibleElements.map((u) => u.id)),
			d = a.findIndex((u) => c.has(u.textElement.id)) ?? null;
		r(a, d);
	}, F$);
var vo = w(M(), 1),
	DM = w(Q(), 1),
	PM = ra("DefaultSidebarTrigger", (e) => {
		let { DefaultSidebarTriggerTunnel: t } = Mt();
		return (0, vo.jsx)(t.In, {
			children: (0, vo.jsx)(Sn.Trigger, {
				...e,
				className: "default-sidebar-trigger",
				name: Vr.name,
			}),
		});
	});
PM.displayName = "DefaultSidebarTrigger";
var RM = ({ children: e }) => {
	let { DefaultSidebarTabTriggersTunnel: t } = Mt();
	return (0, vo.jsx)(t.In, { children: e });
};
RM.displayName = "DefaultTabTriggers";
var Yh = Object.assign(
	ra(
		"DefaultSidebar",
		({ children: e, className: t, onDock: r, docked: o, ...i }) => {
			let a = mt(),
				s = tt(),
				{ DefaultSidebarTabTriggersTunnel: c } = Mt(),
				d = a.openSidebar?.tab === Di;
			return (0, DM.createElement)(
				Sn,
				{
					...i,
					name: "default",
					key: "default",
					className: j("default-sidebar", t),
					docked: d || (o ?? a.defaultSidebarDockedPreference),
					onDock:
						d || r === !1 || (!r && o != null)
							? void 0
							: wa(r, (u) => {
									s({ defaultSidebarDockedPreference: u });
								}),
				},
				(0, vo.jsxs)(Sn.Tabs, {
					children: [
						(0, vo.jsx)(Sn.Header, {
							children: (0, vo.jsxs)(Sn.TabTriggers, {
								children: [
									(0, vo.jsx)(Sn.TabTrigger, { tab: Di, children: Go }),
									(0, vo.jsx)(Sn.TabTrigger, { tab: Xd, children: rc }),
									(0, vo.jsx)(c.Out, {}),
								],
							}),
						}),
						(0, vo.jsx)(Sn.Tab, { tab: Xd, children: (0, vo.jsx)(B3, {}) }),
						(0, vo.jsx)(Sn.Tab, { tab: Di, children: (0, vo.jsx)(MM, {}) }),
						e,
					],
				}),
			);
		},
	),
	{ Trigger: PM, TabTriggers: RM },
);
b();
var lu = w(M(), 1),
	Y$ = "small",
	NM = (e) =>
		(0, lu.jsxs)("label", {
			className: j("ToolIcon ToolIcon__LaserPointer", `ToolIcon_size_${Y$}`, {
				"is-mobile": e.isMobile,
			}),
			title: `${e.title}`,
			children: [
				(0, lu.jsx)("input", {
					className: "ToolIcon_type_checkbox",
					type: "checkbox",
					name: e.name,
					onChange: e.onChange,
					checked: e.checked,
					"aria-label": e.title,
					"data-testid": "toolbar-LaserPointer",
				}),
				(0, lu.jsx)("div", { className: "ToolIcon__icon", children: Vp }),
			],
		});
b();
b();
var jn = w(Q(), 1);
b();
var V$ = ({ canvasRef: e, setError: t }) => {
		let r = e.current;
		if (!r) return;
		let o = r.parentElement;
		o && ((o.style.background = ""), t(null), r.replaceChildren());
	},
	Vh = async ({
		canvasRef: e,
		mermaidToExcalidrawLib: t,
		mermaidDefinition: r,
		setError: o,
		data: i,
	}) => {
		let a = e.current,
			s = a?.parentElement;
		if (!(!a || !s)) {
			if (!r) {
				V$({ canvasRef: e, setError: o });
				return;
			}
			try {
				let c = await t.api,
					d;
				try {
					d = await c.parseMermaidToExcalidraw(r);
				} catch {
					d = await c.parseMermaidToExcalidraw(r.replace(/"/g, "'"));
				}
				let { elements: u, files: f } = d;
				o(null),
					(i.current = { elements: gd(u, { regenerateIds: !0 }), files: f });
				let m = await $l({
					elements: i.current.elements,
					files: i.current.files,
					exportPadding: ba,
					maxWidthOrHeight:
						Math.max(s.offsetWidth, s.offsetHeight) * window.devicePixelRatio,
				});
				try {
					await Hi(m);
				} catch (g) {
					throw g.name === "CANVAS_POSSIBLY_TOO_BIG"
						? new Error(v("canvasError.canvasTooBig"))
						: g;
				}
				(s.style.background = "var(--default-bg-color)"), a.replaceChildren(m);
			} catch (c) {
				throw ((s.style.background = "var(--default-bg-color)"), r && o(c), c);
			}
		}
	},
	su = (e) => {
		hi.set(xa.MERMAID_TO_EXCALIDRAW, e);
	},
	Xh = ({ app: e, data: t, text: r, shouldSaveMermaidDataToStorage: o }) => {
		let { elements: i, files: a } = t.current;
		i.length &&
			(e.addElementsFromPasteOrLibrary({
				elements: i,
				files: a,
				position: "center",
				fitToContent: !0,
			}),
			e.setOpenDialog(null),
			o && r && su(r));
	};
b();
var OM = w(M(), 1),
	Zh = ({ children: e }) =>
		(0, OM.jsx)("div", { className: "ttd-dialog-panels", children: e });
b();
var vi = w(M(), 1),
	hd = ({
		label: e,
		children: t,
		panelAction: r,
		panelActionDisabled: o = !1,
		onTextSubmitInProgess: i,
		renderTopRight: a,
		renderSubmitShortcut: s,
		renderBottomRight: c,
	}) =>
		(0, vi.jsxs)("div", {
			className: "ttd-dialog-panel",
			children: [
				(0, vi.jsxs)("div", {
					className: "ttd-dialog-panel__header",
					children: [(0, vi.jsx)("label", { children: e }), a?.()],
				}),
				t,
				(0, vi.jsxs)("div", {
					className: j("ttd-dialog-panel-button-container", { invisible: !r }),
					style: { display: "flex", alignItems: "center" },
					children: [
						(0, vi.jsxs)(Qo, {
							className: "ttd-dialog-panel-button",
							onSelect: r ? r.action : () => {},
							disabled: o || i,
							children: [
								(0, vi.jsxs)("div", {
									className: j({ invisible: i }),
									children: [
										r?.label,
										r?.icon && (0, vi.jsx)("span", { children: r.icon }),
									],
								}),
								i && (0, vi.jsx)($r, {}),
							],
						}),
						!o && !i && s?.(),
						c?.(),
					],
				}),
			],
		});
b();
var cu = w(Q(), 1);
var FM = w(M(), 1),
	qh = ({ input: e, placeholder: t, onChange: r, onKeyboardSubmit: o }) => {
		let i = (0, cu.useRef)(null),
			a = (0, cu.useRef)(o);
		return (
			(a.current = o),
			(0, cu.useEffect)(() => {
				if (!a.current) return;
				let s = i.current;
				if (s) {
					let c = (d) => {
						d[R.CTRL_OR_CMD] &&
							d.key === R.ENTER &&
							(d.preventDefault(), a.current?.());
					};
					return (
						s.addEventListener("keydown", c),
						() => {
							s.removeEventListener("keydown", c);
						}
					);
				}
			}, []),
			(0, FM.jsx)("textarea", {
				className: "ttd-dialog-input",
				onChange: r,
				value: e,
				placeholder: t,
				autoFocus: !0,
				ref: i,
			})
		);
	};
b();
var el = w(M(), 1),
	X$ = ({ error: e }) =>
		(0, el.jsxs)("div", {
			"data-testid": "ttd-dialog-output-error",
			className: "ttd-dialog-output-error",
			children: ["Error! ", (0, el.jsx)("p", { children: e })],
		}),
	jh = ({ error: e, canvasRef: t, loaded: r }) =>
		(0, el.jsxs)("div", {
			className: "ttd-dialog-output-wrapper",
			children: [
				e && (0, el.jsx)(X$, { error: e.message }),
				r
					? (0, el.jsx)("div", {
							ref: t,
							style: { opacity: e ? "0.15" : 1 },
							className: "ttd-dialog-output-canvas-container",
						})
					: (0, el.jsx)($r, { size: "2rem" }),
			],
		});
b();
var du = w(M(), 1),
	Qh = () =>
		(0, du.jsxs)("div", {
			className: "ttd-dialog-submit-shortcut",
			children: [
				(0, du.jsx)("div", {
					className: "ttd-dialog-submit-shortcut__key",
					children: V("CtrlOrCmd"),
				}),
				(0, du.jsx)("div", {
					className: "ttd-dialog-submit-shortcut__key",
					children: V("Enter"),
				}),
			],
		});
var eo = w(M(), 1),
	Z$ = `flowchart TD
 A[Christmas] -->|Get money| B(Go shopping)
 B --> C{Let me think}
 C -->|One| D[Laptop]
 C -->|Two| E[iPhone]
 C -->|Three| F[Car]`,
	BM = Sl(su, 300),
	q$ = ({ mermaidToExcalidrawLib: e }) => {
		let [t, r] = (0, jn.useState)(() => hi.get(xa.MERMAID_TO_EXCALIDRAW) || Z$),
			o = (0, jn.useDeferredValue)(t.trim()),
			[i, a] = (0, jn.useState)(null),
			s = (0, jn.useRef)(null),
			c = (0, jn.useRef)({ elements: [], files: null }),
			d = Jt();
		(0, jn.useEffect)(() => {
			Vh({
				canvasRef: s,
				data: c,
				mermaidToExcalidrawLib: e,
				setError: a,
				mermaidDefinition: o,
			}).catch((f) => {
				kp() && console.error("Failed to parse mermaid definition", f);
			}),
				BM(o);
		}, [o, e]),
			(0, jn.useEffect)(
				() => () => {
					BM.flush();
				},
				[],
			);
		let u = () => {
			Xh({ app: d, data: c, text: t, shouldSaveMermaidDataToStorage: !0 });
		};
		return (0, eo.jsxs)(eo.Fragment, {
			children: [
				(0, eo.jsx)("div", {
					className: "ttd-dialog-desc",
					children: (0, eo.jsx)(bo, {
						i18nKey: "mermaid.description",
						flowchartLink: (f) =>
							(0, eo.jsx)("a", {
								href: "https://mermaid.js.org/syntax/flowchart.html",
								children: f,
							}),
						sequenceLink: (f) =>
							(0, eo.jsx)("a", {
								href: "https://mermaid.js.org/syntax/sequenceDiagram.html",
								children: f,
							}),
						classLink: (f) =>
							(0, eo.jsx)("a", {
								href: "https://mermaid.js.org/syntax/classDiagram.html",
								children: f,
							}),
					}),
				}),
				(0, eo.jsxs)(Zh, {
					children: [
						(0, eo.jsx)(hd, {
							label: v("mermaid.syntax"),
							children: (0, eo.jsx)(qh, {
								input: t,
								placeholder: "Write Mermaid diagram defintion here...",
								onChange: (f) => r(f.target.value),
								onKeyboardSubmit: () => {
									u();
								},
							}),
						}),
						(0, eo.jsx)(hd, {
							label: v("mermaid.preview"),
							panelAction: {
								action: () => {
									u();
								},
								label: v("mermaid.button"),
								icon: lc,
							},
							renderSubmitShortcut: () => (0, eo.jsx)(Qh, {}),
							children: (0, eo.jsx)(jh, {
								canvasRef: s,
								loaded: e.loaded,
								error: i,
							}),
						}),
					],
				}),
			],
		});
	},
	zM = q$;
b();
var $0 = w(Q(), 1);
var UM = w(M(), 1),
	$M = (e) => {
		let t = tt(),
			r = (0, $0.useRef)(null),
			o = (0, $0.useRef)(0);
		return (0, UM.jsx)(zh, {
			ref: r,
			className: "ttd-dialog-tabs-root",
			value: e.tab,
			onValueChange: (i) => {
				if (!i) return;
				let a = r.current?.closest(".Modal__content");
				if (a) {
					let s = a.offsetHeight || 0;
					s > o.current &&
						((o.current = s),
						(a.style.minHeight = `min(${o.current}px, 100%)`));
				}
				e.dialog === "ttd" &&
					ZT(["text-to-diagram", "mermaid"], i) &&
					t({ openDialog: { name: e.dialog, tab: i } });
			},
			children: e.children,
		});
	};
$M.displayName = "TTDDialogTabs";
var HM = $M;
var Qn = w(Q(), 1);
b();
var GM = w(M(), 1),
	H0 = ({ children: e, ...t }) =>
		(0, GM.jsx)($h, { className: "ttd-dialog-triggers", ...t, children: e });
H0.displayName = "TTDDialogTabTriggers";
b();
var U0 = w(M(), 1),
	Jh = ({ children: e, tab: t, onSelect: r, ...o }) =>
		(0, U0.jsx)(Hh, {
			value: t,
			asChild: !0,
			onSelect: r,
			children: (0, U0.jsx)("button", {
				type: "button",
				className: "ttd-dialog-tab-trigger",
				...o,
				children: e,
			}),
		});
Jh.displayName = "TTDDialogTabTrigger";
b();
var WM = w(M(), 1),
	eb = ({ tab: e, children: t, ...r }) =>
		(0, WM.jsx)(Uh, { ...r, value: e, children: t });
eb.displayName = "TTDDialogTab";
var Ht = w(M(), 1),
	G0 = 3,
	bd = 1e3,
	j$ = xt(null),
	Q$ = xt(null),
	W0 = (e) => {
		let t = mt();
		return t.openDialog?.name !== "ttd"
			? null
			: (0, Ht.jsx)(J$, { ...e, tab: t.openDialog.tab });
	},
	J$ = ra("TTDDialogBase", ({ tab: e, ...t }) => {
		let r = Jt(),
			o = tt(),
			i = (0, Qn.useRef)(null),
			[a, s] = Ge(Q$),
			[c, d] = (0, Qn.useState)(a?.prompt ?? ""),
			u = c.trim(),
			f = (D) => {
				d(D.target.value),
					s((B) => ({
						generatedResponse: B?.generatedResponse ?? null,
						prompt: D.target.value,
					}));
			},
			[m, g] = (0, Qn.useState)(!1),
			[h, y] = Ge(j$),
			E = async () => {
				if (
					u.length > bd ||
					u.length < G0 ||
					m ||
					h?.rateLimitRemaining === 0 ||
					"__fallback" in t
				) {
					u.length < G0 &&
						N(new Error(`Prompt is too short (min ${G0} characters)`)),
						u.length > bd &&
							N(new Error(`Prompt is too long (max ${bd} characters)`));
					return;
				}
				try {
					g(!0), We("ai", "generate", "ttd");
					let {
						generatedResponse: D,
						error: B,
						rateLimit: F,
						rateLimitRemaining: W,
					} = await t.onTextSubmit(u);
					if (
						(typeof D == "string" &&
							s((G) => ({ generatedResponse: D, prompt: G?.prompt ?? null })),
						ev(F) && ev(W) && y({ rateLimit: F, rateLimitRemaining: W }),
						B)
					) {
						N(B);
						return;
					}
					if (!D) {
						N(new Error("Generation failed"));
						return;
					}
					try {
						await Vh({
							canvasRef: i,
							data: C,
							mermaidToExcalidrawLib: I,
							setError: N,
							mermaidDefinition: D,
						}),
							We("ai", "mermaid parse success", "ttd");
					} catch (G) {
						console.info(
							`%cTTD mermaid render errror: ${G.message}`,
							"color: red",
						),
							console.info(
								`>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
TTD mermaid definition render errror: ${G.message}`,
								"color: yellow",
							),
							We("ai", "mermaid parse failed", "ttd"),
							N(
								new Error(
									"Generated an invalid diagram :(. You may also try a different prompt.",
								),
							);
					}
				} catch (D) {
					let B = D.message;
					(!B || B === "Failed to fetch") && (B = "Request failed"),
						N(new Error(B));
				} finally {
					g(!1);
				}
			},
			T = (0, Qn.useRef)(E);
		T.current = E;
		let [I, P] = (0, Qn.useState)({
			loaded: !1,
			api: import("./excalidraw-assets/dist-QNDTTFGF.js"),
		});
		(0, Qn.useEffect)(() => {
			(async () => {
				await I.api, P((B) => ({ ...B, loaded: !0 }));
			})();
		}, [I.api]);
		let C = (0, Qn.useRef)({ elements: [], files: null }),
			[k, N] = (0, Qn.useState)(null);
		return (0, Ht.jsx)(er, {
			className: "ttd-dialog",
			onCloseRequest: () => {
				r.setOpenDialog(null);
			},
			size: 1200,
			title: !1,
			...t,
			autofocus: !1,
			children: (0, Ht.jsxs)(HM, {
				dialog: "ttd",
				tab: e,
				children: [
					"__fallback" in t && t.__fallback
						? (0, Ht.jsx)("p", {
								className: "dialog-mermaid-title",
								children: v("mermaid.title"),
							})
						: (0, Ht.jsxs)(H0, {
								children: [
									(0, Ht.jsx)(Jh, {
										tab: "text-to-diagram",
										children: (0, Ht.jsxs)("div", {
											style: { display: "flex", alignItems: "center" },
											children: [
												v("labels.textToDiagram"),
												(0, Ht.jsx)("div", {
													style: {
														display: "flex",
														alignItems: "center",
														justifyContent: "center",
														padding: "1px 6px",
														marginLeft: "10px",
														fontSize: 10,
														borderRadius: "12px",
														background: "var(--color-promo)",
														color: "var(--color-surface-lowest)",
													},
													children: "AI Beta",
												}),
											],
										}),
									}),
									(0, Ht.jsx)(Jh, { tab: "mermaid", children: "Mermaid" }),
								],
							}),
					(0, Ht.jsx)(eb, {
						className: "ttd-dialog-content",
						tab: "mermaid",
						children: (0, Ht.jsx)(zM, { mermaidToExcalidrawLib: I }),
					}),
					!("__fallback" in t) &&
						(0, Ht.jsxs)(eb, {
							className: "ttd-dialog-content",
							tab: "text-to-diagram",
							children: [
								(0, Ht.jsx)("div", {
									className: "ttd-dialog-desc",
									children:
										"Currently we use Mermaid as a middle step, so you'll get best results if you describe a diagram, workflow, flow chart, and similar.",
								}),
								(0, Ht.jsxs)(Zh, {
									children: [
										(0, Ht.jsx)(hd, {
											label: v("labels.prompt"),
											panelAction: { action: E, label: "Generate", icon: lc },
											onTextSubmitInProgess: m,
											panelActionDisabled:
												u.length > bd || h?.rateLimitRemaining === 0,
											renderTopRight: () =>
												h
													? (0, Ht.jsxs)("div", {
															className: "ttd-dialog-rate-limit",
															style: {
																fontSize: 12,
																marginLeft: "auto",
																color:
																	h.rateLimitRemaining === 0
																		? "var(--color-danger)"
																		: void 0,
															},
															children: [
																h.rateLimitRemaining,
																" requests left today",
															],
														})
													: null,
											renderSubmitShortcut: () => (0, Ht.jsx)(Qh, {}),
											renderBottomRight: () => {
												if (typeof a?.generatedResponse == "string")
													return (0, Ht.jsxs)("div", {
														className: "excalidraw-link",
														style: { marginLeft: "auto", fontSize: 14 },
														onClick: () => {
															typeof a?.generatedResponse == "string" &&
																(su(a.generatedResponse),
																o({
																	openDialog: { name: "ttd", tab: "mermaid" },
																}));
														},
														children: [
															"View as Mermaid",
															(0, Ht.jsx)(Xa, { icon: lc }),
														],
													});
												let D = u.length / bd;
												return D > 0.8
													? (0, Ht.jsxs)("div", {
															style: {
																marginLeft: "auto",
																fontSize: 12,
																fontFamily: "monospace",
																color: D > 1 ? "var(--color-danger)" : void 0,
															},
															children: ["Length: ", u.length, "/", bd],
														})
													: null;
											},
											children: (0, Ht.jsx)(qh, {
												onChange: f,
												input: c,
												placeholder: "Describe what you want to see...",
												onKeyboardSubmit: () => {
													T.current();
												},
											}),
										}),
										(0, Ht.jsx)(hd, {
											label: "Preview",
											panelAction: {
												action: () => {
													console.info("Panel action clicked"),
														Xh({ app: r, data: C });
												},
												label: "Insert",
												icon: lc,
											},
											children: (0, Ht.jsx)(jh, {
												canvasRef: i,
												error: k,
												loaded: I.loaded,
											}),
										}),
									],
								}),
							],
						}),
				],
			}),
		});
	});
b();
var yi = w(Q(), 1);
var fP = w(B0(), 1);
b();
b();
var Ei = w(Q(), 1);
b();
var KM = 0.01,
	Ro = (e, t) =>
		!(
			(t === "height" && Ee(e)) ||
			(t === "width" && Ee(e)) ||
			(t === "angle" && Ye(e))
		),
	Ut = (e, t) => {
		let r = e + t / 2;
		return r - (r % t);
	},
	xd = (e, t, r) =>
		Object.keys(e)
			.map((o) => ({ original: (r ?? t).get(o), latest: t.get(o) }))
			.filter((o) => o.original !== void 0 && o.latest !== void 0);
var vs = (e, t, r, o, i, a, s, c = !0) => {
		let d = o.get(r.id);
		if (!d) return;
		let [u, f] = [r.x + r.width / 2, r.y + r.height / 2],
			[m, g] = ao(pe(r.x, r.y), pe(u, f), r.angle),
			h = e - m,
			y = t - g,
			[E, T] = ao(pe(e, t), pe(u + h, f + y), -r.angle);
		me(d, { x: E, y: T }, c), tb(d, o, i, a);
		let I = ot(r, s);
		if (I) {
			let P = o.get(I.id);
			P && me(P, { x: I.x + h, y: I.y + y }, c);
		}
	},
	vd = (e, t) => {
		let o = Fn(t).map((i) =>
			Vt(e, i).reduce((a, s) => ((a[s.id] = !0), a), {}),
		);
		return (
			e
				.filter((i) => !Ta(i))
				.forEach((i) => {
					o.push({ [i.id]: !0 });
				}),
			o
		);
	},
	tb = (e, t, r, o, i) => {
		at(e) ? Ol([e], t, r, o, !0, [], i?.zoom) : _a(e, t, i);
	};
var Ed = w(M(), 1),
	eH = ({
		label: e,
		icon: t,
		dragInputCallback: r,
		value: o,
		elements: i,
		editable: a = !0,
		shouldKeepAspectRatio: s,
		property: c,
		scene: d,
		appState: u,
		sensitivity: f = 1,
	}) => {
		let m = Jt(),
			g = (0, Ei.useRef)(null),
			h = (0, Ei.useRef)(null),
			[y, E] = (0, Ei.useState)(o.toString()),
			T = (0, Ei.useRef)(null);
		T.current ||
			(T.current = {
				originalAppState: _o(u),
				originalElements: i,
				lastUpdatedValue: y,
				updatePending: !1,
			}),
			(0, Ei.useEffect)(() => {
				let C = o.toString();
				E(C), (T.current.lastUpdatedValue = C);
			}, [o]);
		let I = (C, k, N) => {
				if (!T.current.updatePending) return !1;
				T.current.updatePending = !1;
				let D = Number(C);
				if (isNaN(D)) {
					E(o.toString());
					return;
				}
				let B = Number(D.toFixed(2)),
					F = Number(o);
				(isNaN(F) || Math.abs(B - F) >= KM) &&
					((T.current.lastUpdatedValue = C),
					r({
						accumulatedChange: 0,
						instantChange: 0,
						originalElements: k,
						originalElementsMap: m.scene.getNonDeletedElementsMap(),
						shouldKeepAspectRatio: s,
						shouldChangeByStepSize: !1,
						scene: d,
						nextValue: B,
						property: c,
						originalAppState: N,
						setInputValue: (W) => E(String(W)),
					}),
					m.syncActionResult({ storeAction: H.CAPTURE }));
			},
			P = (0, Ei.useRef)({});
		return (
			(P.current.handleInputValue = I),
			(0, Ei.useEffect)(() => {
				let C = g.current,
					k = P.current;
				return () => {
					let N = C?.value;
					N &&
						k.handleInputValue?.(
							N,
							T.current.originalElements,
							T.current.originalAppState,
						),
						window.removeEventListener("pointermove", k.onPointerMove, !1),
						window.removeEventListener("pointerup", k.onPointerUp, !1);
				};
			}, [a]),
			a
				? (0, Ed.jsxs)("div", {
						className: j("drag-input-container", !a && "disabled"),
						"data-testid": e,
						children: [
							(0, Ed.jsx)("div", {
								className: "drag-input-label",
								ref: h,
								onPointerDown: (C) => {
									if (g.current && a) {
										document.body.classList.add("excalidraw-cursor-resize");
										let k = Number(g.current.value);
										isNaN(k) && (k = 0);
										let N = null,
											D = m.scene
												.getNonDeletedElements()
												.reduce(
													(te, we) => (te.set(we.id, dc(we)), te),
													new Map(),
												),
											B = i.map((te) => D.get(te.id)),
											F = _o(u),
											W = 0,
											G = 0,
											q = (te) => {
												if (N && D !== null && B !== null) {
													let we = te.clientX - N.x;
													we !== 0 &&
														((G += we),
														Math.abs(G) >= f &&
															((G = Math.sign(G) * Math.floor(Math.abs(G) / f)),
															(W += G),
															r({
																accumulatedChange: W,
																instantChange: G,
																originalElements: B,
																originalElementsMap: D,
																shouldKeepAspectRatio: s,
																shouldChangeByStepSize: te.shiftKey,
																property: c,
																scene: d,
																originalAppState: F,
																setInputValue: (X) => E(String(X)),
															}),
															(G = 0)));
												}
												N = { x: te.clientX, y: te.clientY };
											},
											ie = () => {
												window.removeEventListener("pointermove", q, !1),
													m.syncActionResult({ storeAction: H.CAPTURE }),
													(N = null),
													(W = 0),
													(G = 0),
													(B = null),
													(D = null),
													document.body.classList.remove(
														"excalidraw-cursor-resize",
													),
													window.removeEventListener("pointerup", ie, !1);
											};
										(P.current.onPointerMove = q),
											(P.current.onPointerUp = ie),
											window.addEventListener("pointermove", q, !1),
											window.addEventListener("pointerup", ie, !1);
									}
								},
								onPointerEnter: () => {
									h.current && (h.current.style.cursor = "ew-resize");
								},
								children: t ? (0, Ed.jsx)(Xa, { icon: t }) : e,
							}),
							(0, Ed.jsx)("input", {
								className: "drag-input",
								autoComplete: "off",
								spellCheck: "false",
								onKeyDown: (C) => {
									if (a) {
										let k = C.target;
										k instanceof HTMLInputElement &&
											C.key === R.ENTER &&
											(I(k.value, i, u), m.focusContainer());
									}
								},
								ref: g,
								value: y,
								onChange: (C) => {
									(T.current.updatePending = !0), E(C.target.value);
								},
								onFocus: (C) => {
									C.target.select(),
										(T.current.originalElements = i),
										(T.current.originalAppState = _o(u));
								},
								onBlur: (C) => {
									y
										? a &&
											I(
												C.target.value,
												T.current.originalElements,
												T.current.originalAppState,
											)
										: E(o.toString());
								},
								disabled: !a,
							}),
						],
					})
				: null
		);
	},
	Nr = eH;
var VM = w(M(), 1),
	YM = 10,
	tH = (e) => e.type === "image",
	rH = ({
		accumulatedChange: e,
		originalElements: t,
		originalElementsMap: r,
		shouldKeepAspectRatio: o,
		shouldChangeByStepSize: i,
		nextValue: a,
		property: s,
		originalAppState: c,
		instantChange: d,
		scene: u,
	}) => {
		let f = u.getNonDeletedElementsMap(),
			m = t[0],
			g = f.get(m.id);
		if (m && g) {
			let h = o || tH(m),
				y = m.width / m.height;
			if (c.croppingElementId === m.id) {
				let C = f.get(m.id);
				if (!C || !ct(C) || !C.crop) return;
				let k = C.crop,
					N = { ...k },
					D = C.scale[0] === -1,
					B = C.scale[1] === -1,
					{ width: F, height: W } = Bl(C),
					G = k.naturalWidth / F,
					q = k.naturalHeight / W,
					ie = D ? k.width + k.x : k.naturalWidth - k.x,
					te = B ? k.height + k.y : k.naturalHeight - k.y,
					we = Nv * G,
					X = Nv * q;
				if (a !== void 0) {
					if (s === "width") {
						let Y = a * G,
							K = kr(Y, we, ie);
						N = { ...N, width: K, x: D ? k.x + k.width - K : k.x };
					} else if (s === "height") {
						let Y = a * q,
							K = kr(Y, X, te);
						N = { ...N, height: K, y: B ? k.y + k.height - K : k.y };
					}
					me(C, {
						crop: N,
						width: N.width / (k.naturalWidth / F),
						height: N.height / (k.naturalHeight / W),
					});
					return;
				}
				let se = s === "width" ? d : 0,
					Pe = s === "height" ? d : 0,
					ke = kr(k.width + se, we, ie),
					fe = kr(k.height + Pe, we, te);
				(N = {
					...k,
					x: D ? k.x + k.width - ke : k.x,
					y: B ? k.y + k.height - fe : k.y,
					width: ke,
					height: fe,
				}),
					me(C, {
						crop: N,
						width: N.width / (k.naturalWidth / F),
						height: N.height / (k.naturalHeight / W),
					});
				return;
			}
			if (a !== void 0) {
				let C = Math.max(s === "width" ? a : h ? a * y : m.width, Io),
					k = Math.max(s === "height" ? a : h ? a / y : m.height, Io);
				Ec(C, k, g, m, f, r, s === "width" ? "e" : "s", {
					shouldMaintainAspectRatio: h,
				});
				return;
			}
			let E = s === "width" ? e : 0,
				T = s === "height" ? e : 0,
				I = Math.max(0, m.width + E);
			s === "width" && (i ? (I = Ut(I, YM)) : (I = Math.round(I)));
			let P = Math.max(0, m.height + T);
			s === "height" && (i ? (P = Ut(P, YM)) : (P = Math.round(P))),
				h &&
					(s === "width"
						? (P = Math.round((I / y) * 100) / 100)
						: (I = Math.round(P * y * 100) / 100)),
				(P = Math.max(Io, P)),
				(I = Math.max(Io, I)),
				Ec(I, P, g, m, f, r, s === "width" ? "e" : "s", {
					shouldMaintainAspectRatio: h,
				});
		}
	},
	oH = ({ property: e, element: t, scene: r, appState: o }) => {
		let i = cn(e === "width" ? t.width : t.height, 2);
		if (
			o.croppingElementId &&
			o.croppingElementId === t.id &&
			ct(t) &&
			t.crop
		) {
			let { width: a, height: s } = Bl(t);
			if (e === "width") {
				let c = a / t.crop.naturalWidth;
				i = cn(t.crop.width * c, 2);
			}
			if (e === "height") {
				let c = s / t.crop.naturalHeight;
				i = cn(t.crop.height * c, 2);
			}
		}
		return (0, VM.jsx)(Nr, {
			label: e === "width" ? "W" : "H",
			elements: [t],
			dragInputCallback: rH,
			value: i,
			editable: Ro(t, e),
			scene: r,
			appState: o,
			property: e,
		});
	},
	K0 = oH;
b();
var ZM = w(M(), 1),
	nH = 15,
	iH = ({
		accumulatedChange: e,
		originalElements: t,
		shouldChangeByStepSize: r,
		nextValue: o,
		scene: i,
	}) => {
		let a = i.getNonDeletedElementsMap(),
			s = i.getNonDeletedElements(),
			c = t[0];
		if (c && !qe(c)) {
			let d = a.get(c.id);
			if (!d) return;
			if (o !== void 0) {
				let y = Us(o);
				me(d, { angle: y }), tb(d, a, s, i);
				let E = ot(d, a);
				E && !Lt(d) && me(E, { angle: y });
				return;
			}
			let u = Math.round(Gs(c.angle) * 100) / 100,
				f = Math.round(e),
				m = (u + f) % 360;
			r && (m = Ut(m, nH)), (m = m < 0 ? m + 360 : m);
			let g = Us(m);
			me(d, { angle: g }), tb(d, a, s, i);
			let h = ot(d, a);
			h && !Lt(d) && me(h, { angle: g });
		}
	},
	aH = ({ element: e, scene: t, appState: r, property: o }) =>
		(0, ZM.jsx)(Nr, {
			label: "A",
			icon: Gp,
			value: Math.round((Gs(e.angle) % 360) * 100) / 100,
			elements: [e],
			dragInputCallback: iH,
			editable: Ro(e, "angle"),
			scene: t,
			appState: r,
			property: o,
		}),
	XM = aH;
b();
var QM = w(M(), 1),
	qM = 4,
	lH = 4,
	sH = ({
		accumulatedChange: e,
		originalElements: t,
		shouldChangeByStepSize: r,
		nextValue: o,
		scene: i,
	}) => {
		let a = i.getNonDeletedElementsMap(),
			s = t[0];
		if (s) {
			let c = a.get(s.id);
			if (!c || !Ee(c)) return;
			let d;
			if (o !== void 0) d = Math.max(Math.round(o), qM);
			else if (s.type === "text") {
				let u = Math.round(s.fontSize),
					f = Math.round(e);
				(d = Math.max(u + f, qM)), r && (d = Ut(d, lH));
			}
			d &&
				(me(c, { fontSize: d }),
				jt(c, i.getContainerElement(c), i.getNonDeletedElementsMap()));
		}
	},
	cH = ({ element: e, scene: t, appState: r, property: o }) => {
		let i = Ee(e) ? e : Ao(e) ? ot(e, t.getNonDeletedElementsMap()) : null;
		return i
			? (0, QM.jsx)(Nr, {
					label: "F",
					value: Math.round(i.fontSize * 10) / 10,
					elements: [i],
					dragInputCallback: sH,
					icon: Pl,
					appState: r,
					scene: t,
					property: o,
				})
			: null;
	},
	jM = cH;
b();
var eP = w(Q(), 1);
var tP = w(M(), 1),
	yd = 10,
	dH = (e, t, r, o) => {
		let i = o.x - e,
			a = o.y - t,
			s = o.width * r,
			c = o.height * r,
			d = e + i * r,
			u = t + a * r;
		return {
			width: s,
			height: c,
			x: d,
			y: u,
			...R_(o, s, c, !1),
			...(Ee(o) ? { fontSize: o.fontSize * r } : {}),
		};
	},
	mH = (e, t, r, o, i, a, s, c) => {
		let d = dH(e, t, o, a);
		me(i, d, !1);
		let u = ot(a, c);
		if (u) {
			let f = u.fontSize * o;
			_a(i, s, { newSize: { width: d.width, height: d.height } });
			let m = s.get(u.id);
			m &&
				Ee(m) &&
				(me(m, { fontSize: f }, !1), f_(i, s, r === "width" ? "e" : "s", !0));
		}
	},
	JM = (e, t, r, o, i, a, s, c, d, u) => {
		a === "width"
			? (t = Math.round((e / o) * 100) / 100)
			: (e = Math.round(t * o * 100) / 100);
		let f = t / r;
		for (let m = 0; m < c.length; m++) {
			let g = c[m],
				h = s[m];
			mH(i[0], i[1], a, f, h, g, d, u);
		}
	},
	uH = ({
		accumulatedChange: e,
		originalElements: t,
		originalElementsMap: r,
		originalAppState: o,
		shouldChangeByStepSize: i,
		nextValue: a,
		scene: s,
		property: c,
	}) => {
		let d = s.getNonDeletedElementsMap(),
			u = vd(t, o);
		if (a !== void 0) {
			for (let g of u) {
				let h = xd(g, d, r);
				if (h.length > 1) {
					let y = h.map((W) => W.latest),
						E = h.map((W) => W.original),
						[T, I, P, C] = yt(E),
						k = P - T,
						N = C - I,
						D = k / N,
						B = Math.max(Io, c === "width" ? Math.max(0, a) : k),
						F = Math.max(Io, c === "height" ? Math.max(0, a) : N);
					JM(B, F, N, D, pe(T, I), c, y, E, d, r);
				} else {
					let [y] = h,
						E = y?.latest,
						T = y?.original;
					if (E && T && Ro(E, c)) {
						let I = c === "width" ? Math.max(0, a) : E.width;
						c === "width" && (i ? (I = Ut(I, yd)) : (I = Math.round(I)));
						let P = c === "height" ? Math.max(0, a) : E.height;
						c === "height" && (i ? (P = Ut(P, yd)) : (P = Math.round(P))),
							(I = Math.max(Io, I)),
							(P = Math.max(Io, P)),
							Ec(I, P, E, T, d, r, c === "width" ? "e" : "s", {
								shouldInformMutation: !1,
							});
					}
				}
			}
			s.triggerUpdate();
			return;
		}
		let f = c === "width" ? e : 0,
			m = c === "height" ? e : 0;
		for (let g of u) {
			let h = xd(g, d, r);
			if (h.length > 1) {
				let y = h.map((W) => W.latest),
					E = h.map((W) => W.original),
					[T, I, P, C] = yt(E),
					k = P - T,
					N = C - I,
					D = k / N,
					B = Math.max(0, k + f);
				c === "width" && (i ? (B = Ut(B, yd)) : (B = Math.round(B)));
				let F = Math.max(0, N + m);
				c === "height" && (i ? (F = Ut(F, yd)) : (F = Math.round(F))),
					(B = Math.max(Io, B)),
					(F = Math.max(Io, F)),
					JM(B, F, N, D, pe(T, I), c, y, E, d, r);
			} else {
				let [y] = h,
					E = y?.latest,
					T = y?.original;
				if (E && T && Ro(E, c)) {
					let I = Math.max(0, T.width + f);
					c === "width" && (i ? (I = Ut(I, yd)) : (I = Math.round(I)));
					let P = Math.max(0, T.height + m);
					c === "height" && (i ? (P = Ut(P, yd)) : (P = Math.round(P))),
						(I = Math.max(Io, I)),
						(P = Math.max(Io, P)),
						Ec(I, P, E, T, d, r, c === "width" ? "e" : "s", {
							shouldInformMutation: !1,
						});
				}
			}
		}
		s.triggerUpdate();
	},
	pH = ({
		property: e,
		elements: t,
		elementsMap: r,
		atomicUnits: o,
		scene: i,
		appState: a,
	}) => {
		let s = (0, eP.useMemo)(
				() =>
					o.map((u) => {
						let f = xd(u, r);
						if (f.length > 1) {
							let [g, h, y, E] = yt(f.map((T) => T.latest));
							return Math.round((e === "width" ? y - g : E - h) * 100) / 100;
						}
						let [m] = f;
						return (
							Math.round(
								(e === "width" ? m.latest.width : m.latest.height) * 100,
							) / 100
						);
					}),
				[r, o, e],
			),
			c = new Set(s).size === 1 ? Math.round(s[0] * 100) / 100 : "Mixed",
			d = s.length > 0;
		return (0, tP.jsx)(Nr, {
			label: e === "width" ? "W" : "H",
			elements: t,
			dragInputCallback: uH,
			value: c,
			editable: d,
			appState: a,
			property: e,
			scene: i,
		});
	},
	Y0 = pH;
b();
var oP = w(M(), 1),
	fH = 15,
	gH = ({
		accumulatedChange: e,
		originalElements: t,
		shouldChangeByStepSize: r,
		nextValue: o,
		property: i,
		scene: a,
	}) => {
		let s = a.getNonDeletedElementsMap(),
			c = t.map((u) => s.get(u.id)).filter((u) => u && !Ta(u) && Ro(u, i)),
			d = t.filter((u) => !Ta(u) && Ro(u, i));
		if (o !== void 0) {
			let u = Us(o);
			for (let f of c) {
				if (!f) continue;
				me(f, { angle: u }, !1);
				let m = ot(f, s);
				m && !Lt(f) && me(m, { angle: u }, !1);
			}
			a.triggerUpdate();
			return;
		}
		for (let u = 0; u < c.length; u++) {
			let f = c[u];
			if (!f) continue;
			let m = d[u],
				g = Math.round(Gs(m.angle) * 100) / 100,
				h = Math.round(e),
				y = (g + h) % 360;
			r && (y = Ut(y, fH)), (y = y < 0 ? y + 360 : y);
			let E = Us(y);
			me(f, { angle: E }, !1);
			let T = ot(f, s);
			T && !Lt(f) && me(T, { angle: E }, !1);
		}
		a.triggerUpdate();
	},
	hH = ({ elements: e, scene: t, appState: r, property: o }) => {
		let i = e.filter((d) => !Ta(d) && Ro(d, "angle")),
			a = i.map((d) => Math.round((Gs(d.angle) % 360) * 100) / 100),
			s = new Set(a).size === 1 ? a[0] : "Mixed",
			c = i.some((d) => Ro(d, "angle"));
		return (0, oP.jsx)(Nr, {
			label: "A",
			icon: Gp,
			value: s,
			elements: e,
			dragInputCallback: gH,
			editable: c,
			appState: r,
			scene: t,
			property: o,
		});
	},
	rP = hH;
b();
var aP = w(M(), 1),
	nP = 4,
	bH = 4,
	xH = (e, t) =>
		e.reduce((r, o) => {
			if (!o || Ta(o)) return r;
			if (Ee(o)) return r.push(o), r;
			if (Ao(o)) {
				let i = ot(o, t);
				if (i) return r.push(i), r;
			}
			return r;
		}, []),
	vH = ({
		accumulatedChange: e,
		originalElements: t,
		shouldChangeByStepSize: r,
		nextValue: o,
		scene: i,
	}) => {
		let a = i.getNonDeletedElementsMap(),
			s = t.map((d) => a.get(d.id)),
			c;
		if (o) {
			c = Math.max(Math.round(o), nP);
			for (let d of s)
				me(d, { fontSize: c }, !1), jt(d, i.getContainerElement(d), a, !1);
			i.triggerUpdate();
		} else {
			let d = t;
			for (let u = 0; u < s.length; u++) {
				let f = s[u],
					m = d[u],
					g = Math.round(m.fontSize),
					h = Math.round(e),
					y = Math.max(g + h, nP);
				r && (y = Ut(y, bH)),
					me(f, { fontSize: y }, !1),
					jt(f, i.getContainerElement(f), a, !1);
			}
			i.triggerUpdate();
		}
	},
	EH = ({
		elements: e,
		scene: t,
		appState: r,
		property: o,
		elementsMap: i,
	}) => {
		let a = xH(e, i);
		if (!a.length) return null;
		let s = a.map((u) => Math.round(u.fontSize * 10) / 10),
			c = new Set(s).size === 1 ? s[0] : "Mixed",
			d = s.length > 0;
		return (0, aP.jsx)(Nr, {
			label: "F",
			icon: Pl,
			elements: a,
			dragInputCallback: vH,
			value: c,
			editable: d,
			scene: t,
			property: o,
			appState: r,
		});
	},
	iP = EH;
b();
var sP = w(M(), 1),
	lP = 10,
	yH = ({
		accumulatedChange: e,
		instantChange: t,
		originalElements: r,
		originalElementsMap: o,
		shouldChangeByStepSize: i,
		nextValue: a,
		property: s,
		scene: c,
		originalAppState: d,
	}) => {
		let u = c.getNonDeletedElementsMap(),
			f = c.getNonDeletedElements(),
			m = r[0],
			[g, h] = [m.x + m.width / 2, m.y + m.height / 2],
			[y, E] = ao(pe(m.x, m.y), pe(g, h), m.angle);
		if (d.croppingElementId === m.id) {
			let k = u.get(m.id);
			if (!k || !ct(k) || !k.crop) return;
			let N = k.crop,
				D = N,
				B = k.scale[0] === -1,
				F = k.scale[1] === -1,
				{ width: W, height: G } = Bl(k);
			if (a !== void 0) {
				if (s === "x") {
					let te = a * (N.naturalWidth / W);
					B
						? (D = {
								...N,
								x: kr(
									N.naturalWidth - te - N.width,
									0,
									N.naturalWidth - N.width,
								),
							})
						: (D = {
								...N,
								x: kr(a * (N.naturalWidth / W), 0, N.naturalWidth - N.width),
							});
				}
				s === "y" &&
					(D = {
						...N,
						y: kr(a * (N.naturalHeight / G), 0, N.naturalHeight - N.height),
					}),
					me(k, { crop: D });
				return;
			}
			let q = (s === "x" ? t : 0) * (B ? -1 : 1),
				ie = (s === "y" ? t : 0) * (F ? -1 : 1);
			(D = {
				...N,
				x: kr(N.x + q, 0, N.naturalWidth - N.width),
				y: kr(N.y + ie, 0, N.naturalHeight - N.height),
			}),
				me(k, { crop: D });
			return;
		}
		if (a !== void 0) {
			vs(s === "x" ? a : y, s === "y" ? a : E, m, u, f, c, o);
			return;
		}
		let T = s === "x" ? e : 0,
			I = s === "y" ? e : 0,
			P = s === "x" ? Math.round(i ? Ut(m.x + T, lP) : y + T) : y,
			C = s === "y" ? Math.round(i ? Ut(m.y + I, lP) : E + I) : E;
		vs(P, C, m, u, f, c, o);
	},
	wH = ({ property: e, element: t, elementsMap: r, scene: o, appState: i }) => {
		let [a, s] = ao(
				pe(t.x, t.y),
				pe(t.x + t.width / 2, t.y + t.height / 2),
				t.angle,
			),
			c = cn(e === "x" ? a : s, 2);
		if (i.croppingElementId === t.id && ct(t) && t.crop) {
			let d = EI(t);
			d && (c = cn(e === "x" ? d.x : d.y, 2));
		}
		return (0, sP.jsx)(Nr, {
			label: e === "x" ? "X" : "Y",
			elements: [t],
			dragInputCallback: yH,
			scene: o,
			value: c,
			property: e,
			appState: i,
		});
	},
	V0 = wH;
b();
var cP = w(Q(), 1);
var dP = w(M(), 1),
	SH = 10,
	TH = (e, t, r, o, i, a, s, c) => {
		for (let d = 0; d < o.length; d++) {
			let u = i[d],
				[f, m] = [u.x + u.width / 2, u.y + u.height / 2],
				[g, h] = ao(pe(u.x, u.y), pe(f, m), u.angle),
				y = e === "x" ? Math.round(g + t) : g,
				E = e === "y" ? Math.round(h + r) : h;
			vs(y, E, u, a, o, c, s, !1);
		}
	},
	CH = (e, t, r, o, i, a, s) => {
		let [c, d, ,] = yt(r),
			u = e - c,
			f = t - d;
		for (let m = 0; m < r.length; m++) {
			let g = r[m],
				h = o.get(g.id);
			if (h && (!Ee(h) || !h.containerId)) {
				let [y, E] = [h.x + h.width / 2, h.y + h.height / 2],
					[T, I] = ao(pe(h.x, h.y), pe(y, E), h.angle);
				vs(T + u, I + f, g, o, i, s, a, !1);
			}
		}
	},
	IH = ({
		accumulatedChange: e,
		originalElements: t,
		originalElementsMap: r,
		shouldChangeByStepSize: o,
		nextValue: i,
		property: a,
		scene: s,
		originalAppState: c,
	}) => {
		let d = s.getNonDeletedElementsMap(),
			u = s.getNonDeletedElements();
		if (i !== void 0) {
			for (let h of vd(t, c)) {
				let y = xd(h, d, r);
				if (y.length > 1) {
					let [E, T, ,] = yt(y.map((C) => C.latest));
					CH(
						a === "x" ? i : E,
						a === "y" ? i : T,
						y.map((C) => C.original),
						d,
						u,
						r,
						s,
					);
				} else {
					let E = y[0]?.original,
						T = y[0]?.latest;
					if (E && T && Ro(T, a)) {
						let [I, P] = [E.x + E.width / 2, E.y + E.height / 2],
							[C, k] = ao(pe(E.x, E.y), pe(I, P), E.angle);
						vs(a === "x" ? i : C, a === "y" ? i : k, E, d, u, s, r, !1);
					}
				}
			}
			s.triggerUpdate();
			return;
		}
		let f = o ? Ut(e, SH) : e;
		TH(a, a === "x" ? f : 0, a === "y" ? f : 0, t, t, d, r, s),
			s.triggerUpdate();
	},
	_H = ({
		property: e,
		elements: t,
		elementsMap: r,
		atomicUnits: o,
		scene: i,
		appState: a,
	}) => {
		let s = (0, cP.useMemo)(
				() =>
					o.map((d) => {
						let u = Object.keys(d)
							.map((E) => r.get(E))
							.filter((E) => E !== void 0);
						if (u.length > 1) {
							let [E, T] = yt(u);
							return Math.round((e === "x" ? E : T) * 100) / 100;
						}
						let [f] = u,
							[m, g] = [f.x + f.width / 2, f.y + f.height / 2],
							[h, y] = ao(pe(f.x, f.y), pe(m, g), f.angle);
						return Math.round((e === "x" ? h : y) * 100) / 100;
					}),
				[o, r, e],
			),
			c = new Set(s).size === 1 ? s[0] : "Mixed";
		return (0, dP.jsx)(Nr, {
			label: e === "x" ? "X" : "Y",
			elements: t,
			dragInputCallback: IH,
			value: c,
			property: e,
			scene: i,
			appState: a,
		});
	},
	X0 = _H;
b();
var tl = w(M(), 1),
	AH = ({ label: e, open: t, openTrigger: r, children: o }) =>
		(0, tl.jsxs)(tl.Fragment, {
			children: [
				(0, tl.jsxs)("div", {
					style: {
						cursor: "pointer",
						display: "flex",
						justifyContent: "space-between",
						alignItems: "center",
					},
					onClick: r,
					children: [e, (0, tl.jsx)(Xa, { icon: t ? Y2 : jp })],
				}),
				t &&
					(0, tl.jsx)("div", {
						style: { display: "flex", flexDirection: "column" },
						children: o,
					}),
			],
		}),
	Z0 = AH;
b();
var pP = w(M(), 1),
	mP = 5,
	kH = ({ property: e, scene: t, appState: r, setAppState: o }) =>
		(0, pP.jsx)(Nr, {
			label: "Grid step",
			sensitivity: 8,
			elements: [],
			dragInputCallback: ({
				nextValue: i,
				instantChange: a,
				shouldChangeByStepSize: s,
				setInputValue: c,
			}) => {
				o((d) => {
					let u;
					return (
						i
							? (u = i)
							: a &&
								(u = s
									? Ut(d.gridStep + mP * Math.sign(a), mP)
									: d.gridStep + a),
						u ? ((u = U_(u)), c(u), { gridStep: u }) : (c(d.gridStep), null)
					);
				});
			},
			scene: t,
			value: r.gridStep,
			property: e,
			appState: r,
		}),
	uP = kH;
var ve = w(M(), 1),
	LH = 50,
	mu = (e) => {
		let t = pi(),
			r = e.app.scene.getSceneNonce() || 1,
			o = e.app.scene.getSelectedElements({
				selectedElementIds: t.selectedElementIds,
				includeBoundTextElement: !1,
			}),
			i = Hl(e.app);
		return (0, ve.jsx)(MH, {
			...e,
			appState: t,
			sceneNonce: r,
			selectedElements: o,
			gridModeEnabled: i,
		});
	},
	Rt = ({ children: e, columns: t = 1, heading: r, style: o, ...i }) =>
		(0, ve.jsx)("div", {
			className: j("exc-stats__row", { "exc-stats__row--heading": r }),
			style: { gridTemplateColumns: `repeat(${t}, 1fr)`, ...o },
			...i,
			children: e,
		});
Rt.displayName = "StatsRow";
var rb = ({ children: e, order: t, style: r, ...o }) =>
	(0, ve.jsx)("div", {
		className: "exc-stats__rows",
		style: { order: t, ...r },
		...o,
		children: e,
	});
rb.displayName = "StatsRows";
mu.StatsRow = Rt;
mu.StatsRows = rb;
var MH = (0, yi.memo)(
	({
		app: e,
		onClose: t,
		renderCustomStats: r,
		selectedElements: o,
		appState: i,
		sceneNonce: a,
		gridModeEnabled: s,
	}) => {
		let c = e.scene,
			d = c.getNonDeletedElements(),
			u = c.getNonDeletedElementsMap(),
			f = tt(),
			m = o.length === 1 ? o[0] : null,
			g = o.length > 1 ? o : null,
			h = i.croppingElementId && ct(m),
			y = h ? Bl(m) : null,
			[E, T] = (0, yi.useState)({ width: 0, height: 0 }),
			I = (0, yi.useMemo)(
				() =>
					(0, fP.throttle)((C) => {
						let k = yt(C);
						T({
							width: Math.round(k[2]) - Math.round(k[0]),
							height: Math.round(k[3]) - Math.round(k[1]),
						});
					}, LH),
				[],
			);
		(0, yi.useEffect)(() => {
			I(d);
		}, [a, d, I]),
			(0, yi.useEffect)(() => () => I.cancel(), [I]);
		let P = (0, yi.useMemo)(() => vd(o, i), [o, i]);
		return (0, ve.jsx)("div", {
			className: "exc-stats",
			children: (0, ve.jsxs)(yr, {
				padding: 3,
				children: [
					(0, ve.jsxs)("div", {
						className: "title",
						children: [
							(0, ve.jsx)("h2", { children: v("stats.title") }),
							(0, ve.jsx)("div", {
								className: "close",
								onClick: t,
								children: un,
							}),
						],
					}),
					(0, ve.jsxs)(Z0, {
						label: (0, ve.jsx)("h3", { children: v("stats.generalStats") }),
						open: !!(i.stats.panels & Zd.generalStats),
						openTrigger: () =>
							f((C) => ({
								stats: { open: !0, panels: C.stats.panels ^ Zd.generalStats },
							})),
						children: [
							(0, ve.jsxs)(rb, {
								children: [
									(0, ve.jsx)(Rt, { heading: !0, children: v("stats.scene") }),
									(0, ve.jsxs)(Rt, {
										columns: 2,
										children: [
											(0, ve.jsx)("div", { children: v("stats.shapes") }),
											(0, ve.jsx)("div", { children: d.length }),
										],
									}),
									(0, ve.jsxs)(Rt, {
										columns: 2,
										children: [
											(0, ve.jsx)("div", { children: v("stats.width") }),
											(0, ve.jsx)("div", { children: E.width }),
										],
									}),
									(0, ve.jsxs)(Rt, {
										columns: 2,
										children: [
											(0, ve.jsx)("div", { children: v("stats.height") }),
											(0, ve.jsx)("div", { children: E.height }),
										],
									}),
									s &&
										(0, ve.jsxs)(ve.Fragment, {
											children: [
												(0, ve.jsx)(Rt, { heading: !0, children: "Canvas" }),
												(0, ve.jsx)(Rt, {
													children: (0, ve.jsx)(uP, {
														property: "gridStep",
														scene: c,
														appState: i,
														setAppState: f,
													}),
												}),
											],
										}),
								],
							}),
							r?.(d, i),
						],
					}),
					o.length > 0 &&
						(0, ve.jsx)("div", {
							id: "elementStats",
							style: { marginTop: 12 },
							children: (0, ve.jsx)(Z0, {
								label: (0, ve.jsx)("h3", {
									children: v("stats.elementProperties"),
								}),
								open: !!(i.stats.panels & Zd.elementProperties),
								openTrigger: () =>
									f((C) => ({
										stats: {
											open: !0,
											panels: C.stats.panels ^ Zd.elementProperties,
										},
									})),
								children: (0, ve.jsxs)(rb, {
									children: [
										m &&
											(0, ve.jsxs)(ve.Fragment, {
												children: [
													h &&
														(0, ve.jsx)(Rt, {
															heading: !0,
															children: v("labels.unCroppedDimension"),
														}),
													i.croppingElementId &&
														ct(m) &&
														y &&
														(0, ve.jsxs)(Rt, {
															columns: 2,
															children: [
																(0, ve.jsx)("div", {
																	children: v("stats.width"),
																}),
																(0, ve.jsx)("div", {
																	children: cn(y.width, 2),
																}),
															],
														}),
													i.croppingElementId &&
														ct(m) &&
														y &&
														(0, ve.jsxs)(Rt, {
															columns: 2,
															children: [
																(0, ve.jsx)("div", {
																	children: v("stats.height"),
																}),
																(0, ve.jsx)("div", {
																	children: cn(y.height, 2),
																}),
															],
														}),
													(0, ve.jsx)(Rt, {
														heading: !0,
														"data-testid": "stats-element-type",
														children: i.croppingElementId
															? v("labels.imageCropping")
															: v(`element.${m.type}`),
													}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(V0, {
															element: m,
															property: "x",
															elementsMap: u,
															scene: c,
															appState: i,
														}),
													}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(V0, {
															element: m,
															property: "y",
															elementsMap: u,
															scene: c,
															appState: i,
														}),
													}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(K0, {
															property: "width",
															element: m,
															scene: c,
															appState: i,
														}),
													}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(K0, {
															property: "height",
															element: m,
															scene: c,
															appState: i,
														}),
													}),
													!qe(m) &&
														(0, ve.jsx)(Rt, {
															children: (0, ve.jsx)(XM, {
																property: "angle",
																element: m,
																scene: c,
																appState: i,
															}),
														}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(jM, {
															property: "fontSize",
															element: m,
															scene: c,
															appState: i,
														}),
													}),
												],
											}),
										g &&
											(0, ve.jsxs)(ve.Fragment, {
												children: [
													uC(g) &&
														(0, ve.jsx)(Rt, {
															heading: !0,
															children: v("element.group"),
														}),
													(0, ve.jsxs)(Rt, {
														columns: 2,
														style: { margin: "0.3125rem 0" },
														children: [
															(0, ve.jsx)("div", {
																children: v("stats.shapes"),
															}),
															(0, ve.jsx)("div", { children: o.length }),
														],
													}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(X0, {
															property: "x",
															elements: g,
															elementsMap: u,
															atomicUnits: P,
															scene: c,
															appState: i,
														}),
													}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(X0, {
															property: "y",
															elements: g,
															elementsMap: u,
															atomicUnits: P,
															scene: c,
															appState: i,
														}),
													}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(Y0, {
															property: "width",
															elements: g,
															elementsMap: u,
															atomicUnits: P,
															scene: c,
															appState: i,
														}),
													}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(Y0, {
															property: "height",
															elements: g,
															elementsMap: u,
															atomicUnits: P,
															scene: c,
															appState: i,
														}),
													}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(rP, {
															property: "angle",
															elements: g,
															scene: c,
															appState: i,
														}),
													}),
													(0, ve.jsx)(Rt, {
														children: (0, ve.jsx)(iP, {
															property: "fontSize",
															elements: g,
															scene: c,
															appState: i,
															elementsMap: u,
														}),
													}),
												],
											}),
									],
								}),
							}),
						}),
				],
			}),
		});
	},
	(e, t) =>
		e.sceneNonce === t.sceneNonce &&
		e.selectedElements === t.selectedElements &&
		e.appState.stats.panels === t.appState.stats.panels &&
		e.gridModeEnabled === t.gridModeEnabled &&
		e.appState.gridStep === t.appState.gridStep &&
		e.appState.croppingElementId === t.appState.croppingElementId,
);
b();
var rl = w(Q(), 1);
var Cn = w(M(), 1),
	PH = ({
		sourceElementId: e,
		onClose: t,
		elementsMap: r,
		appState: o,
		generateLinkForSelection: i = Sf,
	}) => {
		let a = r.get(e)?.link ?? null,
			[s, c] = (0, rl.useState)(a),
			[d, u] = (0, rl.useState)(!1);
		(0, rl.useEffect)(() => {
			let m = Le(r, o),
				g = a;
			if (m.length > 0 && i) {
				let h = Tf(m, o);
				h && (g = Bn(i(h.id, h.type)));
			}
			c(g);
		}, [r, o, o.selectedElementIds, a, i]);
		let f = (0, rl.useCallback)(() => {
			if (s && s !== r.get(e)?.link) {
				let m = r.get(e);
				m && me(m, { link: s });
			}
			if (!s && d && e) {
				let m = r.get(e);
				m && me(m, { link: null });
			}
			t?.();
		}, [e, s, r, d, t]);
		return (
			(0, rl.useEffect)(() => {
				let m = (g) => {
					o.openDialog?.name === "elementLinkSelector" &&
						g.key === R.ENTER &&
						f(),
						o.openDialog?.name === "elementLinkSelector" &&
							g.key === R.ESCAPE &&
							t?.();
				};
				return (
					window.addEventListener("keydown", m),
					() => {
						window.removeEventListener("keydown", m);
					}
				);
			}, [o, t, f]),
			(0, Cn.jsxs)("div", {
				className: "ElementLinkDialog",
				children: [
					(0, Cn.jsxs)("div", {
						className: "ElementLinkDialog__header",
						children: [
							(0, Cn.jsx)("h2", { children: v("elementLink.title") }),
							(0, Cn.jsx)("p", { children: v("elementLink.desc") }),
						],
					}),
					(0, Cn.jsxs)("div", {
						className: "ElementLinkDialog__input",
						children: [
							(0, Cn.jsx)(cd, {
								value: s ?? "",
								onChange: (m) => {
									d || u(!0), c(m);
								},
								onKeyDown: (m) => {
									m.key === R.ENTER && f();
								},
								className: "ElementLinkDialog__input-field",
								selectOnRender: !0,
							}),
							a &&
								s &&
								(0, Cn.jsx)(Te, {
									type: "button",
									title: v("buttons.remove"),
									"aria-label": v("buttons.remove"),
									label: v("buttons.remove"),
									onClick: () => {
										c(null), u(!0);
									},
									className: "ElementLinkDialog__remove",
									icon: Uo,
								}),
						],
					}),
					(0, Cn.jsxs)("div", {
						className: "ElementLinkDialog__actions",
						children: [
							(0, Cn.jsx)(Qi, {
								label: v("buttons.cancel"),
								onClick: () => {
									t?.();
								},
								style: { marginRight: 10 },
							}),
							(0, Cn.jsx)(Qi, {
								label: v("buttons.confirm"),
								onClick: f,
								actionType: "primary",
							}),
						],
					}),
				],
			})
		);
	},
	gP = PH;
var xe = w(M(), 1),
	RH = ({ UIOptions: e }) =>
		(0, xe.jsxs)(Jr, {
			__fallback: !0,
			children: [
				(0, xe.jsx)(Jr.DefaultItems.LoadScene, {}),
				(0, xe.jsx)(Jr.DefaultItems.SaveToActiveFile, {}),
				e.canvasActions.export && (0, xe.jsx)(Jr.DefaultItems.Export, {}),
				e.canvasActions.saveAsImage &&
					(0, xe.jsx)(Jr.DefaultItems.SaveAsImage, {}),
				(0, xe.jsx)(Jr.DefaultItems.SearchMenu, {}),
				(0, xe.jsx)(Jr.DefaultItems.Help, {}),
				(0, xe.jsx)(Jr.DefaultItems.ClearCanvas, {}),
				(0, xe.jsx)(Jr.Separator, {}),
				(0, xe.jsx)(Jr.Group, {
					title: "Excalidraw links",
					children: (0, xe.jsx)(Jr.DefaultItems.Socials, {}),
				}),
				(0, xe.jsx)(Jr.Separator, {}),
				(0, xe.jsx)(Jr.DefaultItems.ToggleTheme, {}),
				(0, xe.jsx)(Jr.DefaultItems.ChangeCanvasBackground, {}),
			],
		}),
	DH = () =>
		(0, xe.jsxs)(Kh, {
			__fallback: !0,
			children: [
				(0, xe.jsx)(Kh.Actions.SaveToDisk, {}),
				(0, xe.jsx)(Kh.Actions.ExportToImage, {}),
			],
		}),
	NH = ({
		actionManager: e,
		appState: t,
		files: r,
		setAppState: o,
		elements: i,
		canvas: a,
		onLockToggle: s,
		onHandToolToggle: c,
		onPenModeToggle: d,
		showExitZenModeBtn: u,
		renderTopRightUI: f,
		renderCustomStats: m,
		UIOptions: g,
		onExportImage: h,
		renderWelcomeScreen: y,
		children: E,
		app: T,
		isCollaborating: I,
		generateLinkForSelection: P,
	}) => {
		let C = et(),
			k = sL(),
			[N, D] = Ge($a, lt),
			B = () =>
				g.canvasActions.export
					? (0, xe.jsx)(YL, {
							elements: i,
							appState: t,
							files: r,
							actionManager: e,
							exportOpts: g.canvasActions.export,
							canvas: a,
							setAppState: o,
						})
					: null,
			F = () =>
				!g.canvasActions.saveAsImage || t.openDialog?.name !== "imageExport"
					? null
					: (0, xe.jsx)(LL, {
							elements: i,
							appState: t,
							files: r,
							actionManager: e,
							onExportImage: h,
							onCloseRequest: () => o({ openDialog: null }),
							name: T.getName(),
						}),
			W = () =>
				(0, xe.jsxs)("div", {
					style: { position: "relative" },
					children: [
						(0, xe.jsx)(k.MainMenuTunnel.Out, {}),
						y && (0, xe.jsx)(k.WelcomeScreenMenuHintTunnel.Out, {}),
					],
				}),
			G = () =>
				(0, xe.jsx)(qa, {
					heading: "selectedShapeActions",
					className: j("selected-shape-actions zen-mode-transition", {
						"transition-left": t.zenModeEnabled,
					}),
					children: (0, xe.jsx)(yr, {
						className: Nn.SHAPE_ACTIONS_MENU,
						padding: 2,
						style: { maxHeight: `${t.height - 166}px` },
						children: (0, xe.jsx)(vh, {
							appState: t,
							elementsMap: T.scene.getNonDeletedElementsMap(),
							renderAction: e.renderAction,
						}),
					}),
				}),
			q = () => {
				let X = yc(t, i),
					se =
						t.stats.open &&
						!t.zenModeEnabled &&
						!t.viewModeEnabled &&
						t.openDialog?.name !== "elementLinkSelector";
				return (0, xe.jsx)(kh, {
					side: "top",
					children: (0, xe.jsxs)("div", {
						className: "App-menu App-menu_top",
						children: [
							(0, xe.jsxs)(Pr.Col, {
								gap: 6,
								className: j("App-menu_top__left"),
								children: [W(), X && G()],
							}),
							!t.viewModeEnabled &&
								t.openDialog?.name !== "elementLinkSelector" &&
								(0, xe.jsx)(qa, {
									heading: "shapes",
									className: "shapes-section",
									children: (Pe) =>
										(0, xe.jsxs)("div", {
											style: { position: "relative" },
											children: [
												y &&
													(0, xe.jsx)(k.WelcomeScreenToolbarHintTunnel.Out, {}),
												(0, xe.jsx)(Pr.Col, {
													gap: 4,
													align: "start",
													children: (0, xe.jsxs)(Pr.Row, {
														gap: 1,
														className: j("App-toolbar-container", {
															"zen-mode": t.zenModeEnabled,
														}),
														children: [
															(0, xe.jsxs)(yr, {
																padding: 1,
																className: j("App-toolbar", {
																	"zen-mode": t.zenModeEnabled,
																}),
																children: [
																	(0, xe.jsx)(Ph, {
																		appState: t,
																		isMobile: C.editor.isMobile,
																		device: C,
																		app: T,
																	}),
																	Pe,
																	(0, xe.jsxs)(Pr.Row, {
																		gap: 1,
																		children: [
																			(0, xe.jsx)(Dh, {
																				zenModeEnabled: t.zenModeEnabled,
																				checked: t.penMode,
																				onChange: () => d(null),
																				title: v("toolBar.penMode"),
																				penDetected: t.penDetected,
																			}),
																			(0, xe.jsx)(Rh, {
																				checked: t.activeTool.locked,
																				onChange: s,
																				title: v("toolBar.lock"),
																			}),
																			(0, xe.jsx)("div", {
																				className: "App-toolbar__divider",
																			}),
																			(0, xe.jsx)(Nh, {
																				checked: Fi(t),
																				onChange: () => c(),
																				title: v("toolBar.hand"),
																				isMobile: !0,
																			}),
																			(0, xe.jsx)(Eh, {
																				appState: t,
																				activeTool: t.activeTool,
																				UIOptions: g,
																				app: T,
																			}),
																		],
																	}),
																],
															}),
															I &&
																(0, xe.jsx)(yr, {
																	style: {
																		marginLeft: 8,
																		alignSelf: "center",
																		height: "fit-content",
																	},
																	children: (0, xe.jsx)(NM, {
																		title: v("toolBar.laser"),
																		checked: t.activeTool.type === Co.laser,
																		onChange: () =>
																			T.setActiveTool({ type: Co.laser }),
																		isMobile: !0,
																	}),
																}),
														],
													}),
												}),
											],
										}),
								}),
							(0, xe.jsxs)("div", {
								className: j(
									"layer-ui__wrapper__top-right zen-mode-transition",
									{ "transition-right": t.zenModeEnabled },
								),
								children: [
									t.collaborators.size > 0 &&
										(0, xe.jsx)(Oh, {
											collaborators: t.collaborators,
											userToFollow: t.userToFollow?.socketId || null,
										}),
									f?.(C.editor.isMobile, t),
									!t.viewModeEnabled &&
										t.openDialog?.name !== "elementLinkSelector" &&
										(!te || t.openSidebar?.name !== Vr.name) &&
										(0, xe.jsx)(k.DefaultSidebarTriggerTunnel.Out, {}),
									se &&
										(0, xe.jsx)(mu, {
											app: T,
											onClose: () => {
												e.executeAction(td);
											},
											renderCustomStats: m,
										}),
								],
							}),
						],
					}),
				});
			},
			ie = () =>
				(0, xe.jsx)(Yh, {
					__fallback: !0,
					onDock: (X) => {
						We(
							"sidebar",
							`toggleDock (${X ? "dock" : "undock"})`,
							`(${C.editor.isMobile ? "mobile" : "desktop"})`,
						);
					},
				}),
			te = Em(iu, lt),
			we = (0, xe.jsxs)(xe.Fragment, {
				children: [
					E,
					(0, xe.jsx)(RH, { UIOptions: g }),
					(0, xe.jsx)(Yh.Trigger, {
						__fallback: !0,
						icon: rc,
						title: Ea(v("toolBar.library")),
						onToggle: (X) => {
							X &&
								We(
									"sidebar",
									`${Vr.name} (open)`,
									`button (${C.editor.isMobile ? "mobile" : "desktop"})`,
								);
						},
						tab: Vr.defaultTab,
						children: v("toolBar.library"),
					}),
					(0, xe.jsx)(DH, {}),
					t.openDialog?.name === "ttd" && (0, xe.jsx)(W0, { __fallback: !0 }),
					t.isLoading && (0, xe.jsx)(Qf, { delay: 250 }),
					t.errorMessage &&
						(0, xe.jsx)(AL, {
							onClose: () => o({ errorMessage: null }),
							children: t.errorMessage,
						}),
					N &&
						!C.editor.isMobile &&
						(0, xe.jsx)(a5, {
							colorPickerType: N.colorPickerType,
							onCancel: () => {
								D(null);
							},
							onChange: (X, se, Pe, { altKey: ke }) => {
								if (!(X !== "elementBackground" && X !== "elementStroke"))
									if (Pe.length) {
										for (let fe of Pe)
											me(
												fe,
												{
													[ke && N.swapPreviewOnAlt
														? X === "elementBackground"
															? "strokeColor"
															: "backgroundColor"
														: X === "elementBackground"
															? "backgroundColor"
															: "strokeColor"]: se,
												},
												!1,
											),
												Ca.delete(fe);
										Un.getScene(Pe[0])?.triggerUpdate();
									} else
										o(
											X === "elementBackground"
												? { currentItemBackgroundColor: se }
												: { currentItemStrokeColor: se },
										);
							},
							onSelect: (X, se) => {
								D((Pe) => (Pe?.keepOpenOnAlt && se.altKey ? Pe : null)),
									N?.onSelect?.(X, se);
							},
						}),
					t.openDialog?.name === "help" &&
						(0, xe.jsx)(GL, {
							onClose: () => {
								o({ openDialog: null });
							},
						}),
					(0, xe.jsx)(gL, {}),
					t.openDialog?.name === "elementLinkSelector" &&
						(0, xe.jsx)(gP, {
							sourceElementId: t.openDialog.sourceElementId,
							onClose: () => {
								o({ openDialog: null });
							},
							elementsMap: T.scene.getNonDeletedElementsMap(),
							appState: t,
							generateLinkForSelection: P,
						}),
					(0, xe.jsx)(k.OverwriteConfirmDialogTunnel.Out, {}),
					F(),
					B(),
					t.pasteDialog.shown &&
						(0, xe.jsx)(HL, {
							setAppState: o,
							appState: t,
							onClose: () => o({ pasteDialog: { shown: !1, data: null } }),
						}),
					C.editor.isMobile &&
						(0, xe.jsx)(zL, {
							app: T,
							appState: t,
							elements: i,
							actionManager: e,
							renderJSONExportDialog: B,
							renderImageExportDialog: F,
							setAppState: o,
							onLockToggle: s,
							onHandToolToggle: c,
							onPenModeToggle: d,
							renderTopRightUI: f,
							renderCustomStats: m,
							renderSidebars: ie,
							device: C,
							renderWelcomeScreen: y,
							UIOptions: g,
						}),
					!C.editor.isMobile &&
						(0, xe.jsxs)(xe.Fragment, {
							children: [
								(0, xe.jsxs)("div", {
									className: "layer-ui__wrapper",
									style:
										t.openSidebar && te && C.editor.canFitSidebar
											? { width: `calc(100% - ${kT}px)` }
											: {},
									children: [
										y && (0, xe.jsx)(k.WelcomeScreenCenterTunnel.Out, {}),
										q(),
										(0, xe.jsx)(qL, {
											appState: t,
											actionManager: e,
											showExitZenModeBtn: u,
											renderWelcomeScreen: y,
										}),
										t.scrolledOutside &&
											(0, xe.jsx)("button", {
												type: "button",
												className: "scroll-back-to-content",
												onClick: () => {
													o((X) => ({ ...Kl(i, X) }));
												},
												children: v("buttons.scrollBackToContent"),
											}),
									],
								}),
								ie(),
							],
						}),
				],
			});
		return (0, xe.jsx)(sy.Provider, {
			value: t,
			children: (0, xe.jsx)(Yf, {
				scope: k.jotaiScope,
				children: (0, xe.jsx)(Jy.Provider, { value: k, children: we }),
			}),
		});
	},
	hP = (e) => {
		let {
			suggestedBindings: t,
			startBoundElement: r,
			cursorButton: o,
			scrollX: i,
			scrollY: a,
			...s
		} = e;
		return s;
	},
	OH = (e, t) => {
		if (e.children !== t.children) return !1;
		let { canvas: r, appState: o, ...i } = e,
			{ canvas: a, appState: s, ...c } = t;
		return (
			Er(hP(o), hP(s), { selectedElementIds: Er, selectedGroupIds: Er }) &&
			Er(i, c)
		);
	},
	xP = bP.default.memo(NH, OH);
b();
var wd = w(Q(), 1);
var uu = w(M(), 1),
	FH = 5e3,
	vP = ({
		message: e,
		onClose: t,
		closable: r = !1,
		duration: o = FH,
		style: i,
	}) => {
		let a = (0, wd.useRef)(0),
			s = o !== 1 / 0,
			c = (0, wd.useCallback)(() => {
				s && (a.current = window.setTimeout(() => t(), o));
			}, [t, o, s]);
		return (
			(0, wd.useEffect)(() => {
				if (s) return c(), () => clearTimeout(a.current);
			}, [c, e, o, s]),
			(0, uu.jsxs)("div", {
				className: "Toast",
				onMouseEnter: s ? () => clearTimeout(a?.current) : void 0,
				onMouseLeave: s ? c : void 0,
				style: i,
				children: [
					(0, uu.jsx)("p", { className: "Toast__message", children: e }),
					r &&
						(0, uu.jsx)(Te, {
							icon: un,
							"aria-label": "close",
							type: "icon",
							onClick: t,
							className: "close",
						}),
				],
			})
		);
	};
b();
var q0 = re({
	name: "viewMode",
	label: "labels.viewMode",
	paletteName: "Toggle view mode",
	icon: sc,
	viewMode: !0,
	trackEvent: { category: "canvas", predicate: (e) => !e.viewModeEnabled },
	perform(e, t) {
		return {
			appState: { ...t, viewModeEnabled: !this.checked(t) },
			storeAction: H.NONE,
		};
	},
	checked: (e) => e.viewModeEnabled,
	predicate: (e, t, r) => typeof r.viewModeEnabled > "u",
	keyTest: (e) => !e[R.CTRL_OR_CMD] && e.altKey && e.code === Be.R,
});
var JP = w(Jx(), 1);
b();
var EP = (e, t) => {
		let r = t.scene.getSelectedElements(e);
		return r.length === 1 && Ye(r[0]);
	},
	yP = re({
		name: "selectAllElementsInFrame",
		label: "labels.selectAllElementsInFrame",
		trackEvent: { category: "canvas" },
		perform: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t).at(0) || null;
			if (Ye(i)) {
				let a = ka(Ve(e), i.id).filter(
					(s) => !(s.type === "text" && s.containerId),
				);
				return {
					elements: e,
					appState: {
						...t,
						selectedElementIds: a.reduce((s, c) => ((s[c.id] = !0), s), {}),
					},
					storeAction: H.CAPTURE,
				};
			}
			return { elements: e, appState: t, storeAction: H.NONE };
		},
		predicate: (e, t, r, o) => EP(t, o),
	}),
	wP = re({
		name: "removeAllElementsFromFrame",
		label: "labels.removeAllElementsFromFrame",
		trackEvent: { category: "history" },
		perform: (e, t, r, o) => {
			let i = o.scene.getSelectedElements(t).at(0) || null;
			return Ye(i)
				? {
						elements: JI(e, i),
						appState: { ...t, selectedElementIds: { [i.id]: !0 } },
						storeAction: H.CAPTURE,
					}
				: { elements: e, appState: t, storeAction: H.NONE };
		},
		predicate: (e, t, r, o) => EP(t, o),
	}),
	rTe = re({
		name: "updateFrameRendering",
		label: "labels.updateFrameRendering",
		viewMode: !0,
		trackEvent: { category: "canvas" },
		perform: (e, t) => ({
			elements: e,
			appState: {
				...t,
				frameRendering: {
					...t.frameRendering,
					enabled: !t.frameRendering.enabled,
				},
			},
			storeAction: H.NONE,
		}),
		checked: (e) => e.frameRendering.enabled,
	}),
	oTe = re({
		name: "setFrameAsActiveTool",
		label: "toolBar.frame",
		trackEvent: { category: "toolbar" },
		icon: Kp,
		viewMode: !1,
		perform: (e, t, r, o) => {
			let i = Yt(t, { type: "frame" });
			return (
				zn(o.interactiveCanvas, { ...t, activeTool: i }),
				{
					elements: e,
					appState: { ...t, activeTool: Yt(t, { type: "frame" }) },
					storeAction: H.NONE,
				}
			);
		},
		keyTest: (e) =>
			!e[R.CTRL_OR_CMD] &&
			!e.shiftKey &&
			!e.altKey &&
			e.key.toLocaleLowerCase() === R.F,
	});
b();
var to = w(M(), 1),
	BH = () =>
		(0, to.jsxs)("div", {
			"data-testid": "brave-measure-text-error",
			children: [
				(0, to.jsx)("p", {
					children: (0, to.jsx)(bo, {
						i18nKey: "errors.brave_measure_text_error.line1",
						bold: (e) =>
							(0, to.jsx)("span", { style: { fontWeight: 600 }, children: e }),
					}),
				}),
				(0, to.jsx)("p", {
					children: (0, to.jsx)(bo, {
						i18nKey: "errors.brave_measure_text_error.line2",
						bold: (e) =>
							(0, to.jsx)("span", { style: { fontWeight: 600 }, children: e }),
					}),
				}),
				(0, to.jsx)("p", {
					children: (0, to.jsx)(bo, {
						i18nKey: "errors.brave_measure_text_error.line3",
						link: (e) =>
							(0, to.jsx)("a", {
								href: "http://docs.excalidraw.com/docs/@excalidraw/excalidraw/faq#turning-off-aggresive-block-fingerprinting-in-brave-browser",
								children: e,
							}),
					}),
				}),
				(0, to.jsx)("p", {
					children: (0, to.jsx)(bo, {
						i18nKey: "errors.brave_measure_text_error.line4",
						issueLink: (e) =>
							(0, to.jsx)("a", {
								href: "https://github.com/excalidraw/excalidraw/issues/new",
								children: e,
							}),
						discordLink: (e) =>
							(0, to.jsxs)("a", {
								href: "https://discord.gg/UexuTaE",
								children: [e, "."],
							}),
					}),
				}),
			],
		}),
	SP = BH;
b();
var ob = { width: 100, height: 0 },
	ol = 100,
	zH = (e, t, r) => {
		let o = Hn({
			x: 0,
			y: 0,
			textAlign: Vd.CENTER,
			verticalAlign: sn.MIDDLE,
			...t,
			containerId: e.id,
			strokeColor: t.strokeColor || e.strokeColor,
		});
		return (
			Object.assign(e, {
				boundElements: (e.boundElements || []).concat({
					type: "text",
					id: o.id,
				}),
			}),
			jt(o, e, r),
			[e, o]
		);
	},
	TP = (e, t, r, o, i) => {
		let a, s;
		if (
			(Object.assign(e, {
				startBinding: e?.startBinding || null,
				endBinding: e.endBinding || null,
			}),
			t)
		) {
			let f = t?.width ?? ol,
				m = t?.height ?? ol,
				g;
			t.id &&
				((g = o.getElement(t.id)),
				g ||
					console.error(`No element for start binding with id ${t.id} found`));
			let h = t.x || e.x - f,
				y = t.y || e.y - m / 2,
				E = g ? g.type : t.type;
			if (E) {
				if (E === "text") {
					let T = "";
					g && g.type === "text"
						? (T = g.text)
						: t.type === "text" && (T = t.text),
						T ||
							console.error(
								`No text found for start binding text element for ${e.id}`,
							),
						(a = Hn({ x: h, y, type: "text", ...g, ...t, text: T })),
						Object.assign(a, {
							x: t.x || e.x - a.width,
							y: t.y || e.y - a.height / 2,
						});
				} else
					switch (E) {
						case "rectangle":
						case "ellipse":
						case "diamond": {
							a = $n({ x: h, y, width: f, height: m, ...g, ...t, type: E });
							break;
						}
						default:
							Mp(e, `Unhandled element start type "${t.type}"`, !0);
					}
				$i(e, a, "start", i);
			}
		}
		if (r) {
			let f = r?.height ?? ol,
				m = r?.width ?? ol,
				g;
			r.id &&
				((g = o.getElement(r.id)),
				g || console.error(`No element for end binding with id ${r.id} found`));
			let h = r.x || e.x + e.width,
				y = r.y || e.y - f / 2,
				E = g ? g.type : r.type;
			if (E) {
				if (E === "text") {
					let T = "";
					g && g.type === "text"
						? (T = g.text)
						: r.type === "text" && (T = r.text),
						T ||
							console.error(
								`No text found for end binding text element for ${e.id}`,
							),
						(s = Hn({ x: h, y, type: "text", ...g, ...r, text: T })),
						Object.assign(s, { y: r.y || e.y - s.height / 2 });
				} else
					switch (E) {
						case "rectangle":
						case "ellipse":
						case "diamond": {
							s = $n({ x: h, y, width: m, height: f, ...g, ...r, type: E });
							break;
						}
						default:
							Mp(e, `Unhandled element end type "${E}"`, !0);
					}
				$i(e, s, "end", i);
			}
		}
		if (e.points.length < 2)
			return { linearElement: e, startBoundElement: a, endBoundElement: s };
		let c = e.points.length - 1,
			d = 0.5,
			u = _o(e.points);
		return (
			e.points[c][0] > e.points[c - 1][0] && ((u[0][0] = d), (u[c][0] -= d)),
			e.points[c][0] < e.points[c - 1][0] && ((u[0][0] = -d), (u[c][0] += d)),
			e.points[c][1] > e.points[c - 1][1] && ((u[0][1] = d), (u[c][1] -= d)),
			e.points[c][1] < e.points[c - 1][1] && ((u[0][1] = -d), (u[c][1] += d)),
			Object.assign(e, { points: u }),
			{ linearElement: e, startBoundElement: a, endBoundElement: s }
		);
	},
	j0 = class {
		excalidrawElements = new Map();
		add = (t) => {
			t && this.excalidrawElements.set(t.id, t);
		};
		getElements = () => Gi(Array.from(this.excalidrawElements.values()));
		getElementsMap = () => Zs(Fe(this.getElements()));
		getElement = (t) => this.excalidrawElements.get(t);
	},
	gd = (e, t) => {
		if (!e) return [];
		let r = _o(e),
			o = new j0(),
			i = new Map(),
			a = new Map();
		for (let c of r) {
			let d,
				u = c.id;
			switch (
				(t?.regenerateIds !== !1 && Object.assign(c, { id: Sa() }), c.type)
			) {
				case "rectangle":
				case "ellipse":
				case "diamond": {
					let m = c?.label?.text && c.width === void 0 ? 0 : c?.width || ol,
						g = c?.label?.text && c.height === void 0 ? 0 : c?.height || ol;
					d = $n({ ...c, width: m, height: g });
					break;
				}
				case "line": {
					let m = c.width || ob.width,
						g = c.height || ob.height;
					d = ef({ width: m, height: g, points: [pe(0, 0), pe(m, g)], ...c });
					break;
				}
				case "arrow": {
					let m = c.width || ob.width,
						g = c.height || ob.height;
					(d = cc({
						width: m,
						height: g,
						endArrowhead: "arrow",
						points: [pe(0, 0), pe(m, g)],
						...c,
						type: "arrow",
					})),
						Object.assign(d, yI(d.points));
					break;
				}
				case "text": {
					let m = c?.fontFamily || $s,
						g = c?.fontSize || zs,
						h = c?.lineHeight || zi(m),
						y = c.text ?? "",
						E = Ul(y);
					if (c.width && c.height) {
						let T = Js(E, Lr({ fontFamily: m, fontSize: g }), c.width);
						d = Hn({
							width: c.width,
							height: c.height,
							fontFamily: m,
							fontSize: g,
							...c,
							originalText: y,
							text: T,
						});
					} else {
						let T = Ko(E, Lr({ fontFamily: m, fontSize: g }), h);
						d = Hn({
							width: T.width,
							height: T.height,
							fontFamily: m,
							fontSize: g,
							...c,
						});
					}
					break;
				}
				case "image": {
					d = tf({ width: c?.width || ol, height: c?.height || ol, ...c });
					break;
				}
				case "frame": {
					d = Jp({ x: 0, y: 0, ...c });
					break;
				}
				case "magicframe": {
					d = am({ x: 0, y: 0, ...c });
					break;
				}
				case "freedraw":
				case "iframe":
				case "embeddable": {
					d = c;
					break;
				}
				default:
					(d = c), Mp(c, `Unhandled element type "${c.type}"`, !0);
			}
			o.getElement(d.id)
				? console.error(`Duplicate id found for ${d.id}`)
				: (o.add(d), i.set(d.id, c), u && a.set(u, d.id));
		}
		let s = o.getElementsMap();
		for (let [c, d] of i) {
			let u = o.getElement(c);
			switch (d.type) {
				case "rectangle":
				case "ellipse":
				case "diamond":
				case "arrow": {
					if (d.label?.text) {
						let [f, m] = zH(u, d?.label, s);
						if ((o.add(f), o.add(m), Lt(f))) {
							let g = d.type === "arrow" ? d?.start : void 0,
								h = d.type === "arrow" ? d?.end : void 0;
							if (g && g.id) {
								let I = a.get(g.id);
								I && Object.assign(g, { id: I });
							}
							if (h && h.id) {
								let I = a.get(h.id);
								I && Object.assign(h, { id: I });
							}
							let {
								linearElement: y,
								startBoundElement: E,
								endBoundElement: T,
							} = TP(f, g, h, o, s);
							(f = y), o.add(y), o.add(E), o.add(T);
						}
					} else
						switch (d.type) {
							case "arrow": {
								let { start: f, end: m } = d;
								if (f && f.id) {
									let E = a.get(f.id);
									Object.assign(f, { id: E });
								}
								if (m && m.id) {
									let E = a.get(m.id);
									Object.assign(m, { id: E });
								}
								let {
									linearElement: g,
									startBoundElement: h,
									endBoundElement: y,
								} = TP(u, f, m, o, s);
								o.add(g), o.add(h), o.add(y);
								break;
							}
						}
					break;
				}
			}
		}
		for (let [c, d] of i) {
			if (d.type !== "frame" && d.type !== "magicframe") continue;
			let u = o.getElement(c);
			if (!u) throw new Error(`Excalidraw element with id ${c} doesn't exist`);
			let f = [];
			d.children.forEach((k) => {
				let N = a.get(k);
				if (!N) throw new Error(`Element with ${k} wasn't mapped correctly`);
				let D = o.getElement(N);
				if (!D) throw new Error(`Frame element with id ${N} doesn't exist`);
				Object.assign(D, { frameId: u.id }),
					D?.boundElements?.forEach((B) => {
						let F = o.getElement(B.id);
						if (!F)
							throw new Error(`Bound element with id ${B.id} doesn't exist`);
						Object.assign(F, { frameId: u.id }), f.push(F);
					}),
					f.push(D);
			});
			let [m, g, h, y] = yt(f),
				E = 10;
			(m = m - E), (g = g - E), (h = h + E), (y = y + E);
			let T = u?.x || m,
				I = u?.y || g,
				P = u?.width || h - m,
				C = u?.height || y - g;
			Object.assign(u, { x: T, y: I, width: P, height: C }),
				kp() &&
					d.children.length &&
					(u?.x || u?.y || u?.width || u?.height) &&
					console.info(
						"User provided frame attributes are being considered, if you find this inaccurate, please remove any of the attributes - x, y, width and height so frame coordinates and dimensions are calculated automatically",
					);
		}
		return o.getElements();
	};
b();
b();
var Td = w(Q(), 1);
b();
var Q0 = w(Gn(), 1),
	CP = w(Q(), 1);
var Wt = (e) => (t) => {
		(0, Q0.unstable_batchedUpdates)(e, t);
	},
	nb = (e) =>
		Ks((t) => {
			(0, Q0.unstable_batchedUpdates)(e, t);
		}),
	Sd = (() => {
		let e;
		try {
			let r = CP.version.split(".");
			e = Number(r[0]) > 17;
		} catch {
			e = !1;
		}
		let t = !1;
		return () =>
			window.EXCALIDRAW_THROTTLE_RENDER === !0
				? e
					? !0
					: (t ||
							((t = !0),
							console.warn(
								"Excalidraw: render throttling is disabled on React versions < 18.",
							)),
						!1)
				: !1;
	})();
b();
b();
var $H = "#ff6b6b",
	HH = "#ff0000",
	IP = 1,
	_P = 2,
	AP = (e, t) => {
		if (!t.snapLines.length) return;
		let r = t.theme === $e.LIGHT || t.zenModeEnabled ? $H : HH,
			o = (t.zenModeEnabled ? IP * 1.5 : IP) / t.zoom.value;
		e.save(), e.translate(t.scrollX, t.scrollY);
		for (let i of t.snapLines)
			i.type === "pointer"
				? ((e.lineWidth = o), (e.strokeStyle = r), GH(i, e, t))
				: i.type === "gap"
					? ((e.lineWidth = o),
						(e.strokeStyle = r),
						WH(i.points[0], i.points[1], i.direction, t, e))
					: i.type === "points" &&
						((e.lineWidth = o), (e.strokeStyle = r), UH(i, e, t));
		e.restore();
	},
	UH = (e, t, r) => {
		if (!r.zenModeEnabled) {
			let o = e.points[0],
				i = e.points[e.points.length - 1];
			In(o, i, t);
		}
		for (let o of e.points) kP(o, r, t);
	},
	GH = (e, t, r) => {
		kP(e.points[0], r, t), r.zenModeEnabled || In(e.points[0], e.points[1], t);
	},
	kP = ([e, t], r, o) => {
		o.save();
		let i = (r.zenModeEnabled ? _P * 1.5 : _P) / r.zoom.value;
		o.beginPath(),
			o.moveTo(e - i, t - i),
			o.lineTo(e + i, t + i),
			o.moveTo(e + i, t - i),
			o.lineTo(e - i, t + i),
			o.stroke(),
			o.restore();
	},
	In = (e, t, r) => {
		r.beginPath(), r.lineTo(e[0], e[1]), r.lineTo(t[0], t[1]), r.stroke();
	},
	WH = (e, t, r, o, i) => {
		let a = 8 / o.zoom.value,
			s = a / 2,
			c = a / 4;
		if (r === "horizontal") {
			let d = [(e[0] + t[0]) / 2, e[1]];
			o.zenModeEnabled || In(pe(e[0], e[1] - a), pe(e[0], e[1] + a), i),
				In(pe(d[0] - c, d[1] - s), pe(d[0] - c, d[1] + s), i),
				In(pe(d[0] + c, d[1] - s), pe(d[0] + c, d[1] + s), i),
				o.zenModeEnabled ||
					(In(pe(t[0], t[1] - a), pe(t[0], t[1] + a), i), In(e, t, i));
		} else {
			let d = [e[0], (e[1] + t[1]) / 2];
			o.zenModeEnabled || In(pe(e[0] - a, e[1]), pe(e[0] + a, e[1]), i),
				In(pe(d[0] - s, d[1] - c), pe(d[0] + s, d[1] - c), i),
				In(pe(d[0] - s, d[1] + c), pe(d[0] + s, d[1] + c), i),
				o.zenModeEnabled ||
					(In(pe(t[0] - a, t[1]), pe(t[0] + a, t[1]), i), In(e, t, i));
		}
	};
var KH = (e, t, r) => {
		let { elementId: o, hoverPointIndex: i } = t.selectedLinearElement;
		if (t.editingLinearElement?.selectedPointsIndices?.includes(i)) return;
		let a = De.getElement(o, r);
		if (!a) return;
		let s = De.getPointAtIndexGlobalCoordinates(a, i, r);
		e.save(), e.translate(t.scrollX, t.scrollY), ew(s, e, t), e.restore();
	},
	ew = (e, t, r) => {
		(t.fillStyle = "rgba(105, 101, 219, 0.4)"),
			um(t, e[0], e[1], De.POINT_HANDLE_SIZE / r.zoom.value, !1);
	},
	pu = (e, t, r, o, i, a, s, c, d = !1, u = 0) => {
		e.save(),
			e.translate(a, s),
			e.rotate(c),
			d && e.fillRect(t - a, r - s, o, i),
			u && e.roundRect
				? (e.beginPath(),
					e.roundRect(t - a, r - s, o, i, u),
					e.stroke(),
					e.closePath())
				: e.strokeRect(t - a, r - s, o, i),
			e.restore();
	},
	YH = (e, t, r, o, i, a) => {
		e.save(),
			e.translate(o, i),
			e.rotate(a),
			e.beginPath(),
			e.moveTo(0, r / 2),
			e.lineTo(t / 2, 0),
			e.lineTo(0, -r / 2),
			e.lineTo(-t / 2, 0),
			e.closePath(),
			e.stroke(),
			e.restore();
	},
	ib = (e, t, r, o, i, a = !1) => {
		(e.strokeStyle = "#5e5ad8"),
			e.setLineDash([]),
			(e.fillStyle = "rgba(255, 255, 255, 0.9)"),
			i
				? (e.fillStyle = "rgba(134, 131, 226, 0.9)")
				: a && (e.fillStyle = "rgba(177, 151, 252, 0.7)"),
			um(e, r[0], r[1], o / t.zoom.value, !a);
	},
	VH = (e, t, r, o, i, a) => {
		e.beginPath(), e.ellipse(o, i, t / 2, r / 2, a, 0, Math.PI * 2), e.stroke();
	},
	XH = (e, t, r, o) => {
		let [i, a, s, c] = mo(t, r),
			d = s - i,
			u = c - a;
		e.strokeStyle = "rgba(0,0,0,.05)";
		let f = o.value < 1 ? o.value : 1;
		e.lineWidth = pI / f;
		let m = e.lineWidth / 2 + fI,
			g = cf(Math.min(t.width, t.height), t);
		switch (t.type) {
			case "rectangle":
			case "text":
			case "image":
			case "iframe":
			case "embeddable":
			case "frame":
			case "magicframe":
				pu(
					e,
					i - m,
					a - m,
					d + m * 2,
					u + m * 2,
					i + d / 2,
					a + u / 2,
					t.angle,
					void 0,
					g,
				);
				break;
			case "diamond":
				let h = Math.hypot(d, u),
					y = (m * h) / u,
					E = (m * h) / d;
				YH(e, d + y * 2, u + E * 2, i + d / 2, a + u / 2, t.angle);
				break;
			case "ellipse":
				VH(e, d + m * 2, u + m * 2, i + d / 2, a + u / 2, t.angle);
				break;
		}
	},
	ZH = (e, t, r, o) => {
		let [i, a, s] = t,
			c = hI(s, s.width, s.height, o);
		(e.strokeStyle = "rgba(0,0,0,0)"),
			(e.fillStyle = "rgba(0,0,0,.05)"),
			(a === "both" ? [0, -1] : a === "start" ? [0] : [-1]).forEach((u) => {
				let [f, m] = De.getPointAtIndexGlobalCoordinates(i, u, r);
				um(e, f, m, c);
			});
	},
	MP = (e, t, r) => {
		let {
				angle: o,
				x1: i,
				y1: a,
				x2: s,
				y2: c,
				selectionColors: d,
				cx: u,
				cy: f,
				dashed: m,
				activeEmbeddable: g,
			} = r,
			h = s - i,
			y = c - a,
			T = (r.padding ?? xp * 2) / t.zoom.value,
			I = 8 / t.zoom.value,
			P = 4 / t.zoom.value;
		e.save(),
			e.translate(t.scrollX, t.scrollY),
			(e.lineWidth = (g ? 4 : 1) / t.zoom.value);
		let C = d.length;
		for (let k = 0; k < C; ++k)
			(e.strokeStyle = d[k]),
				m && e.setLineDash([I, P + (I + P) * (C - 1)]),
				(e.lineDashOffset = (I + P) * k),
				pu(e, i - T, a - T, h + T * 2, y + T * 2, u, f, o);
		e.restore();
	},
	qH = (e, t, r, o) => {
		let i = Array.isArray(r) ? ZH : XH;
		e.save(),
			e.translate(t.scrollX, t.scrollY),
			i(e, r, o, t.zoom),
			e.restore();
	},
	jH = (e, t, r, o) => {
		let [i, a, s, c] = mo(r, o),
			d = s - i,
			u = c - a;
		(e.strokeStyle = "rgb(0,118,255)"),
			(e.lineWidth = On.strokeWidth / t.zoom.value),
			e.save(),
			e.translate(t.scrollX, t.scrollY),
			pu(
				e,
				i,
				a,
				d,
				u,
				i + d / 2,
				a + u / 2,
				r.angle,
				!1,
				On.radius / t.zoom.value,
			),
			e.restore();
	},
	QH = (e, t, r) => {
		let o = r.filter((c) => c.groupIds.length === 0),
			i = r.filter((c) => c.groupIds.length > 0),
			a = (c) => {
				let [d, u, f, m] = yt(c);
				return {
					angle: 0,
					x1: d,
					x2: f,
					y1: u,
					y2: m,
					selectionColors: ["rgb(0,118,255)"],
					dashed: !1,
					cx: d + (f - d) / 2,
					cy: u + (m - u) / 2,
					activeEmbeddable: !1,
				};
			},
			s = (c) => {
				let d = Vt(r, c);
				return a(d);
			};
		Object.entries(lC(i, t))
			.filter(([c, d]) => d)
			.map(([c, d]) => c)
			.map((c) => s(c))
			.concat(o.map((c) => a([c])))
			.forEach((c) => MP(e, t, c));
	},
	J0 = (e, t, r, o) => {
		if (!t.selectedLinearElement) return;
		e.save(),
			e.translate(t.scrollX, t.scrollY),
			(e.lineWidth = 1 / t.zoom.value);
		let i = De.getPointsGlobalCoordinates(r, o),
			{ POINT_HANDLE_SIZE: a } = De,
			s = t.editingLinearElement ? a : a / 2;
		i.forEach((d, u) => {
			if (qe(r) && u !== 0 && u !== i.length - 1) return;
			let f = !!t.editingLinearElement?.selectedPointsIndices?.includes(u);
			ib(e, t, d, s, f);
		}),
			De.getEditorMidPoints(r, o, t)
				.filter((d) => d !== null)
				.forEach((d) => {
					t?.selectedLinearElement?.segmentMidPointHoveredCoords &&
					De.arePointsEqual(
						d,
						t.selectedLinearElement.segmentMidPointHoveredCoords,
					)
						? t.editingLinearElement
							? (ib(e, t, d, s, !1), ew(d, e, t))
							: (ew(d, e, t), ib(e, t, d, s, !1))
						: (t.editingLinearElement || i.length === 2) &&
							ib(e, t, d, a / 2, !1, !0);
				}),
			e.restore();
	},
	LP = (e, t, r, o, i) => {
		Object.keys(o).forEach((a) => {
			let s = o[a];
			if (s !== void 0) {
				let [c, d, u, f] = s;
				e.save(),
					(e.lineWidth = 1 / r.zoom.value),
					t.selectionColor && (e.strokeStyle = t.selectionColor),
					a === "rotation"
						? um(e, c + u / 2, d + f / 2, u / 2)
						: e.roundRect
							? (e.beginPath(),
								e.roundRect(c, d, u, f, 2 / r.zoom.value),
								e.fill(),
								e.stroke())
							: pu(e, c, d, u, f, c + u / 2, d + f / 2, i, !0),
					e.restore();
			}
		});
	},
	JH = (e, t, r, o, i) => {
		let [a, s, , , c, d] = mo(o, i),
			u = 3,
			f = 20,
			m = u / r.zoom.value,
			g = m / 2,
			h = c - a + m,
			y = d - s + m,
			E = Math.min(f / r.zoom.value, h),
			T = Math.min(f / r.zoom.value, y);
		e.save(),
			(e.fillStyle = t.selectionColor),
			(e.strokeStyle = t.selectionColor),
			(e.lineWidth = m),
			[
				[
					[-h, -y],
					[0, g],
					[E, g],
					[g, 0],
					[g, T],
				],
				[
					[h - g, -y],
					[g, g],
					[-E + g, g],
					[0, 0],
					[0, T],
				],
				[
					[-h, y],
					[0, -g],
					[E, -g],
					[g, 0],
					[g, -T],
				],
				[
					[h - g, y],
					[g, -g],
					[-E + g, -g],
					[0, 0],
					[0, -T],
				],
			].forEach((P) => {
				let [[C, k], [N, D], [B, F], [W, G], [q, ie]] = P;
				e.save(),
					e.translate(c, d),
					e.rotate(o.angle),
					e.beginPath(),
					e.moveTo(C + N, k + D),
					e.lineTo(C + B, k + F),
					e.stroke(),
					e.beginPath(),
					e.moveTo(C + W, k + G),
					e.lineTo(C + q, k + ie),
					e.stroke(),
					e.restore();
			}),
			e.restore();
	},
	eU = (e, t, r, o) => {
		t.save();
		let i = (xp * 2) / r.zoom.value,
			a = e.width + i * 2,
			s = e.height + i * 2,
			c = e.x + a / 2,
			d = e.y + s / 2,
			u = -(a / 2 + i),
			f = -(s / 2 + i);
		t.translate(c + r.scrollX, d + r.scrollY),
			t.rotate(e.angle),
			(t.lineWidth = 1 / r.zoom.value),
			(t.strokeStyle = o),
			t.strokeRect(u, f, a, s),
			t.restore();
	},
	PP = ({
		canvas: e,
		elementsMap: t,
		visibleElements: r,
		selectedElements: o,
		allElementsMap: i,
		scale: a,
		appState: s,
		renderConfig: c,
		device: d,
	}) => {
		if (e === null) return { atLeastOneVisibleElement: !1, elementsMap: t };
		let [u, f] = yf(e, a),
			m = wf({ canvas: e, scale: a, normalizedWidth: u, normalizedHeight: f });
		m.save(), m.scale(s.zoom.value, s.zoom.value);
		let g;
		if (
			(r.forEach((E) => {
				s.editingLinearElement?.elementId === E.id && E && (g = E);
			}),
			g && J0(m, s, g, t),
			s.selectionElement && !s.isCropping)
		)
			try {
				r_(s.selectionElement, m, s, c.selectionColor);
			} catch (E) {
				console.error(E);
			}
		if (s.editingTextElement && Ee(s.editingTextElement)) {
			let E = i.get(s.editingTextElement.id);
			E && !E.autoResize && eU(E, m, s, c.selectionColor);
		}
		s.isBindingEnabled &&
			s.suggestedBindings
				.filter((E) => E != null)
				.forEach((E) => {
					qH(m, s, E, t);
				}),
			s.frameToHighlight && jH(m, s, s.frameToHighlight, t),
			s.elementsToHighlight && QH(m, s, s.elementsToHighlight);
		let h = o.some((E) => Ye(E));
		if (
			(o.length === 1 &&
				s.editingLinearElement?.elementId === o[0].id &&
				J0(m, s, o[0], t),
			s.selectedLinearElement &&
				s.selectedLinearElement.hoverPointIndex >= 0 &&
				!(
					qe(o[0]) &&
					s.selectedLinearElement.hoverPointIndex > 0 &&
					s.selectedLinearElement.hoverPointIndex < o[0].points.length - 1
				) &&
				KH(m, s, t),
			!s.multiElement && !s.editingLinearElement)
		) {
			let E = zf(o, s),
				T = o.length === 1 && at(o[0]);
			T &&
				s.selectedLinearElement?.elementId === o[0].id &&
				!o[0].locked &&
				J0(m, s, o[0], t);
			let I = c.selectionColor || Yr.black;
			if (E) {
				let P = Fe(o),
					C = [];
				for (let N of t.values()) {
					let D = [],
						B = c.remoteSelectedElementIds.get(N.id);
					if (
						((T && qe(N) && (N.startBinding || N.endBinding)) ||
							(P.has(N.id) && !Rp(s, N) && D.push(I),
							B && D.push(...B.map((F) => ns(F, s.collaborators.get(F))))),
						D.length)
					) {
						let [F, W, G, q, ie, te] = mo(N, t, !0);
						C.push({
							angle: N.angle,
							x1: F,
							y1: W,
							x2: G,
							y2: q,
							selectionColors: D,
							dashed: !!B,
							cx: ie,
							cy: te,
							activeEmbeddable:
								s.activeEmbeddable?.element === N &&
								s.activeEmbeddable.state === "active",
							padding: N.id === s.croppingElementId || ct(N) ? 0 : void 0,
						});
					}
				}
				let k = (N) => {
					let D = Vt(t, N),
						[B, F, W, G] = yt(D);
					C.push({
						angle: 0,
						x1: B,
						x2: W,
						y1: F,
						y2: G,
						selectionColors: [Yr.black],
						dashed: !0,
						cx: B + (W - B) / 2,
						cy: F + (G - F) / 2,
						activeEmbeddable: !1,
					});
				};
				for (let N of Fn(s)) k(N);
				s.editingGroupId && k(s.editingGroupId), C.forEach((N) => MP(m, s, N));
			}
			if ((m.save(), m.translate(s.scrollX, s.scrollY), o.length === 1)) {
				m.fillStyle = Yr.white;
				let P = M_(o[0], s.zoom, t, "mouse", Bf(d));
				if (
					(!s.viewModeEnabled &&
						E &&
						!Ee(s.editingTextElement) &&
						!s.croppingElementId &&
						LP(m, c, s, P, o[0].angle),
					s.croppingElementId && !s.isCropping)
				) {
					let C = t.get(s.croppingElementId);
					C && ct(C) && JH(m, c, s, C, t);
				}
			} else if (o.length > 1 && !s.isRotating) {
				let P = (xp * 2) / s.zoom.value;
				m.fillStyle = Yr.white;
				let [C, k, N, D] = yt(o),
					B = m.getLineDash();
				m.setLineDash([2 / s.zoom.value]);
				let F = m.lineWidth;
				(m.lineWidth = 1 / s.zoom.value),
					(m.strokeStyle = I),
					pu(
						m,
						C - P,
						k - P,
						N - C + P * 2,
						D - k + P * 2,
						(C + N) / 2,
						(k + D) / 2,
						0,
					),
					(m.lineWidth = F),
					m.setLineDash(B);
				let W = L_(
					[C, k, N, D, (C + N) / 2, (k + D) / 2],
					0,
					s.zoom,
					"mouse",
					h ? { ...Bf(d), rotation: !0 } : Bf(d),
				);
				o.some((G) => !G.locked) && LP(m, c, s, W, 0);
			}
			m.restore();
		}
		s.searchMatches.forEach(({ id: E, focus: T, matchedLines: I }) => {
			let P = t.get(E);
			if (P && Ee(P)) {
				let [C, k, , , N, D] = mo(P, t, !0);
				m.save(),
					s.theme === $e.LIGHT
						? T
							? (m.fillStyle = "rgba(255, 124, 0, 0.4)")
							: (m.fillStyle = "rgba(255, 226, 0, 0.4)")
						: T
							? (m.fillStyle = "rgba(229, 82, 0, 0.4)")
							: (m.fillStyle = "rgba(99, 52, 0, 0.4)"),
					m.translate(s.scrollX, s.scrollY),
					m.translate(N, D),
					m.rotate(P.angle),
					I.forEach((B) => {
						m.fillRect(C + B.offsetX - N, k + B.offsetY - D, B.width, B.height);
					}),
					m.restore();
			}
		}),
			AP(m, s),
			m.restore(),
			W5({
				context: m,
				renderConfig: c,
				appState: s,
				normalizedWidth: u,
				normalizedHeight: f,
			});
		let y;
		return (
			c.renderScrollbars &&
				((y = FL(r, u, f, s)),
				m.save(),
				(m.fillStyle = OL),
				(m.strokeStyle = "rgba(255,255,255,0.8)"),
				[y.horizontal, y.vertical].forEach((E) => {
					E && Zg(m, E.x, E.y, E.width, E.height, xi / 2);
				}),
				m.restore()),
			{ scrollBars: y, atLeastOneVisibleElement: r.length > 0, elementsMap: t }
		);
	},
	tw = Ks(
		(e) => {
			let t = PP(e);
			e.callback?.(t);
		},
		{ trailing: !0 },
	),
	RP = (e, t) => {
		if (t) {
			tw(e);
			return;
		}
		let r = PP(e);
		return e.callback(r), r;
	};
var NP = w(M(), 1),
	tU = (e) => {
		let t = (0, Td.useRef)(!1);
		return (
			(0, Td.useEffect)(() => {
				if (!t.current) {
					t.current = !0;
					return;
				}
				let r = new Map(),
					o = new Map(),
					i = new Map(),
					a = new Map(),
					s = new Map();
				e.appState.collaborators.forEach((d, u) => {
					if (d.selectedElementIds)
						for (let f of Object.keys(d.selectedElementIds))
							i.has(f) || i.set(f, []), i.get(f).push(u);
					!d.pointer ||
						d.pointer.renderCursor === !1 ||
						(d.username && a.set(u, d.username),
						d.userState && s.set(u, d.userState),
						o.set(
							u,
							lo({ sceneX: d.pointer.x, sceneY: d.pointer.y }, e.appState),
						),
						r.set(u, d.button));
				});
				let c =
					(e.containerRef?.current &&
						getComputedStyle(e.containerRef.current).getPropertyValue(
							"--color-selection",
						)) ||
					"#6965db";
				RP(
					{
						canvas: e.canvas,
						elementsMap: e.elementsMap,
						visibleElements: e.visibleElements,
						selectedElements: e.selectedElements,
						allElementsMap: e.allElementsMap,
						scale: window.devicePixelRatio,
						appState: e.appState,
						renderConfig: {
							remotePointerViewportCoords: o,
							remotePointerButton: r,
							remoteSelectedElementIds: i,
							remotePointerUsernames: a,
							remotePointerUserStates: s,
							selectionColor: c,
							renderScrollbars: !1,
						},
						device: e.device,
						callback: e.renderInteractiveSceneCallback,
					},
					Sd(),
				);
			}),
			(0, NP.jsx)("canvas", {
				className: "excalidraw__canvas interactive",
				style: {
					width: e.appState.width,
					height: e.appState.height,
					cursor: e.appState.viewModeEnabled ? pt.GRAB : pt.AUTO,
				},
				width: e.appState.width * e.scale,
				height: e.appState.height * e.scale,
				ref: e.handleCanvasRef,
				onContextMenu: e.onContextMenu,
				onPointerMove: e.onPointerMove,
				onPointerUp: e.onPointerUp,
				onPointerCancel: e.onPointerCancel,
				onTouchMove: e.onTouchMove,
				onPointerDown: e.onPointerDown,
				onDoubleClick: e.appState.viewModeEnabled ? void 0 : e.onDoubleClick,
				children: v("labels.drawingCanvas"),
			})
		);
	},
	DP = (e) => ({
		zoom: e.zoom,
		scrollX: e.scrollX,
		scrollY: e.scrollY,
		width: e.width,
		height: e.height,
		viewModeEnabled: e.viewModeEnabled,
		openDialog: e.openDialog,
		editingGroupId: e.editingGroupId,
		editingLinearElement: e.editingLinearElement,
		selectedElementIds: e.selectedElementIds,
		frameToHighlight: e.frameToHighlight,
		offsetLeft: e.offsetLeft,
		offsetTop: e.offsetTop,
		theme: e.theme,
		pendingImageElementId: e.pendingImageElementId,
		selectionElement: e.selectionElement,
		selectedGroupIds: e.selectedGroupIds,
		selectedLinearElement: e.selectedLinearElement,
		multiElement: e.multiElement,
		isBindingEnabled: e.isBindingEnabled,
		suggestedBindings: e.suggestedBindings,
		isRotating: e.isRotating,
		elementsToHighlight: e.elementsToHighlight,
		collaborators: e.collaborators,
		activeEmbeddable: e.activeEmbeddable,
		snapLines: e.snapLines,
		zenModeEnabled: e.zenModeEnabled,
		editingTextElement: e.editingTextElement,
		isCropping: e.isCropping,
		croppingElementId: e.croppingElementId,
		searchMatches: e.searchMatches,
	}),
	rU = (e, t) =>
		e.selectionNonce !== t.selectionNonce ||
		e.sceneNonce !== t.sceneNonce ||
		e.scale !== t.scale ||
		e.elementsMap !== t.elementsMap ||
		e.visibleElements !== t.visibleElements ||
		e.selectedElements !== t.selectedElements
			? !1
			: Er(DP(e.appState), DP(t.appState)),
	rw = Td.default.memo(tU, rU);
b();
var Es = w(Q(), 1);
var FP = w(M(), 1),
	oU = (e) => {
		let t = (0, Es.useRef)(null),
			r = (0, Es.useRef)(!1);
		return (
			(0, Es.useEffect)(() => {
				let o = t.current;
				if (!o) return;
				let i = e.canvas;
				r.current ||
					((r.current = !0),
					o.replaceChildren(i),
					i.classList.add("excalidraw__canvas", "static"));
				let a = `${e.appState.width}px`,
					s = `${e.appState.height}px`;
				i.style.width !== a && (i.style.width = a),
					i.style.height !== s && (i.style.height = s);
				let c = e.appState.width * e.scale,
					d = e.appState.height * e.scale;
				i.width !== c && (i.width = c),
					i.height !== d && (i.height = d),
					$I(
						{
							canvas: i,
							rc: e.rc,
							scale: e.scale,
							elementsMap: e.elementsMap,
							allElementsMap: e.allElementsMap,
							visibleElements: e.visibleElements,
							appState: e.appState,
							renderConfig: e.renderConfig,
						},
						Sd(),
					);
			}),
			(0, FP.jsx)("div", { className: "excalidraw__canvas-wrapper", ref: t })
		);
	},
	OP = (e) => ({
		zoom: e.zoom,
		scrollX: e.scrollX,
		scrollY: e.scrollY,
		width: e.width,
		height: e.height,
		viewModeEnabled: e.viewModeEnabled,
		openDialog: e.openDialog,
		hoveredElementIds: e.hoveredElementIds,
		offsetLeft: e.offsetLeft,
		offsetTop: e.offsetTop,
		theme: e.theme,
		pendingImageElementId: e.pendingImageElementId,
		shouldCacheIgnoreZoom: e.shouldCacheIgnoreZoom,
		viewBackgroundColor: e.viewBackgroundColor,
		exportScale: e.exportScale,
		selectedElementsAreBeingDragged: e.selectedElementsAreBeingDragged,
		gridSize: e.gridSize,
		gridStep: e.gridStep,
		frameRendering: e.frameRendering,
		selectedElementIds: e.selectedElementIds,
		frameToHighlight: e.frameToHighlight,
		editingGroupId: e.editingGroupId,
		currentHoveredFontFamily: e.currentHoveredFontFamily,
		croppingElementId: e.croppingElementId,
	}),
	nU = (e, t) =>
		e.sceneNonce !== t.sceneNonce ||
		e.scale !== t.scale ||
		e.elementsMap !== t.elementsMap ||
		e.visibleElements !== t.visibleElements
			? !1
			: Er(OP(e.appState), OP(t.appState)) &&
				Er(e.renderConfig, t.renderConfig),
	ow = Es.default.memo(oU, nU);
b();
var fu = class {
	scene;
	constructor(t) {
		this.scene = t;
	}
	getRenderableElements = (() => {
		let t = ({
				elementsMap: o,
				zoom: i,
				offsetLeft: a,
				offsetTop: s,
				scrollX: c,
				scrollY: d,
				height: u,
				width: f,
			}) => {
				let m = [];
				for (let g of o.values())
					hm(
						g,
						f,
						u,
						{ zoom: i, offsetLeft: a, offsetTop: s, scrollX: c, scrollY: d },
						o,
					) && m.push(g);
				return m;
			},
			r = ({
				elements: o,
				editingTextElement: i,
				newElementId: a,
				pendingImageElementId: s,
			}) => {
				let c = Zs(new Map());
				for (let d of o)
					(ct(d) && s === d.id) ||
						(a !== d.id &&
							(!i || i.type !== "text" || d.id !== i.id) &&
							c.set(d.id, d));
				return c;
			};
		return XT(
			({
				zoom: o,
				offsetLeft: i,
				offsetTop: a,
				scrollX: s,
				scrollY: c,
				height: d,
				width: u,
				editingTextElement: f,
				newElementId: m,
				pendingImageElementId: g,
				sceneNonce: h,
			}) => {
				let y = this.scene.getNonDeletedElements(),
					E = r({
						elements: y,
						editingTextElement: f,
						newElementId: m,
						pendingImageElementId: g,
					}),
					T = t({
						elementsMap: E,
						zoom: o,
						offsetLeft: i,
						offsetTop: a,
						scrollX: s,
						scrollY: c,
						height: d,
						width: u,
					});
				return { elementsMap: E, visibleElements: T };
			},
		);
	})();
	destroy() {
		tw.cancel(), zI.cancel(), this.getRenderableElements.clear();
	}
};
b();
var ab = w(Q(), 1);
var nw = w(M(), 1),
	BP = ({ trails: e }) => {
		let t = (0, ab.useRef)(null);
		return (
			(0, ab.useEffect)(() => {
				if (t.current) for (let r of e) r.start(t.current);
				return () => {
					for (let r of e) r.stop();
				};
			}, e),
			(0, nw.jsx)("div", {
				className: "SVGLayer",
				children: (0, nw.jsx)("svg", { ref: t }),
			})
		);
	};
b();
var zP = w(M(), 1),
	iU = 5,
	aU = (e, t, r) => {
		let [o, i] = mo(e, r),
			{ x: a, y: s } = lo({ sceneX: o + e.width, sceneY: i }, t),
			c = a - t.offsetLeft + 10,
			d = s - t.offsetTop;
		return { x: c, y: d };
	},
	iw = ({ children: e, element: t, elementsMap: r }) => {
		let o = pi();
		if (
			o.contextMenu ||
			o.newElement ||
			o.resizingElement ||
			o.isRotating ||
			o.openMenu ||
			o.viewModeEnabled
		)
			return null;
		let { x: i, y: a } = aU(t, o, r);
		return (0, zP.jsx)("div", {
			className: "excalidraw-canvas-buttons",
			style: { top: `${a}px`, left: `${i}px`, padding: iU },
			children: e,
		});
	};
b();
var gu = w(M(), 1),
	lU = "small",
	lb = (e) =>
		(0, gu.jsxs)("label", {
			className: j("ToolIcon ToolIcon__MagicButton", `ToolIcon_size_${lU}`, {
				"is-mobile": e.isMobile,
			}),
			title: `${e.title}`,
			children: [
				(0, gu.jsx)("input", {
					className: "ToolIcon_type_checkbox",
					type: "checkbox",
					name: e.name,
					onChange: e.onChange,
					checked: e.checked,
					"aria-label": e.title,
				}),
				(0, gu.jsx)("div", { className: "ToolIcon__icon", children: e.icon }),
			],
		});
b();
var ys = w(M(), 1),
	sU = ({ height: e, width: t, userToFollow: r, onDisconnect: o }) =>
		(0, ys.jsx)("div", {
			className: "follow-mode",
			style: { width: t, height: e },
			children: (0, ys.jsxs)("div", {
				className: "follow-mode__badge",
				children: [
					(0, ys.jsxs)("div", {
						className: "follow-mode__badge__label",
						children: [
							"Following",
							" ",
							(0, ys.jsx)("span", {
								className: "follow-mode__badge__username",
								title: r.username,
								children: r.username,
							}),
						],
					}),
					(0, ys.jsx)("button", {
						type: "button",
						onClick: o,
						className: "follow-mode__disconnect-btn",
						children: un,
					}),
				],
			}),
		}),
	$P = sU;
b();
var sb = class {
	targets = new WeakMap();
	rafIds = new WeakMap();
	register(t, r) {
		this.targets.set(t, { callback: r, stopped: !0 });
	}
	start(t) {
		let r = this.targets.get(t);
		r &&
			(this.rafIds.has(t) ||
				(this.targets.set(t, { ...r, stopped: !1 }), this.scheduleFrame(t)));
	}
	stop(t) {
		let r = this.targets.get(t);
		r && !r.stopped && this.targets.set(t, { ...r, stopped: !0 }),
			this.cancelFrame(t);
	}
	constructFrame(t) {
		return (r) => {
			let o = this.targets.get(t);
			if (!o) return;
			let i = this.onFrame(o, r);
			!o.stopped && !i ? this.scheduleFrame(t) : this.cancelFrame(t);
		};
	}
	scheduleFrame(t) {
		let r = requestAnimationFrame(this.constructFrame(t));
		this.rafIds.set(t, r);
	}
	cancelFrame(t) {
		if (this.rafIds.has(t)) {
			let r = this.rafIds.get(t);
			cancelAnimationFrame(r);
		}
		this.rafIds.delete(t);
	}
	onFrame(t, r) {
		return t.callback(r) ?? !1;
	}
};
b();
b();
function cU(e, t, r, o) {
	Object.defineProperty(e, t, {
		get: r,
		set: o,
		enumerable: !0,
		configurable: !0,
	});
}
var dU = {};
cU(dU, "LaserPointer", () => bu);
function or([e, t, r], [o, i, a]) {
	return [e + o, t + i, r + a];
}
function hu([e, t, r], [o, i, a]) {
	return [e - o, t - i, r - a];
}
function gr([e, t, r], o) {
	return [e * o, t * o, r * o];
}
function Cd([e, t, r]) {
	return [e / Math.sqrt(e ** 2 + t ** 2), t / Math.sqrt(e ** 2 + t ** 2), r];
}
function ro([e, t, r], o) {
	return [
		Math.cos(o) * e - Math.sin(o) * t,
		Math.sin(o) * e + Math.cos(o) * t,
		r,
	];
}
function mU(e, t, r) {
	return or(e, gr(hu(t, e), r));
}
function HP(e, t, r) {
	return (
		Math.atan2(r[1] - e[1], r[0] - e[0]) - Math.atan2(t[1] - e[1], t[0] - e[0])
	);
}
function UP(e) {
	return Math.atan2(Math.sin(e), Math.cos(e));
}
function GP([e, t]) {
	return Math.sqrt(e ** 2 + t ** 2);
}
function Id([e, t], [r, o]) {
	return Math.sqrt((r - e) ** 2 + (o - t) ** 2);
}
function uU(e) {
	if (e.length < 2) return 0;
	let t = 0;
	for (let r = 1; r <= e.length - 1; r++) t += Id(e[r - 1], e[r]);
	return (t += Id(e[e.length - 2], e[e.length - 1])), t;
}
var pU = (e, t, r) => Math.max(t, Math.min(r, e));
function fU(e, t, r) {
	let o = Id(t, r);
	if (o === 0) return Id(e, t);
	let i = pU(
			((e[0] - t[0]) * (r[0] - t[0]) + (e[1] - t[1]) * (r[1] - t[1])) / o ** 2,
			0,
			1,
		),
		a = [t[0] + i * (r[0] - t[0]), t[1] + i * (r[1] - t[1]), e[2]];
	return Id(a, e);
}
function cb(e, t) {
	if (t === 0 || e.length <= 2) return e;
	let r = e[0],
		o = e[e.length - 1],
		[i, a] = e.reduce(
			([s, c], d, u) => {
				let f = fU(d, r, o);
				return f > s ? [f, u] : [s, c];
			},
			[0, -1],
		);
	if (i >= t) {
		let s = e[a];
		return [
			...cb([r, ...e.slice(1, a), s], t).slice(0, -1),
			s,
			...cb([s, ...e.slice(a, -1), o], t).slice(1),
		];
	} else return [r, o];
}
var bu = class e {
	static {
		this.defaults = {
			size: 2,
			streamline: 0.45,
			simplify: 0.1,
			simplifyPhase: "output",
			keepHead: !1,
			sizeMapping: () => 1,
		};
	}
	static {
		this.constants = {
			cornerDetectionMaxAngle: 75,
			cornerDetectionVariance: (t) => (t > 35 ? 0.5 : 1),
			maxTailLength: 50,
		};
	}
	constructor(t) {
		(this.originalPoints = []),
			(this.stablePoints = []),
			(this.tailPoints = []),
			(this.isFresh = !0),
			(this.options = Object.assign({}, e.defaults, t));
	}
	get lastPoint() {
		return (
			this.tailPoints[this.tailPoints.length - 1] ??
			this.stablePoints[this.stablePoints.length - 1]
		);
	}
	addPoint(t) {
		let r = this.originalPoints[this.originalPoints.length - 1];
		if (!(r && r[0] === t[0] && r[1] === t[1])) {
			if ((this.originalPoints.push(t), this.isFresh)) {
				(this.isFresh = !1), this.stablePoints.push(t);
				return;
			}
			this.options.streamline > 0 &&
				(t = mU(this.lastPoint, t, 1 - this.options.streamline)),
				this.tailPoints.push(t),
				uU(this.tailPoints) > e.constants.maxTailLength && this.stabilizeTail();
		}
	}
	close() {
		this.stabilizeTail();
	}
	stabilizeTail() {
		if (this.options.simplify > 0 && this.options.simplifyPhase == "tail")
			throw new Error("Not implemented yet");
		this.stablePoints.push(...this.tailPoints), (this.tailPoints = []);
	}
	getSize(t, r, o, i, a) {
		return (
			(t ?? this.options.size) *
			this.options.sizeMapping({
				pressure: r,
				runningLength: a,
				currentIndex: o,
				totalLength: i,
			})
		);
	}
	getStrokeOutline(t) {
		if (this.isFresh) return [];
		let r = [...this.stablePoints, ...this.tailPoints];
		this.options.simplify > 0 &&
			this.options.simplifyPhase === "input" &&
			(r = cb(r, this.options.simplify));
		let o = r.length;
		if (o === 0) return [];
		if (o === 1) {
			let B = r[0],
				F = this.getSize(t, B[2], 0, o, 0);
			if (F < 0.5) return [];
			let W = [];
			for (let G = 0; G <= Math.PI * 2; G += Math.PI / 16)
				W.push(or(B, gr(ro([1, 0, 0], G), F)));
			return W.push(or(B, gr([1, 0, 0], this.getSize(t, B[2], 0, o, 0)))), W;
		}
		if (o === 2) {
			let B = r[0],
				F = r[1],
				W = this.getSize(t, B[2], 0, o, 0),
				G = this.getSize(t, F[2], 0, o, 0);
			if (W < 0.5 || G < 0.5) return [];
			let q = [],
				ie = HP(B, [B[0], B[1] - 100, B[2]], F);
			for (let te = ie; te <= Math.PI + ie; te += Math.PI / 16)
				q.push(or(B, gr(ro([1, 0, 0], te), W)));
			for (let te = Math.PI + ie; te <= Math.PI * 2 + ie; te += Math.PI / 16)
				q.push(or(F, gr(ro([1, 0, 0], te), G)));
			return q.push(q[0]), q;
		}
		let i = [],
			a = [],
			s = 0,
			c = 0,
			d = 0,
			u = 0;
		for (let B = 1; B < o - 1; B++) {
			let F = r[B - 1],
				W = r[B],
				G = r[B + 1],
				q = W[2],
				ie = Id(F, W);
			(u += ie), (s = c + (ie - c) * 0.2);
			let te = this.getSize(t, q, B, o, u);
			if (te === 0) {
				d = B + 1;
				continue;
			}
			let we = Cd(hu(F, W)),
				X = Cd(hu(G, W)),
				se = ro(we, Math.PI / 2),
				Pe = ro(we, -Math.PI / 2),
				ke = ro(X, Math.PI / 2),
				fe = ro(X, -Math.PI / 2),
				Y = or(W, gr(se, te)),
				K = or(W, gr(Pe, te)),
				ee = or(W, gr(ke, te)),
				le = or(W, gr(fe, te)),
				ce = or(se, fe),
				ue = or(Pe, ke),
				ge = or(W, gr(GP(ce) === 0 ? we : Cd(ce), te)),
				Se = or(W, gr(GP(ue) === 0 ? X : Cd(ue), te)),
				Dt = UP(HP(W, F, G)),
				St =
					(e.constants.cornerDetectionMaxAngle / 180) *
					Math.PI *
					e.constants.cornerDetectionVariance(s);
			if (Math.abs(Dt) < St) {
				let _t = Math.abs(UP(Math.PI - Dt));
				if (_t === 0) continue;
				if (Dt < 0) {
					a.push(K, Se);
					for (let Tt = 0; Tt <= _t; Tt += _t / 4)
						i.push(or(W, ro(gr(se, te), Tt)));
					for (let Tt = _t; Tt >= 0; Tt -= _t / 4)
						a.push(or(W, ro(gr(se, te), Tt)));
					a.push(Se, ee);
				} else {
					i.push(Y, ge);
					for (let Tt = 0; Tt <= _t; Tt += _t / 4)
						a.push(or(W, ro(gr(se, -te), -Tt)));
					for (let Tt = _t; Tt >= 0; Tt -= _t / 4)
						i.push(or(W, ro(gr(se, -te), -Tt)));
					i.push(ge, le);
				}
			} else i.push(ge), a.push(Se);
			c = s;
		}
		if (d >= o - 2)
			if (this.options.keepHead) {
				let B = r[o - 1],
					F = [];
				for (let W = 0; W <= Math.PI * 2; W += Math.PI / 16)
					F.push(or(B, gr(ro([1, 0, 0], W), this.options.size)));
				return F.push(or(B, gr([1, 0, 0], this.options.size))), F;
			} else return [];
		let f = r[d],
			m = r[d + 1],
			g = r[o - 2],
			h = r[o - 1],
			y = Cd(hu(m, f)),
			E = Cd(hu(g, h)),
			T = ro(y, -Math.PI / 2),
			I = ro(E, Math.PI / 2),
			P = this.getSize(t, f[2], 0, o, 0),
			C = [],
			k = this.options.keepHead
				? this.options.size
				: this.getSize(t, g[2], o - 2, o, u),
			N = [];
		if (P > 1) {
			for (let B = 0; B <= Math.PI; B += Math.PI / 16)
				C.unshift(or(f, ro(gr(T, P), -B)));
			C.unshift(or(f, gr(T, -P)));
		} else C.push(f);
		for (let B = 0; B <= Math.PI * 3; B += Math.PI / 16)
			N.push(or(h, ro(gr(I, -k), -B)));
		let D = [...C, ...i, ...N.reverse(), ...a.reverse()];
		return (
			C.length > 0 && D.push(C[0]),
			this.options.simplify > 0 && this.options.simplifyPhase === "output"
				? cb(D, this.options.simplify)
				: D
		);
	}
};
var ws = class {
	constructor(t, r, o) {
		this.animationFrameHandler = t;
		this.app = r;
		this.options = o;
		this.animationFrameHandler.register(this, this.onFrame.bind(this)),
			(this.trailElement = document.createElementNS(MT, "path"));
	}
	currentTrail;
	pastTrails = [];
	container;
	trailElement;
	get hasCurrentTrail() {
		return !!this.currentTrail;
	}
	hasLastPoint(t, r) {
		if (this.currentTrail) {
			let o = this.currentTrail.originalPoints.length;
			return (
				this.currentTrail.originalPoints[o - 1][0] === t &&
				this.currentTrail.originalPoints[o - 1][1] === r
			);
		}
		return !1;
	}
	start(t) {
		t && (this.container = t),
			this.trailElement.parentNode !== this.container &&
				this.container &&
				this.container.appendChild(this.trailElement),
			this.animationFrameHandler.start(this);
	}
	stop() {
		this.animationFrameHandler.stop(this),
			this.trailElement.parentNode === this.container &&
				this.container?.removeChild(this.trailElement);
	}
	startPath(t, r) {
		(this.currentTrail = new bu(this.options)),
			this.currentTrail.addPoint([t, r, performance.now()]),
			this.update();
	}
	addPointToPath(t, r) {
		this.currentTrail &&
			(this.currentTrail.addPoint([t, r, performance.now()]), this.update());
	}
	endPath() {
		this.currentTrail &&
			(this.currentTrail.close(),
			(this.currentTrail.options.keepHead = !1),
			this.pastTrails.push(this.currentTrail),
			(this.currentTrail = void 0),
			this.update());
	}
	update() {
		this.start();
	}
	onFrame() {
		let t = [];
		for (let o of this.pastTrails) t.push(this.drawTrail(o, this.app.state));
		if (this.currentTrail) {
			let o = this.drawTrail(this.currentTrail, this.app.state);
			t.push(o);
		}
		(this.pastTrails = this.pastTrails.filter(
			(o) => o.getStrokeOutline().length !== 0,
		)),
			t.length === 0 && this.stop();
		let r = t.join(" ").trim();
		this.trailElement.setAttribute("d", r),
			this.trailElement.setAttribute(
				"fill",
				(this.options.fill ?? (() => "black"))(this),
			);
	}
	drawTrail(t, r) {
		let o = t.getStrokeOutline(t.options.size / r.zoom.value).map(([i, a]) => {
			let s = lo({ sceneX: i, sceneY: a }, r);
			return [s.x, s.y];
		});
		return qT(o, !0);
	}
};
b();
var db = class {
	constructor(t, r) {
		this.animationFrameHandler = t;
		this.app = r;
		this.animationFrameHandler.register(this, this.onFrame.bind(this)),
			(this.localTrail = new ws(t, r, {
				...this.getTrailOptions(),
				fill: () => Kx,
			}));
	}
	localTrail;
	collabTrails = new Map();
	container;
	getTrailOptions() {
		return {
			simplify: 0,
			streamline: 0.4,
			sizeMapping: (t) => {
				let i = Math.max(0, 1 - (performance.now() - t.pressure) / 1e3),
					a = (50 - Math.min(50, t.totalLength - t.currentIndex)) / 50;
				return Math.min(Tl(a), Tl(i));
			},
		};
	}
	startPath(t, r) {
		this.localTrail.startPath(t, r);
	}
	addPointToPath(t, r) {
		this.localTrail.addPointToPath(t, r);
	}
	endPath() {
		this.localTrail.endPath();
	}
	start(t) {
		(this.container = t),
			this.animationFrameHandler.start(this),
			this.localTrail.start(t);
	}
	stop() {
		this.animationFrameHandler.stop(this), this.localTrail.stop();
	}
	onFrame() {
		this.updateCollabTrails();
	}
	updateCollabTrails() {
		if (!(!this.container || this.app.state.collaborators.size === 0)) {
			for (let [t, r] of this.app.state.collaborators.entries()) {
				let o;
				this.collabTrails.has(t)
					? (o = this.collabTrails.get(t))
					: ((o = new ws(this.animationFrameHandler, this.app, {
							...this.getTrailOptions(),
							fill: () => r.pointer?.laserColor || ns(t, r),
						})),
						o.start(this.container),
						this.collabTrails.set(t, o)),
					r.pointer &&
						r.pointer.tool === "laser" &&
						(r.button === "down" &&
							!o.hasCurrentTrail &&
							o.startPath(r.pointer.x, r.pointer.y),
						r.button === "down" &&
							o.hasCurrentTrail &&
							!o.hasLastPoint(r.pointer.x, r.pointer.y) &&
							o.addPointToPath(r.pointer.x, r.pointer.y),
						r.button === "up" &&
							o.hasCurrentTrail &&
							(o.addPointToPath(r.pointer.x, r.pointer.y), o.endPath()));
			}
			for (let t of this.collabTrails.keys())
				this.app.state.collaborators.has(t) ||
					(this.collabTrails.get(t).stop(), this.collabTrails.delete(t));
		}
	}
};
b();
var gU = (e, t, r, o, i, a) => {
		let { zoom: s } = o,
			c = (180 * r) / Math.PI,
			d = (e * (s.value - 1)) / 2,
			u = (t * (s.value - 1)) / 2;
		return (
			e > i && s.value !== 1 && (d = (i * (s.value - 1)) / 2),
			t > a && s.value !== 1 && (u = (a * (s.value - 1)) / 2),
			`translate(${d}px, ${u}px) scale(${s.value}) rotate(${c}deg)`
		);
	},
	WP = ({
		id: e,
		onChange: t,
		onSubmit: r,
		getViewportCoords: o,
		element: i,
		canvas: a,
		excalidrawContainer: s,
		app: c,
		autoSelect: d = !0,
	}) => {
		let u = (X, se) => {
				if (!se.style.fontFamily || !se.style.fontSize) return !1;
				let Pe = se.style.fontFamily.replace(/"/g, "");
				return (
					wl({ fontFamily: X.fontFamily }) !== Pe ||
					`${X.fontSize}px` !== se.style.fontSize
				);
			},
			f = () => {
				let X = c.state,
					se = Un.getScene(i)?.getElement(e);
				if (!se) return;
				let { textAlign: Pe, verticalAlign: ke } = se,
					fe = c.scene.getNonDeletedElementsMap();
				if (se && Ee(se)) {
					let Y = se.x,
						K = se.y,
						ee = Gl(se, c.scene.getNonDeletedElementsMap()),
						le = se.width,
						ce = se.height,
						ue = se.width,
						ge = se.height;
					if (ee && se.containerId) {
						if (Lt(ee)) {
							let No = De.getBoundTextElementPosition(ee, se, fe);
							(Y = No.x), (K = No.y);
						}
						let ia = u(se, m),
							Or;
						if (
							(ia
								? (Or = gm(ee.id, ee.height))
								: ((Or = m_[ee.id]), Or || (Or = gm(ee.id, ee.height))),
							(ue = rE(ee, se)),
							(ge = T_(ee, se)),
							!Lt(ee) && ce > ge)
						) {
							let No = xc(ce, ee.type);
							me(ee, { height: No });
							return;
						} else if (!Lt(ee) && ee.height > Or.height && ce < ge) {
							let No = xc(ce, ee.type);
							me(ee, { height: No });
						} else {
							let { y: No } = Of(ee, se, fe);
							K = No;
						}
					}
					let [Se, Dt] = o(Y, K),
						St = m.selectionStart,
						_t = m.selectionEnd,
						Tt = m.value.length;
					if (St === _t && _t !== Tt) {
						let ia = Tt - _t;
						(m.selectionStart = m.value.length - ia),
							(m.selectionEnd = m.value.length - ia);
					}
					ee
						? (le += 0.5)
						: ((ue = (X.width - 8 - Se) / X.zoom.value),
							(le = Math.min(le, ue))),
						(ce *= 1.05);
					let cr = Lr(se),
						Do = (X.height - Dt) / X.zoom.value;
					Object.assign(m.style, {
						font: cr,
						lineHeight: se.lineHeight,
						width: `${le}px`,
						height: `${ce}px`,
						left: `${Se}px`,
						top: `${Dt}px`,
						transform: gU(le, ce, E_(se, ee), X, ue, Do),
						textAlign: Pe,
						verticalAlign: ke,
						color: se.strokeColor,
						opacity: se.opacity / 100,
						filter: "var(--theme-filter)",
						maxHeight: `${Do}px`,
					}),
						(m.scrollTop = 0),
						jd() && (m.style.fontFamily = wl(se)),
						me(se, { x: Y, y: K });
				}
			},
			m = document.createElement("textarea");
		(m.dir = "auto"),
			(m.tabIndex = 0),
			(m.dataset.type = "wysiwyg"),
			(m.wrap = "off"),
			m.classList.add("excalidraw-wysiwyg");
		let g = "pre",
			h = "normal";
		(co(i) || !i.autoResize) && ((g = "pre-wrap"), (h = "break-word")),
			Object.assign(m.style, {
				position: "absolute",
				display: "inline-block",
				minHeight: "1em",
				backfaceVisibility: "hidden",
				margin: 0,
				padding: 0,
				border: 0,
				outline: 0,
				resize: "none",
				background: "transparent",
				overflow: "hidden",
				zIndex: "var(--zIndex-wysiwyg)",
				wordBreak: h,
				whiteSpace: g,
				overflowWrap: "break-word",
				boxSizing: "content-box",
			}),
			(m.value = i.originalText),
			f(),
			t &&
				((m.onpaste = async (X) => {
					let se = await _f(X, !0);
					if (!se.text) return;
					let Pe = Ul(se.text);
					if (!Pe) return;
					let ke = Gl(i, c.scene.getNonDeletedElementsMap()),
						fe = Lr({
							fontSize: c.state.currentItemFontSize,
							fontFamily: c.state.currentItemFontFamily,
						});
					if (ke) {
						let Y = ot(ke, c.scene.getNonDeletedElementsMap()),
							K = Js(`${m.value}${Pe}`, fe, rE(ke, Y)),
							ee = b_(K, fe, !0);
						m.style.width = `${ee}px`;
					}
				}),
				(m.oninput = () => {
					let X = Ul(m.value);
					if (m.value !== X) {
						let se = m.selectionStart;
						(m.value = X), (m.selectionStart = se), (m.selectionEnd = se);
					}
					t(m.value);
				})),
			(m.onkeydown = (X) => {
				if (!X.shiftKey && Wg.keyTest(X))
					X.preventDefault(), c.actionManager.executeAction(Wg), f();
				else if (!X.shiftKey && Kg.keyTest(X))
					X.preventDefault(), c.actionManager.executeAction(Kg), f();
				else if (!X.shiftKey && Yg.keyTest(X))
					X.preventDefault(), c.actionManager.executeAction(Yg), f();
				else if (fy.keyTest(X)) c.actionManager.executeAction(fy);
				else if (gy.keyTest(X)) c.actionManager.executeAction(gy);
				else if (X.key === R.ESCAPE) X.preventDefault(), (N = !0), D();
				else if (X.key === R.ENTER && X[R.CTRL_OR_CMD]) {
					if ((X.preventDefault(), X.isComposing || X.keyCode === 229)) return;
					(N = !0), D();
				} else if (
					X.key === R.TAB ||
					(X[R.CTRL_OR_CMD] &&
						(X.code === Be.BRACKET_LEFT || X.code === Be.BRACKET_RIGHT))
				) {
					if ((X.preventDefault(), X.isComposing)) return;
					X.shiftKey || X.code === Be.BRACKET_LEFT ? P() : I(),
						m.dispatchEvent(new Event("input"));
				}
			});
		let y = 4,
			E = " ".repeat(y),
			T = new RegExp(`^ {1,${y}}`),
			I = () => {
				let { selectionStart: X, selectionEnd: se } = m,
					Pe = C(),
					ke = m.value;
				Pe.forEach((fe) => {
					let Y = ke.slice(0, fe),
						K = ke.slice(fe);
					ke = `${Y}${E}${K}`;
				}),
					(m.value = ke),
					(m.selectionStart = X + y),
					(m.selectionEnd = se + y * Pe.length);
			},
			P = () => {
				let { selectionStart: X, selectionEnd: se } = m,
					Pe = C(),
					ke = [],
					fe = m.value;
				Pe.forEach((Y) => {
					let K = fe.slice(Y, Y + y).match(T);
					if (K) {
						let ee = fe.slice(0, Y),
							le = fe.slice(Y + K[0].length);
						(fe = `${ee}${le}`), ke.push(Y);
					}
				}),
					(m.value = fe),
					ke.length &&
						(X > ke[ke.length - 1]
							? (m.selectionStart = Math.max(X - y, ke[ke.length - 1]))
							: (m.selectionStart = X),
						(m.selectionEnd = Math.max(m.selectionStart, se - y * ke.length)));
			},
			C = () => {
				let { selectionStart: X, selectionEnd: se, value: Pe } = m,
					ke = Pe.slice(0, X).match(/[^\n]*$/)[0].length;
				return (
					(X = X - ke),
					Pe.slice(X, se)
						.split(`
`)
						.reduce(
							(Y, K, ee, le) =>
								Y.concat(ee ? Y[ee - 1] + le[ee - 1].length + 1 : X),
							[],
						)
						.reverse()
				);
			},
			k = (X) => {
				X.target instanceof HTMLCanvasElement &&
					(X.preventDefault(), X.stopPropagation());
			},
			N = !1,
			D = () => {
				if (te) return;
				(te = !0), B();
				let X = Un.getScene(i)?.getElement(i.id);
				if (!X) return;
				let se = Gl(X, c.scene.getNonDeletedElementsMap());
				if (se) {
					if (m.value.trim()) {
						let Pe = v_(se);
						!Pe || Pe !== i.id
							? me(se, {
									boundElements: (se.boundElements || []).concat({
										type: "text",
										id: i.id,
									}),
								})
							: Lt(se) && nE(se);
					} else
						me(se, {
							boundElements: se.boundElements?.filter((Pe) => !Ee(Pe)),
						});
					jt(X, se, c.scene.getNonDeletedElementsMap());
				}
				r({ viaKeyboard: N, nextOriginalText: m.value });
			},
			B = () => {
				(m.onblur = null),
					(m.oninput = null),
					(m.onkeydown = null),
					we && we.disconnect(),
					window.removeEventListener("resize", f),
					window.removeEventListener("wheel", k, !0),
					window.removeEventListener("pointerdown", G),
					window.removeEventListener("pointerup", F),
					window.removeEventListener("blur", D),
					window.removeEventListener("beforeunload", D),
					q(),
					ie(),
					m.remove();
			},
			F = (X) => {
				window.removeEventListener("pointerup", F);
				let se = X?.target,
					Pe =
						se instanceof HTMLElement &&
						se.classList.contains("properties-trigger");
				setTimeout(() => {
					(m.onblur = D), Pe || m.focus();
				});
			},
			W = () => {
				(m.onblur = null),
					window.addEventListener("pointerup", F),
					window.addEventListener("blur", D);
			},
			G = (X) => {
				let se = X?.target;
				if (X.button === ni.WHEEL) {
					se instanceof HTMLTextAreaElement &&
						(X.preventDefault(), c.handleCanvasPanUsingWheelOrSpaceDrag(X)),
						W();
					return;
				}
				let Pe =
					se instanceof HTMLElement &&
					se.classList.contains("properties-trigger");
				((X.target instanceof HTMLElement || X.target instanceof SVGElement) &&
					X.target.closest(`.${Nn.SHAPE_ACTIONS_MENU}, .${Nn.ZOOM_ACTIONS}`) &&
					!ii(X.target)) ||
				Pe
					? W()
					: X.target instanceof HTMLCanvasElement &&
						!jd() &&
						requestAnimationFrame(() => {
							D();
						});
			},
			q = c.scene.onUpdate(() => {
				f(),
					!!document.activeElement?.closest(".properties-content") || m.focus();
			}),
			ie = c.onScrollChangeEmitter.on(() => {
				f();
			}),
			te = !1;
		d && m.select(), F();
		let we = null;
		a && "ResizeObserver" in window
			? ((we = new window.ResizeObserver(() => {
					f();
				})),
				we.observe(a))
			: window.addEventListener("resize", f),
			(m.onpointerdown = (X) => X.stopPropagation()),
			requestAnimationFrame(() => {
				window.addEventListener("pointerdown", G, { capture: !0 });
			}),
			window.addEventListener("beforeunload", D),
			s?.querySelector(".excalidraw-textEditorContainer").appendChild(m);
	};
b();
var KP = re({
	name: "autoResize",
	label: "labels.autoResize",
	icon: null,
	trackEvent: { category: "element" },
	predicate: (e, t, r, o) => {
		let i = Le(e, t);
		return i.length === 1 && Ee(i[0]) && !i[0].autoResize;
	},
	perform: (e, t, r, o) => {
		let i = Le(e, t);
		return {
			appState: t,
			elements: e.map((a) => {
				if (a.id === i[0].id && Ee(a)) {
					let s = Ko(a.originalText, Lr(a), a.lineHeight);
					return Me(a, {
						autoResize: !0,
						width: s.width,
						height: s.height,
						text: a.originalText,
					});
				}
				return a;
			}),
			storeAction: H.CAPTURE,
		};
	},
});
b();
var YP = (e) => {
	let t = [
		"flowchart",
		"graph",
		"sequenceDiagram",
		"classDiagram",
		"stateDiagram",
		"stateDiagram-v2",
		"erDiagram",
		"journey",
		"gantt",
		"pie",
		"quadrantChart",
		"requirementDiagram",
		"gitGraph",
		"C4Context",
		"mindmap",
		"timeline",
		"zenuml",
		"sankey",
		"xychart",
		"block",
	];
	return new RegExp(
		`^(?:%%{.*?}%%[\\s\\n]*)?\\b(?:${t.map((o) => `\\s*${o}(-beta)?`).join("|")})\\b`,
	).test(e.trim());
};
b();
var mb = w(Q(), 1);
b();
var VP = ({
		canvas: e,
		rc: t,
		newElement: r,
		elementsMap: o,
		allElementsMap: i,
		scale: a,
		appState: s,
		renderConfig: c,
	}) => {
		if (e) {
			let [d, u] = yf(e, a),
				f = wf({
					canvas: e,
					scale: a,
					normalizedWidth: d,
					normalizedHeight: u,
				});
			f.save(),
				f.scale(s.zoom.value, s.zoom.value),
				r && r.type !== "selection"
					? o_(r, o, i, t, f, c, s)
					: f.clearRect(0, 0, d, u);
		}
	},
	hU = Ks(
		(e) => {
			VP(e);
		},
		{ trailing: !0 },
	),
	XP = (e, t) => {
		if (t) {
			hU(e);
			return;
		}
		VP(e);
	};
var qP = w(M(), 1),
	bU = (e) => {
		let t = (0, mb.useRef)(null);
		return (
			(0, mb.useEffect)(() => {
				t.current &&
					XP(
						{
							canvas: t.current,
							scale: e.scale,
							newElement: e.appState.newElement,
							elementsMap: e.elementsMap,
							allElementsMap: e.allElementsMap,
							rc: e.rc,
							renderConfig: e.renderConfig,
							appState: e.appState,
						},
						Sd(),
					);
			}),
			(0, qP.jsx)("canvas", {
				className: "excalidraw__canvas",
				style: { width: e.appState.width, height: e.appState.height },
				width: e.appState.width * e.scale,
				height: e.appState.height * e.scale,
				ref: t,
			})
		);
	},
	ZP = bU;
var Ze = w(M(), 1),
	eR = hr.default.createContext(null),
	tR = hr.default.createContext(null),
	rR = {
		viewport: { isMobile: !1, isLandscape: !1 },
		editor: { isMobile: !1, canFitSidebar: !1 },
		isTouchScreen: !1,
	},
	mw = hr.default.createContext(rR);
mw.displayName = "DeviceContext";
var uw = hr.default.createContext({ container: null, id: null });
uw.displayName = "ExcalidrawContainerContext";
var pw = hr.default.createContext([]);
pw.displayName = "ExcalidrawElementsContext";
var fw = hr.default.createContext({
	...ec(),
	width: 0,
	height: 0,
	offsetLeft: 0,
	offsetTop: 0,
});
fw.displayName = "ExcalidrawAppStateContext";
var gw = hr.default.createContext(() => {
	console.warn("Uninitialized ExcalidrawSetAppStateContext context!");
});
gw.displayName = "ExcalidrawSetAppStateContext";
var hw = hr.default.createContext(null);
hw.displayName = "ExcalidrawActionManagerContext";
var Jt = () => (0, hr.useContext)(eR),
	fi = () => (0, hr.useContext)(tR),
	et = () => (0, hr.useContext)(mw),
	dr = () => (0, hr.useContext)(uw),
	Ha = () => (0, hr.useContext)(pw),
	pi = () => (0, hr.useContext)(fw),
	tt = () => (0, hr.useContext)(gw),
	pr = () => (0, hr.useContext)(hw),
	xu = !1,
	aw = 0,
	Ss = !1,
	vu = !1,
	lw = !1,
	sw = { horizontal: null, vertical: null },
	nl = 0,
	Eu = !1,
	cw = new Map(),
	ub = !1,
	jP = 0,
	QP = !1,
	yu = null,
	st = {
		pointers: new Map(),
		lastCenter: null,
		initialDistance: null,
		initialScale: null,
	},
	dw = class e extends hr.default.Component {
		canvas;
		interactiveCanvas = null;
		rc;
		unmounted = !1;
		actionManager;
		device = rR;
		excalidrawContainerRef = hr.default.createRef();
		scene;
		fonts;
		renderer;
		visibleElements;
		resizeObserver;
		nearestScrollableContainer;
		library;
		libraryItemsFromStorage;
		id;
		store;
		history;
		excalidrawContainerValue;
		files = {};
		imageCache = new Map();
		iFrameRefs = new Map();
		embedsValidationStatus = new Map();
		initializedEmbeds = new Set();
		elementsPendingErasure = new Set();
		flowChartCreator = new Mh();
		flowChartNavigator = new Lh();
		hitLinkElement;
		lastPointerDownEvent = null;
		lastPointerUpEvent = null;
		lastPointerMoveEvent = null;
		lastPointerMoveCoords = null;
		lastViewportPosition = { x: 0, y: 0 };
		animationFrameHandler = new sb();
		laserTrails = new db(this.animationFrameHandler, this);
		eraserTrail = new ws(this.animationFrameHandler, this, {
			streamline: 0.2,
			size: 5,
			keepHead: !0,
			sizeMapping: (t) => {
				let i = Math.max(0, 1 - (performance.now() - t.pressure) / 200),
					a = (10 - Math.min(10, t.totalLength - t.currentIndex)) / 10;
				return Math.min(Tl(a), Tl(i));
			},
			fill: () =>
				this.state.theme === $e.LIGHT
					? "rgba(0, 0, 0, 0.2)"
					: "rgba(255, 255, 255, 0.2)",
		});
		onChangeEmitter = new pn();
		onPointerDownEmitter = new pn();
		onPointerUpEmitter = new pn();
		onUserFollowEmitter = new pn();
		onScrollChangeEmitter = new pn();
		missingPointerEventCleanupEmitter = new pn();
		onRemoveEventListenersEmitter = new pn();
		constructor(t) {
			super(t);
			let r = ec(),
				{
					excalidrawAPI: o,
					viewModeEnabled: i = !1,
					zenModeEnabled: a = !1,
					gridModeEnabled: s = !1,
					objectsSnapModeEnabled: c = !1,
					theme: d = r.theme,
					name: u = `${v("labels.untitled")}-${nv()}`,
				} = t;
			if (
				((this.state = {
					...r,
					theme: d,
					isLoading: !0,
					...this.getCanvasOffsets(),
					viewModeEnabled: i,
					zenModeEnabled: a,
					objectsSnapModeEnabled: c,
					gridModeEnabled: s ?? r.gridModeEnabled,
					name: u,
					width: window.innerWidth,
					height: window.innerHeight,
				}),
				(this.id = NT()),
				(this.library = new f3(this)),
				(this.actionManager = new Ch(
					this.syncActionResult,
					() => this.state,
					() => this.scene.getElementsIncludingDeleted(),
					this,
				)),
				(this.scene = new Un()),
				(this.canvas = document.createElement("canvas")),
				(this.rc = DT.canvas(this.canvas)),
				(this.renderer = new fu(this.scene)),
				(this.visibleElements = []),
				(this.store = new bI()),
				(this.history = new Qm()),
				(this.fonts = new Bi(this.scene)),
				(this.history = new Qm()),
				o)
			) {
				let f = {
					updateScene: this.updateScene,
					updateLibrary: this.library.updateLibrary,
					addFiles: this.addFiles,
					resetScene: this.resetScene,
					getSceneElementsIncludingDeleted:
						this.getSceneElementsIncludingDeleted,
					history: { clear: this.resetHistory },
					scrollToContent: this.scrollToContent,
					getSceneElements: this.getSceneElements,
					getAppState: () => this.state,
					getFiles: () => this.files,
					getName: this.getName,
					registerAction: (m) => {
						this.actionManager.registerAction(m);
					},
					refresh: this.refresh,
					setToast: this.setToast,
					id: this.id,
					setActiveTool: this.setActiveTool,
					setCursor: this.setCursor,
					resetCursor: this.resetCursor,
					updateFrameRendering: this.updateFrameRendering,
					toggleSidebar: this.toggleSidebar,
					onChange: (m) => this.onChangeEmitter.on(m),
					onPointerDown: (m) => this.onPointerDownEmitter.on(m),
					onPointerUp: (m) => this.onPointerUpEmitter.on(m),
					onScrollChange: (m) => this.onScrollChangeEmitter.on(m),
					onUserFollow: (m) => this.onUserFollowEmitter.on(m),
					setFontFamily: this.setFontFamily,
				};
				typeof o == "function"
					? o(f)
					: console.error("excalidrawAPI should be a function!");
			}
			(this.excalidrawContainerValue = {
				container: this.excalidrawContainerRef.current,
				id: this.id,
			}),
				this.actionManager.registerAll(fC),
				this.actionManager.registerAction(SL(this.history, this.store)),
				this.actionManager.registerAction(TL(this.history, this.store));
		}
		onWindowMessage(t) {
			if (
				t.origin !== "https://player.vimeo.com" &&
				t.origin !== "https://www.youtube.com"
			)
				return;
			let r = null;
			try {
				r = JSON.parse(t.data);
			} catch {}
			if (r)
				switch (t.origin) {
					case "https://player.vimeo.com":
						if (r.method === "paused") {
							let o = null,
								i = document.body.querySelectorAll(
									"iframe.excalidraw__embeddable",
								);
							if (!i) break;
							for (let a of i)
								a.contentWindow === t.source && (o = a.contentWindow);
							o?.postMessage(
								JSON.stringify({
									method: r.value ? "play" : "pause",
									value: !0,
								}),
								"*",
							);
						}
						break;
					case "https://www.youtube.com":
						if (
							r.event === "infoDelivery" &&
							r.info &&
							r.id &&
							typeof r.info.playerState == "number"
						) {
							let o = r.id,
								i = r.info.playerState;
							Object.values(Kd).includes(i) && cw.set(o, i);
						}
						break;
				}
		}
		cacheEmbeddableRef(t, r) {
			r && this.iFrameRefs.set(t.id, r);
		}
		getEffectiveGridSize = () => (Hl(this) ? this.state.gridSize : null);
		getHTMLIFrameElement(t) {
			return this.iFrameRefs.get(t.id);
		}
		handleEmbeddableCenterClick(t) {
			if (
				(this.state.activeEmbeddable?.element === t &&
					this.state.activeEmbeddable?.state === "active") ||
				(setTimeout(() => {
					this.setState({
						activeEmbeddable: { element: t, state: "active" },
						selectedElementIds: { [t.id]: !0 },
						newElement: null,
						selectionElement: null,
					});
				}, 100),
				Al(t))
			)
				return;
			let r = this.getHTMLIFrameElement(t);
			if (r?.contentWindow) {
				if (r.src.includes("youtube")) {
					let o = cw.get(t.id);
					switch (
						(o ||
							(cw.set(t.id, Kd.UNSTARTED),
							r.contentWindow.postMessage(
								JSON.stringify({ event: "listening", id: t.id }),
								"*",
							)),
						o)
					) {
						case Kd.PLAYING:
						case Kd.BUFFERING:
							r.contentWindow?.postMessage(
								JSON.stringify({
									event: "command",
									func: "pauseVideo",
									args: "",
								}),
								"*",
							);
							break;
						default:
							r.contentWindow?.postMessage(
								JSON.stringify({
									event: "command",
									func: "playVideo",
									args: "",
								}),
								"*",
							);
					}
				}
				r.src.includes("player.vimeo.com") &&
					r.contentWindow.postMessage(
						JSON.stringify({ method: "paused" }),
						"*",
					);
			}
		}
		isIframeLikeElementCenter(t, r, o, i) {
			return (
				t &&
				!r.altKey &&
				!r.shiftKey &&
				!r.metaKey &&
				!r.ctrlKey &&
				(this.state.activeEmbeddable?.element !== t ||
					this.state.activeEmbeddable?.state === "hover" ||
					!this.state.activeEmbeddable) &&
				o >= t.x + t.width / 3 &&
				o <= t.x + (2 * t.width) / 3 &&
				i >= t.y + t.height / 3 &&
				i <= t.y + (2 * t.height) / 3
			);
		}
		updateEmbedValidationStatus = (t, r) => {
			this.embedsValidationStatus.set(t.id, r), Ca.delete(t);
		};
		updateEmbeddables = () => {
			let t = new Set(),
				r = !1;
			this.scene.getNonDeletedElements().filter((o) => {
				if (so(o)) {
					if ((t.add(o.id), !this.embedsValidationStatus.has(o.id))) {
						r = !0;
						let i = pc(o.link, this.props.validateEmbeddable);
						this.updateEmbedValidationStatus(o, i);
					}
				} else Al(o) && t.add(o.id);
				return !1;
			}),
				r && this.scene.triggerUpdate(),
				this.iFrameRefs.forEach((o, i) => {
					t.has(i) || this.iFrameRefs.delete(i);
				});
		};
		renderEmbeddables() {
			let t = this.state.zoom.value,
				r = this.state.width,
				o = this.state.height,
				i = this.scene
					.getNonDeletedElements()
					.filter(
						(a) =>
							(so(a) && this.embedsValidationStatus.get(a.id) === !0) || Al(a),
					);
			return (0, Ze.jsx)(Ze.Fragment, {
				children: i.map((a) => {
					let { x: s, y: c } = lo({ sceneX: a.x, sceneY: a.y }, this.state),
						d = hm(a, r, o, this.state, this.scene.getNonDeletedElementsMap()),
						u = this.initializedEmbeds.has(a.id);
					if ((d && !u && this.initializedEmbeds.add(a.id), !(d || u)))
						return null;
					let m;
					if (Al(a)) {
						m = null;
						let y = (a.customData?.generationData ??
							this.magicGenerations.get(a.id)) || {
							status: "error",
							message: "No generation data",
							code: "ERR_NO_GENERATION_DATA",
						};
						if (y.status === "done") {
							let E = y.html;
							m = {
								intrinsicSize: { w: a.width, h: a.height },
								type: "document",
								srcdoc: () => E,
							};
						} else if (y.status === "pending")
							m = {
								intrinsicSize: { w: a.width, h: a.height },
								type: "document",
								srcdoc: () =>
									Dv(`
                    <style>
                      html, body {
                        width: 100%;
                        height: 100%;
                        color: ${this.state.theme === $e.DARK ? "white" : "black"};
                      }
                      body {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        flex-direction: column;
                        gap: 1rem;
                      }

                      .Spinner {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-left: auto;
                        margin-right: auto;
                      }

                      .Spinner svg {
                        animation: rotate 1.6s linear infinite;
                        transform-origin: center center;
                        width: 40px;
                        height: 40px;
                      }

                      .Spinner circle {
                        stroke: currentColor;
                        animation: dash 1.6s linear 0s infinite;
                        stroke-linecap: round;
                      }

                      @keyframes rotate {
                        100% {
                          transform: rotate(360deg);
                        }
                      }

                      @keyframes dash {
                        0% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: 0;
                        }
                        50% {
                          stroke-dasharray: 150, 300;
                          stroke-dashoffset: -200;
                        }
                        100% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: -280;
                        }
                      }
                    </style>
                    <div class="Spinner">
                      <svg
                        viewBox="0 0 100 100"
                      >
                        <circle
                          cx="50"
                          cy="50"
                          r="46"
                          stroke-width="8"
                          fill="none"
                          stroke-miter-limit="10"
                        />
                      </svg>
                    </div>
                    <div>Generating...</div>
                  `),
							};
						else {
							let E;
							y.code === "ERR_GENERATION_INTERRUPTED"
								? (E = "Generation was interrupted...")
								: (E = y.message || "Generation failed"),
								(m = {
									intrinsicSize: { w: a.width, h: a.height },
									type: "document",
									srcdoc: () =>
										Dv(`
                    <style>
                    html, body {
                      height: 100%;
                    }
                      body {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        color: ${Mi.red[3]};
                      }
                      h1, h3 {
                        margin-top: 0;
                        margin-bottom: 0.5rem;
                      }
                    </style>
                    <h1>Error!</h1>
                    <h3>${E}</h3>
                  `),
								});
						}
					} else m = Fl(pC(a.link || ""));
					let g =
							this.state.activeEmbeddable?.element === a &&
							this.state.activeEmbeddable?.state === "active",
						h =
							this.state.activeEmbeddable?.element === a &&
							this.state.activeEmbeddable?.state === "hover";
					return (0, Ze.jsx)(
						"div",
						{
							className: j("excalidraw__embeddable-container", {
								"is-hovered": h,
							}),
							style: {
								transform: d
									? `translate(${s - this.state.offsetLeft}px, ${c - this.state.offsetTop}px) scale(${t})`
									: "none",
								display: d ? "block" : "none",
								opacity: t_(
									a,
									Lf(a, this.scene.getNonDeletedElementsMap()),
									this.elementsPendingErasure,
									null,
									this.state.openDialog?.name === "elementLinkSelector"
										? RT
										: 1,
								),
								"--embeddable-radius": `${cf(Math.min(a.width, a.height), a)}px`,
							},
							children: (0, Ze.jsxs)("div", {
								className: "excalidraw__embeddable-container__inner",
								style: {
									width: d ? `${a.width}px` : 0,
									height: d ? `${a.height}px` : 0,
									transform: d ? `rotate(${a.angle}rad)` : "none",
									pointerEvents: g ? yl.enabled : yl.disabled,
								},
								children: [
									h &&
										(0, Ze.jsx)("div", {
											className: "excalidraw__embeddable-hint",
											children: v("buttons.embeddableInteractionButton"),
										}),
									(0, Ze.jsx)("div", {
										className: "excalidraw__embeddable__outer",
										style: { padding: `${a.strokeWidth}px` },
										children:
											(so(a)
												? this.props.renderEmbeddable?.(a, this.state)
												: null) ??
											(0, Ze.jsx)("iframe", {
												ref: (y) => this.cacheEmbeddableRef(a, y),
												className: "excalidraw__embeddable",
												srcDoc:
													m?.type === "document"
														? m.srcdoc(this.state.theme)
														: void 0,
												src: m?.type !== "document" ? (m?.link ?? "") : void 0,
												scrolling: "no",
												referrerPolicy: "no-referrer-when-downgrade",
												title: "Excalidraw Embedded Content",
												allow:
													"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",
												allowFullScreen: !0,
												sandbox: `${m?.sandbox?.allowSameOrigin ? "allow-same-origin" : ""} allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-presentation allow-downloads`,
											}),
									}),
								],
							}),
						},
						a.id,
					);
				}),
			});
		}
		getFrameNameDOMId = (t) => `${this.id}-frame-name-${t.id}`;
		frameNameBoundsCache = {
			get: (t) => {
				let r = this.frameNameBoundsCache._cache.get(t.id);
				if (
					!r ||
					r.zoom !== this.state.zoom.value ||
					r.versionNonce !== t.versionNonce
				) {
					let o = document.getElementById(this.getFrameNameDOMId(t));
					if (o) {
						let i = o.getBoundingClientRect(),
							a = Ot({ clientX: i.x, clientY: i.y }, this.state),
							s = Ot({ clientX: i.right, clientY: i.bottom }, this.state);
						return (
							(r = {
								x: a.x,
								y: a.y,
								width: s.x - a.x,
								height: s.y - a.y,
								angle: 0,
								zoom: this.state.zoom.value,
								versionNonce: t.versionNonce,
							}),
							this.frameNameBoundsCache._cache.set(t.id, r),
							r
						);
					}
					return null;
				}
				return r;
			},
			_cache: new Map(),
		};
		resetEditingFrame = (t) => {
			t && me(t, { name: t.name?.trim() || null }),
				this.setState({ editingFrame: null });
		};
		renderFrameNames = () => {
			if (!this.state.frameRendering.enabled || !this.state.frameRendering.name)
				return this.state.editingFrame && this.resetEditingFrame(null), null;
			let t = this.state.theme === $e.DARK;
			return this.scene.getNonDeletedFramesLikes().map((r) => {
				if (
					!hm(
						r,
						this.canvas.width / window.devicePixelRatio,
						this.canvas.height / window.devicePixelRatio,
						{
							offsetLeft: this.state.offsetLeft,
							offsetTop: this.state.offsetTop,
							scrollX: this.state.scrollX,
							scrollY: this.state.scrollY,
							zoom: this.state.zoom,
						},
						this.scene.getNonDeletedElementsMap(),
					)
				)
					return (
						this.state.editingFrame === r.id && this.resetEditingFrame(r), null
					);
				let { x: o, y: i } = lo({ sceneX: r.x, sceneY: r.y }, this.state),
					a = 6,
					s,
					c = e_(r);
				if (r.id === this.state.editingFrame) {
					let d = c;
					s = (0, Ze.jsx)("input", {
						autoFocus: !0,
						value: d,
						onChange: (u) => {
							me(r, { name: u.target.value });
						},
						onFocus: (u) => u.target.select(),
						onBlur: () => this.resetEditingFrame(r),
						onKeyDown: (u) => {
							(u.key === R.ESCAPE || u.key === R.ENTER) &&
								this.resetEditingFrame(r);
						},
						style: {
							background: this.state.viewBackgroundColor,
							filter: t ? TT : "none",
							zIndex: 2,
							border: "none",
							display: "block",
							padding: `${a}px`,
							borderRadius: 4,
							boxShadow: "inset 0 0 0 1px var(--color-primary)",
							fontFamily: "Assistant",
							fontSize: "14px",
							transform: `translate(-${a}px, ${a}px)`,
							color: "var(--color-gray-80)",
							overflow: "hidden",
							maxWidth: `${document.body.clientWidth - o - a}px`,
						},
						size: d.length + 1 || 1,
						dir: "auto",
						autoComplete: "off",
						autoCapitalize: "off",
						autoCorrect: "off",
					});
				} else s = c;
				return (0, Ze.jsx)(
					"div",
					{
						id: this.getFrameNameDOMId(r),
						style: {
							position: "absolute",
							bottom: `${this.state.height + On.nameOffsetY - i + this.state.offsetTop}px`,
							left: `${o - this.state.offsetLeft}px`,
							zIndex: 2,
							fontSize: On.nameFontSize,
							color: t ? On.nameColorDarkTheme : On.nameColorLightTheme,
							lineHeight: On.nameLineHeight,
							width: "max-content",
							maxWidth: `${r.width}px`,
							overflow: r.id === this.state.editingFrame ? "visible" : "hidden",
							whiteSpace: "nowrap",
							textOverflow: "ellipsis",
							cursor: pt.MOVE,
							pointerEvents: this.state.viewModeEnabled
								? yl.disabled
								: yl.enabled,
						},
						onPointerDown: (d) => this.handleCanvasPointerDown(d),
						onWheel: (d) => this.handleWheel(d),
						onContextMenu: this.handleCanvasContextMenu,
						onDoubleClick: () => {
							this.setState({ editingFrame: r.id });
						},
						children: s,
					},
					r.id,
				);
			});
		};
		toggleOverscrollBehavior(t) {
			document.documentElement.style.overscrollBehaviorX =
				t.type === "pointerenter" ? "none" : "auto";
		}
		render() {
			let t = this.scene.getSelectedElements(this.state),
				{ renderTopRightUI: r, renderCustomStats: o } = this.props,
				i = this.scene.getSceneNonce(),
				{ elementsMap: a, visibleElements: s } =
					this.renderer.getRenderableElements({
						sceneNonce: i,
						zoom: this.state.zoom,
						offsetLeft: this.state.offsetLeft,
						offsetTop: this.state.offsetTop,
						scrollX: this.state.scrollX,
						scrollY: this.state.scrollY,
						height: this.state.height,
						width: this.state.width,
						editingTextElement: this.state.editingTextElement,
						newElementId: this.state.newElement?.id,
						pendingImageElementId: this.state.pendingImageElementId,
					});
			this.visibleElements = s;
			let c = this.scene.getNonDeletedElementsMap(),
				d =
					this.state.selectionElement ||
					this.state.newElement ||
					this.state.selectedElementsAreBeingDragged ||
					this.state.resizingElement ||
					(this.state.activeTool.type === "laser" &&
						this.state.cursorButton === "down"),
				u = t[0];
			return (0, Ze.jsx)("div", {
				className: j("excalidraw excalidraw-container", {
					"excalidraw--view-mode":
						this.state.viewModeEnabled ||
						this.state.openDialog?.name === "elementLinkSelector",
					"excalidraw--mobile": this.device.editor.isMobile,
				}),
				style: { "--ui-pointerEvents": d ? yl.disabled : yl.enabled },
				ref: this.excalidrawContainerRef,
				onDrop: this.handleAppOnDrop,
				tabIndex: 0,
				onKeyDown: this.props.handleKeyboardGlobally ? void 0 : this.onKeyDown,
				onPointerEnter: this.toggleOverscrollBehavior,
				onPointerLeave: this.toggleOverscrollBehavior,
				children: (0, Ze.jsx)(eR.Provider, {
					value: this,
					children: (0, Ze.jsx)(tR.Provider, {
						value: this.props,
						children: (0, Ze.jsx)(uw.Provider, {
							value: this.excalidrawContainerValue,
							children: (0, Ze.jsx)(mw.Provider, {
								value: this.device,
								children: (0, Ze.jsx)(gw.Provider, {
									value: this.setAppState,
									children: (0, Ze.jsx)(fw.Provider, {
										value: this.state,
										children: (0, Ze.jsxs)(pw.Provider, {
											value: this.scene.getNonDeletedElements(),
											children: [
												(0, Ze.jsxs)(hw.Provider, {
													value: this.actionManager,
													children: [
														(0, Ze.jsx)(xP, {
															canvas: this.canvas,
															appState: this.state,
															files: this.files,
															setAppState: this.setAppState,
															actionManager: this.actionManager,
															elements: this.scene.getNonDeletedElements(),
															onLockToggle: this.toggleLock,
															onPenModeToggle: this.togglePenMode,
															onHandToolToggle: this.onHandToolToggle,
															langCode: ci().code,
															renderTopRightUI: r,
															renderCustomStats: o,
															showExitZenModeBtn:
																typeof this.props?.zenModeEnabled > "u" &&
																this.state.zenModeEnabled,
															UIOptions: this.props.UIOptions,
															onExportImage: this.onExportImage,
															renderWelcomeScreen:
																!this.state.isLoading &&
																this.state.showWelcomeScreen &&
																this.state.activeTool.type === "selection" &&
																!this.state.zenModeEnabled &&
																!this.scene.getElementsIncludingDeleted()
																	.length,
															app: this,
															isCollaborating: this.props.isCollaborating,
															generateLinkForSelection:
																this.props.generateLinkForSelection,
															children: this.props.children,
														}),
														(0, Ze.jsx)("div", {
															className: "excalidraw-textEditorContainer",
														}),
														(0, Ze.jsx)("div", {
															className: "excalidraw-contextMenuContainer",
														}),
														(0, Ze.jsx)("div", {
															className: "excalidraw-eye-dropper-container",
														}),
														(0, Ze.jsx)(BP, {
															trails: [this.laserTrails, this.eraserTrail],
														}),
														t.length === 1 &&
															this.state.openDialog?.name !==
																"elementLinkSelector" &&
															this.state.showHyperlinkPopup &&
															(0, Ze.jsx)(
																J5,
																{
																	element: u,
																	elementsMap: c,
																	setAppState: this.setAppState,
																	onLinkOpen: this.props.onLinkOpen,
																	setToast: this.setToast,
																	updateEmbedValidationStatus:
																		this.updateEmbedValidationStatus,
																},
																u.id,
															),
														this.props.aiEnabled !== !1 &&
															t.length === 1 &&
															Pp(u) &&
															(0, Ze.jsx)(iw, {
																element: u,
																elementsMap: a,
																children: (0, Ze.jsx)(lb, {
																	title: v("labels.convertToCode"),
																	icon: Xp,
																	checked: !1,
																	onChange: () =>
																		this.onMagicFrameGenerate(u, "button"),
																}),
															}),
														t.length === 1 &&
															Al(u) &&
															u.customData?.generationData?.status === "done" &&
															(0, Ze.jsxs)(iw, {
																element: u,
																elementsMap: a,
																children: [
																	(0, Ze.jsx)(lb, {
																		title: v("labels.copySource"),
																		icon: ac,
																		checked: !1,
																		onChange: () => this.onIframeSrcCopy(u),
																	}),
																	(0, Ze.jsx)(lb, {
																		title: "Enter fullscreen",
																		icon: T2,
																		checked: !1,
																		onChange: () => {
																			let f = this.getHTMLIFrameElement(u);
																			if (f)
																				try {
																					f.requestFullscreen(),
																						this.setState({
																							activeEmbeddable: {
																								element: u,
																								state: "active",
																							},
																							selectedElementIds: {
																								[u.id]: !0,
																							},
																							newElement: null,
																							selectionElement: null,
																						});
																				} catch (m) {
																					console.warn(m),
																						this.setState({
																							errorMessage:
																								"Couldn't enter fullscreen",
																						});
																				}
																		},
																	}),
																],
															}),
														this.state.toast !== null &&
															(0, Ze.jsx)(vP, {
																message: this.state.toast.message,
																onClose: () => this.setToast(null),
																duration: this.state.toast.duration,
																closable: this.state.toast.closable,
															}),
														this.state.contextMenu &&
															(0, Ze.jsx)(_L, {
																items: this.state.contextMenu.items,
																top: this.state.contextMenu.top,
																left: this.state.contextMenu.left,
																actionManager: this.actionManager,
																onClose: (f) => {
																	this.setState({ contextMenu: null }, () => {
																		this.focusContainer(), f?.();
																	});
																},
															}),
														(0, Ze.jsx)(ow, {
															canvas: this.canvas,
															rc: this.rc,
															elementsMap: a,
															allElementsMap: c,
															visibleElements: s,
															sceneNonce: i,
															selectionNonce:
																this.state.selectionElement?.versionNonce,
															scale: window.devicePixelRatio,
															appState: this.state,
															renderConfig: {
																imageCache: this.imageCache,
																isExporting: !1,
																renderGrid: Hl(this),
																canvasBackgroundColor:
																	this.state.viewBackgroundColor,
																embedsValidationStatus:
																	this.embedsValidationStatus,
																elementsPendingErasure:
																	this.elementsPendingErasure,
																pendingFlowchartNodes:
																	this.flowChartCreator.pendingNodes,
															},
														}),
														this.state.newElement &&
															(0, Ze.jsx)(ZP, {
																appState: this.state,
																scale: window.devicePixelRatio,
																rc: this.rc,
																elementsMap: a,
																allElementsMap: c,
																renderConfig: {
																	imageCache: this.imageCache,
																	isExporting: !1,
																	renderGrid: !1,
																	canvasBackgroundColor:
																		this.state.viewBackgroundColor,
																	embedsValidationStatus:
																		this.embedsValidationStatus,
																	elementsPendingErasure:
																		this.elementsPendingErasure,
																	pendingFlowchartNodes: null,
																},
															}),
														(0, Ze.jsx)(rw, {
															containerRef: this.excalidrawContainerRef,
															canvas: this.interactiveCanvas,
															elementsMap: a,
															visibleElements: s,
															allElementsMap: c,
															selectedElements: t,
															sceneNonce: i,
															selectionNonce:
																this.state.selectionElement?.versionNonce,
															scale: window.devicePixelRatio,
															appState: this.state,
															device: this.device,
															renderInteractiveSceneCallback:
																this.renderInteractiveSceneCallback,
															handleCanvasRef: this.handleInteractiveCanvasRef,
															onContextMenu: this.handleCanvasContextMenu,
															onPointerMove: this.handleCanvasPointerMove,
															onPointerUp: this.handleCanvasPointerUp,
															onPointerCancel: this.removePointer,
															onTouchMove: this.handleTouchMove,
															onPointerDown: this.handleCanvasPointerDown,
															onDoubleClick: this.handleCanvasDoubleClick,
														}),
														this.state.userToFollow &&
															(0, Ze.jsx)($P, {
																width: this.state.width,
																height: this.state.height,
																userToFollow: this.state.userToFollow,
																onDisconnect: this.maybeUnfollowRemoteUser,
															}),
														this.renderFrameNames(),
													],
												}),
												this.renderEmbeddables(),
											],
										}),
									}),
								}),
							}),
						}),
					}),
				}),
			});
		}
		focusContainer = () => {
			this.excalidrawContainerRef.current?.focus();
		};
		getSceneElementsIncludingDeleted = () =>
			this.scene.getElementsIncludingDeleted();
		getSceneElements = () => this.scene.getNonDeletedElements();
		onInsertElements = (t) => {
			this.addElementsFromPasteOrLibrary({
				elements: t,
				position: "center",
				files: null,
			});
		};
		onExportImage = async (t, r, o) => {
			We("export", t, "ui");
			let i = await ts(t, r, this.state, this.files, {
				exportBackground: this.state.exportBackground,
				name: this.getName(),
				viewBackgroundColor: this.state.viewBackgroundColor,
				exportingFrame: o.exportingFrame,
			})
				.catch(_p)
				.catch((a) => {
					console.error(a), this.setState({ errorMessage: a.message });
				});
			this.state.exportEmbedScene &&
				i &&
				gf(i) &&
				this.setState({ fileHandle: i });
		};
		magicGenerations = new Map();
		updateMagicGeneration = ({ frameElement: t, data: r }) => {
			r.status === "pending"
				? me(t, { customData: { generationData: void 0 } }, !1)
				: me(t, { customData: { generationData: r } }, !1),
				this.magicGenerations.set(t.id, r),
				this.triggerRender();
		};
		plugins = {};
		setPlugins(t) {
			Object.assign(this.plugins, t);
		}
		async onMagicFrameGenerate(t, r) {
			let o = this.plugins.diagramToCode?.generate;
			if (!o) {
				this.setState({ errorMessage: "No diagram to code plugin found" });
				return;
			}
			let i = Df(this.scene.getNonDeletedElements(), t).filter((s) => !Pp(s));
			if (!i.length) {
				r === "button"
					? (this.setState({
							errorMessage: "Cannot generate from an empty frame",
						}),
						We("ai", "generate (no-children)", "d2c"))
					: this.setActiveTool({ type: "magicframe" });
				return;
			}
			let a = this.insertIframeElement({
				sceneX: t.x + t.width + 30,
				sceneY: t.y,
				width: t.width,
				height: t.height,
			});
			if (a) {
				this.updateMagicGeneration({
					frameElement: a,
					data: { status: "pending" },
				}),
					this.setState({ selectedElementIds: { [a.id]: !0 } }),
					We("ai", "generate (start)", "d2c");
				try {
					let { html: s } = await o({ frame: t, children: i });
					if ((We("ai", "generate (success)", "d2c"), !s.trim())) {
						this.updateMagicGeneration({
							frameElement: a,
							data: {
								status: "error",
								code: "ERR_OAI",
								message: "Nothing genereated :(",
							},
						});
						return;
					}
					let c =
						s.includes("<!DOCTYPE html>") && s.includes("</html>")
							? s.slice(s.indexOf("<!DOCTYPE html>"), s.indexOf("</html>") + 7)
							: s;
					this.updateMagicGeneration({
						frameElement: a,
						data: { status: "done", html: c },
					});
				} catch (s) {
					We("ai", "generate (failed)", "d2c"),
						this.updateMagicGeneration({
							frameElement: a,
							data: {
								status: "error",
								code: "ERR_OAI",
								message: s.message || "Unknown error during generation",
							},
						});
				}
			}
		}
		onIframeSrcCopy(t) {
			t.customData?.generationData?.status === "done" &&
				(Aa(t.customData.generationData.html),
				this.setToast({
					message: "copied to clipboard",
					closable: !1,
					duration: 1500,
				}));
		}
		onMagicframeToolSelect = () => {
			let t = this.scene.getSelectedElements({
				selectedElementIds: this.state.selectedElementIds,
			});
			if (t.length === 0)
				this.setActiveTool({ type: Co.magicframe }),
					We("ai", "tool-select (empty-selection)", "d2c");
			else {
				let r = t.length === 1 && Pp(t[0]) && t[0];
				if (!r && t.some((i) => Ye(i) || i.frameId)) {
					this.setActiveTool({ type: Co.magicframe });
					return;
				}
				We("ai", "tool-select (existing selection)", "d2c");
				let o;
				if (r) o = r;
				else {
					let [i, a, s, c] = yt(t),
						d = 50;
					(o = am({
						...On,
						x: i - d,
						y: a - d,
						width: s - i + d * 2,
						height: c - a + d * 2,
						opacity: 100,
						locked: !1,
					})),
						this.scene.insertElement(o);
					for (let u of t) me(u, { frameId: o.id });
					this.setState({ selectedElementIds: { [o.id]: !0 } });
				}
				this.onMagicFrameGenerate(o, "upstream");
			}
		};
		openEyeDropper = ({ type: t }) => {
			zr.set($a, {
				swapPreviewOnAlt: !0,
				colorPickerType: t === "stroke" ? "elementStroke" : "elementBackground",
				onSelect: (r, o) => {
					let i =
						(t === "background" && o.altKey) || (t === "stroke" && !o.altKey);
					!this.scene.getSelectedElements(this.state).length ||
					this.state.activeTool.type !== "selection"
						? i
							? this.syncActionResult({
									appState: { ...this.state, currentItemStrokeColor: r },
									storeAction: H.CAPTURE,
								})
							: this.syncActionResult({
									appState: { ...this.state, currentItemBackgroundColor: r },
									storeAction: H.CAPTURE,
								})
						: this.updateScene({
								elements: this.scene
									.getElementsIncludingDeleted()
									.map((s) =>
										this.state.selectedElementIds[s.id]
											? Me(s, { [i ? "strokeColor" : "backgroundColor"]: r })
											: s,
									),
								storeAction: H.CAPTURE,
							});
				},
				keepOpenOnAlt: !1,
			});
		};
		dismissLinearEditor = () => {
			setTimeout(() => {
				this.setState({ editingLinearElement: null });
			});
		};
		syncActionResult = Wt((t) => {
			if (this.unmounted || t === !1) return;
			t.storeAction === H.UPDATE
				? this.store.shouldUpdateSnapshot()
				: t.storeAction === H.CAPTURE && this.store.shouldCaptureIncrement();
			let r = !1,
				o = null;
			if (
				(t.elements && (this.scene.replaceAllElements(t.elements), (r = !0)),
				t.files &&
					(this.addMissingFiles(t.files, t.replaceFiles),
					this.addNewImagesToImageCache()),
				t.appState || o || this.state.contextMenu)
			) {
				let i = t?.appState?.viewModeEnabled || !1,
					a = t?.appState?.zenModeEnabled || !1,
					s = t?.appState?.theme || this.props.theme || $e.LIGHT,
					c = t?.appState?.name ?? this.state.name,
					d = t?.appState?.errorMessage ?? this.state.errorMessage;
				typeof this.props.viewModeEnabled < "u" &&
					(i = this.props.viewModeEnabled),
					typeof this.props.zenModeEnabled < "u" &&
						(a = this.props.zenModeEnabled),
					(o = t.appState?.editingTextElement || null),
					t.elements &&
						o &&
						t.elements.forEach((u) => {
							o?.id === u.id && o !== u && uE(u) && Ee(u) && (o = u);
						}),
					o?.isDeleted && (o = null),
					this.setState((u) => {
						let f = t.appState || {};
						return {
							...u,
							...f,
							contextMenu: null,
							editingTextElement: o,
							viewModeEnabled: i,
							zenModeEnabled: a,
							theme: s,
							name: c,
							errorMessage: d,
						};
					}),
					(r = !0);
			}
			!r && t.storeAction !== H.NONE && this.scene.triggerUpdate();
		});
		onBlur = Wt(() => {
			(Ss = !1), this.setState({ isBindingEnabled: !0 });
		});
		onUnload = () => {
			this.onBlur();
		};
		disableEvent = (t) => {
			t.preventDefault();
		};
		resetHistory = () => {
			this.history.clear();
		};
		resetStore = () => {
			this.store.clear();
		};
		resetScene = Wt((t) => {
			this.scene.replaceAllElements([]),
				this.setState((r) => ({
					...ec(),
					isLoading: t?.resetLoadingState ? !1 : r.isLoading,
					theme: this.state.theme,
				})),
				this.resetStore(),
				this.resetHistory();
		});
		initializeScene = async () => {
			"launchQueue" in window &&
				"LaunchParams" in window &&
				window.launchQueue.setConsumer(async (o) => {
					if (!o.files.length) return;
					let i = o.files[0],
						a = await i.getFile();
					this.loadFileToCanvas(
						new File([a], a.name || "", { type: a.type }),
						i,
					);
				}),
				this.props.theme && this.setState({ theme: this.props.theme }),
				this.state.isLoading || this.setState({ isLoading: !0 });
			let t = null;
			try {
				typeof this.props.initialData == "function"
					? (t = (await this.props.initialData()) || null)
					: (t = (await this.props.initialData) || null),
					t?.libraryItems &&
						this.library
							.updateLibrary({ libraryItems: t.libraryItems, merge: !0 })
							.catch((o) => {
								console.error(o);
							});
			} catch (o) {
				console.error(o),
					(t = {
						appState: {
							errorMessage:
								o.message ||
								"Encountered an error during importing or restoring scene data",
						},
					});
			}
			let r = Bv(t, null, null, { repairBindings: !0 });
			(r.appState = {
				...r.appState,
				theme: this.props.theme || r.appState.theme,
				openSidebar: r.appState?.openSidebar || this.state.openSidebar,
				activeTool:
					r.appState.activeTool.type === "image"
						? { ...r.appState.activeTool, type: "selection" }
						: r.appState.activeTool,
				isLoading: !1,
				toast: this.state.toast,
			}),
				t?.scrollToContent &&
					(r.appState = {
						...r.appState,
						...Kl(r.elements, {
							...r.appState,
							width: this.state.width,
							height: this.state.height,
							offsetTop: this.state.offsetTop,
							offsetLeft: this.state.offsetLeft,
						}),
					}),
				this.resetStore(),
				this.resetHistory(),
				this.syncActionResult({ ...r, storeAction: H.UPDATE }),
				this.clearImageShapeCache(),
				this.fonts.loadSceneFonts().then((o) => {
					this.fonts.onLoaded(o);
				}),
				zl(window.location.href) &&
					this.scrollToContent(window.location.href, { animate: !1 });
		};
		isMobileBreakpoint = (t, r) => t < CT || (r < _T && t < IT);
		refreshViewportBreakpoints = () => {
			if (!this.excalidrawContainerRef.current) return;
			let { clientWidth: r, clientHeight: o } = document.body,
				i = this.device.viewport,
				a = Ys(i, {
					isLandscape: r > o,
					isMobile: this.isMobileBreakpoint(r, o),
				});
			return i !== a
				? ((this.device = { ...this.device, viewport: a }), !0)
				: !1;
		};
		refreshEditorBreakpoints = () => {
			let t = this.excalidrawContainerRef.current;
			if (!t) return;
			let { width: r, height: o } = t.getBoundingClientRect(),
				i =
					this.props.UIOptions.dockedSidebarBreakpoint != null
						? this.props.UIOptions.dockedSidebarBreakpoint
						: AT,
				a = this.device.editor,
				s = Ys(a, {
					isMobile: this.isMobileBreakpoint(r, o),
					canFitSidebar: r > i,
				});
			return a !== s ? ((this.device = { ...this.device, editor: s }), !0) : !1;
		};
		clearImageShapeCache(t) {
			let r = t ?? this.files;
			this.scene.getNonDeletedElements().forEach((o) => {
				_l(o) &&
					r[o.fileId] &&
					(this.imageCache.delete(o.fileId), Ca.delete(o));
			});
		}
		async componentDidMount() {
			if (
				((this.unmounted = !1),
				(this.excalidrawContainerValue.container =
					this.excalidrawContainerRef.current),
				_.MODE === Bs.TEST || _.DEV)
			) {
				let r = this.setState.bind(this);
				Object.defineProperties(window.h, {
					state: { configurable: !0, get: () => this.state },
					setState: { configurable: !0, value: (...o) => this.setState(...o) },
					app: { configurable: !0, value: this },
					history: { configurable: !0, value: this.history },
					store: { configurable: !0, value: this.store },
					fonts: { configurable: !0, value: this.fonts },
				});
			}
			this.store.onStoreIncrementEmitter.on((r) => {
				this.history.record(r.elementsChange, r.appStateChange);
			}),
				this.scene.onUpdate(this.triggerRender),
				this.addEventListeners(),
				this.props.autoFocus &&
					this.excalidrawContainerRef.current &&
					this.focusContainer(),
				jd() ||
					(this.refreshViewportBreakpoints(), this.refreshEditorBreakpoints()),
				Gd &&
					this.excalidrawContainerRef.current &&
					((this.resizeObserver = new ResizeObserver(() => {
						this.refreshEditorBreakpoints(), this.updateDOMRect();
					})),
					this.resizeObserver?.observe(this.excalidrawContainerRef.current)),
				new URLSearchParams(window.location.search.slice(1)).has(
					"web-share-target",
				)
					? this.restoreFileFromShare()
					: this.updateDOMRect(this.initializeScene),
				dT() && !C_() && this.setState({ errorMessage: (0, Ze.jsx)(SP, {}) });
		}
		componentWillUnmount() {
			window.launchQueue?.setConsumer(() => {}),
				this.renderer.destroy(),
				this.scene.destroy(),
				(this.scene = new Un()),
				(this.fonts = new Bi(this.scene)),
				(this.renderer = new fu(this.scene)),
				(this.files = {}),
				this.imageCache.clear(),
				this.resizeObserver?.disconnect(),
				(this.unmounted = !0),
				this.removeEventListeners(),
				this.library.destroy(),
				this.laserTrails.stop(),
				this.eraserTrail.stop(),
				this.onChangeEmitter.clear(),
				this.store.onStoreIncrementEmitter.clear(),
				Ca.destroy(),
				Ma.destroy(),
				clearTimeout(nl),
				bt.clearCache(),
				Mr.clearCache(),
				(nl = 0),
				(document.documentElement.style.overscrollBehaviorX = "");
		}
		onResize = Wt(() => {
			this.scene.getElementsIncludingDeleted().forEach((t) => Ca.delete(t)),
				this.refreshViewportBreakpoints(),
				this.updateDOMRect(),
				Gd || this.refreshEditorBreakpoints(),
				this.setState({});
		});
		onFullscreenChange = () => {
			!document.fullscreenElement &&
				this.state.activeEmbeddable?.state === "active" &&
				this.setState({ activeEmbeddable: null });
		};
		removeEventListeners() {
			this.onRemoveEventListenersEmitter.trigger();
		}
		addEventListeners() {
			this.removeEventListeners(),
				this.props.handleKeyboardGlobally &&
					this.onRemoveEventListenersEmitter.once(
						kt(document, "keydown", this.onKeyDown, !1),
					),
				this.onRemoveEventListenersEmitter.once(
					kt(this.excalidrawContainerRef.current, "wheel", this.handleWheel, {
						passive: !1,
					}),
					kt(window, "message", this.onWindowMessage, !1),
					kt(document, "pointerup", this.removePointer, { passive: !1 }),
					kt(document, "copy", this.onCopy, { passive: !1 }),
					kt(document, "keyup", this.onKeyUp, { passive: !0 }),
					kt(document, "pointermove", this.updateCurrentCursorPosition, {
						passive: !1,
					}),
					kt(
						document.fonts,
						"loadingdone",
						(t) => {
							let r = t.fontfaces;
							this.fonts.onLoaded(r);
						},
						{ passive: !1 },
					),
					kt(document, "gesturestart", this.onGestureStart, !1),
					kt(document, "gesturechange", this.onGestureChange, !1),
					kt(document, "gestureend", this.onGestureEnd, !1),
					kt(
						window,
						"focus",
						() => {
							this.maybeCleanupAfterMissingPointerUp(null),
								this.triggerRender(!0);
						},
						{ passive: !1 },
					),
				),
				!this.state.viewModeEnabled &&
					(this.onRemoveEventListenersEmitter.once(
						kt(document, "fullscreenchange", this.onFullscreenChange, {
							passive: !1,
						}),
						kt(document, "paste", this.pasteFromClipboard, { passive: !1 }),
						kt(document, "cut", this.onCut, { passive: !1 }),
						kt(window, "resize", this.onResize, !1),
						kt(window, "unload", this.onUnload, !1),
						kt(window, "blur", this.onBlur, !1),
						kt(this.excalidrawContainerRef.current, "wheel", this.handleWheel, {
							passive: !1,
						}),
						kt(
							this.excalidrawContainerRef.current,
							"dragover",
							this.disableEvent,
							!1,
						),
						kt(
							this.excalidrawContainerRef.current,
							"drop",
							this.disableEvent,
							!1,
						),
					),
					this.props.detectScroll &&
						this.onRemoveEventListenersEmitter.once(
							kt(
								UT(this.excalidrawContainerRef.current),
								"scroll",
								this.onScroll,
								{ passive: !1 },
							),
						));
		}
		componentDidUpdate(t, r) {
			this.updateEmbeddables();
			let o = this.scene.getElementsIncludingDeleted(),
				i = this.scene.getElementsMapIncludingDeleted(),
				a = this.scene.getNonDeletedElementsMap();
			!this.state.showWelcomeScreen &&
				!o.length &&
				this.setState({ showWelcomeScreen: !0 }),
				t.UIOptions.dockedSidebarBreakpoint !==
					this.props.UIOptions.dockedSidebarBreakpoint &&
					this.refreshEditorBreakpoints(),
				r.userToFollow &&
					!this.state.collaborators.has(r.userToFollow.socketId) &&
					this.maybeUnfollowRemoteUser(),
				(r.zoom.value !== this.state.zoom.value ||
					r.scrollX !== this.state.scrollX ||
					r.scrollY !== this.state.scrollY) &&
					(this.props?.onScrollChange?.(
						this.state.scrollX,
						this.state.scrollY,
						this.state.zoom,
					),
					this.onScrollChangeEmitter.trigger(
						this.state.scrollX,
						this.state.scrollY,
						this.state.zoom,
					)),
				r.userToFollow !== this.state.userToFollow &&
					(r.userToFollow &&
						this.onUserFollowEmitter.trigger({
							userToFollow: r.userToFollow,
							action: "UNFOLLOW",
						}),
					this.state.userToFollow &&
						this.onUserFollowEmitter.trigger({
							userToFollow: this.state.userToFollow,
							action: "FOLLOW",
						})),
				Object.keys(this.state.selectedElementIds).length &&
					dn(this.state) &&
					this.setState({ activeTool: Yt(this.state, { type: "selection" }) }),
				this.state.activeTool.type === "eraser" &&
					r.theme !== this.state.theme &&
					gC(this.interactiveCanvas, this.state.theme),
				r.activeTool.type === "selection" &&
					this.state.activeTool.type !== "selection" &&
					this.state.showHyperlinkPopup &&
					this.setState({ showHyperlinkPopup: !1 }),
				t.langCode !== this.props.langCode && this.updateLanguage(),
				dn(r) && !dn(this.state) && this.eraserTrail.endPath(),
				t.viewModeEnabled !== this.props.viewModeEnabled &&
					this.setState({ viewModeEnabled: !!this.props.viewModeEnabled }),
				r.viewModeEnabled !== this.state.viewModeEnabled &&
					(this.addEventListeners(), this.deselectElements()),
				(r.openDialog?.name === "elementLinkSelector" ||
					this.state.openDialog?.name === "elementLinkSelector") &&
					r.openDialog?.name !== this.state.openDialog?.name &&
					(this.deselectElements(), this.setState({ hoveredElementIds: {} })),
				t.zenModeEnabled !== this.props.zenModeEnabled &&
					this.setState({ zenModeEnabled: !!this.props.zenModeEnabled }),
				t.theme !== this.props.theme &&
					this.props.theme &&
					this.setState({ theme: this.props.theme }),
				this.excalidrawContainerRef.current?.classList.toggle(
					"theme--dark",
					this.state.theme === $e.DARK,
				),
				this.state.editingLinearElement &&
					!this.state.selectedElementIds[
						this.state.editingLinearElement.elementId
					] &&
					setTimeout(() => {
						this.state.editingLinearElement &&
							this.actionManager.executeAction(Zo);
					}),
				this.state.editingTextElement?.isDeleted &&
					this.setState({ editingTextElement: null }),
				this.state.selectedLinearElement &&
					!this.state.selectedElementIds[
						this.state.selectedLinearElement.elementId
					] &&
					this.setState({ selectedLinearElement: null });
			let { multiElement: c } = r;
			r.activeTool !== this.state.activeTool &&
				c != null &&
				Nl(this.state) &&
				Ni(c, !1) &&
				cm(
					c,
					this.state,
					ya(De.getPointAtIndexGlobalCoordinates(c, -1, a)),
					this.scene.getNonDeletedElementsMap(),
					this.scene.getNonDeletedElements(),
				),
				this.store.commit(i, this.state),
				this.state.isLoading ||
					(this.props.onChange?.(o, this.state, this.files),
					this.onChangeEmitter.trigger(o, this.state, this.files));
		}
		renderInteractiveSceneCallback = ({
			atLeastOneVisibleElement: t,
			scrollBars: r,
			elementsMap: o,
		}) => {
			r && (sw = r);
			let i = this.state.editingTextElement ? !1 : !t && o.size > 0;
			this.state.scrolledOutside !== i && this.setState({ scrolledOutside: i }),
				this.scheduleImageRefresh();
		};
		onScroll = Sl(() => {
			let { offsetTop: t, offsetLeft: r } = this.getCanvasOffsets();
			this.setState((o) =>
				o.offsetLeft === r && o.offsetTop === t
					? null
					: { offsetTop: t, offsetLeft: r },
			);
		}, wT);
		onCut = Wt((t) => {
			!this.excalidrawContainerRef.current?.contains(document.activeElement) ||
				ii(t.target) ||
				(this.actionManager.executeAction(qg, "keyboard", t),
				t.preventDefault(),
				t.stopPropagation());
		});
		onCopy = Wt((t) => {
			!this.excalidrawContainerRef.current?.contains(document.activeElement) ||
				ii(t.target) ||
				(this.actionManager.executeAction(Jc, "keyboard", t),
				t.preventDefault(),
				t.stopPropagation());
		});
		static resetTapTwice() {
			xu = !1;
		}
		onTouchStart = (t) => {
			if ((cT && t.preventDefault(), !xu)) {
				(xu = !0),
					clearTimeout(aw),
					(aw = window.setTimeout(e.resetTapTwice, ET));
				return;
			}
			if (xu && t.touches.length === 1) {
				let r = t.touches[0];
				this.handleCanvasDoubleClick({
					clientX: r.clientX,
					clientY: r.clientY,
				}),
					(xu = !1),
					clearTimeout(aw);
			}
			t.touches.length === 2 &&
				this.setState({
					selectedElementIds: dt({}, this.state),
					activeEmbeddable: null,
				});
		};
		onTouchEnd = (t) => {
			this.resetContextMenuTimer(),
				t.touches.length > 0
					? this.setState({
							previousSelectedElementIds: {},
							selectedElementIds: dt(
								this.state.previousSelectedElementIds,
								this.state,
							),
						})
					: st.pointers.clear();
		};
		pasteFromClipboard = Wt(async (t) => {
			let r = !!ub,
				o = document.activeElement,
				i = this.excalidrawContainerRef.current?.contains(o);
			if (t && !i) return;
			let a = document.elementFromPoint(
				this.lastViewportPosition.x,
				this.lastViewportPosition.y,
			);
			if (t && (!(a instanceof HTMLCanvasElement) || ii(o))) return;
			let { x: s, y: c } = Ot(
					{
						clientX: this.lastViewportPosition.x,
						clientY: this.lastViewportPosition.y,
					},
					this.state,
				),
				d = t?.clipboardData?.files[0],
				u = await _f(t, r);
			if (!d && !r) {
				if (u.mixedContent)
					return this.addElementsFromMixedContentPaste(u.mixedContent, {
						isPlainPaste: r,
						sceneX: s,
						sceneY: c,
					});
				if (u.text) {
					let f = u.text.trim();
					f.startsWith("<svg") && f.endsWith("</svg>") && (d = Hv(f));
				}
			}
			if (hf(d) && !u.spreadsheet) {
				if (!this.isToolSupported("image")) {
					this.setState({ errorMessage: v("errors.imageToolNotSupported") });
					return;
				}
				let f = this.createImageElement({ sceneX: s, sceneY: c });
				this.insertImageElement(f, d),
					this.initializeImageDimensions(f),
					this.setState({ selectedElementIds: dt({ [f.id]: !0 }, this.state) });
				return;
			}
			if (this.props.onPaste)
				try {
					if ((await this.props.onPaste(u, t)) === !1) return;
				} catch (f) {
					console.error(f);
				}
			if (u.errorMessage) this.setState({ errorMessage: u.errorMessage });
			else if (u.spreadsheet && !r)
				this.setState({ pasteDialog: { data: u.spreadsheet, shown: !0 } });
			else if (u.elements) {
				let f = u.programmaticAPI ? gd(u.elements) : u.elements;
				this.addElementsFromPasteOrLibrary({
					elements: f,
					files: u.files || null,
					position: "cursor",
					retainSeed: r,
				});
			} else if (u.text) {
				if (u.text && YP(u.text)) {
					let g = await import("./excalidraw-assets/dist-QNDTTFGF.js");
					try {
						let { elements: h, files: y } = await g.parseMermaidToExcalidraw(
								u.text,
							),
							E = gd(h, { regenerateIds: !0 });
						this.addElementsFromPasteOrLibrary({
							elements: E,
							files: y,
							position: "cursor",
						});
						return;
					} catch (h) {
						console.warn(
							`parsing pasted text as mermaid definition failed: ${h.message}`,
						);
					}
				}
				let f = jT(u.text)
						.split(/\n+/)
						.map((g) => g.trim())
						.filter(Boolean),
					m = f
						.map((g) => xI(g))
						.filter(
							(g) =>
								pc(g, this.props.validateEmbeddable) &&
								(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(g) ||
									Fl(g)?.type === "video"),
						);
				if (!ub && m.length > 0 && m.length === f.length) {
					let g = [];
					for (let h of m) {
						let y = g[g.length - 1],
							E = this.insertEmbeddableElement({
								sceneX: y ? y.x + y.width + 20 : s,
								sceneY: c,
								link: Bn(h),
							});
						E && g.push(E);
					}
					g.length &&
						this.setState({
							selectedElementIds: Object.fromEntries(g.map((h) => [h.id, !0])),
						});
					return;
				}
				this.addTextFromPaste(u.text, r);
			}
			this.setActiveTool({ type: "selection" }), t?.preventDefault();
		});
		addElementsFromPasteOrLibrary = (t) => {
			let r = t.elements.map((D, B, F) => {
				if (qe(D)) {
					let W = [
							D.startBinding &&
								F.find((ie) => ie.id === D.startBinding?.elementId),
							D.endBinding && F.find((ie) => ie.id === D.endBinding?.elementId),
						],
						G = W[0] ? D.startBinding : null,
						q = W[1] ? D.endBinding : null;
					return {
						...D,
						...n_(
							{ ...D, startBinding: G, endBinding: q },
							Zs(
								new Map(W.filter((ie) => ie != null).map((ie) => [ie.id, ie])),
							),
							[D.points[0], D.points[D.points.length - 1]],
							void 0,
							{ zoom: this.state.zoom },
						),
					};
				}
				return D;
			});
			r = Fv(r, null, void 0);
			let [o, i, a, s] = yt(r),
				c = Cl(o, a) / 2,
				d = Cl(i, s) / 2,
				u =
					typeof t.position == "object"
						? t.position.clientX
						: t.position === "cursor"
							? this.lastViewportPosition.x
							: this.state.width / 2 + this.state.offsetLeft,
				f =
					typeof t.position == "object"
						? t.position.clientY
						: t.position === "cursor"
							? this.lastViewportPosition.y
							: this.state.height / 2 + this.state.offsetTop,
				{ x: m, y: g } = Ot({ clientX: u, clientY: f }, this.state),
				h = m - c,
				y = g - d,
				[E, T] = Br(h, y, this.getEffectiveGridSize()),
				I = of(
					r.map((D) => Me(D, { x: D.x + E - o, y: D.y + T - i })),
					{ randomizeSeed: !t.retainSeed },
				),
				C = [...this.scene.getElementsIncludingDeleted(), ...I];
			Yo(C, Fe(I));
			let k = this.getTopLayerFrameAtSceneCoords({ x: m, y: g });
			if (k) {
				let D = QI(I, k);
				Mf(C, D, k);
			}
			this.scene.replaceAllElements(C),
				I.forEach((D) => {
					if (Ee(D) && co(D)) {
						let B = Gl(D, this.scene.getElementsMapIncludingDeleted());
						jt(D, B, this.scene.getElementsMapIncludingDeleted());
					}
				}),
				sT &&
					Bi.loadElementsFonts(I).then((D) => {
						this.fonts.onLoaded(D);
					}),
				t.files && this.addMissingFiles(t.files),
				this.store.shouldCaptureIncrement();
			let N = wc(I);
			this.setState(
				{
					...this.state,
					openSidebar:
						this.state.openSidebar &&
						this.device.editor.canFitSidebar &&
						zr.get(iu)
							? this.state.openSidebar
							: null,
					...Mr(
						{
							editingGroupId: null,
							selectedElementIds: N.reduce(
								(D, B) => (co(B) || (D[B.id] = !0), D),
								{},
							),
						},
						this.scene.getNonDeletedElements(),
						this.state,
						this,
					),
				},
				() => {
					t.files && this.addNewImagesToImageCache();
				},
			),
				this.setActiveTool({ type: "selection" }),
				t.fitToContent &&
					this.scrollToContent(I, {
						fitToContent: !0,
						canvasOffsets: this.getEditorUIOffsets(),
					});
		};
		async addElementsFromMixedContentPaste(
			t,
			{ isPlainPaste: r, sceneX: o, sceneY: i },
		) {
			if (
				!r &&
				t.some((a) => a.type === "imageUrl") &&
				this.isToolSupported("image")
			) {
				let a = t.filter((m) => m.type === "imageUrl").map((m) => m.value),
					s = await Promise.all(
						a.map(async (m) => {
							try {
								return { file: await kI(m) };
							} catch (g) {
								let h = g.message;
								return (
									g.cause === "FETCH_ERROR"
										? (h = v("errors.failedToFetchImage"))
										: g.cause === "UNSUPPORTED" &&
											(h = v("errors.unsupportedFileType")),
									{ errorMessage: h }
								);
							}
						}),
					),
					c = i,
					d = !1,
					u = {};
				for (let m of s)
					if (m.file) {
						let g = this.createImageElement({ sceneX: o, sceneY: c }),
							h = await this.insertImageElement(g, m.file);
						h &&
							(d || ((d = !0), (c -= h.height / 2)),
							me(h, { y: c }, !1),
							(c = g.y + g.height + 25),
							(u[g.id] = !0));
					}
				this.setState({ selectedElementIds: dt(u, this.state) });
				let f = s.find((m) => !!m.errorMessage);
				f && f.errorMessage && this.setState({ errorMessage: f.errorMessage });
			} else {
				let a = t.filter((s) => s.type === "text");
				a.length &&
					this.addTextFromPaste(
						a
							.map((s) => s.value)
							.join(`

`),
						r,
					);
			}
		}
		addTextFromPaste(t, r = !1) {
			let { x: o, y: i } = Ot(
					{
						clientX: this.lastViewportPosition.x,
						clientY: this.lastViewportPosition.y,
					},
					this.state,
				),
				a = {
					x: o,
					y: i,
					strokeColor: this.state.currentItemStrokeColor,
					backgroundColor: this.state.currentItemBackgroundColor,
					fillStyle: this.state.currentItemFillStyle,
					strokeWidth: this.state.currentItemStrokeWidth,
					strokeStyle: this.state.currentItemStrokeStyle,
					roundness: null,
					roughness: this.state.currentItemRoughness,
					opacity: this.state.currentItemOpacity,
					text: t,
					fontSize: this.state.currentItemFontSize,
					fontFamily: this.state.currentItemFontFamily,
					textAlign: bp,
					verticalAlign: Yx,
					locked: !1,
				},
				s = Lr({ fontSize: a.fontSize, fontFamily: a.fontFamily }),
				c = zi(a.fontFamily),
				[d, , u] = Jv(this.state),
				f = Math.max(Math.min((u - d) * 0.5, 800), 200),
				m = 10,
				g = i,
				h = r
					? [t]
					: t.split(`
`),
				y = h.reduce((E, T, I) => {
					let P = Ul(T).trim();
					if (P.length) {
						let C = this.getTopLayerFrameAtSceneCoords({ x: o, y: g }),
							k = Ko(P, s, c),
							N = k.width > f,
							D = N ? Js(P, s, f) : P;
						k = N ? Ko(D, s, c) : k;
						let B = o - k.width / 2,
							F = g - k.height / 2,
							W = Hn({
								...a,
								x: B,
								y: F,
								text: D,
								originalText: P,
								lineHeight: c,
								autoResize: !N,
								frameId: C ? C.id : null,
							});
						E.push(W), (g += W.height + m);
					} else h[I - 1]?.trim() && (g += g_(a.fontSize, c) + m);
					return E;
				}, []);
			y.length !== 0 &&
				(this.scene.insertElements(y),
				this.setState({
					selectedElementIds: dt(
						Object.fromEntries(y.map((E) => [E.id, !0])),
						this.state,
					),
				}),
				!r &&
					y.length > 1 &&
					QP === !1 &&
					!this.device.editor.isMobile &&
					(this.setToast({
						message: v("toast.pasteAsSingleElement", {
							shortcut: V("CtrlOrCmd+Shift+V"),
						}),
						duration: 5e3,
					}),
					(QP = !0)),
				this.store.shouldCaptureIncrement());
		}
		setAppState = (t, r) => {
			this.setState(t, r);
		};
		removePointer = (t) => {
			nl && this.resetContextMenuTimer(), st.pointers.delete(t.pointerId);
		};
		toggleLock = (t = "ui") => {
			this.state.activeTool.locked ||
				We(
					"toolbar",
					"toggleLock",
					`${t} (${this.device.editor.isMobile ? "mobile" : "desktop"})`,
				),
				this.setState((r) => ({
					activeTool: {
						...r.activeTool,
						...Yt(
							this.state,
							r.activeTool.locked ? { type: "selection" } : r.activeTool,
						),
						locked: !r.activeTool.locked,
					},
				}));
		};
		updateFrameRendering = (t) => {
			this.setState((r) => {
				let o = typeof t == "function" ? t(r.frameRendering) : t;
				return {
					frameRendering: {
						enabled: o?.enabled ?? r.frameRendering.enabled,
						clip: o?.clip ?? r.frameRendering.clip,
						name: o?.name ?? r.frameRendering.name,
						outline: o?.outline ?? r.frameRendering.outline,
					},
				};
			});
		};
		togglePenMode = (t) => {
			this.setState((r) => ({ penMode: t ?? !r.penMode, penDetected: !0 }));
		};
		onHandToolToggle = () => {
			this.actionManager.executeAction(P5);
		};
		zoomCanvas = (t) => {
			this.setState({
				...qi(
					{
						viewportX: this.state.width / 2 + this.state.offsetLeft,
						viewportY: this.state.height / 2 + this.state.offsetTop,
						nextZoom: li(t),
					},
					this.state,
				),
			});
		};
		cancelInProgressAnimation = null;
		scrollToContent = (t = this.scene.getNonDeletedElements(), r) => {
			if (typeof t == "string") {
				let c;
				if ((zl(t) ? (c = BI(t)) : (c = t), c)) {
					let d = this.scene.getElementsFromId(c);
					d?.length
						? this.scrollToContent(d, {
								fitToContent: r?.fitToContent ?? !0,
								animate: r?.animate ?? !0,
							})
						: zl(t) &&
							this.setState({
								toast: {
									message: v("elementLink.notFound"),
									duration: 3e3,
									closable: !0,
								},
							});
				}
				return;
			}
			this.cancelInProgressAnimation?.();
			let o = Array.isArray(t) ? t : [t],
				i = this.state.zoom,
				a = this.state.scrollX,
				s = this.state.scrollY;
			if (r?.fitToContent || r?.fitToViewport) {
				let { appState: c } = Fm({
					canvasOffsets: r.canvasOffsets,
					targetElements: o,
					appState: this.state,
					fitToViewport: !!r?.fitToViewport,
					viewportZoomFactor: r?.viewportZoomFactor,
					minZoom: r?.minZoom,
					maxZoom: r?.maxZoom,
				});
				(i = c.zoom), (a = c.scrollX), (s = c.scrollY);
			} else {
				let c = Kl(o, this.state);
				(a = c.scrollX), (s = c.scrollY);
			}
			if (r?.animate) {
				let c = this.state.scrollX,
					d = this.state.scrollY,
					u = this.state.zoom.value,
					f = $T({
						fromValues: { scrollX: c, scrollY: d, zoom: u },
						toValues: { scrollX: a, scrollY: s, zoom: i.value },
						interpolateValue: (m, g, h, y) => {
							if (y === "zoom") return m * Math.pow(g / m, Tl(h));
						},
						onStep: ({ scrollX: m, scrollY: g, zoom: h }) => {
							this.setState({ scrollX: m, scrollY: g, zoom: { value: h } });
						},
						onStart: () => {
							this.setState({ shouldCacheIgnoreZoom: !0 });
						},
						onEnd: () => {
							this.setState({ shouldCacheIgnoreZoom: !1 });
						},
						onCancel: () => {
							this.setState({ shouldCacheIgnoreZoom: !1 });
						},
						duration: r?.duration ?? 500,
					});
				this.cancelInProgressAnimation = () => {
					f(), (this.cancelInProgressAnimation = null);
				};
			} else this.setState({ scrollX: a, scrollY: s, zoom: i });
		};
		maybeUnfollowRemoteUser = () => {
			this.state.userToFollow && this.setState({ userToFollow: null });
		};
		translateCanvas = (t) => {
			this.cancelInProgressAnimation?.(),
				this.maybeUnfollowRemoteUser(),
				this.setState(t);
		};
		setToast = (t) => {
			this.setState({ toast: t });
		};
		restoreFileFromShare = async () => {
			try {
				let t = await caches.open("web-share-target"),
					r = await t.match("shared-file");
				if (r) {
					let o = await r.blob(),
						i = new File([o], o.name || "", { type: o.type });
					this.loadFileToCanvas(i, null),
						await t.delete("shared-file"),
						window.history.replaceState(null, Wd, window.location.pathname);
				}
			} catch (t) {
				this.setState({ errorMessage: t.message });
			}
		};
		addFiles = Wt((t) => {
			let { addedFiles: r } = this.addMissingFiles(t);
			this.clearImageShapeCache(r),
				this.scene.triggerUpdate(),
				this.addNewImagesToImageCache();
		});
		addMissingFiles = (t, r = !1) => {
			let o = r ? {} : { ...this.files },
				i = {},
				a = Array.isArray(t) ? t : Object.values(t);
			for (let s of a)
				if (!o[s.id] && ((i[s.id] = s), (o[s.id] = s), s.mimeType === vr.svg))
					try {
						let c = II(Kv(AI(s.dataURL)), vr.svg);
						s.dataURL !== c &&
							((s.version = (s.version ?? 1) + 1), (s.dataURL = c));
					} catch (c) {
						console.error(c);
					}
			return (this.files = o), { addedFiles: i };
		};
		updateScene = Wt((t) => {
			let r = Gi(t.elements ?? []);
			if (t.storeAction && t.storeAction !== H.NONE) {
				let o = this.store.snapshot.appState,
					i = this.store.snapshot.elements,
					a = t.appState ? Object.assign({}, o, t.appState) : o,
					s = t.elements
						? this.store.filterUncomittedElements(
								this.scene.getElementsMapIncludingDeleted(),
								Fe(r),
							)
						: i;
				t.storeAction === H.CAPTURE
					? this.store.captureIncrement(s, a)
					: t.storeAction === H.UPDATE && this.store.updateSnapshot(s, a);
			}
			t.appState && this.setState(t.appState),
				t.elements && this.scene.replaceAllElements(r),
				t.collaborators && this.setState({ collaborators: t.collaborators });
		});
		triggerRender = (t) => {
			t === !0 ? this.scene.triggerUpdate() : this.setState({});
		};
		toggleSidebar = ({ name: t, tab: r, force: o }) => {
			let i;
			o === void 0
				? (i =
						this.state.openSidebar?.name === t &&
						this.state.openSidebar?.tab === r
							? null
							: t)
				: (i = o ? t : null);
			let a = i ? { name: i } : null;
			return a && r && (a.tab = r), this.setState({ openSidebar: a }), !!i;
		};
		updateCurrentCursorPosition = Wt((t) => {
			(this.lastViewportPosition.x = t.clientX),
				(this.lastViewportPosition.y = t.clientY);
		});
		getEditorUIOffsets = () => {
			let t =
					this.excalidrawContainerRef?.current
						?.querySelector(".App-toolbar")
						?.getBoundingClientRect()?.bottom ?? 0,
				r = this.excalidrawContainerRef?.current
					?.querySelector(".sidebar")
					?.getBoundingClientRect(),
				o = this.excalidrawContainerRef?.current
					?.querySelector(".App-menu__left")
					?.getBoundingClientRect(),
				i = 16;
			return ci().rtl
				? {
						top: t + i,
						right:
							Math.max(this.state.width - (o?.left ?? this.state.width), 0) + i,
						bottom: i,
						left: Math.max(r?.right ?? 0, 0) + i,
					}
				: {
						top: t + i,
						right: Math.max(
							this.state.width - (r?.left ?? this.state.width) + i,
							0,
						),
						bottom: i,
						left: Math.max(o?.right ?? 0, 0) + i,
					};
		};
		onKeyDown = Wt((t) => {
			if (
				("Proxy" in window &&
					((!t.shiftKey && /^[A-Z]$/.test(t.key)) ||
						(t.shiftKey && /^[a-z]$/.test(t.key))) &&
					(t = new Proxy(t, {
						get(a, s) {
							let c = a[s];
							return typeof c == "function"
								? c.bind(a)
								: s === "key"
									? t.shiftKey
										? a.key.toUpperCase()
										: a.key.toLowerCase()
									: c;
						},
					})),
				!iv(t.target))
			) {
				if (
					(t.key === R.ESCAPE || t.key === R.ENTER) &&
					this.state.croppingElementId
				) {
					this.finishImageCropping();
					return;
				}
				let a = Le(this.scene.getNonDeletedElementsMap(), this.state);
				if (a.length === 1 && ct(a[0]) && t.key === R.ENTER) {
					this.startImageCropping(a[0]);
					return;
				}
				if (t.key === R.ESCAPE && this.flowChartCreator.isCreatingChart) {
					this.flowChartCreator.clear(), this.triggerRender(!0);
					return;
				}
				let s = Rl(t.key);
				if (t[R.CTRL_OR_CMD] && s && !t.shiftKey) {
					t.preventDefault();
					let c = Le(this.scene.getNonDeletedElementsMap(), this.state);
					c.length === 1 &&
						kl(c[0]) &&
						this.flowChartCreator.createNodes(
							c[0],
							this.scene.getNonDeletedElementsMap(),
							this.state,
							h0(t.key),
						),
						this.flowChartCreator.pendingNodes?.length &&
							!vc(
								this.flowChartCreator.pendingNodes,
								this.canvas.width / window.devicePixelRatio,
								this.canvas.height / window.devicePixelRatio,
								{
									offsetLeft: this.state.offsetLeft,
									offsetTop: this.state.offsetTop,
									scrollX: this.state.scrollX,
									scrollY: this.state.scrollY,
									zoom: this.state.zoom,
								},
								this.scene.getNonDeletedElementsMap(),
								this.getEditorUIOffsets(),
							) &&
							this.scrollToContent(this.flowChartCreator.pendingNodes, {
								animate: !0,
								duration: 300,
								fitToContent: !0,
								canvasOffsets: this.getEditorUIOffsets(),
							});
					return;
				}
				if (t.altKey) {
					let c = Le(this.scene.getNonDeletedElementsMap(), this.state);
					if (c.length === 1 && s) {
						t.preventDefault();
						let d = this.flowChartNavigator.exploreByDirection(
							c[0],
							this.scene.getNonDeletedElementsMap(),
							h0(t.key),
						);
						if (d) {
							this.setState((f) => ({
								selectedElementIds: dt({ [d]: !0 }, f),
							}));
							let u = this.scene.getNonDeletedElementsMap().get(d);
							u &&
								!vc(
									[u],
									this.canvas.width / window.devicePixelRatio,
									this.canvas.height / window.devicePixelRatio,
									{
										offsetLeft: this.state.offsetLeft,
										offsetTop: this.state.offsetTop,
										scrollX: this.state.scrollX,
										scrollY: this.state.scrollY,
										zoom: this.state.zoom,
									},
									this.scene.getNonDeletedElementsMap(),
									this.getEditorUIOffsets(),
								) &&
								this.scrollToContent(u, {
									animate: !0,
									duration: 300,
									canvasOffsets: this.getEditorUIOffsets(),
								});
						}
						return;
					}
				}
			}
			if (t[R.CTRL_OR_CMD] && t.key === R.P && !t.shiftKey && !t.altKey) {
				this.setToast({
					message: v("commandPalette.shortcutHint", {
						shortcut: tr("commandPalette"),
					}),
				}),
					t.preventDefault();
				return;
			}
			if (
				(t[R.CTRL_OR_CMD] &&
					t.key.toLowerCase() === R.V &&
					((ub = t.shiftKey),
					clearTimeout(jP),
					(jP = window.setTimeout(() => {
						ub = !1;
					}, 100))),
				t[R.CTRL_OR_CMD] &&
					ii(t.target) &&
					(t.code === Be.MINUS || t.code === Be.EQUAL))
			) {
				t.preventDefault();
				return;
			}
			if ((ii(t.target) && t.key !== R.ESCAPE) || (Rl(t.key) && iv(t.target)))
				return;
			if (t.key === R.QUESTION_MARK) {
				this.setState({ openDialog: { name: "help" } });
				return;
			} else if (
				t.key.toLowerCase() === R.E &&
				t.shiftKey &&
				t[R.CTRL_OR_CMD]
			) {
				t.preventDefault(),
					this.setState({ openDialog: { name: "imageExport" } });
				return;
			}
			if (t.key === R.PAGE_UP || t.key === R.PAGE_DOWN) {
				let a =
					(t.shiftKey ? this.state.width : this.state.height) /
					this.state.zoom.value;
				t.key === R.PAGE_DOWN && (a = -a),
					t.shiftKey
						? this.translateCanvas((s) => ({ scrollX: s.scrollX + a }))
						: this.translateCanvas((s) => ({ scrollY: s.scrollY + a }));
			}
			if (
				this.state.openDialog?.name === "elementLinkSelector" ||
				this.actionManager.handleKeyDown(t) ||
				this.state.viewModeEnabled
			)
				return;
			if (
				(t[R.CTRL_OR_CMD] &&
					this.state.isBindingEnabled &&
					this.setState({ isBindingEnabled: !1 }),
				Rl(t.key))
			) {
				let a = this.scene.getSelectedElements({
						selectedElementIds: this.state.selectedElementIds,
						includeBoundTextElement: !0,
						includeElementsInFrames: !0,
					}),
					s = a.find(qe),
					c = new Set();
				a
					.filter(qe)
					.filter((m) => {
						let g =
								m.startBinding &&
								!a.some((y) => y.id === m.startBinding?.elementId),
							h =
								m.endBinding &&
								!a.some((y) => y.id === m.endBinding?.elementId);
						return g || h;
					})
					.forEach((m) => c.add(m.id)),
					(a = a.filter((m) => !c.has(m.id)));
				let d =
						(this.getEffectiveGridSize() &&
							(t.shiftKey ? Wx : this.getEffectiveGridSize())) ||
						(t.shiftKey ? mT : Wx),
					u = 0,
					f = 0;
				t.key === R.ARROW_LEFT
					? (u = -d)
					: t.key === R.ARROW_RIGHT
						? (u = d)
						: t.key === R.ARROW_UP
							? (f = -d)
							: t.key === R.ARROW_DOWN && (f = d),
					a.forEach((m) => {
						me(m, { x: m.x + u, y: m.y + f }),
							_a(m, this.scene.getNonDeletedElementsMap(), {
								simultaneouslyUpdated: a,
								zoom: this.state.zoom,
							});
					}),
					this.setState({
						suggestedBindings: mf(
							a.filter((m) => m.id !== s?.id || d !== 0),
							this.scene.getNonDeletedElementsMap(),
							this.state.zoom,
						),
					}),
					t.preventDefault();
			} else if (t.key === R.ENTER) {
				let a = this.scene.getSelectedElements(this.state);
				if (a.length === 1) {
					let s = a[0];
					if (t[R.CTRL_OR_CMD])
						at(s) &&
							(!this.state.editingLinearElement ||
								this.state.editingLinearElement.elementId !== a[0].id) &&
							(this.store.shouldCaptureIncrement(),
							qe(s) || this.setState({ editingLinearElement: new De(s) }));
					else if (Ee(s) || S_(s)) {
						let c;
						Ee(s) || (c = s);
						let d = Ff(s, this.state, this.scene.getNonDeletedElementsMap()),
							u = d.x,
							f = d.y;
						this.startTextEditing({ sceneX: u, sceneY: f, container: c }),
							t.preventDefault();
						return;
					} else Ye(s) && this.setState({ editingFrame: s.id });
				}
			} else if (
				!t.ctrlKey &&
				!t.altKey &&
				!t.metaKey &&
				!this.state.newElement &&
				!this.state.selectionElement &&
				!this.state.selectedElementsAreBeingDragged
			) {
				let a = nI(t.key);
				a
					? (this.state.activeTool.type !== a &&
							We(
								"toolbar",
								a,
								`keyboard (${this.device.editor.isMobile ? "mobile" : "desktop"})`,
							),
						a === "arrow" &&
							this.state.activeTool.type === "arrow" &&
							this.setState((s) => ({
								currentItemArrowType:
									s.currentItemArrowType === Ar.sharp
										? Ar.round
										: s.currentItemArrowType === Ar.round
											? Ar.elbow
											: Ar.sharp,
							})),
						this.setActiveTool({ type: a }),
						t.stopPropagation())
					: t.key === R.Q && (this.toggleLock("keyboard"), t.stopPropagation());
			}
			if (
				(t.key === R.SPACE &&
					st.pointers.size === 0 &&
					((Ss = !0), ft(this.interactiveCanvas, pt.GRAB), t.preventDefault()),
				(t.key === R.G || t.key === R.S) && !t.altKey && !t[R.CTRL_OR_CMD])
			) {
				let a = this.scene.getSelectedElements(this.state);
				if (this.state.activeTool.type === "selection" && !a.length) return;
				t.key === R.G &&
					(La(this.state.activeTool.type) || a.some((s) => La(s.type))) &&
					(this.setState({ openPopup: "elementBackground" }),
					t.stopPropagation()),
					t.key === R.S &&
						(this.setState({ openPopup: "elementStroke" }),
						t.stopPropagation());
			}
			if (!t[R.CTRL_OR_CMD] && t.shiftKey && t.key.toLowerCase() === R.F) {
				let a = this.scene.getSelectedElements(this.state);
				if (this.state.activeTool.type === "selection" && !a.length) return;
				(this.state.activeTool.type === "text" ||
					a.find(
						(s) => Ee(s) || ot(s, this.scene.getNonDeletedElementsMap()),
					)) &&
					(t.preventDefault(), this.setState({ openPopup: "fontFamily" }));
			}
			if (t.key === R.K && !t.altKey && !t[R.CTRL_OR_CMD]) {
				this.state.activeTool.type === "laser"
					? this.setActiveTool({ type: "selection" })
					: this.setActiveTool({ type: "laser" });
				return;
			}
			t[R.CTRL_OR_CMD] &&
				(t.key === R.BACKSPACE || t.key === R.DELETE) &&
				zr.set(ms, "clearCanvas");
			let r = t.key.toLocaleLowerCase(),
				o = r === R.S && t.shiftKey,
				i = t.key === R.I || (r === R.G && t.shiftKey);
			(o || i) && this.openEyeDropper({ type: o ? "stroke" : "background" });
		});
		onKeyUp = Wt((t) => {
			if (
				(t.key === R.SPACE &&
					(this.state.viewModeEnabled ||
					this.state.openDialog?.name === "elementLinkSelector"
						? ft(this.interactiveCanvas, pt.GRAB)
						: this.state.activeTool.type === "selection"
							? mn(this.interactiveCanvas)
							: (zn(this.interactiveCanvas, this.state),
								this.setState({
									selectedElementIds: dt({}, this.state),
									selectedGroupIds: {},
									editingGroupId: null,
									activeEmbeddable: null,
								})),
					(Ss = !1)),
				!t[R.CTRL_OR_CMD] &&
					!this.state.isBindingEnabled &&
					this.setState({ isBindingEnabled: !0 }),
				Rl(t.key) &&
					(Ol(
						this.scene.getSelectedElements(this.state).filter(at),
						this.scene.getNonDeletedElementsMap(),
						this.scene.getNonDeletedElements(),
						this.scene,
						Nl(this.state),
						this.state.selectedLinearElement?.selectedPointsIndices ?? [],
						this.state.zoom,
					),
					this.setState({ suggestedBindings: [] })),
				t.altKey ||
					(this.flowChartNavigator.isExploring &&
						(this.flowChartNavigator.clear(),
						this.syncActionResult({ storeAction: H.CAPTURE }))),
				!t[R.CTRL_OR_CMD] && this.flowChartCreator.isCreatingChart)
			) {
				this.flowChartCreator.pendingNodes?.length &&
					this.scene.insertElements(this.flowChartCreator.pendingNodes);
				let r = this.flowChartCreator.pendingNodes?.[0];
				r &&
					(this.setState((o) => ({
						selectedElementIds: dt({ [r.id]: !0 }, o),
					})),
					vc(
						[r],
						this.canvas.width / window.devicePixelRatio,
						this.canvas.height / window.devicePixelRatio,
						{
							offsetLeft: this.state.offsetLeft,
							offsetTop: this.state.offsetTop,
							scrollX: this.state.scrollX,
							scrollY: this.state.scrollY,
							zoom: this.state.zoom,
						},
						this.scene.getNonDeletedElementsMap(),
						this.getEditorUIOffsets(),
					) ||
						this.scrollToContent(r, {
							animate: !0,
							duration: 300,
							canvasOffsets: this.getEditorUIOffsets(),
						})),
					this.flowChartCreator.clear(),
					this.syncActionResult({ storeAction: H.CAPTURE });
			}
		});
		isToolSupported = (t) => this.props.UIOptions.tools?.[t] !== !1;
		setActiveTool = (t) => {
			if (!this.isToolSupported(t.type)) {
				console.warn(
					`"${t.type}" tool is disabled via "UIOptions.canvasActions.tools.${t.type}"`,
				);
				return;
			}
			let r = Yt(this.state, t);
			r.type === "hand"
				? ft(this.interactiveCanvas, pt.GRAB)
				: Ss || zn(this.interactiveCanvas, this.state),
				BT(document.activeElement) && this.focusContainer(),
				JT(r.type) || this.setState({ suggestedBindings: [] }),
				r.type === "image" &&
					this.onImageAction({
						insertOnCanvasDirectly:
							(t.type === "image" && t.insertOnCanvasDirectly) ?? !1,
					}),
				this.setState((o) => {
					let i = {
						snapLines: o.snapLines.length ? [] : o.snapLines,
						originSnapOffset: null,
						activeEmbeddable: null,
					};
					return (
						r.type === "freedraw" && this.store.shouldCaptureIncrement(),
						r.type !== "selection"
							? {
									...o,
									activeTool: r,
									selectedElementIds: dt({}, o),
									selectedGroupIds: dt({}, o),
									editingGroupId: null,
									multiElement: null,
									...i,
								}
							: { ...o, activeTool: r, ...i }
					);
				});
		};
		setOpenDialog = (t) => {
			this.setState({ openDialog: t });
		};
		setCursor = (t) => {
			ft(this.interactiveCanvas, t);
		};
		resetCursor = () => {
			mn(this.interactiveCanvas);
		};
		isTouchScreenMultiTouchGesture = () => st.pointers.size >= 2;
		getName = () =>
			this.state.name || this.props.name || `${v("labels.untitled")}-${nv()}`;
		onGestureStart = Wt((t) => {
			t.preventDefault(),
				this.isTouchScreenMultiTouchGesture() &&
					this.setState({
						selectedElementIds: dt({}, this.state),
						activeEmbeddable: null,
					}),
				(st.initialScale = this.state.zoom.value);
		});
		onGestureChange = Wt((t) => {
			if ((t.preventDefault(), this.isTouchScreenMultiTouchGesture())) return;
			let r = st.initialScale;
			r &&
				this.setState((o) => ({
					...qi(
						{
							viewportX: this.lastViewportPosition.x,
							viewportY: this.lastViewportPosition.y,
							nextZoom: li(r * t.scale),
						},
						o,
					),
				}));
		});
		onGestureEnd = Wt((t) => {
			t.preventDefault(),
				this.isTouchScreenMultiTouchGesture() &&
					this.setState({
						previousSelectedElementIds: {},
						selectedElementIds: dt(
							this.state.previousSelectedElementIds,
							this.state,
						),
					}),
				(st.initialScale = null);
		});
		handleTextWysiwyg(t, { isExistingElement: r = !1 }) {
			let o = this.scene.getElementsMapIncludingDeleted(),
				i = (a, s) => {
					this.scene.replaceAllElements([
						...this.scene
							.getElementsIncludingDeleted()
							.map((c) =>
								c.id === t.id && Ee(c)
									? Me(c, {
											originalText: a,
											isDeleted: s ?? c.isDeleted,
											...j2(c, Gl(c, o), o, a),
										})
									: c,
							),
					]);
				};
			WP({
				id: t.id,
				canvas: this.canvas,
				getViewportCoords: (a, s) => {
					let { x: c, y: d } = lo({ sceneX: a, sceneY: s }, this.state);
					return [c - this.state.offsetLeft, d - this.state.offsetTop];
				},
				onChange: Wt((a) => {
					i(a, !1), uE(t) && _a(t, this.scene.getNonDeletedElementsMap());
				}),
				onSubmit: Wt(({ viaKeyboard: a, nextOriginalText: s }) => {
					let c = !s.trim();
					if ((i(s, c), !c && a)) {
						let d = t.containerId ? t.containerId : t.id;
						(0, il.flushSync)(() => {
							this.setState((u) => ({
								selectedElementIds: dt({ ...u.selectedElementIds, [d]: !0 }, u),
							}));
						});
					}
					c && pf(this.scene.getNonDeletedElements(), [t]),
						(!c || r) && this.store.shouldCaptureIncrement(),
						(0, il.flushSync)(() => {
							this.setState({ newElement: null, editingTextElement: null });
						}),
						this.state.activeTool.locked &&
							zn(this.interactiveCanvas, this.state),
						this.focusContainer();
				}),
				element: t,
				excalidrawContainer: this.excalidrawContainerRef.current,
				app: this,
				autoSelect: !this.device.isTouchScreen,
			}),
				this.deselectElements(),
				i(t.originalText, !1);
		}
		deselectElements() {
			this.setState({
				selectedElementIds: dt({}, this.state),
				selectedGroupIds: {},
				editingGroupId: null,
				activeEmbeddable: null,
			});
		}
		getTextElementAtPosition(t, r) {
			let o = this.getElementAtPosition(t, r, { includeBoundTextElement: !0 });
			return o && Ee(o) && !o.isDeleted ? o : null;
		}
		getElementAtPosition(t, r, o) {
			let i = this.getElementsAtPosition(
				t,
				r,
				o?.includeBoundTextElement,
				o?.includeLockedElements,
			);
			if (i.length > 1) {
				if (o?.preferSelected) {
					for (let s = i.length - 1; s > -1; s--)
						if (this.state.selectedElementIds[i[s].id]) return i[s];
				}
				let a = i[i.length - 1];
				return uc({
					x: t,
					y: r,
					element: a,
					shape: Dl(a, this.scene.getNonDeletedElementsMap()),
					threshold: this.getElementHitThreshold() / 2,
					frameNameBound: Ye(a) ? this.frameNameBoundsCache.get(a) : null,
				})
					? a
					: i[i.length - 2];
			}
			return i.length === 1 ? i[0] : null;
		}
		getElementsAtPosition(t, r, o = !1, i = !1) {
			let a = [],
				s = this.scene.getNonDeletedElementsMap();
			return (
				o && i
					? this.scene.getNonDeletedElements()
					: this.scene
							.getNonDeletedElements()
							.filter(
								(d) => (i || !d.locked) && (o || !(Ee(d) && d.containerId)),
							)
			)
				.filter((d) => this.hitElement(t, r, d))
				.filter((d) => {
					let u = Lf(d, s);
					return u &&
						this.state.frameRendering.enabled &&
						this.state.frameRendering.clip
						? Vv({ x: t, y: r }, u, s)
						: !0;
				})
				.filter((d) => (Al(d) ? (a.push(d), !1) : !0))
				.concat(a);
		}
		getElementHitThreshold() {
			return pT / this.state.zoom.value;
		}
		hitElement(t, r, o, i = !0) {
			if (i && this.state.selectedElementIds[o.id] && zf([o], this.state)) {
				let s = J2(
					o,
					this.scene.getNonDeletedElementsMap(),
					ct(o) ? 0 : this.getElementHitThreshold(),
				);
				if (eI(pe(t, r), s)) return !0;
			}
			return oI(t, r, iI(o, this.scene.getNonDeletedElementsMap()))
				? !0
				: uc({
						x: t,
						y: r,
						element: o,
						shape: Dl(o, this.scene.getNonDeletedElementsMap()),
						threshold: this.getElementHitThreshold(),
						frameNameBound: Ye(o) ? this.frameNameBoundsCache.get(o) : null,
					});
		}
		getTextBindableContainerAtPosition(t, r) {
			let o = this.scene.getNonDeletedElements(),
				i = this.scene.getSelectedElements(this.state);
			if (i.length === 1) return Oi(i[0], !1) ? i[0] : null;
			let a = null;
			for (let s = o.length - 1; s >= 0; --s) {
				if (o[s].isDeleted) continue;
				let [c, d, u, f] = mo(o[s], this.scene.getNonDeletedElementsMap());
				if (
					Lt(o[s]) &&
					uc({
						x: t,
						y: r,
						element: o[s],
						shape: Dl(o[s], this.scene.getNonDeletedElementsMap()),
						threshold: this.getElementHitThreshold(),
					})
				) {
					a = o[s];
					break;
				} else if (c < t && t < u && d < r && r < f) {
					a = o[s];
					break;
				}
			}
			return Oi(a, !1) ? a : null;
		}
		startTextEditing = ({
			sceneX: t,
			sceneY: r,
			insertAtParentCenter: o = !0,
			container: i,
			autoEdit: a = !0,
		}) => {
			let s = !1,
				c =
					o && this.getTextWysiwygSnappedToCenterPosition(t, r, this.state, i);
			i && c && (ot(i, this.scene.getNonDeletedElementsMap()) || (s = !0));
			let d = null,
				u = this.scene.getSelectedElements(this.state);
			u.length === 1
				? Ee(u[0])
					? (d = u[0])
					: i
						? (d = ot(u[0], this.scene.getNonDeletedElementsMap()))
						: (d = this.getTextElementAtPosition(t, r))
				: (d = this.getTextElementAtPosition(t, r));
			let f = d?.fontFamily || this.state.currentItemFontFamily,
				m = d?.lineHeight || zi(f),
				g = this.state.currentItemFontSize;
			if (!d && s && i && !Lt(i)) {
				let T = x_(Lr({ fontSize: g, fontFamily: f }), m),
					I = h_(g, m),
					P = Math.max(i.height, I),
					C = Math.max(i.width, T);
				me(i, { height: P, width: C }),
					(t = i.x + C / 2),
					(r = i.y + P / 2),
					c &&
						(c = this.getTextWysiwygSnappedToCenterPosition(
							t,
							r,
							this.state,
							i,
						));
			}
			let h = this.getTopLayerFrameAtSceneCoords({ x: t, y: r }),
				y =
					d ||
					Hn({
						x: c ? c.elementCenterX : t,
						y: c ? c.elementCenterY : r,
						strokeColor: this.state.currentItemStrokeColor,
						backgroundColor: this.state.currentItemBackgroundColor,
						fillStyle: this.state.currentItemFillStyle,
						strokeWidth: this.state.currentItemStrokeWidth,
						strokeStyle: this.state.currentItemStrokeStyle,
						roughness: this.state.currentItemRoughness,
						opacity: this.state.currentItemOpacity,
						text: "",
						fontSize: g,
						fontFamily: f,
						textAlign: c ? "center" : this.state.currentItemTextAlign,
						verticalAlign: c ? sn.MIDDLE : Yx,
						containerId: s ? i?.id : void 0,
						groupIds: i?.groupIds ?? [],
						lineHeight: m,
						angle: i?.angle ?? 0,
						frameId: h ? h.id : null,
					});
			if (
				(!d &&
					s &&
					i &&
					me(i, {
						boundElements: (i.boundElements || []).concat({
							type: "text",
							id: y.id,
						}),
					}),
				this.setState({ editingTextElement: y }),
				!d)
			)
				if (i && s) {
					let E = this.scene.getElementIndex(i.id);
					this.scene.insertElementAtIndex(y, E + 1);
				} else this.scene.insertElement(y);
			a || d || i
				? this.handleTextWysiwyg(y, { isExistingElement: !!d })
				: this.setState({ newElement: y, multiElement: null });
		};
		startImageCropping = (t) => {
			this.store.shouldCaptureIncrement(),
				this.setState({ croppingElementId: t.id });
		};
		finishImageCropping = () => {
			this.state.croppingElementId &&
				(this.store.shouldCaptureIncrement(),
				this.setState({ croppingElementId: null }));
		};
		handleCanvasDoubleClick = (t) => {
			if (this.state.multiElement || this.state.activeTool.type !== "selection")
				return;
			let r = this.scene.getSelectedElements(this.state);
			if (
				r.length === 1 &&
				at(r[0]) &&
				t[R.CTRL_OR_CMD] &&
				(!this.state.editingLinearElement ||
					this.state.editingLinearElement.elementId !== r[0].id) &&
				!qe(r[0])
			) {
				this.store.shouldCaptureIncrement(),
					this.setState({ editingLinearElement: new De(r[0]) });
				return;
			}
			if (r.length === 1 && ct(r[0])) {
				this.startImageCropping(r[0]);
				return;
			}
			mn(this.interactiveCanvas);
			let { x: o, y: i } = Ot(t, this.state);
			if (Fn(this.state).length > 0) {
				let s = this.getElementAtPosition(o, i),
					c = s && cC(s, this.state.selectedGroupIds);
				if (c) {
					this.store.shouldCaptureIncrement(),
						this.setState((d) => ({
							...d,
							...Mr(
								{ editingGroupId: c, selectedElementIds: { [s.id]: !0 } },
								this.scene.getNonDeletedElements(),
								d,
								this,
							),
						}));
					return;
				}
			}
			if (
				(mn(this.interactiveCanvas),
				!t[R.CTRL_OR_CMD] && !this.state.viewModeEnabled)
			) {
				let s = this.getElementAtPosition(o, i);
				if (qs(s)) {
					this.setState({ activeEmbeddable: { element: s, state: "active" } });
					return;
				}
				let c = this.getTextBindableContainerAtPosition(o, i);
				if (
					c &&
					(Ao(c) ||
						!Il(c.backgroundColor) ||
						uc({
							x: o,
							y: i,
							element: c,
							shape: Dl(c, this.scene.getNonDeletedElementsMap()),
							threshold: this.getElementHitThreshold(),
						}))
				) {
					let d = Ff(c, this.state, this.scene.getNonDeletedElementsMap());
					(o = d.x), (i = d.y);
				}
				this.startTextEditing({
					sceneX: o,
					sceneY: i,
					insertAtParentCenter: !t.altKey,
					container: c,
				});
			}
		};
		getElementLinkAtPosition = (t, r) => {
			let o = this.scene.getNonDeletedElements(),
				i = -1;
			for (let a = o.length - 1; a >= 0; a--) {
				let s = o[a];
				if (
					(r && s.id === r.id && (i = a),
					s.link &&
						a >= i &&
						Ef(
							s,
							this.scene.getNonDeletedElementsMap(),
							this.state,
							pe(t.x, t.y),
							this.device.editor.isMobile,
						))
				)
					return s;
			}
		};
		redirectToLink = (t, r) => {
			let o = va(
				pe(
					this.lastPointerDownEvent.clientX,
					this.lastPointerDownEvent.clientY,
				),
				pe(this.lastPointerUpEvent.clientX, this.lastPointerUpEvent.clientY),
			);
			if (!this.hitLinkElement || o > El) return;
			let i = Ot(this.lastPointerDownEvent, this.state),
				a = this.scene.getNonDeletedElementsMap(),
				s = Ef(
					this.hitLinkElement,
					a,
					this.state,
					pe(i.x, i.y),
					this.device.editor.isMobile,
				),
				c = Ot(this.lastPointerUpEvent, this.state),
				d = Ef(
					this.hitLinkElement,
					a,
					this.state,
					pe(c.x, c.y),
					this.device.editor.isMobile,
				);
			if (s && d) {
				By();
				let u = this.hitLinkElement.link;
				if (u) {
					u = Bn(u);
					let f;
					if (
						(this.props.onLinkOpen &&
							((f = Lp("excalidraw-link", t.nativeEvent)),
							this.props.onLinkOpen({ ...this.hitLinkElement, link: u }, f)),
						!f?.defaultPrevented)
					) {
						let m = Np(u) ? "_self" : "_blank",
							g = window.open(void 0, m);
						g && ((g.opener = null), (g.location = u));
					}
				}
			}
		};
		getTopLayerFrameAtSceneCoords = (t) => {
			let r = this.scene.getNonDeletedElementsMap(),
				o = this.scene.getNonDeletedFramesLikes().filter((i) => Vv(t, i, r));
			return o.length ? o[o.length - 1] : null;
		};
		handleCanvasPointerMove = (t) => {
			this.savePointer(t.clientX, t.clientY, this.state.cursorButton),
				(this.lastPointerMoveEvent = t.nativeEvent),
				st.pointers.has(t.pointerId) &&
					st.pointers.set(t.pointerId, { x: t.clientX, y: t.clientY });
			let r = st.initialScale;
			if (st.pointers.size === 2 && st.lastCenter && r && st.initialDistance) {
				let g = m0(st.pointers),
					h = g.x - st.lastCenter.x,
					y = g.y - st.lastCenter.y;
				st.lastCenter = g;
				let E = u0(Array.from(st.pointers.values())),
					T =
						this.state.activeTool.type === "freedraw" && this.state.penMode
							? 1
							: E / st.initialDistance,
					I = T ? li(r * T) : this.state.zoom.value;
				this.setState((P) => {
					let C = qi({ viewportX: g.x, viewportY: g.y, nextZoom: I }, P);
					this.translateCanvas({
						zoom: C.zoom,
						scrollX: C.scrollX + 2 * (h / I),
						scrollY: C.scrollY + 2 * (y / I),
						shouldCacheIgnoreZoom: !0,
					});
				}),
					this.resetShouldCacheIgnoreZoomDebounced();
			} else st.lastCenter = st.initialDistance = st.initialScale = null;
			if (Ss || vu || lw || Fi(this.state)) return;
			let i = x0(
				sw,
				t.clientX - this.state.offsetLeft,
				t.clientY - this.state.offsetTop,
			).isOverEither;
			!this.state.newElement &&
				!this.state.selectionElement &&
				!this.state.selectedElementsAreBeingDragged &&
				!this.state.multiElement &&
				(i
					? mn(this.interactiveCanvas)
					: zn(this.interactiveCanvas, this.state));
			let a = Ot(t, this.state),
				{ x: s, y: c } = a;
			if (!this.state.newElement && d_(this.state.activeTool.type)) {
				let { originOffset: g, snapLines: h } = c_(
					this.scene.getNonDeletedElements(),
					this,
					{ x: s, y: c },
					t,
					this.scene.getNonDeletedElementsMap(),
				);
				this.setState((y) => {
					let E = Xs(y.snapLines, h),
						T = y.originSnapOffset ? Xs(y.originSnapOffset, g) : g;
					return y.snapLines === E && y.originSnapOffset === T
						? null
						: { snapLines: E, originSnapOffset: T };
				});
			} else
				!this.state.newElement &&
					!this.state.selectedElementsAreBeingDragged &&
					!this.state.selectionElement &&
					this.setState((g) => (g.snapLines.length ? { snapLines: [] } : null));
			if (
				this.state.editingLinearElement &&
				!this.state.editingLinearElement.isDragging
			) {
				let g = De.handlePointerMove(
					t,
					s,
					c,
					this,
					this.scene.getNonDeletedElementsMap(),
				);
				g &&
					g !== this.state.editingLinearElement &&
					(0, il.flushSync)(() => {
						this.setState({ editingLinearElement: g });
					}),
					g?.lastUncommittedPoint != null
						? this.maybeSuggestBindingAtCursor(a)
						: (0, il.flushSync)(() => {
								this.setState({ suggestedBindings: [] });
							});
			}
			if (eC(this.state.activeTool.type)) {
				let { newElement: g } = this.state;
				Ni(g, !1)
					? this.maybeSuggestBindingsForLinearElementAtCoords(
							g,
							[a],
							this.state.startBoundElement,
						)
					: this.maybeSuggestBindingAtCursor(a);
			}
			if (this.state.multiElement) {
				let { multiElement: g } = this.state,
					{ x: h, y } = g,
					{ points: E, lastCommittedPoint: T } = g,
					I = E[E.length - 1];
				if ((zn(this.interactiveCanvas, this.state), I === T))
					va(pe(s - h, c - y), I) >= hp
						? me(g, { points: [...E, pe(s - h, c - y)] }, !1)
						: ft(this.interactiveCanvas, pt.POINTER);
				else if (E.length > 2 && T && va(pe(s - h, c - y), T) < hp)
					ft(this.interactiveCanvas, pt.POINTER),
						me(g, { points: E.slice(0, -1) }, !1);
				else {
					let [P, C] = Br(
							s,
							c,
							t[R.CTRL_OR_CMD] || qe(g) ? null : this.getEffectiveGridSize(),
						),
						[k, N] = g?.lastCommittedPoint ?? [0, 0],
						D = P - h - k,
						B = C - y - N;
					lf(t) && ({ width: D, height: B } = iE(k + h, N + y, P, C)),
						lm(E, this.state.zoom.value) &&
							ft(this.interactiveCanvas, pt.POINTER),
						qe(g)
							? Ui(
									g,
									this.scene.getNonDeletedElementsMap(),
									[...E.slice(0, -1), pe(k + D, N + B)],
									void 0,
									void 0,
									{ isDragging: !0, informMutation: !1, zoom: this.state.zoom },
								)
							: me(g, { points: [...E.slice(0, -1), pe(k + D, N + B)] }, !1),
						this.triggerRender(!1);
				}
				return;
			}
			if (
				!!t.buttons ||
				(this.state.activeTool.type !== "selection" &&
					this.state.activeTool.type !== "text" &&
					this.state.activeTool.type !== "eraser")
			)
				return;
			let u = this.scene.getNonDeletedElements(),
				f = this.scene.getSelectedElements(this.state);
			if (f.length === 1 && !i && !this.state.editingLinearElement) {
				if (
					(this.state.selectedLinearElement &&
						this.handleHoverSelectedLinearElement(
							this.state.selectedLinearElement,
							s,
							c,
						),
					(!this.state.selectedLinearElement ||
						this.state.selectedLinearElement.hoverPointIndex === -1) &&
						this.state.openDialog?.name !== "elementLinkSelector" &&
						!(f.length === 1 && qe(f[0])))
				) {
					let g = aE(
						u,
						this.state,
						s,
						c,
						this.state.zoom,
						t.pointerType,
						this.scene.getNonDeletedElementsMap(),
						this.device,
					);
					if (g && g.transformHandleType) {
						ft(this.interactiveCanvas, sE(g));
						return;
					}
				}
			} else if (
				f.length > 1 &&
				!i &&
				this.state.openDialog?.name !== "elementLinkSelector"
			) {
				let g = lE(yt(f), s, c, this.state.zoom, t.pointerType, this.device);
				if (g) {
					ft(this.interactiveCanvas, sE({ transformHandleType: g }));
					return;
				}
			}
			let m = this.getElementAtPosition(a.x, a.y);
			(this.hitLinkElement = this.getElementLinkAtPosition(a, m)),
				!dn(this.state) &&
					(this.hitLinkElement &&
					!this.state.selectedElementIds[this.hitLinkElement.id]
						? (ft(this.interactiveCanvas, pt.POINTER),
							t3(
								this.hitLinkElement,
								this.state,
								this.scene.getNonDeletedElementsMap(),
							))
						: (By(),
							m &&
							(m.link || so(m)) &&
							this.state.selectedElementIds[m.id] &&
							!this.state.contextMenu &&
							!this.state.showHyperlinkPopup
								? this.setState({ showHyperlinkPopup: "info" })
								: this.state.activeTool.type === "text"
									? ft(this.interactiveCanvas, Ee(m) ? pt.TEXT : pt.CROSSHAIR)
									: this.state.viewModeEnabled
										? ft(this.interactiveCanvas, pt.GRAB)
										: this.state.openDialog?.name === "elementLinkSelector"
											? ft(this.interactiveCanvas, pt.AUTO)
											: i
												? ft(this.interactiveCanvas, pt.AUTO)
												: this.state.selectedLinearElement
													? this.handleHoverSelectedLinearElement(
															this.state.selectedLinearElement,
															s,
															c,
														)
													: t[R.CTRL_OR_CMD]
														? ft(this.interactiveCanvas, pt.AUTO)
														: (m ||
																this.isHittingCommonBoundingBoxOfSelectedElements(
																	a,
																	f,
																)) &&
															!m?.locked &&
															(m &&
															qs(m) &&
															this.isIframeLikeElementCenter(m, t, s, c)
																? (ft(this.interactiveCanvas, pt.POINTER),
																	this.setState({
																		activeEmbeddable: {
																			element: m,
																			state: "hover",
																		},
																	}))
																: (ft(this.interactiveCanvas, pt.MOVE),
																	this.state.activeEmbeddable?.state ===
																		"hover" &&
																		this.setState({
																			activeEmbeddable: null,
																		})))),
					this.state.openDialog?.name === "elementLinkSelector" && m
						? this.setState((g) => ({
								hoveredElementIds: Xs(
									g.hoveredElementIds,
									Mr(
										{
											editingGroupId: g.editingGroupId,
											selectedElementIds: { [m.id]: !0 },
										},
										this.scene.getNonDeletedElements(),
										g,
										this,
									).selectedElementIds,
								),
							}))
						: this.state.openDialog?.name === "elementLinkSelector" &&
							!m &&
							this.setState((g) => ({
								hoveredElementIds: Xs(g.hoveredElementIds, {}),
							})));
		};
		handleEraser = (t, r, o) => {
			this.eraserTrail.addPointToPath(o.x, o.y);
			let i = !1,
				a = new Set(),
				s = this.scene.getNonDeletedElements(),
				c = (g) => {
					for (let h of g) {
						if (h.locked) return;
						if (
							(t.altKey
								? this.elementsPendingErasure.delete(h.id) && (i = !0)
								: this.elementsPendingErasure.has(h.id) ||
									((i = !0), this.elementsPendingErasure.add(h.id)),
							i && h.groupIds?.length)
						) {
							let y = h.groupIds.at(-1);
							if (!a.has(y)) {
								a.add(y);
								let E = Vt(s, y);
								for (let T of E)
									t.altKey
										? this.elementsPendingErasure.delete(T.id)
										: this.elementsPendingErasure.add(T.id);
							}
						}
					}
				},
				d = va(pe(r.lastCoords.x, r.lastCoords.y), pe(o.x, o.y)),
				u = this.getElementHitThreshold(),
				f = { ...r.lastCoords },
				m = 0;
			for (; m <= d; ) {
				let g = this.getElementsAtPosition(f.x, f.y);
				if ((c(g), m === d)) break;
				m = Math.min(m + u, d);
				let h = m / d,
					y = (1 - h) * f.x + h * o.x,
					E = (1 - h) * f.y + h * o.y;
				(f.x = y), (f.y = E);
			}
			if (((r.lastCoords.x = o.x), (r.lastCoords.y = o.y), i)) {
				for (let g of this.scene.getNonDeletedElements())
					co(g) &&
						(this.elementsPendingErasure.has(g.id) ||
							this.elementsPendingErasure.has(g.containerId)) &&
						(t.altKey
							? (this.elementsPendingErasure.delete(g.id),
								this.elementsPendingErasure.delete(g.containerId))
							: (this.elementsPendingErasure.add(g.id),
								this.elementsPendingErasure.add(g.containerId)));
				(this.elementsPendingErasure = new Set(this.elementsPendingErasure)),
					this.triggerRender();
			}
		};
		handleTouchMove = (t) => {
			Eu = !0;
		};
		handleHoverSelectedLinearElement(t, r, o) {
			let i = this.scene.getNonDeletedElementsMap(),
				a = De.getElement(t.elementId, i);
			if (a)
				if (this.state.selectedLinearElement) {
					let s = -1,
						c = null;
					uc({
						x: r,
						y: o,
						element: a,
						shape: Dl(a, this.scene.getNonDeletedElementsMap()),
					})
						? ((s = De.getPointIndexUnderCursor(a, i, this.state.zoom, r, o)),
							(c = De.getSegmentMidpointHitCoords(
								t,
								{ x: r, y: o },
								this.state,
								this.scene.getNonDeletedElementsMap(),
							)),
							s >= 0 || c
								? ft(this.interactiveCanvas, pt.POINTER)
								: this.hitElement(r, o, a) &&
									ft(this.interactiveCanvas, pt.MOVE))
						: this.hitElement(r, o, a) &&
							(!qe(a) || !(a.startBinding || a.endBinding)) &&
							ft(this.interactiveCanvas, pt.MOVE),
						this.state.selectedLinearElement.hoverPointIndex !== s &&
							this.setState({
								selectedLinearElement: {
									...this.state.selectedLinearElement,
									hoverPointIndex: s,
								},
							}),
						De.arePointsEqual(
							this.state.selectedLinearElement.segmentMidPointHoveredCoords,
							c,
						) ||
							this.setState({
								selectedLinearElement: {
									...this.state.selectedLinearElement,
									segmentMidPointHoveredCoords: c,
								},
							});
				} else ft(this.interactiveCanvas, pt.AUTO);
		}
		handleCanvasPointerDown = (t) => {
			if (
				(this.maybeCleanupAfterMissingPointerUp(t.nativeEvent),
				this.maybeUnfollowRemoteUser(),
				this.state.searchMatches &&
					(this.setState((u) => ({
						searchMatches: u.searchMatches.map((f) => ({ ...f, focus: !1 })),
					})),
					zr.set(z0, null)),
				this.state.contextMenu && this.setState({ contextMenu: null }),
				this.state.snapLines && this.setAppState({ snapLines: [] }),
				this.updateGestureOnPointerDown(t),
				t.pointerType === "touch" &&
					this.state.newElement &&
					this.state.newElement.type === "freedraw")
			) {
				let u = this.state.newElement;
				this.updateScene({
					...(u.points.length < 10
						? {
								elements: this.scene
									.getElementsIncludingDeleted()
									.filter((f) => f.id !== u.id),
							}
						: {}),
					appState: {
						newElement: null,
						editingTextElement: null,
						startBoundElement: null,
						suggestedBindings: [],
						selectedElementIds: dt(
							Object.keys(this.state.selectedElementIds)
								.filter((f) => f !== u.id)
								.reduce(
									(f, m) => ((f[m] = this.state.selectedElementIds[m]), f),
									{},
								),
							this.state,
						),
					},
					storeAction:
						this.state.openDialog?.name === "elementLinkSelector"
							? H.NONE
							: H.UPDATE,
				});
				return;
			}
			let r = document.getSelection();
			if (
				(r?.anchorNode && r.removeAllRanges(),
				this.maybeOpenContextMenuAfterPointerDownOnTouchDevices(t),
				!this.state.penDetected &&
					t.pointerType === "pen" &&
					this.setState((u) => ({ penMode: !0, penDetected: !0 })),
				!this.device.isTouchScreen &&
					["pen", "touch"].includes(t.pointerType) &&
					(this.device = Ys(this.device, { isTouchScreen: !0 })),
				vu ||
					((this.lastPointerDownEvent = t),
					this.handleCanvasPanUsingWheelOrSpaceDrag(t)))
			)
				return;
			if (
				(this.setState({
					lastPointerDownWith: t.pointerType,
					cursorButton: "down",
				}),
				this.savePointer(t.clientX, t.clientY, "down"),
				t.button === ni.ERASER && this.state.activeTool.type !== Co.eraser)
			) {
				this.setState(
					{
						activeTool: Yt(this.state, {
							type: Co.eraser,
							lastActiveToolBeforeEraser: this.state.activeTool,
						}),
					},
					() => {
						this.handleCanvasPointerDown(t);
						let u = () => {
								f(),
									m?.(),
									dn(this.state) &&
										this.setState({
											activeTool: Yt(this.state, {
												...(this.state.activeTool.lastActiveTool || {
													type: Co.selection,
												}),
												lastActiveToolBeforeEraser: null,
											}),
										});
							},
							f = kt(window, "pointerup", u, { once: !0 }),
							m;
						requestAnimationFrame(() => {
							m = this.missingPointerEventCleanupEmitter.once(u);
						});
					},
				);
				return;
			}
			if (
				(t.button !== ni.MAIN &&
					t.button !== ni.TOUCH &&
					t.button !== ni.ERASER) ||
				st.pointers.size > 1
			)
				return;
			let o = this.initialPointerDownState(t);
			if (
				(this.setState({ selectedElementsAreBeingDragged: !1 }),
				this.handleDraggingScrollBar(t, o) ||
					(this.clearSelectionIfNotUsingSelection(),
					this.updateBindingEnabledOnPointerMove(t),
					this.handleSelectionOnPointerDown(t, o)) ||
					!(
						!this.state.penMode ||
						t.pointerType !== "touch" ||
						this.state.activeTool.type === "selection" ||
						this.state.activeTool.type === "text" ||
						this.state.activeTool.type === "image"
					))
			)
				return;
			if (this.state.activeTool.type === "text")
				this.handleTextOnPointerDown(t, o);
			else if (
				this.state.activeTool.type === "arrow" ||
				this.state.activeTool.type === "line"
			)
				this.handleLinearElementOnPointerDown(t, this.state.activeTool.type, o);
			else if (this.state.activeTool.type === "image") {
				ft(this.interactiveCanvas, pt.CROSSHAIR);
				let u =
					this.state.pendingImageElementId &&
					this.scene.getElement(this.state.pendingImageElementId);
				if (!u) return;
				this.setState({
					newElement: u,
					pendingImageElementId: null,
					multiElement: null,
				});
				let { x: f, y: m } = Ot(t, this.state),
					g = this.getTopLayerFrameAtSceneCoords({ x: f, y: m });
				me(u, { x: f, y: m, frameId: g ? g.id : null });
			} else
				this.state.activeTool.type === "freedraw"
					? this.handleFreeDrawElementOnPointerDown(
							t,
							this.state.activeTool.type,
							o,
						)
					: this.state.activeTool.type === "custom"
						? zn(this.interactiveCanvas, this.state)
						: this.state.activeTool.type === Co.frame ||
								this.state.activeTool.type === Co.magicframe
							? this.createFrameElementOnPointerDown(
									o,
									this.state.activeTool.type,
								)
							: this.state.activeTool.type === "laser"
								? this.laserTrails.startPath(o.lastCoords.x, o.lastCoords.y)
								: this.state.activeTool.type !== "eraser" &&
									this.state.activeTool.type !== "hand" &&
									this.createGenericElementOnPointerDown(
										this.state.activeTool.type,
										o,
									);
			this.props?.onPointerDown?.(this.state.activeTool, o),
				this.onPointerDownEmitter.trigger(this.state.activeTool, o, t),
				this.state.activeTool.type === "eraser" &&
					this.eraserTrail.startPath(o.lastCoords.x, o.lastCoords.y);
			let a = this.onPointerMoveFromPointerDownHandler(o),
				s = this.onPointerUpFromPointerDownHandler(o),
				c = this.onKeyDownFromPointerDownHandler(o),
				d = this.onKeyUpFromPointerDownHandler(o);
			this.missingPointerEventCleanupEmitter.once((u) => s(u || t.nativeEvent)),
				(!this.state.viewModeEnabled ||
					this.state.activeTool.type === "laser") &&
					(window.addEventListener("pointermove", a),
					window.addEventListener("pointerup", s),
					window.addEventListener("keydown", c),
					window.addEventListener("keyup", d),
					(o.eventListeners.onMove = a),
					(o.eventListeners.onUp = s),
					(o.eventListeners.onKeyUp = d),
					(o.eventListeners.onKeyDown = c));
		};
		handleCanvasPointerUp = (t) => {
			this.removePointer(t), (this.lastPointerUpEvent = t);
			let r = Ot({ clientX: t.clientX, clientY: t.clientY }, this.state),
				o = t.timeStamp - (this.lastPointerDownEvent?.timeStamp ?? 0);
			if (this.device.editor.isMobile && o < 300) {
				let i = this.getElementAtPosition(r.x, r.y);
				if (qs(i) && this.isIframeLikeElementCenter(i, t, r.x, r.y)) {
					this.handleEmbeddableCenterClick(i);
					return;
				}
			}
			if (this.device.isTouchScreen) {
				let i = this.getElementAtPosition(r.x, r.y);
				this.hitLinkElement = this.getElementLinkAtPosition(r, i);
			}
			this.hitLinkElement &&
			!this.state.selectedElementIds[this.hitLinkElement.id]
				? o < 300 &&
					qs(this.hitLinkElement) &&
					!FI(
						this.hitLinkElement,
						this.scene.getNonDeletedElementsMap(),
						this.state,
						pe(r.x, r.y),
					)
					? this.handleEmbeddableCenterClick(this.hitLinkElement)
					: this.redirectToLink(t, this.device.isTouchScreen)
				: this.state.viewModeEnabled &&
					this.setState({ activeEmbeddable: null, selectedElementIds: {} });
		};
		maybeOpenContextMenuAfterPointerDownOnTouchDevices = (t) => {
			t.pointerType === "touch" &&
				((Eu = !1),
				nl
					? (Eu = !0)
					: (nl = window.setTimeout(() => {
							(nl = 0), Eu || this.handleCanvasContextMenu(t);
						}, yT)));
		};
		resetContextMenuTimer = () => {
			clearTimeout(nl), (nl = 0), (Eu = !1);
		};
		maybeCleanupAfterMissingPointerUp = (t) => {
			yu?.(), this.missingPointerEventCleanupEmitter.trigger(t).clear();
		};
		handleCanvasPanUsingWheelOrSpaceDrag = (t) => {
			if (
				!(
					st.pointers.size <= 1 &&
					(t.button === ni.WHEEL ||
						(t.button === ni.MAIN && Ss) ||
						Fi(this.state) ||
						this.state.viewModeEnabled)
				)
			)
				return !1;
			(vu = !0),
				this.focusContainer(),
				this.state.editingTextElement || t.preventDefault();
			let r = !1,
				o =
					typeof window === void 0
						? !1
						: /Linux/.test(window.navigator.platform);
			ft(this.interactiveCanvas, pt.GRABBING);
			let { clientX: i, clientY: a } = t,
				s = nb((d) => {
					let u = i - d.clientX,
						f = a - d.clientY;
					if (
						((i = d.clientX),
						(a = d.clientY),
						o && !r && (Math.abs(u) > 1 || Math.abs(f) > 1))
					) {
						r = !0;
						let m = (h) => {
								document.body.removeEventListener("paste", m),
									h.stopPropagation();
							},
							g = () => {
								setTimeout(() => {
									document.body.removeEventListener("paste", m),
										window.removeEventListener("pointerup", g);
								}, 100);
							};
						document.body.addEventListener("paste", m),
							window.addEventListener("pointerup", g);
					}
					this.translateCanvas({
						scrollX: this.state.scrollX - u / this.state.zoom.value,
						scrollY: this.state.scrollY - f / this.state.zoom.value,
					});
				}),
				c = Wt(
					(yu = () => {
						(yu = null),
							(vu = !1),
							Ss ||
								(this.state.viewModeEnabled
									? ft(this.interactiveCanvas, pt.GRAB)
									: zn(this.interactiveCanvas, this.state)),
							this.setState({ cursorButton: "up" }),
							this.savePointer(t.clientX, t.clientY, "up"),
							window.removeEventListener("pointermove", s),
							window.removeEventListener("pointerup", c),
							window.removeEventListener("blur", c),
							s.flush();
					}),
				);
			return (
				window.addEventListener("blur", c),
				window.addEventListener("pointermove", s, { passive: !0 }),
				window.addEventListener("pointerup", c),
				!0
			);
		};
		updateGestureOnPointerDown(t) {
			st.pointers.set(t.pointerId, { x: t.clientX, y: t.clientY }),
				st.pointers.size === 2 &&
					((st.lastCenter = m0(st.pointers)),
					(st.initialScale = this.state.zoom.value),
					(st.initialDistance = u0(Array.from(st.pointers.values()))));
		}
		initialPointerDownState(t) {
			let r = Ot(t, this.state),
				o = this.scene.getSelectedElements(this.state),
				[i, a, s, c] = yt(o),
				d = o.findIndex(qe) === 0;
			return {
				origin: r,
				withCmdOrCtrl: t[R.CTRL_OR_CMD],
				originInGrid: ya(
					Br(
						r.x,
						r.y,
						t[R.CTRL_OR_CMD] || d ? null : this.getEffectiveGridSize(),
					),
				),
				scrollbars: x0(
					sw,
					t.clientX - this.state.offsetLeft,
					t.clientY - this.state.offsetTop,
				),
				lastCoords: { ...r },
				originalElements: this.scene
					.getNonDeletedElements()
					.reduce((u, f) => (u.set(f.id, dc(f)), u), new Map()),
				resize: {
					handleType: !1,
					isResizing: !1,
					offset: { x: 0, y: 0 },
					arrowDirection: "origin",
					center: { x: (s + i) / 2, y: (c + a) / 2 },
				},
				hit: {
					element: null,
					allHitElements: [],
					wasAddedToSelection: !1,
					hasBeenDuplicated: !1,
					hasHitCommonBoundingBoxOfSelectedElements:
						this.isHittingCommonBoundingBoxOfSelectedElements(r, o),
				},
				drag: { hasOccurred: !1, offset: null },
				eventListeners: {
					onMove: null,
					onUp: null,
					onKeyUp: null,
					onKeyDown: null,
				},
				boxSelection: { hasOccurred: !1 },
			};
		}
		handleDraggingScrollBar(t, r) {
			if (!(r.scrollbars.isOverEither && !this.state.multiElement)) return !1;
			(lw = !0), (r.lastCoords.x = t.clientX), (r.lastCoords.y = t.clientY);
			let o = nb((a) => {
					a.target instanceof HTMLElement &&
						this.handlePointerMoveOverScrollbars(a, r);
				}),
				i = Wt(() => {
					(yu = null),
						(lw = !1),
						zn(this.interactiveCanvas, this.state),
						this.setState({ cursorButton: "up" }),
						this.savePointer(t.clientX, t.clientY, "up"),
						window.removeEventListener("pointermove", o),
						window.removeEventListener("pointerup", i),
						o.flush();
				});
			return (
				(yu = i),
				window.addEventListener("pointermove", o),
				window.addEventListener("pointerup", i),
				!0
			);
		}
		clearSelectionIfNotUsingSelection = () => {
			this.state.activeTool.type !== "selection" &&
				this.setState({
					selectedElementIds: dt({}, this.state),
					selectedGroupIds: {},
					editingGroupId: null,
					activeEmbeddable: null,
				});
		};
		handleSelectionOnPointerDown = (t, r) => {
			if (this.state.activeTool.type === "selection") {
				let o = this.scene.getNonDeletedElements(),
					i = this.scene.getNonDeletedElementsMap(),
					a = this.scene.getSelectedElements(this.state);
				if (
					a.length === 1 &&
					!this.state.editingLinearElement &&
					!(
						this.state.selectedLinearElement &&
						this.state.selectedLinearElement.hoverPointIndex !== -1
					)
				) {
					let s = aE(
						o,
						this.state,
						r.origin.x,
						r.origin.y,
						this.state.zoom,
						t.pointerType,
						this.scene.getNonDeletedElementsMap(),
						this.device,
					);
					s != null &&
						(s.transformHandleType === "rotation"
							? (this.setState({ resizingElement: s.element }),
								(r.resize.handleType = s.transformHandleType))
							: (this.state.croppingElementId ||
									this.setState({ resizingElement: s.element }),
								(r.resize.handleType = s.transformHandleType)));
				} else
					a.length > 1 &&
						(r.resize.handleType = lE(
							yt(a),
							r.origin.x,
							r.origin.y,
							this.state.zoom,
							t.pointerType,
							this.device,
						));
				if (r.resize.handleType)
					(r.resize.isResizing = !0),
						(r.resize.offset = ya(
							D_(r.resize.handleType, a, i, r.origin.x, r.origin.y),
						)),
						a.length === 1 &&
							at(a[0]) &&
							a[0].points.length === 2 &&
							(r.resize.arrowDirection = N_(r.resize.handleType, a[0]));
				else {
					if (this.state.selectedLinearElement) {
						let d =
								this.state.editingLinearElement ||
								this.state.selectedLinearElement,
							u = De.handlePointerDown(
								t,
								this,
								this.store,
								r.origin,
								d,
								this.scene,
							);
						if (
							(u.hitElement && (r.hit.element = u.hitElement),
							u.linearElementEditor &&
								(this.setState({
									selectedLinearElement: u.linearElementEditor,
								}),
								this.state.editingLinearElement &&
									this.setState({
										editingLinearElement: u.linearElementEditor,
									})),
							u.didAddPoint)
						)
							return !0;
					}
					if (
						((r.hit.element =
							r.hit.element ??
							this.getElementAtPosition(r.origin.x, r.origin.y)),
						(this.hitLinkElement = this.getElementLinkAtPosition(
							r.origin,
							r.hit.element,
						)),
						this.hitLinkElement)
					)
						return !0;
					if (
						(this.state.croppingElementId &&
							r.hit.element?.id !== this.state.croppingElementId &&
							this.finishImageCropping(),
						r.hit.element &&
							this.getElementLinkAtPosition(
								{ x: r.origin.x, y: r.origin.y },
								r.hit.element,
							))
					)
						return !1;
					r.hit.allHitElements = this.getElementsAtPosition(
						r.origin.x,
						r.origin.y,
					);
					let s = r.hit.element,
						c = r.hit.allHitElements.some((d) => this.isASelectedElement(d));
					if (
						((s === null || !c) &&
							!t.shiftKey &&
							!r.hit.hasHitCommonBoundingBoxOfSelectedElements &&
							this.clearSelection(s),
						this.state.editingLinearElement)
					)
						this.setState({
							selectedElementIds: dt(
								{ [this.state.editingLinearElement.elementId]: !0 },
								this.state,
							),
						});
					else if (s != null) {
						if (t[R.CTRL_OR_CMD])
							return (
								this.state.selectedElementIds[s.id] ||
									(r.hit.wasAddedToSelection = !0),
								this.setState((d) => ({
									...sC(d, s),
									previousSelectedElementIds: this.state.selectedElementIds,
								})),
								!1
							);
						this.state.selectedElementIds[s.id] ||
							(this.state.editingGroupId &&
								!tc(s, this.state.editingGroupId) &&
								this.setState({
									selectedElementIds: dt({}, this.state),
									selectedGroupIds: {},
									editingGroupId: null,
									activeEmbeddable: null,
								}),
							!c &&
								!r.hit.hasHitCommonBoundingBoxOfSelectedElements &&
								(this.setState((d) => {
									let u = { ...d.selectedElementIds, [s.id]: !0 },
										f = [];
									if (
										(Object.keys(d.selectedElementIds).forEach((m) => {
											let g = this.scene.getElement(m);
											g && f.push(g);
										}),
										Ye(s))
									)
										ka(f, s.id).forEach((m) => {
											delete u[m.id];
										});
									else if (s.frameId) u[s.frameId] && delete u[s.id];
									else {
										let m = s.groupIds,
											g = new Set(
												m
													.flatMap((h) =>
														Vt(this.scene.getNonDeletedElements(), h),
													)
													.filter((h) => Ye(h))
													.map((h) => h.id),
											);
										g.size > 0 &&
											f.forEach((h) => {
												h.frameId &&
													g.has(h.frameId) &&
													(delete u[h.id],
													h.groupIds
														.flatMap((y) =>
															Vt(this.scene.getNonDeletedElements(), y),
														)
														.forEach((y) => {
															delete u[y.id];
														}));
											});
									}
									return (
										d.openDialog?.name === "elementLinkSelector" &&
											(s.groupIds.some((m) => d.selectedGroupIds[m]) ||
												(u = { [s.id]: !0 })),
										{
											...Mr(
												{
													editingGroupId: d.editingGroupId,
													selectedElementIds: u,
												},
												this.scene.getNonDeletedElements(),
												d,
												this,
											),
											showHyperlinkPopup: s.link || so(s) ? "info" : !1,
										}
									);
								}),
								(r.hit.wasAddedToSelection = !0)));
					}
					this.setState({
						previousSelectedElementIds: this.state.selectedElementIds,
					});
				}
			}
			return !1;
		};
		isASelectedElement(t) {
			return t != null && this.state.selectedElementIds[t.id];
		}
		isHittingCommonBoundingBoxOfSelectedElements(t, r) {
			if (r.length < 2) return !1;
			let o = this.getElementHitThreshold(),
				[i, a, s, c] = yt(r);
			return t.x > i - o && t.x < s + o && t.y > a - o && t.y < c + o;
		}
		handleTextOnPointerDown = (t, r) => {
			if (this.state.editingTextElement) return;
			let o = r.origin.x,
				i = r.origin.y,
				a = this.getElementAtPosition(o, i, { includeBoundTextElement: !0 }),
				s = this.getTextBindableContainerAtPosition(o, i);
			Ao(a) && ((s = a), (o = a.x + a.width / 2), (i = a.y + a.height / 2)),
				this.startTextEditing({
					sceneX: o,
					sceneY: i,
					insertAtParentCenter: !t.altKey,
					container: s,
					autoEdit: !1,
				}),
				mn(this.interactiveCanvas),
				this.state.activeTool.locked ||
					this.setState({ activeTool: Yt(this.state, { type: "selection" }) });
		};
		handleFreeDrawElementOnPointerDown = (t, r, o) => {
			let [i, a] = Br(o.origin.x, o.origin.y, null),
				s = this.getTopLayerFrameAtSceneCoords({ x: i, y: a }),
				c = t.pressure === 0.5,
				d = Q2({
					type: r,
					x: i,
					y: a,
					strokeColor: this.state.currentItemStrokeColor,
					backgroundColor: this.state.currentItemBackgroundColor,
					fillStyle: this.state.currentItemFillStyle,
					strokeWidth: this.state.currentItemStrokeWidth,
					strokeStyle: this.state.currentItemStrokeStyle,
					roughness: this.state.currentItemRoughness,
					opacity: this.state.currentItemOpacity,
					roundness: null,
					simulatePressure: c,
					locked: !1,
					frameId: s ? s.id : null,
					points: [pe(0, 0)],
					pressures: c ? [] : [t.pressure],
				});
			this.scene.insertElement(d),
				this.setState((f) => {
					let m = { ...f.selectedElementIds };
					return delete m[d.id], { selectedElementIds: dt(m, f) };
				});
			let u = Ia(
				o.origin,
				this.scene.getNonDeletedElements(),
				this.scene.getNonDeletedElementsMap(),
				this.state.zoom,
			);
			this.setState({
				newElement: d,
				startBoundElement: u,
				suggestedBindings: [],
			});
		};
		insertIframeElement = ({ sceneX: t, sceneY: r, width: o, height: i }) => {
			let [a, s] = Br(
					t,
					r,
					this.lastPointerDownEvent?.[R.CTRL_OR_CMD]
						? null
						: this.getEffectiveGridSize(),
				),
				c = q2({
					type: "iframe",
					x: a,
					y: s,
					strokeColor: "transparent",
					backgroundColor: "transparent",
					fillStyle: this.state.currentItemFillStyle,
					strokeWidth: this.state.currentItemStrokeWidth,
					strokeStyle: this.state.currentItemStrokeStyle,
					roughness: this.state.currentItemRoughness,
					roundness: this.getCurrentItemRoundness("iframe"),
					opacity: this.state.currentItemOpacity,
					locked: !1,
					width: o,
					height: i,
				});
			return this.scene.insertElement(c), c;
		};
		insertEmbeddableElement = ({ sceneX: t, sceneY: r, link: o }) => {
			let [i, a] = Br(
					t,
					r,
					this.lastPointerDownEvent?.[R.CTRL_OR_CMD]
						? null
						: this.getEffectiveGridSize(),
				),
				s = Fl(o);
			if (!s) return;
			s.error instanceof URIError &&
				this.setToast({
					message: v("toast.unrecognizedLinkFormat"),
					closable: !0,
				});
			let c = Mv({
				type: "embeddable",
				x: i,
				y: a,
				strokeColor: "transparent",
				backgroundColor: "transparent",
				fillStyle: this.state.currentItemFillStyle,
				strokeWidth: this.state.currentItemStrokeWidth,
				strokeStyle: this.state.currentItemStrokeStyle,
				roughness: this.state.currentItemRoughness,
				roundness: this.getCurrentItemRoundness("embeddable"),
				opacity: this.state.currentItemOpacity,
				locked: !1,
				width: s.intrinsicSize.w,
				height: s.intrinsicSize.h,
				link: o,
			});
			return this.scene.insertElement(c), c;
		};
		createImageElement = ({
			sceneX: t,
			sceneY: r,
			addToFrameUnderCursor: o = !0,
		}) => {
			let [i, a] = Br(
					t,
					r,
					this.lastPointerDownEvent?.[R.CTRL_OR_CMD]
						? null
						: this.getEffectiveGridSize(),
				),
				s = o ? this.getTopLayerFrameAtSceneCoords({ x: i, y: a }) : null;
			return tf({
				type: "image",
				x: i,
				y: a,
				strokeColor: this.state.currentItemStrokeColor,
				backgroundColor: this.state.currentItemBackgroundColor,
				fillStyle: this.state.currentItemFillStyle,
				strokeWidth: this.state.currentItemStrokeWidth,
				strokeStyle: this.state.currentItemStrokeStyle,
				roughness: this.state.currentItemRoughness,
				roundness: null,
				opacity: this.state.currentItemOpacity,
				locked: !1,
				frameId: s ? s.id : null,
			});
		};
		handleLinearElementOnPointerDown = (t, r, o) => {
			if (this.state.multiElement) {
				let { multiElement: i } = this.state;
				if (i.type === "line" && lm(i.points, this.state.zoom.value)) {
					me(i, { lastCommittedPoint: i.points[i.points.length - 1] }),
						this.actionManager.executeAction(Zo);
					return;
				}
				if (qe(i) && i.points.length > 1) {
					me(i, { lastCommittedPoint: i.points[i.points.length - 1] }),
						this.actionManager.executeAction(Zo);
					return;
				}
				let { x: a, y: s, lastCommittedPoint: c } = i;
				if (
					i.points.length > 1 &&
					c &&
					va(pe(o.origin.x - a, o.origin.y - s), c) < hp
				) {
					this.actionManager.executeAction(Zo);
					return;
				}
				this.setState((d) => ({
					selectedElementIds: dt({ ...d.selectedElementIds, [i.id]: !0 }, d),
				})),
					me(i, { lastCommittedPoint: i.points[i.points.length - 1] }),
					ft(this.interactiveCanvas, pt.POINTER);
			} else {
				let [i, a] = Br(
						o.origin.x,
						o.origin.y,
						t[R.CTRL_OR_CMD] ? null : this.getEffectiveGridSize(),
					),
					s = this.getTopLayerFrameAtSceneCoords({ x: i, y: a }),
					{ currentItemStartArrowhead: c, currentItemEndArrowhead: d } =
						this.state,
					[u, f] = r === "arrow" ? [c, d] : [null, null],
					m =
						r === "arrow"
							? cc({
									type: r,
									x: i,
									y: a,
									strokeColor: this.state.currentItemStrokeColor,
									backgroundColor: this.state.currentItemBackgroundColor,
									fillStyle: this.state.currentItemFillStyle,
									strokeWidth: this.state.currentItemStrokeWidth,
									strokeStyle: this.state.currentItemStrokeStyle,
									roughness: this.state.currentItemRoughness,
									opacity: this.state.currentItemOpacity,
									roundness:
										this.state.currentItemArrowType === Ar.round
											? { type: To.PROPORTIONAL_RADIUS }
											: null,
									startArrowhead: u,
									endArrowhead: f,
									locked: !1,
									frameId: s ? s.id : null,
									elbowed: this.state.currentItemArrowType === Ar.elbow,
								})
							: ef({
									type: r,
									x: i,
									y: a,
									strokeColor: this.state.currentItemStrokeColor,
									backgroundColor: this.state.currentItemBackgroundColor,
									fillStyle: this.state.currentItemFillStyle,
									strokeWidth: this.state.currentItemStrokeWidth,
									strokeStyle: this.state.currentItemStrokeStyle,
									roughness: this.state.currentItemRoughness,
									opacity: this.state.currentItemOpacity,
									roundness:
										this.state.currentItemRoundness === "round"
											? { type: To.PROPORTIONAL_RADIUS }
											: null,
									locked: !1,
									frameId: s ? s.id : null,
								});
				this.setState((h) => {
					let y = { ...h.selectedElementIds };
					return delete y[m.id], { selectedElementIds: dt(y, h) };
				}),
					me(m, { points: [...m.points, pe(0, 0)] });
				let g = Ia(
					o.origin,
					this.scene.getNonDeletedElements(),
					this.scene.getNonDeletedElementsMap(),
					this.state.zoom,
					qe(m),
				);
				this.scene.insertElement(m),
					this.setState({
						newElement: m,
						startBoundElement: g,
						suggestedBindings: [],
					});
			}
		};
		getCurrentItemRoundness(t) {
			return this.state.currentItemRoundness === "round"
				? { type: js(t) ? To.ADAPTIVE_RADIUS : To.PROPORTIONAL_RADIUS }
				: null;
		}
		createGenericElementOnPointerDown = (t, r) => {
			let [o, i] = Br(
					r.origin.x,
					r.origin.y,
					this.lastPointerDownEvent?.[R.CTRL_OR_CMD]
						? null
						: this.getEffectiveGridSize(),
				),
				a = this.getTopLayerFrameAtSceneCoords({ x: o, y: i }),
				s = {
					x: o,
					y: i,
					strokeColor: this.state.currentItemStrokeColor,
					backgroundColor: this.state.currentItemBackgroundColor,
					fillStyle: this.state.currentItemFillStyle,
					strokeWidth: this.state.currentItemStrokeWidth,
					strokeStyle: this.state.currentItemStrokeStyle,
					roughness: this.state.currentItemRoughness,
					opacity: this.state.currentItemOpacity,
					roundness: this.getCurrentItemRoundness(t),
					locked: !1,
					frameId: a ? a.id : null,
				},
				c;
			t === "embeddable"
				? (c = Mv({ type: "embeddable", ...s }))
				: (c = $n({ type: t, ...s })),
				c.type === "selection"
					? this.setState({ selectionElement: c })
					: (this.scene.insertElement(c),
						this.setState({ multiElement: null, newElement: c }));
		};
		createFrameElementOnPointerDown = (t, r) => {
			let [o, i] = Br(
					t.origin.x,
					t.origin.y,
					this.lastPointerDownEvent?.[R.CTRL_OR_CMD]
						? null
						: this.getEffectiveGridSize(),
				),
				a = {
					x: o,
					y: i,
					opacity: this.state.currentItemOpacity,
					locked: !1,
					...On,
				},
				s = r === Co.magicframe ? am(a) : Jp(a);
			this.scene.insertElement(s),
				this.setState({ multiElement: null, newElement: s });
		};
		maybeCacheReferenceSnapPoints(t, r, o = !1) {
			eE({ event: t, app: this, selectedElements: r }) &&
				(o || !Ma.getReferenceSnapPoints()) &&
				Ma.setReferenceSnapPoints(
					a_(
						this.scene.getNonDeletedElements(),
						r,
						this.state,
						this.scene.getNonDeletedElementsMap(),
					),
				);
		}
		maybeCacheVisibleGaps(t, r, o = !1) {
			eE({ event: t, app: this, selectedElements: r }) &&
				(o || !Ma.getVisibleGaps()) &&
				Ma.setVisibleGaps(
					i_(
						this.scene.getNonDeletedElements(),
						r,
						this.state,
						this.scene.getNonDeletedElementsMap(),
					),
				);
		}
		onKeyDownFromPointerDownHandler(t) {
			return Wt((r) => {
				this.maybeHandleResize(t, r) || this.maybeDragNewGenericElement(t, r);
			});
		}
		onKeyUpFromPointerDownHandler(t) {
			return Wt((r) => {
				r.key === R.ALT && r.preventDefault(),
					!this.maybeHandleResize(t, r) &&
						this.maybeDragNewGenericElement(t, r);
			});
		}
		onPointerMoveFromPointerDownHandler(t) {
			return nb((r) => {
				if (this.state.openDialog?.name === "elementLinkSelector") return;
				let o = Ot(r, this.state),
					i = this.lastPointerMoveCoords ?? t.origin;
				if (
					((this.lastPointerMoveCoords = o),
					t.drag.offset === null &&
						(t.drag.offset = ya(
							B_(
								this.scene.getSelectedElements(this.state),
								t.origin.x,
								t.origin.y,
							),
						)),
					!(r.target instanceof HTMLElement) ||
						this.handlePointerMoveOverScrollbars(r, t))
				)
					return;
				if (dn(this.state)) {
					this.handleEraser(r, t, o);
					return;
				}
				this.state.activeTool.type === "laser" &&
					this.laserTrails.addPointToPath(o.x, o.y);
				let [s, c] = Br(
					o.x,
					o.y,
					r[R.CTRL_OR_CMD] ? null : this.getEffectiveGridSize(),
				);
				if (
					!t.drag.hasOccurred &&
					(this.state.activeTool.type === "arrow" ||
						this.state.activeTool.type === "line") &&
					va(pe(o.x, o.y), pe(t.origin.x, t.origin.y)) < El
				)
					return;
				if (
					t.resize.isResizing &&
					((t.lastCoords.x = o.x),
					(t.lastCoords.y = o.y),
					this.maybeHandleCrop(t, r) || this.maybeHandleResize(t, r))
				)
					return !0;
				let d = this.scene.getNonDeletedElementsMap();
				if (this.state.selectedLinearElement) {
					let m =
						this.state.editingLinearElement || this.state.selectedLinearElement;
					if (
						De.shouldAddMidpoint(
							this.state.selectedLinearElement,
							o,
							this.state,
							d,
						)
					) {
						let h = De.addMidpoint(
							this.state.selectedLinearElement,
							o,
							this,
							!r[R.CTRL_OR_CMD],
							d,
						);
						if (!h) return;
						(0, il.flushSync)(() => {
							this.state.selectedLinearElement &&
								this.setState({
									selectedLinearElement: {
										...this.state.selectedLinearElement,
										pointerDownState: h.pointerDownState,
										selectedPointsIndices: h.selectedPointsIndices,
									},
								}),
								this.state.editingLinearElement &&
									this.setState({
										editingLinearElement: {
											...this.state.editingLinearElement,
											pointerDownState: h.pointerDownState,
											selectedPointsIndices: h.selectedPointsIndices,
										},
									});
						});
						return;
					} else if (
						m.pointerDownState.segmentMidpoint.value !== null &&
						!m.pointerDownState.segmentMidpoint.added
					)
						return;
					if (
						De.handlePointDragging(
							r,
							this,
							o.x,
							o.y,
							(h, y) => {
								this.maybeSuggestBindingsForLinearElementAtCoords(h, y);
							},
							m,
							this.scene,
						)
					) {
						(t.lastCoords.x = o.x),
							(t.lastCoords.y = o.y),
							(t.drag.hasOccurred = !0),
							this.state.editingLinearElement &&
								!this.state.editingLinearElement.isDragging &&
								this.setState({
									editingLinearElement: {
										...this.state.editingLinearElement,
										isDragging: !0,
									},
								}),
							this.state.selectedLinearElement.isDragging ||
								this.setState({
									selectedLinearElement: {
										...this.state.selectedLinearElement,
										isDragging: !0,
									},
								});
						return;
					}
				}
				let u = t.hit.allHitElements.some((m) => this.isASelectedElement(m)),
					f =
						this.state.editingLinearElement &&
						r.shiftKey &&
						this.state.editingLinearElement.elementId === t.hit.element?.id;
				if ((u || t.hit.hasHitCommonBoundingBoxOfSelectedElements) && !f) {
					let m = this.scene.getSelectedElements(this.state);
					if (m.every((E) => E.locked)) return;
					let g = m.find((E) => Ye(E)),
						h = this.getTopLayerFrameAtSceneCoords(o),
						y = h && !g ? h : null;
					if (
						(this.state.frameToHighlight !== y &&
							(0, il.flushSync)(() => {
								this.setState({ frameToHighlight: y });
							}),
						(t.drag.hasOccurred = !0),
						m.length > 0 &&
							!t.withCmdOrCtrl &&
							!this.state.editingTextElement &&
							this.state.activeEmbeddable?.state !== "active")
					) {
						let E = { x: o.x - t.origin.x, y: o.y - t.origin.y },
							T = [...t.originalElements.values()],
							I = r.shiftKey;
						if (I) {
							let k = Math.abs(E.x),
								N = Math.abs(E.y),
								D = I && k < N,
								B = I && k > N;
							D && (E.x = 0), B && (E.y = 0);
						}
						if (this.state.croppingElementId) {
							let k = this.scene
								.getNonDeletedElementsMap()
								.get(this.state.croppingElementId);
							if (k && ct(k) && k.crop !== null && t.hit.element === k) {
								let N = k.crop,
									D = _l(k) && this.imageCache.get(k.fileId)?.image;
								if (D && !(D instanceof Promise)) {
									let B = FT(
											Ws(o.x - i.x, o.y - i.y),
											Math.max(this.state.zoom.value, 2),
										),
										[F, W, G, q, ie, te] = mo(k, d),
										we = Ip(ao(pe(F, W), pe(ie, te), k.angle)),
										X = Ip(ao(pe(G, W), pe(ie, te), k.angle)),
										se = Ip(ao(pe(F, q), pe(ie, te), k.angle)),
										Pe = ov(rv(X, we)),
										ke = ov(rv(se, we)),
										fe = Ws(tv(B, Pe), tv(B, ke)),
										Y = {
											...N,
											x: kr(
												N.x - fe[0] * Math.sign(k.scale[0]),
												0,
												D.naturalWidth - N.width,
											),
											y: kr(
												N.y - fe[1] * Math.sign(k.scale[1]),
												0,
												D.naturalHeight - N.height,
											),
										};
									me(k, { crop: Y });
									return;
								}
							}
						}
						this.maybeCacheVisibleGaps(r, m),
							this.maybeCacheReferenceSnapPoints(r, m);
						let { snapOffset: P, snapLines: C } = l_(
							T,
							E,
							this,
							r,
							this.scene.getNonDeletedElementsMap(),
						);
						if (
							((0, il.flushSync)(() => {
								this.setState({ snapLines: C });
							}),
							!this.state.editingFrame &&
								F_(
									t,
									m,
									E,
									this.scene,
									P,
									r[R.CTRL_OR_CMD] ? null : this.getEffectiveGridSize(),
								),
							this.setState({
								selectedElementsAreBeingDragged: !0,
								selectionElement: null,
							}),
							(m.length !== 1 || !qe(m[0])) &&
								this.setState({
									suggestedBindings: mf(
										m,
										this.scene.getNonDeletedElementsMap(),
										this.state.zoom,
									),
								}),
							r.altKey && !t.hit.hasBeenDuplicated)
						) {
							t.hit.hasBeenDuplicated = !0;
							let k = [],
								N = [],
								D = new Map(),
								B = new Map(),
								F = t.hit.element,
								W = new Set(
									this.scene
										.getSelectedElements({
											selectedElementIds: this.state.selectedElementIds,
											includeBoundTextElement: !0,
											includeElementsInFrames: !0,
										})
										.map((ie) => ie.id),
								),
								G = this.scene.getElementsIncludingDeleted();
							for (let ie of G)
								if (
									W.has(ie.id) ||
									(ie.id === F?.id && t.hit.wasAddedToSelection)
								) {
									let te = rf(this.state.editingGroupId, D, ie),
										we = t.originalElements.get(ie.id);
									me(te, { x: we.x, y: we.y }),
										t.originalElements.set(te.id, te),
										k.push(te),
										N.push(ie),
										B.set(ie.id, te.id);
								} else k.push(ie);
							let q = [...k, ...N];
							Yo(q, Fe(N)),
								Nf(k, N, B),
								uf(q, N, B, "duplicatesServeAsOld"),
								Af(q, N, B),
								this.scene.replaceAllElements(q),
								this.maybeCacheVisibleGaps(r, m, !0),
								this.maybeCacheReferenceSnapPoints(r, m, !0);
						}
						return;
					}
				}
				if (this.state.selectionElement)
					(t.lastCoords.x = o.x),
						(t.lastCoords.y = o.y),
						this.maybeDragNewGenericElement(t, r);
				else {
					let m = this.state.newElement;
					if (!m) return;
					if (m.type === "freedraw") {
						let g = m.points,
							h = o.x - m.x,
							y = o.y - m.y,
							E = g.length > 0 && g[g.length - 1];
						if (!(E && E[0] === h && E[1] === y)) {
							let I = m.simulatePressure
								? m.pressures
								: [...m.pressures, r.pressure];
							me(m, { points: [...g, pe(h, y)], pressures: I }, !1),
								this.setState({ newElement: m });
						}
					} else if (at(m)) {
						t.drag.hasOccurred = !0;
						let g = m.points,
							h = s - m.x,
							y = c - m.y;
						lf(r) &&
							g.length === 2 &&
							({ width: h, height: y } = iE(m.x, m.y, o.x, o.y)),
							g.length === 1
								? me(m, { points: [...g, pe(h, y)] }, !1)
								: g.length > 1 && qe(m)
									? Ui(m, d, [...g.slice(0, -1), pe(h, y)], Ws(0, 0), void 0, {
											isDragging: !0,
											informMutation: !1,
											zoom: this.state.zoom,
										})
									: g.length === 2 &&
										me(m, { points: [...g.slice(0, -1), pe(h, y)] }, !1),
							this.setState({ newElement: m }),
							Ni(m, !1) &&
								this.maybeSuggestBindingsForLinearElementAtCoords(
									m,
									[o],
									this.state.startBoundElement,
								);
					} else
						(t.lastCoords.x = o.x),
							(t.lastCoords.y = o.y),
							this.maybeDragNewGenericElement(t, r, !1);
				}
				if (this.state.activeTool.type === "selection") {
					t.boxSelection.hasOccurred = !0;
					let m = this.scene.getNonDeletedElements();
					if (this.state.editingLinearElement)
						De.handleBoxSelection(
							r,
							this.state,
							this.setState.bind(this),
							this.scene.getNonDeletedElementsMap(),
						);
					else {
						let g = !0;
						!r.shiftKey &&
							bt(m, this.state) &&
							(t.withCmdOrCtrl && t.hit.element
								? this.setState((y) =>
										Mr(
											{ ...y, selectedElementIds: { [t.hit.element.id]: !0 } },
											this.scene.getNonDeletedElements(),
											y,
											this,
										),
									)
								: (g = !1));
						let h = this.state.selectionElement
							? z_(
									m,
									this.state.selectionElement,
									this.scene.getNonDeletedElementsMap(),
								)
							: [];
						this.setState((y) => {
							let E = {
								...(g && y.selectedElementIds),
								...h.reduce((T, I) => ((T[I.id] = !0), T), {}),
							};
							return (
								t.hit.element &&
									(h.length
										? delete E[t.hit.element.id]
										: (E[t.hit.element.id] = !0)),
								(y = g
									? y
									: { ...y, selectedGroupIds: {}, editingGroupId: null }),
								{
									...Mr(
										{ editingGroupId: y.editingGroupId, selectedElementIds: E },
										this.scene.getNonDeletedElements(),
										y,
										this,
									),
									selectedLinearElement:
										h.length === 1 && at(h[0]) ? new De(h[0]) : null,
									showHyperlinkPopup:
										h.length === 1 && (h[0].link || so(h[0])) ? "info" : !1,
								}
							);
						});
					}
				}
			});
		}
		handlePointerMoveOverScrollbars(t, r) {
			if (r.scrollbars.isOverHorizontal) {
				let o = t.clientX,
					i = o - r.lastCoords.x;
				return (
					this.translateCanvas({
						scrollX: this.state.scrollX - i / this.state.zoom.value,
					}),
					(r.lastCoords.x = o),
					!0
				);
			}
			if (r.scrollbars.isOverVertical) {
				let o = t.clientY,
					i = o - r.lastCoords.y;
				return (
					this.translateCanvas({
						scrollY: this.state.scrollY - i / this.state.zoom.value,
					}),
					(r.lastCoords.y = o),
					!0
				);
			}
			return !1;
		}
		onPointerUpFromPointerDownHandler(t) {
			return Wt((r) => {
				this.removePointer(r),
					t.eventListeners.onMove && t.eventListeners.onMove.flush();
				let {
					newElement: o,
					resizingElement: i,
					croppingElementId: a,
					multiElement: s,
					activeTool: c,
					isResizing: d,
					isRotating: u,
					isCropping: f,
				} = this.state;
				this.setState((E) => ({
					isResizing: !1,
					isRotating: !1,
					isCropping: !1,
					resizingElement: null,
					selectionElement: null,
					frameToHighlight: null,
					elementsToHighlight: null,
					cursorButton: "up",
					snapLines: Xs(E.snapLines, []),
					originSnapOffset: null,
				})),
					(this.lastPointerMoveCoords = null),
					Ma.setReferenceSnapPoints(null),
					Ma.setVisibleGaps(null),
					this.savePointer(r.clientX, r.clientY, "up"),
					this.setState({ selectedElementsAreBeingDragged: !1 });
				let m = this.scene.getNonDeletedElementsMap();
				if (this.state.editingLinearElement)
					if (
						!t.boxSelection.hasOccurred &&
						t.hit?.element?.id !== this.state.editingLinearElement.elementId
					)
						this.actionManager.executeAction(Zo);
					else {
						let E = De.handlePointerUp(
							r,
							this.state.editingLinearElement,
							this.state,
							this.scene,
						);
						E !== this.state.editingLinearElement &&
							this.setState({ editingLinearElement: E, suggestedBindings: [] });
					}
				else if (this.state.selectedLinearElement)
					if (t.hit?.element?.id !== this.state.selectedLinearElement.elementId)
						this.scene.getSelectedElements(this.state).length > 1 &&
							this.setState({ selectedLinearElement: null });
					else {
						let E = De.handlePointerUp(
								r,
								this.state.selectedLinearElement,
								this.state,
								this.scene,
							),
							{ startBindingElement: T, endBindingElement: I } = E,
							P = this.scene.getElement(E.elementId);
						Ni(P) && df(P, T, I, m, this.scene),
							E !== this.state.selectedLinearElement &&
								this.setState({
									selectedLinearElement: { ...E, selectedPointsIndices: null },
									suggestedBindings: [],
								});
					}
				if (
					(this.missingPointerEventCleanupEmitter.clear(),
					window.removeEventListener("pointermove", t.eventListeners.onMove),
					window.removeEventListener("pointerup", t.eventListeners.onUp),
					window.removeEventListener("keydown", t.eventListeners.onKeyDown),
					window.removeEventListener("keyup", t.eventListeners.onKeyUp),
					this.state.pendingImageElementId &&
						this.setState({ pendingImageElementId: null }),
					this.props?.onPointerUp?.(c, t),
					this.onPointerUpEmitter.trigger(this.state.activeTool, t, r),
					o?.type === "freedraw")
				) {
					let E = Ot(r, this.state),
						T = o.points,
						I = E.x - o.x,
						P = E.y - o.y;
					I === T[0][0] && P === T[0][1] && ((P += 1e-4), (I += 1e-4));
					let C = o.simulatePressure ? [] : [...o.pressures, r.pressure];
					me(o, {
						points: [...T, pe(I, P)],
						pressures: C,
						lastCommittedPoint: pe(I, P),
					}),
						this.actionManager.executeAction(Zo);
					return;
				}
				if (ct(o)) {
					let E = o;
					try {
						this.initializeImageDimensions(E),
							this.setState(
								{ selectedElementIds: dt({ [E.id]: !0 }, this.state) },
								() => {
									this.actionManager.executeAction(Zo);
								},
							);
					} catch (T) {
						console.error(T),
							this.scene.replaceAllElements(
								this.scene
									.getElementsIncludingDeleted()
									.filter((I) => I.id !== E.id),
							),
							this.actionManager.executeAction(Zo);
					}
					return;
				}
				if (at(o)) {
					o.points.length > 1 && this.store.shouldCaptureIncrement();
					let E = Ot(r, this.state);
					!t.drag.hasOccurred && o && !s
						? (me(o, { points: [...o.points, pe(E.x - o.x, E.y - o.y)] }),
							this.setState({ multiElement: o, newElement: o }))
						: t.drag.hasOccurred &&
							!s &&
							(Nl(this.state) &&
								Ni(o, !1) &&
								cm(
									o,
									this.state,
									E,
									this.scene.getNonDeletedElementsMap(),
									this.scene.getNonDeletedElements(),
								),
							this.setState({ suggestedBindings: [], startBoundElement: null }),
							c.locked
								? this.setState((T) => ({ newElement: null }))
								: (mn(this.interactiveCanvas),
									this.setState((T) => ({
										newElement: null,
										activeTool: Yt(this.state, { type: "selection" }),
										selectedElementIds: dt(
											{ ...T.selectedElementIds, [o.id]: !0 },
											T,
										),
										selectedLinearElement: new De(o),
									}))),
							this.scene.triggerUpdate());
					return;
				}
				if (Ee(o)) {
					let E = I_(
						Lr({ fontSize: o.fontSize, fontFamily: o.fontFamily }),
						o.lineHeight,
					);
					o.width < E && me(o, { autoResize: !0 }),
						this.resetCursor(),
						this.handleTextWysiwyg(o, { isExistingElement: !0 });
				}
				if (c.type !== "selection" && o && Wl(o)) {
					this.updateScene({
						elements: this.scene
							.getElementsIncludingDeleted()
							.filter((E) => E.id !== o.id),
						appState: { newElement: null },
						storeAction: H.UPDATE,
					});
					return;
				}
				if (Ye(o)) {
					let E = jI(
						this.scene.getElementsIncludingDeleted(),
						o,
						this.scene.getNonDeletedElementsMap(),
					);
					this.scene.replaceAllElements(
						Mf(this.scene.getElementsMapIncludingDeleted(), E, o),
					);
				}
				if (
					(o && (me(o, k_(o)), this.scene.triggerUpdate()), t.drag.hasOccurred)
				) {
					let E = Ot(r, this.state);
					if (
						this.state.selectedLinearElement &&
						this.state.selectedLinearElement.isDragging
					) {
						let T = this.scene.getElement(
							this.state.selectedLinearElement.elementId,
						);
						if (T?.frameId) {
							let I = Lf(T, m);
							I &&
								T &&
								(kf(T, I, this.scene.getNonDeletedElementsMap()) ||
									(me(T, { groupIds: [] }),
									Pf([T], this.scene.getNonDeletedElementsMap()),
									this.scene.triggerUpdate()));
						}
					} else {
						let T = this.getTopLayerFrameAtSceneCoords(E),
							I = this.scene.getSelectedElements(this.state),
							P = this.scene.getElementsMapIncludingDeleted(),
							C = (k) => {
								if (k.length > 0) {
									for (let N of k) {
										let D = N.groupIds.indexOf(this.state.editingGroupId);
										me(N, { groupIds: N.groupIds.slice(0, D) }, !1);
									}
									P.forEach((N) => {
										N.groupIds.length &&
											Vt(P, N.groupIds[N.groupIds.length - 1]).length < 2 &&
											me(N, { groupIds: [] }, !1);
									}),
										this.setState({ editingGroupId: null });
								}
							};
						if (T && !this.state.selectedElementIds[T.id]) {
							let k = I.filter(
								(N) => N.frameId !== T.id && Xv(N, P, this.state),
							);
							this.state.editingGroupId && C(k), (P = Mf(P, k, T));
						} else if (!T && this.state.editingGroupId) {
							let k = I.filter((N) => N.frameId && !Xv(N, P, this.state));
							C(k);
						}
						(P = ai(P, this.state, this)), this.scene.replaceAllElements(P);
					}
				}
				if (
					(i && this.store.shouldCaptureIncrement(),
					i &&
						Wl(i) &&
						this.updateScene({
							elements: this.scene
								.getElementsIncludingDeleted()
								.filter((E) => E.id !== i.id),
							storeAction: H.UPDATE,
						}),
					t.resize.isResizing)
				) {
					let E = ai(
							this.scene.getElementsIncludingDeleted(),
							this.state,
							this,
						),
						T = this.scene.getSelectedElements(this.state).filter((I) => Ye(I));
					for (let I of T)
						E = Rf(
							E,
							hc(this.scene.getElementsIncludingDeleted(), I, this.state, m),
							I,
							this,
						);
					this.scene.replaceAllElements(E);
				}
				let g = t.hit.element;
				this.state.selectedLinearElement?.elementId !== g?.id &&
					at(g) &&
					this.scene.getSelectedElements(this.state).length === 1 &&
					this.setState({ selectedLinearElement: new De(g) }),
					(!a || (a && ((!g && !f) || (g && g.id !== a)))) &&
						this.finishImageCropping();
				let h = this.lastPointerDownEvent,
					y = this.lastPointerUpEvent || this.lastPointerMoveEvent;
				if (dn(this.state) && h && y) {
					if (
						(this.eraserTrail.endPath(),
						va(pe(h.clientX, h.clientY), pe(y.clientX, y.clientY)) === 0)
					) {
						let T = Ot({ clientX: y.clientX, clientY: y.clientY }, this.state);
						this.getElementsAtPosition(T.x, T.y).forEach((P) =>
							this.elementsPendingErasure.add(P.id),
						);
					}
					this.eraseElements();
					return;
				} else
					this.elementsPendingErasure.size &&
						this.restoreReadyToEraseElements();
				if (
					(g &&
						!t.drag.hasOccurred &&
						!t.hit.wasAddedToSelection &&
						(!this.state.editingLinearElement || !t.boxSelection.hasOccurred) &&
						(r.shiftKey && !this.state.editingLinearElement
							? this.state.selectedElementIds[g.id]
								? Rp(this.state, g)
									? this.setState((E) => {
											let T = { ...E.selectedElementIds };
											for (let I of g.groupIds.flatMap((P) =>
												Vt(this.scene.getNonDeletedElements(), P),
											))
												delete T[I.id];
											return {
												selectedGroupIds: {
													...E.selectedElementIds,
													...g.groupIds
														.map((I) => ({ [I]: !1 }))
														.reduce((I, P) => ({ ...I, ...P }), {}),
												},
												selectedElementIds: dt(T, E),
											};
										})
									: this.state.selectedLinearElement?.isDragging ||
										this.setState((E) => {
											let T = { ...E.selectedElementIds };
											delete T[g.id];
											let I = Le(this.scene.getNonDeletedElements(), {
												selectedElementIds: T,
											});
											return {
												...Mr(
													{
														editingGroupId: E.editingGroupId,
														selectedElementIds: T,
													},
													this.scene.getNonDeletedElements(),
													E,
													this,
												),
												selectedLinearElement:
													I.length === 1 && at(I[0])
														? new De(I[0])
														: E.selectedLinearElement,
											};
										})
								: g.frameId && this.state.selectedElementIds[g.frameId]
									? this.setState((E) => {
											let T = { ...E.selectedElementIds, [g.id]: !0 };
											return (
												delete T[g.frameId],
												(this.scene.getElement(g.frameId)?.groupIds ?? [])
													.flatMap((I) =>
														Vt(this.scene.getNonDeletedElements(), I),
													)
													.forEach((I) => {
														delete T[I.id];
													}),
												{
													...Mr(
														{
															editingGroupId: E.editingGroupId,
															selectedElementIds: T,
														},
														this.scene.getNonDeletedElements(),
														E,
														this,
													),
													showHyperlinkPopup: g.link || so(g) ? "info" : !1,
												}
											);
										})
									: this.setState((E) => ({
											selectedElementIds: dt(
												{ ...E.selectedElementIds, [g.id]: !0 },
												E,
											),
										}))
							: this.setState((E) => ({
									...Mr(
										{
											editingGroupId: E.editingGroupId,
											selectedElementIds: { [g.id]: !0 },
										},
										this.scene.getNonDeletedElements(),
										E,
										this,
									),
									selectedLinearElement:
										at(g) && E.selectedLinearElement?.elementId !== g.id
											? new De(g)
											: E.selectedLinearElement,
								}))),
					!t.drag.hasOccurred &&
						!this.state.isResizing &&
						((g &&
							rI(
								{
									x: t.origin.x,
									y: t.origin.y,
									element: g,
									shape: Dl(g, this.scene.getNonDeletedElementsMap()),
									threshold: this.getElementHitThreshold(),
									frameNameBound: Ye(g)
										? this.frameNameBoundsCache.get(g)
										: null,
								},
								m,
							)) ||
							(!g && t.hit.hasHitCommonBoundingBoxOfSelectedElements)))
				) {
					this.state.editingLinearElement
						? this.setState({ editingLinearElement: null })
						: this.setState({
								selectedElementIds: dt({}, this.state),
								selectedGroupIds: {},
								editingGroupId: null,
								activeEmbeddable: null,
							}),
						ft(this.interactiveCanvas, pt.AUTO);
					return;
				}
				if (
					(!c.locked &&
						c.type !== "freedraw" &&
						o &&
						this.setState((E) => ({
							selectedElementIds: dt(
								{ ...E.selectedElementIds, [o.id]: !0 },
								E,
							),
							showHyperlinkPopup:
								so(o) && !o.link ? "editor" : E.showHyperlinkPopup,
						})),
					(c.type !== "selection" ||
						bt(this.scene.getNonDeletedElements(), this.state) ||
						!Er(
							this.state.previousSelectedElementIds,
							this.state.selectedElementIds,
						)) &&
						this.store.shouldCaptureIncrement(),
					t.drag.hasOccurred || d || u || f)
				) {
					let E = this.scene.getSelectedElements(this.state).filter(at);
					Ol(
						E,
						this.scene.getNonDeletedElementsMap(),
						this.scene.getNonDeletedElements(),
						this.scene,
						Nl(this.state),
						this.state.selectedLinearElement?.selectedPointsIndices ?? [],
						this.state.zoom,
					);
				}
				if (c.type === "laser") {
					this.laserTrails.endPath();
					return;
				}
				!c.locked && c.type !== "freedraw"
					? (mn(this.interactiveCanvas),
						this.setState({
							newElement: null,
							suggestedBindings: [],
							activeTool: Yt(this.state, { type: "selection" }),
						}))
					: this.setState({ newElement: null, suggestedBindings: [] }),
					g &&
						this.lastPointerUpEvent &&
						this.lastPointerDownEvent &&
						this.lastPointerUpEvent.timeStamp -
							this.lastPointerDownEvent.timeStamp <
							300 &&
						st.pointers.size <= 1 &&
						qs(g) &&
						this.isIframeLikeElementCenter(
							g,
							this.lastPointerUpEvent,
							t.origin.x,
							t.origin.y,
						) &&
						this.handleEmbeddableCenterClick(g);
			});
		}
		restoreReadyToEraseElements = () => {
			(this.elementsPendingErasure = new Set()), this.triggerRender();
		};
		eraseElements = () => {
			let t = !1,
				r = this.scene
					.getElementsIncludingDeleted()
					.map((o) =>
						this.elementsPendingErasure.has(o.id) ||
						(o.frameId && this.elementsPendingErasure.has(o.frameId)) ||
						(co(o) && this.elementsPendingErasure.has(o.containerId))
							? ((t = !0), Me(o, { isDeleted: !0 }))
							: o,
					);
			(this.elementsPendingErasure = new Set()),
				t &&
					(this.store.shouldCaptureIncrement(),
					this.scene.replaceAllElements(r));
		};
		initializeImage = async ({
			imageFile: t,
			imageElement: r,
			showCursorImagePreview: o = !1,
		}) => {
			if (!hf(t)) throw new Error(v("errors.unsupportedFileType"));
			let i = t.type;
			if ((ft(this.interactiveCanvas, "wait"), i === vr.svg))
				try {
					t = Hv(Kv(await t.text()), t.name);
				} catch (u) {
					throw (console.warn(u), new Error(v("errors.svgImageInsertError")));
				}
			let a = await (this.props.generateIdForFile?.(t) || CI(t));
			if (!a)
				throw (
					(console.warn(
						"Couldn't generate file id or the supplied `generateIdForFile` didn't resolve to one.",
					),
					new Error(v("errors.imageInsertError")))
				);
			if (!this.files[a]?.dataURL) {
				try {
					t = await mm(t, { maxWidthOrHeight: LT });
				} catch (u) {
					console.error("Error trying to resizing image file on insertion", u);
				}
				if (t.size > jx)
					throw new Error(
						v("errors.fileTooBig", {
							maxSize: `${Math.trunc(jx / 1024 / 1024)}MB`,
						}),
					);
			}
			if (o) {
				let u = this.files[a]?.dataURL,
					f = u && _I(u);
				this.setImagePreviewCursor(f || t);
			}
			let c = this.files[a]?.dataURL || (await xf(t)),
				d = me(r, { fileId: a }, !1);
			return new Promise(async (u, f) => {
				try {
					this.addMissingFiles([
						{
							mimeType: i,
							id: a,
							dataURL: c,
							created: Date.now(),
							lastRetrieved: Date.now(),
						},
					]);
					let m = this.imageCache.get(a);
					m ||
						(this.addNewImagesToImageCache(), await this.updateImageCache([d])),
						m?.image instanceof Promise && (await m.image),
						this.state.pendingImageElementId !== d.id &&
							this.state.newElement?.id !== d.id &&
							this.initializeImageDimensions(d, !0),
						u(d);
				} catch (m) {
					console.error(m), f(new Error(v("errors.imageInsertError")));
				} finally {
					o || mn(this.interactiveCanvas);
				}
			});
		};
		insertImageElement = async (t, r, o) => {
			if (!this.isToolSupported("image")) {
				this.setState({ errorMessage: v("errors.imageToolNotSupported") });
				return;
			}
			this.scene.insertElement(t);
			try {
				return await this.initializeImage({
					imageFile: r,
					imageElement: t,
					showCursorImagePreview: o,
				});
			} catch (i) {
				return (
					me(t, { isDeleted: !0 }),
					this.actionManager.executeAction(Zo),
					this.setState({
						errorMessage: i.message || v("errors.imageInsertError"),
					}),
					null
				);
			}
		};
		setImagePreviewCursor = async (t) => {
			let o;
			try {
				o = await mm(t, { maxWidthOrHeight: 96 });
			} catch (a) {
				throw a.cause === "UNSUPPORTED"
					? new Error(v("errors.unsupportedFileType"))
					: a;
			}
			let i = await xf(o);
			if (t.type === vr.svg) {
				let a = await RI(i),
					s = Math.min(a.height, 96),
					c = s * (a.width / a.height);
				c > 96 && ((c = 96), (s = c * (a.height / a.width)));
				let d = document.createElement("canvas");
				(d.height = s),
					(d.width = c),
					d.getContext("2d").drawImage(a, 0, 0, c, s),
					(i = d.toDataURL(vr.svg));
			}
			this.state.pendingImageElementId &&
				ft(this.interactiveCanvas, `url(${i}) 4 4, auto`);
		};
		onImageAction = async ({ insertOnCanvasDirectly: t }) => {
			try {
				let r = this.state.width / 2 + this.state.offsetLeft,
					o = this.state.height / 2 + this.state.offsetTop,
					{ x: i, y: a } = Ot({ clientX: r, clientY: o }, this.state),
					s = await ff({ description: "Image", extensions: Object.keys(hT) }),
					c = this.createImageElement({
						sceneX: i,
						sceneY: a,
						addToFrameUnderCursor: !1,
					});
				t
					? (this.insertImageElement(c, s),
						this.initializeImageDimensions(c),
						this.setState(
							{ selectedElementIds: dt({ [c.id]: !0 }, this.state) },
							() => {
								this.actionManager.executeAction(Zo);
							},
						))
					: this.setState({ pendingImageElementId: c.id }, () => {
							this.insertImageElement(c, s, !0);
						});
			} catch (r) {
				r.name !== "AbortError" ? console.error(r) : console.warn(r),
					this.setState(
						{
							pendingImageElementId: null,
							newElement: null,
							activeTool: Yt(this.state, { type: "selection" }),
						},
						() => {
							this.actionManager.executeAction(Zo);
						},
					);
			}
		};
		initializeImageDimensions = (t, r = !1) => {
			let o = _l(t) && this.imageCache.get(t.fileId)?.image;
			if (!o || o instanceof Promise) {
				if (
					t.width < El / this.state.zoom.value &&
					t.height < El / this.state.zoom.value
				) {
					let i = 100 / this.state.zoom.value;
					me(t, { x: t.x - i / 2, y: t.y - i / 2, width: i, height: i });
				}
				return;
			}
			if (
				r ||
				(t.width < El / this.state.zoom.value &&
					t.height < El / this.state.zoom.value)
			) {
				let i = Math.max(this.state.height - 120, 160),
					a = Math.min(
						i,
						Math.floor(this.state.height * 0.5) / this.state.zoom.value,
					),
					s = Math.min(o.naturalHeight, a),
					c = s * (o.naturalWidth / o.naturalHeight),
					d = t.x + t.width / 2 - c / 2,
					u = t.y + t.height / 2 - s / 2;
				me(t, { x: d, y: u, width: c, height: s, crop: null });
			}
		};
		updateImageCache = async (t, r = this.files) => {
			let { updatedFiles: o, erroredFiles: i } = await DI({
				imageCache: this.imageCache,
				fileIds: t.map((a) => a.fileId),
				files: r,
			});
			if (o.size || i.size) for (let a of t) o.has(a.fileId) && Ca.delete(a);
			return (
				i.size &&
					this.scene.replaceAllElements(
						this.scene
							.getElementsIncludingDeleted()
							.map((a) =>
								_l(a) && i.has(a.fileId) ? Me(a, { status: "error" }) : a,
							),
					),
				{ updatedFiles: o, erroredFiles: i }
			);
		};
		addNewImagesToImageCache = async (
			t = NI(this.scene.getNonDeletedElements()),
			r = this.files,
		) => {
			let o = t.filter((i) => !i.isDeleted && !this.imageCache.has(i.fileId));
			if (o.length) {
				let { updatedFiles: i } = await this.updateImageCache(o, r);
				i.size && this.scene.triggerUpdate();
			}
		};
		scheduleImageRefresh = (0, JP.default)(() => {
			this.addNewImagesToImageCache();
		}, vT);
		updateBindingEnabledOnPointerMove = (t) => {
			let r = uI(t);
			this.state.isBindingEnabled !== r &&
				this.setState({ isBindingEnabled: r });
		};
		maybeSuggestBindingAtCursor = (t) => {
			let r = Ia(
				t,
				this.scene.getNonDeletedElements(),
				this.scene.getNonDeletedElementsMap(),
				this.state.zoom,
			);
			this.setState({ suggestedBindings: r != null ? [r] : [] });
		};
		maybeSuggestBindingsForLinearElementAtCoords = (t, r, o) => {
			if (!r.length) return;
			let i = r.reduce((a, s) => {
				let c = Ia(
					s,
					this.scene.getNonDeletedElements(),
					this.scene.getNonDeletedElementsMap(),
					this.state.zoom,
					Lt(t) && qe(t),
				);
				return c != null && !gI(t, o?.id, c) && a.push(c), a;
			}, []);
			this.setState({ suggestedBindings: i });
		};
		clearSelection(t) {
			this.setState((r) => ({
				selectedElementIds: dt({}, r),
				activeEmbeddable: null,
				selectedGroupIds: {},
				editingGroupId:
					r.editingGroupId && t != null && tc(t, r.editingGroupId)
						? r.editingGroupId
						: null,
			})),
				this.setState({
					selectedElementIds: dt({}, this.state),
					activeEmbeddable: null,
					previousSelectedElementIds: this.state.selectedElementIds,
				});
		}
		handleInteractiveCanvasRef = (t) => {
			t !== null
				? ((this.interactiveCanvas = t),
					this.interactiveCanvas.addEventListener(
						"touchstart",
						this.onTouchStart,
						{ passive: !1 },
					),
					this.interactiveCanvas.addEventListener("touchend", this.onTouchEnd))
				: (this.interactiveCanvas?.removeEventListener(
						"touchstart",
						this.onTouchStart,
					),
					this.interactiveCanvas?.removeEventListener(
						"touchend",
						this.onTouchEnd,
					));
		};
		handleAppOnDrop = async (t) => {
			let { file: r, fileHandle: o } = await LI(t),
				{ x: i, y: a } = Ot(t, this.state);
			try {
				if (hf(r) && this.isToolSupported("image")) {
					if (r?.type === vr.png || r?.type === vr.svg)
						try {
							let d = await bf(
								r,
								this.state,
								this.scene.getElementsIncludingDeleted(),
								o,
							);
							this.syncActionResult({
								...d,
								appState: { ...(d.appState || this.state), isLoading: !1 },
								replaceFiles: !0,
								storeAction: H.CAPTURE,
							});
							return;
						} catch (d) {
							if (d.name !== "EncodingError")
								throw new Error(v("alerts.couldNotLoadInvalidFile"));
						}
					let c = this.createImageElement({ sceneX: i, sceneY: a });
					this.insertImageElement(c, r),
						this.initializeImageDimensions(c),
						this.setState({
							selectedElementIds: dt({ [c.id]: !0 }, this.state),
						});
					return;
				}
			} catch (c) {
				return this.setState({ isLoading: !1, errorMessage: c.message });
			}
			let s = t.dataTransfer.getData(vr.excalidrawlib);
			if (s && typeof s == "string") {
				try {
					let c = TI(s);
					this.addElementsFromPasteOrLibrary({
						elements: sh(c),
						position: t,
						files: null,
					});
				} catch (c) {
					this.setState({ errorMessage: c.message });
				}
				return;
			}
			if (
				(r && (await this.loadFileToCanvas(r, o)),
				t.dataTransfer?.types?.includes("text/plain"))
			) {
				let c = t.dataTransfer?.getData("text");
				if (
					c &&
					pc(c, this.props.validateEmbeddable) &&
					(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(c) ||
						Fl(c)?.type === "video")
				) {
					let d = this.insertEmbeddableElement({
						sceneX: i,
						sceneY: a,
						link: Bn(c),
					});
					d && this.setState({ selectedElementIds: { [d.id]: !0 } });
				}
			}
		};
		loadFileToCanvas = async (t, r) => {
			t = await MI(t);
			try {
				let o = this.scene.getElementsIncludingDeleted(),
					i;
				try {
					i = await zv(t, this.state, o, r);
				} catch (a) {
					let s = a instanceof nC;
					if (
						s &&
						a.code === "IMAGE_NOT_CONTAINS_SCENE_DATA" &&
						!this.isToolSupported("image")
					) {
						this.setState({
							isLoading: !1,
							errorMessage: v("errors.imageToolNotSupported"),
						});
						return;
					}
					let c = s
						? v("alerts.cannotRestoreFromImage")
						: v("alerts.couldNotLoadInvalidFile");
					this.setState({ isLoading: !1, errorMessage: c });
				}
				if (!i) return;
				i.type === vr.excalidraw
					? (Gi(o.concat(i.data.elements)),
						this.store.updateSnapshot(Fe(o), this.state),
						this.setState({ isLoading: !0 }),
						this.syncActionResult({
							...i.data,
							appState: { ...(i.data.appState || this.state), isLoading: !1 },
							replaceFiles: !0,
							storeAction: H.CAPTURE,
						}))
					: i.type === vr.excalidrawlib &&
						(await this.library
							.updateLibrary({
								libraryItems: t,
								merge: !0,
								openLibraryMenu: !0,
							})
							.catch((a) => {
								console.error(a),
									this.setState({
										errorMessage: v("errors.importLibraryError"),
									});
							}));
			} catch (o) {
				this.setState({ isLoading: !1, errorMessage: o.message });
			}
		};
		handleCanvasContextMenu = (t) => {
			if (
				(t.preventDefault(),
				(("pointerType" in t.nativeEvent &&
					t.nativeEvent.pointerType === "touch") ||
					("pointerType" in t.nativeEvent &&
						t.nativeEvent.pointerType === "pen" &&
						t.button !== ni.SECONDARY)) &&
					this.state.activeTool.type !== "selection")
			)
				return;
			let { x: r, y: o } = Ot(t, this.state),
				i = this.getElementAtPosition(r, o, {
					preferSelected: !0,
					includeLockedElements: !0,
				}),
				a = this.scene.getSelectedElements(this.state),
				s = this.isHittingCommonBoundingBoxOfSelectedElements(
					{ x: r, y: o },
					a,
				),
				c = i || s ? "element" : "canvas",
				d = this.excalidrawContainerRef.current,
				{ top: u, left: f } = d.getBoundingClientRect(),
				m = t.clientX - f,
				g = t.clientY - u;
			We("contextMenu", "openContextMenu", c),
				this.setState(
					{
						...(i && !this.state.selectedElementIds[i.id]
							? {
									...this.state,
									...Mr(
										{
											editingGroupId: this.state.editingGroupId,
											selectedElementIds: { [i.id]: !0 },
										},
										this.scene.getNonDeletedElements(),
										this.state,
										this,
									),
									selectedLinearElement: at(i) ? new De(i) : null,
								}
							: this.state),
						showHyperlinkPopup: !1,
					},
					() => {
						this.setState({
							contextMenu: {
								top: g,
								left: m,
								items: this.getContextMenuItems(c),
							},
						});
					},
				);
		};
		maybeDragNewGenericElement = (t, r, o = !0) => {
			let i = this.state.selectionElement,
				a = t.lastCoords;
			if (i && this.state.activeTool.type !== "eraser") {
				cE({
					newElement: i,
					elementType: this.state.activeTool.type,
					originX: t.origin.x,
					originY: t.origin.y,
					x: a.x,
					y: a.y,
					width: Cl(t.origin.x, a.x),
					height: Cl(t.origin.y, a.y),
					shouldMaintainAspectRatio: mc(r),
					shouldResizeFromCenter: af(r),
					zoom: this.state.zoom.value,
					informMutation: o,
				});
				return;
			}
			let s = this.state.newElement;
			if (!s) return;
			let [c, d] = Br(
					a.x,
					a.y,
					r[R.CTRL_OR_CMD] ? null : this.getEffectiveGridSize(),
				),
				u = _l(s) && this.imageCache.get(s.fileId)?.image,
				f = u && !(u instanceof Promise) ? u.width / u.height : null;
			this.maybeCacheReferenceSnapPoints(r, [s]);
			let { snapOffset: m, snapLines: g } = s_(
				s,
				this,
				r,
				{
					x: t.originInGrid.x + (this.state.originSnapOffset?.x ?? 0),
					y: t.originInGrid.y + (this.state.originSnapOffset?.y ?? 0),
				},
				{ x: c - t.originInGrid.x, y: d - t.originInGrid.y },
				this.scene.getNonDeletedElementsMap(),
			);
			(c += m.x),
				(d += m.y),
				this.setState({ snapLines: g }),
				cE({
					newElement: s,
					elementType: this.state.activeTool.type,
					originX: t.originInGrid.x,
					originY: t.originInGrid.y,
					x: c,
					y: d,
					width: Cl(t.originInGrid.x, c),
					height: Cl(t.originInGrid.y, d),
					shouldMaintainAspectRatio: ct(s) ? !mc(r) : mc(r),
					shouldResizeFromCenter: af(r),
					zoom: this.state.zoom.value,
					widthAspectRatio: f,
					originOffset: this.state.originSnapOffset,
					informMutation: o,
				}),
				this.setState({ newElement: s }),
				(this.state.activeTool.type === Co.frame ||
					this.state.activeTool.type === Co.magicframe) &&
					this.setState({
						elementsToHighlight: hc(
							this.scene.getNonDeletedElements(),
							s,
							this.state,
							this.scene.getNonDeletedElementsMap(),
						),
					});
		};
		maybeHandleCrop = (t, r) => {
			if (!this.state.croppingElementId) return !1;
			let o = t.resize.handleType,
				i = t.lastCoords,
				[a, s] = Br(
					i.x - t.resize.offset.x,
					i.y - t.resize.offset.y,
					r[R.CTRL_OR_CMD] ? null : this.getEffectiveGridSize(),
				),
				c = this.scene
					.getNonDeletedElementsMap()
					.get(this.state.croppingElementId);
			if (o && c && ct(c)) {
				let d = t.originalElements.get(c.id),
					u = _l(c) && this.imageCache.get(c.fileId)?.image;
				if (d && ct(d) && u && !(u instanceof Promise)) {
					let [f, m] = Br(
							i.x,
							i.y,
							r[R.CTRL_OR_CMD] ? null : this.getEffectiveGridSize(),
						),
						g = { x: f - t.originInGrid.x, y: m - t.originInGrid.y };
					this.maybeCacheReferenceSnapPoints(r, [c]);
					let { snapOffset: h, snapLines: y } = tE([c], [d], this, r, g, o);
					me(
						c,
						vI(
							c,
							o,
							u.naturalWidth,
							u.naturalHeight,
							a + h.x,
							s + h.y,
							r.shiftKey ? d.width / d.height : void 0,
						),
					),
						_a(c, this.scene.getNonDeletedElementsMap(), {
							newSize: { width: c.width, height: c.height },
						}),
						this.setState({ isCropping: o && o !== "rotation", snapLines: y });
				}
				return !0;
			}
			return !1;
		};
		maybeHandleResize = (t, r) => {
			let o = this.scene.getSelectedElements(this.state),
				i = o.filter((f) => Ye(f)),
				a = t.resize.handleType;
			if (
				(i.length > 0 && a === "rotation") ||
				(o.length === 1 && qe(o[0])) ||
				this.state.croppingElementId
			)
				return !1;
			this.setState({
				isResizing: a && a !== "rotation",
				isRotating: a === "rotation",
				activeEmbeddable: null,
			});
			let s = t.lastCoords,
				[c, d] = Br(
					s.x - t.resize.offset.x,
					s.y - t.resize.offset.y,
					r[R.CTRL_OR_CMD] ? null : this.getEffectiveGridSize(),
				),
				u = new Map();
			if (
				(i.forEach((f) => {
					ka(this.scene.getNonDeletedElements(), f.id).forEach((g) => {
						u.set(f.id + g.id, { x: g.x - f.x, y: g.y - f.y });
					});
				}),
				!this.state.selectedElementsAreBeingDragged)
			) {
				let [f, m] = Br(
						s.x,
						s.y,
						r[R.CTRL_OR_CMD] ? null : this.getEffectiveGridSize(),
					),
					g = { x: f - t.originInGrid.x, y: m - t.originInGrid.y },
					h = [...t.originalElements.values()];
				this.maybeCacheReferenceSnapPoints(r, o);
				let { snapOffset: y, snapLines: E } = tE(
					o,
					Le(h, this.state),
					this,
					r,
					g,
					a,
				);
				(c += y.x), (d += y.y), this.setState({ snapLines: E });
			}
			if (
				P_(
					t.originalElements,
					a,
					o,
					this.scene.getElementsMapIncludingDeleted(),
					this.scene,
					lf(r),
					af(r),
					o.some((f) => ct(f)) ? !mc(r) : mc(r),
					c,
					d,
					t.resize.center.x,
					t.resize.center.y,
				)
			) {
				let f = mf(o, this.scene.getNonDeletedElementsMap(), this.state.zoom),
					m = new Set();
				return (
					i.forEach((g) => {
						hc(
							this.scene.getNonDeletedElements(),
							g,
							this.state,
							this.scene.getNonDeletedElementsMap(),
						).forEach((h) => m.add(h));
					}),
					this.setState({ elementsToHighlight: [...m], suggestedBindings: f }),
					!0
				);
			}
			return !1;
		};
		getContextMenuItems = (t) => {
			let r = [];
			return (
				r.push(Qg, jg),
				t === "canvas"
					? this.state.viewModeEnabled
						? [...r, eh, ed, q0, td]
						: [Ly, Sr, Qg, jg, Jg, Sr, wE, o3, Sr, eh, My, ed, q0, td]
					: (r.push(Jg),
						this.state.viewModeEnabled
							? [Jc, ...r]
							: [
									Sr,
									qg,
									Jc,
									Ly,
									yP,
									wP,
									Sr,
									i0,
									Sr,
									...r,
									Sr,
									vy,
									Ey,
									Sr,
									wy,
									KP,
									Py,
									Ry,
									j5,
									Sy,
									Sr,
									Iy,
									Sr,
									xE,
									vE,
									EE,
									yE,
									Sr,
									Ay,
									ky,
									Sr,
									n0,
									Sr,
									Gm,
									wh,
									Sr,
									SE,
									$y,
									Sr,
									ym,
								])
			);
		};
		handleWheel = Wt((t) => {
			if (
				!(
					t.target instanceof HTMLCanvasElement ||
					t.target instanceof HTMLTextAreaElement ||
					t.target instanceof HTMLIFrameElement
				)
			) {
				t[R.CTRL_OR_CMD] && t.preventDefault();
				return;
			}
			if ((t.preventDefault(), vu)) return;
			let { deltaX: r, deltaY: o } = t;
			if (t.metaKey || t.ctrlKey) {
				let i = Math.sign(o),
					a = Hs * 100,
					s = Math.abs(o),
					c = o;
				s > a && (c = a * i);
				let d = this.state.zoom.value - c / 100;
				(d +=
					Math.log10(Math.max(1, this.state.zoom.value)) *
					-i *
					Math.min(1, s / 20)),
					this.translateCanvas((u) => ({
						...qi(
							{
								viewportX: this.lastViewportPosition.x,
								viewportY: this.lastViewportPosition.y,
								nextZoom: li(d),
							},
							u,
						),
						shouldCacheIgnoreZoom: !0,
					})),
					this.resetShouldCacheIgnoreZoomDebounced();
				return;
			}
			if (t.shiftKey) {
				this.translateCanvas(({ zoom: i, scrollX: a }) => ({
					scrollX: a - (o || r) / i.value,
				}));
				return;
			}
			this.translateCanvas(({ zoom: i, scrollX: a, scrollY: s }) => ({
				scrollX: a - r / i.value,
				scrollY: s - o / i.value,
			}));
		});
		getTextWysiwygSnappedToCenterPosition(t, r, o, i) {
			if (i) {
				let a = i.x + i.width / 2,
					s = i.y + i.height / 2,
					c = Ff(i, o, this.scene.getNonDeletedElementsMap());
				if ((c && ((a = c.x), (s = c.y)), Math.hypot(t - a, r - s) < uT)) {
					let { x: f, y: m } = lo({ sceneX: a, sceneY: s }, o);
					return {
						viewportX: f,
						viewportY: m,
						elementCenterX: a,
						elementCenterY: s,
					};
				}
			}
		}
		savePointer = (t, r, o) => {
			if (!t || !r) return;
			let { x: i, y: a } = Ot({ clientX: t, clientY: r }, this.state);
			isNaN(i) || isNaN(a);
			let s = {
				x: i,
				y: a,
				tool: this.state.activeTool.type === "laser" ? "laser" : "pointer",
			};
			this.props.onPointerUpdate?.({
				pointer: s,
				button: o,
				pointersMap: st.pointers,
			});
		};
		resetShouldCacheIgnoreZoomDebounced = Sl(() => {
			this.unmounted || this.setState({ shouldCacheIgnoreZoom: !1 });
		}, 300);
		updateDOMRect = (t) => {
			if (this.excalidrawContainerRef?.current) {
				let r = this.excalidrawContainerRef.current,
					{ width: o, height: i, left: a, top: s } = r.getBoundingClientRect(),
					{ width: c, height: d, offsetTop: u, offsetLeft: f } = this.state;
				if (o === c && i === d && a === f && s === u) {
					t && t();
					return;
				}
				this.setState(
					{ width: o, height: i, offsetLeft: a, offsetTop: s },
					() => {
						t && t();
					},
				);
			}
		};
		refresh = () => {
			this.setState({ ...this.getCanvasOffsets() });
		};
		getCanvasOffsets() {
			if (this.excalidrawContainerRef?.current) {
				let t = this.excalidrawContainerRef.current,
					{ left: r, top: o } = t.getBoundingClientRect();
				return { offsetLeft: r, offsetTop: o };
			}
			return { offsetLeft: 0, offsetTop: 0 };
		}
		async updateLanguage() {
			let t = Tc.find((r) => r.code === this.props.langCode) || si;
			await Zf(t), this.setAppState({});
		}
		setFontFamily = (t, r, o = !0) => {
			let i = X2[Ri.Excalifont];
			this.fonts.registered.set(t, {
				metadata: i,
				fontFaces: r.map((a) => new Z2(t, a.url, a)),
			}),
				o && Bi.loadAllFonts();
		};
	},
	xU = () => {
		(_.MODE === Bs.TEST || _.DEV) &&
			((window.h = window.h || {}),
			Object.defineProperties(window.h, {
				elements: {
					configurable: !0,
					get() {
						return this.app?.scene.getElementsIncludingDeleted();
					},
					set(e) {
						return this.app?.scene.replaceAllElements(Gi(e));
					},
				},
				scene: {
					configurable: !0,
					get() {
						return this.app?.scene;
					},
				},
			}));
	};
xU();
var oR = dw;
b();
var vU = () => {
		Array.prototype.at ||
			Object.defineProperty(Array.prototype, "at", {
				value: function (e) {
					if (
						((e = Math.trunc(e) || 0),
						e < 0 && (e += this.length),
						!(e < 0 || e >= this.length))
					)
						return this[e];
				},
				writable: !0,
				enumerable: !1,
				configurable: !0,
			}),
			Element.prototype.replaceChildren ||
				(Element.prototype.replaceChildren = function (...e) {
					(this.innerHTML = ""), this.append(...e);
				});
	},
	nR = vU;
b();
var bw = w(M(), 1),
	iR = ({ children: e }) => {
		let { FooterCenterTunnel: t } = Mt(),
			r = mt();
		return (0, bw.jsx)(t.In, {
			children: (0, bw.jsx)("div", {
				className: j("footer-center zen-mode-transition", {
					"layer-ui__wrapper__footer-left--transition-bottom": r.zenModeEnabled,
				}),
				children: e,
			}),
		});
	},
	EU = iR;
iR.displayName = "FooterCenter";
b();
b();
b();
var _n = w(M(), 1),
	yU = () =>
		(0, _n.jsx)("svg", {
			viewBox: "0 0 40 40",
			fill: "none",
			xmlns: "http://www.w3.org/2000/svg",
			className: "ExcalidrawLogo-icon",
			children: (0, _n.jsx)("path", {
				d: "M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",
				fill: "currentColor",
			}),
		}),
	wU = () =>
		(0, _n.jsxs)("svg", {
			viewBox: "0 0 450 55",
			xmlns: "http://www.w3.org/2000/svg",
			fill: "none",
			className: "ExcalidrawLogo-text",
			children: [
				(0, _n.jsx)("path", {
					d: "M429.27 96.74c2.47-1.39 4.78-3.02 6.83-4.95 1.43-1.35 2.73-2.86 3.81-4.51-.66.9-1.4 1.77-2.23 2.59-2.91 2.84-5.72 5.09-8.42 6.87h.01ZM343.6 69.36c.33 3.13.58 6.27.79 9.4.09 1.37.18 2.75.25 4.12-.12-4.46-.27-8.93-.5-13.39-.11-2.08-.24-4.16-.4-6.24-.06 1.79-.11 3.85-.13 6.11h-.01ZM378.47 98.34c.01-.37.07-1.13.01-6.51-.11 1.9-.22 3.81-.31 5.71-.07 1.42-.22 2.91-.16 4.35.39.03.78.07 1.17.1-.92-.85-.76-2.01-.72-3.66l.01.01ZM344.09 86.12c-.09-2.41-.22-4.83-.39-7.24v12.21c.15-.05.32-.09.47-.14.05-1.61-.03-3.23-.09-4.83h.01ZM440.69 66.79c-.22-.34-.45-.67-.69-.99-3.71-4.87-9.91-7.14-15.65-8.55-1.05-.26-2.12-.49-3.18-.71 2.29.59 4.48 1.26 6.64 2.02 7.19 2.54 10.57 5.41 12.88 8.23ZM305.09 72.46l1.2 3.6c.84 2.53 1.67 5.06 2.46 7.61.24.78.5 1.57.73 2.36.22-.04.44-.08.67-.12a776.9 776.9 0 0 1-5.01-13.57c-.02.04-.03.09-.05.13v-.01ZM345.49 90.25v.31c1.48-.42 3.05-.83 4.66-1.2-1.56.25-3.12.52-4.66.89ZM371.02 90.22c0-.57-.04-1.14-.11-1.71-.06-.02-.12-.04-.19-.05-.21-.05-.43-.08-.65-.11.42.16.74.88.95 1.87ZM398.93 54.23c-.13 0-.27-.01-.4-.02l.03.4c.11-.15.23-.27.37-.38ZM401.57 62.28v-.15c-1.22-.24-2.86-.61-3.23-1.25-.09-.15-.18-.51-.27-.98-.09.37-.2.73-.33 1.09 1.24.56 2.52.98 3.83 1.29ZM421.73 88.68c-2.97 1.65-6.28 3.12-9.69 3.68v.18c4.72-.14 11.63-3.85 16.33-8.38-2.04 1.75-4.33 3.24-6.63 4.53l-.01-.01ZM411.28 80.92c-.05-1.2-.09-2.4-.15-3.6-.21 5.66-.46 11.38-.47 14.51.24-.02.48-.04.71-.07.15-3.61.05-7.23-.09-10.83v-.01Z",
					transform: "translate(-144.023 -51.76)",
				}),
				(0, _n.jsx)("path", {
					d: "M425.38 67.41c-3.5-1.45-7.19-2.57-14.06-3.62.09 1.97.06 4.88-.03 8.12.03.04.06.09.06.15.19 1.36.28 2.73.37 4.1.25 3.77.39 7.55.41 11.33 0 1.38-.01 2.76-.07 4.13 1.4-.25 2.78-.65 4.12-1.15 4.07-1.5 7.94-3.78 11.28-6.54 2.33-1.92 5.13-4.49 5.88-7.58.63-3.53-2.45-6.68-7.97-8.96l.01.02ZM411.35 92.53v-.06l-.34.03c.11.01.22.03.34.03ZM314.26 64.06c-.23-.59-.47-1.17-.7-1.75.57 1.62 1.11 3.25 1.6 4.9l.15.54 2.35 6.05c.32.82.66 1.64.98 2.46-1.38-4.1-2.83-8.17-4.39-12.2h.01ZM156.82 103.07c-.18.13-.38.23-.58.33 1.32-.03 2.66-.2 3.93-.34.86-.09 1.72-.22 2.58-.33-2.12.1-4.12.17-5.94.34h.01ZM210.14 68.88s.03.04.05.07c.18-.31.39-.64.58-.96-.21.3-.42.6-.64.89h.01ZM201.65 82.8c-.5.77-1.02 1.56-1.49 2.37 1.11-1.55 2.21-3.1 3.2-4.59-.23.23-.49.51-.75.79-.32.47-.65.95-.96 1.43ZM194.03 98.66c-.33-.4-.65-.84-1.05-1.17-.24-.2-.07-.49.17-.56-.23-.26-.42-.5-.63-.75 1.51-2.55 3.93-5.87 6.4-9.28-.17-.08-.29-.28-.2-.49.04-.09.09-.17.13-.26-1.21 1.78-2.42 3.55-3.61 5.33-.87 1.31-1.74 2.64-2.54 4-.29.5-.63 1.04-.87 1.61.81.65 1.63 1.27 2.47 1.88-.09-.11-.18-.21-.27-.32v.01ZM307.79 82.93c-1-3.17-2.05-6.32-3.1-9.48-1.62 4.08-3.69 9.17-6.16 15.19 3.32-1.04 6.77-1.87 10.27-2.5-.32-1.08-.67-2.15-1.01-3.21ZM149.5 80.7c.05-1.71.04-3.43 0-5.14-.1 2.26-.16 4.51-.22 6.77-.02.73-.03 1.46-.04 2.19.14-1.27.2-2.55.24-3.82h.02ZM228.98 98.3c.39 1.25.91 3.03.94 3.91.06-.03.12-.07.17-.1.08-1.29-.55-2.65-1.11-3.81ZM307.72 53.36c.81.5 1.53 1.04 2.07 1.49-.38-.8-.78-1.58-1.21-2.35-.17.03-.34.06-.51.11-.43.12-.86.26-1.29.41.35-.01.53.1.94.34ZM283.69 96.14c3.91-7.25 6.89-13.35 8.88-18.15l1.1-2.66c-1.27 2.64-2.56 5.27-3.83 7.9-1.53 3.15-3.06 6.31-4.58 9.47-.87 1.81-1.76 3.62-2.54 5.47.04.02.07.04.11.07.05.05.1.09.15.14.05-.73.27-1.48.71-2.24ZM289.92 103.23s-.04.01-.05.03c0-.02.04-.03.05-.04.05-.05.11-.1.16-.15l.21-.21c-.55 0-1.5-.27-2.55-.72.4.26.8.51 1.22.74.24.13.48.26.73.37.05.02.1.03.14.05a.27.27 0 0 1 .08-.07h.01ZM269.23 68.49c-.39-.19-.82-.48-1.33-.87-3.06-1.56-6.31-2.78-9.36-2.35-3.5.49-5.7 1.11-7.74 2.44 5.71-2.6 12.82-2.07 18.44.79l-.01-.01ZM177.87 53.69l1.06.03c-.96-.22-2-.25-2.89-.3-4.95-.26-9.99.33-14.86 1.19-2.44.43-4.88.95-7.28 1.59 9.09-1.76 15.69-2.77 23.97-2.51ZM219.85 55.51c-.18.12-.36.27-.56.45-.45.53-.86 1.11-1.26 1.66-1.91 2.61-3.71 5.31-5.57 7.95l-.12.18 8.05-10.11c-.18-.05-.36-.1-.55-.13h.01ZM510.71 54.1c.12-.15.29-.3.53-.45.69-.4 3.72-.63 5.87-.74-.36-.02-.73-.04-1.09-.05-1.84-.03-3.67.09-5.49.35.05.3.12.59.18.88v.01ZM510.76 86.02c1.37-3.07 2.49-6.27 3.57-9.46.55-1.64 1.12-3.3 1.6-4.97-1.59 4.01-3.67 9.14-6.2 15.3.24-.08.5-.14.74-.22.1-.22.19-.44.29-.65ZM566.95 75.76c.11-.02.23.03.31.11-.05-.13-.09-.26-.14-.39-.05.09-.11.18-.17.28ZM511.33 86.41c3.08-.89 6.24-1.62 9.46-2.14-1.51-3.98-2.98-7.96-4.39-11.87-.05.15-.09.31-.14.46-1.02 3.32-2.15 6.61-3.39 9.85-.48 1.25-.98 2.49-1.53 3.7h-.01ZM578.24 74.45c.11-.44.23-.87.35-1.31-.31.7-.64 1.39-.97 2.08.09.21.19.4.28.61.12-.46.23-.92.35-1.38h-.01ZM520.62 53.11c-.09 0-.18-.01-.28-.02.38.34.29 1.08.93 2.53l6.65 17.15c2.2 5.68 4.69 11.36 7.41 16.87l1.06 2.17c-2.95-7.05-5.92-14.08-8.87-21.13-1.58-3.79-3.16-7.59-4.7-11.4-.78-1.92-1.73-3.89-2.25-5.91-.03-.1 0-.19.04-.26h.01ZM578.78 77.87c1.45-5.77 3.07-10.43 3.58-13.36.05-.34.16-.88.31-1.55-.67 1.79-1.37 3.56-2.08 5.33-.12.43-.23.86-.35 1.29-.65 2.43-1.29 4.86-1.9 7.3.14.33.29.65.43 1l.01-.01ZM545.3 94.66c.02-.44.03-.83.05-1.12.02-1.01.05-2.02.11-3.02.03-6.66-.46-14.33-1.46-22.8-.13-.42-.27-1.24-.56-2.89 0-.02 0-.04-.01-.06.62 6.61.95 13.25 1.32 19.87.17 3.08.33 6.16.52 9.23.02.25.03.52.04.78l-.01.01ZM580.77 102.81c.13.2.27.38.37.49.27-.11.53-.22.8-.32-.43.09-.82.05-1.17-.16v-.01ZM530.48 104.07h.33c-.36-.13-.71-.32-1.04-.56.14.24.3.47.45.7.06-.08.14-.13.26-.13v-.01ZM542.63 58.82c.06.23.11.47.15.71.14-.33.36-.62.7-.86-.28.05-.57.11-.85.15ZM583.81 57.87c.15-.7.29-1.41.42-2.11-.14.45-.28.9-.42 1.34-.46 1.44-.89 2.89-1.31 4.34.44-1.19.88-2.37 1.31-3.57ZM523.62 91.48c-4.66 1.17-9.05 2.89-14.02 5.27 4.65-1.84 9.48-3.29 14.28-4.63-.09-.22-.17-.41-.26-.64ZM460.64 78.3c-.04-2.9-.11-5.81-.28-8.71-.1-1.68-.17-3.43-.5-5.09-.07.02-.14.03-.2.05.3 6.54.45 12.17.51 17.12.17-.07.34-.14.51-.2 0-1.06-.01-2.11-.03-3.17h-.01ZM470.63 63.24c-3.38-.26-6.81.32-10.1 1.1.41 2.01.47 4.14.57 6.18.18 3.55.25 7.11.27 10.67 3.31-1.38 6.5-3.12 9.3-5.35 1.96-1.56 3.86-3.41 5.02-5.66.73-1.41 1.19-3.22.26-4.65-1.09-1.7-3.46-2.14-5.32-2.29ZM460.29 63.68c1-.24 2.01-.46 3.04-.65-1.15.16-2.37.38-3.71.69v.13c.07-.02.15-.04.22-.05.11-.13.3-.18.45-.11v-.01ZM457.24 100.96c.43-.03.86-.07 1.29-.11.14-.49.27-.99.38-1.49-.44.7-1 1.23-1.67 1.6ZM482.88 104.98c-.18.23-.36.38-.55.47.14.09.27.19.4.28a70.76 70.76 0 0 0 4.37-4.63c.76-.89 1.52-1.81 2.19-2.77-.3-.27-.61-.53-.92-.79-.07 1.94-4.62 6.32-5.49 7.45v-.01Z",
					transform: "translate(-144.023 -51.76)",
				}),
				(0, _n.jsx)("path", {
					d: "M474.36 63.31c-.4-.16-.84-.27-1.29-.37 1.56.42 3.08 1.22 3.76 2.74.62 1.4.32 2.95-.28 4.32.7-1.22.94-2.34.74-3.47-.24-1.33-1.19-2.54-2.93-3.21v-.01ZM477.34 89.18c-1.2-.81-2.4-1.62-3.6-2.42-.14.1-.26.19-.4.29 1.4.67 2.73 1.39 4 2.13ZM465.88 93.85c.37.25.74.5 1.1.75.46.32.92.65 1.38.97-1.57-1.2-2.01-1.61-2.49-1.72h.01ZM574.92 90.06c-2.28-5.21-4.93-11.13-5.67-12.26-.1-.15-1.57-3.01-1.63-3.08 0 0-.01.02-.02.02.4 1.37 1.09 2.69 1.65 3.99 2.14 4.95 4.36 9.86 6.67 14.73.6 1.26 1.21 2.52 1.83 3.78-.75-2.01-1.64-4.45-2.83-7.18ZM448.73 65.29c.1.2.22.38.34.57.22-.02.43-.06.65-.08v-.08c-.14-.05-.25 0-.99-.41ZM460.16 94.81c-.02.31-.06.59-.1.89-.03 1.71-.33 3.43-.79 5.07.15-.02.3-.03.45-.05.01-.04.02-.08.03-.11.09-.34.15-.69.2-1.03.17-1.07.25-2.16.33-3.24.05-.69.08-1.39.12-2.08-.27.1-.27.26-.24.57v-.02Z",
					transform: "translate(-144.023 -51.76)",
				}),
				(0, _n.jsx)("path", {
					d: "m328.67 98.12-3.22-6.58c-1.29-2.63-2.53-5.29-3.72-7.97-.25-.85-.52-1.69-.79-2.53-.81-2.57-1.67-5.12-2.55-7.67-1.92-5.53-3.9-11.08-6.32-16.41-.72-1.58-1.46-3.44-2.63-4.79-.03-.17-.16-.29-.34-.36a.282.282 0 0 0-.23-.04c-.06-.01-.12 0-.18.01-.74.06-1.5.38-2.19.61-2.22.77-4.4 1.64-6.63 2.38-.03-.08-.06-.16-.09-.25-.15-.42-.82-.24-.67.19.03.09.07.19.1.28l-.18.06c-.36.11-.28.6 0 .68.18 1.18.63 2.36.98 3.49.03.09.06.17.08.26-.08.23-.17.46-.24.64-.37.98-.79 1.94-1.21 2.9-1.27 2.89-2.62 5.75-3.98 8.6-3.18 6.67-6.44 13.31-9.64 19.97-1.08 2.25-2.2 4.5-3.15 6.81-.13.32.24.5.5.37 1.34 1.33 2.84 2.5 4.4 3.57.65.44 1.31.87 2.01 1.24.4.22.86.48 1.33.5.24.01.35-.19.33-.37.11-.1.21-.21.28-.28.41-.41.81-.84 1.2-1.26.85-.92 1.69-1.87 2.5-2.84 6.31-2.34 12.6-4.31 18.71-5.84 2.14 5.3 3.43 8.43 3.97 9.58.55 1.05 1.15 1.88 1.82 2.52 1.32.56 6.96-.03 9.23-1.96.87-1.28 1.19-2.67.93-4.15-.09-.5-.22-.95-.4-1.33l-.01-.03Zm-20.09-45.61c.43.77.83 1.56 1.21 2.35-.54-.45-1.27-.99-2.07-1.49-.42-.24-.6-.35-.94-.34.43-.15.85-.29 1.29-.41.17-.05.34-.08.51-.11Zm-25.86 45.66c.78-1.85 1.67-3.66 2.54-5.47 1.51-3.16 3.05-6.31 4.58-9.47 1.28-2.63 2.56-5.26 3.83-7.9l-1.1 2.66c-1.99 4.79-4.97 10.9-8.88 18.15-.43.76-.66 1.51-.71 2.24-.05-.05-.1-.09-.15-.14a.259.259 0 0 0-.11-.07Zm6.24 4.71c-.42-.23-.82-.48-1.22-.74 1.05.45 2 .72 2.55.72l-.21.21c-.05.05-.11.1-.16.15-.01.01-.04.03-.05.04 0-.02.03-.02.05-.03a.27.27 0 0 0-.08.07c-.05-.02-.1-.03-.14-.05-.25-.1-.49-.24-.73-.37h-.01Zm15.73-29.43c1.05 3.15 2.1 6.31 3.1 9.48.34 1.06.69 2.13 1.01 3.21-3.5.63-6.95 1.46-10.27 2.5 2.48-6.03 4.54-11.11 6.16-15.19Zm4.79 12.57c-.23-.79-.49-1.58-.73-2.36-.79-2.54-1.63-5.08-2.46-7.61l-1.2-3.6c.02-.04.04-.09.05-.13 1.6 4.45 3.28 9 5.01 13.57l-.67.12v.01Zm5.83-18.27-.15-.54c-.49-1.64-1.03-3.28-1.6-4.9.23.58.47 1.17.7 1.75 1.56 4.03 3.01 8.1 4.39 12.2-.33-.82-.67-1.64-.98-2.46l-2.35-6.05h-.01ZM390.43 79.37c-.13-10.43-.22-17.5-.24-19.97-.24-1.6.21-2.88-.65-3.65-.14-.13-.32-.23-.52-.32h.03c.45 0 .45-.69 0-.7-1.75-.03-3.5-.04-5.25-.14-1.38-.08-2.76-.21-4.15-.31-.07 0-.12.01-.17.04-.21-.07-.47.03-.45.31l.03.45c-.11.14-.19.3-.22.5-.21 1.26-.32 13.67-.36 23.59-.32 5.79-.67 11.57-.97 17.36-.09 1.73-.29 3.54-.21 5.3-.39.02-.38.64.04.69v.12c.05.44.74.45.7 0v-.06c1.1.09 2.2.21 3.3.3 1.14.19 2.44.2 3.29.17 1.73-.05 2.92-.05 3.8-.37.45-.05.9-.11 1.35-.17.44-.06.25-.73-.19-.67h-.01c.24-.32.45-.72.62-1.25.66-1.84.41-6.36.34-11.33l-.13-9.9.02.01Zm-12.26 18.17c.09-1.91.2-3.81.31-5.71.06 5.38 0 6.14-.01 6.51-.05 1.65-.21 2.81.72 3.66-.39-.04-.78-.07-1.17-.1-.06-1.44.09-2.93.16-4.35l-.01-.01ZM588.97 53.85c-2.06-.25-3.17-.51-3.76-.6a.3.3 0 0 1 .04-.08c.22-.39-.39-.75-.6-.35-.56 1.02-.9 2.19-1.26 3.29-.61 1.88-1.17 3.78-1.72 5.68-.63 2.19-1.24 4.39-1.83 6.59-.81 2.03-1.67 4.05-2.61 6.03-1.7-3.64-3.11-6.04-4.03-7.57-2.26-3.74-2.85-5.48-3.57-6.08l.31-.09c.43-.12.25-.8-.19-.67-1.06.3-2.12.6-3.17.95-.93.32-1.85.69-2.76 1.07-.13.05-.19.16-.22.27-.04.02-.08.05-.11.07-.04-.06-.07-.12-.11-.18a.354.354 0 0 0-.48-.12c-.16.09-.22.32-.13.48l.33.54c0 .09.02.18.06.28.51 1.16.78 1.38.72 1.47-2.42 3.44-5.41 7.86-6.2 9.1-1.27 1.97-2.01 3.14-2.45 3.84l-.91-6.56-.43-4.1c-.19-1.85-.37-3.23-.53-4.13-.19-1.1-.3-2.15-.45-3.16-.2-1.36-.29-2.06-.47-2.42h.04c.45.02.45-.68 0-.7-3.43-.16-6.81.94-10.17 1.48-.24-.22-.73-.04-.58.32.24.59.33 1.25.43 1.87.17 1.06.29 2.13.4 3.2.32 3.09.53 6.2.74 9.3.44 6.75.77 13.51 1.17 20.26.11 1.95.13 3.96.46 5.89.05.3.37.31.55.14.74 1.71 2.87 1.27 6.13 1.27 1.34 0 2.39.04 2.99-.11.02.32.48.53.63.18 3.61-8.26 7.41-16.46 12.05-24.2.03-.05.04-.1.05-.15.3.73.64 1.45.94 2.16.97 2.26 1.97 4.52 2.98 6.76 2.26 5.03 4.54 10.07 7.09 14.96.47.9.94 1.79 1.47 2.65.2.32.4.67.66.96-.18.25 0 .68.34.54.91-.38 1.82-.75 2.76-1.07 1.04-.35 2.11-.65 3.17-.95.39-.11.28-.66-.07-.68.62-.4.95-.96.87-1.91-.3-3.34.72-7.47.86-8.52l2.14-11.43c1.75-10.74 3.13-17.51 3.23-20.86.02-.49.08-2.84.13-3.24.17-1.25.48-1-4.96-1.65l.03-.02Zm-46.19 5.67c-.04-.24-.09-.48-.15-.71l.85-.15c-.34.24-.56.53-.7.86Zm1.95 25.12c-.36-6.63-.7-13.26-1.32-19.87 0 .02 0 .04.01.06.29 1.65.44 2.47.56 2.89 1 8.46 1.5 16.14 1.46 22.8-.06.99-.1 2-.11 3.02-.01.29-.03.68-.05 1.12-.01-.26-.03-.53-.04-.78-.19-3.08-.35-6.16-.52-9.23l.01-.01Zm36.4 18.66c-.11-.11-.24-.29-.37-.49.35.21.74.26 1.17.16-.27.11-.53.22-.8.32v.01Zm-.89-33.72c.12-.43.23-.86.35-1.29.71-1.77 1.41-3.55 2.08-5.33-.15.68-.26 1.22-.31 1.55-.5 2.94-2.13 7.59-3.58 13.36-.15-.35-.29-.66-.43-1 .61-2.44 1.25-4.87 1.9-7.3l-.01.01Zm3.56-12.48c.14-.44.28-.89.42-1.34-.13.7-.27 1.41-.42 2.11-.43 1.19-.86 2.38-1.31 3.57.42-1.45.85-2.9 1.31-4.34Zm-5.22 16.05c-.11.44-.23.87-.35 1.31-.12.46-.23.92-.35 1.38-.1-.22-.19-.4-.28-.61.34-.69.66-1.38.97-2.08h.01Zm-11.64 2.62c.06-.1.12-.19.17-.28.05.13.09.26.14.39a.398.398 0 0 0-.31-.11Zm2.3 2.98c-.56-1.3-1.25-2.63-1.65-3.99 0 0 .01-.02.02-.02.06.08 1.52 2.93 1.63 3.08.73 1.13 3.38 7.04 5.67 12.26 1.2 2.73 2.08 5.17 2.83 7.18-.62-1.25-1.23-2.51-1.83-3.78-2.31-4.87-4.53-9.78-6.67-14.73ZM275.92 87.03c-1.06-2.18-1.13-3.45-2.44-2.93-1.52.57-2.94 1.3-4.5 2.1-1.4.72-2.68 1.44-3.92 2.12.01-.25-.24-.5-.51-.34-4.8 2.93-12.41 4.7-17.28 1.31-1.98-1.77-3.32-4.15-3.97-5.78-.29-.95-.49-1.94-.63-2.93-.14-3.34 1.58-6.53 3.9-9.12.8-.79 1.68-1.51 2.66-2.12 3.7-2.3 8.22-3.07 12.51-2.51 2.71.35 5.32 1.24 7.71 2.55.39.22.75-.39.35-.6-.18-.1-.37-.18-.55-.27.56.27 1.03.33 1.51.19l-.48.39c-.15.11-.23.3-.13.48.09.15.33.24.48.13 1.3-.97 2.46-2.09 3.45-3.37.37-.29.64-.6.65-.97v-.02c.08-.33-.03-.7-.21-1.08-.31-.87-.98-2.01-2.19-3.26-2.43-2.52-3.79-3.45-5.68-4.26-1.14-.49-3.12-1.06-4.42-1.23-3.28-.42-10.64-1.21-18.18 4.11-7.74 5.46-11.94 12.3-12.23 20.61-.08 2.06.04 3.98.34 5.71.74 4.18 2.57 8 5.44 11.34 4.26 4.99 9.76 7.52 16.34 7.52 4.85 0 9.69-1.77 14.89-4.62.23-.12.45-.23.68-.35 2.19-1.1 4.37-2.23 6.46-3.5.49-.3 1.03-.61 1.5-.98 1.47-.87 1.11-1.12.49-2.95-.39-1.14-.76-2.7-2.06-5.36l.02-.01Zm-17.38-21.76c3.05-.42 6.31.79 9.36 2.35.51.39.94.68 1.33.87-5.61-2.86-12.72-3.39-18.44-.79 2.05-1.33 4.24-1.95 7.74-2.44l.01.01ZM443.67 72.67c-.4-2.2-1.15-4.33-2.37-6.22-1.49-2.32-3.58-4.19-5.91-5.64-6.17-3.81-13.75-5.11-20.83-6.01-3.23-.41-6.47-.69-9.72-.92l-1.39-.12c-.85-.07-1.52-.1-2.05-.1-1.08-.06-2.17-.12-3.25-.17-.08 0-.14.02-.19.05-.1.05-.18.14-.16.3.27 2.55-.01 5.12-.92 7.52-.15.38.4.56.62.28 1.32.59 2.68 1.05 4.08 1.37 0 2.78-.14 7.58-.33 12.91 0 0 0 .02-.01.03-.61 3.66-.79 7.42-1 11.12-.23 4.01-.43 8.03-.44 12.05 0 .64 0 1.28.03 1.93.02.31 0 .68.15.96.06.11.14.16.24.17-.2.17-.21.54.11.59 3.83.67 7.78.71 11.68.25 2.3-.19 4.87-.65 7.65-1.56 1.85-.54 3.67-1.18 5.43-1.91 7.2-3.02 14.31-8.07 17.35-15.53.76-1.86 1.17-3.8 1.31-5.75.3-1.93.28-3.82-.09-5.58l.01-.02Zm-19.32-15.42c5.74 1.41 11.94 3.68 15.65 8.55.25.32.47.65.69.99-2.3-2.82-5.68-5.69-12.88-8.23-2.16-.76-4.35-1.43-6.64-2.02 1.06.21 2.13.45 3.18.71Zm-25.82-3.04c.13 0 .27.01.4.02-.14.1-.26.23-.37.38 0-.13-.02-.26-.03-.4Zm34.82 22.17c-.75 3.09-3.55 5.66-5.88 7.58-3.35 2.76-7.21 5.03-11.28 6.54-1.33.49-2.71.9-4.12 1.15.06-1.38.08-2.76.07-4.13-.02-3.78-.16-7.56-.41-11.33-.09-1.37-.18-2.74-.37-4.1 0-.06-.03-.11-.06-.15.09-3.25.12-6.16.03-8.12 6.86 1.05 10.56 2.17 14.06 3.62 5.52 2.28 8.59 5.44 7.97 8.96l-.01-.02Zm-22 16.15c-.12 0-.23-.02-.34-.03l.34-.03v.06Zm-.69-.7c0-3.13.26-8.84.47-14.51.06 1.2.11 2.41.15 3.6.15 3.6.25 7.23.09 10.83-.24.03-.48.05-.71.07v.01Zm-12.33-30.94c.37.63 2.01 1.01 3.23 1.25v.15c-1.31-.31-2.59-.73-3.83-1.29.12-.36.23-.72.33-1.09.08.48.18.84.27.98Zm13.7 31.65v-.18c3.41-.56 6.71-2.02 9.69-3.68 2.31-1.28 4.59-2.78 6.63-4.53-4.69 4.53-11.61 8.24-16.33 8.38l.01.01Zm24.07-.75c-2.05 1.93-4.37 3.56-6.83 4.95 2.7-1.78 5.52-4.03 8.42-6.87.82-.82 1.56-1.69 2.23-2.59-1.08 1.65-2.38 3.16-3.81 4.51h-.01ZM187.16 92.14c-.79-2.47-2.1-7.12-3.1-6.87-.19-.01-2.09.77-4.08 1.54-3.06 1.18-5.91 2.13-10.09 2.82-2.74.42-5.87 1.01-10.61 1.06.04-3.34.05-6.01.05-7.99 7.97-.65 12.33-2.11 16.37-3.55 1.11-.39 2.69-1.01 2.63-1.8-.08-.35-.55-1.39-1.17-2.61-.47-1.16-.98-2.31-1.61-3.38-.42-.71-1.04-1.69-1.86-2.06-.11-.08-.22-.13-.29-.12-.02 0-.04 0-.07.01-.19-.04-.39-.05-.6-.01-.17.03-.24.15-.25.28-.04.02-.09.04-.14.05-4.33 1.48-8.85 2.33-13.24 3.61a499.1 499.1 0 0 0-.31-8.19c4.51-.99 8.88-1.38 13.11-1.82 3.68-.38 6.28.12 7.47.34.59.11.9.16 1.16.18h.1c-.1.37.44.66.62.28.02-.04.03-.08.05-.13.15.2.53.22.62-.1.17-.58.19-1.21.21-1.81v-.36c.03-.15.05-.3.07-.45.52-2.47.33-5.09-.64-7.44-.11-.27-.44-.28-.6-.14-.08-.21-.15-.42-.24-.62-.19-.41-.79-.05-.6.35.03.07.05.15.09.22-.98-.42-2.15-.54-3.17-.63-2.17-.19-4.37-.14-6.54 0-5.7.35-11.4 1.3-16.91 2.79-2.08.56-4.13 1.22-6.14 2-4.54 1.05-3.79 1.51-2.17 6.07.18.51.46 1.68.54 1.94.82 2.47 1.08 2.13 3.1 2.13s0 .05 0 .08h.52c-.48 2.66-.51 5.45-.62 8.13-.15 3.48-.22 6.96-.28 10.45 0 .41-.01.82-.02 1.23-.16.29-.33.57-.51.85-.05.38-.09.77-.14 1.18-.42 3.52-.59 6.48-.52 8.8v.34c.02.47.05.76.06.87.16 1.57-.26 3.47 1.35 3.79 1.61.32 3.5.55 4.85.55.11 0 .22-.02.33-.02 1.79.24 3.67.05 5.45-.12 2.85-.28 5.69-.7 8.51-1.19 3.03-.53 6.05-1.14 9.04-1.86 2.4-.58 4.82-1.19 7.13-2.06.51-.19 1.73-.57 2.46-1.14 1.81-.68 2.18-1 1.57-2.67-.23-.62-.48-1.49-.91-2.78l-.03-.02Zm-11.12-38.71c.89.05 1.93.08 2.89.3-.33 0-.68-.02-1.06-.03-8.28-.26-14.88.75-23.97 2.51 2.41-.64 4.85-1.16 7.28-1.59 4.87-.86 9.91-1.45 14.86-1.19Zm-26.53 22.13c.03 1.71.04 3.43 0 5.14-.04 1.27-.11 2.55-.24 3.82 0-.73.02-1.46.04-2.19.05-2.26.12-4.51.22-6.77h-.02Zm6.73 27.85c.2-.1.4-.21.58-.33 1.82-.17 3.82-.24 5.94-.34-.86.11-1.72.24-2.58.33-1.27.14-2.61.31-3.93.34h-.01ZM534.48 85.44c-3.52-8.38-7.07-16.75-10.5-25.17-.63-1.54-1.25-3.09-1.86-4.65-.31-.8-.65-1.6-.87-2.43-.04-.17-.17-.24-.31-.25.1-.2 0-.51-.29-.53-1.59-.08-3.18-.22-4.78-.25-1.96-.03-3.91.13-5.84.42-.31.05-.31.38-.13.56-.03.06-.05.14-.04.22.23 1.54.63 3.06 1.16 4.53.13.35.27.7.41 1.06l-2.68 6.18c-.11.03-.2.09-.25.22-.67 1.9-1.52 3.73-2.34 5.56a536.85 536.85 0 0 1-3.9 8.45c-2.64 5.64-5.34 11.25-7.91 16.93-.44.97-.88 1.94-1.29 2.93-.2.48-.47 1-.55 1.52v.05c-.02.12.02.26.16.34 1.19.73 2.41 1.41 3.66 2.05 1.2.62 2.45 1.25 3.76 1.61.43.12.62-.55.19-.67-1.13-.31-2.2-.83-3.24-1.36 1.09.36 2.1.69 2.75.93 2.82 1.01 2.38 1.1 4.3-3.75 2.1-1.09 4.34-1.96 6.53-2.79 4.35-1.64 8.8-3.03 13.27-4.29.82 2.01 1.77 3.97 2.72 5.92.35.83.62 1.45.79 1.82.22.42.45.8.69 1.15.17.33.33.67.5 1 .42.8.84 1.63 1.4 2.35.23.29.6 0 .55-.31 1.53-.02 3.06-.07 4.58-.27.92-.12 1.82-.32 2.71-.54 1.39-.27 3.85-1.11 3.74-1.42-.67-1.96-1.55-3.87-2.34-5.78-1.57-3.78-3.16-7.56-4.75-11.33v-.01Zm-11.65-26.16c1.54 3.81 3.12 7.6 4.7 11.4 2.94 7.05 5.91 14.09 8.87 21.13l-1.06-2.17c-2.71-5.51-5.2-11.19-7.41-16.87l-6.65-17.15c-.65-1.45-.55-2.19-.93-2.53.09 0 .18.01.28.02a.29.29 0 0 0-.04.26c.52 2.02 1.47 3.98 2.25 5.91h-.01Zm-6.58 13.58c.05-.15.09-.31.14-.46 1.41 3.92 2.88 7.9 4.39 11.87-3.22.52-6.38 1.25-9.46 2.14.55-1.22 1.05-2.46 1.53-3.7 1.24-3.24 2.37-6.53 3.39-9.85h.01Zm-.23-20c.36 0 .73.03 1.09.05-2.15.1-5.18.33-5.87.74-.24.15-.41.3-.53.45-.06-.29-.13-.58-.18-.88 1.82-.26 3.65-.39 5.49-.35v-.01Zm-.09 18.72c-.49 1.67-1.05 3.33-1.6 4.97-1.07 3.19-2.19 6.38-3.57 9.46-.09.21-.19.43-.29.65-.25.07-.5.14-.74.22 2.53-6.16 4.61-11.29 6.2-15.3Zm-6.34 25.16c4.97-2.38 9.37-4.1 14.02-5.27l.26.64c-4.8 1.35-9.63 2.8-14.28 4.63Zm20.17 6.76c.33.23.68.42 1.04.56h-.33c-.12 0-.21.06-.26.13-.15-.23-.31-.45-.45-.7v.01ZM226.57 91.75c-3.55-4.74-6.68-9.11-9.31-12.99 9.2-15.25 10.05-17.81 10.35-18.38.17-.34 1.09-2.27.64-2.53-1.13-.65-1.03-.65-2.97-1.71-1.19-.65-3.04-1.61-4.53-2.12-1.71-.59-1.24-.36-3 2.77-.06.1-.11.2-.17.3-.75 1.02-1.48 2.05-2.2 3.09-1.88 2.71-3.73 5.45-5.69 8.1-3.68-4.91-6.88-8.76-9.51-11.43-.15-.15-.3-.29-.46-.42-1.27-1.28-7.24 3.53-7.93 5.58-.09.09-.19.16-.28.25-.27.26.03.64.33.58.19.65.5 1.29.94 1.91 3.85 5.06 7.19 9.76 9.94 14-1.23 2.61-3.06 5-4.67 7.38l-2.28 3.33c-.5.66-.93 1.23-1.29 1.69-.67.93-2.09 2.61-2.3 3.87-.51.85-1.16 1.84-1.29 2.83-.06.44.61.63.67.19.01-.08.04-.15.06-.22 1.36 1.08 2.76 2.11 4.19 3.11 1.3.91 2.62 1.85 4.04 2.56.21.1.4 0 .48-.17.24.07.48.14.72.2.44.1.62-.57.19-.67-2.02-.48-3.77-1.57-5.23-3.02-.47-.46-.9-.96-1.32-1.46 1.74 1.35 4.2 2.89 5.89 4.14 1.39 1.03 2.85-2.27 4.22-4.2 1.86-2.64 3.96-5.86 5.52-8.29l10.39 14.51c.67.81 1.14 1.21 1.57 1.36-.05.24.12.51.41.4 1.53-.58 3.05-1.19 4.54-1.87 1.52-.69 3.06-1.45 4.36-2.5a.28.28 0 0 0 .12-.23c1.66-1.1.81-1.74-1.41-4.91-1.13-1.58-1.71-2.36-3.7-5.01l-.03-.02Zm2.41 6.54c.56 1.15 1.19 2.52 1.11 3.81-.06.04-.12.07-.17.1-.03-.88-.55-2.66-.94-3.91Zm-16.51-32.73c1.86-2.65 3.65-5.35 5.57-7.95.4-.55.81-1.13 1.26-1.66.19-.18.38-.33.56-.45.18.03.36.08.55.13l-8.05 10.11.12-.18h-.01ZM192.7 95.48c.79-1.37 1.66-2.69 2.54-4 1.19-1.79 2.4-3.56 3.61-5.33-.04.09-.09.17-.13.26-.1.22.03.41.2.49-2.47 3.42-4.89 6.73-6.4 9.28.21.24.4.48.63.75-.24.07-.4.36-.17.56.4.33.72.77 1.05 1.17.09.11.18.21.27.32-.84-.61-1.66-1.24-2.47-1.88.24-.57.58-1.11.87-1.61v-.01Zm7.46-10.32c.47-.81.98-1.59 1.49-2.37.31-.48.64-.95.96-1.43.26-.29.52-.56.75-.79-.99 1.48-2.09 3.03-3.2 4.59Zm10.03-16.22s-.03-.05-.05-.07c.22-.29.43-.59.64-.89-.2.32-.4.65-.58.96h-.01ZM371.54 87.96c-.01-.08-.01-.16-.03-.23-.06-.38-.58-.29-.66.03-.3-.05-.6-.08-.81-.11-1.14-.15-2.29-.19-3.44-.2 1.04-.09 2.09-.18 3.14-.23.45-.02.45-.72 0-.7-6.57.35-13.14 1.23-19.65 2.11-1.53.21-3.05.42-4.57.68-.01 0-.02.01-.04.01-.04-3.33-.13-6.66-.24-9.99-.19-5.7-.4-11.41-.88-17.1-.13-1.51-.23-3.07-.49-4.58 0-.25 0-.48-.02-.68-.06-1.19-.04-2.61-.68-2.78-.16-.07-.72-.16-1.5-.24.22-.17.16-.62-.2-.63-1.19-.04-2.39.09-3.57.23-1.2.14-2.41.32-3.59.6-.16-.1-.41-.06-.5.12-.06.02-.13.03-.19.05-.35.1-.29.55-.03.66-.26.6-.19 2.27-.21 3-.02.66-.66 33.73-.9 40.3-.03.65.06 1.12.04 1.45-.16 3.05.87 4.96 6.34 3.93 1.09-.08 2.75-.77 5.36-1.43 4.13-1.04 5.78-1.52 6.2-1.65 6.43-1.69 6.78-1.97 11.72-2.43.55-.05 4.8-.38 6.03-.3.64.04 1.19.07 1.65.1.09 0 .16-.03.24-.05.1.27.56.33.66-.02.39-1.32.61-2.71.78-4.08.2-1.61.29-3.24.15-4.86.24.03.52-.23.38-.53-.09-.2-.27-.33-.49-.43v-.02Zm-.63.56c.07.57.11 1.14.11 1.71-.21-.99-.53-1.71-.95-1.87.22.03.44.06.65.11.06.01.12.04.19.05Zm-25.41 1.73c1.54-.36 3.1-.64 4.66-.89-1.61.37-3.18.77-4.66 1.2v-.31Zm-.86-7.37c-.07-1.37-.16-2.75-.25-4.12-.21-3.13-.45-6.27-.79-9.4.02-2.25.08-4.31.13-6.11.16 2.08.29 4.16.4 6.24.23 4.46.38 8.93.5 13.39h.01Zm-.94-4c.16 2.41.29 4.83.39 7.24.06 1.6.14 3.22.09 4.83-.15.05-.32.09-.47.14V78.88h-.01ZM483.72 92.83c-3.05-2.28-6.22-4.4-9.38-6.51 8.86-6.49 13.49-12.95 13.73-19.23.04-.76 0-1.5-.13-2.2-.67-3.82-3.5-6.68-8.39-8.48.13.04.27.08.4.13 3.92 1.39 7.74 4.23 8.5 8.56.34 1.95-.05 3.96-.98 5.69-.21.4.39.75.6.35 1.86-3.46 1.46-7.55-.97-10.63-3.53-4.47-9.76-5.88-15.16-6.16-2.32-.12-4.64-.04-6.95.19-6 .32-12.71 1.68-17.63 3.21-.37.11-.67.23-.92.35-.2-.17-.62.02-.57.37v.03c-.64.68-.18 1.64.48 3.21.38.91.67 1.89 1.15 2.58.32.76.68 1.51 1.13 2.19.14.21.38.19.53.07.19-.02.38-.05.57-.08v1.57c-.06.06-.1.13-.11.23-.27 4.18-.34 8.38-.48 12.57l-.3 9.03c-.24 3.91-.44 6.77-.46 7.26-.05.88-.11 1.95.07 2.81-.01.22-.02.43-.04.65 0 .11-.02.23-.03.35 0 .05-.03.27-.01.16-.05.4.5.59.64.28.05.04.12.08.2.08 1.75.13 3.5.28 5.25.3 1.69.02 3.38-.12 5.06-.32.08.23.36.39.55.15.06-.08.11-.17.16-.26.18-.09.24-.32.18-.48.05-.2.1-.4.13-.6.16-.86.25-1.74.33-2.62.11-1.17.17-2.34.23-3.51.15-.01.32-.03.52-.04.36-.03 1.73-.15 2.06-.15.39 0 .7-.02.95-.04 1.76 1.11 3.45 2.35 5.14 3.55 2.83 2.01 5.64 4.04 8.47 6.04 1.42 1 2.85 2 4.29 2.97.1.06.19.07.27.04.08 0 .17-.02.25-.1 1.61-1.56 3.15-3.18 4.6-4.88.75-.88 1.49-1.78 2.15-2.73.01.01.03.02.04.03.34.3.83-.2.49-.49-2.16-1.9-4.34-3.76-6.64-5.48l.03-.01Zm-6.38-3.65a55.72 55.72 0 0 0-4-2.13c.14-.1.26-.19.4-.29 1.2.81 2.4 1.61 3.6 2.42Zm-20.1 11.78c.67-.37 1.23-.91 1.67-1.6-.11.5-.24 1-.38 1.49-.43.04-.86.08-1.29.11Zm2.38-37.24c1.34-.31 2.56-.52 3.71-.69-1.03.19-2.04.41-3.04.65-.14-.07-.34-.02-.45.11-.07.02-.15.04-.22.05v-.13.01Zm.04.84c.07-.02.14-.03.2-.05.34 1.66.41 3.41.5 5.09.17 2.9.24 5.81.28 8.71l.03 3.17c-.17.07-.34.14-.51.2-.06-4.96-.21-10.58-.51-17.12h.01Zm16.04 5.62c-1.16 2.25-3.06 4.1-5.02 5.66-2.8 2.23-5.99 3.97-9.3 5.35-.01-3.56-.09-7.12-.27-10.67-.1-2.04-.16-4.16-.57-6.18 3.3-.78 6.72-1.36 10.1-1.1 1.85.14 4.23.59 5.32 2.29.92 1.43.46 3.24-.26 4.65Zm.85-.18c.6-1.37.9-2.92.28-4.32-.67-1.52-2.2-2.32-3.76-2.74.46.1.89.21 1.29.37 1.74.67 2.69 1.88 2.93 3.21.2 1.13-.05 2.25-.74 3.47V70Zm-27.47-4.14c-.12-.19-.23-.38-.34-.57.74.42.85.36.99.41v.08c-.22.03-.43.06-.65.08Zm11.21 30.46c-.08 1.08-.16 2.17-.33 3.24-.05.35-.11.69-.2 1.03 0 .04-.02.07-.03.11-.15.02-.3.04-.45.05.45-1.64.76-3.36.79-5.07.03-.29.08-.57.1-.89-.03-.31-.03-.47.24-.57-.04.69-.07 1.39-.12 2.08v.02Zm5.6-2.47c.48.11.92.52 2.49 1.72-.46-.32-.92-.65-1.38-.97-.37-.25-.73-.5-1.1-.75h-.01Zm21.23 7.24a70.76 70.76 0 0 1-4.37 4.63c-.14-.09-.27-.19-.4-.28.19-.09.37-.24.55-.47.87-1.14 5.43-5.51 5.49-7.45.31.26.62.53.92.79-.67.97-1.42 1.88-2.19 2.77v.01Z",
					fill: "currentColor",
					transform: "translate(-144.023 -51.76)",
				}),
			],
		}),
	aR = ({ style: e, size: t = "small", withText: r }) =>
		(0, _n.jsxs)("div", {
			className: `ExcalidrawLogo is-${t}`,
			style: e,
			children: [(0, _n.jsx)(yU, {}), r && (0, _n.jsx)(wU, {})],
		});
var wt = w(M(), 1),
	xw = ({ icon: e, shortcut: t, children: r }) => {
		let o = et();
		return (0, wt.jsxs)(wt.Fragment, {
			children: [
				(0, wt.jsx)("div", {
					className: "welcome-screen-menu-item__icon",
					children: e,
				}),
				(0, wt.jsx)("div", {
					className: "welcome-screen-menu-item__text",
					children: r,
				}),
				t &&
					!o.editor.isMobile &&
					(0, wt.jsx)("div", {
						className: "welcome-screen-menu-item__shortcut",
						children: t,
					}),
			],
		});
	};
xw.displayName = "WelcomeScreenMenuItemContent";
var wu = ({
	onSelect: e,
	children: t,
	icon: r,
	shortcut: o,
	className: i = "",
	...a
}) =>
	(0, wt.jsx)("button", {
		...a,
		type: "button",
		className: `welcome-screen-menu-item ${i}`,
		onClick: e,
		children: (0, wt.jsx)(xw, { icon: r, shortcut: o, children: t }),
	});
wu.displayName = "WelcomeScreenMenuItem";
var lR = ({
	children: e,
	href: t,
	icon: r,
	shortcut: o,
	className: i = "",
	...a
}) =>
	(0, wt.jsx)("a", {
		...a,
		className: `welcome-screen-menu-item ${i}`,
		href: t,
		target: "_blank",
		rel: "noreferrer",
		children: (0, wt.jsx)(xw, { icon: r, shortcut: o, children: e }),
	});
lR.displayName = "WelcomeScreenMenuItemLink";
var An = ({ children: e }) => {
	let { WelcomeScreenCenterTunnel: t } = Mt();
	return (0, wt.jsx)(t.In, {
		children: (0, wt.jsx)("div", {
			className: "welcome-screen-center",
			children:
				e ||
				(0, wt.jsxs)(wt.Fragment, {
					children: [
						(0, wt.jsx)(vw, {}),
						(0, wt.jsx)(Ew, {
							children: v("welcomeScreen.defaults.center_heading"),
						}),
						(0, wt.jsxs)(yw, {
							children: [(0, wt.jsx)(Sw, {}), (0, wt.jsx)(ww, {})],
						}),
					],
				}),
		}),
	});
};
An.displayName = "Center";
var vw = ({ children: e }) =>
	(0, wt.jsx)("div", {
		className: "welcome-screen-center__logo excalifont welcome-screen-decor",
		children: e || (0, wt.jsx)(aR, { withText: !0 }),
	});
vw.displayName = "Logo";
var Ew = ({ children: e }) =>
	(0, wt.jsx)("div", {
		className: "welcome-screen-center__heading welcome-screen-decor excalifont",
		children: e,
	});
Ew.displayName = "Heading";
var yw = ({ children: e }) =>
	(0, wt.jsx)("div", { className: "welcome-screen-menu", children: e });
yw.displayName = "Menu";
var ww = () => {
	let e = pr();
	return (0, wt.jsx)(wu, {
		onSelect: () => e.executeAction(rs),
		shortcut: "?",
		icon: nc,
		children: v("helpDialog.title"),
	});
};
ww.displayName = "MenuItemHelp";
var Sw = () => {
	let e = mt(),
		t = pr();
	return e.viewModeEnabled
		? null
		: (0, wt.jsx)(wu, {
				onSelect: () => t.executeAction(jc),
				shortcut: tr("loadScene"),
				icon: ic,
				children: v("buttons.load"),
			});
};
Sw.displayName = "MenuItemLoadScene";
var sR = ({ onSelect: e }) => {
	let { t } = lr();
	return (0, wt.jsx)(wu, {
		shortcut: null,
		onSelect: e,
		icon: Hp,
		children: t("labels.liveCollaboration"),
	});
};
sR.displayName = "MenuItemLiveCollaborationTrigger";
An.Logo = vw;
An.Heading = Ew;
An.Menu = yw;
An.MenuItem = wu;
An.MenuItemLink = lR;
An.MenuItemHelp = ww;
An.MenuItemLoadScene = Sw;
An.MenuItemLiveCollaborationTrigger = sR;
b();
var Jn = w(M(), 1),
	pb = ({ children: e }) => {
		let { WelcomeScreenMenuHintTunnel: t } = Mt();
		return (0, Jn.jsx)(t.In, {
			children: (0, Jn.jsxs)("div", {
				className:
					"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--menu",
				children: [
					vC,
					(0, Jn.jsx)("div", {
						className: "welcome-screen-decor-hint__label",
						children: e || v("welcomeScreen.defaults.menuHint"),
					}),
				],
			}),
		});
	};
pb.displayName = "MenuHint";
var fb = ({ children: e }) => {
	let { WelcomeScreenToolbarHintTunnel: t } = Mt();
	return (0, Jn.jsx)(t.In, {
		children: (0, Jn.jsxs)("div", {
			className:
				"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--toolbar",
			children: [
				(0, Jn.jsx)("div", {
					className: "welcome-screen-decor-hint__label",
					children: e || v("welcomeScreen.defaults.toolbarHint"),
				}),
				yC,
			],
		}),
	});
};
fb.displayName = "ToolbarHint";
var gb = ({ children: e }) => {
	let { WelcomeScreenHelpHintTunnel: t } = Mt();
	return (0, Jn.jsx)(t.In, {
		children: (0, Jn.jsxs)("div", {
			className:
				"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--help",
			children: [
				(0, Jn.jsx)("div", {
					children: e || v("welcomeScreen.defaults.helpHint"),
				}),
				EC,
			],
		}),
	});
};
gb.displayName = "HelpHint";
var ei = w(M(), 1),
	hb = (e) =>
		(0, ei.jsx)(ei.Fragment, {
			children:
				e.children ||
				(0, ei.jsxs)(ei.Fragment, {
					children: [
						(0, ei.jsx)(An, {}),
						(0, ei.jsx)(pb, {}),
						(0, ei.jsx)(fb, {}),
						(0, ei.jsx)(gb, {}),
					],
				}),
		});
hb.displayName = "WelcomeScreen";
hb.Center = An;
hb.Hints = { MenuHint: pb, ToolbarHint: fb, HelpHint: gb };
var SU = hb;
b();
var bb = w(M(), 1),
	cR = ({ isCollaborating: e, onSelect: t, ...r }) => {
		let o = mt(),
			i = o.width < 830;
		return (0, bb.jsxs)(Qo, {
			...r,
			className: j("collab-button", { active: e }),
			type: "button",
			onSelect: t,
			style: { position: "relative", width: i ? void 0 : "auto" },
			title: v("labels.liveCollaboration"),
			children: [
				i ? OC : v("labels.share"),
				o.collaborators.size > 0 &&
					(0, bb.jsx)("div", {
						className: "CollabButton-collaborators",
						children: o.collaborators.size,
					}),
			],
		});
	},
	TU = cR;
cR.displayName = "LiveCollaborationTrigger";
b();
var dR = w(Jx(), 1);
var CU = (e, t, r) =>
		!!(
			t &&
			(t.id === e.editingTextElement?.id ||
				t.id === e.resizingElement?.id ||
				t.id === e.newElement?.id ||
				t.version > r.version ||
				(t.version === r.version && t.versionNonce < r.versionNonce))
		),
	IU = (0, dR.default)(
		(e, t, r) => {
			if (_.DEV || _.MODE === Bs.TEST || window?.DEBUG_FRACTIONAL_INDICES) {
				let o = Gi(e.map((i) => ({ ...i })));
				__(o, {
					shouldThrow: _.DEV || _.MODE === Bs.TEST,
					includeBoundTextValidation: !0,
					reconciliationContext: { localElements: t, remoteElements: r },
				});
			}
		},
		1e3 * 60,
		{ leading: !0, trailing: !1 },
	),
	_U = (e, t, r) => {
		let o = Fe(e),
			i = [],
			a = new Set();
		for (let c of t)
			if (!a.has(c.id)) {
				let d = o.get(c.id),
					u = CU(r, d, c);
				d && u ? (i.push(d), a.add(d.id)) : (i.push(c), a.add(c.id));
			}
		for (let c of e) a.has(c.id) || (i.push(c), a.add(c.id));
		let s = A_(i);
		return IU(s, e, t), Gi(s), s;
	};
b();
var Su = w(M(), 1),
	mR = ({ children: e, icon: t }) => {
		let { TTDDialogTriggerTunnel: r } = Mt(),
			o = tt();
		return (0, Su.jsx)(r.In, {
			children: (0, Su.jsxs)(gt.Item, {
				onSelect: () => {
					We("ai", "dialog open", "ttd"),
						o({ openDialog: { name: "ttd", tab: "text-to-diagram" } });
				},
				icon: t ?? I2,
				children: [
					e ?? v("labels.textToDiagram"),
					(0, Su.jsx)(gt.Item.Badge, { children: "AI" }),
				],
			}),
		});
	};
mR.displayName = "TTDDialogTrigger";
b();
var uR = w(Q(), 1);
var AU = (e) => {
	let t = Jt();
	return (
		(0, uR.useLayoutEffect)(() => {
			t.setPlugins({ diagramToCode: { generate: e.generate } });
		}, [t, e.generate]),
		null
	);
};
var xb = w(M(), 1);
nR();
var kU = (e) => {
		let {
				onChange: t,
				initialData: r,
				excalidrawAPI: o,
				isCollaborating: i = !1,
				onPointerUpdate: a,
				renderTopRightUI: s,
				langCode: c = si.code,
				viewModeEnabled: d,
				zenModeEnabled: u,
				gridModeEnabled: f,
				libraryReturnUrl: m,
				theme: g,
				name: h,
				renderCustomStats: y,
				onPaste: E,
				detectScroll: T = !0,
				handleKeyboardGlobally: I = !1,
				onLibraryChange: P,
				autoFocus: C = !1,
				generateIdForFile: k,
				onLinkOpen: N,
				generateLinkForSelection: D,
				onPointerDown: B,
				onPointerUp: F,
				onScrollChange: W,
				children: G,
				validateEmbeddable: q,
				renderEmbeddable: ie,
				aiEnabled: te,
				showDeprecatedFonts: we,
			} = e,
			X = e.UIOptions?.canvasActions,
			se = {
				...e.UIOptions,
				canvasActions: { ...qx.canvasActions, ...X },
				tools: { image: e.UIOptions?.tools?.image ?? !0 },
			};
		return (
			X?.export &&
				(se.canvasActions.export.saveFileToDisk =
					X.export?.saveFileToDisk ?? qx.canvasActions.export.saveFileToDisk),
			se.canvasActions.toggleTheme === null &&
				typeof g > "u" &&
				(se.canvasActions.toggleTheme = !0),
			(0, vb.useEffect)(() => {
				(async () => {
					await import("./excalidraw-assets/roundRect-2ACQK4DA.js");
				})();
				let ke = (fe) => {
					typeof fe.scale == "number" && fe.scale !== 1 && fe.preventDefault();
				};
				return (
					document.addEventListener("touchmove", ke, { passive: !1 }),
					() => {
						document.removeEventListener("touchmove", ke);
					}
				);
			}, []),
			(0, xb.jsx)(Yf, {
				unstable_createStore: () => zr,
				scope: lt,
				children: (0, xb.jsx)(j_, {
					langCode: c,
					theme: g,
					children: (0, xb.jsx)(oR, {
						onChange: t,
						initialData: r,
						excalidrawAPI: o,
						isCollaborating: i,
						onPointerUpdate: a,
						renderTopRightUI: s,
						langCode: c,
						viewModeEnabled: d,
						zenModeEnabled: u,
						gridModeEnabled: f,
						libraryReturnUrl: m,
						theme: g,
						name: h,
						renderCustomStats: y,
						UIOptions: se,
						onPaste: E,
						detectScroll: T,
						handleKeyboardGlobally: I,
						onLibraryChange: P,
						autoFocus: C,
						generateIdForFile: k,
						onLinkOpen: N,
						generateLinkForSelection: D,
						onPointerDown: B,
						onPointerUp: F,
						onScrollChange: W,
						validateEmbeddable: q,
						renderEmbeddable: ie,
						aiEnabled: te !== !1,
						showDeprecatedFonts: we,
						children: G,
					}),
				}),
			})
		);
	},
	LU = (e, t) => {
		if (e.children !== t.children) return !1;
		let { initialData: r, UIOptions: o = {}, ...i } = e,
			{ initialData: a, UIOptions: s = {}, ...c } = t,
			d = Object.keys(o),
			u = Object.keys(s);
		return d.length !== u.length
			? !1
			: d.every((m) =>
					m === "canvasActions"
						? Object.keys(o.canvasActions).every((h) =>
								h === "export" &&
								o?.canvasActions?.export &&
								s?.canvasActions?.export
									? o.canvasActions.export.saveFileToDisk ===
										s.canvasActions.export.saveFileToDisk
									: o?.canvasActions?.[h] === s?.canvasActions?.[h],
							)
						: o[m] === s[m],
				) && Er(i, c);
	},
	MU = vb.default.memo(kU, LU);
MU.displayName = "Excalidraw";
export {
	Qo as Button,
	Kx as DEFAULT_LASER_COLOR,
	Yh as DefaultSidebar,
	AU as DiagramToCodePlugin,
	MU as Excalidraw,
	Ri as FONT_FAMILY,
	EU as Footer,
	TU as LiveCollaborationTrigger,
	vr as MIME_TYPES,
	Jr as MainMenu,
	To as ROUNDNESS,
	Sn as Sidebar,
	mu as Stats,
	H as StoreAction,
	$e as THEME,
	W0 as TTDDialog,
	mR as TTDDialogTrigger,
	SU as WelcomeScreen,
	nE as bumpVersion,
	gd as convertToExcalidrawElements,
	si as defaultLang,
	q7 as elementPartiallyOverlapsWithOrContainsBBox,
	j7 as elementsOverlappingBBox,
	V7 as exportToBlob,
	$l as exportToCanvas,
	X7 as exportToClipboard,
	pm as exportToSvg,
	yt as getCommonBounds,
	xf as getDataURL,
	Q7 as getFreeDrawSvgPath,
	lh as getLibraryItemsHash,
	Ve as getNonDeletedElements,
	J7 as getSceneVersion,
	oE as getTextFromElements,
	Jv as getVisibleSceneBounds,
	dE as hashElementsVersion,
	mE as hashString,
	Z7 as isElementInsideBBox,
	zl as isElementLink,
	Wl as isInvisiblySmallElement,
	at as isLinearElement,
	Tc as languages,
	bf as loadFromBlob,
	$v as loadLibraryFromBlob,
	zv as loadSceneOrLibraryFromBlob,
	u3 as mergeLibraryItems,
	me as mutateElement,
	Me as newElementWith,
	Bn as normalizeLink,
	Gy as parseLibraryTokensFromUrl,
	_U as reconcileElements,
	Bv as restore,
	Y7 as restoreAppState,
	Fv as restoreElements,
	dm as restoreLibraryItems,
	lo as sceneCoordsToViewportCoords,
	Uv as serializeAsJSON,
	Wv as serializeLibraryAsJSON,
	et as useDevice,
	zB as useHandleLibrary,
	lr as useI18n,
	Ot as viewportCoordsToSceneCoords,
	M5 as zoomToFitBounds,
};
/*! Bundled license information:

use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.min.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
