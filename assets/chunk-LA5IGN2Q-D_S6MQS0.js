import{w as s,m as k,H as S,x as V,Q as w,X as N,y as M,c as x,j as y,s as I,a as G,F as En,e as Nn,d as D,N as m,Y as L,A as H,$ as Q,f as C,h as In,b as P,B as _n,U as F,V as Rn}from"./chunk-4IXHFASB-CDVo3L-Z.js";import{r as X,s as Mn,u as Tn}from"./dist-QNDTTFGF-C-70H9Cw.js";import{an as h}from"./index-DnwN-RZ1.js";h();h();h();function _(n,e,t,o){var i;do i=D(o);while(n.hasNode(i));return t.dummy=e,n.setNode(i,t),i}function Ln(n){var e=new k().setGraph(n.graph());return s(n.nodes(),function(t){e.setNode(t,n.node(t))}),s(n.edges(),function(t){var o=e.edge(t.v,t.w)||{weight:0,minlen:1},i=n.edge(t);e.setEdge(t.v,t.w,{weight:o.weight+i.weight,minlen:Math.max(o.minlen,i.minlen)})}),e}function cn(n){var e=new k({multigraph:n.isMultigraph()}).setGraph(n.graph());return s(n.nodes(),function(t){n.children(t).length||e.setNode(t,n.node(t))}),s(n.edges(),function(t){e.setEdge(t,n.edge(t))}),e}function W(n,e){var t=n.x,o=n.y,i=e.x-t,u=e.y-o,r=n.width/2,a=n.height/2;if(!i&&!u)throw new Error("Not possible to find intersection inside of the rectangle");var d,c;return Math.abs(u)*r>Math.abs(i)*a?(u<0&&(a=-a),d=a*i/u,c=a):(i<0&&(r=-r),d=r,c=r*u/i),{x:t+d,y:o+c}}function O(n){var e=w(N(sn(n)+1),function(){return[]});return s(n.nodes(),function(t){var o=n.node(t),i=o.rank;y(i)||(e[i][o.order]=t)}),e}function Cn(n){var e=M(w(n.nodes(),function(t){return n.node(t).rank}));s(n.nodes(),function(t){var o=n.node(t);m(o,"rank")&&(o.rank-=e)})}function Pn(n){var e=M(w(n.nodes(),function(u){return n.node(u).rank})),t=[];s(n.nodes(),function(u){var r=n.node(u).rank-e;t[r]||(t[r]=[]),t[r].push(u)});var o=0,i=n.graph().nodeRankFactor;s(t,function(u,r){y(u)&&r%i!==0?--o:o&&s(u,function(a){n.node(a).rank+=o})})}function Z(n,e,t,o){var i={width:0,height:0};return arguments.length>=4&&(i.rank=t,i.order=o),_(n,"border",i,e)}function sn(n){return x(w(n.nodes(),function(e){var t=n.node(e).rank;if(!y(t))return t}))}function Sn(n,e){var t={lhs:[],rhs:[]};return s(n,function(o){e(o)?t.lhs.push(o):t.rhs.push(o)}),t}function Fn(n,e){return e()}function Vn(n){function e(t){var o=n.children(t),i=n.node(t);if(o.length&&s(o,e),m(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var u=i.minRank,r=i.maxRank+1;u<r;++u)nn(n,"borderLeft","_bl",t,i,u),nn(n,"borderRight","_br",t,i,u)}}s(n.children(),e)}function nn(n,e,t,o,i,u){var r={width:0,height:0,rank:u,borderType:e},a=i[e][u-1],d=_(n,"border",r,t);i[e][u]=d,n.setParent(d,o),a&&n.setEdge(a,d,{weight:1})}h();function Gn(n){var e=n.graph().rankdir.toLowerCase();(e==="lr"||e==="rl")&&fn(n)}function On(n){var e=n.graph().rankdir.toLowerCase();(e==="bt"||e==="rl")&&Bn(n),(e==="lr"||e==="rl")&&(qn(n),fn(n))}function fn(n){s(n.nodes(),function(e){en(n.node(e))}),s(n.edges(),function(e){en(n.edge(e))})}function en(n){var e=n.width;n.width=n.height,n.height=e}function Bn(n){s(n.nodes(),function(e){B(n.node(e))}),s(n.edges(),function(e){var t=n.edge(e);s(t.points,B),m(t,"y")&&B(t)})}function B(n){n.y=-n.y}function qn(n){s(n.nodes(),function(e){q(n.node(e))}),s(n.edges(),function(e){var t=n.edge(e);s(t.points,q),m(t,"x")&&q(t)})}function q(n){var e=n.x;n.x=n.y,n.y=e}h();h();h();var Yn=class{constructor(){var n={};n._next=n._prev=n,this._sentinel=n}dequeue(){var n=this._sentinel,e=n._prev;if(e!==n)return tn(e),e}enqueue(n){var e=this._sentinel;n._prev&&n._next&&tn(n),n._next=e._next,e._next._prev=n,e._next=n,n._prev=e}toString(){for(var n=[],e=this._sentinel,t=e._prev;t!==e;)n.push(JSON.stringify(t,jn)),t=t._prev;return"["+n.join(", ")+"]"}};function tn(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function jn(n,e){if(n!=="_next"&&n!=="_prev")return e}var zn=Mn(1);function Xn(n,e){if(n.nodeCount()<=1)return[];var t=Dn(n,e||zn),o=An(t.graph,t.buckets,t.zeroIdx);return L(w(o,function(i){return n.outEdges(i.v,i.w)}))}function An(n,e,t){for(var o=[],i=e[e.length-1],u=e[0],r;n.nodeCount();){for(;r=u.dequeue();)Y(n,e,t,r);for(;r=i.dequeue();)Y(n,e,t,r);if(n.nodeCount()){for(var a=e.length-2;a>0;--a)if(r=e[a].dequeue(),r){o=o.concat(Y(n,e,t,r,!0));break}}}return o}function Y(n,e,t,o,i){var u=i?[]:void 0;return s(n.inEdges(o.v),function(r){var a=n.edge(r),d=n.node(r.v);i&&u.push({v:r.v,w:r.w}),d.out-=a,A(e,t,d)}),s(n.outEdges(o.v),function(r){var a=n.edge(r),d=r.w,c=n.node(d);c.in-=a,A(e,t,c)}),n.removeNode(o.v),u}function Dn(n,e){var t=new k,o=0,i=0;s(n.nodes(),function(a){t.setNode(a,{v:a,in:0,out:0})}),s(n.edges(),function(a){var d=t.edge(a.v,a.w)||0,c=e(a),f=d+c;t.setEdge(a.v,a.w,f),i=Math.max(i,t.node(a.v).out+=c),o=Math.max(o,t.node(a.w).in+=c)});var u=N(i+o+3).map(function(){return new Yn}),r=o+1;return s(t.nodes(),function(a){A(u,r,t.node(a))}),{graph:t,buckets:u,zeroIdx:r}}function A(n,e,t){t.out?t.in?n[t.out-t.in+e].enqueue(t):n[n.length-1].enqueue(t):n[0].enqueue(t)}function Hn(n){var e=n.graph().acyclicer==="greedy"?Xn(n,t(n)):Qn(n);s(e,function(o){var i=n.edge(o);n.removeEdge(o),i.forwardName=o.name,i.reversed=!0,n.setEdge(o.w,o.v,i,D("rev"))});function t(o){return function(i){return o.edge(i).weight}}}function Qn(n){var e=[],t={},o={};function i(u){m(o,u)||(o[u]=!0,t[u]=!0,s(n.outEdges(u),function(r){m(t,r.w)?e.push(r):i(r.w)}),delete t[u])}return s(n.nodes(),i),e}function $n(n){s(n.edges(),function(e){var t=n.edge(e);if(t.reversed){n.removeEdge(e);var o=t.forwardName;delete t.reversed,delete t.forwardName,n.setEdge(e.w,e.v,t,o)}})}h();function Jn(n){n.graph().dummyChains=[],s(n.edges(),function(e){Un(n,e)})}function Un(n,e){var t=e.v,o=n.node(t).rank,i=e.w,u=n.node(i).rank,r=e.name,a=n.edge(e),d=a.labelRank;if(u!==o+1){n.removeEdge(e);var c,f,g;for(g=0,++o;o<u;++g,++o)a.points=[],f={width:0,height:0,edgeLabel:a,edgeObj:e,rank:o},c=_(n,"edge",f,"_d"),o===d&&(f.width=a.width,f.height=a.height,f.dummy="edge-label",f.labelpos=a.labelpos),n.setEdge(t,c,{weight:a.weight},r),g===0&&n.graph().dummyChains.push(c),t=c;n.setEdge(t,i,{weight:a.weight},r)}}function Kn(n){s(n.graph().dummyChains,function(e){var t=n.node(e),o=t.edgeLabel,i;for(n.setEdge(t.edgeObj,o);t.dummy;)i=n.successors(e)[0],n.removeNode(e),o.points.push({x:t.x,y:t.y}),t.dummy==="edge-label"&&(o.x=t.x,o.y=t.y,o.width=t.width,o.height=t.height),e=i,t=n.node(e)})}h();h();h();function $(n){var e={};function t(o){var i=n.node(o);if(m(e,o))return i.rank;e[o]=!0;var u=M(w(n.outEdges(o),function(r){return t(r.w)-n.edge(r).minlen}));return(u===Number.POSITIVE_INFINITY||u===void 0||u===null)&&(u=0),i.rank=u}s(n.sources(),t)}function T(n,e){return n.node(e.w).rank-n.node(e.v).rank-n.edge(e).minlen}function gn(n){var e=new k({directed:!1}),t=n.nodes()[0],o=n.nodeCount();e.setNode(t,{});for(var i,u;Wn(e,n)<o;)i=Zn(e,n),u=e.hasNode(i.v)?T(n,i):-T(n,i),ne(e,n,u);return e}function Wn(n,e){function t(o){s(e.nodeEdges(o),function(i){var u=i.v,r=o===u?i.w:u;!n.hasNode(r)&&!T(e,i)&&(n.setNode(r,{}),n.setEdge(o,r,{}),t(r))})}return s(n.nodes(),t),n.nodeCount()}function Zn(n,e){return H(e.edges(),function(t){if(n.hasNode(t.v)!==n.hasNode(t.w))return T(e,t)})}function ne(n,e,t){s(n.nodes(),function(o){e.node(o).rank+=t})}h();h();h();h();h();h();h();h();h();h();h();function ee(){}ee.prototype=new Error;h();h();function hn(n,e,t){Tn(e)||(e=[e]);var o=(n.isDirected()?n.successors:n.neighbors).bind(n),i=[],u={};return s(e,function(r){if(!n.hasNode(r))throw new Error("Graph does not have node: "+r);vn(n,r,t==="post",u,o,i)}),i}function vn(n,e,t,o,i,u){m(o,e)||(o[e]=!0,t||u.push(e),s(i(e),function(r){vn(n,r,t,o,i,u)}),t&&u.push(e))}function te(n,e){return hn(n,e,"post")}h();function oe(n,e){return hn(n,e,"pre")}h();E.initLowLimValues=U;E.initCutValues=J;E.calcCutValue=ln;E.leaveEdge=mn;E.enterEdge=wn;E.exchangeEdges=bn;function E(n){n=Ln(n),$(n);var e=gn(n);U(e),J(e,n);for(var t,o;t=mn(e);)o=wn(e,n,t),bn(e,n,t,o)}function J(n,e){var t=te(n,n.nodes());t=t.slice(0,t.length-1),s(t,function(o){ie(n,e,o)})}function ie(n,e,t){var o=n.node(t),i=o.parent;n.edge(t,i).cutvalue=ln(n,e,t)}function ln(n,e,t){var o=n.node(t),i=o.parent,u=!0,r=e.edge(t,i),a=0;return r||(u=!1,r=e.edge(i,t)),a=r.weight,s(e.nodeEdges(t),function(d){var c=d.v===t,f=c?d.w:d.v;if(f!==i){var g=c===u,v=e.edge(d).weight;if(a+=g?v:-v,ue(n,t,f)){var l=n.edge(t,f).cutvalue;a+=g?-l:l}}}),a}function U(n,e){arguments.length<2&&(e=n.nodes()[0]),pn(n,{},1,e)}function pn(n,e,t,o,i){var u=t,r=n.node(o);return e[o]=!0,s(n.neighbors(o),function(a){m(e,a)||(t=pn(n,e,t,a,o))}),r.low=u,r.lim=t++,i?r.parent=i:delete r.parent,t}function mn(n){return Q(n.edges(),function(e){return n.edge(e).cutvalue<0})}function wn(n,e,t){var o=t.v,i=t.w;e.hasEdge(o,i)||(o=t.w,i=t.v);var u=n.node(o),r=n.node(i),a=u,d=!1;u.lim>r.lim&&(a=r,d=!0);var c=C(e.edges(),function(f){return d===on(n,n.node(f.v),a)&&d!==on(n,n.node(f.w),a)});return H(c,function(f){return T(e,f)})}function bn(n,e,t,o){var i=t.v,u=t.w;n.removeEdge(i,u),n.setEdge(o.v,o.w,{}),U(n),J(n,e),re(n,e)}function re(n,e){var t=Q(n.nodes(),function(i){return!e.node(i).parent}),o=oe(n,t);o=o.slice(1),s(o,function(i){var u=n.node(i).parent,r=e.edge(i,u),a=!1;r||(r=e.edge(u,i),a=!0),e.node(i).rank=e.node(u).rank+(a?r.minlen:-r.minlen)})}function ue(n,e,t){return n.hasEdge(e,t)}function on(n,e,t){return t.low<=e.lim&&e.lim<=t.lim}function ae(n){switch(n.graph().ranker){case"network-simplex":rn(n);break;case"tight-tree":ce(n);break;case"longest-path":de(n);break;default:rn(n)}}var de=$;function ce(n){$(n),gn(n)}function rn(n){E(n)}h();function se(n){var e=_(n,"root",{},"_root"),t=fe(n),o=x(I(t))-1,i=2*o+1;n.graph().nestingRoot=e,s(n.edges(),function(r){n.edge(r).minlen*=i});var u=ge(n)+1;s(n.children(),function(r){yn(n,e,i,u,o,t,r)}),n.graph().nodeRankFactor=i}function yn(n,e,t,o,i,u,r){var a=n.children(r);if(!a.length){r!==e&&n.setEdge(e,r,{weight:0,minlen:t});return}var d=Z(n,"_bt"),c=Z(n,"_bb"),f=n.node(r);n.setParent(d,r),f.borderTop=d,n.setParent(c,r),f.borderBottom=c,s(a,function(g){yn(n,e,t,o,i,u,g);var v=n.node(g),l=v.borderTop?v.borderTop:g,p=v.borderBottom?v.borderBottom:g,b=v.borderTop?o:2*o,R=l!==p?1:i-u[r]+1;n.setEdge(d,l,{weight:b,minlen:R,nestingEdge:!0}),n.setEdge(p,c,{weight:b,minlen:R,nestingEdge:!0})}),n.parent(r)||n.setEdge(e,d,{weight:0,minlen:i+u[r]})}function fe(n){var e={};function t(o,i){var u=n.children(o);u&&u.length&&s(u,function(r){t(r,i+1)}),e[o]=i}return s(n.children(),function(o){t(o,1)}),e}function ge(n){return G(n.edges(),function(e,t){return e+n.edge(t).weight},0)}function he(n){var e=n.graph();n.removeNode(e.nestingRoot),delete e.nestingRoot,s(n.edges(),function(t){var o=n.edge(t);o.nestingEdge&&n.removeEdge(t)})}h();h();function ve(n,e,t){var o={},i;s(t,function(u){for(var r=n.parent(u),a,d;r;){if(a=n.parent(r),a?(d=o[a],o[a]=r):(d=i,i=r),d&&d!==r){e.setEdge(d,r);return}r=a}})}h();function le(n,e,t){var o=pe(n),i=new k({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(function(u){return n.node(u)});return s(n.nodes(),function(u){var r=n.node(u),a=n.parent(u);(r.rank===e||r.minRank<=e&&e<=r.maxRank)&&(i.setNode(u),i.setParent(u,a||o),s(n[t](u),function(d){var c=d.v===u?d.w:d.v,f=i.edge(c,u),g=y(f)?0:f.weight;i.setEdge(c,u,{weight:n.edge(d).weight+g})}),m(r,"minRank")&&i.setNode(u,{borderLeft:r.borderLeft[e],borderRight:r.borderRight[e]}))}),i}function pe(n){for(var e;n.hasNode(e=D("_root")););return e}h();function me(n,e){for(var t=0,o=1;o<e.length;++o)t+=we(n,e[o-1],e[o]);return t}function we(n,e,t){for(var o=In(t,w(t,function(c,f){return f})),i=L(w(e,function(c){return P(w(n.outEdges(c),function(f){return{pos:o[f.w],weight:n.edge(f).weight}}),"pos")})),u=1;u<t.length;)u<<=1;var r=2*u-1;u-=1;var a=w(new Array(r),function(){return 0}),d=0;return s(i.forEach(function(c){var f=c.pos+u;a[f]+=c.weight;for(var g=0;f>0;)f%2&&(g+=a[f+1]),f=f-1>>1,a[f]+=c.weight;d+=c.weight*g})),d}h();function be(n){var e={},t=C(n.nodes(),function(a){return!n.children(a).length}),o=x(w(t,function(a){return n.node(a).rank})),i=w(N(o+1),function(){return[]});function u(a){if(!m(e,a)){e[a]=!0;var d=n.node(a);i[d.rank].push(a),s(n.successors(a),u)}}var r=P(t,function(a){return n.node(a).rank});return s(r,u),i}h();h();function ye(n,e){return w(e,function(t){var o=n.inEdges(t);if(o.length){var i=G(o,function(u,r){var a=n.edge(r),d=n.node(r.v);return{sum:u.sum+a.weight*d.order,weight:u.weight+a.weight}},{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:t}})}h();function ke(n,e){var t={};s(n,function(i,u){var r=t[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:u};y(i.barycenter)||(r.barycenter=i.barycenter,r.weight=i.weight)}),s(e.edges(),function(i){var u=t[i.v],r=t[i.w];!y(u)&&!y(r)&&(r.indegree++,u.out.push(t[i.w]))});var o=C(t,function(i){return!i.indegree});return xe(o)}function xe(n){var e=[];function t(u){return function(r){r.merged||(y(r.barycenter)||y(u.barycenter)||r.barycenter>=u.barycenter)&&Ee(u,r)}}function o(u){return function(r){r.in.push(u),--r.indegree===0&&n.push(r)}}for(;n.length;){var i=n.pop();e.push(i),s(i.in.reverse(),t(i)),s(i.out,o(i))}return w(C(e,function(u){return!u.merged}),function(u){return S(u,["vs","i","barycenter","weight"])})}function Ee(n,e){var t=0,o=0;n.weight&&(t+=n.barycenter*n.weight,o+=n.weight),e.weight&&(t+=e.barycenter*e.weight,o+=e.weight),n.vs=e.vs.concat(n.vs),n.barycenter=t/o,n.weight=o,n.i=Math.min(e.i,n.i),e.merged=!0}h();function Ne(n,e){var t=Sn(n,function(f){return m(f,"barycenter")}),o=t.lhs,i=P(t.rhs,function(f){return-f.i}),u=[],r=0,a=0,d=0;o.sort(Ie(!!e)),d=un(u,i,d),s(o,function(f){d+=f.vs.length,u.push(f.vs),r+=f.barycenter*f.weight,a+=f.weight,d=un(u,i,d)});var c={vs:L(u)};return a&&(c.barycenter=r/a,c.weight=a),c}function un(n,e,t){for(var o;e.length&&(o=F(e)).i<=t;)e.pop(),n.push(o.vs),t++;return t}function Ie(n){return function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:n?t.i-e.i:e.i-t.i}}function kn(n,e,t,o){var i=n.children(e),u=n.node(e),r=u?u.borderLeft:void 0,a=u?u.borderRight:void 0,d={};r&&(i=C(i,function(p){return p!==r&&p!==a}));var c=ye(n,i);s(c,function(p){if(n.children(p.v).length){var b=kn(n,p.v,t,o);d[p.v]=b,m(b,"barycenter")&&Re(p,b)}});var f=ke(c,t);_e(f,d);var g=Ne(f,o);if(r&&(g.vs=L([r,g.vs,a]),n.predecessors(r).length)){var v=n.node(n.predecessors(r)[0]),l=n.node(n.predecessors(a)[0]);m(g,"barycenter")||(g.barycenter=0,g.weight=0),g.barycenter=(g.barycenter*g.weight+v.order+l.order)/(g.weight+2),g.weight+=2}return g}function _e(n,e){s(n,function(t){t.vs=L(t.vs.map(function(o){return e[o]?e[o].vs:o}))})}function Re(n,e){y(n.barycenter)?(n.barycenter=e.barycenter,n.weight=e.weight):(n.barycenter=(n.barycenter*n.weight+e.barycenter*e.weight)/(n.weight+e.weight),n.weight+=e.weight)}function Me(n){var e=sn(n),t=an(n,N(1,e+1),"inEdges"),o=an(n,N(e-1,-1,-1),"outEdges"),i=be(n);dn(n,i);for(var u=Number.POSITIVE_INFINITY,r,a=0,d=0;d<4;++a,++d){Te(a%2?t:o,a%4>=2),i=O(n);var c=me(n,i);c<u&&(d=0,r=En(i),u=c)}dn(n,r)}function an(n,e,t){return w(e,function(o){return le(n,o,t)})}function Te(n,e){var t=new k;s(n,function(o){var i=o.graph().root,u=kn(o,i,t,e);s(u.vs,function(r,a){o.node(r).order=a}),ve(o,t,u.vs)})}function dn(n,e){s(e,function(t){s(t,function(o,i){n.node(o).order=i})})}h();function Le(n){var e=Pe(n);s(n.graph().dummyChains,function(t){for(var o=n.node(t),i=o.edgeObj,u=Ce(n,e,i.v,i.w),r=u.path,a=u.lca,d=0,c=r[d],f=!0;t!==i.w;){if(o=n.node(t),f){for(;(c=r[d])!==a&&n.node(c).maxRank<o.rank;)d++;c===a&&(f=!1)}if(!f){for(;d<r.length-1&&n.node(c=r[d+1]).minRank<=o.rank;)d++;c=r[d]}n.setParent(t,c),t=n.successors(t)[0]}})}function Ce(n,e,t,o){var i=[],u=[],r=Math.min(e[t].low,e[o].low),a=Math.max(e[t].lim,e[o].lim),d,c;d=t;do d=n.parent(d),i.push(d);while(d&&(e[d].low>r||a>e[d].lim));for(c=d,d=o;(d=n.parent(d))!==c;)u.push(d);return{path:i.concat(u.reverse()),lca:c}}function Pe(n){var e={},t=0;function o(i){var u=t;s(n.children(i),o),e[i]={low:u,lim:t++}}return s(n.children(),o),e}h();h();function Se(n,e){var t={};function o(i,u){var r=0,a=0,d=i.length,c=F(u);return s(u,function(f,g){var v=Ve(n,f),l=v?n.node(v).order:d;(v||f===c)&&(s(u.slice(a,g+1),function(p){s(n.predecessors(p),function(b){var R=n.node(b),K=R.order;(K<r||l<K)&&!(R.dummy&&n.node(p).dummy)&&xn(t,b,p)})}),a=g+1,r=l)}),u}return G(e,o),t}function Fe(n,e){var t={};function o(u,r,a,d,c){var f;s(N(r,a),function(g){f=u[g],n.node(f).dummy&&s(n.predecessors(f),function(v){var l=n.node(v);l.dummy&&(l.order<d||l.order>c)&&xn(t,v,f)})})}function i(u,r){var a=-1,d,c=0;return s(r,function(f,g){if(n.node(f).dummy==="border"){var v=n.predecessors(f);v.length&&(d=n.node(v[0]).order,o(r,c,g,a,d),c=g,a=d)}o(r,c,r.length,d,u.length)}),r}return G(e,i),t}function Ve(n,e){if(n.node(e).dummy)return Q(n.predecessors(e),function(t){return n.node(t).dummy})}function xn(n,e,t){if(e>t){var o=e;e=t,t=o}var i=n[e];i||(n[e]=i={}),i[t]=!0}function Ge(n,e,t){if(e>t){var o=e;e=t,t=o}return m(n[e],t)}function Oe(n,e,t,o){var i={},u={},r={};return s(e,function(a){s(a,function(d,c){i[d]=d,u[d]=d,r[d]=c})}),s(e,function(a){var d=-1;s(a,function(c){var f=o(c);if(f.length){f=P(f,function(b){return r[b]});for(var g=(f.length-1)/2,v=Math.floor(g),l=Math.ceil(g);v<=l;++v){var p=f[v];u[c]===c&&d<r[p]&&!Ge(t,c,p)&&(u[p]=c,u[c]=i[c]=i[p],d=r[p])}}})}),{root:i,align:u}}function Be(n,e,t,o,i){var u={},r=qe(n,e,t,i),a=i?"borderLeft":"borderRight";function d(g,v){for(var l=r.nodes(),p=l.pop(),b={};p;)b[p]?g(p):(b[p]=!0,l.push(p),l=l.concat(v(p))),p=l.pop()}function c(g){u[g]=r.inEdges(g).reduce(function(v,l){return Math.max(v,u[l.v]+r.edge(l))},0)}function f(g){var v=r.outEdges(g).reduce(function(p,b){return Math.min(p,u[b.w]-r.edge(b))},Number.POSITIVE_INFINITY),l=n.node(g);v!==Number.POSITIVE_INFINITY&&l.borderType!==a&&(u[g]=Math.max(u[g],v))}return d(c,r.predecessors.bind(r)),d(f,r.successors.bind(r)),s(o,function(g){u[g]=u[t[g]]}),u}function qe(n,e,t,o){var i=new k,u=n.graph(),r=Ae(u.nodesep,u.edgesep,o);return s(e,function(a){var d;s(a,function(c){var f=t[c];if(i.setNode(f),d){var g=t[d],v=i.edge(g,f);i.setEdge(g,f,Math.max(r(n,c,d),v||0))}d=c})}),i}function Ye(n,e){return H(I(e),function(t){var o=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return Rn(t,function(u,r){var a=De(n,r)/2;o=Math.max(u+a,o),i=Math.min(u-a,i)}),o-i})}function je(n,e){var t=I(e),o=M(t),i=x(t);s(["u","d"],function(u){s(["l","r"],function(r){var a=u+r,d=n[a],c;if(d!==e){var f=I(d);c=r==="l"?o-M(f):i-x(f),c&&(n[a]=V(d,function(g){return g+c}))}})})}function ze(n,e){return V(n.ul,function(t,o){if(e)return n[e.toLowerCase()][o];var i=P(w(n,o));return(i[1]+i[2])/2})}function Xe(n){var e=O(n),t=X(Se(n,e),Fe(n,e)),o={},i;s(["u","d"],function(r){i=r==="u"?e:I(e).reverse(),s(["l","r"],function(a){a==="r"&&(i=w(i,function(g){return I(g).reverse()}));var d=(r==="u"?n.predecessors:n.successors).bind(n),c=Oe(n,i,t,d),f=Be(n,i,c.root,c.align,a==="r");a==="r"&&(f=V(f,function(g){return-g})),o[r+a]=f})});var u=Ye(n,o);return je(o,u),ze(o,n.graph().align)}function Ae(n,e,t){return function(o,i,u){var r=o.node(i),a=o.node(u),d=0,c;if(d+=r.width/2,m(r,"labelpos"))switch(r.labelpos.toLowerCase()){case"l":c=-r.width/2;break;case"r":c=r.width/2;break}if(c&&(d+=t?c:-c),c=0,d+=(r.dummy?e:n)/2,d+=(a.dummy?e:n)/2,d+=a.width/2,m(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":c=a.width/2;break;case"r":c=-a.width/2;break}return c&&(d+=t?c:-c),c=0,d}}function De(n,e){return n.node(e).width}function He(n){n=cn(n),Qe(n),Nn(Xe(n),function(e,t){n.node(t).x=e})}function Qe(n){var e=O(n),t=n.graph().ranksep,o=0;s(e,function(i){var u=x(w(i,function(r){return n.node(r).height}));s(i,function(r){n.node(r).y=o+u/2}),o+=u+t})}function yt(n,e){var t=Fn;t("layout",function(){var o=t("  buildLayoutGraph",function(){return it(n)});t("  runLayout",function(){$e(o,t)}),t("  updateInputGraph",function(){Je(n,o)})})}function $e(n,e){e("    makeSpaceForEdgeLabels",function(){rt(n)}),e("    removeSelfEdges",function(){vt(n)}),e("    acyclic",function(){Hn(n)}),e("    nestingGraph.run",function(){se(n)}),e("    rank",function(){ae(cn(n))}),e("    injectEdgeLabelProxies",function(){ut(n)}),e("    removeEmptyRanks",function(){Pn(n)}),e("    nestingGraph.cleanup",function(){he(n)}),e("    normalizeRanks",function(){Cn(n)}),e("    assignRankMinMax",function(){at(n)}),e("    removeEdgeLabelProxies",function(){dt(n)}),e("    normalize.run",function(){Jn(n)}),e("    parentDummyChains",function(){Le(n)}),e("    addBorderSegments",function(){Vn(n)}),e("    order",function(){Me(n)}),e("    insertSelfEdges",function(){lt(n)}),e("    adjustCoordinateSystem",function(){Gn(n)}),e("    position",function(){He(n)}),e("    positionSelfEdges",function(){pt(n)}),e("    removeBorderNodes",function(){ht(n)}),e("    normalize.undo",function(){Kn(n)}),e("    fixupEdgeLabelCoords",function(){ft(n)}),e("    undoCoordinateSystem",function(){On(n)}),e("    translateGraph",function(){ct(n)}),e("    assignNodeIntersects",function(){st(n)}),e("    reversePoints",function(){gt(n)}),e("    acyclic.undo",function(){$n(n)})}function Je(n,e){s(n.nodes(),function(t){var o=n.node(t),i=e.node(t);o&&(o.x=i.x,o.y=i.y,e.children(t).length&&(o.width=i.width,o.height=i.height))}),s(n.edges(),function(t){var o=n.edge(t),i=e.edge(t);o.points=i.points,m(i,"x")&&(o.x=i.x,o.y=i.y)}),n.graph().width=e.graph().width,n.graph().height=e.graph().height}var Ue=["nodesep","edgesep","ranksep","marginx","marginy"],Ke={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},We=["acyclicer","ranker","rankdir","align"],Ze=["width","height"],nt={width:0,height:0},et=["minlen","weight","width","height","labeloffset"],tt={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},ot=["labelpos"];function it(n){var e=new k({multigraph:!0,compound:!0}),t=z(n.graph());return e.setGraph(X({},Ke,j(t,Ue),S(t,We))),s(n.nodes(),function(o){var i=z(n.node(o));e.setNode(o,_n(j(i,Ze),nt)),e.setParent(o,n.parent(o))}),s(n.edges(),function(o){var i=z(n.edge(o));e.setEdge(o,X({},tt,j(i,et),S(i,ot)))}),e}function rt(n){var e=n.graph();e.ranksep/=2,s(n.edges(),function(t){var o=n.edge(t);o.minlen*=2,o.labelpos.toLowerCase()!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?o.width+=o.labeloffset:o.height+=o.labeloffset)})}function ut(n){s(n.edges(),function(e){var t=n.edge(e);if(t.width&&t.height){var o=n.node(e.v),i=n.node(e.w),u={rank:(i.rank-o.rank)/2+o.rank,e};_(n,"edge-proxy",u,"_ep")}})}function at(n){var e=0;s(n.nodes(),function(t){var o=n.node(t);o.borderTop&&(o.minRank=n.node(o.borderTop).rank,o.maxRank=n.node(o.borderBottom).rank,e=x(e,o.maxRank))}),n.graph().maxRank=e}function dt(n){s(n.nodes(),function(e){var t=n.node(e);t.dummy==="edge-proxy"&&(n.edge(t.e).labelRank=t.rank,n.removeNode(e))})}function ct(n){var e=Number.POSITIVE_INFINITY,t=0,o=Number.POSITIVE_INFINITY,i=0,u=n.graph(),r=u.marginx||0,a=u.marginy||0;function d(c){var f=c.x,g=c.y,v=c.width,l=c.height;e=Math.min(e,f-v/2),t=Math.max(t,f+v/2),o=Math.min(o,g-l/2),i=Math.max(i,g+l/2)}s(n.nodes(),function(c){d(n.node(c))}),s(n.edges(),function(c){var f=n.edge(c);m(f,"x")&&d(f)}),e-=r,o-=a,s(n.nodes(),function(c){var f=n.node(c);f.x-=e,f.y-=o}),s(n.edges(),function(c){var f=n.edge(c);s(f.points,function(g){g.x-=e,g.y-=o}),m(f,"x")&&(f.x-=e),m(f,"y")&&(f.y-=o)}),u.width=t-e+r,u.height=i-o+a}function st(n){s(n.edges(),function(e){var t=n.edge(e),o=n.node(e.v),i=n.node(e.w),u,r;t.points?(u=t.points[0],r=t.points[t.points.length-1]):(t.points=[],u=i,r=o),t.points.unshift(W(o,u)),t.points.push(W(i,r))})}function ft(n){s(n.edges(),function(e){var t=n.edge(e);if(m(t,"x"))switch((t.labelpos==="l"||t.labelpos==="r")&&(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset;break}})}function gt(n){s(n.edges(),function(e){var t=n.edge(e);t.reversed&&t.points.reverse()})}function ht(n){s(n.nodes(),function(e){if(n.children(e).length){var t=n.node(e),o=n.node(t.borderTop),i=n.node(t.borderBottom),u=n.node(F(t.borderLeft)),r=n.node(F(t.borderRight));t.width=Math.abs(r.x-u.x),t.height=Math.abs(i.y-o.y),t.x=u.x+t.width/2,t.y=o.y+t.height/2}}),s(n.nodes(),function(e){n.node(e).dummy==="border"&&n.removeNode(e)})}function vt(n){s(n.edges(),function(e){if(e.v===e.w){var t=n.node(e.v);t.selfEdges||(t.selfEdges=[]),t.selfEdges.push({e,label:n.edge(e)}),n.removeEdge(e)}})}function lt(n){var e=O(n);s(e,function(t){var o=0;s(t,function(i,u){var r=n.node(i);r.order=u+o,s(r.selfEdges,function(a){_(n,"selfedge",{width:a.label.width,height:a.label.height,rank:r.rank,order:u+ ++o,e:a.e,label:a.label},"_se")}),delete r.selfEdges})})}function pt(n){s(n.nodes(),function(e){var t=n.node(e);if(t.dummy==="selfedge"){var o=n.node(t.e.v),i=o.x+o.width/2,u=o.y,r=t.x-i,a=o.height/2;n.setEdge(t.e,t.label),n.removeNode(e),t.label.points=[{x:i+2*r/3,y:u-a},{x:i+5*r/6,y:u-a},{x:i+r,y:u},{x:i+5*r/6,y:u+a},{x:i+2*r/3,y:u+a}],t.label.x=t.x,t.label.y=t.y}})}function j(n,e){return V(S(n,e),Number)}function z(n){var e={};return s(n,function(t,o){e[o.toLowerCase()]=t}),e}h();export{yt as u};
