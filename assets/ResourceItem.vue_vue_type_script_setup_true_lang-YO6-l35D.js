import{d as T,C as V,X as B,r as R,g as d,k as t,f as o,c as P,w as s,h as p,n as x,Y as $,I as f,u as n,m as A,i as C,e as c,Z as h,$ as E,a0 as N,a1 as X,E as Y}from"./index-DnwN-RZ1.js";import{E as F}from"./el-popover-DGnhGXBk.js";import{E as M}from"./el-image-viewer-CAyj13Vk.js";import{u as U}from"./index-Cp1P3COd.js";const Z={class:"h-24 cursor-pointer center bg-night hover:border-2 hover:border-purple box-border overflow-hidden"},j=["src"],q={class:"flex-1 overflow-hidden flex gap-4 items-center"},G=["src"],H={key:2,class:"relative w-24"},J={class:"h-24 flex flex-col cursor-pointer center hover:border-2 hover:border-purple box-border overflow-hidden"},K={class:"w-20 text-center text-ellipsis overflow-hidden whitespace-nowrap"},L={class:"whitespace-pre overflow-auto max-h-[600px] select-text"},oe=T({__name:"ResourceItem",props:{resource:{},type:{},noAction:{type:Boolean}},setup(D){const v=D,l=V(),g=B(),{toClipboard:S}=U(),m=R(!1);async function b(e){e.stopPropagation(),l.dragData.dataInfo=v.resource,l.dragData.dragType=v.type,l.dragData.dragPoint.x=e.offsetX,l.dragData.dragPoint.y=e.offsetY,l.selectTrackItem.line=-1,l.selectTrackItem.index=-1}async function y(e){e.stopPropagation();const r=await l.createTrack(v.resource);l.addTrack(r)}const w=e=>e.result?e.result:e.type==="text"?e.content:"",I=async e=>{var r;try{const i=((r=window.getSelection())==null?void 0:r.toString())||"";await S(i===""?e:i),Y.success("复制成功")}catch(i){console.error(i)}};return(e,r)=>{const i=M,z=A,u=C,k=F,_=C;return["image","video"].includes(e.type)?(c(),d("div",{key:0,class:"relative w-24",draggable:"true",onDragstart:b},[t("div",Z,[o(i,{class:"max-h-full max-w-full","preview-teleported":"",src:"cover"in e.resource?e.resource.cover:e.resource.url,"preview-src-list":["cover"in e.resource?e.resource.cover:e.resource.url]},null,8,["src","preview-src-list"]),m.value?(c(),P(z,{key:0,title:"原始视频",center:"",modelValue:m.value,"onUpdate:modelValue":r[0]||(r[0]=a=>m.value=a)},{default:s(()=>[t("video",{controls:"",src:"url"in e.resource?e.resource.url:""},null,8,j)]),_:1},8,["modelValue"])):p("",!0)]),x(t("span",{class:"h-5 absolute bottom-1 right-2 text-xs text-gray-400"},f("duration"in e.resource&&e.resource.duration?e.resource.duration.toFixed(1):0)+" s",513),[[$,"duration"in e.resource&&e.resource.duration]]),t("div",{class:"absolute top-2 right-2 bg-red-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:r[1]||(r[1]=a=>n(g).removeResource(e.resource.id))},[o(u,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:s(()=>[o(n(h))]),_:1})]),e.noAction?p("",!0):(c(),d("div",{key:0,class:"absolute bottom-2 right-1 bg-blue-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:y},[o(u,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:s(()=>[o(n(E))]),_:1})]))],32)):e.type==="audio"?(c(),d("div",{key:1,class:"relative w-full h-10 flex items-center py-1 px-2 gap-2 overflow-hidden",draggable:"true",onDragstart:b},[t("div",q,[o(k,null,{reference:s(()=>[t("audio",{class:"h-10",controls:"",preload:"metadata",src:"url"in e.resource?e.resource.url:""},null,8,G)]),default:s(()=>{var a;return[t("div",null,f((a=e.resource.meta)==null?void 0:a.prompt),1)]}),_:1})]),t("div",{class:"bg-red-500 rounded-full w-6 h-6",onClick:r[2]||(r[2]=a=>n(g).removeResource(e.resource.id))},[o(u,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:s(()=>[o(n(h))]),_:1})]),e.noAction?p("",!0):(c(),d("div",{key:0,class:"bg-blue-500 rounded-full w-6 h-6",onClick:y},[o(u,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:s(()=>[o(n(E))]),_:1})]))],32)):e.type==="text"?(c(),d("div",H,[o(k,{trigger:"click",placement:"right",width:400},{reference:s(()=>{var a;return[t("div",J,[o(_,{size:"30"},{default:s(()=>[o(n(N))]),_:1}),t("div",K,f((a=e.resource.meta)==null?void 0:a.prompt),1)])]}),default:s(()=>[t("div",L,f(w(e.resource)),1),t("button",{class:"absolute top-4 right-6 bg-night-light",onClick:r[3]||(r[3]=()=>I(w(e.resource)))},[o(_,{size:"18",color:"#1473e6"},{default:s(()=>[o(n(X))]),_:1})])]),_:1}),t("div",{class:"absolute top-2 right-1 bg-red-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:r[4]||(r[4]=a=>n(g).removeResource(e.resource.id))},[o(u,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:s(()=>[o(n(h))]),_:1})])])):p("",!0)}}});export{oe as _};
