import{d as L,O as S,C,r as h,D as V,P as R,z as U,g as o,k as i,f as p,w as D,u as e,I as g,h as _,Q as O,R as j,p as z,n as B,Y as E,i as N,e as s,a7 as P,ay as $}from"./index-DnwN-RZ1.js";import{L as F}from"./Loading-BP_LpVh7.js";import{g as w}from"./canvasUtil-Cql1jrBt.js";const M={class:"flex flex-col rounded overflow-hidden h-full"},G={class:"flex items-center text-xs pl-2 overflow-hidden h-5 leading-5 bg-[#4b4f54] text-white"},Q={key:0,class:"mr-4 shrink-0"},T={class:"shrink-0"},W=["src"],Y={key:0,class:"pl-2 overflow-hidden h-4 flex items-center bg-gray-700 relative text-xs overflow-ellipsis whitespace-nowrap text-white"},J=L({__name:"VideoItem",props:{trackItem:{type:Object}},setup(a){const n=a,k=S(),l=C(),x=h(),d=h(!0),m=h([]),t=V(()=>n.trackItem.resource);async function y(){if(!t.value){console.error("Video resource not found");return}try{k.ingLoadingCount++,d.value=!0;const r=w(l.trackScale,n.trackItem.frameCount),v=Math.ceil(r/50),u=Math.ceil(t.value.duration*1e6/v),f=await $.thumbnails(n.trackItem,l.trackScale,u);m.value=f.map(({img:c})=>URL.createObjectURL(c))}finally{d.value=!1,k.ingLoadingCount--}}return R(()=>[n.trackItem,t.value],y,{immediate:!0,flush:"post"}),U(()=>{m.value.forEach(r=>{URL.revokeObjectURL(r)})}),(r,v)=>{var c;const u=P,f=N;return s(),o("div",M,[i("div",G,[p(f,{size:"18"},{default:D(()=>[p(u,{class:"inline-block mr-2 shrink-0"})]),_:1}),e(t)?(s(),o("span",Q," ["+g(e(t).duration.toFixed(1))+"s] ",1)):_("",!0),i("span",T,g(`${a.trackItem.name}.${a.trackItem.format}`),1)]),i("div",{ref_key:"container",ref:x,class:"bg-gray-400 bg-opacity-70 flex-1 relative whitespace-nowrap overflow-hidden",style:z({left:`-${e(w)(e(l).trackScale,a.trackItem.offsetL)}px`})},[(s(!0),o(O,null,j(e(m),(I,b)=>(s(),o("img",{key:b,src:I,alt:"",class:"image-item",draggable:"false"},null,8,W))),128))],4),(c=e(t).meta)!=null&&c.prompt?(s(),o("div",Y,[i("span",null,g(e(t).meta.prompt),1)])):_("",!0),B(p(F,{class:"pl-12 bg-opacity-70"},null,512),[[E,e(d)||a.trackItem.loading]])])}}});export{J as _};
