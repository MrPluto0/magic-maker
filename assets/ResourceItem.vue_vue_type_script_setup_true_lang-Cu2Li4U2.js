import{d as D,D as S,U as E,r as V,g as l,h as r,f,c as z,w as a,i as u,q as T,V as B,I as d,u as v,p as I,e as n,E as R}from"./index-C9HzHbyJ.js";import{E as P}from"./el-popover-ClIMayzq.js";import{E as A}from"./el-image-viewer-CtlOkK0q.js";import{u as N}from"./index-NT0ps5Vv.js";const $={class:"h-24 cursor-pointer center bg-night hover:border-2 hover:border-purple box-border overflow-hidden"},U=["src"],q={class:"flex-1 overflow-hidden flex gap-4 items-center"},F=["src"],M={key:2,class:"relative w-24"},X={class:"h-24 flex flex-col cursor-pointer center hover:border-2 hover:border-purple box-border overflow-hidden"},Y={class:"w-20 text-center text-ellipsis overflow-hidden whitespace-nowrap"},j={class:"whitespace-pre overflow-auto max-h-[600px] select-text"},L=D({__name:"ResourceItem",props:{resource:{},type:{},noAction:{type:Boolean}},setup(h){const c=h,s=S(),p=E(),{toClipboard:k}=N(),m=V(!1);async function g(e){e.stopPropagation(),s.dragData.dataInfo=c.resource,s.dragData.dragType=c.type,s.dragData.dragPoint.x=e.offsetX,s.dragData.dragPoint.y=e.offsetY,s.selectTrackItem.line=-1,s.selectTrackItem.index=-1}async function y(e){e.stopPropagation();const o=await s.createTrack(c.resource);s.addTrack(o)}const w=e=>e.result?e.result:e.type==="text"?e.content:"",x=async e=>{var o;try{const i=((o=window.getSelection())==null?void 0:o.toString())||"";await k(i===""?e:i),R.success("复制成功")}catch(i){console.error(i)}};return(e,o)=>{const i=A,C=I,b=P;return["image","video"].includes(e.type)?(n(),l("div",{key:0,class:"relative w-24",draggable:"true",onDragstart:g},[r("div",$,[f(i,{class:"max-h-full max-w-full","preview-teleported":"",src:"cover"in e.resource?e.resource.cover:e.resource.url,"preview-src-list":["cover"in e.resource?e.resource.cover:e.resource.url]},null,8,["src","preview-src-list"]),m.value?(n(),z(C,{key:0,title:"原始视频",center:"",modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=t=>m.value=t)},{default:a(()=>[r("video",{controls:"",src:"url"in e.resource?e.resource.url:""},null,8,U)]),_:1},8,["modelValue"])):u("",!0)]),T(r("span",{class:"h-5 absolute bottom-1 right-2 text-xs text-gray-400"},d("duration"in e.resource&&e.resource.duration?e.resource.duration.toFixed(1):0)+" s",513),[[B,"duration"in e.resource&&e.resource.duration]]),r("div",{class:"absolute top-2 right-2 bg-red-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:o[1]||(o[1]=t=>v(p).removeResource(e.resource.id))},o[5]||(o[5]=[r("i",{class:"i-mdi-minus text-white cursor-pointer p-1 box-content",style:{"font-size":"16px"}},null,-1)])),e.noAction?u("",!0):(n(),l("div",{key:0,class:"absolute bottom-2 right-1 bg-blue-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:y},o[6]||(o[6]=[r("i",{class:"i-mdi-plus text-white cursor-pointer p-1 box-content",style:{"font-size":"16px"}},null,-1)])))],32)):e.type==="audio"?(n(),l("div",{key:1,class:"relative w-full h-10 flex items-center py-1 px-2 gap-2 overflow-hidden",draggable:"true",onDragstart:g},[r("div",q,[f(b,null,{reference:a(()=>[r("audio",{class:"h-10",controls:"",preload:"metadata",src:"url"in e.resource?e.resource.url:""},null,8,F)]),default:a(()=>{var t;return[r("div",null,d((t=e.resource.meta)==null?void 0:t.prompt),1)]}),_:1})]),r("div",{class:"bg-red-500 rounded-full w-6 h-6",onClick:o[2]||(o[2]=t=>v(p).removeResource(e.resource.id))},o[7]||(o[7]=[r("i",{class:"i-mdi-minus text-white cursor-pointer p-1 box-content",style:{"font-size":"16px"}},null,-1)])),e.noAction?u("",!0):(n(),l("div",{key:0,class:"bg-blue-500 rounded-full w-6 h-6",onClick:y},o[8]||(o[8]=[r("i",{class:"i-mdi-plus text-white cursor-pointer p-1 box-content",style:{"font-size":"16px"}},null,-1)])))],32)):e.type==="text"?(n(),l("div",M,[f(b,{trigger:"click",placement:"right",width:400},{reference:a(()=>{var t;return[r("div",X,[o[9]||(o[9]=r("i",{class:"i-mdi-folder-open",style:{"font-size":"30px"}},null,-1)),r("div",Y,d((t=e.resource.meta)==null?void 0:t.prompt),1)])]}),default:a(()=>[r("div",j,d(w(e.resource)),1),r("button",{class:"absolute top-4 right-6 bg-night-light",onClick:o[3]||(o[3]=()=>x(w(e.resource)))},o[10]||(o[10]=[r("i",{class:"i-mdi-content-copy",style:{"font-size":"18px",color:"#1473e6"}},null,-1)]))]),_:1}),r("div",{class:"absolute top-2 right-1 bg-red-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:o[4]||(o[4]=t=>v(p).removeResource(e.resource.id))},o[11]||(o[11]=[r("i",{class:"i-mdi-minus text-white cursor-pointer p-1 box-content",style:{"font-size":"16px"}},null,-1)]))])):u("",!0)}}});export{L as _};
