import{l as Se,s as Ne,t as Y,b as ye,d as H,v as be,x as de,a as se,y as ge,z as xe,A as Oe,B as ke,u as _e,C as Te,D as _,E as Re,F as Ae,e as p,G as fe,H as Ce,I as Ie,o as k,J as ve,K as y,L as f,T as $e,M as b,n as m,g as t,j as he,N as Ye,O as Me,i as E,P as T,Q as Xe,f as N,R as ne,S as Be,U as Pe,V as Ve,W as De,X as Fe,Y as He,Z as je,$ as We,a0 as Ke,a1 as Ze,h as ae,a2 as qe,k as Le,a3 as M,a4 as $,a5 as Ge,w as ze,a6 as Ue,a7 as Je,a8 as Qe,a9 as et,aa as tt,ab as we,ac as at,ad as nt,ae as st,af as lt}from"./index-DUIAo018.js";var ot="Expected a function";function ue(s,r,n){var v=!0,l=!0;if(typeof s!="function")throw new TypeError(ot);return Se(n)&&(v="leading"in n?!!n.leading:v,l="trailing"in n?!!n.trailing:l),Ne(s,r,{leading:v,maxWait:r,trailing:l})}const it=(s,r)=>{if(!Y||!s||!r)return!1;const n=s.getBoundingClientRect();let v;return r instanceof Element?v=r.getBoundingClientRect():v={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},n.top<v.bottom&&n.bottom>v.top&&n.right>v.left&&n.left<v.right},bt=s=>{let r,n;return s.type==="touchend"?(n=s.changedTouches[0].clientY,r=s.changedTouches[0].clientX):s.type.startsWith("touch")?(n=s.touches[0].clientY,r=s.touches[0].clientX):(n=s.clientY,r=s.clientX),{clientX:r,clientY:n}},rt=ye({urlList:{type:H(Array),default:()=>be([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:H(String)}}),ct={close:()=>!0,switch:s=>de(s),rotate:s=>de(s)},ut=se({name:"ElImageViewer"}),dt=se({...ut,props:rt,emits:ct,setup(s,{expose:r,emit:n}){var v;const l=s,g={CONTAIN:{name:"contain",icon:ge(xe)},ORIGINAL:{name:"original",icon:ge(Oe)}},{t:le}=ke(),i=_e("image-viewer"),{nextZIndex:oe}=Te(),R=_(),x=_([]),S=Re(),I=_(!0),h=_(l.initialIndex),w=Ae(g.CONTAIN),c=_({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),X=_((v=l.zIndex)!=null?v:oe()),B=p(()=>{const{urlList:a}=l;return a.length<=1}),j=p(()=>h.value===0),W=p(()=>h.value===l.urlList.length-1),P=p(()=>l.urlList[h.value]),ie=p(()=>[i.e("btn"),i.e("prev"),i.is("disabled",!l.infinite&&j.value)]),K=p(()=>[i.e("btn"),i.e("next"),i.is("disabled",!l.infinite&&W.value)]),V=p(()=>{const{scale:a,deg:d,offsetX:o,offsetY:C,enableTransition:L}=c.value;let z=o/a,O=C/a;const F=d*Math.PI/180,me=Math.cos(F),pe=Math.sin(F);z=z*me+O*pe,O=O*me-o/a*pe;const ce={transform:`scale(${a}) rotate(${d}deg) translate(${z}px, ${O}px)`,transition:L?"transform .3s":""};return w.value.name===g.CONTAIN.name&&(ce.maxWidth=ce.maxHeight="100%"),ce});function A(){Z(),n("close")}function re(){const a=ue(o=>{switch(o.code){case $.esc:l.closeOnPressEscape&&A();break;case $.space:Q();break;case $.left:ee();break;case $.up:u("zoomIn");break;case $.right:e();break;case $.down:u("zoomOut");break}}),d=ue(o=>{const C=o.deltaY||o.deltaX;u(C<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});S.run(()=>{M(document,"keydown",a),M(document,"wheel",d)})}function Z(){S.stop()}function q(){I.value=!1}function G(a){I.value=!1,a.target.alt=le("el.image.error")}function U(a){if(I.value||a.button!==0||!R.value)return;c.value.enableTransition=!1;const{offsetX:d,offsetY:o}=c.value,C=a.pageX,L=a.pageY,z=ue(F=>{c.value={...c.value,offsetX:d+F.pageX-C,offsetY:o+F.pageY-L}}),O=M(document,"mousemove",z);M(document,"mouseup",()=>{O()}),a.preventDefault()}function J(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Q(){if(I.value)return;const a=Ge(g),d=Object.values(g),o=w.value.name,L=(d.findIndex(z=>z.name===o)+1)%a.length;w.value=g[a[L]],J()}function D(a){const d=l.urlList.length;h.value=(a+d)%d}function ee(){j.value&&!l.infinite||D(h.value-1)}function e(){W.value&&!l.infinite||D(h.value+1)}function u(a,d={}){if(I.value)return;const{minScale:o,maxScale:C}=l,{zoomRate:L,rotateDeg:z,enableTransition:O}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...d};switch(a){case"zoomOut":c.value.scale>o&&(c.value.scale=Number.parseFloat((c.value.scale/L).toFixed(3)));break;case"zoomIn":c.value.scale<C&&(c.value.scale=Number.parseFloat((c.value.scale*L).toFixed(3)));break;case"clockwise":c.value.deg+=z,n("rotate",c.value.deg);break;case"anticlockwise":c.value.deg-=z,n("rotate",c.value.deg);break}c.value.enableTransition=O}function te(a){var d;((d=a.detail)==null?void 0:d.focusReason)==="pointer"&&a.preventDefault()}function Ee(){l.closeOnPressEscape&&A()}return fe(P,()=>{Ce(()=>{const a=x.value[0];a!=null&&a.complete||(I.value=!0)})}),fe(h,a=>{J(),n("switch",a)}),Ie(()=>{re()}),r({setActiveItem:D}),(a,d)=>(k(),ve(t(qe),{to:"body",disabled:!a.teleported},{default:y(()=>[f($e,{name:"viewer-fade",appear:""},{default:y(()=>[b("div",{ref_key:"wrapper",ref:R,tabindex:-1,class:m(t(i).e("wrapper")),style:he({zIndex:X.value})},[f(t(Ye),{loop:"",trapped:"","focus-trap-el":R.value,"focus-start-el":"container",onFocusoutPrevented:te,onReleaseRequested:Ee},{default:y(()=>[b("div",{class:m(t(i).e("mask")),onClick:Me(o=>a.hideOnClickModal&&A(),["self"])},null,10,["onClick"]),E(" CLOSE "),b("span",{class:m([t(i).e("btn"),t(i).e("close")]),onClick:A},[f(t(T),null,{default:y(()=>[f(t(Xe))]),_:1})],2),E(" ARROW "),t(B)?E("v-if",!0):(k(),N(ne,{key:0},[b("span",{class:m(t(ie)),onClick:ee},[f(t(T),null,{default:y(()=>[f(t(Be))]),_:1})],2),b("span",{class:m(t(K)),onClick:e},[f(t(T),null,{default:y(()=>[f(t(Pe))]),_:1})],2)],64)),E(" ACTIONS "),b("div",{class:m([t(i).e("btn"),t(i).e("actions")])},[b("div",{class:m(t(i).e("actions__inner"))},[f(t(T),{onClick:o=>u("zoomOut")},{default:y(()=>[f(t(Ve))]),_:1},8,["onClick"]),f(t(T),{onClick:o=>u("zoomIn")},{default:y(()=>[f(t(De))]),_:1},8,["onClick"]),b("i",{class:m(t(i).e("actions__divider"))},null,2),f(t(T),{onClick:Q},{default:y(()=>[(k(),ve(Fe(t(w).icon)))]),_:1}),b("i",{class:m(t(i).e("actions__divider"))},null,2),f(t(T),{onClick:o=>u("anticlockwise")},{default:y(()=>[f(t(He))]),_:1},8,["onClick"]),f(t(T),{onClick:o=>u("clockwise")},{default:y(()=>[f(t(je))]),_:1},8,["onClick"])],2)],2),E(" CANVAS "),b("div",{class:m(t(i).e("canvas"))},[(k(!0),N(ne,null,We(a.urlList,(o,C)=>Ke((k(),N("img",{ref_for:!0,ref:L=>x.value[C]=L,key:o,src:o,style:he(t(V)),class:m(t(i).e("img")),crossorigin:a.crossorigin,onLoad:q,onError:G,onMousedown:U},null,46,["src","crossorigin"])),[[Ze,C===h.value]])),128))],2),ae(a.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var ft=Le(dt,[["__file","image-viewer.vue"]]);const vt=ze(ft),mt=ye({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:H([String,Object])},previewSrcList:{type:H(Array),default:()=>be([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:H(String)}}),pt={load:s=>s instanceof Event,error:s=>s instanceof Event,switch:s=>de(s),close:()=>!0,show:()=>!0},gt=se({name:"ElImage",inheritAttrs:!1}),ht=se({...gt,props:mt,emits:pt,setup(s,{emit:r}){const n=s;let v="";const{t:l}=ke(),g=_e("image"),le=Ue(),i=p(()=>Je(Object.entries(le).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),oe=Qe({excludeListeners:!0,excludeKeys:p(()=>Object.keys(i.value))}),R=_(),x=_(!1),S=_(!0),I=_(!1),h=_(),w=_(),c=Y&&"loading"in HTMLImageElement.prototype;let X,B;const j=p(()=>[g.e("inner"),P.value&&g.e("preview"),S.value&&g.is("loading")]),W=p(()=>{const{fit:e}=n;return Y&&e?{objectFit:e}:{}}),P=p(()=>{const{previewSrcList:e}=n;return et(e)&&e.length>0}),ie=p(()=>{const{previewSrcList:e,initialIndex:u}=n;let te=u;return u>e.length-1&&(te=0),te}),K=p(()=>n.loading==="eager"?!1:!c&&n.loading==="lazy"||n.lazy),V=()=>{Y&&(S.value=!0,x.value=!1,R.value=n.src)};function A(e){S.value=!1,x.value=!1,r("load",e)}function re(e){S.value=!1,x.value=!0,r("error",e)}function Z(){it(h.value,w.value)&&(V(),U())}const q=lt(Z,200,!0);async function G(){var e;if(!Y)return;await Ce();const{scrollContainer:u}=n;at(u)?w.value=u:nt(u)&&u!==""?w.value=(e=document.querySelector(u))!=null?e:void 0:h.value&&(w.value=st(h.value)),w.value&&(X=M(w,"scroll",q),setTimeout(()=>Z(),100))}function U(){!Y||!w.value||!q||(X==null||X(),w.value=void 0)}function J(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function Q(){P.value&&(B=M("wheel",J,{passive:!1}),v=document.body.style.overflow,document.body.style.overflow="hidden",I.value=!0,r("show"))}function D(){B==null||B(),document.body.style.overflow=v,I.value=!1,r("close")}function ee(e){r("switch",e)}return fe(()=>n.src,()=>{K.value?(S.value=!0,x.value=!1,U(),G()):V()}),Ie(()=>{K.value?G():V()}),(e,u)=>(k(),N("div",we({ref_key:"container",ref:h},t(i),{class:[t(g).b(),e.$attrs.class]}),[x.value?ae(e.$slots,"error",{key:0},()=>[b("div",{class:m(t(g).e("error"))},tt(t(l)("el.image.error")),3)]):(k(),N(ne,{key:1},[R.value!==void 0?(k(),N("img",we({key:0},t(oe),{src:R.value,loading:e.loading,style:t(W),class:t(j),crossorigin:e.crossorigin,onClick:Q,onLoad:A,onError:re}),null,16,["src","loading","crossorigin"])):E("v-if",!0),S.value?(k(),N("div",{key:1,class:m(t(g).e("wrapper"))},[ae(e.$slots,"placeholder",{},()=>[b("div",{class:m(t(g).e("placeholder"))},null,2)])],2)):E("v-if",!0)],64)),t(P)?(k(),N(ne,{key:2},[I.value?(k(),ve(t(vt),{key:0,"z-index":e.zIndex,"initial-index":t(ie),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:D,onSwitch:ee},{default:y(()=>[e.$slots.viewer?(k(),N("div",{key:0},[ae(e.$slots,"viewer")])):E("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):E("v-if",!0)],64)):E("v-if",!0)],16))}});var wt=Le(ht,[["__file","image.vue"]]);const kt=ze(wt);export{kt as E,bt as g};
