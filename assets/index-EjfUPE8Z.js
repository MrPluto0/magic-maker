var Fl=e=>{throw TypeError(e)};var Wf=(e,t,r)=>t.has(e)||Fl("Cannot "+r);var $l=(e,t,r)=>t.has(e)?Fl("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r);var In=(e,t,r)=>(Wf(e,t,"access private method"),r);import{bt as Xf,bu as Nl,bv as Yf,bw as zl,bx as Vl,by as Hl,bz as Gl,bA as Ii,bB as Uf,bC as Uo,bD as Wl,ay as jf,bE as qf,bF as u0,bG as c0,bH as zn,bI as Kf,bJ as Zf,bK as Qf,b as Zr,bL as Jf,a as vt,bc as Os,u as vr,e as Xe,o as se,f as Te,s as ue,h as Bt,n as Ye,g as B,C as _t,D as Ce,y as Z,aL as Fa,R as ar,W as Ht,i as ct,j as Ct,au as ed,k as yr,w as da,aA as Ps,a_ as Yr,b0 as td,d as Pt,t as ji,aJ as $a,M as rt,a1 as Gr,B as Nt,v as jo,aV as cn,as as jn,b4 as f0,bM as Qr,b5 as d0,b9 as Jr,b1 as wn,b8 as Da,b6 as Ls,bN as Xl,bo as sa,bO as v0,O as jt,P as er,ba as p0,bd as ja,br as h0,bP as g0,A as hr,az as Na,a8 as Tr,bs as qi,a3 as Kt,a2 as Rr,G as on,I as rn,E as Ut,x as dt,a$ as Wn,bf as m0,av as Hr,bq as va,bl as Fi,bQ as yn,bR as ra,bS as rd,bT as nd,l as _0,bp as Ki,bU as b0,bV as On,bW as ad,bX as id,bY as od,bb as pi,bZ as Yl,aD as sd,aB as Vn,b_ as qo,b$ as ld,c0 as Ul,c1 as y0,bn as ud,c2 as cd,a4 as fd,c3 as Pr,c4 as dd,c5 as x0,aQ as en,c6 as vd,c7 as pd,c8 as S0,c9 as jl,ca as Mo,cb as hd,cc as gd,cd as md,ce as w0,cf as C0,bk as Fs,aC as Ko,cg as _r,Q as _d,aP as bd,T as yd,ch as xd,ci as ql,cj as Sd,ck as wd,cl as Cd,bj as Kl,cm as Ed,cn as sr,co as br,a5 as sn,F as Zt,cp as Nr,cq as Md,cr as kd,cs as Td,X as ln,ct as pa,aw as E0,ax as M0,cu as Zl,cv as Rd,cw as Dd,cx as Ad,cy as Id,cz as Bd,cA as Od,cB as Pd,a9 as k0,cC as Ld,cD as $s,cE as Fd,cF as T0,cG as R0,cH as Ns,cI as $d,cJ as Nd,cK as zd,cL as D0,cM as qn,cN as A0,cO as Vd,cP as Hd,cQ as Gd,cR as I0,cS as qa,bg as ko,bi as Ql,cT as Wd,K as Xd,cU as B0,cV as O0,cW as Yd,cX as Ud,cY as jd,cZ as qd,c_ as Kd,U as Zo,c$ as Zd,z as P0,d0 as Qd}from"./index-D_A9KGA0.js";import{g as zs,b as Zi,a as Ka,d as Jd,E as ev,G as tv,I as Qo,M as rv,T as nv,R as av,h as Or}from"./hotkeys.esm-2VKegET4.js";import{E as iv}from"./el-empty-HNMTnzwe.js";function ov(e,t,r,n){e.length;for(var a=r+1;a--;)if(t(e[a],a,e))return a;return-1}var sv="__lodash_hash_undefined__";function lv(e){return this.__data__.set(e,sv),this}function uv(e){return this.__data__.has(e)}function $i(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Xf;++t<r;)this.add(e[t])}$i.prototype.add=$i.prototype.push=lv;$i.prototype.has=uv;function cv(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function fv(e,t){return e.has(t)}var dv=1,vv=2;function L0(e,t,r,n,a,i){var o=r&dv,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var u=i.get(e),c=i.get(t);if(u&&c)return u==t&&c==e;var f=-1,d=!0,h=r&vv?new $i:void 0;for(i.set(e,t),i.set(t,e);++f<s;){var v=e[f],p=t[f];if(n)var g=o?n(p,v,f,t,e,i):n(v,p,f,e,t,i);if(g!==void 0){if(g)continue;d=!1;break}if(h){if(!cv(t,function(b,y){if(!fv(h,y)&&(v===b||a(v,b,r,n,i)))return h.push(y)})){d=!1;break}}else if(!(v===p||a(v,p,r,n,i))){d=!1;break}}return i.delete(e),i.delete(t),d}function pv(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}function hv(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var gv=1,mv=2,_v="[object Boolean]",bv="[object Date]",yv="[object Error]",xv="[object Map]",Sv="[object Number]",wv="[object RegExp]",Cv="[object Set]",Ev="[object String]",Mv="[object Symbol]",kv="[object ArrayBuffer]",Tv="[object DataView]",Jl=Nl?Nl.prototype:void 0,To=Jl?Jl.valueOf:void 0;function Rv(e,t,r,n,a,i,o){switch(r){case Tv:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case kv:return!(e.byteLength!=t.byteLength||!i(new zl(e),new zl(t)));case _v:case bv:case Sv:return Yf(+e,+t);case yv:return e.name==t.name&&e.message==t.message;case wv:case Ev:return e==t+"";case xv:var s=pv;case Cv:var l=n&gv;if(s||(s=hv),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;n|=mv,o.set(e,t);var c=L0(s(e),s(t),n,a,i,o);return o.delete(e),c;case Mv:if(To)return To.call(e)==To.call(t)}return!1}var Dv=1,Av=Object.prototype,Iv=Av.hasOwnProperty;function Bv(e,t,r,n,a,i){var o=r&Dv,s=Vl(e),l=s.length,u=Vl(t),c=u.length;if(l!=c&&!o)return!1;for(var f=l;f--;){var d=s[f];if(!(o?d in t:Iv.call(t,d)))return!1}var h=i.get(e),v=i.get(t);if(h&&v)return h==t&&v==e;var p=!0;i.set(e,t),i.set(t,e);for(var g=o;++f<l;){d=s[f];var b=e[d],y=t[d];if(n)var S=o?n(y,b,d,t,e,i):n(b,y,d,e,t,i);if(!(S===void 0?b===y||a(b,y,r,n,i):S)){p=!1;break}g||(g=d=="constructor")}if(p&&!g){var C=e.constructor,T=t.constructor;C!=T&&"constructor"in e&&"constructor"in t&&!(typeof C=="function"&&C instanceof C&&typeof T=="function"&&T instanceof T)&&(p=!1)}return i.delete(e),i.delete(t),p}var Ov=1,eu="[object Arguments]",tu="[object Array]",hi="[object Object]",Pv=Object.prototype,ru=Pv.hasOwnProperty;function Lv(e,t,r,n,a,i){var o=Uo(e),s=Uo(t),l=o?tu:Hl(e),u=s?tu:Hl(t);l=l==eu?hi:l,u=u==eu?hi:u;var c=l==hi,f=u==hi,d=l==u;if(d&&Gl(e)){if(!Gl(t))return!1;o=!0,c=!1}if(d&&!c)return i||(i=new Ii),o||Uf(e)?L0(e,t,r,n,a,i):Rv(e,t,l,r,n,a,i);if(!(r&Ov)){var h=c&&ru.call(e,"__wrapped__"),v=f&&ru.call(t,"__wrapped__");if(h||v){var p=h?e.value():e,g=v?t.value():t;return i||(i=new Ii),a(p,g,r,n,i)}}return d?(i||(i=new Ii),Bv(e,t,r,n,a,i)):!1}function Qi(e,t,r,n,a){return e===t?!0:e==null||t==null||!Wl(e)&&!Wl(t)?e!==e&&t!==t:Lv(e,t,r,n,Qi,a)}var Fv=1,$v=2;function Nv(e,t,r,n){var a=r.length,i=a;if(e==null)return!i;for(e=Object(e);a--;){var o=r[a];if(o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<i;){o=r[a];var s=o[0],l=e[s],u=o[1];if(o[2]){if(l===void 0&&!(s in e))return!1}else{var c=new Ii,f;if(!(f===void 0?Qi(u,l,Fv|$v,n,c):f))return!1}}return!0}function F0(e){return e===e&&!jf(e)}function zv(e){for(var t=qf(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,F0(a)]}return t}function $0(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}function Vv(e){var t=zv(e);return t.length==1&&t[0][2]?$0(t[0][0],t[0][1]):function(r){return r===e||Nv(r,e,t)}}var Hv=1,Gv=2;function Wv(e,t){return u0(e)&&F0(t)?$0(c0(e),t):function(r){var n=zn(r,e);return n===void 0&&n===t?Kf(r,e):Qi(t,n,Hv|Gv)}}function Xv(e){return function(t){return t==null?void 0:t[e]}}function Yv(e){return function(t){return Zf(t,e)}}function Uv(e){return u0(e)?Xv(c0(e)):Yv(e)}function jv(e){return typeof e=="function"?e:e==null?Qf:typeof e=="object"?Uo(e)?Wv(e[0],e[1]):Vv(e):Uv(e)}function qv(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=n-1;return ov(e,jv(t),a)}function Aa(e,t){return Qi(e,t)}const Jo=Zr({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:Jf},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),Kv={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},Zv=vt({name:"ElTag"}),Qv=vt({...Zv,props:Jo,emits:Kv,setup(e,{emit:t}){const r=e,n=Os(),a=vr("tag"),i=Xe(()=>{const{type:u,hit:c,effect:f,closable:d,round:h}=r;return[a.b(),a.is("closable",d),a.m(u||"primary"),a.m(n.value),a.m(f),a.is("hit",c),a.is("round",h)]}),o=u=>{t("close",u)},s=u=>{t("click",u)},l=u=>{var c,f,d;(d=(f=(c=u==null?void 0:u.component)==null?void 0:c.subTree)==null?void 0:f.component)!=null&&d.bum&&(u.component.subTree.component.bum=null)};return(u,c)=>u.disableTransitions?(se(),Te("span",{key:0,class:Ye(B(i)),style:Ct({backgroundColor:u.color}),onClick:s},[ue("span",{class:Ye(B(a).e("content"))},[Bt(u.$slots,"default")],2),u.closable?(se(),_t(B(Ht),{key:0,class:Ye(B(a).e("close")),onClick:ar(o,["stop"])},{default:Ce(()=>[Z(B(Fa))]),_:1},8,["class","onClick"])):ct("v-if",!0)],6)):(se(),_t(ed,{key:1,name:`${B(a).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:l},{default:Ce(()=>[ue("span",{class:Ye(B(i)),style:Ct({backgroundColor:u.color}),onClick:s},[ue("span",{class:Ye(B(a).e("content"))},[Bt(u.$slots,"default")],2),u.closable?(se(),_t(B(Ht),{key:0,class:Ye(B(a).e("close")),onClick:ar(o,["stop"])},{default:Ce(()=>[Z(B(Fa))]),_:1},8,["class","onClick"])):ct("v-if",!0)],6)]),_:3},8,["name"]))}});var Jv=yr(Qv,[["__file","tag.vue"]]);const Kn=da(Jv),_n=new Map;if(Ps){let e;document.addEventListener("mousedown",t=>e=t),document.addEventListener("mouseup",t=>{if(e){for(const r of _n.values())for(const{documentHandler:n}of r)n(t,e);e=void 0}})}function nu(e,t){let r=[];return Yr(t.arg)?r=t.arg:td(t.arg)&&r.push(t.arg),function(n,a){const i=t.instance.popperRef,o=n.target,s=a==null?void 0:a.target,l=!t||!t.instance,u=!o||!s,c=e.contains(o)||e.contains(s),f=e===o,d=r.length&&r.some(v=>v==null?void 0:v.contains(o))||r.length&&r.includes(s),h=i&&(i.contains(o)||i.contains(s));l||u||c||f||d||h||t.value(n,a)}}const N0={beforeMount(e,t){_n.has(e)||_n.set(e,[]),_n.get(e).push({documentHandler:nu(e,t),bindingFn:t.value})},updated(e,t){_n.has(e)||_n.set(e,[]);const r=_n.get(e),n=r.findIndex(i=>i.bindingFn===t.oldValue),a={documentHandler:nu(e,t),bindingFn:t.value};n>=0?r.splice(n,1,a):r.push(a)},unmounted(e){_n.delete(e)}},e1=Zr({color:{type:Pt(Object),required:!0},vertical:{type:Boolean,default:!1}});let Ro=!1;function za(e,t){if(!Ps)return;const r=function(i){var o;(o=t.drag)==null||o.call(t,i)},n=function(i){var o;document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",n),document.removeEventListener("touchmove",r),document.removeEventListener("touchend",n),document.onselectstart=null,document.ondragstart=null,Ro=!1,(o=t.end)==null||o.call(t,i)},a=function(i){var o;Ro||(i.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",r),document.addEventListener("mouseup",n),document.addEventListener("touchmove",r),document.addEventListener("touchend",n),Ro=!0,(o=t.start)==null||o.call(t,i))};e.addEventListener("mousedown",a),e.addEventListener("touchstart",a,{passive:!1})}const t1=e=>{const t=jn(),{t:r}=ji(),n=$a(),a=$a(),i=Xe(()=>e.color.get("alpha")),o=Xe(()=>r("el.colorpicker.alphaLabel"));function s(f){var d;f.target!==n.value&&l(f),(d=n.value)==null||d.focus()}function l(f){if(!a.value||!n.value)return;const h=t.vnode.el.getBoundingClientRect(),{clientX:v,clientY:p}=zs(f);if(e.vertical){let g=p-h.top;g=Math.max(n.value.offsetHeight/2,g),g=Math.min(g,h.height-n.value.offsetHeight/2),e.color.set("alpha",Math.round((g-n.value.offsetHeight/2)/(h.height-n.value.offsetHeight)*100))}else{let g=v-h.left;g=Math.max(n.value.offsetWidth/2,g),g=Math.min(g,h.width-n.value.offsetWidth/2),e.color.set("alpha",Math.round((g-n.value.offsetWidth/2)/(h.width-n.value.offsetWidth)*100))}}function u(f){const{code:d,shiftKey:h}=f,v=h?10:1;switch(d){case cn.left:case cn.down:f.preventDefault(),f.stopPropagation(),c(-v);break;case cn.right:case cn.up:f.preventDefault(),f.stopPropagation(),c(v);break}}function c(f){let d=i.value+f;d=d<0?0:d>100?100:d,e.color.set("alpha",d)}return{thumb:n,bar:a,alpha:i,alphaLabel:o,handleDrag:l,handleClick:s,handleKeydown:u}},r1=(e,{bar:t,thumb:r,handleDrag:n})=>{const a=jn(),i=vr("color-alpha-slider"),o=rt(0),s=rt(0),l=rt();function u(){if(!r.value||e.vertical)return 0;const y=a.vnode.el,S=e.color.get("alpha");return y?Math.round(S*(y.offsetWidth-r.value.offsetWidth/2)/100):0}function c(){if(!r.value)return 0;const y=a.vnode.el;if(!e.vertical)return 0;const S=e.color.get("alpha");return y?Math.round(S*(y.offsetHeight-r.value.offsetHeight/2)/100):0}function f(){if(e.color&&e.color.value){const{r:y,g:S,b:C}=e.color.toRgb();return`linear-gradient(to right, rgba(${y}, ${S}, ${C}, 0) 0%, rgba(${y}, ${S}, ${C}, 1) 100%)`}return""}function d(){o.value=u(),s.value=c(),l.value=f()}Gr(()=>{if(!t.value||!r.value)return;const y={drag:S=>{n(S)},end:S=>{n(S)}};za(t.value,y),za(r.value,y),d()}),Nt(()=>e.color.get("alpha"),()=>d()),Nt(()=>e.color.value,()=>d());const h=Xe(()=>[i.b(),i.is("vertical",e.vertical)]),v=Xe(()=>i.e("bar")),p=Xe(()=>i.e("thumb")),g=Xe(()=>({background:l.value})),b=Xe(()=>({left:jo(o.value),top:jo(s.value)}));return{rootKls:h,barKls:v,barStyle:g,thumbKls:p,thumbStyle:b,update:d}},n1="ElColorAlphaSlider",a1=vt({name:n1}),i1=vt({...a1,props:e1,setup(e,{expose:t}){const r=e,{alpha:n,alphaLabel:a,bar:i,thumb:o,handleDrag:s,handleClick:l,handleKeydown:u}=t1(r),{rootKls:c,barKls:f,barStyle:d,thumbKls:h,thumbStyle:v,update:p}=r1(r,{bar:i,thumb:o,handleDrag:s});return t({update:p,bar:i,thumb:o}),(g,b)=>(se(),Te("div",{class:Ye(B(c))},[ue("div",{ref_key:"bar",ref:i,class:Ye(B(f)),style:Ct(B(d)),onClick:B(l)},null,14,["onClick"]),ue("div",{ref_key:"thumb",ref:o,class:Ye(B(h)),style:Ct(B(v)),"aria-label":B(a),"aria-valuenow":B(n),"aria-orientation":g.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:B(u)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var o1=yr(i1,[["__file","alpha-slider.vue"]]);const s1=vt({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=vr("color-hue-slider"),r=jn(),n=rt(),a=rt(),i=rt(0),o=rt(0),s=Xe(()=>e.color.get("hue"));Nt(()=>s.value,()=>{d()});function l(h){h.target!==n.value&&u(h)}function u(h){if(!a.value||!n.value)return;const p=r.vnode.el.getBoundingClientRect(),{clientX:g,clientY:b}=zs(h);let y;if(e.vertical){let S=b-p.top;S=Math.min(S,p.height-n.value.offsetHeight/2),S=Math.max(n.value.offsetHeight/2,S),y=Math.round((S-n.value.offsetHeight/2)/(p.height-n.value.offsetHeight)*360)}else{let S=g-p.left;S=Math.min(S,p.width-n.value.offsetWidth/2),S=Math.max(n.value.offsetWidth/2,S),y=Math.round((S-n.value.offsetWidth/2)/(p.width-n.value.offsetWidth)*360)}e.color.set("hue",y)}function c(){if(!n.value)return 0;const h=r.vnode.el;if(e.vertical)return 0;const v=e.color.get("hue");return h?Math.round(v*(h.offsetWidth-n.value.offsetWidth/2)/360):0}function f(){if(!n.value)return 0;const h=r.vnode.el;if(!e.vertical)return 0;const v=e.color.get("hue");return h?Math.round(v*(h.offsetHeight-n.value.offsetHeight/2)/360):0}function d(){i.value=c(),o.value=f()}return Gr(()=>{if(!a.value||!n.value)return;const h={drag:v=>{u(v)},end:v=>{u(v)}};za(a.value,h),za(n.value,h),d()}),{bar:a,thumb:n,thumbLeft:i,thumbTop:o,hueValue:s,handleClick:l,update:d,ns:t}}});function l1(e,t,r,n,a,i){return se(),Te("div",{class:Ye([e.ns.b(),e.ns.is("vertical",e.vertical)])},[ue("div",{ref:"bar",class:Ye(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),ue("div",{ref:"thumb",class:Ye(e.ns.e("thumb")),style:Ct({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var u1=yr(s1,[["render",l1],["__file","hue-slider.vue"]]);const c1=Zr({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:f0,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:Qr.teleported,predefine:{type:Pt(Array)},validateEvent:{type:Boolean,default:!0},...d0(["ariaLabel"])}),f1={[Jr]:e=>wn(e)||Da(e),[Ls]:e=>wn(e)||Da(e),activeChange:e=>wn(e)||Da(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},z0=Symbol("colorPickerContextKey"),au=function(e,t,r){return[e,t*r/((e=(2-t)*r)<1?e:2-e)||0,e/2]},d1=function(e){return wn(e)&&e.includes(".")&&Number.parseFloat(e)===1},v1=function(e){return wn(e)&&e.includes("%")},ia=function(e,t){d1(e)&&(e="100%");const r=v1(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),r&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},iu={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},Bi=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),r=e%16;return`${iu[t]||t}${iu[r]||r}`},ou=function({r:e,g:t,b:r}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+r)?"":`#${Bi(e)}${Bi(t)}${Bi(r)}`},Do={A:10,B:11,C:12,D:13,E:14,F:15},Bn=function(e){return e.length===2?(Do[e[0].toUpperCase()]||+e[0])*16+(Do[e[1].toUpperCase()]||+e[1]):Do[e[1].toUpperCase()]||+e[1]},p1=function(e,t,r){t=t/100,r=r/100;let n=t;const a=Math.max(r,.01);r*=2,t*=r<=1?r:2-r,n*=a<=1?a:2-a;const i=(r+t)/2,o=r===0?2*n/(a+n):2*t/(r+t);return{h:e,s:o*100,v:i*100}},su=(e,t,r)=>{e=ia(e,255),t=ia(t,255),r=ia(r,255);const n=Math.max(e,t,r),a=Math.min(e,t,r);let i;const o=n,s=n-a,l=n===0?0:s/n;if(n===a)i=0;else{switch(n){case e:{i=(t-r)/s+(t<r?6:0);break}case t:{i=(r-e)/s+2;break}case r:{i=(e-t)/s+4;break}}i/=6}return{h:i*360,s:l*100,v:o*100}},Ca=function(e,t,r){e=ia(e,360)*6,t=ia(t,100),r=ia(r,100);const n=Math.floor(e),a=e-n,i=r*(1-t),o=r*(1-a*t),s=r*(1-(1-a)*t),l=n%6,u=[r,o,i,i,s,r][l],c=[s,r,r,o,i,i][l],f=[i,i,s,r,r,o][l];return{r:Math.round(u*255),g:Math.round(c*255),b:Math.round(f*255)}};class Ia{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const r in t)Xl(t,r)&&(this[r]=t[r]);t.value?this.fromString(t.value):this.doOnChange()}set(t,r){if(arguments.length===1&&typeof t=="object"){for(const n in t)Xl(t,n)&&this.set(n,t[n]);return}this[`_${t}`]=r,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return Ca(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const r=(n,a,i)=>{this._hue=Math.max(0,Math.min(360,n)),this._saturation=Math.max(0,Math.min(100,a)),this._value=Math.max(0,Math.min(100,i)),this.doOnChange()};if(t.includes("hsl")){const n=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,i)=>i>2?Number.parseFloat(a):Number.parseInt(a,10));if(n.length===4?this._alpha=Number.parseFloat(n[3])*100:n.length===3&&(this._alpha=100),n.length>=3){const{h:a,s:i,v:o}=p1(n[0],n[1],n[2]);r(a,i,o)}}else if(t.includes("hsv")){const n=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,i)=>i>2?Number.parseFloat(a):Number.parseInt(a,10));n.length===4?this._alpha=Number.parseFloat(n[3])*100:n.length===3&&(this._alpha=100),n.length>=3&&r(n[0],n[1],n[2])}else if(t.includes("rgb")){const n=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,i)=>i>2?Number.parseFloat(a):Number.parseInt(a,10));if(n.length===4?this._alpha=Number.parseFloat(n[3])*100:n.length===3&&(this._alpha=100),n.length>=3){const{h:a,s:i,v:o}=su(n[0],n[1],n[2]);r(a,i,o)}}else if(t.includes("#")){const n=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(n))return;let a,i,o;n.length===3?(a=Bn(n[0]+n[0]),i=Bn(n[1]+n[1]),o=Bn(n[2]+n[2])):(n.length===6||n.length===8)&&(a=Bn(n.slice(0,2)),i=Bn(n.slice(2,4)),o=Bn(n.slice(4,6))),n.length===8?this._alpha=Bn(n.slice(6))/255*100:(n.length===3||n.length===6)&&(this._alpha=100);const{h:s,s:l,v:u}=su(a,i,o);r(s,l,u)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:r,_value:n,_alpha:a,format:i}=this;if(this.enableAlpha)switch(i){case"hsl":{const o=au(t,r/100,n/100);this.value=`hsla(${t}, ${Math.round(o[1]*100)}%, ${Math.round(o[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(r)}%, ${Math.round(n)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${ou(Ca(t,r,n))}${Bi(a*255/100)}`;break}default:{const{r:o,g:s,b:l}=Ca(t,r,n);this.value=`rgba(${o}, ${s}, ${l}, ${this.get("alpha")/100})`}}else switch(i){case"hsl":{const o=au(t,r/100,n/100);this.value=`hsl(${t}, ${Math.round(o[1]*100)}%, ${Math.round(o[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(r)}%, ${Math.round(n)}%)`;break}case"rgb":{const{r:o,g:s,b:l}=Ca(t,r,n);this.value=`rgb(${o}, ${s}, ${l})`;break}default:this.value=ou(Ca(t,r,n))}}}const h1=vt({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const t=vr("color-predefine"),{currentColor:r}=sa(z0),n=rt(i(e.colors,e.color));Nt(()=>r.value,o=>{const s=new Ia;s.fromString(o),n.value.forEach(l=>{l.selected=s.compare(l)})}),v0(()=>{n.value=i(e.colors,e.color)});function a(o){e.color.fromString(e.colors[o])}function i(o,s){return o.map(l=>{const u=new Ia;return u.enableAlpha=e.enableAlpha,u.format="rgba",u.fromString(l),u.selected=u.value===s.value,u})}return{rgbaColors:n,handleSelect:a,ns:t}}});function g1(e,t,r,n,a,i){return se(),Te("div",{class:Ye(e.ns.b())},[ue("div",{class:Ye(e.ns.e("colors"))},[(se(!0),Te(jt,null,er(e.rgbaColors,(o,s)=>(se(),Te("div",{key:e.colors[s],class:Ye([e.ns.e("color-selector"),e.ns.is("alpha",o._alpha<100),{selected:o.selected}]),onClick:l=>e.handleSelect(s)},[ue("div",{style:Ct({backgroundColor:o.value})},null,4)],10,["onClick"]))),128))],2)],2)}var m1=yr(h1,[["render",g1],["__file","predefine.vue"]]);const _1=vt({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=vr("color-svpanel"),r=jn(),n=rt(0),a=rt(0),i=rt("hsl(0, 100%, 50%)"),o=Xe(()=>{const u=e.color.get("hue"),c=e.color.get("value");return{hue:u,value:c}});function s(){const u=e.color.get("saturation"),c=e.color.get("value"),f=r.vnode.el,{clientWidth:d,clientHeight:h}=f;a.value=u*d/100,n.value=(100-c)*h/100,i.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function l(u){const f=r.vnode.el.getBoundingClientRect(),{clientX:d,clientY:h}=zs(u);let v=d-f.left,p=h-f.top;v=Math.max(0,v),v=Math.min(v,f.width),p=Math.max(0,p),p=Math.min(p,f.height),a.value=v,n.value=p,e.color.set({saturation:v/f.width*100,value:100-p/f.height*100})}return Nt(()=>o.value,()=>{s()}),Gr(()=>{za(r.vnode.el,{drag:u=>{l(u)},end:u=>{l(u)}}),s()}),{cursorTop:n,cursorLeft:a,background:i,colorValue:o,handleDrag:l,update:s,ns:t}}});function b1(e,t,r,n,a,i){return se(),Te("div",{class:Ye(e.ns.b()),style:Ct({backgroundColor:e.background})},[ue("div",{class:Ye(e.ns.e("white"))},null,2),ue("div",{class:Ye(e.ns.e("black"))},null,2),ue("div",{class:Ye(e.ns.e("cursor")),style:Ct({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[ue("div")],6)],6)}var y1=yr(_1,[["render",b1],["__file","sv-panel.vue"]]);const x1=vt({name:"ElColorPicker"}),S1=vt({...x1,props:c1,emits:f1,setup(e,{expose:t,emit:r}){const n=e,{t:a}=ji(),i=vr("color"),{formItem:o}=p0(),s=Os(),l=ja(),{inputId:u,isLabeledByFormItem:c}=h0(n,{formItemContext:o}),f=rt(),d=rt(),h=rt(),v=rt(),p=rt(),g=rt(),{isFocused:b,handleFocus:y,handleBlur:S}=g0(p,{beforeFocus(){return l.value},beforeBlur(Y){var ce;return(ce=v.value)==null?void 0:ce.isFocusInsideContent(Y)},afterBlur(){be(!1),Ne()}});let C=!0;const T=hr(new Ia({enableAlpha:n.showAlpha,format:n.colorFormat||"",value:n.modelValue})),D=rt(!1),P=rt(!1),G=rt(""),W=Xe(()=>!n.modelValue&&!P.value?"transparent":re(T,n.showAlpha)),L=Xe(()=>!n.modelValue&&!P.value?"":T.value),X=Xe(()=>c.value?void 0:n.ariaLabel||a("el.colorpicker.defaultLabel")),M=Xe(()=>c.value?o==null?void 0:o.labelId:void 0),oe=Xe(()=>[i.b("picker"),i.is("disabled",l.value),i.bm("picker",s.value),i.is("focused",b.value)]);function re(Y,ce){if(!(Y instanceof Ia))throw new TypeError("color should be instance of _color Class");const{r:xe,g:De,b:He}=Y.toRgb();return ce?`rgba(${xe}, ${De}, ${He}, ${Y.get("alpha")/100})`:`rgb(${xe}, ${De}, ${He})`}function be(Y){D.value=Y}const ze=Na(be,100,{leading:!0});function Ue(){l.value||be(!0)}function Ge(){ze(!1),Ne()}function Ne(){Tr(()=>{n.modelValue?T.fromString(n.modelValue):(T.value="",Tr(()=>{P.value=!1}))})}function Me(){l.value||ze(!D.value)}function Pe(){T.fromString(G.value)}function Se(){const Y=T.value;r(Jr,Y),r("change",Y),n.validateEvent&&(o==null||o.validate("change").catch(ce=>Fi())),ze(!1),Tr(()=>{const ce=new Ia({enableAlpha:n.showAlpha,format:n.colorFormat||"",value:n.modelValue});T.compare(ce)||Ne()})}function ve(){ze(!1),r(Jr,null),r("change",null),n.modelValue!==null&&n.validateEvent&&(o==null||o.validate("change").catch(Y=>Fi())),Ne()}function j(){D.value&&(Ge(),b.value&&F())}function we(Y){Y.preventDefault(),Y.stopPropagation(),be(!1),Ne()}function A(Y){switch(Y.code){case cn.enter:case cn.numpadEnter:case cn.space:Y.preventDefault(),Y.stopPropagation(),Ue(),g.value.focus();break;case cn.esc:we(Y);break}}function F(){p.value.focus()}function _(){p.value.blur()}return Gr(()=>{n.modelValue&&(G.value=L.value)}),Nt(()=>n.modelValue,Y=>{Y?Y&&Y!==T.value&&(C=!1,T.fromString(Y)):P.value=!1}),Nt(()=>[n.colorFormat,n.showAlpha],()=>{T.enableAlpha=n.showAlpha,T.format=n.colorFormat||T.format,T.doOnChange(),r(Jr,T.value)}),Nt(()=>L.value,Y=>{G.value=Y,C&&r("activeChange",Y),C=!0}),Nt(()=>T.value,()=>{!n.modelValue&&!P.value&&(P.value=!0)}),Nt(()=>D.value,()=>{Tr(()=>{var Y,ce,xe;(Y=f.value)==null||Y.update(),(ce=d.value)==null||ce.update(),(xe=h.value)==null||xe.update()})}),qi(z0,{currentColor:L}),t({color:T,show:Ue,hide:Ge,focus:F,blur:_}),(Y,ce)=>(se(),_t(B(va),{ref_key:"popper",ref:v,visible:D.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[B(i).be("picker","panel"),B(i).b("dropdown"),Y.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:Y.teleported,transition:`${B(i).namespace.value}-zoom-in-top`,persistent:"",onHide:xe=>be(!1)},{content:Ce(()=>[Kt((se(),Te("div",{onKeydown:Rr(we,["esc"])},[ue("div",{class:Ye(B(i).be("dropdown","main-wrapper"))},[Z(u1,{ref_key:"hue",ref:f,class:"hue-slider",color:B(T),vertical:""},null,8,["color"]),Z(y1,{ref_key:"sv",ref:d,color:B(T)},null,8,["color"])],2),Y.showAlpha?(se(),_t(o1,{key:0,ref_key:"alpha",ref:h,color:B(T)},null,8,["color"])):ct("v-if",!0),Y.predefine?(se(),_t(m1,{key:1,ref:"predefine","enable-alpha":Y.showAlpha,color:B(T),colors:Y.predefine},null,8,["enable-alpha","color","colors"])):ct("v-if",!0),ue("div",{class:Ye(B(i).be("dropdown","btns"))},[ue("span",{class:Ye(B(i).be("dropdown","value"))},[Z(B(on),{ref_key:"inputRef",ref:g,modelValue:G.value,"onUpdate:modelValue":xe=>G.value=xe,"validate-event":!1,size:"small",onKeyup:Rr(Pe,["enter"]),onBlur:Pe},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),Z(B(rn),{class:Ye(B(i).be("dropdown","link-btn")),text:"",size:"small",onClick:ve},{default:Ce(()=>[Ut(dt(B(a)("el.colorpicker.clear")),1)]),_:1},8,["class"]),Z(B(rn),{plain:"",size:"small",class:Ye(B(i).be("dropdown","btn")),onClick:Se},{default:Ce(()=>[Ut(dt(B(a)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[B(N0),j]])]),default:Ce(()=>[ue("div",Wn({id:B(u),ref_key:"triggerRef",ref:p},Y.$attrs,{class:B(oe),role:"button","aria-label":B(X),"aria-labelledby":B(M),"aria-description":B(a)("el.colorpicker.description",{color:Y.modelValue||""}),"aria-disabled":B(l),tabindex:B(l)?-1:Y.tabindex,onKeydown:A,onFocus:B(y),onBlur:B(S)}),[B(l)?(se(),Te("div",{key:0,class:Ye(B(i).be("picker","mask"))},null,2)):ct("v-if",!0),ue("div",{class:Ye(B(i).be("picker","trigger")),onClick:Me},[ue("span",{class:Ye([B(i).be("picker","color"),B(i).is("alpha",Y.showAlpha)])},[ue("span",{class:Ye(B(i).be("picker","color-inner")),style:Ct({backgroundColor:B(W)})},[Kt(Z(B(Ht),{class:Ye([B(i).be("picker","icon"),B(i).is("icon-arrow-down")])},{default:Ce(()=>[Z(B(m0))]),_:1},8,["class"]),[[Hr,Y.modelValue||P.value]]),Kt(Z(B(Ht),{class:Ye([B(i).be("picker","empty"),B(i).is("icon-close")])},{default:Ce(()=>[Z(B(Fa))]),_:1},8,["class"]),[[Hr,!Y.modelValue&&!P.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var w1=yr(S1,[["__file","color-picker.vue"]]);const C1=da(w1),V0=Symbol("ElSelectGroup"),Ji=Symbol("ElSelect");function E1(e,t){const r=sa(Ji),n=sa(V0,{disabled:!1}),a=Xe(()=>c(yn(r.props.modelValue),e.value)),i=Xe(()=>{var h;if(r.props.multiple){const v=yn((h=r.props.modelValue)!=null?h:[]);return!a.value&&v.length>=r.props.multipleLimit&&r.props.multipleLimit>0}else return!1}),o=Xe(()=>e.label||(ra(e.value)?"":e.value)),s=Xe(()=>e.value||e.label||""),l=Xe(()=>e.disabled||t.groupDisabled||i.value),u=jn(),c=(h=[],v)=>{if(ra(e.value)){const p=r.props.valueKey;return h&&h.some(g=>rd(zn(g,p))===zn(v,p))}else return h&&h.includes(v)},f=()=>{!e.disabled&&!n.disabled&&(r.states.hoveringIndex=r.optionsArray.indexOf(u.proxy))},d=h=>{const v=new RegExp(nd(h),"i");t.visible=v.test(o.value)||e.created};return Nt(()=>o.value,()=>{!e.created&&!r.props.remote&&r.setSelected()}),Nt(()=>e.value,(h,v)=>{const{remote:p,valueKey:g}=r.props;if(h!==v&&(r.onOptionDestroy(v,u.proxy),r.onOptionCreate(u.proxy)),!e.created&&!p){if(g&&ra(h)&&ra(v)&&h[g]===v[g])return;r.setSelected()}}),Nt(()=>n.disabled,()=>{t.groupDisabled=n.disabled},{immediate:!0}),{select:r,currentLabel:o,currentValue:s,itemSelected:a,isDisabled:l,hoverItem:f,updateOption:d}}const M1=vt({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=vr("select"),r=_0(),n=Xe(()=>[t.be("dropdown","item"),t.is("disabled",B(s)),t.is("selected",B(o)),t.is("hovering",B(d))]),a=hr({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:i,itemSelected:o,isDisabled:s,select:l,hoverItem:u,updateOption:c}=E1(e,a),{visible:f,hover:d}=Ki(a),h=jn().proxy;l.onOptionCreate(h),b0(()=>{const p=h.value,{selected:g}=l.states,b=g.some(y=>y.value===h.value);Tr(()=>{l.states.cachedOptions.get(p)===h&&!b&&l.states.cachedOptions.delete(p)}),l.onOptionDestroy(p,h)});function v(){s.value||l.handleOptionSelect(h)}return{ns:t,id:r,containerKls:n,currentLabel:i,itemSelected:o,isDisabled:s,select:l,hoverItem:u,updateOption:c,visible:f,hover:d,selectOptionClick:v,states:a}}});function k1(e,t,r,n,a,i){return Kt((se(),Te("li",{id:e.id,class:Ye(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMousemove:e.hoverItem,onClick:ar(e.selectOptionClick,["stop"])},[Bt(e.$slots,"default",{},()=>[ue("span",null,dt(e.currentLabel),1)])],42,["id","aria-disabled","aria-selected","onMousemove","onClick"])),[[Hr,e.visible]])}var Vs=yr(M1,[["render",k1],["__file","option.vue"]]);const T1=vt({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=sa(Ji),t=vr("select"),r=Xe(()=>e.props.popperClass),n=Xe(()=>e.props.multiple),a=Xe(()=>e.props.fitInputWidth),i=rt("");function o(){var s;i.value=`${(s=e.selectRef)==null?void 0:s.offsetWidth}px`}return Gr(()=>{o(),On(e.selectRef,o)}),{ns:t,minWidth:i,popperClass:r,isMultiple:n,isFitInputWidth:a}}});function R1(e,t,r,n,a,i){return se(),Te("div",{class:Ye([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:Ct({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(se(),Te("div",{key:0,class:Ye(e.ns.be("dropdown","header"))},[Bt(e.$slots,"header")],2)):ct("v-if",!0),Bt(e.$slots,"default"),e.$slots.footer?(se(),Te("div",{key:1,class:Ye(e.ns.be("dropdown","footer"))},[Bt(e.$slots,"footer")],2)):ct("v-if",!0)],6)}var D1=yr(T1,[["render",R1],["__file","select-dropdown.vue"]]);const A1=11,I1=(e,t)=>{const{t:r}=ji(),n=_0(),a=vr("select"),i=vr("input"),o=hr({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),s=rt(null),l=rt(null),u=rt(null),c=rt(null),f=rt(null),d=rt(null),h=rt(null),v=rt(null),p=rt(null),g=rt(null),b=rt(null),y=rt(null),{isComposing:S,handleCompositionStart:C,handleCompositionUpdate:T,handleCompositionEnd:D}=ad({afterComposition:ee=>Oe(ee)}),{wrapperRef:P,isFocused:G,handleBlur:W}=g0(f,{beforeFocus(){return Ue.value},afterFocus(){e.automaticDropdown&&!L.value&&(L.value=!0,o.menuVisibleOnFocus=!0)},beforeBlur(ee){var Ae,Qe;return((Ae=u.value)==null?void 0:Ae.isFocusInsideContent(ee))||((Qe=c.value)==null?void 0:Qe.isFocusInsideContent(ee))},afterBlur(){L.value=!1,o.menuVisibleOnFocus=!1}}),L=rt(!1),X=rt(),{form:M,formItem:oe}=p0(),{inputId:re}=h0(e,{formItemContext:oe}),{valueOnClear:be,isEmptyValue:ze}=id(e),Ue=Xe(()=>e.disabled||(M==null?void 0:M.disabled)),Ge=Xe(()=>Yr(e.modelValue)?e.modelValue.length>0:!ze(e.modelValue)),Ne=Xe(()=>{var ee;return(ee=M==null?void 0:M.statusIcon)!=null?ee:!1}),Me=Xe(()=>e.clearable&&!Ue.value&&o.inputHovering&&Ge.value),Pe=Xe(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),Se=Xe(()=>a.is("reverse",Pe.value&&L.value)),ve=Xe(()=>(oe==null?void 0:oe.validateState)||""),j=Xe(()=>od[ve.value]),we=Xe(()=>e.remote?300:0),A=Xe(()=>e.loading?e.loadingText||r("el.select.loading"):e.remote&&!o.inputValue&&o.options.size===0?!1:e.filterable&&o.inputValue&&o.options.size>0&&F.value===0?e.noMatchText||r("el.select.noMatch"):o.options.size===0?e.noDataText||r("el.select.noData"):null),F=Xe(()=>_.value.filter(ee=>ee.visible).length),_=Xe(()=>{const ee=Array.from(o.options.values()),Ae=[];return o.optionValues.forEach(Qe=>{const st=ee.findIndex(kt=>kt.value===Qe);st>-1&&Ae.push(ee[st])}),Ae.length>=ee.length?Ae:ee}),Y=Xe(()=>Array.from(o.cachedOptions.values())),ce=Xe(()=>{const ee=_.value.filter(Ae=>!Ae.created).some(Ae=>Ae.currentLabel===o.inputValue);return e.filterable&&e.allowCreate&&o.inputValue!==""&&!ee}),xe=()=>{e.filterable&&Vn(e.filterMethod)||e.filterable&&e.remote&&Vn(e.remoteMethod)||_.value.forEach(ee=>{var Ae;(Ae=ee.updateOption)==null||Ae.call(ee,o.inputValue)})},De=Os(),He=Xe(()=>["small"].includes(De.value)?"small":"default"),Ze=Xe({get(){return L.value&&A.value!==!1},set(ee){L.value=ee}}),je=Xe(()=>{if(e.multiple&&!pi(e.modelValue))return yn(e.modelValue).length===0&&!o.inputValue;const ee=Yr(e.modelValue)?e.modelValue[0]:e.modelValue;return e.filterable||pi(ee)?!o.inputValue:!0}),Fe=Xe(()=>{var ee;const Ae=(ee=e.placeholder)!=null?ee:r("el.select.placeholder");return e.multiple||!Ge.value?Ae:o.selectedLabel}),pt=Xe(()=>Yl?null:"mouseenter");Nt(()=>e.modelValue,(ee,Ae)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(o.inputValue="",Je("")),Ke(),!Aa(ee,Ae)&&e.validateEvent&&(oe==null||oe.validate("change").catch(Qe=>Fi()))},{flush:"post",deep:!0}),Nt(()=>L.value,ee=>{ee?Je(o.inputValue):(o.inputValue="",o.previousQuery=null,o.isBeforeHide=!0),t("visible-change",ee)}),Nt(()=>o.options.entries(),()=>{Ps&&(Ke(),e.defaultFirstOption&&(e.filterable||e.remote)&&F.value&&at())},{flush:"post"}),Nt(()=>o.hoveringIndex,ee=>{sd(ee)&&ee>-1?X.value=_.value[ee]||{}:X.value={},_.value.forEach(Ae=>{Ae.hover=X.value===Ae})}),v0(()=>{o.isBeforeHide||xe()});const Je=ee=>{o.previousQuery===ee||S.value||(o.previousQuery=ee,e.filterable&&Vn(e.filterMethod)?e.filterMethod(ee):e.filterable&&e.remote&&Vn(e.remoteMethod)&&e.remoteMethod(ee),e.defaultFirstOption&&(e.filterable||e.remote)&&F.value?Tr(at):Tr(V))},at=()=>{const ee=_.value.filter(kt=>kt.visible&&!kt.disabled&&!kt.states.groupDisabled),Ae=ee.find(kt=>kt.created),Qe=ee[0],st=_.value.map(kt=>kt.value);o.hoveringIndex=R(st,Ae||Qe)},Ke=()=>{if(e.multiple)o.selectedLabel="";else{const Ae=Yr(e.modelValue)?e.modelValue[0]:e.modelValue,Qe=yt(Ae);o.selectedLabel=Qe.currentLabel,o.selected=[Qe];return}const ee=[];pi(e.modelValue)||yn(e.modelValue).forEach(Ae=>{ee.push(yt(Ae))}),o.selected=ee},yt=ee=>{let Ae;const Qe=qo(ee);for(let Lt=o.cachedOptions.size-1;Lt>=0;Lt--){const Dt=Y.value[Lt];if(Qe?zn(Dt.value,e.valueKey)===zn(ee,e.valueKey):Dt.value===ee){Ae={value:ee,currentLabel:Dt.currentLabel,get isDisabled(){return Dt.isDisabled}};break}}if(Ae)return Ae;const st=Qe?ee.label:ee??"";return{value:ee,currentLabel:st}},V=()=>{o.hoveringIndex=_.value.findIndex(ee=>o.selected.some(Ae=>q(Ae)===q(ee)))},pe=()=>{o.selectionWidth=l.value.getBoundingClientRect().width},me=()=>{o.calculatorWidth=d.value.getBoundingClientRect().width},J=()=>{o.collapseItemWidth=b.value.getBoundingClientRect().width},$e=()=>{var ee,Ae;(Ae=(ee=u.value)==null?void 0:ee.updatePopper)==null||Ae.call(ee)},K=()=>{var ee,Ae;(Ae=(ee=c.value)==null?void 0:ee.updatePopper)==null||Ae.call(ee)},ie=()=>{o.inputValue.length>0&&!L.value&&(L.value=!0),Je(o.inputValue)},Oe=ee=>{if(o.inputValue=ee.target.value,e.remote)he();else return ie()},he=Na(()=>{ie()},we.value),Be=ee=>{Aa(e.modelValue,ee)||t(Ls,ee)},te=ee=>qv(ee,Ae=>{const Qe=o.cachedOptions.get(Ae);return Qe&&!Qe.disabled&&!Qe.states.groupDisabled}),Le=ee=>{if(e.multiple&&ee.code!==cn.delete&&ee.target.value.length<=0){const Ae=yn(e.modelValue).slice(),Qe=te(Ae);if(Qe<0)return;const st=Ae[Qe];Ae.splice(Qe,1),t(Jr,Ae),Be(Ae),t("remove-tag",st)}},le=(ee,Ae)=>{const Qe=o.selected.indexOf(Ae);if(Qe>-1&&!Ue.value){const st=yn(e.modelValue).slice();st.splice(Qe,1),t(Jr,st),Be(st),t("remove-tag",Ae.value)}ee.stopPropagation(),k()},ae=ee=>{ee.stopPropagation();const Ae=e.multiple?[]:be.value;if(e.multiple)for(const Qe of o.selected)Qe.isDisabled&&Ae.push(Qe.value);t(Jr,Ae),Be(Ae),o.hoveringIndex=-1,L.value=!1,t("clear"),k()},m=ee=>{var Ae;if(e.multiple){const Qe=yn((Ae=e.modelValue)!=null?Ae:[]).slice(),st=R(Qe,ee);st>-1?Qe.splice(st,1):(e.multipleLimit<=0||Qe.length<e.multipleLimit)&&Qe.push(ee.value),t(Jr,Qe),Be(Qe),ee.created&&Je(""),e.filterable&&!e.reserveKeyword&&(o.inputValue="")}else t(Jr,ee.value),Be(ee.value),L.value=!1;k(),!L.value&&Tr(()=>{U(ee)})},R=(ee=[],Ae)=>pi(Ae)?-1:ra(Ae.value)?ee.findIndex(Qe=>Aa(zn(Qe,e.valueKey),q(Ae))):ee.indexOf(Ae.value),U=ee=>{var Ae,Qe,st,kt,Lt;const Dt=Yr(ee)?ee[0]:ee;let Ft=null;if(Dt!=null&&Dt.value){const qt=_.value.filter(Wr=>Wr.value===Dt.value);qt.length>0&&(Ft=qt[0].$el)}if(u.value&&Ft){const qt=(kt=(st=(Qe=(Ae=u.value)==null?void 0:Ae.popperRef)==null?void 0:Qe.contentRef)==null?void 0:st.querySelector)==null?void 0:kt.call(st,`.${a.be("dropdown","wrap")}`);qt&&ld(qt,Ft)}(Lt=y.value)==null||Lt.handleScroll()},ne=ee=>{o.options.set(ee.value,ee),o.cachedOptions.set(ee.value,ee)},z=(ee,Ae)=>{o.options.get(ee)===Ae&&o.options.delete(ee)},I=Xe(()=>{var ee,Ae;return(Ae=(ee=u.value)==null?void 0:ee.popperRef)==null?void 0:Ae.contentRef}),N=()=>{o.isBeforeHide=!1,Tr(()=>U(o.selected))},k=()=>{var ee;(ee=f.value)==null||ee.focus()},Q=()=>{var ee;if(L.value){L.value=!1,Tr(()=>{var Ae;return(Ae=f.value)==null?void 0:Ae.blur()});return}(ee=f.value)==null||ee.blur()},w=ee=>{ae(ee)},ye=ee=>{if(L.value=!1,G.value){const Ae=new FocusEvent("focus",ee);Tr(()=>W(Ae))}},O=()=>{o.inputValue.length>0?o.inputValue="":L.value=!1},$=()=>{Ue.value||(Yl&&(o.inputHovering=!0),o.menuVisibleOnFocus?o.menuVisibleOnFocus=!1:L.value=!L.value)},H=()=>{if(!L.value)$();else{const ee=_.value[o.hoveringIndex];ee&&!ee.isDisabled&&m(ee)}},q=ee=>ra(ee.value)?zn(ee.value,e.valueKey):ee.value,de=Xe(()=>_.value.filter(ee=>ee.visible).every(ee=>ee.isDisabled)),x=Xe(()=>e.multiple?e.collapseTags?o.selected.slice(0,e.maxCollapseTags):o.selected:[]),E=Xe(()=>e.multiple?e.collapseTags?o.selected.slice(e.maxCollapseTags):[]:[]),ke=ee=>{if(!L.value){L.value=!0;return}if(!(o.options.size===0||F.value===0||S.value)&&!de.value){ee==="next"?(o.hoveringIndex++,o.hoveringIndex===o.options.size&&(o.hoveringIndex=0)):ee==="prev"&&(o.hoveringIndex--,o.hoveringIndex<0&&(o.hoveringIndex=o.options.size-1));const Ae=_.value[o.hoveringIndex];(Ae.isDisabled||!Ae.visible)&&ke(ee),Tr(()=>U(X.value))}},ge=()=>{if(!l.value)return 0;const ee=window.getComputedStyle(l.value);return Number.parseFloat(ee.gap||"6px")},Ee=Xe(()=>{const ee=ge();return{maxWidth:`${b.value&&e.maxCollapseTags===1?o.selectionWidth-o.collapseItemWidth-ee:o.selectionWidth}px`}}),Ve=Xe(()=>({maxWidth:`${o.selectionWidth}px`})),qe=Xe(()=>({width:`${Math.max(o.calculatorWidth,A1)}px`}));return On(l,pe),On(d,me),On(p,$e),On(P,$e),On(g,K),On(b,J),Gr(()=>{Ke()}),{inputId:re,contentId:n,nsSelect:a,nsInput:i,states:o,isFocused:G,expanded:L,optionsArray:_,hoverOption:X,selectSize:De,filteredOptionsCount:F,resetCalculatorWidth:me,updateTooltip:$e,updateTagTooltip:K,debouncedOnInputChange:he,onInput:Oe,deletePrevTag:Le,deleteTag:le,deleteSelected:ae,handleOptionSelect:m,scrollToOption:U,hasModelValue:Ge,shouldShowPlaceholder:je,currentPlaceholder:Fe,mouseEnterEventName:pt,needStatusIcon:Ne,showClose:Me,iconComponent:Pe,iconReverse:Se,validateState:ve,validateIcon:j,showNewOption:ce,updateOptions:xe,collapseTagSize:He,setSelected:Ke,selectDisabled:Ue,emptyText:A,handleCompositionStart:C,handleCompositionUpdate:T,handleCompositionEnd:D,onOptionCreate:ne,onOptionDestroy:z,handleMenuEnter:N,focus:k,blur:Q,handleClearClick:w,handleClickOutside:ye,handleEsc:O,toggleMenu:$,selectOption:H,getValueKey:q,navigateOptions:ke,dropdownMenuVisible:Ze,showTagList:x,collapseTagList:E,tagStyle:Ee,collapseTagStyle:Ve,inputStyle:qe,popperRef:I,inputRef:f,tooltipRef:u,tagTooltipRef:c,calculatorRef:d,prefixRef:h,suffixRef:v,selectRef:s,wrapperRef:P,selectionRef:l,scrollbarRef:y,menuRef:p,tagMenuRef:g,collapseItemRef:b}};var B1=vt({name:"ElOptions",setup(e,{slots:t}){const r=sa(Ji);let n=[];return()=>{var a,i;const o=(a=t.default)==null?void 0:a.call(t),s=[];function l(u){Yr(u)&&u.forEach(c=>{var f,d,h,v;const p=(f=(c==null?void 0:c.type)||{})==null?void 0:f.name;p==="ElOptionGroup"?l(!wn(c.children)&&!Yr(c.children)&&Vn((d=c.children)==null?void 0:d.default)?(h=c.children)==null?void 0:h.default():c.children):p==="ElOption"?s.push((v=c.props)==null?void 0:v.value):Yr(c.children)&&l(c.children)})}return o.length&&l((i=o[0])==null?void 0:i.children),Aa(s,n)||(n=s,r&&(r.states.optionValues=s)),o}}});const O1=Zr({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:f0,effect:{type:Pt(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Pt(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:Qr.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Ul,default:y0},fitInputWidth:Boolean,suffixIcon:{type:Ul,default:m0},tagType:{...Jo.type,default:"info"},tagEffect:{...Jo.effect,default:"light"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,showArrow:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:Pt(String),values:ud,default:"bottom-start"},fallbackPlacements:{type:Pt(Array),default:["bottom-start","top-start","right","left"]},tabindex:{type:[String,Number],default:0},appendTo:String,...cd,...d0(["ariaLabel"])}),lu="ElSelect",P1=vt({name:lu,componentName:lu,components:{ElSelectMenu:D1,ElOption:Vs,ElOptions:B1,ElTag:Kn,ElScrollbar:fd,ElTooltip:va,ElIcon:Ht},directives:{ClickOutside:N0},props:O1,emits:[Jr,Ls,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const r=Xe(()=>{const{modelValue:o,multiple:s}=e,l=s?[]:void 0;return Yr(o)?s?o:l:s?l:o}),n=hr({...Ki(e),modelValue:r}),a=I1(n,t);qi(Ji,hr({props:n,states:a.states,optionsArray:a.optionsArray,handleOptionSelect:a.handleOptionSelect,onOptionCreate:a.onOptionCreate,onOptionDestroy:a.onOptionDestroy,selectRef:a.selectRef,setSelected:a.setSelected}));const i=Xe(()=>e.multiple?a.states.selected.map(o=>o.currentLabel):a.states.selectedLabel);return{...a,modelValue:r,selectedLabel:i}}});function L1(e,t,r,n,a,i){const o=Pr("el-tag"),s=Pr("el-tooltip"),l=Pr("el-icon"),u=Pr("el-option"),c=Pr("el-options"),f=Pr("el-scrollbar"),d=Pr("el-select-menu"),h=dd("click-outside");return Kt((se(),Te("div",{ref:"selectRef",class:Ye([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),[vd(e.mouseEnterEventName)]:v=>e.states.inputHovering=!0,onMouseleave:v=>e.states.inputHovering=!1},[Z(s,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:v=>e.states.isBeforeHide=!1},{default:Ce(()=>{var v;return[ue("div",{ref:"wrapperRef",class:Ye([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:ar(e.toggleMenu,["prevent"])},[e.$slots.prefix?(se(),Te("div",{key:0,ref:"prefixRef",class:Ye(e.nsSelect.e("prefix"))},[Bt(e.$slots,"prefix")],2)):ct("v-if",!0),ue("div",{ref:"selectionRef",class:Ye([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?Bt(e.$slots,"tag",{key:0},()=>[(se(!0),Te(jt,null,er(e.showTagList,p=>(se(),Te("div",{key:e.getValueKey(p),class:Ye(e.nsSelect.e("selected-item"))},[Z(o,{closable:!e.selectDisabled&&!p.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Ct(e.tagStyle),onClose:g=>e.deleteTag(g,p)},{default:Ce(()=>[ue("span",{class:Ye(e.nsSelect.e("tags-text"))},[Bt(e.$slots,"label",{label:p.currentLabel,value:p.value},()=>[Ut(dt(p.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(se(),_t(s,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:Ce(()=>[ue("div",{ref:"collapseItemRef",class:Ye(e.nsSelect.e("selected-item"))},[Z(o,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Ct(e.collapseTagStyle)},{default:Ce(()=>[ue("span",{class:Ye(e.nsSelect.e("tags-text"))}," + "+dt(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:Ce(()=>[ue("div",{ref:"tagMenuRef",class:Ye(e.nsSelect.e("selection"))},[(se(!0),Te(jt,null,er(e.collapseTagList,p=>(se(),Te("div",{key:e.getValueKey(p),class:Ye(e.nsSelect.e("selected-item"))},[Z(o,{class:"in-tooltip",closable:!e.selectDisabled&&!p.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:g=>e.deleteTag(g,p)},{default:Ce(()=>[ue("span",{class:Ye(e.nsSelect.e("tags-text"))},[Bt(e.$slots,"label",{label:p.currentLabel,value:p.value},()=>[Ut(dt(p.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):ct("v-if",!0)]):ct("v-if",!0),ue("div",{class:Ye([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[Kt(ue("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":p=>e.states.inputValue=p,type:"text",name:e.name,class:Ye([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:Ct(e.inputStyle),tabindex:e.tabindex,role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":((v=e.hoverOption)==null?void 0:v.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onKeydown:[Rr(ar(p=>e.navigateOptions("next"),["stop","prevent"]),["down"]),Rr(ar(p=>e.navigateOptions("prev"),["stop","prevent"]),["up"]),Rr(ar(e.handleEsc,["stop","prevent"]),["esc"]),Rr(ar(e.selectOption,["stop","prevent"]),["enter"]),Rr(ar(e.deletePrevTag,["stop"]),["delete"])],onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onInput:e.onInput,onClick:ar(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","name","disabled","autocomplete","tabindex","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onClick"]),[[x0,e.states.inputValue]]),e.filterable?(se(),Te("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:Ye(e.nsSelect.e("input-calculator")),textContent:dt(e.states.inputValue)},null,10,["textContent"])):ct("v-if",!0)],2),e.shouldShowPlaceholder?(se(),Te("div",{key:1,class:Ye([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?Bt(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[ue("span",null,dt(e.currentPlaceholder),1)]):(se(),Te("span",{key:1},dt(e.currentPlaceholder),1))],2)):ct("v-if",!0)],2),ue("div",{ref:"suffixRef",class:Ye(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(se(),_t(l,{key:0,class:Ye([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:Ce(()=>[(se(),_t(en(e.iconComponent)))]),_:1},8,["class"])):ct("v-if",!0),e.showClose&&e.clearIcon?(se(),_t(l,{key:1,class:Ye([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.nsSelect.e("clear")]),onClick:e.handleClearClick},{default:Ce(()=>[(se(),_t(en(e.clearIcon)))]),_:1},8,["class","onClick"])):ct("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(se(),_t(l,{key:2,class:Ye([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:Ce(()=>[(se(),_t(en(e.validateIcon)))]),_:1},8,["class"])):ct("v-if",!0)],2)],10,["onClick"])]}),content:Ce(()=>[Z(d,{ref:"menuRef"},{default:Ce(()=>[e.$slots.header?(se(),Te("div",{key:0,class:Ye(e.nsSelect.be("dropdown","header")),onClick:ar(()=>{},["stop"])},[Bt(e.$slots,"header")],10,["onClick"])):ct("v-if",!0),Kt(Z(f,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:Ye([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical"},{default:Ce(()=>[e.showNewOption?(se(),_t(u,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):ct("v-if",!0),Z(c,null,{default:Ce(()=>[Bt(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[Hr,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(se(),Te("div",{key:1,class:Ye(e.nsSelect.be("dropdown","loading"))},[Bt(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(se(),Te("div",{key:2,class:Ye(e.nsSelect.be("dropdown","empty"))},[Bt(e.$slots,"empty",{},()=>[ue("span",null,dt(e.emptyText),1)])],2)):ct("v-if",!0),e.$slots.footer?(se(),Te("div",{key:3,class:Ye(e.nsSelect.be("dropdown","footer")),onClick:ar(()=>{},["stop"])},[Bt(e.$slots,"footer")],10,["onClick"])):ct("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],16,["onMouseleave"])),[[h,e.handleClickOutside,e.popperRef]])}var F1=yr(P1,[["render",L1],["__file","select.vue"]]);const $1=vt({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=vr("select"),r=rt(null),n=jn(),a=rt([]);qi(V0,hr({...Ki(e)}));const i=Xe(()=>a.value.some(u=>u.visible===!0)),o=u=>{var c,f;return((c=u.type)==null?void 0:c.name)==="ElOption"&&!!((f=u.component)!=null&&f.proxy)},s=u=>{const c=yn(u),f=[];return c.forEach(d=>{var h,v;o(d)?f.push(d.component.proxy):(h=d.children)!=null&&h.length?f.push(...s(d.children)):(v=d.component)!=null&&v.subTree&&f.push(...s(d.component.subTree))}),f},l=()=>{a.value=s(n.subTree)};return Gr(()=>{l()}),pd(r,l,{attributes:!0,subtree:!0,childList:!0}),{groupRef:r,visible:i,ns:t}}});function N1(e,t,r,n,a,i){return Kt((se(),Te("ul",{ref:"groupRef",class:Ye(e.ns.be("group","wrap"))},[ue("li",{class:Ye(e.ns.be("group","title"))},dt(e.label),3),ue("li",null,[ue("ul",{class:Ye(e.ns.b("group"))},[Bt(e.$slots,"default")],2)])],2)),[[Hr,e.visible]])}var H0=yr($1,[["render",N1],["__file","option-group.vue"]]);const eo=da(F1,{Option:Vs,OptionGroup:H0}),to=S0(Vs);S0(H0);const z1=Zr({trigger:jl.trigger,placement:Mo.placement,disabled:jl.disabled,visible:Qr.visible,transition:Qr.transition,popperOptions:Mo.popperOptions,tabindex:Mo.tabindex,content:Qr.content,popperStyle:Qr.popperStyle,popperClass:Qr.popperClass,enterable:{...Qr.enterable,default:!0},effect:{...Qr.effect,default:"light"},teleported:Qr.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),V1={"update:visible":e=>hd(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},H1="onUpdate:visible",G1=vt({name:"ElPopover"}),W1=vt({...G1,props:z1,emits:V1,setup(e,{expose:t,emit:r}){const n=e,a=Xe(()=>n[H1]),i=vr("popover"),o=rt(),s=Xe(()=>{var g;return(g=B(o))==null?void 0:g.popperRef}),l=Xe(()=>[{width:jo(n.width)},n.popperStyle]),u=Xe(()=>[i.b(),n.popperClass,{[i.m("plain")]:!!n.content}]),c=Xe(()=>n.transition===`${i.namespace.value}-fade-in-linear`),f=()=>{var g;(g=o.value)==null||g.hide()},d=()=>{r("before-enter")},h=()=>{r("before-leave")},v=()=>{r("after-enter")},p=()=>{r("update:visible",!1),r("after-leave")};return t({popperRef:s,hide:f}),(g,b)=>(se(),_t(B(va),Wn({ref_key:"tooltipRef",ref:o},g.$attrs,{trigger:g.trigger,placement:g.placement,disabled:g.disabled,visible:g.visible,transition:g.transition,"popper-options":g.popperOptions,tabindex:g.tabindex,content:g.content,offset:g.offset,"show-after":g.showAfter,"hide-after":g.hideAfter,"auto-close":g.autoClose,"show-arrow":g.showArrow,"aria-label":g.title,effect:g.effect,enterable:g.enterable,"popper-class":B(u),"popper-style":B(l),teleported:g.teleported,persistent:g.persistent,"gpu-acceleration":B(c),"onUpdate:visible":B(a),onBeforeShow:d,onBeforeHide:h,onShow:v,onHide:p}),{content:Ce(()=>[g.title?(se(),Te("div",{key:0,class:Ye(B(i).e("title")),role:"title"},dt(g.title),3)):ct("v-if",!0),Bt(g.$slots,"default",{},()=>[Ut(dt(g.content),1)])]),default:Ce(()=>[g.$slots.reference?Bt(g.$slots,"reference",{key:0}):ct("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var X1=yr(W1,[["__file","popover.vue"]]);const uu=(e,t)=>{const r=t.arg||t.value,n=r==null?void 0:r.popperRef;n&&(n.triggerRef=e)};var Y1={mounted(e,t){uu(e,t)},updated(e,t){uu(e,t)}};const U1="popover",j1=gd(Y1,U1),Za=da(X1,{directive:j1}),q1=Zr({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:Pt(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:Pt([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:Pt(Function),default:e=>`${e}%`}}),K1=vt({name:"ElProgress"}),Z1=vt({...K1,props:q1,setup(e){const t=e,r={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},n=vr("progress"),a=Xe(()=>{const S={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},C=y(t.percentage);return C.includes("gradient")?S.background=C:S.backgroundColor=C,S}),i=Xe(()=>(t.strokeWidth/t.width*100).toFixed(1)),o=Xe(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(i.value)/2}`,10):0),s=Xe(()=>{const S=o.value,C=t.type==="dashboard";return`
          M 50 50
          m 0 ${C?"":"-"}${S}
          a ${S} ${S} 0 1 1 0 ${C?"-":""}${S*2}
          a ${S} ${S} 0 1 1 0 ${C?"":"-"}${S*2}
          `}),l=Xe(()=>2*Math.PI*o.value),u=Xe(()=>t.type==="dashboard"?.75:1),c=Xe(()=>`${-1*l.value*(1-u.value)/2}px`),f=Xe(()=>({strokeDasharray:`${l.value*u.value}px, ${l.value}px`,strokeDashoffset:c.value})),d=Xe(()=>({strokeDasharray:`${l.value*u.value*(t.percentage/100)}px, ${l.value}px`,strokeDashoffset:c.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),h=Xe(()=>{let S;return t.color?S=y(t.percentage):S=r[t.status]||r.default,S}),v=Xe(()=>t.status==="warning"?md:t.type==="line"?t.status==="success"?w0:y0:t.status==="success"?C0:Fa),p=Xe(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),g=Xe(()=>t.format(t.percentage));function b(S){const C=100/S.length;return S.map((D,P)=>wn(D)?{color:D,percentage:(P+1)*C}:D).sort((D,P)=>D.percentage-P.percentage)}const y=S=>{var C;const{color:T}=t;if(Vn(T))return T(S);if(wn(T))return T;{const D=b(T);for(const P of D)if(P.percentage>S)return P.color;return(C=D[D.length-1])==null?void 0:C.color}};return(S,C)=>(se(),Te("div",{class:Ye([B(n).b(),B(n).m(S.type),B(n).is(S.status),{[B(n).m("without-text")]:!S.showText,[B(n).m("text-inside")]:S.textInside}]),role:"progressbar","aria-valuenow":S.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[S.type==="line"?(se(),Te("div",{key:0,class:Ye(B(n).b("bar"))},[ue("div",{class:Ye(B(n).be("bar","outer")),style:Ct({height:`${S.strokeWidth}px`})},[ue("div",{class:Ye([B(n).be("bar","inner"),{[B(n).bem("bar","inner","indeterminate")]:S.indeterminate},{[B(n).bem("bar","inner","striped")]:S.striped},{[B(n).bem("bar","inner","striped-flow")]:S.stripedFlow}]),style:Ct(B(a))},[(S.showText||S.$slots.default)&&S.textInside?(se(),Te("div",{key:0,class:Ye(B(n).be("bar","innerText"))},[Bt(S.$slots,"default",{percentage:S.percentage},()=>[ue("span",null,dt(B(g)),1)])],2)):ct("v-if",!0)],6)],6)],2)):(se(),Te("div",{key:1,class:Ye(B(n).b("circle")),style:Ct({height:`${S.width}px`,width:`${S.width}px`})},[(se(),Te("svg",{viewBox:"0 0 100 100"},[ue("path",{class:Ye(B(n).be("circle","track")),d:B(s),stroke:`var(${B(n).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":S.strokeLinecap,"stroke-width":B(i),fill:"none",style:Ct(B(f))},null,14,["d","stroke","stroke-linecap","stroke-width"]),ue("path",{class:Ye(B(n).be("circle","path")),d:B(s),stroke:B(h),fill:"none",opacity:S.percentage?1:0,"stroke-linecap":S.strokeLinecap,"stroke-width":B(i),style:Ct(B(d))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(S.showText||S.$slots.default)&&!S.textInside?(se(),Te("div",{key:2,class:Ye(B(n).e("text")),style:Ct({fontSize:`${B(p)}px`})},[Bt(S.$slots,"default",{percentage:S.percentage},()=>[S.status?(se(),_t(B(Ht),{key:1},{default:Ce(()=>[(se(),_t(en(B(v))))]),_:1})):(se(),Te("span",{key:0},dt(B(g)),1))])],6)):ct("v-if",!0)],10,["aria-valuenow"]))}});var Q1=yr(Z1,[["__file","progress.vue"]]);const J1=da(Q1),G0=Symbol("uploadContextKey"),ep="ElUpload";class tp extends Error{constructor(t,r,n,a){super(t),this.name="UploadAjaxError",this.status=r,this.method=n,this.url=a}}function cu(e,t,r){let n;return r.response?n=`${r.response.error||r.response}`:r.responseText?n=`${r.responseText}`:n=`fail to ${t.method} ${e} ${r.status}`,new tp(n,r.status,t.method,e)}function rp(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const np=e=>{typeof XMLHttpRequest>"u"&&Fs(ep,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,r=e.action;t.upload&&t.upload.addEventListener("progress",i=>{const o=i;o.percent=i.total>0?i.loaded/i.total*100:0,e.onProgress(o)});const n=new FormData;if(e.data)for(const[i,o]of Object.entries(e.data))Yr(o)&&o.length?n.append(i,...o):n.append(i,o);n.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(cu(r,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(cu(r,e,t));e.onSuccess(rp(t))}),t.open(e.method,r,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const a=e.headers||{};if(a instanceof Headers)a.forEach((i,o)=>t.setRequestHeader(o,i));else for(const[i,o]of Object.entries(a))Da(o)||t.setRequestHeader(i,String(o));return t.send(n),t},W0=["text","picture","picture-card"];let ap=1;const es=()=>Date.now()+ap++,X0=Zr({action:{type:String,default:"#"},headers:{type:Pt(Object)},method:{type:String,default:"post"},data:{type:Pt([Object,Function,Promise]),default:()=>Ko({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:Pt(Array),default:()=>Ko([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:W0,default:"text"},httpRequest:{type:Pt(Function),default:np},disabled:Boolean,limit:Number}),ip=Zr({...X0,beforeUpload:{type:Pt(Function),default:_r},beforeRemove:{type:Pt(Function)},onRemove:{type:Pt(Function),default:_r},onChange:{type:Pt(Function),default:_r},onPreview:{type:Pt(Function),default:_r},onSuccess:{type:Pt(Function),default:_r},onProgress:{type:Pt(Function),default:_r},onError:{type:Pt(Function),default:_r},onExceed:{type:Pt(Function),default:_r},crossorigin:{type:Pt(String)}}),op=Zr({files:{type:Pt(Array),default:()=>Ko([])},disabled:{type:Boolean,default:!1},handlePreview:{type:Pt(Function),default:_r},listType:{type:String,values:W0,default:"text"},crossorigin:{type:Pt(String)}}),sp={remove:e=>!!e},lp=vt({name:"ElUploadList"}),up=vt({...lp,props:op,emits:sp,setup(e,{emit:t}){const r=e,{t:n}=ji(),a=vr("upload"),i=vr("icon"),o=vr("list"),s=ja(),l=rt(!1),u=Xe(()=>[a.b("list"),a.bm("list",r.listType),a.is("disabled",r.disabled)]),c=f=>{t("remove",f)};return(f,d)=>(se(),_t(xd,{tag:"ul",class:Ye(B(u)),name:B(o).b()},{default:Ce(()=>[(se(!0),Te(jt,null,er(f.files,(h,v)=>(se(),Te("li",{key:h.uid||h.name,class:Ye([B(a).be("list","item"),B(a).is(h.status),{focusing:l.value}]),tabindex:"0",onKeydown:Rr(p=>!B(s)&&c(h),["delete"]),onFocus:p=>l.value=!0,onBlur:p=>l.value=!1,onClick:p=>l.value=!1},[Bt(f.$slots,"default",{file:h,index:v},()=>[f.listType==="picture"||h.status!=="uploading"&&f.listType==="picture-card"?(se(),Te("img",{key:0,class:Ye(B(a).be("list","item-thumbnail")),src:h.url,crossorigin:f.crossorigin,alt:""},null,10,["src","crossorigin"])):ct("v-if",!0),h.status==="uploading"||f.listType!=="picture-card"?(se(),Te("div",{key:1,class:Ye(B(a).be("list","item-info"))},[ue("a",{class:Ye(B(a).be("list","item-name")),onClick:ar(p=>f.handlePreview(h),["prevent"])},[Z(B(Ht),{class:Ye(B(i).m("document"))},{default:Ce(()=>[Z(B(_d))]),_:1},8,["class"]),ue("span",{class:Ye(B(a).be("list","item-file-name")),title:h.name},dt(h.name),11,["title"])],10,["onClick"]),h.status==="uploading"?(se(),_t(B(J1),{key:0,type:f.listType==="picture-card"?"circle":"line","stroke-width":f.listType==="picture-card"?6:2,percentage:Number(h.percentage),style:Ct(f.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):ct("v-if",!0)],2)):ct("v-if",!0),ue("label",{class:Ye(B(a).be("list","item-status-label"))},[f.listType==="text"?(se(),_t(B(Ht),{key:0,class:Ye([B(i).m("upload-success"),B(i).m("circle-check")])},{default:Ce(()=>[Z(B(w0))]),_:1},8,["class"])):["picture-card","picture"].includes(f.listType)?(se(),_t(B(Ht),{key:1,class:Ye([B(i).m("upload-success"),B(i).m("check")])},{default:Ce(()=>[Z(B(C0))]),_:1},8,["class"])):ct("v-if",!0)],2),B(s)?ct("v-if",!0):(se(),_t(B(Ht),{key:2,class:Ye(B(i).m("close")),onClick:p=>c(h)},{default:Ce(()=>[Z(B(Fa))]),_:2},1032,["class","onClick"])),ct(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),ct(" This is a bug which needs to be fixed "),ct(" TODO: Fix the incorrect navigation interaction "),B(s)?ct("v-if",!0):(se(),Te("i",{key:3,class:Ye(B(i).m("close-tip"))},dt(B(n)("el.upload.deleteTip")),3)),f.listType==="picture-card"?(se(),Te("span",{key:4,class:Ye(B(a).be("list","item-actions"))},[ue("span",{class:Ye(B(a).be("list","item-preview")),onClick:p=>f.handlePreview(h)},[Z(B(Ht),{class:Ye(B(i).m("zoom-in"))},{default:Ce(()=>[Z(B(bd))]),_:1},8,["class"])],10,["onClick"]),B(s)?ct("v-if",!0):(se(),Te("span",{key:0,class:Ye(B(a).be("list","item-delete")),onClick:p=>c(h)},[Z(B(Ht),{class:Ye(B(i).m("delete"))},{default:Ce(()=>[Z(B(yd))]),_:1},8,["class"])],10,["onClick"]))],2)):ct("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),Bt(f.$slots,"append")]),_:3},8,["class","name"]))}});var fu=yr(up,[["__file","upload-list.vue"]]);const cp=Zr({disabled:{type:Boolean,default:!1}}),fp={file:e=>Yr(e)},Y0="ElUploadDrag",dp=vt({name:Y0}),vp=vt({...dp,props:cp,emits:fp,setup(e,{emit:t}){sa(G0)||Fs(Y0,"usage: <el-upload><el-upload-dragger /></el-upload>");const n=vr("upload"),a=rt(!1),i=ja(),o=l=>{if(i.value)return;a.value=!1,l.stopPropagation();const u=Array.from(l.dataTransfer.files);t("file",u)},s=()=>{i.value||(a.value=!0)};return(l,u)=>(se(),Te("div",{class:Ye([B(n).b("dragger"),B(n).is("dragover",a.value)]),onDrop:ar(o,["prevent"]),onDragover:ar(s,["prevent"]),onDragleave:ar(c=>a.value=!1,["prevent"])},[Bt(l.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var pp=yr(vp,[["__file","upload-dragger.vue"]]);const hp=Zr({...X0,beforeUpload:{type:Pt(Function),default:_r},onRemove:{type:Pt(Function),default:_r},onStart:{type:Pt(Function),default:_r},onSuccess:{type:Pt(Function),default:_r},onProgress:{type:Pt(Function),default:_r},onError:{type:Pt(Function),default:_r},onExceed:{type:Pt(Function),default:_r}}),gp=vt({name:"ElUploadContent",inheritAttrs:!1}),mp=vt({...gp,props:hp,setup(e,{expose:t}){const r=e,n=vr("upload"),a=ja(),i=$a({}),o=$a(),s=p=>{if(p.length===0)return;const{autoUpload:g,limit:b,fileList:y,multiple:S,onStart:C,onExceed:T}=r;if(b&&y.length+p.length>b){T(p,y);return}S||(p=p.slice(0,1));for(const D of p){const P=D;P.uid=es(),C(P),g&&l(P)}},l=async p=>{if(o.value.value="",!r.beforeUpload)return c(p);let g,b={};try{const S=r.data,C=r.beforeUpload(p);b=qo(r.data)?ql(r.data):r.data,g=await C,qo(r.data)&&Aa(S,b)&&(b=ql(r.data))}catch{g=!1}if(g===!1){r.onRemove(p);return}let y=p;g instanceof Blob&&(g instanceof File?y=g:y=new File([g],p.name,{type:p.type})),c(Object.assign(y,{uid:p.uid}),b)},u=async(p,g)=>Vn(p)?p(g):p,c=async(p,g)=>{const{headers:b,data:y,method:S,withCredentials:C,name:T,action:D,onProgress:P,onSuccess:G,onError:W,httpRequest:L}=r;try{g=await u(g??y,p)}catch{r.onRemove(p);return}const{uid:X}=p,M={headers:b||{},withCredentials:C,file:p,data:g,method:S,filename:T,action:D,onProgress:re=>{P(re,p)},onSuccess:re=>{G(re,p),delete i.value[X]},onError:re=>{W(re,p),delete i.value[X]}},oe=L(M);i.value[X]=oe,oe instanceof Promise&&oe.then(M.onSuccess,M.onError)},f=p=>{const g=p.target.files;g&&s(Array.from(g))},d=()=>{a.value||(o.value.value="",o.value.click())},h=()=>{d()};return t({abort:p=>{Sd(i.value).filter(p?([b])=>String(p.uid)===b:()=>!0).forEach(([b,y])=>{y instanceof XMLHttpRequest&&y.abort(),delete i.value[b]})},upload:l}),(p,g)=>(se(),Te("div",{class:Ye([B(n).b(),B(n).m(p.listType),B(n).is("drag",p.drag),B(n).is("disabled",B(a))]),tabindex:B(a)?"-1":"0",onClick:d,onKeydown:Rr(ar(h,["self"]),["enter","space"])},[p.drag?(se(),_t(pp,{key:0,disabled:B(a),onFile:s},{default:Ce(()=>[Bt(p.$slots,"default")]),_:3},8,["disabled"])):Bt(p.$slots,"default",{key:1}),ue("input",{ref_key:"inputRef",ref:o,class:Ye(B(n).e("input")),name:p.name,disabled:B(a),multiple:p.multiple,accept:p.accept,type:"file",onChange:f,onClick:ar(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var du=yr(mp,[["__file","upload-content.vue"]]);const vu="ElUpload",pu=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},_p=(e,t)=>{const r=wd(e,"fileList",void 0,{passive:!0}),n=h=>r.value.find(v=>v.uid===h.uid);function a(h){var v;(v=t.value)==null||v.abort(h)}function i(h=["ready","uploading","success","fail"]){r.value=r.value.filter(v=>!h.includes(v.status))}function o(h){r.value=r.value.filter(v=>v!==h)}const s=(h,v)=>{const p=n(v);p&&(console.error(h),p.status="fail",o(p),e.onError(h,p,r.value),e.onChange(p,r.value))},l=(h,v)=>{const p=n(v);p&&(e.onProgress(h,p,r.value),p.status="uploading",p.percentage=Math.round(h.percent))},u=(h,v)=>{const p=n(v);p&&(p.status="success",p.response=h,e.onSuccess(h,p,r.value),e.onChange(p,r.value))},c=h=>{Da(h.uid)&&(h.uid=es());const v={name:h.name,percentage:0,status:"ready",size:h.size,raw:h,uid:h.uid};if(e.listType==="picture-card"||e.listType==="picture")try{v.url=URL.createObjectURL(h)}catch(p){Fi(vu,p.message),e.onError(p,v,r.value)}r.value=[...r.value,v],e.onChange(v,r.value)},f=async h=>{const v=h instanceof File?n(h):h;v||Fs(vu,"file to be removed not found");const p=g=>{a(g),o(g),e.onRemove(g,r.value),pu(g)};e.beforeRemove?await e.beforeRemove(v,r.value)!==!1&&p(v):p(v)};function d(){r.value.filter(({status:h})=>h==="ready").forEach(({raw:h})=>{var v;return h&&((v=t.value)==null?void 0:v.upload(h))})}return Nt(()=>e.listType,h=>{h!=="picture-card"&&h!=="picture"||(r.value=r.value.map(v=>{const{raw:p,url:g}=v;if(!g&&p)try{v.url=URL.createObjectURL(p)}catch(b){e.onError(b,v,r.value)}return v}))}),Nt(r,h=>{for(const v of h)v.uid||(v.uid=es()),v.status||(v.status="success")},{immediate:!0,deep:!0}),{uploadFiles:r,abort:a,clearFiles:i,handleError:s,handleProgress:l,handleStart:c,handleSuccess:u,handleRemove:f,submit:d,revokeFileObjectURL:pu}},bp=vt({name:"ElUpload"}),yp=vt({...bp,props:ip,setup(e,{expose:t}){const r=e,n=ja(),a=$a(),{abort:i,submit:o,clearFiles:s,uploadFiles:l,handleStart:u,handleError:c,handleRemove:f,handleSuccess:d,handleProgress:h,revokeFileObjectURL:v}=_p(r,a),p=Xe(()=>r.listType==="picture-card"),g=Xe(()=>({...r,fileList:l.value,onStart:u,onProgress:h,onSuccess:d,onError:c,onRemove:f}));return b0(()=>{l.value.forEach(v)}),qi(G0,{accept:Cd(r,"accept")}),t({abort:i,submit:o,clearFiles:s,handleStart:u,handleRemove:f}),(b,y)=>(se(),Te("div",null,[B(p)&&b.showFileList?(se(),_t(fu,{key:0,disabled:B(n),"list-type":b.listType,files:B(l),crossorigin:b.crossorigin,"handle-preview":b.onPreview,onRemove:B(f)},Kl({append:Ce(()=>[Z(du,Wn({ref_key:"uploadRef",ref:a},B(g)),{default:Ce(()=>[b.$slots.trigger?Bt(b.$slots,"trigger",{key:0}):ct("v-if",!0),!b.$slots.trigger&&b.$slots.default?Bt(b.$slots,"default",{key:1}):ct("v-if",!0)]),_:3},16)]),_:2},[b.$slots.file?{name:"default",fn:Ce(({file:S,index:C})=>[Bt(b.$slots,"file",{file:S,index:C})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):ct("v-if",!0),!B(p)||B(p)&&!b.showFileList?(se(),_t(du,Wn({key:1,ref_key:"uploadRef",ref:a},B(g)),{default:Ce(()=>[b.$slots.trigger?Bt(b.$slots,"trigger",{key:0}):ct("v-if",!0),!b.$slots.trigger&&b.$slots.default?Bt(b.$slots,"default",{key:1}):ct("v-if",!0)]),_:3},16)):ct("v-if",!0),b.$slots.trigger?Bt(b.$slots,"default",{key:2}):ct("v-if",!0),Bt(b.$slots,"tip"),!B(p)&&b.showFileList?(se(),_t(fu,{key:3,disabled:B(n),"list-type":b.listType,files:B(l),crossorigin:b.crossorigin,"handle-preview":b.onPreview,onRemove:B(f)},Kl({_:2},[b.$slots.file?{name:"default",fn:Ce(({file:S,index:C})=>[Bt(b.$slots,"file",{file:S,index:C})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):ct("v-if",!0)]))}});var xp=yr(yp,[["__file","upload.vue"]]);const Sp=da(xp),wp={class:"flex flex-1 gap-3 items-center"},Cp={class:"font-semibold flex-shrink-0"},Tt=vt({__name:"AttrCol",props:{name:{},nowrap:{type:Boolean}},setup(e){return(t,r)=>(se(),Te("div",wp,[ue("div",Cp,dt(t.name),1),ue("div",{class:Ye(["flex-1 overflow-hidden font-thin",{"overflow-ellipsis whitespace-nowrap":t.nowrap}])},[Bt(t.$slots,"default")],2)]))}}),Ep=["rgba(0,0,0,0)","#000","#fff","#fafafa","#f5f5f5","#EBEBEB","#D9D9D9","#BFBFBF","#8C8C8C","#595959","#262626","#1E2026","#292C34","#31353E","#3A3F49","#4C525D","#7A808B","#AAAFBB","#C7CBD5","#EDEEF2","#3f3ddf","#3875FF","#21B0FF","#1CD2C8","#F6BD15","#FF9846","#E96452","#896AFF","#5E7092","#213474"],Mp="";function ha(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}const ga=function(e,t){const{componentPrefix:r=Mp}=t||{};e.component(`${r}${this.name}`,this)},Ao={};var Qa={name:"Checkboard",props:{size:{type:[Number,String],default:8},white:{type:String,default:"#fff"},grey:{type:String,default:"#e6e6e6"}},computed:{bgStyle(){return{"background-image":`url(${Tp(this.white,this.grey,this.size)})`}}}};function kp(e,t,r){if(typeof document>"u")return null;const n=document.createElement("canvas");n.width=n.height=r*2;const a=n.getContext("2d");return a?(a.fillStyle=e,a.fillRect(0,0,n.width,n.height),a.fillStyle=t,a.fillRect(0,0,r,r),a.translate(r,r),a.fillRect(0,0,r,r),n.toDataURL()):null}function Tp(e,t,r){const n=`${e},${t},${r}`;if(Ao[n])return Ao[n];const a=kp(e,t,r);return Ao[n]=a,a}function Rp(e,t,r,n,a,i){return se(),Te("div",{class:"vc-checkerboard",style:Ct(i.bgStyle)},null,4)}var Dp=".vc-checkerboard{background-size:contain;bottom:0;left:0;position:absolute;right:0;top:0}";ha(Dp);Qa.render=Rp;Qa.__file="src/components/checkboard/checkboard.vue";Qa.install=ga;var ro={name:"Alpha",components:{Checkboard:Qa},props:{value:Object,onChange:Function},computed:{colors(){return this.value},gradientColor(){const{rgba:e}=this.colors,t=[e.r,e.g,e.b].join(",");return`linear-gradient(to right, rgba(${t}, 0) 0%, rgba(${t}, 1) 100%)`}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:r}=this.$refs;if(!r)return;const n=r.clientWidth,a=r.getBoundingClientRect().left+window.pageXOffset,o=(e.pageX||(e.touches?e.touches[0].pageX:0))-a;let s;o<0?s=0:o>n?s=1:s=Math.round(o*100/n)/100,this.colors.a!==s&&this.$emit("change",{h:this.colors.hsl.h,s:this.colors.hsl.s,l:this.colors.hsl.l,a:s,source:"rgba"})},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const Ap={class:"vc-alpha"},Ip={class:"vc-alpha-checkboard-wrap"},Bp=ue("div",{class:"vc-alpha-picker"},null,-1),Op=[Bp];function Pp(e,t,r,n,a,i){const o=Pr("Checkboard");return se(),Te("div",Ap,[ue("div",Ip,[Z(o)]),ue("div",{class:"vc-alpha-gradient",style:Ct({background:i.gradientColor})},null,4),ue("div",{ref:"container",class:"vc-alpha-container",onMousedown:t[0]||(t[0]=(...s)=>i.handleMouseDown&&i.handleMouseDown(...s)),onTouchmove:t[1]||(t[1]=(...s)=>i.handleChange&&i.handleChange(...s)),onTouchstart:t[2]||(t[2]=(...s)=>i.handleChange&&i.handleChange(...s))},[ue("div",{class:"vc-alpha-pointer",style:Ct({left:`${i.colors.a*100}%`})},Op,4)],544)])}var Lp=".vc-alpha,.vc-alpha-checkboard-wrap{bottom:0;left:0;position:absolute;right:0;top:0}.vc-alpha-checkboard-wrap{overflow:hidden}.vc-alpha-gradient{bottom:0;left:0;position:absolute;right:0;top:0}.vc-alpha-container{cursor:pointer;height:100%;margin:0 3px;position:relative;z-index:2}.vc-alpha-pointer{position:absolute;z-index:2}.vc-alpha-picker{background:#fff;border-radius:1px;box-shadow:0 0 2px rgba(0,0,0,.6);cursor:pointer;height:8px;margin-top:1px;transform:translateX(-2px);width:4px}";ha(Lp);ro.render=Pp;ro.__file="src/components/alpha/alpha.vue";ro.install=ga;function bn(...e){return new Ed(...e)}function Io(e,t){const r=e&&e.a;let n;e&&e.hsl?n=bn(e.hsl):e&&e.hex&&e.hex.length>0?n=bn(e.hex):e&&e.hsv?n=bn(e.hsv):e&&e.rgba?n=bn(e.rgba):e&&e.rgb?n=bn(e.rgb):n=bn(e),n&&(n._a===void 0||n._a===null)&&n.setAlpha(r||n.getAlpha());const a=n.toHsl(),i=n.toHsv();return a.s===0&&(i.h=a.h=e.h||e.hsl&&e.hsl.h||t||0),i.v<.0164&&(i.h=e.h||e.hsv&&e.hsv.h||0,i.s=e.s||e.hsv&&e.hsv.s||0),a.l<.01&&(a.h=e.h||e.hsl&&e.hsl.h||0,a.s=e.s||e.hsl&&e.hsl.s||0),{hsl:a,hex:n.toHexString().toUpperCase(),hex8:n.toHex8String().toUpperCase(),rgba:n.toRgb(),hsv:i,oldHue:e.h||t||a.h,source:e.source,a:n.getAlpha()}}var Fp={model:{prop:"modelValue",event:"update:modelValue"},props:["modelValue"],data(){return{val:Io(this.modelValue)}},computed:{colors:{get(){return this.val},set(e){this.val=e,this.$emit("update:modelValue",e)}}},watch:{modelValue(e){this.val=Io(e)}},methods:{colorChange(e,t){this.oldHue=this.colors.hsl.h,this.colors=Io(e,t||this.oldHue)},isValidHex(e){return bn(e).isValid},simpleCheckForValidColor(e){const t=["r","g","b","a","h","s","l","v"];let r=0,n=0;for(let a=0;a<t.length;a++){const i=t[a];e[i]&&(r++,isNaN(e[i])||n++)}if(r===n)return e},paletteUpperCase(e){return e.map(t=>t.toUpperCase())},isTransparent(e){return bn(e).getAlpha()===0}}},no={name:"EditableInput",props:{label:String,labelText:String,desc:String,value:[String,Number],max:Number,min:Number,arrowOffset:{type:Number,default:1}},computed:{val:{get(){return this.value},set(e){if(this.max!==void 0&&+e>this.max)this.$refs.input.value=this.max;else return e}},labelId(){return`input__label__${this.label}__${Math.random().toString().slice(2,5)}`},labelSpanText(){return this.labelText||this.label}},methods:{update(e){this.handleChange(e.target.value)},handleChange(e){const t={};t[this.label]=e,t.hex===void 0&&t["#"]===void 0?this.$emit("change",t):e.length>5&&this.$emit("change",t)},handleKeyDown(e){let{val:t}=this;const r=Number(t);if(r){const n=this.arrowOffset||1;e.keyCode===38&&(t=r+n,this.handleChange(t),e.preventDefault()),e.keyCode===40&&(t=r-n,this.handleChange(t),e.preventDefault())}}}};const $p={class:"vc-editable-input"},Np=["aria-labelledby"],zp=["id","for"],Vp={class:"vc-input__desc"};function Hp(e,t,r,n,a,i){return se(),Te("div",$p,[Kt(ue("input",{ref:"input","onUpdate:modelValue":t[0]||(t[0]=o=>i.val=o),"aria-labelledby":i.labelId,class:"vc-input__input",onKeydown:t[1]||(t[1]=(...o)=>i.handleKeyDown&&i.handleKeyDown(...o)),onInput:t[2]||(t[2]=(...o)=>i.update&&i.update(...o))},null,40,Np),[[x0,i.val]]),ue("span",{id:i.labelId,for:r.label,class:"vc-input__label"},dt(i.labelSpanText),9,zp),ue("span",Vp,dt(r.desc),1)])}var Gp=".vc-editable-input{position:relative}.vc-input__input{border:0;outline:none;padding:0}.vc-input__label{text-transform:capitalize}";ha(Gp);no.render=Hp;no.__file="src/components/editable-input/editable-input.vue";no.install=ga;function Bo(e,t,r){return t<r?e<t?t:e>r?r:e:e<r?r:e>t?t:e}var ao={name:"Saturation",props:{value:Object},computed:{colors(){return this.value},bgColor(){return`hsl(${this.colors.hsv.h}, 100%, 50%)`},pointerTop(){return`${-(this.colors.hsv.v*100)+1+100}%`},pointerLeft(){return`${this.colors.hsv.s*100}%`}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:r}=this.$refs;if(!r)return;const n=r.clientWidth,a=r.clientHeight,i=r.getBoundingClientRect().left+window.pageXOffset,o=r.getBoundingClientRect().top+window.pageYOffset,s=e.pageX||(e.touches?e.touches[0].pageX:0),l=e.pageY||(e.touches?e.touches[0].pageY:0),u=Bo(s-i,0,n),c=Bo(l-o,0,a),f=u/n,d=Bo(-(c/a)+1,0,1);this.onChange({h:this.colors.hsv.h,s:f,v:d,a:this.colors.hsv.a,source:"hsva"})},onChange(e){this.$emit("change",e)},handleMouseDown(e){window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const Wp=ue("div",{class:"vc-saturation--white"},null,-1),Xp=ue("div",{class:"vc-saturation--black"},null,-1),Yp=ue("div",{class:"vc-saturation-circle"},null,-1),Up=[Yp];function jp(e,t,r,n,a,i){return se(),Te("div",{ref:"container",class:"vc-saturation",style:Ct({background:i.bgColor}),onMousedown:t[0]||(t[0]=(...o)=>i.handleMouseDown&&i.handleMouseDown(...o)),onTouchmove:t[1]||(t[1]=(...o)=>i.handleChange&&i.handleChange(...o)),onTouchstart:t[2]||(t[2]=(...o)=>i.handleChange&&i.handleChange(...o))},[Wp,Xp,ue("div",{class:"vc-saturation-pointer",style:Ct({top:i.pointerTop,left:i.pointerLeft})},Up,4)],36)}var qp=".vc-saturation,.vc-saturation--black,.vc-saturation--white{bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.vc-saturation--white{background:linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.vc-saturation--black{background:linear-gradient(0deg,#000,transparent)}.vc-saturation-pointer{cursor:pointer;position:absolute}.vc-saturation-circle{border-radius:50%;box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgba(0,0,0,.3),0 0 1px 2px rgba(0,0,0,.4);cursor:head;height:4px;transform:translate(-2px,-2px);width:4px}";ha(qp);ao.render=jp;ao.__file="src/components/saturation/saturation.vue";ao.install=ga;var io={name:"Hue",props:{value:Object,direction:{type:String,default:"horizontal"}},data(){return{oldHue:0,pullDirection:""}},computed:{colors(){return this.value},directionClass(){return{"vc-hue--horizontal":this.direction==="horizontal","vc-hue--vertical":this.direction==="vertical"}},pointerTop(){return this.direction==="vertical"?this.colors.hsl.h===0&&this.pullDirection==="right"?0:`${-(this.colors.hsl.h*100/360)+100}%`:0},pointerLeft(){return this.direction==="vertical"?0:this.colors.hsl.h===0&&this.pullDirection==="right"?"100%":`${this.colors.hsl.h*100/360}%`}},watch:{value:{handler(e,t){const{h:r}=e.hsl;r!==0&&r-this.oldHue>0&&(this.pullDirection="right"),r!==0&&r-this.oldHue<0&&(this.pullDirection="left"),this.oldHue=r},deep:!0,immediate:!0}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:r}=this.$refs;if(!r)return;const n=r.clientWidth,a=r.clientHeight,i=r.getBoundingClientRect().left+window.pageXOffset,o=r.getBoundingClientRect().top+window.pageYOffset,s=e.pageX||(e.touches?e.touches[0].pageX:0),l=e.pageY||(e.touches?e.touches[0].pageY:0),u=s-i,c=l-o;let f,d;this.direction==="vertical"?(c<0?f=360:c>a?f=0:(d=-(c*100/a)+100,f=360*d/100),this.colors.hsl.h!==f&&this.$emit("change",{h:f,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"})):(u<0?f=0:u>n?f=360:(d=u*100/n,f=360*d/100),this.colors.hsl.h!==f&&this.$emit("change",{h:f,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"}))},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const Kp=["aria-valuenow"],Zp=ue("div",{class:"vc-hue-picker"},null,-1),Qp=[Zp];function Jp(e,t,r,n,a,i){return se(),Te("div",{class:Ye(["vc-hue",[i.directionClass]])},[ue("div",{ref:"container",class:"vc-hue-container",role:"slider","aria-valuenow":i.colors.hsl.h,"aria-valuemin":"0","aria-valuemax":"360",onMousedown:t[0]||(t[0]=(...o)=>i.handleMouseDown&&i.handleMouseDown(...o)),onTouchmove:t[1]||(t[1]=(...o)=>i.handleChange&&i.handleChange(...o)),onTouchstart:t[2]||(t[2]=(...o)=>i.handleChange&&i.handleChange(...o))},[ue("div",{class:"vc-hue-pointer",style:Ct({top:i.pointerTop,left:i.pointerLeft}),role:"presentation"},Qp,4)],40,Kp)],2)}var eh=".vc-hue{border-radius:2px;bottom:0;left:0;position:absolute;right:0;top:0}.vc-hue--horizontal{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.vc-hue--vertical{background:linear-gradient(0deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.vc-hue-container{cursor:pointer;height:100%;margin:0 2px;position:relative}.vc-hue-pointer{position:absolute;z-index:2}.vc-hue-picker{background:#fff;border-radius:1px;box-shadow:0 0 2px rgba(0,0,0,.6);cursor:pointer;height:8px;margin-top:1px;transform:translateX(-2px);width:4px}";ha(eh);io.render=Jp;io.__file="src/components/hue/hue.vue";io.install=ga;const th=["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF","rgba(0,0,0,0)"];var oo={name:"Sketch",components:{Saturation:ao,Hue:io,Alpha:ro,EdIn:no,Checkboard:Qa},mixins:[Fp],props:{presetColors:{type:Array,default(){return th}},disableAlpha:{type:Boolean,default:!1},disableFields:{type:Boolean,default:!1}},computed:{hex(){let e;return this.colors.a<1?e=this.colors.hex8:e=this.colors.hex,e.replace("#","")},activeColor(){const{rgba:e}=this.colors;return`rgba(${[e.r,e.g,e.b,e.a].join(",")})`}},methods:{handlePreset(e){this.colorChange(e)},childChange(e){this.colorChange(e)},inputChange(e){e&&(e.hex?this.isValidHex(e.hex)&&this.colorChange({hex:e.hex,source:"hex"}):(e.r||e.g||e.b||e.a)&&this.colorChange({r:e.r||this.colors.rgba.r,g:e.g||this.colors.rgba.g,b:e.b||this.colors.rgba.b,a:e.a||this.colors.rgba.a,source:"rgba"}))}}};const rh={class:"vc-sketch-saturation-wrap"},nh={class:"vc-sketch-controls"},ah={class:"vc-sketch-sliders"},ih={class:"vc-sketch-hue-wrap"},oh={key:0,class:"vc-sketch-alpha-wrap"},sh={class:"vc-sketch-color-wrap"},lh=["aria-label"],uh={key:0,class:"vc-sketch-field"},ch={class:"vc-sketch-field--double"},fh={class:"vc-sketch-field--single"},dh={class:"vc-sketch-field--single"},vh={class:"vc-sketch-field--single"},ph={key:0,class:"vc-sketch-field--single"},hh={class:"vc-sketch-presets",role:"group","aria-label":"A color preset, pick one to set as current color"},gh=["aria-label","onClick"],mh=["aria-label","onClick"];function _h(e,t,r,n,a,i){const o=Pr("Saturation"),s=Pr("Hue"),l=Pr("Alpha"),u=Pr("Checkboard"),c=Pr("EdIn");return se(),Te("div",{role:"application","aria-label":"Sketch color picker",class:Ye(["vc-sketch",[r.disableAlpha?"vc-sketch__disable-alpha":""]])},[ue("div",rh,[Z(o,{value:e.colors,onChange:i.childChange},null,8,["value","onChange"])]),ue("div",nh,[ue("div",ah,[ue("div",ih,[Z(s,{value:e.colors,onChange:i.childChange},null,8,["value","onChange"])]),r.disableAlpha?ct("v-if",!0):(se(),Te("div",oh,[Z(l,{value:e.colors,onChange:i.childChange},null,8,["value","onChange"])]))]),ue("div",sh,[ue("div",{"aria-label":`Current color is ${i.activeColor}`,class:"vc-sketch-active-color",style:Ct({background:i.activeColor})},null,12,lh),Z(u)])]),r.disableFields?ct("v-if",!0):(se(),Te("div",uh,[ct(" rgba "),ue("div",ch,[Z(c,{label:"hex",value:i.hex,onChange:i.inputChange},null,8,["value","onChange"])]),ue("div",fh,[Z(c,{label:"r",value:e.colors.rgba.r,onChange:i.inputChange},null,8,["value","onChange"])]),ue("div",dh,[Z(c,{label:"g",value:e.colors.rgba.g,onChange:i.inputChange},null,8,["value","onChange"])]),ue("div",vh,[Z(c,{label:"b",value:e.colors.rgba.b,onChange:i.inputChange},null,8,["value","onChange"])]),r.disableAlpha?ct("v-if",!0):(se(),Te("div",ph,[Z(c,{label:"a",value:e.colors.a,"arrow-offset":.01,max:1,onChange:i.inputChange},null,8,["value","arrow-offset","onChange"])]))])),ue("div",hh,[(se(!0),Te(jt,null,er(r.presetColors,f=>(se(),Te(jt,null,[e.isTransparent(f)?(se(),Te("div",{key:f,"aria-label":`Color:${f}`,class:"vc-sketch-presets-color",onClick:d=>i.handlePreset(f)},[Z(u)],8,mh)):(se(),Te("div",{key:`!${f}`,class:"vc-sketch-presets-color","aria-label":`Color:${f}`,style:Ct({background:f}),onClick:d=>i.handlePreset(f)},null,12,gh))],64))),256))])],2)}var bh=".vc-sketch{background:#fff;border-radius:4px;box-shadow:0 0 0 1px rgba(0,0,0,.15),0 8px 16px rgba(0,0,0,.15);box-sizing:initial;padding:10px 10px 0;position:relative;width:200px}.vc-sketch-saturation-wrap{overflow:hidden;padding-bottom:75%;position:relative;width:100%}.vc-sketch-controls{display:flex}.vc-sketch-sliders{flex:1;padding:4px 0}.vc-sketch-sliders .vc-alpha-gradient,.vc-sketch-sliders .vc-hue{border-radius:2px}.vc-sketch-alpha-wrap,.vc-sketch-hue-wrap{height:10px;position:relative}.vc-sketch-alpha-wrap{margin-top:4px;overflow:hidden}.vc-sketch-color-wrap{border-radius:3px;height:24px;margin-left:4px;margin-top:4px;position:relative;width:24px}.vc-sketch-active-color{border-radius:2px;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.15),inset 0 0 4px rgba(0,0,0,.25);left:0;position:absolute;right:0;top:0;z-index:2}.vc-sketch-color-wrap .vc-checkerboard{background-size:auto}.vc-sketch-field{display:flex;padding-top:4px}.vc-sketch-field .vc-input__input{border:none;box-shadow:inset 0 0 0 1px #ccc;font-size:10px;padding:4px 0 3px 10%;width:90%}.vc-sketch-field .vc-input__label{color:#222;display:block;font-size:11px;padding-bottom:4px;padding-top:3px;text-align:center;text-transform:capitalize}.vc-sketch-field--single{flex:1;padding-left:6px}.vc-sketch-field--double{flex:2}.vc-sketch-presets{border-top:1px solid #eee;margin-left:-10px;margin-right:-10px;padding-left:10px;padding-top:10px}.vc-sketch-presets-color{cursor:pointer;display:inline-block;height:16px;margin:0 10px 10px 0;overflow:hidden;position:relative;vertical-align:top;width:16px}.vc-sketch-presets-color,.vc-sketch-presets-color .vc-checkerboard{border-radius:3px;box-shadow:inset 0 0 0 1px rgba(0,0,0,.15)}.vc-sketch__disable-alpha .vc-sketch-color-wrap{height:10px}";ha(bh);oo.render=_h;oo.__file="src/components/sketch/sketch.vue";oo.install=ga;const yh={class:"flex flex-row items-center cursor-pointer"},xh={class:"not-italic"},Oo=vt({__name:"ColorPicker",props:{modelValue:{type:String,default(){return""}}},emits:{"update:modelValue":e=>e!==null},setup(e,{emit:t}){const r=t;function n(a){a.rgba.a===0?r("update:modelValue",""):r("update:modelValue",a.hex)}return(a,i)=>{const o=Za;return se(),_t(o,{placement:"bottom",width:220,trigger:"click"},{reference:Ce(()=>[ue("div",yh,[ue("span",{class:"w-6 h-4 block mr-1 border border-gray-500",style:Ct({backgroundColor:e.modelValue})},null,4),ue("span",xh,dt(e.modelValue),1)])]),default:Ce(()=>[Z(B(oo),{"model-value":e.modelValue,"onUpdate:modelValue":n,"preset-colors":B(Ep)},null,8,["model-value","preset-colors"])]),_:1})}}}),Sh={class:"text-[12px] leading-5 flex flex-col gap-5"},wh={class:"flex"},Ch={class:"w-full grid grid-cols-2 gap-4"},Eh={class:"flex flex-1 gap-2 items-center"},Mh={class:"flex flex-1 gap-2 items-center"},kh={class:"flex items-center gap-2"},Th={class:"flex-shrink-0"},Rh={class:"flex gap-4"},Dh={class:"flex gap-4"},Ah=vt({__name:"TextAttr",setup(e){const t=rt(!1),r=sr(),n=Xe(()=>r.selectTrack);return(a,i)=>{const o=Kn,s=Zi,l=Ka,u=on,c=sn;return Kt((se(),Te("div",Sh,[ue("div",wh,[Z(Tt,{name:"时长"},{default:Ce(()=>[Ut(dt(((B(n).end-B(n).start)/B(br)).toFixed(2))+" s ",1)]),_:1}),Z(Tt,{name:"类型"},{default:Ce(()=>[Z(o,{size:"small"},{default:Ce(()=>[Ut(dt(B(n).type),1)]),_:1})]),_:1})]),Z(Tt,{name:"位置"},{default:Ce(()=>[ue("div",Ch,[ue("div",Eh,[i[8]||(i[8]=ue("span",null,"X",-1)),Z(s,{class:"flex-1",controlsPosition:"right",modelValue:B(n).centerX,"onUpdate:modelValue":i[0]||(i[0]=f=>B(n).centerX=f)},null,8,["modelValue"])]),ue("div",Mh,[i[9]||(i[9]=ue("span",null,"Y",-1)),Z(s,{controlsPosition:"right",modelValue:B(n).centerY,"onUpdate:modelValue":i[1]||(i[1]=f=>B(n).centerY=f)},null,8,["modelValue"])])])]),_:1}),Z(Tt,{name:"缩放"},{default:Ce(()=>[ue("div",kh,[Z(l,{min:1,max:200,step:1,modelValue:B(n).scale,"onUpdate:modelValue":i[2]||(i[2]=f=>B(n).scale=f)},null,8,["modelValue"]),ue("div",Th,dt(B(n).scale)+" %",1)])]),_:1}),Z(Tt,{name:"内容"},{default:Ce(()=>[Z(u,{modelValue:B(n).text,"onUpdate:modelValue":i[3]||(i[3]=f=>B(n).text=f),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1}),ue("div",Rh,[Z(Tt,{name:"字号"},{default:Ce(()=>[Z(s,{class:"w-[90%]",controlsPosition:"right",modelValue:B(n).fontSize,"onUpdate:modelValue":i[4]||(i[4]=f=>B(n).fontSize=f)},null,8,["modelValue"])]),_:1}),Z(Tt,{name:"背景"},{default:Ce(()=>[Z(Oo,{modelValue:B(n).textBackgroundColor,"onUpdate:modelValue":i[5]||(i[5]=f=>B(n).textBackgroundColor=f)},null,8,["modelValue"])]),_:1})]),ue("div",Dh,[Z(Tt,{name:"字体颜色"},{default:Ce(()=>[Z(Oo,{modelValue:B(n).fill,"onUpdate:modelValue":i[6]||(i[6]=f=>B(n).fill=f)},null,8,["modelValue"])]),_:1}),Z(Tt,{name:"描边颜色"},{default:Ce(()=>[Z(Oo,{modelValue:B(n).stroke,"onUpdate:modelValue":i[7]||(i[7]=f=>B(n).stroke=f)},null,8,["modelValue"])]),_:1})])])),[[c,B(t)]])}}}),Ih={class:"text-[12px] leading-5 flex flex-col gap-5"},Bh={key:0,class:"flex"},Oh={key:1,class:"flex"},Ph={class:"w-full grid grid-cols-2 gap-4"},Lh={class:"flex flex-1 gap-2 items-center"},Fh={class:"flex flex-1 gap-2 items-center"},$h={class:"flex items-center gap-2"},Nh={class:"flex-shrink-0"},zh=vt({__name:"VideoAttr",setup(e){const t=sr(),r=Xe(()=>t.selectTrack),n=Xe(()=>t.selectTrack.resource),a=async()=>{if(!r.value){Zt.error("缺少重新生成所需的提示词");return}try{r.value.loading=!0,Zt.info("重新生成功能需要后端支持")}catch(i){console.error("重新生成失败:",i),Zt.error("重新生成失败")}finally{r.value.loading=!1}};return(i,o)=>{var h,v;const s=Kn,l=Zi,u=Ka,c=on,f=rn,d=sn;return Kt((se(),Te("div",Ih,[Z(Tt,{name:"名称",nowrap:""},{default:Ce(()=>[Ut(dt(B(r).name),1)]),_:1}),B(r)?(se(),Te("div",Bh,[Z(Tt,{name:"初始时间"},{default:Ce(()=>[Ut(dt(B(n).duration.toFixed(2))+" s ",1)]),_:1}),Z(Tt,{name:"当前时间"},{default:Ce(()=>[Ut(dt(((B(r).end-B(r).start)/B(br)).toFixed(2))+" s ",1)]),_:1})])):ct("",!0),B(n)?(se(),Te("div",Oh,[Z(Tt,{name:"类型"},{default:Ce(()=>[Z(s,{size:"small"},{default:Ce(()=>[Ut(dt(B(r).type),1)]),_:1})]),_:1}),Z(Tt,{name:"分辨率"},{default:Ce(()=>[Ut(dt(B(n).width)+" × "+dt(B(n).height),1)]),_:1})])):ct("",!0),Z(Tt,{name:"位置"},{default:Ce(()=>[ue("div",Ph,[ue("div",Lh,[o[4]||(o[4]=ue("span",null,"X",-1)),Z(l,{class:"flex-1",controlsPosition:"right",modelValue:B(r).centerX,"onUpdate:modelValue":o[0]||(o[0]=p=>B(r).centerX=p)},null,8,["modelValue"])]),ue("div",Fh,[o[5]||(o[5]=ue("span",null,"Y",-1)),Z(l,{controlsPosition:"right",modelValue:B(r).centerY,"onUpdate:modelValue":o[1]||(o[1]=p=>B(r).centerY=p)},null,8,["modelValue"])])])]),_:1}),Z(Tt,{name:"缩放"},{default:Ce(()=>[ue("div",$h,[Z(u,{min:1,max:200,step:1,modelValue:B(r).scale,"onUpdate:modelValue":o[2]||(o[2]=p=>B(r).scale=p)},null,8,["modelValue"]),ue("div",Nh,dt(B(r).scale)+" %",1)])]),_:1}),((h=B(n).meta)==null?void 0:h.prompt)!==void 0?(se(),_t(Tt,{key:2,name:"描述"},{default:Ce(()=>[Z(c,{modelValue:B(n).meta.prompt,"onUpdate:modelValue":o[3]||(o[3]=p=>B(n).meta.prompt=p),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1})):ct("",!0),((v=B(n).meta)==null?void 0:v.model)!=="upload"?(se(),_t(Tt,{key:3,name:"操作"},{default:Ce(()=>[Z(f,{type:"primary",onClick:a},{default:Ce(()=>o[6]||(o[6]=[Ut("重新生成")])),_:1})]),_:1})):ct("",!0)])),[[d,B(r).loading]])}}}),Vh={class:"text-[12px] leading-5 flex flex-col gap-5"},Hh={class:"flex"},Gh={class:"w-full grid grid-cols-2 gap-4"},Wh={class:"flex flex-1 gap-2 items-center"},Xh={class:"flex flex-1 gap-2 items-center"},Yh={class:"flex items-center gap-2"},Uh={class:"flex-shrink-0"},jh=vt({__name:"ImageAttr",setup(e){const t=sr(),r=Xe(()=>t.selectTrack),n=()=>{Zt.info("前端模式下暂不支持重新生成功能")},a=()=>{Zt.info("前端模式下暂不支持图片生成视频功能")};return(i,o)=>{const s=Kn,l=Zi,u=Ka,c=on,f=rn,d=sn;return Kt((se(),Te("div",Vh,[Z(Tt,{name:"名称",nowrap:""},{default:Ce(()=>[Ut(dt(B(r).name),1)]),_:1}),Z(Tt,{name:"时长"},{default:Ce(()=>[Ut(dt(((B(r).end-B(r).start)/B(br)).toFixed(2))+" s ",1)]),_:1}),ue("div",Hh,[Z(Tt,{name:"类型"},{default:Ce(()=>[Z(s,{size:"small"},{default:Ce(()=>[Ut(dt(B(r).type),1)]),_:1})]),_:1}),Z(Tt,{name:"分辨率"},{default:Ce(()=>[Ut(dt(B(r).width)+" × "+dt(B(r).height),1)]),_:1})]),Z(Tt,{name:"位置"},{default:Ce(()=>[ue("div",Gh,[ue("div",Wh,[o[4]||(o[4]=ue("span",null,"X",-1)),Z(l,{class:"flex-1",controlsPosition:"right",modelValue:B(r).centerX,"onUpdate:modelValue":o[0]||(o[0]=h=>B(r).centerX=h)},null,8,["modelValue"])]),ue("div",Xh,[o[5]||(o[5]=ue("span",null,"Y",-1)),Z(l,{controlsPosition:"right",modelValue:B(r).centerY,"onUpdate:modelValue":o[1]||(o[1]=h=>B(r).centerY=h)},null,8,["modelValue"])])])]),_:1}),Z(Tt,{name:"缩放"},{default:Ce(()=>[ue("div",Yh,[Z(u,{min:1,max:200,step:1,modelValue:B(r).scale,"onUpdate:modelValue":o[2]||(o[2]=h=>B(r).scale=h)},null,8,["modelValue"]),ue("div",Uh,dt(B(r).scale)+" %",1)])]),_:1}),Z(Tt,{name:"描述"},{default:Ce(()=>[Z(c,{modelValue:B(r).name,"onUpdate:modelValue":o[3]||(o[3]=h=>B(r).name=h),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1}),Z(Tt,{name:"操作"},{default:Ce(()=>[Z(f,{type:"primary",onClick:n},{default:Ce(()=>o[6]||(o[6]=[Ut("重新生成")])),_:1}),Z(f,{type:"primary",onClick:a},{default:Ce(()=>o[7]||(o[7]=[Ut("图生视频")])),_:1})]),_:1})])),[[d,B(r).loading]])}}}),qh={class:"text-[12px] leading-5 flex flex-col gap-5"},Kh={class:"flex"},Zh={class:"flex items-center gap-4"},Qh={class:"flex-shrink-0"},Jh={class:"flex"},eg={class:"flex"},tg={class:"flex"},rg=vt({__name:"AudioAttr",setup(e){const t=Nr(),r=sr(),n=Xe(()=>r.selectTrack),a=()=>{Zt.info("前端模式下暂不支持重新生成功能")};return Nt(()=>n.value.volume,Na(()=>{t.isPause=!0,Md.updateVolume(n.value,n.value.volume)},100)),Nt(()=>n.value.subtitle,Na(async()=>{t.isPause=!0,await kd.decode(n.value)},100),{deep:!0}),(i,o)=>{const s=Kn,l=Ka,u=Td,c=Zi,f=C1,d=on,h=rn,v=sn;return Kt((se(),Te("div",qh,[Z(Tt,{name:"名称",nowrap:""},{default:Ce(()=>[Ut(dt(B(n).name),1)]),_:1}),ue("div",Kh,[Z(Tt,{name:"初始时间"},{default:Ce(()=>[Ut(dt((B(n).frameCount/B(br)).toFixed(2))+" s ",1)]),_:1}),Z(Tt,{name:"当前时间"},{default:Ce(()=>[Ut(dt(((B(n).end-B(n).start)/B(br)).toFixed(2))+" s ",1)]),_:1})]),Z(Tt,{name:"类型"},{default:Ce(()=>[Z(s,{size:"small"},{default:Ce(()=>[Ut(dt(B(n).type),1)]),_:1})]),_:1}),Z(Tt,{name:"音量"},{default:Ce(()=>[ue("div",Zh,[Z(l,{min:0,max:1,step:.1,modelValue:B(n).volume,"onUpdate:modelValue":o[0]||(o[0]=p=>B(n).volume=p)},null,8,["modelValue"]),ue("div",Qh,dt(B(n).volume),1)])]),_:1}),ue("div",Jh,[Z(Tt,{name:"静音"},{default:Ce(()=>[Z(u,{modelValue:B(n).mute,"onUpdate:modelValue":o[1]||(o[1]=p=>B(n).mute=p)},null,8,["modelValue"])]),_:1}),Z(Tt,{name:"字幕"},{default:Ce(()=>[Z(u,{modelValue:B(n).drawSub,"onUpdate:modelValue":o[2]||(o[2]=p=>B(n).drawSub=p)},null,8,["modelValue"])]),_:1})]),B(n).drawSub?(se(),Te(jt,{key:0},[ue("div",eg,[Z(Tt,{name:"字号"},{default:Ce(()=>[Z(c,{modelValue:B(n).subtitle.fontSize,"onUpdate:modelValue":o[3]||(o[3]=p=>B(n).subtitle.fontSize=p),class:"input-number",min:12,max:100,size:"small"},null,8,["modelValue"])]),_:1}),Z(Tt,{name:"字体颜色"},{default:Ce(()=>[Z(f,{modelValue:B(n).subtitle.fontColor,"onUpdate:modelValue":o[4]||(o[4]=p=>B(n).subtitle.fontColor=p),size:"small"},null,8,["modelValue"])]),_:1})]),ue("div",tg,[Z(Tt,{name:"描边大小"},{default:Ce(()=>[Z(c,{modelValue:B(n).subtitle.strokeSize,"onUpdate:modelValue":o[5]||(o[5]=p=>B(n).subtitle.strokeSize=p),class:"input-number",min:0,max:20,size:"small"},null,8,["modelValue"])]),_:1}),Z(Tt,{name:"描边颜色"},{default:Ce(()=>[Z(f,{modelValue:B(n).subtitle.strokeColor,"onUpdate:modelValue":o[6]||(o[6]=p=>B(n).subtitle.strokeColor=p),size:"small"},null,8,["modelValue"])]),_:1})]),Z(Tt,{name:"底部边距"},{default:Ce(()=>[Z(c,{modelValue:B(n).subtitle.bottomOffset,"onUpdate:modelValue":o[7]||(o[7]=p=>B(n).subtitle.bottomOffset=p),class:"input-number",min:0,max:200,size:"small"},null,8,["modelValue"])]),_:1})],64)):ct("",!0),Z(Tt,{name:"提示词"},{default:Ce(()=>[Z(d,{modelValue:B(n).name,"onUpdate:modelValue":o[8]||(o[8]=p=>B(n).name=p),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1}),Z(Tt,{name:"操作"},{default:Ce(()=>[Z(h,{type:"primary",onClick:a},{default:Ce(()=>o[9]||(o[9]=[Ut("重新生成")])),_:1})]),_:1})])),[[v,B(n).loading]])}}}),ng=ln(rg,[["__scopeId","data-v-c7e08463"]]),ag={key:0,class:"w-full h-full flex flex-col justify-center items-center"},ig={key:1,class:"absolute top-0 left-3 right-2 bottom-0 pr-2 overflow-auto"},og=vt({__name:"AttributeContainer",setup(e){const t=pa(),r=sr(),n=Xe(()=>({width:`${t.attrWidth}px`})),a={},i=Object.assign({});for(const s in i){const l=s.match(new RegExp("(?<=\\/)(\\w+)(?=\\.ts)"))||[];a[l[0]]=i[s].Options}const o=Xe(()=>r.selectTrack);return(s,l)=>{const u=iv,c=Ah,f=E0,d=M0;return se(),Te("div",{class:"select-none relative pl-2 dark:bg-night bg-gray-100",style:Ct(B(n))},[B(o)?(se(),Te("div",ig,[Z(d,null,{default:Ce(()=>[Z(f,{label:"基本信息"},{default:Ce(()=>[B(o).type==="video"?(se(),_t(zh,{key:0})):B(o).type==="image"?(se(),_t(jh,{key:1})):B(o).type==="audio"?(se(),_t(ng,{key:2})):B(o).type==="text"?(se(),_t(c,{key:3})):ct("",!0)]),_:1})]),_:1})])):(se(),Te("div",ag,[Z(u,{description:"点击轨道进行编辑"})]))],4)}}});function sg(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map(function(n){return n.split(" ").map(function(a){return a?""+e+a:""}).join(" ")}).join(" ")}function lg(e,t){return t.replace(/([^}{]*){/gm,function(r,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+e+"$1")+"{"})}function tn(e,t){return function(r){r&&(e[t]=r)}}function U0(e,t,r){return function(n){n&&(e[t][r]=n)}}function hu(e,t){return function(r){var n=r.prototype;e.forEach(function(a){t(n,a)})}}function ug(e,t){return t===void 0&&(t={}),function(r,n){e.forEach(function(a){var i=t[a]||a;i in r||(r[i]=function(){for(var o,s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];var u=(o=this[n])[a].apply(o,s);return u===this[n]?this:u})})}}var cg=function(){function e(){this.keys=[],this.values=[]}var t=e.prototype;return t.get=function(r){return this.values[this.keys.indexOf(r)]},t.set=function(r,n){var a=this.keys,i=this.values,o=a.indexOf(r),s=o===-1?a.length:o;a[s]=r,i[s]=n},e}(),fg=function(){function e(){this.object={}}var t=e.prototype;return t.get=function(r){return this.object[r]},t.set=function(r,n){this.object[r]=n},e}(),dg=typeof Map=="function",vg=function(){function e(){}var t=e.prototype;return t.connect=function(r,n){this.prev=r,this.next=n,r&&(r.next=this),n&&(n.prev=this)},t.disconnect=function(){var r=this.prev,n=this.next;r&&(r.next=n),n&&(n.prev=r)},t.getIndex=function(){for(var r=this,n=-1;r;)r=r.prev,++n;return n},e}();function pg(e,t){var r=[],n=[];return e.forEach(function(a){var i=a[0],o=a[1],s=new vg;r[i]=s,n[o]=s}),r.forEach(function(a,i){a.connect(r[i-1])}),e.filter(function(a,i){return!t[i]}).map(function(a,i){var o=a[0],s=a[1];if(o===s)return[0,0];var l=r[o],u=n[s-1],c=l.getIndex();l.disconnect(),u?l.connect(u,u.next):l.connect(void 0,r[0]);var f=l.getIndex();return[c,f]})}var hg=function(){function e(r,n,a,i,o,s,l,u){this.prevList=r,this.list=n,this.added=a,this.removed=i,this.changed=o,this.maintained=s,this.changedBeforeAdded=l,this.fixed=u}var t=e.prototype;return Object.defineProperty(t,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),t.caculateOrdered=function(){var r=pg(this.changedBeforeAdded,this.fixed),n=this.changed,a=[];this.cacheOrdered=r.filter(function(i,o){var s=i[0],l=i[1],u=n[o],c=u[0],f=u[1];if(s!==l)return a.push([c,f]),!0}),this.cachePureChanged=a},e}();function Ja(e,t,r){var n=dg?Map:r?fg:cg,a=r||function(y){return y},i=[],o=[],s=[],l=e.map(a),u=t.map(a),c=new n,f=new n,d=[],h=[],v={},p=[],g=0,b=0;return l.forEach(function(y,S){c.set(y,S)}),u.forEach(function(y,S){f.set(y,S)}),l.forEach(function(y,S){var C=f.get(y);typeof C>"u"?(++b,o.push(S)):v[C]=b}),u.forEach(function(y,S){var C=c.get(y);typeof C>"u"?(i.push(S),++g):(s.push([C,S]),b=v[S]||0,d.push([C-b,S-g]),h.push(S===C),C!==S&&p.push([C,S]))}),o.reverse(),new hg(e,t,i,o,p,s,d,h)}var gg=function(){function e(r,n){r===void 0&&(r=[]),this.findKeyCallback=n,this.list=[].slice.call(r)}var t=e.prototype;return t.update=function(r){var n=[].slice.call(r),a=Ja(this.list,n,this.findKeyCallback);return this.list=n,a},e}(),mg="function",_g="object",bg="string",yg="number",Hs="undefined",j0=typeof window!==Hs,xg=typeof document!==Hs&&document,Sg=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],ir=1e-7,gi={cm:function(e){return e*96/2.54},mm:function(e){return e*96/254},in:function(e){return e*96},pt:function(e){return e*96/72},pc:function(e){return e*96/6},"%":function(e,t){return e*t/100},vw:function(e,t){return t===void 0&&(t=window.innerWidth),e/100*t},vh:function(e,t){return t===void 0&&(t=window.innerHeight),e/100*t},vmax:function(e,t){return t===void 0&&(t=Math.max(window.innerWidth,window.innerHeight)),e/100*t},vmin:function(e,t){return t===void 0&&(t=Math.min(window.innerWidth,window.innerHeight)),e/100*t}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function wg(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}function Pn(e,t,r,n){return(e*n+t*r)/(r+n)}function ei(e){return typeof e===Hs}function Kr(e){return e&&typeof e===_g}function or(e){return Array.isArray(e)}function Lr(e){return typeof e===bg}function ts(e){return typeof e===yg}function Gs(e){return typeof e===mg}function Cg(e,t){var r=e===""||e==" ",n=t===""||t==" ";return n&&r||e===t}function q0(e,t,r,n,a){var i=Ws(e,t,r);return i?r:Eg(e,t,r+1,n,a)}function Ws(e,t,r){if(!e.ignore)return null;var n=t.slice(Math.max(r-3,0),r+3).join("");return new RegExp(e.ignore).exec(n)}function Eg(e,t,r,n,a){for(var i=function(u){var c=t[u].trim();if(c===e.close&&!Ws(e,t,u))return{value:u};var f=u,d=vn(a,function(h){var v=h.open;return v===c});if(d&&(f=q0(d,t,u,n,a)),f===-1)return o=u,"break";u=f,o=u},o,s=r;s<n;++s){var l=i(s);if(s=o,typeof l=="object")return l.value;if(l==="break")break}return-1}function Xs(e,t){var r=Lr(t)?{separator:t}:t,n=r.separator,a=n===void 0?",":n,i=r.isSeparateFirst,o=r.isSeparateOnlyOpenClose,s=r.isSeparateOpenClose,l=s===void 0?o:s,u=r.openCloseCharacters,c=u===void 0?Sg:u,f=c.map(function(P){var G=P.open,W=P.close;return G===W?G:G+"|"+W}).join("|"),d="(\\s*"+a+"\\s*|"+f+"|\\s+)",h=new RegExp(d,"g"),v=e.split(h).filter(function(P){return P&&P!=="undefined"}),p=v.length,g=[],b=[];function y(){return b.length?(g.push(b.join("")),b=[],!0):!1}for(var S=function(P){var G=v[P].trim(),W=P,L=vn(c,function(oe){var re=oe.open;return re===G}),X=vn(c,function(oe){var re=oe.close;return re===G});if(L){if(W=q0(L,v,P,p,c),W!==-1&&l)return y()&&i||(g.push(v.slice(P,W+1).join("")),P=W,i)?(C=P,"break"):(C=P,"continue")}else if(X&&!Ws(X,v,P)){var M=wg(c);return M.splice(c.indexOf(X),1),{value:Xs(e,{separator:a,isSeparateFirst:i,isSeparateOnlyOpenClose:o,isSeparateOpenClose:l,openCloseCharacters:M})}}else if(Cg(G,a)&&!o)return y(),i?(C=P,"break"):(C=P,"continue");W===-1&&(W=p-1),b.push(v.slice(P,W+1).join("")),P=W,C=P},C,T=0;T<p;++T){var D=S(T);if(T=C,typeof D=="object")return D.value;if(D==="break")break}return b.length&&g.push(b.join("")),g}function Cn(e){return Xs(e,"")}function Hn(e){return Xs(e,",")}function K0(e){var t=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(e);return!t||t.length<4?{}:{prefix:t[1],value:t[2],suffix:t[3]}}function ti(e){var t=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(e);if(!t)return{prefix:"",unit:"",value:NaN};var r=t[1],n=t[2],a=t[3];return{prefix:r,unit:a,value:parseFloat(n)}}function Mg(e){return e.replace(/[\s-_]+([^\s-_])/g,function(t,r){return r.toUpperCase()})}function Oi(e,t){return e.replace(/([a-z])([A-Z])/g,function(r,n,a){return""+n+t+a.toLowerCase()})}function Va(){return Date.now?Date.now():new Date().getTime()}function dn(e,t,r){r===void 0&&(r=-1);for(var n=e.length,a=0;a<n;++a)if(t(e[a],a,e))return a;return r}function vn(e,t,r){var n=dn(e,t);return n>-1?e[n]:r}var Z0=function(){var e=Va(),t=j0&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return t?t.bind(window):function(r){var n=Va(),a=setTimeout(function(){r(n-e)},1e3/60);return a}}(),kg=function(){var e=j0&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return e?e.bind(window):function(t){clearTimeout(t)}}();function ma(e){return Object.keys(e)}function Yt(e,t){var r=ti(e),n=r.value,a=r.unit;if(Kr(t)){var i=t[a];if(i){if(Gs(i))return i(n);if(gi[a])return gi[a](n,i)}}else if(a==="%")return n*t/100;return gi[a]?gi[a](n):n}function rs(e,t,r){return Math.max(t,Math.min(e,r))}function gu(e,t,r,n){return n===void 0&&(n=e[0]/e[1]),[[Et(t[0],ir),Et(t[0]/n,ir)],[Et(t[1]*n,ir),Et(t[1],ir)]].filter(function(a){return a.every(function(i,o){var s=t[o],l=Et(s,ir);return r?i<=s||i<=l:i>=s||i>=l})})[0]||e}function Tg(e,t,r,n){if(!n)return e.map(function(h,v){return rs(h,t[v],r[v])});var a=e[0],i=e[1],o=n===!0?a/i:n,s=gu(e,t,!1,o),l=s[0],u=s[1],c=gu(e,r,!0,o),f=c[0],d=c[1];return a<l||i<u?(a=l,i=u):(a>f||i>d)&&(a=f,i=d),[a,i]}function Rg(e){for(var t=e.length,r=0,n=t-1;n>=0;--n)r+=e[n];return r}function ns(e){for(var t=e.length,r=0,n=t-1;n>=0;--n)r+=e[n];return t?r/t:0}function rr(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=Math.atan2(n,r);return a>=0?a:a+Math.PI*2}function Dg(e){return[0,1].map(function(t){return ns(e.map(function(r){return r[t]}))})}function as(e){var t=Dg(e),r=rr(t,e[0]),n=rr(t,e[1]);return r<n&&n-r<Math.PI||r>n&&n-r<-Math.PI?1:-1}function Ur(e,t){return Math.sqrt(Math.pow((t?t[0]:0)-e[0],2)+Math.pow((t?t[1]:0)-e[1],2))}function Et(e,t){if(!t)return e;var r=1/t;return Math.round(e/t)/r}function mu(e,t){return e.forEach(function(r,n){e[n]=Et(e[n],t)}),e}function cr(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function Q0(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function J0(e,t){if(e.classList)e.classList.remove(t);else{var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ")}}function mr(e,t,r,n){e.addEventListener(t,r,n)}function pr(e,t,r,n){e.removeEventListener(t,r,n)}function Ag(e){return(e==null?void 0:e.ownerDocument)||xg}function Po(e){var t;return((t=e==null?void 0:e.ownerDocument)===null||t===void 0?void 0:t.defaultView)||window}function Ig(e){return e&&"postMessage"in e&&"blur"in e&&"self"in e}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var is=function(e,t){return is=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},is(e,t)};function Zn(e,t){is(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var xn=function(){return xn=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},xn.apply(this,arguments)};function ec(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Bg(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}function os(e,t){if(e===t)return!1;for(var r in e)if(!(r in t))return!0;for(var r in t)if(e[r]!==t[r])return!0;return!1}function Ys(e,t){var r=Object.keys(e),n=Object.keys(t),a=Ja(r,n,function(l){return l}),i={},o={},s={};return a.added.forEach(function(l){var u=n[l];i[u]=t[u]}),a.removed.forEach(function(l){var u=r[l];o[u]=e[u]}),a.maintained.forEach(function(l){var u=l[0],c=r[u],f=[e[c],t[c]];e[c]!==t[c]&&(s[c]=f)}),{added:i,removed:o,changed:s}}function tc(e){e.forEach(function(t){t()})}function _u(e){var t=0;return e.map(function(r){return r==null?"$compat"+ ++t:""+r})}function bu(e,t,r,n){if(Lr(e)||ts(e))return new Fg("text_"+e,t,r,n,null,{});var a=typeof e.type=="string"?$g:e.type.prototype.render?zg:Ng;return new a(e.type,t,r,n,e.ref,e.props)}function rc(e){var t=[];return e.forEach(function(r){t=t.concat(or(r)?rc(r):r)}),t}function yu(e){var t=e.className,r=ec(e,["className"]);return t!=null&&(r.class=t),delete r.style,delete r.children,r}function Lo(e,t){if(!t)return e;for(var r in t)ei(e[r])&&(e[r]=t[r]);return e}function zr(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=t||{},i=a.key,o=a.ref,s=ec(a,["key","ref"]);return{type:e,key:i,ref:o,props:xn(xn({},s),{children:rc(r).filter(function(l){return l!=null&&l!==!1})})}}var ri=function(){function e(r,n,a,i,o,s){s===void 0&&(s={}),this.type=r,this.key=n,this.index=a,this.container=i,this.ref=o,this.props=s,this._providers=[]}var t=e.prototype;return t._should=function(r,n){return!0},t._update=function(r,n,a,i){if(this.base&&!Lr(n)&&!i&&!this._should(n.props,a))return!1;this.original=n,this._setState(a);var o=this.props;return Lr(n)||(this.props=n.props,this.ref=n.ref),this._render(r,this.base?o:{},a),!0},t._mounted=function(){var r=this.ref;r&&r(this.base)},t._setState=function(r){},t._updated=function(){var r=this.ref;r&&r(this.base)},t._destroy=function(){var r=this.ref;r&&r(null)},e}();function Og(e,t,r){var n=Ys(e,t),a=n.added,i=n.removed,o=n.changed;for(var s in a)r.setAttribute(s,a[s]);for(var s in o)r.setAttribute(s,o[s][1]);for(var s in i)r.removeAttribute(s)}function Pg(e,t,r){var n=Ys(e,t),a=n.added,i=n.removed,o=n.changed;for(var s in i)r.removeEventListener(s);for(var s in a)r.addEventListener(s,a[s]);for(var s in o)r.removeEventListener(s),r.addEventListener(s,o[s][1]);for(var s in i)r.removeEventListener(s)}function Lg(e,t,r){var n=r.style,a=Ys(e,t),i=a.added,o=a.removed,s=a.changed;for(var l in i){var u=Oi(l,"-");n.setProperty?n.setProperty(u,i[l]):n[u]=i[l]}for(var l in s){var u=Oi(l,"-");n.setProperty?n.setProperty(u,s[l][1]):n[u]=s[l][1]}for(var l in o){var u=Oi(l,"-");n.removeProperty?n.removeProperty(u):n[u]=""}}function xu(e){var t={},r={};for(var n in e)n.indexOf("on")===0?r[n.replace("on","").toLowerCase()]=e[n]:t[n]=e[n];return{attributes:t,events:r}}var Fg=function(e){Zn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r._render=function(n){var a=this,i=!this.base;return i&&(this.base=document.createTextNode(this.type.replace("text_",""))),n.push(function(){i?a._mounted():a._updated()}),!0},r._unmount=function(){this.base.parentNode.removeChild(this.base)},t}(ri),$g=function(e){Zn(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.events={},n._isSVG=!1,n}var r=t.prototype;return r.addEventListener=function(n,a){var i=this.events;i[n]=function(o){o.nativeEvent=o,a(o)},this.base.addEventListener(n,i[n])},r.removeEventListener=function(n){var a=this.events;this.base.removeEventListener(n,a[n]),delete a[n]},r._should=function(n){return os(this.props,n)},r._render=function(n,a){var i=this,o=!this.base;if(o){var s=this._hasSVG();this._isSVG=s;var l=this.props.portalContainer;if(!l){var u=this.type;s?l=document.createElementNS("http://www.w3.org/2000/svg",u):l=document.createElement(u)}this.base=l}ni(this,this._providers,this.props.children,n,null);var c=this.base,f=xu(a),d=f.attributes,h=f.events,v=xu(this.props),p=v.attributes,g=v.events;return Og(yu(d),yu(p),c),Pg(h,g,this),Lg(a.style||{},this.props.style||{},c),n.push(function(){o?i._mounted():i._updated()}),!0},r._unmount=function(){var n=this.events,a=this.base;for(var i in n)a.removeEventListener(i,n[i]);this._providers.forEach(function(o){o._unmount()}),this.events={},this.props.portalContainer||a.parentNode.removeChild(a)},r._hasSVG=function(){if(this._isSVG||this.type==="svg")return!0;var n=Us(this.container);return n&&"ownerSVGElement"in n},t}(ri);function Us(e){if(!e)return null;var t=e.base;return t instanceof Node?t:Us(e.container)}function Ha(e){if(!e)return null;if(e instanceof Node)return e;var t=e.$_provider._providers;return t.length?Ha(t[0].base):null}var Ng=function(e){Zn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r._render=function(n){var a=this.type(this.props);return ni(this,this._providers,a?[a]:[],n),!0},r._unmount=function(){this._providers.forEach(function(n){n._unmount()})},t}(ri),nc=function(e){Zn(t,e);function t(n){var a=e.call(this,"container","container",0,null)||this;return a.base=n,a}var r=t.prototype;return r._render=function(){return!0},r._unmount=function(){},t}(ri),zg=function(e){Zn(t,e);function t(n,a,i,o,s,l){return l===void 0&&(l={}),e.call(this,n,a,i,o,s,Lo(l,n.defaultProps))||this}var r=t.prototype;return r._should=function(n,a){return this.base.shouldComponentUpdate(Lo(n,this.type.defaultProps),a||this.base.state)},r._render=function(n,a){var i=this;this.props=Lo(this.props,this.type.defaultProps);var o=!this.base;o?(this.base=new this.type(this.props),this.base.$_provider=this):this.base.props=this.props;var s=this.base,l=s.state,u=s.render();u&&u.props&&!u.props.children.length&&(u.props.children=this.props.children),ni(this,this._providers,u?[u]:[],n),n.push(function(){o?(i._mounted(),s.componentDidMount()):(i._updated(),s.componentDidUpdate(a,l))})},r._setState=function(n){var a=this.base;!a||!n||(a.state=n)},r._unmount=function(){this._providers.forEach(function(n){n._unmount()}),clearTimeout(this.base.$_timer),this.base.componentWillUnmount()},t}(ri),js=function(){function e(r){r===void 0&&(r={}),this.props=r,this.state={},this.$_timer=0,this.$_state={}}var t=e.prototype;return t.shouldComponentUpdate=function(r,n){return!0},t.render=function(){return null},t.setState=function(r,n,a){var i=this;this.$_timer||(this.$_state={}),clearTimeout(this.$_timer),this.$_timer=0,this.$_state=xn(xn({},this.$_state),r),a?this.$_setState(n,a):this.$_timer=setTimeout(function(){i.$_timer=0,i.$_setState(n,a)})},t.forceUpdate=function(r){this.setState({},r,!0)},t.componentDidMount=function(){},t.componentDidUpdate=function(r,n){},t.componentWillUnmount=function(){},t.$_setState=function(r,n){var a=[],i=this.$_provider,o=ni(i.container,[i],[i.original],a,xn(xn({},this.state),this.$_state),n);o&&(r&&a.push(r),tc(a))},e}(),qs=function(e){Zn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r.shouldComponentUpdate=function(n,a){return os(this.props,n)||os(this.state,a)},t}(js),Vg=function(e){Zn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r.componentDidMount=function(){var n=this.props,a=n.element,i=n.container;this._portalProvider=new nc(i),Pi(a,i,this._portalProvider)},r.componentDidUpdate=function(){var n=this.props,a=n.element,i=n.container;Pi(a,i,this._portalProvider)},r.componentWillUnmount=function(){var n=this.props.container;Pi(null,n,this._portalProvider),this._portalProvider=null},t}(qs);function Hg(e,t,r){var n=[];ni(e,e._providers,t,n,r),tc(n)}function Gg(e,t){for(var r=e._providers,n=r.length,a=t.index+1;a<n;++a){var i=Ha(r[a].base);if(i)return i}return null}function Wg(e,t,r){var n=r.map(function(l){return Lr(l)?null:l.key}),a=_u(t.map(function(l){return l.key})),i=_u(n),o=Ja(a,i,function(l){return l});o.removed.forEach(function(l){t.splice(l,1)[0]._unmount()}),o.ordered.forEach(function(l){var u=l[0],c=l[1],f=t.splice(u,1)[0];t.splice(c,0,f);var d=Ha(f.base),h=Ha(t[c+1]&&t[c+1].base);d&&d.parentNode.insertBefore(d,h)}),o.added.forEach(function(l){t.splice(l,0,bu(r[l],n[l],l,e))});var s=o.maintained.filter(function(l){l[0];var u=l[1],c=r[u],f=t[u],d=Lr(c)?"text_"+c:c.type;return d!==f.type?(f._unmount(),t.splice(u,1,bu(c,n[u],u,e)),!0):(f.index=u,!1)});return Bg(o.added,s.map(function(l){l[0];var u=l[1];return u}))}function ni(e,t,r,n,a,i){var o=Wg(e,t,r),s=t.filter(function(u,c){return u._update(n,r[c],a,i)}),l=Us(e);return l&&o.reverse().forEach(function(u){var c=t[u],f=Ha(c.base);if(f&&l!==f&&!f.parentNode){var d=Gg(e,c);l.insertBefore(f,d)}}),s.length>0}function Pi(e,t,r){r===void 0&&(r=t.__REACT_COMPAT__);var n=!!r;return r||(r=new nc(t)),Hg(r,e?[e]:[]),n||(t.__REACT_COMPAT__=r),r}function Su(e,t,r){var n=t.__REACT_COMPAT__;e&&!n&&(t.innerHTML=""),Pi(e,t,n)}function Xg(e,t){return zr(Vg,{element:e,container:t})}var Yg="simple-1.1.0";function Ks(e,t){for(var r=e.length,n=0;n<r;++n)if(t(e[n],n))return!0;return!1}function ac(e,t){for(var r=e.length,n=0;n<r;++n)if(t(e[n],n))return e[n];return null}function ic(e){var t=e;if(typeof t>"u"){if(typeof navigator>"u"||!navigator)return"";t=navigator.userAgent||""}return t.toLowerCase()}function Zs(e,t){try{return new RegExp(e,"g").exec(t)}catch{return null}}function Ug(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var e=navigator.userAgentData,t=e.brands||e.uaList;return!!(t&&t.length)}function jg(e,t){var r=Zs("("+e+")((?:\\/|\\s|:)([0-9|\\.|_]+))",t);return r?r[3]:""}function ss(e){return e.replace(/_/g,".")}function Ma(e,t){var r=null,n="-1";return Ks(e,function(a){var i=Zs("("+a.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",t);return!i||a.brand?!1:(r=a,n=i[3]||"-1",a.versionAlias?n=a.versionAlias:a.versionTest&&(n=jg(a.versionTest.toLowerCase(),t)||n),n=ss(n),!0)}),{preset:r,version:n}}function mi(e,t){var r={brand:"",version:"-1"};return Ks(e,function(n){var a=oc(t,n);return a?(r.brand=n.id,r.version=n.versionAlias||a.version,r.version!=="-1"):!1}),r}function oc(e,t){return ac(e,function(r){var n=r.brand;return Zs(""+t.test,n.toLowerCase())})}var sc=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],lc=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],ls=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],uc=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],cc=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function fc(e){return!!Ma(uc,e).preset}function qg(e){var t=ic(e),r=!!/mobi/g.exec(t),n={name:"unknown",version:"-1",majorVersion:-1,webview:fc(t),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},a={name:"unknown",version:"-1",majorVersion:-1},i=Ma(sc,t),o=i.preset,s=i.version,l=Ma(cc,t),u=l.preset,c=l.version,f=Ma(lc,t);if(n.chromium=!!f.preset,n.chromiumVersion=f.version,!n.chromium){var d=Ma(ls,t);n.webkit=!!d.preset,n.webkitVersion=d.version}return u&&(a.name=u.id,a.version=c,a.majorVersion=parseInt(c,10)),o&&(n.name=o.id,n.version=s,n.webview&&a.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:a,isMobile:r,isHints:!1}}function Kg(e){var t=navigator.userAgentData,r=(t.uaList||t.brands).slice(),n=t.mobile||!1,a=r[0],i=(t.platform||navigator.platform).toLowerCase(),o={name:a.brand,version:a.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!mi(uc,r).brand||fc(ic())},s={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&Ks(ls,function(d){return oc(r,d)});var l=mi(lc,r);if(o.chromium=!!l.brand,o.chromiumVersion=l.version||"-1",!o.chromium){var u=mi(ls,r);o.webkit=!!u.brand,o.webkitVersion=u.version||"-1"}var c=ac(cc,function(d){return new RegExp(""+d.test,"g").exec(i)});s.name=c?c.id:"";{var f=mi(sc,r);o.name=f.brand||o.name,o.version=f.brand&&e?e.uaFullVersion:f.version}return o.webkit&&(s.name=n?"ios":"mac"),s.name==="ios"&&o.webview&&(o.version="-1"),s.version=ss(s.version),o.version=ss(o.version),s.majorVersion=parseInt(s.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:s,isMobile:n,isHints:!0}}function Zg(e){return Ug()?Kg():qg(e)}function Qg(e,t,r,n,a,i){for(var o=0;o<a;++o){var s=r+o*a,l=n+o*a;e[s]+=e[l]*i,t[s]+=t[l]*i}}function Jg(e,t,r,n,a){for(var i=0;i<a;++i){var o=r+i*a,s=n+i*a,l=e[o],u=t[o];e[o]=e[s],e[s]=l,t[o]=t[s],t[s]=u}}function em(e,t,r,n,a){for(var i=0;i<n;++i){var o=r+i*n;e[o]/=a,t[o]/=a}}function dc(e,t,r){for(var n=e.slice(),a=0;a<r;++a)n[a*r+t-1]=0,n[(t-1)*r+a]=0;return n[(t-1)*(r+1)]=1,n}function nn(e,t){t===void 0&&(t=Math.sqrt(e.length));for(var r=e.slice(),n=Jt(t),a=0;a<t;++a){var i=t*a+a;if(!Et(r[i],ir)){for(var o=a+1;o<t;++o)if(r[t*a+o]){Jg(r,n,a,o,t);break}}if(!Et(r[i],ir))return[];em(r,n,a,t,r[i]);for(var o=0;o<t;++o){var s=o,l=o+a*t,u=r[l];!Et(u,ir)||a===o||Qg(r,n,s,a,t,-u)}}return n}function tm(e,t){t===void 0&&(t=Math.sqrt(e.length));for(var r=[],n=0;n<t;++n)for(var a=0;a<t;++a)r[a*t+n]=e[t*n+a];return r}function vc(e,t){t===void 0&&(t=Math.sqrt(e.length));for(var r=[],n=e[t*t-1],a=0;a<t-1;++a)r[a]=e[t*(t-1)+a]/n;return r[t-1]=0,r}function rm(e,t){for(var r=Jt(t),n=0;n<t-1;++n)r[t*(t-1)+n]=e[n]||0;return r}function Xn(e,t){for(var r=e.slice(),n=e.length;n<t-1;++n)r[n]=0;return r[t-1]=1,r}function an(e,t,r){if(t===void 0&&(t=Math.sqrt(e.length)),t===r)return e;for(var n=Jt(r),a=Math.min(t,r),i=0;i<a-1;++i){for(var o=0;o<a-1;++o)n[i*r+o]=e[i*t+o];n[(i+1)*r-1]=e[(i+1)*t-1],n[(r-1)*r+i]=e[(t-1)*t+i]}return n[r*r-1]=e[t*t-1],n}function us(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=Jt(e);return t.forEach(function(a){n=Wt(n,a,e)}),n}function Wt(e,t,r){r===void 0&&(r=Math.sqrt(e.length));var n=[],a=e.length/r,i=t.length/a;if(a){if(!i)return e}else return t;for(var o=0;o<r;++o)for(var s=0;s<i;++s){n[s*r+o]=0;for(var l=0;l<a;++l)n[s*r+o]+=e[l*r+o]*t[s*a+l]}return n}function At(e,t){for(var r=Math.min(e.length,t.length),n=e.slice(),a=0;a<r;++a)n[a]=n[a]+t[a];return n}function gt(e,t){for(var r=Math.min(e.length,t.length),n=e.slice(),a=0;a<r;++a)n[a]=n[a]-t[a];return n}function nm(e,t){return t===void 0&&(t=e.length===6),t?[e[0],e[1],0,e[2],e[3],0,e[4],e[5],1]:e}function pc(e,t){return t===void 0&&(t=e.length===9),t?[e[0],e[1],e[3],e[4],e[6],e[7]]:e}function gr(e,t,r){r===void 0&&(r=t.length);var n=Wt(e,t,r),a=n[r-1];return n.map(function(i){return i/a})}function am(e,t){return Wt(e,[1,0,0,0,0,Math.cos(t),Math.sin(t),0,0,-Math.sin(t),Math.cos(t),0,0,0,0,1],4)}function im(e,t){return Wt(e,[Math.cos(t),0,-Math.sin(t),0,0,1,0,0,Math.sin(t),0,Math.cos(t),0,0,0,0,1],4)}function om(e,t){return Wt(e,la(t,4))}function _i(e,t){var r=t[0],n=r===void 0?1:r,a=t[1],i=a===void 0?1:a,o=t[2],s=o===void 0?1:o;return Wt(e,[n,0,0,0,0,i,0,0,0,0,s,0,0,0,0,1],4)}function ai(e,t){return gr(la(t,3),Xn(e,3))}function Fo(e,t){var r=t[0],n=r===void 0?0:r,a=t[1],i=a===void 0?0:a,o=t[2],s=o===void 0?0:o;return Wt(e,[1,0,0,0,0,1,0,0,0,0,1,0,n,i,s,1],4)}function wu(e,t){return Wt(e,t,4)}function la(e,t){var r=Math.cos(e),n=Math.sin(e),a=Jt(t);return a[0]=r,a[1]=n,a[t]=-n,a[t+1]=r,a}function Jt(e){for(var t=e*e,r=[],n=0;n<t;++n)r[n]=n%(e+1)?0:1;return r}function Qs(e,t){for(var r=Jt(t),n=Math.min(e.length,t-1),a=0;a<n;++a)r[(t+1)*a]=e[a];return r}function Ga(e,t){for(var r=Jt(t),n=Math.min(e.length,t-1),a=0;a<n;++a)r[t*(t-1)+a]=e[a];return r}function Js(e,t,r,n,a,i,o,s){var l=e[0],u=e[1],c=t[0],f=t[1],d=r[0],h=r[1],v=n[0],p=n[1],g=a[0],b=a[1],y=i[0],S=i[1],C=o[0],T=o[1],D=s[0],P=s[1],G=[l,0,c,0,d,0,v,0,u,0,f,0,h,0,p,0,1,0,1,0,1,0,1,0,0,l,0,c,0,d,0,v,0,u,0,f,0,h,0,p,0,1,0,1,0,1,0,1,-g*l,-b*l,-y*c,-S*c,-C*d,-T*d,-D*v,-P*v,-g*u,-b*u,-y*f,-S*f,-C*h,-T*h,-D*p,-P*p],W=nn(G,8);if(!W.length)return[];var L=Wt(W,[g,b,y,S,C,T,D,P],8);return L[8]=1,an(tm(L),3,4)}var Ba=function(){return Ba=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ba.apply(this,arguments)};function sm(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function el(e,t){return t===void 0&&(t=0),ta(Ln(e,t))}function lm(e,t){var r=gr(e,[t[0],t[1]||0,t[2]||0,1],4),n=r[3]||1;return[r[0]/n,r[1]/n,r[2]/n]}function ta(e){var t=sm();return e.forEach(function(r){var n=r.matrixFunction,a=r.functionValue;n&&(t=n(t,a))}),t}function Ln(e,t){t===void 0&&(t=0);var r=or(e)?e:Cn(e);return r.map(function(n){var a=K0(n),i=a.prefix,o=a.value,s=null,l=i,u="";if(i==="translate"||i==="translateX"||i==="translate3d"){var c=Kr(t)?Ba(Ba({},t),{"o%":t["%"]}):{"%":t,"o%":t},f=Hn(o).map(function(oe,re){return re===0&&"x%"in c?c["%"]=t["x%"]:re===1&&"y%"in c?c["%"]=t["y%"]:c["%"]=t["o%"],Yt(oe,c)}),d=f[0],h=f[1],v=h===void 0?0:h,p=f[2],g=p===void 0?0:p;s=Fo,u=[d,v,g]}else if(i==="translateY"){var b=Kr(t)?Ba({"%":t["y%"]},t):{"%":t},v=Yt(o,b);s=Fo,u=[0,v,0]}else if(i==="translateZ"){var g=parseFloat(o);s=Fo,u=[0,0,g]}else if(i==="scale"||i==="scale3d"){var y=Hn(o).map(function(oe){return parseFloat(oe)}),S=y[0],C=y[1],T=C===void 0?S:C,D=y[2],P=D===void 0?1:D;s=_i,u=[S,T,P]}else if(i==="scaleX"){var S=parseFloat(o);s=_i,u=[S,1,1]}else if(i==="scaleY"){var T=parseFloat(o);s=_i,u=[1,T,1]}else if(i==="scaleZ"){var P=parseFloat(o);s=_i,u=[1,1,P]}else if(i==="rotate"||i==="rotateZ"||i==="rotateX"||i==="rotateY"){var G=ti(o),W=G.unit,L=G.value,X=W==="rad"?L:L*Math.PI/180;i==="rotate"||i==="rotateZ"?(l="rotateZ",s=om):i==="rotateX"?s=am:i==="rotateY"&&(s=im),u=X}else if(i==="matrix3d")s=wu,u=Hn(o).map(function(oe){return parseFloat(oe)});else if(i==="matrix"){var M=Hn(o).map(function(oe){return parseFloat(oe)});s=wu,u=[M[0],M[1],0,0,M[2],M[3],0,0,0,0,1,0,M[4],M[5],0,1]}else l="";return{name:i,functionName:l,value:o,matrixFunction:s,functionValue:u}})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var cs=function(e,t){return cs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},cs(e,t)};function um(e,t){cs(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var hc=typeof Map=="function"?void 0:function(){var e=0;return function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++e)}}(),gc=function(e){um(t,e);function t(r){return r===void 0&&(r=[]),e.call(this,r,hc)||this}return t}(gg);function cm(e,t){return Ja(e,t,hc)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function fm(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}function kr(e){return Et(e,ir)}function dm(e,t){return e.every(function(r,n){return kr(r-t[n])===0})}function vm(e,t){return!kr(e[0]-t[0])&&!kr(e[1]-t[1])}function mc(e){return e.length<3?0:Math.abs(Rg(e.map(function(t,r){var n=e[r+1]||e[0];return t[0]*n[1]-n[0]*t[1]})))/2}function Cu(e,t){var r=t.width,n=t.height,a=t.left,i=t.top,o=En(e),s=o.minX,l=o.minY,u=o.maxX,c=o.maxY,f=r/(u-s),d=n/(c-l);return e.map(function(h){return[a+(h[0]-s)*f,i+(h[1]-l)*d]})}function En(e){var t=e.map(function(n){return n[0]}),r=e.map(function(n){return n[1]});return{minX:Math.min.apply(Math,t),minY:Math.min.apply(Math,r),maxX:Math.max.apply(Math,t),maxY:Math.max.apply(Math,r)}}function fs(e,t,r){var n=e[0],a=e[1],i=En(t),o=i.minX,s=i.maxX,l=[[o,a],[s,a]],u=Ni(l[0],l[1]),c=ds(t),f=[];if(c.forEach(function(v){var p=Ni(v[0],v[1]),g=v[0];if(dm(u,p))f.push({pos:e,line:v,type:"line"});else{var b=_c(tl(u,p),[l,v]);b.forEach(function(y){v.some(function(S){return vm(S,y)})?f.push({pos:y,line:v,type:"point"}):kr(g[1]-a)!==0&&f.push({pos:y,line:v,type:"intersection"})})}}),vn(f,function(v){return v[0]===n}))return!0;var d=0,h={};return f.forEach(function(v){var p=v.pos,g=v.type,b=v.line;if(!(p[0]>n))if(g==="intersection")++d;else{if(g==="line")return;if(g==="point"){var y=vn(b,function(T){return T[1]!==a}),S=h[p[0]],C=y[1]>a?1:-1;S?S!==C&&++d:h[p[0]]=C}}}),d%2===1}function Ni(e,t){var r=e[0],n=e[1],a=t[0],i=t[1],o=a-r,s=i-n;Math.abs(o)<ir&&(o=0),Math.abs(s)<ir&&(s=0);var l=0,u=0,c=0;return o?s?(l=-s/o,u=1,c=-l*r-n):(u=1,c=-n):s&&(l=-1,c=r),[l,u,c]}function tl(e,t){var r=e[0],n=e[1],a=e[2],i=t[0],o=t[1],s=t[2],l=r===0&&i===0,u=n===0&&o===0,c=[];if(l&&u)return[];if(l){var f=-a/n,d=-s/o;return f!==d?[]:[[-1/0,f],[1/0,f]]}else if(u){var h=-a/r,v=-s/i;return h!==v?[]:[[h,-1/0],[h,1/0]]}else if(r===0){var p=-a/n,g=-(o*p+s)/i;c=[[g,p]]}else if(i===0){var p=-s/o,g=-(n*p+a)/r;c=[[g,p]]}else if(n===0){var g=-a/r,p=-(i*g+s)/o;c=[[g,p]]}else if(o===0){var g=-s/i,p=-(r*g+a)/n;c=[[g,p]]}else{var g=(n*s-o*a)/(o*r-n*i),p=-(r*g+a)/n;c=[[g,p]]}return c.map(function(b){return[b[0],b[1]]})}function _c(e,t){var r=t.map(function(f){return[0,1].map(function(d){return[Math.min(f[0][d],f[1][d]),Math.max(f[0][d],f[1][d])]})}),n=[];if(e.length===2){var a=e[0],i=a[0],o=a[1];if(kr(i-e[1][0])){if(!kr(o-e[1][1])){var u=Math.max.apply(Math,r.map(function(f){return f[0][0]})),c=Math.min.apply(Math,r.map(function(f){return f[0][1]}));if(kr(u-c)>0)return[];n=[[u,o],[c,o]]}}else{var s=Math.max.apply(Math,r.map(function(f){return f[1][0]})),l=Math.min.apply(Math,r.map(function(f){return f[1][1]}));if(kr(s-l)>0)return[];n=[[i,s],[i,l]]}}return n.length||(n=e.filter(function(f){var d=f[0],h=f[1];return r.every(function(v){return 0<=kr(d-v[0][0])&&0<=kr(v[0][1]-d)&&0<=kr(h-v[1][0])&&0<=kr(v[1][1]-h)})})),n.map(function(f){return[kr(f[0]),kr(f[1])]})}function ds(e){return fm(e.slice(1),[e[0]]).map(function(t,r){return[e[r],t]})}function pm(e,t){var r=e.slice(),n=t.slice();as(r)===-1&&r.reverse(),as(n)===-1&&n.reverse();var a=ds(r),i=ds(n),o=a.map(function(c){return Ni(c[0],c[1])}),s=i.map(function(c){return Ni(c[0],c[1])}),l=[];o.forEach(function(c,f){var d=a[f],h=[];s.forEach(function(v,p){var g=tl(c,v),b=_c(g,[d,i[p]]);h.push.apply(h,b.map(function(y){return{index1:f,index2:p,pos:y,type:"intersection"}}))}),h.sort(function(v,p){return Ur(d[0],v.pos)-Ur(d[0],p.pos)}),l.push.apply(l,h),fs(d[1],n)&&l.push({index1:f,index2:-1,pos:d[1],type:"inside"})}),i.forEach(function(c,f){if(fs(c[1],r)){var d=!1,h=dn(l,function(v){var p=v.index2;return p===f?(d=!0,!1):!!d});h===-1&&(d=!1,h=dn(l,function(v){var p=v.index1,g=v.index2;return p===-1&&g+1===f?(d=!0,!1):!!d})),h===-1?l.push({index1:-1,index2:f,pos:c[1],type:"inside"}):l.splice(h,0,{index1:-1,index2:f,pos:c[1],type:"inside"})}});var u={};return l.filter(function(c){var f=c.pos,d=f[0]+"x"+f[1];return u[d]?!1:(u[d]=!0,!0)})}function hm(e,t){var r=pm(e,t);return r.map(function(n){var a=n.pos;return a})}function gm(e,t){var r=hm(e,t);return mc(r)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var vs=function(){return vs=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},vs.apply(this,arguments)};function mm(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}var so=function(){function e(){this._events={}}var t=e.prototype;return t.on=function(r,n){if(Kr(r))for(var a in r)this.on(a,r[a]);else this._addEvent(r,n,{});return this},t.off=function(r,n){if(!r)this._events={};else if(Kr(r))for(var a in r)this.off(a);else if(!n)this._events[r]=[];else{var i=this._events[r];if(i){var o=dn(i,function(s){return s.listener===n});o>-1&&i.splice(o,1)}}return this},t.once=function(r,n){var a=this;return n&&this._addEvent(r,n,{once:!0}),new Promise(function(i){a._addEvent(r,i,{once:!0})})},t.emit=function(r,n){var a=this;n===void 0&&(n={});var i=this._events[r];if(!r||!i)return!0;var o=!1;return n.eventType=r,n.stop=function(){o=!0},n.currentTarget=this,mm(i).forEach(function(s){s.listener(n),s.once&&a.off(r,s.listener)}),!o},t.trigger=function(r,n){return n===void 0&&(n={}),this.emit(r,n)},t._addEvent=function(r,n,a){var i=this._events;i[r]=i[r]||[];var o=i[r];o.push(vs({listener:n},a))},e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ps=function(e,t){return ps=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},ps(e,t)};function _m(e,t){ps(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var na=function(){return na=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},na.apply(this,arguments)};function bm(e){var t=e.container;return t===document.body?[t.scrollLeft||document.documentElement.scrollLeft,t.scrollTop||document.documentElement.scrollTop]:[t.scrollLeft,t.scrollTop]}function Eu(e,t){return e.addEventListener("scroll",t),function(){e.removeEventListener("scroll",t)}}function bi(e){if(e){if(Lr(e))return document.querySelector(e)}else return null;if(Gs(e))return e();if(e instanceof Element)return e;if("current"in e)return e.current;if("value"in e)return e.value}var ym=function(e){_m(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._startRect=null,n._startPos=[],n._prevTime=0,n._timer=0,n._prevScrollPos=[0,0],n._isWait=!1,n._flag=!1,n._currentOptions=null,n._lock=!1,n._unregister=null,n._onScroll=function(){var a=n._currentOptions;n._lock||!a||n.emit("scrollDrag",{next:function(i){n.checkScroll({container:a.container,inputEvent:i})}})},n}var r=t.prototype;return r.dragStart=function(n,a){var i=bi(a.container);if(!i){this._flag=!1;return}var o=0,s=0,l=0,u=0;if(i===document.body)l=window.innerWidth,u=window.innerHeight;else{var c=i.getBoundingClientRect();o=c.top,s=c.left,l=c.width,u=c.height}this._flag=!0,this._startPos=[n.clientX,n.clientY],this._startRect={top:o,left:s,width:l,height:u},this._prevScrollPos=this._getScrollPosition([0,0],a),this._currentOptions=a,this._registerScrollEvent(a)},r.drag=function(n,a){if(clearTimeout(this._timer),!!this._flag){var i=n.clientX,o=n.clientY,s=a.threshold,l=s===void 0?0:s,u=this,c=u._startRect,f=u._startPos;this._currentOptions=a;var d=[0,0];return c.top>o-l?(f[1]>c.top||o<f[1])&&(d[1]=-1):c.top+c.height<o+l&&(f[1]<c.top+c.height||o>f[1])&&(d[1]=1),c.left>i-l?(f[0]>c.left||i<f[0])&&(d[0]=-1):c.left+c.width<i+l&&(f[0]<c.left+c.width||i>f[0])&&(d[0]=1),!d[0]&&!d[1]?!1:this._continueDrag(na(na({},a),{direction:d,inputEvent:n,isDrag:!0}))}},r.checkScroll=function(n){var a=this;if(this._isWait)return!1;var i=n.prevScrollPos,o=i===void 0?this._prevScrollPos:i,s=n.direction,l=n.throttleTime,u=l===void 0?0:l,c=n.inputEvent,f=n.isDrag,d=this._getScrollPosition(s||[0,0],n),h=d[0]-o[0],v=d[1]-o[1],p=s||[h?Math.abs(h)/h:0,v?Math.abs(v)/v:0];return this._prevScrollPos=d,this._lock=!1,!h&&!v?!1:(this.emit("move",{offsetX:p[0]?h:0,offsetY:p[1]?v:0,inputEvent:c}),u&&f&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){a._continueDrag(n)},u)),!0)},r.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},r._getScrollPosition=function(n,a){var i=a.container,o=a.getScrollPosition,s=o===void 0?bm:o;return s({container:bi(i),direction:n})},r._continueDrag=function(n){var a=this,i,o=n.container,s=n.direction,l=n.throttleTime,u=n.useScroll,c=n.isDrag,f=n.inputEvent;if(!(!this._flag||c&&this._isWait)){var d=Va(),h=Math.max(l+this._prevTime-d,0);if(h>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){a._continueDrag(n)},h),!1;this._prevTime=d;var v=this._getScrollPosition(s,n);this._prevScrollPos=v,c&&(this._isWait=!0),u||(this._lock=!0);var p={container:bi(o),direction:s,inputEvent:f};return(i=n.requestScroll)===null||i===void 0||i.call(n,p),this.emit("scroll",p),this._isWait=!1,u||this.checkScroll(na(na({},n),{prevScrollPos:v,direction:s,inputEvent:f}))}},r._registerScrollEvent=function(n){this._unregisterScrollEvent();var a=n.checkScrollEvent;if(a){var i=a===!0?Eu:a,o=bi(n.container);a===!0&&(o===document.body||o===document.documentElement)?this._unregister=Eu(window,this._onScroll):this._unregister=i(o,this._onScroll)}},r._unregisterScrollEvent=function(){var n;(n=this._unregister)===null||n===void 0||n.call(this),this._unregister=null},t}(so);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var hs=function(e,t){return hs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},hs(e,t)};function xm(e,t){hs(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var nr=function(){return nr=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},nr.apply(this,arguments)};function Sm(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=Math.atan2(n,r);return a>=0?a:a+Math.PI*2}function $o(e){return Sm([e[0].clientX,e[0].clientY],[e[1].clientX,e[1].clientY])/Math.PI*180}function wm(e){return e.touches&&e.touches.length>=2}function yi(e){return e?e.touches?Em(e.touches):[bc(e)]:[]}function Cm(e){return e&&(e.type.indexOf("mouse")>-1||"button"in e)}function Mu(e,t,r){var n=r.length,a=Oa(e,n),i=a.clientX,o=a.clientY,s=a.originalClientX,l=a.originalClientY,u=Oa(t,n),c=u.clientX,f=u.clientY,d=Oa(r,n),h=d.clientX,v=d.clientY,p=i-c,g=o-f,b=i-h,y=o-v;return{clientX:s,clientY:l,deltaX:p,deltaY:g,distX:b,distY:y}}function No(e){return Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2))}function Em(e){for(var t=Math.min(e.length,2),r=[],n=0;n<t;++n)r.push(bc(e[n]));return r}function bc(e){return{clientX:e.clientX,clientY:e.clientY}}function Oa(e,t){t===void 0&&(t=e.length);for(var r={clientX:0,clientY:0,originalClientX:0,originalClientY:0},n=Math.min(e.length,t),a=0;a<n;++a){var i=e[a];r.originalClientX+="originalClientX"in i?i.originalClientX:i.clientX,r.originalClientY+="originalClientY"in i?i.originalClientY:i.clientY,r.clientX+=i.clientX,r.clientY+=i.clientY}return t?{clientX:r.clientX/t,clientY:r.clientY/t,originalClientX:r.originalClientX/t,originalClientY:r.originalClientY/t}:r}var zo=function(){function e(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}return e.prototype.getAngle=function(t){return t===void 0&&(t=this.prevClients),$o(t)},e.prototype.getRotation=function(t){return t===void 0&&(t=this.prevClients),$o(t)-$o(this.startClients)},e.prototype.getPosition=function(t,r){t===void 0&&(t=this.prevClients);var n=Mu(t||this.prevClients,this.prevClients,this.startClients),a=n.deltaX,i=n.deltaY;return this.movement+=Math.sqrt(a*a+i*i),this.prevClients=t,n},e.prototype.getPositions=function(t){t===void 0&&(t=this.prevClients);for(var r=this.prevClients,n=this.startClients,a=Math.min(this.length,r.length),i=[],o=0;o<a;++o)i[o]=Mu([t[o]],[r[o]],[n[o]]);return i},e.prototype.getMovement=function(t){var r=this.movement;if(!t)return r;var n=Oa(t,this.length),a=Oa(this.prevClients,this.length),i=n.clientX-a.clientX,o=n.clientY-a.clientY;return Math.sqrt(i*i+o*o)+r},e.prototype.getDistance=function(t){return t===void 0&&(t=this.prevClients),No(t)},e.prototype.getScale=function(t){return t===void 0&&(t=this.prevClients),No(t)/No(this.startClients)},e.prototype.move=function(t,r){this.startClients.forEach(function(n){n.clientX-=t,n.clientY-=r}),this.prevClients.forEach(function(n){n.clientX-=t,n.clientY-=r})},e}(),ku=["textarea","input"],Mm=function(e){xm(t,e);function t(r,n){n===void 0&&(n={});var a=e.call(this)||this;a.options={},a.flag=!1,a.pinchFlag=!1,a.data={},a.isDrag=!1,a.isPinch=!1,a.clientStores=[],a.targets=[],a.prevTime=0,a.doubleFlag=!1,a._useMouse=!1,a._useTouch=!1,a._useDrag=!1,a._dragFlag=!1,a._isTrusted=!1,a._isMouseEvent=!1,a._isSecondaryButton=!1,a._preventMouseEvent=!1,a._prevInputEvent=null,a._isDragAPI=!1,a._isIdle=!0,a._preventMouseEventId=0,a._window=window,a.onDragStart=function(d,h){if(h===void 0&&(h=!0),!(!a.flag&&d.cancelable===!1)){var v=d.type.indexOf("drag")>=-1;if(!(a.flag&&v)){a._isDragAPI=!0;var p=a.options,g=p.container,b=p.pinchOutside,y=p.preventWheelClick,S=p.preventRightClick,C=p.preventDefault,T=p.checkInput,D=p.dragFocusedInput,P=p.preventClickEventOnDragStart,G=p.preventClickEventOnDrag,W=p.preventClickEventByCondition,L=a._useTouch,X=!a.flag;if(a._isSecondaryButton=d.which===3||d.button===2,y&&(d.which===2||d.button===1)||S&&(d.which===3||d.button===2))return a.stop(),!1;if(X){var M=a._window.document.activeElement,oe=d.target;if(oe){var re=oe.tagName.toLowerCase(),be=ku.indexOf(re)>-1,ze=oe.isContentEditable;if(be||ze){if(T||!D&&M===oe)return!1;if(M&&(M===oe||ze&&M.isContentEditable&&M.contains(oe)))if(D)oe.blur();else return!1}else if((C||d.type==="touchstart")&&M){var Ue=M.tagName.toLowerCase();(M.isContentEditable||ku.indexOf(Ue)>-1)&&M.blur()}(P||G||W)&&mr(a._window,"click",a._onClick,!0)}a.clientStores=[new zo(yi(d))],a._isIdle=!1,a.flag=!0,a.isDrag=!1,a._isTrusted=h,a._dragFlag=!0,a._prevInputEvent=d,a.data={},a.doubleFlag=Va()-a.prevTime<200,a._isMouseEvent=Cm(d),!a._isMouseEvent&&a._preventMouseEvent&&a._allowMouseEvent();var Ge=a._preventMouseEvent||a.emit("dragStart",nr(nr({data:a.data,datas:a.data,inputEvent:d,isMouseEvent:a._isMouseEvent,isSecondaryButton:a._isSecondaryButton,isTrusted:h,isDouble:a.doubleFlag},a.getCurrentStore().getPosition()),{preventDefault:function(){d.preventDefault()},preventDrag:function(){a._dragFlag=!1}}));Ge===!1&&a.stop(),a._isMouseEvent&&a.flag&&C&&d.preventDefault()}if(!a.flag)return!1;var Ne=0;if(X?(a._attchDragEvent(),L&&b&&(Ne=setTimeout(function(){mr(g,"touchstart",a.onDragStart,{passive:!1})}))):L&&b&&pr(g,"touchstart",a.onDragStart),a.flag&&wm(d)){if(clearTimeout(Ne),X&&d.touches.length!==d.changedTouches.length)return;a.pinchFlag||a.onPinchStart(d)}}}},a.onDrag=function(d,h){if(a.flag){var v=a.options.preventDefault;!a._isMouseEvent&&v&&d.preventDefault(),a._prevInputEvent=d;var p=yi(d),g=a.moveClients(p,d,!1);if(a._dragFlag){if(a.pinchFlag||g.deltaX||g.deltaY){var b=a._preventMouseEvent||a.emit("drag",nr(nr({},g),{isScroll:!!h,inputEvent:d}));if(b===!1){a.stop();return}}a.pinchFlag&&a.onPinch(d,p)}a.getCurrentStore().getPosition(p,!0)}},a.onDragEnd=function(d){if(a.flag){var h=a.options,v=h.pinchOutside,p=h.container,g=h.preventClickEventOnDrag,b=h.preventClickEventOnDragStart,y=h.preventClickEventByCondition,S=a.isDrag;(g||b||y)&&requestAnimationFrame(function(){a._allowClickEvent()}),!y&&!b&&g&&!S&&a._allowClickEvent(),a._useTouch&&v&&pr(p,"touchstart",a.onDragStart),a.pinchFlag&&a.onPinchEnd(d);var C=d!=null&&d.touches?yi(d):[],T=C.length;T===0||!a.options.keepDragging?a.flag=!1:a._addStore(new zo(C));var D=a._getPosition(),P=Va(),G=!S&&a.doubleFlag;a._prevInputEvent=null,a.prevTime=S||G?0:P,a.flag||(a._dettachDragEvent(),a._preventMouseEvent||a.emit("dragEnd",nr({data:a.data,datas:a.data,isDouble:G,isDrag:S,isClick:!S,isMouseEvent:a._isMouseEvent,isSecondaryButton:a._isSecondaryButton,inputEvent:d,isTrusted:a._isTrusted},D)),a.clientStores=[],a._isMouseEvent||(a._preventMouseEvent=!0,clearTimeout(a._preventMouseEventId),a._preventMouseEventId=setTimeout(function(){a._preventMouseEvent=!1},200)),a._isIdle=!0)}},a.onBlur=function(){a.onDragEnd()},a._allowClickEvent=function(){pr(a._window,"click",a._onClick,!0)},a._onClick=function(d){a._allowClickEvent(),a._allowMouseEvent();var h=a.options.preventClickEventByCondition;h!=null&&h(d)||(d.stopPropagation(),d.preventDefault())},a._onContextMenu=function(d){var h=a.options;h.preventRightClick?a.onDragEnd(d):d.preventDefault()},a._passCallback=function(){};var i=[].concat(r),o=i[0];a._window=Ig(o)?o:Po(o),a.options=nr({checkInput:!1,container:o&&!("document"in o)?Po(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var s=a.options,l=s.container,u=s.events,c=s.checkWindowBlur;if(a._useDrag=u.indexOf("drag")>-1,a._useTouch=u.indexOf("touch")>-1,a._useMouse=u.indexOf("mouse")>-1,a.targets=i,a._useDrag&&i.forEach(function(d){mr(d,"dragstart",a.onDragStart)}),a._useMouse&&(i.forEach(function(d){mr(d,"mousedown",a.onDragStart),mr(d,"mousemove",a._passCallback)}),mr(l,"contextmenu",a._onContextMenu)),c&&mr(Po(),"blur",a.onBlur),a._useTouch){var f={passive:!1};i.forEach(function(d){mr(d,"touchstart",a.onDragStart,f),mr(d,"touchmove",a._passCallback,f)})}return a}return t.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},t.prototype.getMovement=function(r){return this.getCurrentStore().getMovement(r)+this.clientStores.slice(1).reduce(function(n,a){return n+a.movement},0)},t.prototype.isDragging=function(){return this.isDrag},t.prototype.isIdle=function(){return this._isIdle},t.prototype.isFlag=function(){return this.flag},t.prototype.isPinchFlag=function(){return this.pinchFlag},t.prototype.isDoubleFlag=function(){return this.doubleFlag},t.prototype.isPinching=function(){return this.isPinch},t.prototype.scrollBy=function(r,n,a,i){i===void 0&&(i=!0),this.flag&&(this.clientStores[0].move(r,n),i&&this.onDrag(a,!0))},t.prototype.move=function(r,n){var a=r[0],i=r[1],o=this.getCurrentStore(),s=o.prevClients;return this.moveClients(s.map(function(l){var u=l.clientX,c=l.clientY;return{clientX:u+a,clientY:c+i,originalClientX:u,originalClientY:c}}),n,!0)},t.prototype.triggerDragStart=function(r){this.onDragStart(r,!1)},t.prototype.setEventData=function(r){var n=this.data;for(var a in r)n[a]=r[a];return this},t.prototype.setEventDatas=function(r){return this.setEventData(r)},t.prototype.getCurrentEvent=function(r){return r===void 0&&(r=this._prevInputEvent),nr(nr({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:r})},t.prototype.getEventData=function(){return this.data},t.prototype.getEventDatas=function(){return this.data},t.prototype.unset=function(){var r=this,n=this.targets,a=this.options.container;this.off(),pr(this._window,"blur",this.onBlur),this._useDrag&&n.forEach(function(i){pr(i,"dragstart",r.onDragStart)}),this._useMouse&&(n.forEach(function(i){pr(i,"mousedown",r.onDragStart)}),pr(a,"contextmenu",this._onContextMenu)),this._useTouch&&(n.forEach(function(i){pr(i,"touchstart",r.onDragStart)}),pr(a,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},t.prototype.onPinchStart=function(r){var n=this,a=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>a)){var i=new zo(yi(r));this.pinchFlag=!0,this._addStore(i);var o=this.emit("pinchStart",nr(nr({data:this.data,datas:this.data,angle:i.getAngle(),touches:this.getCurrentStore().getPositions()},i.getPosition()),{inputEvent:r,isTrusted:this._isTrusted,preventDefault:function(){r.preventDefault()},preventDrag:function(){n._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},t.prototype.onPinch=function(r,n){if(!(!this.flag||!this.pinchFlag||n.length<2)){var a=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",nr(nr({data:this.data,datas:this.data,movement:this.getMovement(n),angle:a.getAngle(n),rotation:a.getRotation(n),touches:a.getPositions(n),scale:a.getScale(n),distance:a.getDistance(n)},a.getPosition(n)),{inputEvent:r,isTrusted:this._isTrusted}))}},t.prototype.onPinchEnd=function(r){if(this.pinchFlag){var n=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var a=this.getCurrentStore();this.emit("pinchEnd",nr(nr({data:this.data,datas:this.data,isPinch:n,touches:a.getPositions()},a.getPosition()),{inputEvent:r}))}},t.prototype.getCurrentStore=function(){return this.clientStores[0]},t.prototype.moveClients=function(r,n,a){var i=this._getPosition(r,a),o=this.isDrag;(i.deltaX||i.deltaY)&&(this.isDrag=!0);var s=!1;return!o&&this.isDrag&&(s=!0),nr(nr({data:this.data,datas:this.data},i),{movement:this.getMovement(r),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:n,isTrusted:this._isTrusted,isFirstDrag:s})},t.prototype._addStore=function(r){this.clientStores.splice(0,0,r)},t.prototype._getPosition=function(r,n){var a=this.getCurrentStore(),i=a.getPosition(r,n),o=this.clientStores.slice(1).reduce(function(u,c){var f=c.getPosition();return u.distX+=f.distX,u.distY+=f.distY,u},i),s=o.distX,l=o.distY;return nr(nr({},i),{distX:s,distY:l})},t.prototype._attchDragEvent=function(){var r=this._window,n=this.options.container,a={passive:!1};this._isDragAPI&&(mr(n,"dragover",this.onDrag,a),mr(r,"dragend",this.onDragEnd)),this._useMouse&&(mr(n,"mousemove",this.onDrag),mr(r,"mouseup",this.onDragEnd)),this._useTouch&&(mr(n,"touchmove",this.onDrag,a),mr(r,"touchend",this.onDragEnd,a),mr(r,"touchcancel",this.onDragEnd,a))},t.prototype._dettachDragEvent=function(){var r=this._window,n=this.options.container;this._isDragAPI&&(pr(n,"dragover",this.onDrag),pr(r,"dragend",this.onDragEnd)),this._useMouse&&(pr(n,"mousemove",this.onDrag),pr(r,"mouseup",this.onDragEnd)),this._useTouch&&(pr(n,"touchstart",this.onDragStart),pr(n,"touchmove",this.onDrag),pr(r,"touchend",this.onDragEnd),pr(r,"touchcancel",this.onDragEnd))},t.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},t}(so);function km(e){for(var t=5381,r=e.length;r;)t=t*33^e.charCodeAt(--r);return t>>>0}var Tm=km;function Rm(e){return Tm(e).toString(36)}function Dm(e){if(e&&e.getRootNode){var t=e.getRootNode();if(t.nodeType===11)return t}}function Am(e,t,r){return r.original?t:t.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(n,a){var i=a.trim();return(i?Hn(i):[""]).map(function(o){var s=o.trim();return s.indexOf("@")===0?s:s.indexOf(":global")>-1?s.replace(/\:global/g,""):s.indexOf(":host")>-1?"".concat(s.replace(/\:host/g,".".concat(e))):s?".".concat(e," ").concat(s):".".concat(e)}).join(", ")+" {"})}function Im(e,t,r,n,a){var i=Ag(n),o=i.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",e),o.setAttribute("data-styled-count","1"),r.nonce&&o.setAttribute("nonce",r.nonce),o.innerHTML=Am(e,t,r),(a||i.head||i.body).appendChild(o),o}function Bm(e){var t="rCS"+Rm(e);return{className:t,inject:function(r,n){n===void 0&&(n={});var a=Dm(r),i=(a||r.ownerDocument||document).querySelector('style[data-styled-id="'.concat(t,'"]'));if(!i)i=Im(t,e,n,r,a);else{var o=parseFloat(i.getAttribute("data-styled-count"))||0;i.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var s,l=parseFloat(i.getAttribute("data-styled-count"))||0;l<=1?(i.remove?i.remove():(s=i.parentNode)===null||s===void 0||s.removeChild(i),i=null):i.setAttribute("data-styled-count","".concat(l-1))}}}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var gs=function(e,t){return gs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},gs(e,t)};function yc(e,t){gs(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ms=function(){return ms=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},ms.apply(this,arguments)};function Om(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}var Pm=function(e){yc(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.injectResult=null,n.tag="div",n}var r=t.prototype;return r.render=function(){var n=this.props,a=n.className,i=a===void 0?"":a;n.cspNonce;var o=n.portalContainer,s=Om(n,["className","cspNonce","portalContainer"]),l=this.injector.className,u=this.tag,c={};return Yg.indexOf("simple")>-1&&o&&(c={portalContainer:o}),zr(u,ms({ref:tn(this,"element"),"data-styled-id":l,className:i+" "+l},c,s))},r.componentDidMount=function(){this.injectResult=this.injector.inject(this.element,{nonce:this.props.cspNonce})},r.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},r.getElement=function(){return this.element},t}(js);function xc(e,t){var r=Bm(t);return function(n){yc(a,n);function a(){var i=n!==null&&n.apply(this,arguments)||this;return i.injector=r,i.tag=e,i}return a}(Pm)}var _s=function(e,t){return _s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},_s(e,t)};function ii(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");_s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var fe=function(){return fe=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},fe.apply(this,arguments)};function Lm(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Fm(e,t,r,n){var a=arguments.length,i=a<3?t:n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function xt(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function oi(e,t){var r;return fe({events:{},props:(r={},r[e]=Boolean,r),name:e},t)}function $m(e,t){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*e,'px" height="').concat(32*e,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(t,'deg);transform-origin: 16px 16px"></path></svg>')}function Nm(e){var t=$m(1,e),r=Math.round(e/45)*45%180,n="ns-resize";return r===135?n="nwse-resize":r===45?n="nesw-resize":r===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(t,"') 16 16, ").concat(n,";")}var zi=Zg(),Sc=zi.browser.webkit,wc=Sc&&function(){var e=typeof window>"u"?{userAgent:""}:window.navigator,t=/applewebkit\/([^\s]+)/g.exec(e.userAgent.toLowerCase());return t?parseFloat(t[1])<605:!1}(),zm=zi.browser.name==="firefox",Vm=parseInt(zi.browser.webkitVersion,10)>=612||parseInt(zi.browser.version,10)>=15,rl="moveable-",Hm=`
{
	position: absolute;
	width: 1px;
	height: 1px;
	left: 0;
	top: 0;
    z-index: 3000;
    --moveable-color: #4af;
    --zoom: 1;
    --zoompx: 1px;
    will-change: transform;
    outline: 1px solid transparent;
}
.control-box {
    z-index: 0;
}
.line, .control {
    position: absolute;
	left: 0;
    top: 0;
    will-change: transform;
}
.control {
	width: 14px;
	height: 14px;
	border-radius: 50%;
	border: 2px solid #fff;
	box-sizing: border-box;
    background: #4af;
    background: var(--moveable-color);
	margin-top: -7px;
    margin-left: -7px;
    border: 2px solid #fff;
    z-index: 10;
}
.padding {
    position: absolute;
    top: 0px;
    left: 0px;
    width: 100px;
    height: 100px;
    transform-origin: 0 0;
}
.line {
	width: 1px;
    height: 1px;
    background: #4af;
    background: var(--moveable-color);
	transform-origin: 0px 50%;
}
.line.edge {
    z-index: 1;
    background: transparent;
}
.line.dashed {
    box-sizing: border-box;
    background: transparent;
}
.line.dashed.horizontal {
    border-top: 1px dashed #4af;
    border-top-color: #4af;
    border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
    border-left: 1px dashed #4af;
    border-left-color: #4af;
    border-left-color: var(--moveable-color);
}
.line.vertical {
    transform: translateX(-50%);
}
.line.horizontal {
    transform: translateY(-50%);
}
.line.vertical.bold {
    width: 2px;
}
.line.horizontal.bold {
    height: 2px;
}

.control.origin {
	border-color: #f55;
	background: #fff;
	width: 12px;
	height: 12px;
	margin-top: -6px;
    margin-left: -6px;
	pointer-events: none;
}
`.concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(e){return`
.direction[data-rotation="`.concat(e,'"], :global .view-control-rotation').concat(e,` {
	`).concat(Nm(e),`
}
`)}).join(`
`),`

.line.direction:before {
    content: "";
    position: absolute;
    width: 100%;
    height: calc(var(--moveable-line-padding, 0) * 1px);
    bottom: 0;
    left: 0;
}
.group {
    z-index: -1;
}
.area {
    position: absolute;
}
.area-pieces {
    position: absolute;
    top: 0;
    left: 0;
    display: none;
}
.area.avoid, .area.pass {
    pointer-events: none;
}
.area.avoid+.area-pieces {
    display: block;
}
.area-piece {
    position: absolute;
}

`).concat(wc?`:global svg *:before {
	content:"";
	transform-origin: inherit;
}`:"",`
`),Gm=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],bs=1e-4,Cr=1e-7,xi=1e-9,ys=Math.pow(10,10),Tu=-ys,Wm=["n","w","s","e"],nl=["n","w","s","e","nw","ne","sw","se"],Xm={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},al={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},Cc={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},Ec=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag"];function si(e,t,r,n,a,i){var o,s;i===void 0&&(i="draggable");var l=(s=(o=t.gestos[i])===null||o===void 0?void 0:o.move(r,e.inputEvent))!==null&&s!==void 0?s:{},u=l.originalDatas||l.datas,c=u[i]||(u[i]={});return fe(fe({},l),{isPinch:!!n,parentEvent:!0,datas:c,originalDatas:e.originalDatas})}var ua=function(){function e(r){var n;r===void 0&&(r="draggable"),this.ableName=r,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(n={},n[r]={},n)}var t=e.prototype;return t.dragStart=function(r,n){this.isDrag=!1,this.isFlag=!1;var a=n.originalDatas;return this.datas=a,a[this.ableName]||(a[this.ableName]={}),fe(fe({},this.move(r,n.inputEvent)),{type:"dragstart"})},t.drag=function(r,n){return this.move([r[0]-this.prevX,r[1]-this.prevY],n)},t.move=function(r,n){var a,i,o=!1;if(!this.isFlag)this.prevX=r[0],this.prevY=r[1],this.startX=r[0],this.startY=r[1],a=r[0],i=r[1],this.isFlag=!0;else{var s=this.isDrag;a=this.prevX+r[0],i=this.prevY+r[1],(r[0]||r[1])&&(this.isDrag=!0),!s&&this.isDrag&&(o=!0)}return this.prevX=a,this.prevY=i,{type:"drag",clientX:a,clientY:i,inputEvent:n,isFirstDrag:o,isDrag:this.isDrag,distX:a-this.startX,distY:i-this.startY,deltaX:r[0],deltaY:r[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},e}();function Mc(e,t){var r=t.clientX,n=t.clientY,a=t.datas,i=e.state,o=i.moveableClientRect,s=i.rootMatrix,l=i.is3d,u=i.pos1,c=o.left,f=o.top,d=l?4:3,h=gt(Gn(s,[r-c,n-f],d),u),v=h[0],p=h[1],g=un({datas:a,distX:v,distY:p}),b=g[0],y=g[1];return[b,y]}function Qn(e,t){var r=t.datas,n=e.state,a=n.allMatrix,i=n.beforeMatrix,o=n.is3d,s=n.left,l=n.top,u=n.origin,c=n.offsetMatrix,f=n.targetMatrix,d=n.transformOrigin,h=o?4:3;r.is3d=o,r.matrix=a,r.targetMatrix=f,r.beforeMatrix=i,r.offsetMatrix=c,r.transformOrigin=d,r.inverseMatrix=nn(a,h),r.inverseBeforeMatrix=nn(i,h),r.absoluteOrigin=Xn(At([s,l],u),h),r.startDragBeforeDist=gr(r.inverseBeforeMatrix,r.absoluteOrigin,h),r.startDragDist=gr(r.inverseMatrix,r.absoluteOrigin,h)}function Ym(e){return oa(e.datas.beforeTransform,[50,50],100,100).direction}function lo(e,t){var r=e.datas,n=e.originalDatas.beforeRenderable,a=r.transformIndex,i=n.nextTransforms,o=i.length,s=n.nextTransformAppendedIndexes,l=0;a===-1?(t==="translate"?l=0:t==="rotate"&&(l=dn(i,function(d){return d.match(/scale\(/g)})),l===-1&&(l=i.length),r.transformIndex=l):vn(s,function(d){return d.index===a&&d.functionName===t})?l=a:l=a+s.filter(function(d){return d.index<a}).length;var u=b2(i,l),c=u.targetFunction,f=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=u.beforeFunctionTexts,r.afterFunctionTexts=u.afterFunctionTexts,r.beforeTransform=u.beforeFunctionMatrix,r.beforeTransform2=u.beforeFunctionMatrix2,r.targetTansform=u.targetFunctionMatrix,r.afterTransform=u.afterFunctionMatrix,r.afterTransform2=u.afterFunctionMatrix2,r.targetAllTransform=u.allFunctionMatrix,c.functionName===f?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):o>l&&(r.isAppendTransform=!0,n.nextTransformAppendedIndexes=xt(xt([],s,!0),[{functionName:t,index:l,isAppend:!0}],!1))}function uo(e,t,r){return"".concat(e.beforeFunctionTexts.join(" ")," ").concat(e.isAppendTransform?r:t," ").concat(e.afterFunctionTexts.join(" "))}function Um(e){var t=e.datas,r=e.distX,n=e.distY,a=Tc({datas:t,distX:r,distY:n}),i=a[0],o=a[1],s=kc(t,rm([i,o],4));return gr(s,Xn([0,0,0],4),4)}function kc(e,t,r){var n=e.beforeTransform,a=e.afterTransform,i=e.beforeTransform2,o=e.afterTransform2,s=e.targetAllTransform,l=r?Wt(s,t,4):Wt(t,s,4),u=Wt(nn(r?i:n,4),l,4),c=Wt(u,nn(r?o:a,4),4);return c}function Tc(e){var t=e.datas,r=e.distX,n=e.distY,a=t.inverseBeforeMatrix,i=t.is3d,o=t.startDragBeforeDist,s=t.absoluteOrigin,l=i?4:3;return gt(gr(a,At(s,[r,n]),l),o)}function un(e,t){var r=e.datas,n=e.distX,a=e.distY,i=r.inverseBeforeMatrix,o=r.inverseMatrix,s=r.is3d,l=r.startDragBeforeDist,u=r.startDragDist,c=r.absoluteOrigin,f=s?4:3;return gt(gr(t?i:o,At(c,[n,a]),f),t?l:u)}function jm(e,t){var r=e.datas,n=e.distX,a=e.distY;r.beforeMatrix;var i=r.matrix,o=r.is3d;r.startDragBeforeDist;var s=r.startDragDist,l=r.absoluteOrigin,u=o?4:3;return gt(gr(i,At(s,[n,a]),u),l)}function qm(e,t,r,n,a,i){return n===void 0&&(n=t),a===void 0&&(a=r),i===void 0&&(i=[0,0]),e?e.map(function(o,s){var l=ti(o),u=l.value,c=l.unit,f=s?a:n,d=s?r:t;if(o==="%"||isNaN(u)){var h=f?i[s]/f:0;return d*h}else if(c!=="%")return u;return d*u/100}):i}function Rc(e){var t=[];return e[1]>=0&&(e[0]>=0&&t.push(3),e[0]<=0&&t.push(2)),e[1]<=0&&(e[0]>=0&&t.push(1),e[0]<=0&&t.push(0)),t}function Km(e,t){return Rc(t).map(function(r){return e[r]})}function tr(e,t){var r=(t[0]+1)/2,n=(t[1]+1)/2,a=[Pn(e[0][0],e[1][0],r,1-r),Pn(e[0][1],e[1][1],r,1-r)],i=[Pn(e[2][0],e[3][0],r,1-r),Pn(e[2][1],e[3][1],r,1-r)];return[Pn(a[0],i[0],n,1-n),Pn(a[1],i[1],n,1-n)]}function Zm(e,t,r,n,a,i){var o=Mn(t,r,n,a),s=tr(o,i),l=e[0]-s[0],u=e[1]-s[1];return[l,u]}function li(e,t,r,n){return Wt(e,Vi(t,n,r),n)}function Qm(e,t,r){var n=e.transformOrigin,a=e.offsetMatrix,i=e.is3d,o=t.beforeTransform,s=t.afterTransform,l=i?4:3,u=el([r]);return li(a,an(Wt(Wt(o,u,4),s,4),4,l),n,l)}function Jm(e,t){var r=e.transformOrigin,n=e.offsetMatrix,a=e.is3d,i=e.targetMatrix,o=a?4:3;return li(n,Wt(i,Qs(t,o),o),r,o)}function co(e){var t=_a(e);return{setTransform:function(r,n){n===void 0&&(n=-1),t.startTransforms=or(r)?r:Cn(r),xs(e,n)},setTransformIndex:function(r){xs(e,r)}}}function fo(e,t){var r=_a(e),n=r.startTransforms;xs(e,dn(n,function(a){return a.indexOf("".concat(t,"("))===0}))}function xs(e,t){var r=_a(e),n=e.datas;if(n.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var i=Ln([a]);n.startValue=i[0].functionValue}}}function il(e,t){var r=_a(e);r.nextTransforms=Cn(t)}function _a(e){return e.originalDatas.beforeRenderable}function Dc(e){var t=e.originalDatas.beforeRenderable;return t.nextTransforms}function Si(e){return Dc(e).join(" ")}function wi(e){return _a(e).nextStyle}function Ac(e,t,r,n,a){il(a,t);var i=Sr.drag(e,si(a,e.state,r,n)),o=i?i.transform:t;return fe(fe({transform:t,drag:i},wr({transform:o},a)),{afterTransform:o})}function Ic(e,t,r,n,a){var i=e.state,o=i.left,s=i.top,l=e.props.groupable,u=Qm(e.state,a,t),c=l?o:0,f=l?s:0,d=Oc(e,r,u),h=gt(n,d);return gt(h,[c,f])}function e2(e,t,r,n,a){var i=Ic(e,"scale(".concat(t.join(", "),")"),r,n,a);return i}function Bc(e,t,r){return[-1+e[0]/(t/2),-1+e[1]/(r/2)]}function Oc(e,t,r){r===void 0&&(r=e.state.allMatrix);var n=e.state,a=n.width,i=n.height,o=n.is3d,s=o?4:3,l=[a/2*(1+t[0]),i/2*(1+t[1])];return ur(r,l,s)}function t2(e,t,r){var n=r.fixedDirection,a=r.fixedPosition;return Ic(e,"rotate(".concat(t,"deg)"),n,a,r)}function r2(e,t,r,n,a,i){var o=e.props.groupable,s=e.state,l=s.transformOrigin,u=s.offsetMatrix,c=s.is3d,f=s.width,d=s.height,h=s.left,v=s.top,p=i.fixedDirection,g=i.nextTargetMatrix||s.targetMatrix,b=c?4:3,y=qm(a,t,r,f,d,l),S=o?h:0,C=o?v:0,T=li(u,g,y,b),D=Zm(n,T,t,r,b,p);return gt(D,[S,C])}function Pc(e,t){return tr(Dr(e.state),t)}function n2(e,t){var r=e.targetGesto,n=e.controlGesto,a;return r!=null&&r.isFlag()&&(a=r.getEventData()[t]),!a&&(n!=null&&n.isFlag())&&(a=n.getEventData()[t]),a||{}}function a2(e,t){return[e[0]*t[0],e[1]*t[1]]}function bt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return sg.apply(void 0,xt([rl],e,!1))}function Lc(e){e()}function i2(e){return!e||e==="none"?[1,0,0,1,0,0]:Kr(e)?e:el(e)}function Vi(e,t,r){return us(t,Ga(r,t),e,Ga(r.map(function(n){return-n}),t))}function o2(e,t,r){if(t==="%"){var n=ol(e.ownerSVGElement);return n[r?"width":"height"]/100}return 1}function s2(e){var t=Hi(pn(e,":before"));return t.map(function(r,n){var a=ti(r),i=a.value,o=a.unit;return i*o2(e,o,n===0)})}function Hi(e){var t=e.transformOrigin;return t?t.split(" "):["0","0"]}function Fc(e,t){t===void 0&&(t=pn(e));var r=t.transform;if(r&&r!=="none")return t.transform;if("transform"in e){var n=e.transform,a=n.baseVal;if(!a)return"";var i=a.length;if(!i)return"";for(var o=[],s=function(u){var c=a[u].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(f){return c[f]}).join(", "),")"))},l=0;l<i;++l)s(l);return o.join(" ")}return""}function Wa(e,t,r,n,a){var i,o,s,l=e&&e.ownerDocument?e.ownerDocument:document,u=l.documentElement||l.body,c=!1,f,d;if(!e||r)f=e;else{var h=(i=e==null?void 0:e.assignedSlot)===null||i===void 0?void 0:i.parentElement,v=e.parentElement;h?(c=!0,d=v,f=h):f=v}for(var p=!1,g=e===t||f===t,b="relative",y=1,S=parseFloat((o=a)===null||o===void 0?void 0:o.zoom)||1,C=a==null?void 0:a.position;f&&f!==u;){t===f&&(g=!0);var T=pn(f),D=f.tagName.toLowerCase(),P=Fc(f,T),G=T.willChange,W=parseFloat(T.zoom)||1;if(b=T.position,n&&W!==1){y=W;break}if(!r&&n&&S!==1&&C&&C!=="absolute"||D==="svg"||b!=="static"||P&&P!=="none"||G==="transform")break;var L=(s=e==null?void 0:e.assignedSlot)===null||s===void 0?void 0:s.parentNode,X=f.parentNode;L&&(c=!0,d=X);var M=L||X;if(M&&M.nodeType===11){f=M.host,p=!0;break}f=M,b="relative"}return{offsetZoom:y,hasSlot:c,parentSlotElement:d,isCustomElement:p,isStatic:b==="static",isEnd:g||!f||f===u,offsetParent:f||u}}function l2(e,t,r){var n,a=e.tagName.toLowerCase(),i=e.offsetLeft,o=e.offsetTop,s=ei(i),l=!s,u,c;return!l&&a!=="svg"?(u=wc?s2(e):Hi(r).map(function(f){return parseFloat(f)}),c=u.slice(),l=!0,n=f2(e,u,e===t&&t.tagName.toLowerCase()==="g"),i=n[0],o=n[1],u[0]=n[2],u[1]=n[3]):(u=Hi(r).map(function(f){return parseFloat(f)}),c=u.slice()),{tagName:a,isSVG:s,hasOffset:l,offset:[i||0,o||0],origin:u,targetOrigin:c}}function $c(e,t,r){r===void 0&&(r=pn(e));var n=pn(document.body),a=n.position;if(!t&&(!a||a==="static"))return[0,0];var i=parseInt(n.marginLeft,10),o=parseInt(n.marginTop,10);return r.position==="absolute"&&((r.top!=="auto"||r.bottom!=="auto")&&(o=0),(r.left!=="auto"||r.right!=="auto")&&(i=0)),[i,o]}function Ss(e){e.forEach(function(t){var r=t.matrix;r&&(t.matrix=an(r,3,4))})}function u2(e){for(var t=e.parentElement,r=!1;t;){var n=pn(t).transform;if(n&&n!=="none"){r=!0;break}if(t===document.body)break;t=t.parentElement}return{fixedContainer:t||document.body,hasTransform:r}}function vo(e,t){return t===void 0&&(t=e.length>9),"".concat(t?"matrix3d":"matrix","(").concat(pc(e,!t).join(","),")")}function ol(e){var t=e.clientWidth,r=e.clientHeight;if(!e)return{x:0,y:0,width:0,height:0,clientWidth:t,clientHeight:r};var n=e.viewBox,a=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:a.x,y:a.y,width:a.width||t,height:a.height||r,clientWidth:t,clientHeight:r}}function c2(e,t){var r=ol(e),n=r.width,a=r.height,i=r.clientWidth,o=r.clientHeight,s=i/n,l=o/a,u=e.preserveAspectRatio.baseVal,c=u.align,f=u.meetOrSlice,d=[0,0],h=[s,l],v=[0,0];if(c!==1){var p=(c-2)%3,g=Math.floor((c-2)/3);d[0]=n*p/2,d[1]=a*g/2;var b=f===2?Math.max(l,s):Math.min(s,l);h[0]=b,h[1]=b,v[0]=(i-n)/2*p,v[1]=(o-a)/2*g}var y=Qs(h,t);return y[t*(t-1)]=v[0],y[t*(t-1)+1]=v[1],Vi(y,t,d)}function f2(e,t,r){if(!e.getBBox||!r&&e.tagName.toLowerCase()==="g")return[0,0,0,0];var n=e.getBBox(),a=ol(e.ownerSVGElement),i=n.x-a.x,o=n.y-a.y;return[i,o,t[0]-i,t[1]-o]}function ur(e,t,r){return gr(e,Xn(t,r),r)}function Mn(e,t,r,n){return[[0,0],[t,0],[0,r],[t,r]].map(function(a){return ur(e,a,n)})}function Vr(e){var t=e.map(function(u){return u[0]}),r=e.map(function(u){return u[1]}),n=Math.min.apply(Math,t),a=Math.min.apply(Math,r),i=Math.max.apply(Math,t),o=Math.max.apply(Math,r),s=i-n,l=o-a;return{left:n,top:a,right:i,bottom:o,width:s,height:l}}function Ru(e,t,r,n){var a=Mn(e,t,r,n);return Vr(a)}function d2(e,t,r,n,a){var i,o=e.target,s=e.origin,l=t.matrix,u=zc(o),c=u.offsetWidth,f=u.offsetHeight,d=r.getBoundingClientRect(),h=[0,0];r===document.body&&(h=$c(o,!0));for(var v=o.getBoundingClientRect(),p=v.left-d.left+r.scrollLeft-(r.clientLeft||0)+h[0],g=v.top-d.top+r.scrollTop-(r.clientTop||0)+h[1],b=v.width,y=v.height,S=us(n,a,l),C=Ru(S,c,f,n),T=C.left,D=C.top,P=C.width,G=C.height,W=ur(S,s,n),L=gt(W,[T,D]),X=[p+L[0]*b/P,g+L[1]*y/G],M=[0,0],oe=0;++oe<10;){var re=nn(a,n);i=gt(ur(re,X,n),ur(re,W,n)),M[0]=i[0],M[1]=i[1];var be=us(n,a,Ga(M,n),l),ze=Ru(be,c,f,n),Ue=ze.left,Ge=ze.top,Ne=Ue-p,Me=Ge-g;if(Math.abs(Ne)<2&&Math.abs(Me)<2)break;X[0]-=Ne,X[1]-=Me}return M.map(function(Pe){return Math.round(Pe)})}function v2(e,t,r){var n=e.length===16,a=n?4:3,i=t.map(function(l){return ur(e,l,a)}),o=r.left,s=r.top;return i.map(function(l){return[l[0]+o,l[1]+s]})}function oa(e,t,r,n){var a=e.length===16,i=a?4:3,o=Mn(e,r,n,i),s=o[0],l=s[0],u=s[1],c=o[1],f=c[0],d=c[1],h=o[2],v=h[0],p=h[1],g=o[3],b=g[0],y=g[1],S=ur(e,t,i),C=S[0],T=S[1],D=Math.min(l,f,v,b),P=Math.min(u,d,p,y),G=Math.max(l,f,v,b),W=Math.max(u,d,p,y);l=l-D||0,f=f-D||0,v=v-D||0,b=b-D||0,u=u-P||0,d=d-P||0,p=p-P||0,y=y-P||0,C=C-D||0,T=T-P||0;var L=as(Mn(e,100,100,i));return{left:D,top:P,right:G,bottom:W,origin:[C,T],pos1:[l,u],pos2:[f,d],pos3:[v,p],pos4:[b,y],direction:L}}function jr(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Nc(e,t){return jr([t[0]-e[0],t[1]-e[1]])}function ka(e,t,r,n){r===void 0&&(r=1),n===void 0&&(n=rr(e,t));var a=Nc(e,t);return{transform:"translateY(-50%) translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(n,"rad) scaleY(").concat(r,")"),width:"".concat(a,"px")}}function sl(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=r.length,i=r.reduce(function(s,l){return s+l[0]},0)/a,o=r.reduce(function(s,l){return s+l[1]},0)/a;return{transform:"translateZ(0px) translate(".concat(i,"px, ").concat(o,"px) rotate(").concat(e,"rad) scale(").concat(t,")")}}function Yn(e,t){var r=e[t];return Kr(r)?fe(fe({},e),r):e}function zc(e,t){t===void 0&&(t=e?pn(e):null);var r=e&&!ei(e.offsetWidth),n=0,a=0,i=0,o=0,s=0,l=0,u=0,c=0,f=0,d=0,h=0,v=0,p=1/0,g=1/0,b=1/0,y=1/0,S=0,C=0,T=!1;if(e)if(!r&&e.tagName.toLowerCase()!=="svg"){var D=e.getBBox();T=!0,n=D.width,a=D.height,s=n,l=a,u=n,c=a,i=n,o=a}else{var P=e.style,G=t.boxSizing==="border-box",W=parseFloat(t.borderLeftWidth)||0,L=parseFloat(t.borderRightWidth)||0,X=parseFloat(t.borderTopWidth)||0,M=parseFloat(t.borderBottomWidth)||0,oe=parseFloat(t.paddingLeft)||0,re=parseFloat(t.paddingRight)||0,be=parseFloat(t.paddingTop)||0,ze=parseFloat(t.paddingBottom)||0,Ue=oe+re,Ge=be+ze,Ne=W+L,Me=X+M,Pe=Ue+Ne,Se=Ge+Me,ve=t.position,j=0,we=0;if("clientLeft"in e){var A=null;if(ve==="absolute"){var F=Wa(e,document.body);A=F.offsetParent}else A=e.parentElement;if(A){var _=pn(A);j=parseFloat(_.width),we=parseFloat(_.height)}}f=Math.max(Ue,Yt(t.minWidth,j)||0),d=Math.max(Ge,Yt(t.minHeight,we)||0),p=Yt(t.maxWidth,j),g=Yt(t.maxHeight,we),isNaN(p)&&(p=1/0),isNaN(g)&&(g=1/0),S=Yt(P.width,0)||0,C=Yt(P.height,0)||0,s=parseFloat(t.width)||0,l=parseFloat(t.height)||0,u=Math.abs(s-S)<1?rs(f,S||s,p):s,c=Math.abs(l-C)<1?rs(d,C||l,g):l,n=u,a=c,i=u,o=c,G?(b=p,y=g,h=f,v=d,u=n-Pe,c=a-Se):(b=p+Pe,y=g+Se,h=f+Pe,v=d+Se,n=u+Pe,a=c+Se),i=u+Ue,o=c+Ge}return{svg:T,offsetWidth:n,offsetHeight:a,clientWidth:i,clientHeight:o,contentWidth:u,contentHeight:c,inlineCSSWidth:S,inlineCSSHeight:C,cssWidth:s,cssHeight:l,minWidth:f,minHeight:d,maxWidth:p,maxHeight:g,minOffsetWidth:h,minOffsetHeight:v,maxOffsetWidth:b,maxOffsetHeight:y}}function Vc(e,t){return rr(t>0?e[0]:e[1],t>0?e[1]:e[0])}function Ci(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function Hc(e,t){var r=e===document.body||e===document.documentElement,n={clientLeft:e.clientLeft,clientTop:e.clientTop,clientWidth:e.clientWidth,clientHeight:e.clientHeight,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,overflow:!1};return r&&(n.clientHeight=Math.max(t.height,n.clientHeight),n.scrollHeight=Math.max(t.height,n.scrollHeight)),n.overflow=pn(e).overflow!=="visible",fe(fe({},t),n)}function Vo(e,t,r,n){var a=e.left,i=e.right,o=e.top,s=e.bottom,l=t.top,u=t.left,c={left:u+a,top:l+o,right:u+i,bottom:l+s,width:i-a,height:s-o};return r&&n?Hc(r,c):c}function Ta(e,t){var r=0,n=0,a=0,i=0;if(e){var o=e.getBoundingClientRect();r=o.left,n=o.top,a=o.width,i=o.height}var s={left:r,top:n,width:a,height:i,right:r+a,bottom:n+i};return e&&t?Hc(e,s):s}function Gc(e,t,r,n){var a;if(e)a=e;else if(t)a=[0,0];else{var i=r.target;a=Wc(i,n)}return a}function Wc(e,t){if(e){var r=e.getAttribute("data-rotation")||"",n=e.getAttribute("data-direction");if(t.deg=r,!!n){var a=[0,0];return n.indexOf("w")>-1&&(a[0]=-1),n.indexOf("e")>-1&&(a[0]=1),n.indexOf("n")>-1&&(a[1]=-1),n.indexOf("s")>-1&&(a[1]=1),a}}}function ll(e,t){return[At(t,e[0]),At(t,e[1]),At(t,e[2]),At(t,e[3])]}function Dr(e){var t=e.left,r=e.top,n=e.pos1,a=e.pos2,i=e.pos3,o=e.pos4;return ll([n,a,i,o],[t,r])}function p2(e){return Math.round(e%1===-.5?e-1:e)}function aa(e,t){var r;(r=e[t])===null||r===void 0||r.unset(),e[t]=null}function wr(e,t){if(t){var r=_a(t);r.nextStyle=fe(fe({},r.nextStyle),e)}return{style:e,cssText:ma(e).map(function(n){return"".concat(Oi(n,"-"),": ").concat(e[n],";")}).join("")}}function Xc(e,t,r){var n=t.afterTransform||t.transform;return fe(fe({},wr(fe(fe(fe({},e.style),t.style),{transform:n}),r)),{afterTransform:n,transform:e.transform})}function Mt(e,t,r,n){var a=t.datas;a.datas||(a.datas={});var i=fe(fe({},r),{target:e.state.target,clientX:t.clientX,clientY:t.clientY,inputEvent:t.inputEvent,currentTarget:e,moveable:e,datas:a.datas,isFirstDrag:!!t.isFirstDrag,isTrusted:t.isTrusted!==!1,stopAble:function(){a.isEventStart=!1},stopDrag:function(){var o;(o=t.stop)===null||o===void 0||o.call(t)}});return a.isStartEvent?n||(a.lastEvent=i):a.isStartEvent=!0,i}function Fr(e,t,r){var n=t.datas,a="isDrag"in r?r.isDrag:t.isDrag;return n.datas||(n.datas={}),fe(fe({isDrag:a},r),{moveable:e,target:e.state.target,clientX:t.clientX,clientY:t.clientY,inputEvent:t.inputEvent,currentTarget:e,lastEvent:n.lastEvent,isDouble:t.isDouble,datas:n.datas,isFirstDrag:!!t.isFirstDrag})}function po(e,t,r){e._emitter.on(t,r)}function ft(e,t,r,n){return e.triggerEvent(t,r,n)}function pn(e,t){return window.getComputedStyle(e,t)}function Ei(e,t,r){var n={},a={};return e.filter(function(i){var o=i.name;if(n[o]||!t.some(function(s){return i[s]}))return!1;if(!r&&i.ableGroup){if(a[i.ableGroup])return!1;a[i.ableGroup]=!0}return n[o]=!0,!0})}function ws(e,t){return e===t||e==null&&t==null}function h2(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.length-1,n=0;n<r;++n){var a=e[n];if(!ei(a))return a}return e[r]}function Yc(e,t){var r=[],n=[];return e.forEach(function(a,i){var o=t(a,i,e),s=n.indexOf(o),l=r[s]||[];s===-1&&(n.push(o),r.push(l)),l.push(a)}),r}function g2(e,t){var r=[],n={};return e.forEach(function(a,i){var o=t(a,i,e),s=n[o];s||(s=[],n[o]=s,r.push(s)),s.push(a)}),r}function Uc(e){return e.reduce(function(t,r){return t.concat(r)},[])}function ca(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.sort(function(r,n){return Math.abs(n)-Math.abs(r)}),e[0]}function Gn(e,t,r){return gr(nn(e,r),Xn(t,r),r)}function m2(e,t){var r,n=e.is3d,a=e.rootMatrix,i=n?4:3;return r=Gn(a,[t.distX,t.distY],i),t.distX=r[0],t.distY=r[1],t}function Mi(e,t,r,n,a){return gt(ur(e,At(r,t),a),n)}function Xr(e,t,r){return r?"".concat(e/t*100,"%"):"".concat(e,"px")}function Gi(e){return Math.abs(e)<=Cr?0:e}function ul(e){return function(t){if(!t.isDragging(e))return"";var r=n2(t,e),n=r.deg;return n?bt("view-control-rotation".concat(n)):""}}function cl(e,t){return t===void 0&&(t=[e]),function(r,n){if(n.isRequest)return t.some(function(i){return n.requestAble===i})?n.parentDirection:!1;var a=n.inputEvent.target;return cr(a,bt("direction"))&&(!e||cr(a,bt(e)))}}function _2(e){var t={};for(var r in e)t[e[r]]=r;return t}function b2(e,t){var r=e.slice(0,t<0?void 0:t),n=e.slice(0,t<0?void 0:t+1),a=e[t]||"",i=t<0?[]:e.slice(t),o=t<0?[]:e.slice(t+1),s=Ln(r),l=Ln(n),u=Ln([a]),c=Ln(i),f=Ln(o),d=ta(s),h=ta(l),v=ta(c),p=ta(f),g=Wt(d,v,4);return{transforms:e,beforeFunctionMatrix:d,beforeFunctionMatrix2:h,targetFunctionMatrix:ta(u),afterFunctionMatrix:v,afterFunctionMatrix2:p,allFunctionMatrix:g,beforeFunctions:s,beforeFunctions2:l,targetFunction:u[0],afterFunctions:c,afterFunctions2:f,beforeFunctionTexts:r,beforeFunctionTexts2:n,targetFunctionText:a,afterFunctionTexts:i,afterFunctionTexts2:o}}function y2(e){return!e||!Kr(e)||e instanceof Element?!1:or(e)||"length"in e}function Un(e,t){return e?e instanceof Element?e:Lr(e)?t?document.querySelector(e):e:Gs(e)?e():"current"in e?e.current:e:null}function fl(e,t){if(!e)return[];var r=y2(e)?[].slice.call(e):[e];return r.reduce(function(n,a){return Lr(a)&&t?xt(xt([],n,!0),[].slice.call(document.querySelectorAll(a)),!0):(or(a)?n.push(fl(a,t)):n.push(Un(a,t)),n)},[])}function x2(e,t,r){var n=rr(e,t)/Math.PI*180;return n=r>=0?n:180-n,n=n>=0?n:360+n,n}function Du(e,t){var r=e.rootMatrix,n=e.is3d,a=n?4:3,i=nn(r,a);return n||(i=an(i,3,4)),i[12]=0,i[13]=0,i[14]=0,lm(i,t)}function jc(e,t,r,n,a){var i=e[0],o=e[1],s=0,l=0;if(a&&i&&o){var u=rr([0,0],t),c=rr([0,0],n),f=jr(t),d=Math.cos(u-c)*f;if(!n[0])l=d,s=l*r;else if(!n[1])s=d,l=s/r;else{var h=n[0]*2*i,v=n[1]*2*o,p=jr([h+t[0],v+t[1]])-jr([h,v]),g=rr([0,0],[r,1]);s=Math.cos(g)*p,l=Math.sin(g)*p}}else s=n[0]*t[0],l=n[1]*t[1];return[s,l]}function qc(e,t,r,n){var a,i=r.ratio,o=r.startOffsetWidth,s=r.startOffsetHeight,l=0,u=0,c=n.distX,f=n.distY,d=n.parentDistance,h=n.parentDist,v=n.parentScale,p=r.fixedDirection,g=[0,1].map(function(D){return Math.abs(e[D]-p[D])}),b=[0,1].map(function(D){var P=g[D];return P!==0&&(P=2/P),P});if(h)l=h[0],u=h[1],t&&(l?u||(u=l/i):l=u*i);else if(v)l=(v[0]-1)*o,u=(v[1]-1)*s;else if(d){var y=o*g[0],S=s*g[1],C=jr([y,S]);l=d/C*y*b[0],u=d/C*S*b[1]}else{var T=un({datas:r,distX:c,distY:f});T=b.map(function(D,P){return T[P]*D}),a=jc([o,s],T,i,e,t),l=a[0],u=a[1]}return{distWidth:l,distHeight:u}}function Cs(e,t){if(t){if(e==="left")return{x:"0%",y:"50%"};if(e==="top")return{x:"50%",y:"50%"};if(e==="center")return{x:"50%",y:"50%"};if(e==="right")return{x:"100%",y:"50%"};if(e==="bottom")return{x:"50%",y:"100%"};var r=e.split(" "),n=r[0],a=r[1],i=Cs(n||""),o=Cs(a||""),s=fe(fe({},i),o),l={x:"50%",y:"50%"};return s.x&&(l.x=s.x),s.y&&(l.y=s.y),s.value&&(s.x&&!s.y&&(l.y=s.value),!s.x&&s.y&&(l.x=s.value)),l}return e==="left"?{x:"0%"}:e==="right"?{x:"100%"}:e==="top"?{y:"0%"}:e==="bottom"?{y:"100%"}:e?e==="center"?{value:"50%"}:{value:e}:{}}function S2(e,t,r){var n=Cs(e,!0),a=n.x,i=n.y;return[Yt(a,t)||0,Yt(i,r)||0]}function w2(e,t,r){var n=e.map(function(i){return gt(i,t)}),a=n.map(function(i){return ai(i,r)});return{prev:n,next:a,result:a.map(function(i){return At(i,t)})}}function Kc(e,t){return e.length===t.length&&e.every(function(r,n){var a=t[n],i=or(r),o=or(a);return i&&o?Kc(r,a):!i&&!o?r===a:!1})}var C2=oi("pinchable",{events:{onPinchStart:"pinchStart",onPinch:"pinch",onPinchEnd:"pinchEnd",onPinchGroupStart:"pinchGroupStart",onPinchGroup:"pinchGroup",onPinchGroupEnd:"pinchGroupEnd"},dragStart:function(){return!0},pinchStart:function(e,t){var r=t.datas,n=t.targets,a=t.angle,i=t.originalDatas,o=e.props,s=o.pinchable,l=o.ables;if(!s)return!1;var u="onPinch".concat(n?"Group":"","Start"),c="drag".concat(n?"Group":"","ControlStart"),f=(s===!0?e.controlAbles:l.filter(function(p){return s.indexOf(p.name)>-1})).filter(function(p){return p.canPinch&&p[c]}),d=Mt(e,t,{});n&&(d.targets=n);var h=ft(e,u,d);r.isPinch=h!==!1,r.ables=f;var v=r.isPinch;return v?(f.forEach(function(p){if(i[p.name]=i[p.name]||{},!!p[c]){var g=fe(fe({},t),{datas:i[p.name],parentRotate:a,isPinch:!0});p[c](e,g)}}),e.state.snapRenderInfo={request:t.isRequest,direction:[0,0]},v):!1},pinch:function(e,t){var r=t.datas,n=t.scale,a=t.distance,i=t.originalDatas,o=t.inputEvent,s=t.targets,l=t.angle;if(r.isPinch){var u=a*(1-1/n),c=Mt(e,t,{});s&&(c.targets=s);var f="onPinch".concat(s?"Group":"");ft(e,f,c);var d=r.ables,h="drag".concat(s?"Group":"","Control");return d.forEach(function(v){v[h]&&v[h](e,fe(fe({},t),{datas:i[v.name],inputEvent:o,parentDistance:u,parentRotate:l,isPinch:!0}))}),c}},pinchEnd:function(e,t){var r=t.datas,n=t.isPinch,a=t.inputEvent,i=t.targets,o=t.originalDatas;if(r.isPinch){var s="onPinch".concat(i?"Group":"","End"),l=Fr(e,t,{isDrag:n});i&&(l.targets=i),ft(e,s,l);var u=r.ables,c="drag".concat(i?"Group":"","ControlEnd");return u.forEach(function(f){f[c]&&f[c](e,fe(fe({},t),{isDrag:n,datas:o[f.name],inputEvent:a,isPinch:!0}))}),n}},pinchGroupStart:function(e,t){return this.pinchStart(e,fe(fe({},t),{targets:e.props.targets}))},pinchGroup:function(e,t){return this.pinch(e,fe(fe({},t),{targets:e.props.targets}))},pinchGroupEnd:function(e,t){return this.pinchEnd(e,fe(fe({},t),{targets:e.props.targets}))}});function qr(e,t,r){var n=r.originalDatas;n.groupable=n.groupable||{};var a=n.groupable;a.childDatas=a.childDatas||[];var i=a.childDatas;return e.moveables.map(function(o,s){return i[s]=i[s]||{},i[s][t]=i[s][t]||{},fe(fe({},r),{datas:i[s][t],originalDatas:i[s]})})}function Ho(e,t,r,n,a,i,o){var s=!!r.match(/Start$/g),l=!!r.match(/End$/g),u=a.isPinch,c=a.datas,f=qr(e,t.name,a),d=e.moveables,h=f.map(function(v,p){var g=d[p],b=g.state,y=b.gestos,S=v;if(s)S=new ua(o).dragStart(n,v);else{if(y[o]||(y[o]=c.childGestos[p]),!y[o])return;S=si(v,b,n,u,i,o)}var C=t[r](g,fe(fe({},S),{parentFlag:!0}));return l&&(y[o]=null),C});return s&&(c.childGestos=d.map(function(v){return v.state.gestos[o]})),h}function fn(e,t,r,n,a,i){a===void 0&&(a=function(c,f){return f});var o=!!r.match(/End$/g),s=qr(e,t.name,n),l=e.moveables,u=s.map(function(c,f){var d=l[f],h=c;h=a(d,c);var v=t[r](d,fe(fe({},h),{parentFlag:!0}));return v&&i&&i(d,c,v,f),o&&(d.state.gestos={}),v});return u}var E2=["left","right","center"],M2=["top","bottom","middle"],kn={start:"left",end:"right",center:"center"},Tn={start:"top",end:"bottom",center:"middle"};function ba(e,t){var r=e.props,n=r.snappable,a=r.bounds,i=r.innerBounds,o=r.verticalGuidelines,s=r.horizontalGuidelines,l=r.snapGridWidth,u=r.snapGridHeight,c=e.state,f=c.guidelines,d=c.enableSnap;return!n||!d||t&&n!==!0&&n.indexOf(t)<0?!1:!!(l||u||a||i||f&&f.length||o&&o.length||s&&s.length)}function dl(e){return e===!1?{}:e===!0||!e?{left:!0,right:!0,top:!0,bottom:!0}:e}function k2(e,t){var r=dl(e),n={};for(var a in r)a in t&&r[a]&&(n[a]=t[a]);return n}function vl(e,t){var r=k2(e,t),n=M2.filter(function(i){return i in r}),a=E2.filter(function(i){return i in r});return{horizontal:n.map(function(i){return r[i]}),vertical:a.map(function(i){return r[i]})}}function T2(e,t,r){var n=ur(e,[t.clientLeft,t.clientTop],r);return[t.left+n[0],t.top+n[1]]}function R2(e){var t=e[0],r=e[1],n=r[0]-t[0],a=r[1]-t[1];Math.abs(n)<ir&&(n=0),Math.abs(a)<ir&&(a=0);var i=0,o=0,s=0;return n?a?(i=-a/n,o=1,s=i*t[0]-t[1]):(o=1,s=-t[1]):(i=-1,s=t[0]),[i,o,s].map(function(l){return Et(l,ir)})}function ho(e,t,r,n){var a=e.props,i=h2(n,a.snapThreshold,5);return Zc(e.state.guidelines,t,r,i)}function Zc(e,t,r,n){return{vertical:Iu(e,"vertical",t,n),horizontal:Iu(e,"horizontal",r,n)}}function D2(e,t,r){var n=r[0],a=r[1],i=t[0],o=t[1],s=gt(r,t),l=s[0],u=s[1],c=u>0,f=l>0;l=Gi(l),u=Gi(u);var d={isSnap:!1,offset:0,pos:0},h={isSnap:!1,offset:0,pos:0};if(l===0&&u===0)return{vertical:d,horizontal:h};var v=ho(e,l?[n]:[],u?[a]:[]),p=v.vertical,g=v.horizontal;p.posInfos.filter(function(re){var be=re.pos;return f?be>=i:be<=i}),g.posInfos.filter(function(re){var be=re.pos;return c?be>=o:be<=o}),p.isSnap=p.posInfos.length>0,g.isSnap=g.posInfos.length>0;var b=Es(p),y=b.isSnap,S=b.guideline,C=Es(g),T=C.isSnap,D=C.guideline,P=T?D.pos[1]:0,G=y?S.pos[0]:0;if(l===0)T&&(h.isSnap=!0,h.pos=D.pos[1],h.offset=a-h.pos);else if(u===0)y&&(d.isSnap=!0,d.pos=G,d.offset=n-G);else{var W=u/l,L=r[1]-W*n,X=0,M=0,oe=!1;y?(M=G,X=W*M+L,oe=!0):T&&(X=P,M=(X-L)/W,oe=!0),oe&&(d.isSnap=!0,d.pos=M,d.offset=n-M,h.isSnap=!0,h.pos=X,h.offset=a-X)}return{vertical:d,horizontal:h}}function Au(e,t,r){var n=vl(e.props.snapDirections,t);return ho(e,n.vertical,n.horizontal,r)}function Es(e){var t=e.isSnap;if(!t)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var r=e.posInfos[0],n=r.guidelineInfos[0],a=n.offset,i=n.dist,o=n.guideline;return{isSnap:t,offset:a,dist:i,pos:r.pos,guideline:o}}function Iu(e,t,r,n){if(!e||!e.length)return{isSnap:!1,index:-1,posInfos:[]};var a=t==="vertical",i=a?0:1,o=r.map(function(l,u){var c=e.map(function(f){var d=f.pos,h=l-d[i];return{offset:h,dist:Math.abs(h),guideline:f}}).filter(function(f){var d=f.guideline,h=f.dist,v=d.type;return!(v!==t||h>n)}).sort(function(f,d){return f.dist-d.dist});return{pos:l,index:u,guidelineInfos:c}}).filter(function(l){return l.guidelineInfos.length>0}).sort(function(l,u){return l.guidelineInfos[0].dist-u.guidelineInfos[0].dist}),s=o.length>0;return{isSnap:s,index:s?o[0].index:-1,posInfos:o}}function A2(e,t,r,n){n===void 0&&(n=1);var a=[];if(r[0]&&r[1])a=[r,[-r[0],r[1]],[r[0],-r[1]]].map(function(s){return tr(t,s)});else if(!r[0]&&!r[1])for(var i=[t[0],t[1],t[3],t[2],t[0]],o=0;o<4;++o)a.push(i[o]),a.push([(i[o][0]+i[o+1][0])/2,(i[o][1]+i[o+1][1])/2]);else e.props.keepRatio?a=[[-1,-1],[-1,1],[1,-1],[1,1],r].map(function(s){return tr(t,s)}):(a=Km(t,r),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));return ho(e,a.map(function(s){return s[0]}),a.map(function(s){return s[1]}),n)}function Qc(e,t){var r=Math.abs(e.offset),n=Math.abs(t.offset);return e.isBound&&t.isBound?n-r:e.isBound?-1:t.isBound?1:e.isSnap&&t.isSnap?n-r:e.isSnap?-1:t.isSnap||r<Cr?1:n<Cr?-1:r-n}function Wi(e,t){return e.slice().sort(function(r,n){var a=r.sign[t],i=n.sign[t],o=r.offset[t],s=n.offset[t];if(a){if(!i)return-1}else return 1;return Qc({isBound:r.isBound,isSnap:r.isSnap,offset:o},{isBound:n.isBound,isSnap:n.isSnap,offset:s})})[0]}function I2(e,t,r){var n=[];if(r)Math.abs(t[0])!==1||Math.abs(t[1])!==1?n.push([t,[-1,-1]],[t,[-1,1]],[t,[1,-1]],[t,[1,1]]):n.push([t,[e[0],-e[1]]],[t,[-e[0],e[1]]]),n.push([t,e]);else if(e[0]&&e[1]||!e[0]&&!e[1]){var a=e[0]?e:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(s){var l=[o*a[0],s*a[1]];t[0]===l[0]&&t[1]===l[1]||n.push([t,l])})})}else if(e[0]){var i=Math.abs(t[0])===1?[1]:[1,-1];i.forEach(function(o){n.push([[t[0],-1],[o*e[0],-1]],[[t[0],0],[o*e[0],0]],[[t[0],1],[o*e[0],1]])})}else if(e[1]){var i=Math.abs(t[1])===1?[1]:[1,-1];i.forEach(function(s){n.push([[-1,t[1]],[-1,s*e[1]]],[[0,t[1]],[0,s*e[1]]],[[1,t[1]],[1,s*e[1]]])})}return n}function Jc(e,t){var r=ns([t[0][0],t[1][0]]),n=ns([t[0][1],t[1][1]]);return{vertical:r<=e[0],horizontal:n<=e[1]}}function pl(e,t){var r=t[0],n=t[1],a=n[0]-r[0],i=n[1]-r[1];Math.abs(a)<Cr&&(a=0),Math.abs(i)<Cr&&(i=0);var o,s;if(!a)o=r[0],s=e[0];else if(!i)o=r[1],s=e[1];else{var l=i/a;o=l*(e[0]-r[0])+r[1],s=e[1]}return o-s}function ef(e,t,r,n){return n===void 0&&(n=Cr),e.every(function(a){var i=pl(a,t),o=i<=0;return o===r||Math.abs(i)<=n})}function Bu(e,t,r,n,a){return a===void 0&&(a=0),n&&t-a<=e||!n&&e<=r+a?{isBound:!0,offset:n?t-e:r-e}:{isBound:!1,offset:0}}function B2(e,t){var r=t.line,n=t.centerSign,a=t.verticalSign,i=t.horizontalSign,o=t.lineConstants,s=e.props.innerBounds;if(!s)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var l=s.left,u=s.top,c=s.width,f=s.height,d=[[l,u],[l,u+f]],h=[[l,u],[l+c,u]],v=[[l+c,u],[l+c,u+f]],p=[[l,u+f],[l+c,u+f]];if(ef([[l,u],[l+c,u],[l,u+f],[l+c,u+f]],r,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var g=Sn(r,o,h,a),b=Sn(r,o,p,a),y=Sn(r,o,d,i),S=Sn(r,o,v,i),C=g.isBound&&b.isBound,T=g.isBound||b.isBound,D=y.isBound&&S.isBound,P=y.isBound||S.isBound,G=ca(g.offset,b.offset),W=ca(y.offset,S.offset),L=[0,0],X=!1,M=!1;return Math.abs(W)<Math.abs(G)?(L=[G,0],X=T,M=C):(L=[0,W],X=P,M=D),{isAllBound:M,isVerticalBound:T,isHorizontalBound:P,isBound:X,offset:L}}function Sn(e,t,r,n,a,i){var o=t[0],s=t[1],l=e[0],u=r[0],c=r[1],f=Gi(c[1]-u[1]),d=Gi(c[0]-u[0]),h=s,v=o,p=-o/s;if(d){if(!f){if(i&&!h)return{isBound:!1,offset:0};if(v){var S=(u[1]-l[1])/p+l[0];return Bu(S,u[0],c[0],n,a)}else{var b=u[1]-l[1],y=Math.abs(b)<=(a||0);return{isBound:y,offset:y?b:0}}}}else{if(i&&!v)return{isBound:!1,offset:0};if(h){var g=p*(u[0]-l[0])+l[1];return Bu(g,u[1],c[1],n,a)}else{var b=u[0]-l[0],y=Math.abs(b)<=(a||0);return{isBound:y,offset:y?b:0}}}return{isBound:!1,offset:0}}function tf(e,t,r){return t.map(function(n){var a=B2(e,n),i=a.isBound,o=a.offset,s=a.isVerticalBound,l=a.isHorizontalBound,u=n.multiple,c=un({datas:r,distX:o[0],distY:o[1]}).map(function(f,d){return f*(u[d]?2/u[d]:0)});return{sign:u,isBound:i,isVerticalBound:s,isHorizontalBound:l,isSnap:!1,offset:c}})}function O2(e,t,r){var n,a=hl(e,t,[0,0],!1).map(function(d){return fe(fe({},d),{multiple:d.multiple.map(function(h){return Math.abs(h)*2})})}),i=tf(e,a,r),o=Wi(i,0),s=Wi(i,1),l=0,u=0,c=o.isVerticalBound||s.isVerticalBound,f=o.isHorizontalBound||s.isHorizontalBound;return(c||f)&&(n=jm({datas:r,distX:-o.offset[0],distY:-s.offset[1]}),l=n[0],u=n[1]),{vertical:{isBound:c,offset:l},horizontal:{isBound:f,offset:u}}}function P2(e,t){var r=[],n=e[0],a=e[1];return n&&a?r.push([[0,a*2],e,[-n,a]],[[n*2,0],e,[n,-a]]):n?(r.push([[n*2,0],[n,1],[n,-1]]),t&&r.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):a?(r.push([[0,a*2],[1,a],[-1,a]]),t&&r.push([[-1,0],[-1,a],[-1,-a]],[[1,0],[1,a],[1,-a]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r}function hl(e,t,r,n){var a=e.state,i=a.allMatrix,o=a.is3d,s=Mn(i,100,100,o?4:3),l=tr(s,[0,0]);return P2(r,n).map(function(u){var c=u[0],f=u[1],d=u[2],h=[tr(s,f),tr(s,d)],v=R2(h),p=Jc(l,h),g=p.vertical,b=p.horizontal,y=pl(l,h)<=0;return{multiple:c,centerSign:y,verticalSign:g,horizontalSign:b,lineConstants:v,line:[tr(t,f),tr(t,d)]}})}function Ou(e,t,r,n){var a=n?e.map(function(i){return ai(i,n)}):e;return[[a[0],a[1]],[a[1],a[3]],[a[3],a[2]],[a[2],a[0]]].some(function(i){var o=pl(r,i)<=0;return!ef(t,i,o)})}function L2(e){var t=e[0],r=e[1],n=r[0]-t[0],a=r[1]-t[1];if(!n)return Math.abs(t[0]);if(!a)return Math.abs(t[1]);var i=a/n;return Math.abs((-i*t[0]+t[1])/Math.sqrt(Math.pow(i,2)+1))}function F2(e){var t=e[0],r=e[1],n=r[0]-t[0],a=r[1]-t[1];if(!n)return[t[0],0];if(!a)return[0,t[1]];var i=a/n,o=-i*t[0]+t[1];return[-o/(i+1/i),o/(i*i+1)]}function $2(e,t,r,n,a){var i=e.props.innerBounds,o=a*Math.PI/180;if(!i)return[];var s=i.left,l=i.top,u=i.width,c=i.height,f=s-n[0],d=s+u-n[0],h=l-n[1],v=l+c-n[1],p=[[f,h],[d,h],[f,v],[d,v]],g=tr(r,[0,0]);if(!Ou(r,p,g,0))return[];var b=[],y=p.map(function(S){return[jr(S),rr([0,0],S)]});return[[r[0],r[1]],[r[1],r[3]],[r[3],r[2]],[r[2],r[0]]].forEach(function(S){var C=rr([0,0],F2(S)),T=L2(S);b.push.apply(b,y.filter(function(D){var P=D[0];return P&&T<=P}).map(function(D){var P=D[0],G=D[1],W=Math.acos(P?T/P:0),L=G+W,X=G-W;return[o+L-C,o+X-C]}).reduce(function(D,P){return D.push.apply(D,P),D},[]).filter(function(D){return!Ou(t,p,g,D)}).map(function(D){return Et(D*180/Math.PI,Cr)}))}),b}function N2(e){var t=e.props.innerBounds;if(!t)return{vertical:[],horizontal:[]};var r=e.getRect(),n=r.pos1,a=r.pos2,i=r.pos3,o=r.pos4,s=[n,a,i,o],l=tr(s,[0,0]),u=t.left,c=t.top,f=t.width,d=t.height,h=[[u,c],[u,c+d]],v=[[u,c],[u+f,c]],p=[[u+f,c],[u+f,c+d]],g=[[u,c+d],[u+f,c+d]],b=hl(e,s,[0,0],!1),y=[],S=[],C={top:!1,bottom:!1,left:!1,right:!1};return b.forEach(function(T){var D=T.line,P=T.lineConstants,G=Jc(l,D),W=G.horizontal,L=G.vertical,X=Sn(D,P,v,L,1,!0),M=Sn(D,P,g,L,1,!0),oe=Sn(D,P,h,W,1,!0),re=Sn(D,P,p,W,1,!0);X.isBound&&!C.top&&(y.push(c),C.top=!0),M.isBound&&!C.bottom&&(y.push(c+d),C.bottom=!0),oe.isBound&&!C.left&&(S.push(u),C.left=!0),re.isBound&&!C.right&&(S.push(u+f),C.right=!0)}),{horizontal:y,vertical:S}}function gl(e,t,r){var n=e||{},a=n.position,i=a===void 0?"client":a,o=n.left,s=o===void 0?-1/0:o,l=n.top,u=l===void 0?-1/0:l,c=n.right,f=c===void 0?1/0:c,d=n.bottom,h=d===void 0?1/0:d,v={position:i,left:s,top:u,right:f,bottom:h};return{vertical:Pu(v,t,!0),horizontal:Pu(v,r,!1)}}function go(e,t){var r=e.state,n=r.containerClientRect,a=n.clientHeight,i=n.clientWidth,o=n.clientLeft,s=n.clientTop,l=r.snapOffset,u=l.left,c=l.top,f=l.right,d=l.bottom,h=t||e.props.bounds||{},v=h.position||"client",p=v==="css",g=h.left,b=g===void 0?-1/0:g,y=h.top,S=y===void 0?-1/0:y,C=h.right,T=C===void 0?p?-1/0:1/0:C,D=h.bottom,P=D===void 0?p?-1/0:1/0:D;return p&&(T=i+f-u-T,P=a+d-c-P),{left:b+u-o,right:T+u-o,top:S+c-s,bottom:P+c-s}}function z2(e,t,r){var n=go(e),a=n.left,i=n.top,o=n.right,s=n.bottom,l=r[0],u=r[1],c=gt(r,t),f=c[0],d=c[1];Math.abs(f)<Cr&&(f=0),Math.abs(d)<Cr&&(d=0);var h=d>0,v=f>0,p={isBound:!1,offset:0,pos:0},g={isBound:!1,offset:0,pos:0};if(f===0&&d===0)return{vertical:p,horizontal:g};if(f===0)h?s<u&&(g.pos=s,g.offset=u-s):i>u&&(g.pos=i,g.offset=u-i);else if(d===0)v?o<l&&(p.pos=o,p.offset=l-o):a>l&&(p.pos=a,p.offset=l-a);else{var b=d/f,y=r[1]-b*l,S=0,C=0,T=!1;v&&o<=l?(S=b*o+y,C=o,T=!0):!v&&l<=a&&(S=b*a+y,C=a,T=!0),T&&(S<i||S>s)&&(T=!1),T||(h&&s<=u?(S=s,C=(S-y)/b,T=!0):!h&&u<=i&&(S=i,C=(S-y)/b,T=!0)),T&&(p.isBound=!0,p.pos=C,p.offset=l-C,g.isBound=!0,g.pos=S,g.offset=u-S)}return{vertical:p,horizontal:g}}function Pu(e,t,r){var n=e[r?"left":"top"],a=e[r?"right":"bottom"],i=Math.min.apply(Math,t),o=Math.max.apply(Math,t),s=[];return n+1>i&&s.push({isBound:!0,offset:i-n,pos:n}),a-1<o&&s.push({isBound:!0,offset:o-a,pos:a}),s.length||s.push({isBound:!1,offset:0,pos:0}),s.sort(function(l,u){return Math.abs(u.offset)-Math.abs(l.offset)})}function Lu(e,t,r){var n=r?e.map(function(a){return ai(a,r)}):e;return n.some(function(a){return a[0]<t.left&&Math.abs(a[0]-t.left)>.1||a[0]>t.right&&Math.abs(a[0]-t.right)>.1||a[1]<t.top&&Math.abs(a[1]-t.top)>.1||a[1]>t.bottom&&Math.abs(a[1]-t.bottom)>.1})}function V2(e,t,r){var n=jr(e),a=Math.sqrt(n*n-t*t)||0;return[a,-a].sort(function(i,o){return Math.abs(i-e[r?0:1])-Math.abs(o-e[r?0:1])}).map(function(i){return rr([0,0],r?[i,t]:[t,i])})}function H2(e,t,r,n,a){if(!e.props.bounds)return[];var i=a*Math.PI/180,o=go(e),s=o.left,l=o.top,u=o.right,c=o.bottom,f=s-n[0],d=u-n[0],h=l-n[1],v=c-n[1],p={left:f,top:h,right:d,bottom:v};if(!Lu(r,p,0))return[];var g=[];return[[f,0],[d,0],[h,1],[v,1]].forEach(function(b){var y=b[0],S=b[1];r.forEach(function(C){var T=rr([0,0],C);g.push.apply(g,V2(C,y,S).map(function(D){return i+D-T}).filter(function(D){return!Lu(t,p,D)}).map(function(D){return Et(D*180/Math.PI,Cr)}))})}),g}function G2(e,t){var r,n=e.direction,a=e.classNames,i=e.size,o=e.pos,s=e.zoom,l=e.key,u=n==="horizontal",c=u?"Y":"X";return t.createElement("div",{key:l,className:a.join(" "),style:(r={},r[u?"width":"height"]="".concat(i),r.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(c,"(-50%) scale").concat(c,"(").concat(s,")"),r)})}function ml(e,t){return G2(fe(fe({},e),{classNames:xt([bt("line","guideline",e.direction)],e.classNames,!0).filter(function(r){return r}),size:e.size||"".concat(e.sizeValue,"px"),pos:e.pos||e.posValue.map(function(r){return"".concat(Et(r,.1),"px")})}),t)}function Fu(e,t,r,n,a,i,o,s){var l=e.props.zoom;return r.map(function(u,c){var f=u.type,d=u.pos,h=[0,0];return h[o]=n,h[o?0:1]=-a+d,ml({key:"".concat(t,"TargetGuideline").concat(c),classNames:[bt("target","bold",f)],posValue:h,sizeValue:i,zoom:l,direction:t},s)})}function $u(e,t,r,n,a,i){var o=e.props,s=o.zoom,l=o.isDisplayInnerSnapDigit,u=t==="horizontal"?kn:Tn,c=a[u.start],f=a[u.end];return r.filter(function(d){var h=d.hide,v=d.elementRect;if(h)return!1;if(l&&v){var p=v.rect;if(p[u.start]<=c&&f<=p[u.end])return!1}return!0}).map(function(d,h){var v=d.pos,p=d.size,g=d.element,b=d.className,y=[-n[0]+v[0],-n[1]+v[1]];return ml({key:"".concat(t,"-default-guideline-").concat(h),classNames:g?[bt("bold"),b]:[bt("normal"),b],direction:t,posValue:y,sizeValue:p,zoom:s},i)})}function Ra(e,t,r,n,a,i,o,s){var l,u=e.props,c=u.snapDigit,f=c===void 0?0:c,d=u.isDisplaySnapDigit,h=d===void 0?!0:d,v=u.snapDistFormat,p=v===void 0?function(T,D){return T}:v,g=u.zoom,b=t==="horizontal"?"X":"Y",y=t==="vertical"?"height":"width",S=Math.abs(a),C=h?parseFloat(S.toFixed(f)):0;return s.createElement("div",{key:"".concat(t,"-").concat(r,"-guideline-").concat(n),className:bt("guideline-group",t),style:(l={left:"".concat(i[0],"px"),top:"".concat(i[1],"px")},l[y]="".concat(S,"px"),l)},ml({direction:t,classNames:[bt(r),o],size:"100%",posValue:[0,0],sizeValue:S,zoom:g},s),s.createElement("div",{className:bt("size-value","gap"),style:{transform:"translate".concat(b,"(-50%) scale(").concat(g,")")}},C>0?p(C,t):""))}function W2(e,t,r,n){var a=e==="vertical"?0:1,i=e==="vertical"?1:0,o=a?kn:Tn,s=r[o.start],l=r[o.end];return Yc(t,function(u){return u.pos[a]}).map(function(u){var c=[],f=[],d=[];return u.forEach(function(h){var v,p,g=h.element,b=h.elementRect.rect;if(b[o.end]<s)c.push(h);else if(l<b[o.start])f.push(h);else if(b[o.start]<=s&&l<=b[o.end]&&n){var y=h.pos,S={element:g,rect:fe(fe({},b),(v={},v[o.end]=b[o.start],v))},C={element:g,rect:fe(fe({},b),(p={},p[o.start]=b[o.end],p))},T=[0,0],D=[0,0];T[a]=y[a],T[i]=y[i],D[a]=y[a],D[i]=y[i]+h.size,c.push({type:e,pos:T,size:0,elementRect:S}),f.push({type:e,pos:D,size:0,elementRect:C})}}),c.sort(function(h,v){return v.pos[i]-h.pos[i]}),f.sort(function(h,v){return h.pos[i]-v.pos[i]}),{total:u,start:c,end:f,inner:d}})}function X2(e,t,r,n,a){var i=e.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(s){var l=t.filter(function(g){return g.type===s}),u=s==="vertical"?1:0,c=u?0:1,f=W2(s,l,n,i),d=u?Tn:kn,h=u?kn:Tn,v=n[d.start],p=n[d.end];f.forEach(function(g){var b=g.total,y=g.start,S=g.end,C=g.inner,T=r[c]+b[0].pos[c]-n[h.start],D=n;y.forEach(function(P){var G=P.elementRect.rect,W=D[d.start]-G[d.end];if(W>0){var L=[0,0];L[u]=r[u]+D[d.start]-v-W,L[c]=T,o.push(Ra(e,s,"dashed",o.length,W,L,P.className,a))}D=G}),D=n,S.forEach(function(P){var G=P.elementRect.rect,W=G[d.start]-D[d.end];if(W>0){var L=[0,0];L[u]=r[u]+D[d.end]-v,L[c]=T,o.push(Ra(e,s,"dashed",o.length,W,L,P.className,a))}D=G}),C.forEach(function(P){var G=P.elementRect.rect,W=v-G[d.start],L=G[d.end]-p,X=[0,0],M=[0,0];X[u]=r[u]-W,X[c]=T,M[u]=r[u]+p-v,M[c]=T,o.push(Ra(e,s,"dashed",o.length,W,X,P.className,a)),o.push(Ra(e,s,"dashed",o.length,L,M,P.className,a))})})}),o}function Y2(e,t,r,n,a){var i=[];return["horizontal","vertical"].forEach(function(o){var s=t.filter(function(g){return g.type===o}).slice(0,1),l=o==="vertical"?0:1,u=l?0:1,c=l?Tn:kn,f=l?kn:Tn,d=n[c.start],h=n[c.end],v=n[f.start],p=n[f.end];s.forEach(function(g){var b=g.gap,y=g.gapRects,S=Math.max.apply(Math,xt([v],y.map(function(D){var P=D.rect;return P[f.start]}),!1)),C=Math.min.apply(Math,xt([p],y.map(function(D){var P=D.rect;return P[f.end]}),!1)),T=(S+C)/2;S===C||T===(v+p)/2||y.forEach(function(D){var P=D.rect,G=D.className,W=[r[0],r[1]];if(P[c.end]<d)W[l]+=P[c.end]-d;else if(h<P[c.start])W[l]+=P[c.start]-d-b;else return;W[u]+=T-v,i.push(Ra(e,l?"vertical":"horizontal","gap",i.length,b,W,G,a))})})}),i}function U2(e,t,r,n){var a=t[0]-e[0],i=t[1]-e[1];if(Math.abs(a)<ir&&(a=0),Math.abs(i)<ir&&(i=0),!a)return n?[0,0]:[0,r];if(!i)return n?[r,0]:[0,0];var o=i/a,s=e[1]-o*e[0];if(n){var l=o*(t[0]+r)+s;return[r,l-t[1]]}else{var u=(t[1]+r-s)/o;return[u-t[0],r]}}function Ms(e,t,r,n,a){var i=U2(e,t,r,n);if(!i)return{isOutside:!1,offset:[0,0]};var o=Ur(e,t),s=Ur(i,e),l=Ur(i,t),u=s>o||l>o,c=un({datas:a,distX:i[0],distY:i[1]}),f=c[0],d=c[1];return{offset:[f,d],isOutside:u}}function Xi(e,t){return e.isBound?e.offset:t.isSnap?Es(t).offset:0}function j2(e,t,r,n,a){var i=t[0],o=t[1],s=r[0],l=r[1],u=n[0],c=n[1],f=a[0],d=a[1],h=-f,v=-d;if(e&&i&&o){h=0,v=0;var p=[];if(s&&l?p.push([0,d],[f,0]):s?p.push([f,0]):l?p.push([0,d]):u&&c?p.push([0,d],[f,0]):u?p.push([f,0]):c&&p.push([0,d]),p.length){p.sort(function(S,C){return jr(gt([i,o],S))-jr(gt([i,o],C))});var g=p[0];if(g[0]&&Math.abs(i)>ir)h=-g[0],v=o*Math.abs(i+h)/Math.abs(i)-o;else if(g[1]&&Math.abs(o)>ir){var b=o;v=-g[1],h=i*Math.abs(o+v)/Math.abs(b)-i}if(e&&l&&s)if(Math.abs(h)>ir&&Math.abs(h)<Math.abs(f)){var y=Math.abs(f)/Math.abs(h);h*=y,v*=y}else if(Math.abs(v)>ir&&Math.abs(v)<Math.abs(d)){var y=Math.abs(d)/Math.abs(v);h*=y,v*=y}else h=ca(-f,h),v=ca(-d,v)}}else h=i||s?-f:0,v=o||l?-d:0;return[h,v]}function q2(e,t,r,n,a,i){if(!ba(e,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=ll(i.absolutePoses,[t,r]),s=Vr(o),l=s.left,u=s.right,c=s.top,f=s.bottom,d={horizontal:o.map(function(re){return re[1]}),vertical:o.map(function(re){return re[0]})},h=dl(e.props.snapDirections),v=vl(h,{left:l,right:u,top:c,bottom:f,center:(l+u)/2,middle:(c+f)/2}),p=mo(e,a,v,d),g=p.vertical,b=p.horizontal,y=O2(e,o,i),S=y.vertical,C=y.horizontal,T=g.isSnap,D=b.isSnap,P=g.isBound||S.isBound,G=b.isBound||C.isBound,W=ca(g.offset,S.offset),L=ca(b.offset,C.offset),X=j2(n,[t,r],[P,G],[T,D],[W,L]),M=X[0],oe=X[1];return[{isBound:P,isSnap:T,offset:M},{isBound:G,isSnap:D,offset:oe}]}function mo(e,t,r,n){n===void 0&&(n=r);var a=gl(go(e),n.vertical,n.horizontal),i=a.horizontal,o=a.vertical,s=t?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:ho(e,r.vertical,r.horizontal),l=s.horizontal,u=s.vertical,c=Xi(i[0],l),f=Xi(o[0],u),d=Math.abs(c),h=Math.abs(f);return{horizontal:{isBound:i[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:c,dist:d,bounds:i,snap:l},vertical:{isBound:o[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:f,dist:h,bounds:o,snap:u}}}function Nu(e,t,r,n,a){var i=gl(t,r,n),o=i.horizontal,s=i.vertical,l=Zc(e,r,n,a),u=l.horizontal,c=l.vertical,f=Xi(o[0],u),d=Xi(s[0],c),h=Math.abs(f),v=Math.abs(d);return{horizontal:{isBound:o[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:f,dist:h,bounds:o,snap:u},vertical:{isBound:s[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:d,dist:v,bounds:s,snap:c}}}function K2(e,t,r,n){var a=rr(e,t)/Math.PI*180,i=r.vertical,o=i.isBound,s=i.isSnap,l=i.dist,u=r.horizontal,c=u.isBound,f=u.isSnap,d=u.dist,h=a%180,v=h<3||h>177,p=h>87&&h<93;return d<l&&(o||s&&!p&&(!n||!v))?"vertical":c||f&&!v&&(!n||!p)?"horizontal":""}function Z2(e,t,r,n,a,i){return r.map(function(o){var s=o[0],l=o[1],u=tr(t,s),c=tr(t,l),f=n?Q2(e,u,c,a):mo(e,a,{vertical:[c[0]],horizontal:[c[1]]}),d=f.horizontal,h=d.offset,v=d.isBound,p=d.isSnap,g=f.vertical,b=g.offset,y=g.isBound,S=g.isSnap,C=gt(l,s);if(!b&&!h)return{isBound:y||v,isSnap:S||p,sign:C,offset:[0,0]};var T=K2(u,c,f,n);if(!T)return{sign:C,isBound:!1,isSnap:!1,offset:[0,0]};var D=T==="vertical",P=[0,0];return!n&&Math.abs(l[0])===1&&Math.abs(l[1])===1&&s[0]!==l[0]&&s[1]!==l[1]?P=un({datas:i,distX:-b,distY:-h}):P=Ms(u,c,-(D?b:h),D,i).offset,P=P.map(function(G,W){return G*(C[W]?2/C[W]:0)}),{sign:C,isBound:D?y:v,isSnap:D?S:p,offset:P}})}function zu(e,t){return e.isBound?e.offset:t.isSnap?t.offset:0}function Q2(e,t,r,n){var a=z2(e,t,r),i=a.horizontal,o=a.vertical,s=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:D2(e,t,r),l=s.horizontal,u=s.vertical,c=zu(i,l),f=zu(o,u),d=Math.abs(c),h=Math.abs(f);return{horizontal:{isBound:i.isBound,isSnap:l.isSnap,offset:c,dist:d},vertical:{isBound:o.isBound,isSnap:u.isSnap,offset:f,dist:h}}}function J2(e,t,r,n,a){var i=[-r[0],-r[1]],o=e.state,s=o.width,l=o.height,u=e.props.bounds,c=1/0,f=1/0;if(u){var d=[[r[0],-r[1]],[-r[0],r[1]]],h=u.left,v=h===void 0?-1/0:h,p=u.top,g=p===void 0?-1/0:p,b=u.right,y=b===void 0?1/0:b,S=u.bottom,C=S===void 0?1/0:S;d.forEach(function(T){var D=T[0]!==i[0],P=T[1]!==i[1],G=tr(t,T),W=rr(n,G)*360/Math.PI;if(P){var L=G.slice();(Math.abs(W-360)<2||Math.abs(W-180)<2)&&(L[1]=n[1]);var X=Ms(n,L,(n[1]<G[1]?C:g)-G[1],!1,a),M=X.offset,oe=M[1],re=X.isOutside;isNaN(oe)||(f=l+(re?1:-1)*Math.abs(oe))}if(D){var L=G.slice();(Math.abs(W-90)<2||Math.abs(W-270)<2)&&(L[0]=n[0]);var be=Ms(n,L,(n[0]<G[0]?y:v)-G[0],!0,a),ze=be.offset[0],Ue=be.isOutside;isNaN(ze)||(c=s+(Ue?1:-1)*Math.abs(ze))}})}return{maxWidth:c,maxHeight:f}}function ks(e){var t=e.state,r=t.containerClientRect,n=t.hasFixed,a=r.overflow,i=r.scrollHeight,o=r.scrollWidth,s=r.clientHeight,l=r.clientWidth,u=r.clientLeft,c=r.clientTop,f=e.props,d=f.snapGap,h=d===void 0?!0:d,v=f.verticalGuidelines,p=f.horizontalGuidelines,g=f.snapThreshold,b=g===void 0?5:g,y=f.snapGridWidth,S=y===void 0?0:y,C=f.snapGridHeight,T=C===void 0?0:C,D=f.maxSnapElementGuidelineDistance,P=D===void 0?1/0:D,G=Vr(Dr(e.state)),W=G.top,L=G.left,X=G.bottom,M=G.right,oe={top:W,left:L,bottom:X,right:M,center:(L+M)/2,middle:(W+X)/2},re=r_(e),be=xt([],re,!0);h&&be.push.apply(be,e_(e,oe,b)),be.push.apply(be,t_(S,T,a?o:l,a?i:s,u,c));var ze=fe({},t.snapOffset||{left:0,top:0,bottom:0,right:0});if(n){var Ue=r.left,Ge=r.top;ze.left+=Ue,ze.top+=Ge,ze.right+=Ue,ze.bottom+=Ge}return be.push.apply(be,nf(p||!1,v||!1,a?o:l,a?i:s,u,c,ze)),be=be.filter(function(Ne){var Me=Ne.element,Pe=Ne.elementRect,Se=Ne.type;if(!Me||!Pe)return!0;var ve=Pe.rect;return rf(oe,ve,Se,P)}),be}function e_(e,t,r){var n=e.props,a=n.maxSnapElementGuidelineDistance,i=a===void 0?1/0:a,o=n.maxSnapElementGapDistance,s=o===void 0?1/0:o,l=e.state.elementRects,u=[];return[["vertical",kn,Tn],["horizontal",Tn,kn]].forEach(function(c){var f=c[0],d=c[1],h=c[2],v=t[d.start],p=t[d.end],g=t[d.center],b=t[h.start],y=t[h.end];function S(D){var P=D.rect;return P[d.end]<v+r?v-P[d.end]:p-r<P[d.start]?P[d.start]-p:-1}var C=l.filter(function(D){var P=D.rect;return P[h.start]>y||P[h.end]<b?!1:S(D)>0}).sort(function(D,P){return S(D)-S(P)}),T=[];C.forEach(function(D){C.forEach(function(P){if(D!==P){var G=D.rect,W=P.rect,L=G[h.start],X=G[h.end],M=W[h.start],oe=W[h.end];L>oe||M>X||T.push([D,P])}})}),T.forEach(function(D){var P=D[0],G=D[1],W=P.rect,L=G.rect,X=W[d.start],M=W[d.end],oe=L[d.start],re=L[d.end],be=0,ze=0,Ue=!1,Ge=!1,Ne=!1;if(M<=v&&p<=oe){if(Ge=!0,be=(oe-M-(p-v))/2,ze=M+be+(p-v)/2,Math.abs(ze-g)>r)return}else if(M<oe&&re<v+r){if(Ue=!0,be=oe-M,ze=re+be,Math.abs(ze-v)>r)return}else if(M<oe&&p-r<X){if(Ne=!0,be=oe-M,ze=X-be,Math.abs(ze-p)>r)return}else return;be&&rf(t,L,f,i)&&(be>s||u.push({type:f,pos:f==="vertical"?[ze,0]:[0,ze],element:G.element,size:0,className:G.className,isStart:Ue,isCenter:Ge,isEnd:Ne,gap:be,hide:!0,gapRects:[P,G]}))})}),u}function t_(e,t,r,n,a,i){a===void 0&&(a=0),i===void 0&&(i=0);var o=[];if(t)for(var s=0;s<=n;s+=t)o.push({type:"horizontal",pos:[0,Et(s-i,.1)],size:r,hide:!0});if(e)for(var s=0;s<=r;s+=e)o.push({type:"vertical",pos:[Et(s-a,.1),0],size:n,hide:!0});return o}function rf(e,t,r,n){return r==="horizontal"?Math.abs(e.right-t.left)<=n||Math.abs(e.left-t.right)<=n||e.left<=t.right&&t.left<=e.right:r==="vertical"?Math.abs(e.bottom-t.top)<=n||Math.abs(e.top-t.bottom)<=n||e.top<=t.bottom&&t.top<=e.bottom:!0}function r_(e){var t=e.state,r=e.props.elementGuidelines,n=r===void 0?[]:r;if(!n.length)return t.elementRects=[],[];var a=(t.elementRects||[]).filter(function(d){return!d.refresh}),i=n.map(function(d){return Kr(d)&&"element"in d?fe(fe({},d),{element:Un(d.element,!0)}):{element:Un(d,!0)}}).filter(function(d){return d.element}),o=cm(a.map(function(d){return d.element}),i.map(function(d){return d.element})),s=o.maintained,l=o.added,u=[];s.forEach(function(d){var h=d[0],v=d[1];u[v]=a[h]}),n_(e,l.map(function(d){return i[d]})).map(function(d,h){u[l[h]]=d}),t.elementRects=u;var c=dl(e.props.elementSnapDirections),f=[];return u.forEach(function(d){var h=d.element,v=d.top,p=v===void 0?c.top:v,g=d.left,b=g===void 0?c.left:g,y=d.right,S=y===void 0?c.right:y,C=d.bottom,T=C===void 0?c.bottom:C,D=d.center,P=D===void 0?c.center:D,G=d.middle,W=G===void 0?c.middle:G,L=d.className,X=d.rect,M=vl({top:p,right:S,left:b,bottom:T,center:P,middle:W},X),oe=M.horizontal,re=M.vertical,be=X.top,ze=X.left,Ue=X.right-ze,Ge=X.bottom-be,Ne=[Ue,Ge];re.forEach(function(Me){f.push({type:"vertical",element:h,pos:[Et(Me,.1),be],size:Ge,sizes:Ne,className:L,elementRect:d})}),oe.forEach(function(Me){f.push({type:"horizontal",element:h,pos:[ze,Et(Me,.1)],size:Ue,sizes:Ne,className:L,elementRect:d})})}),f}function nf(e,t,r,n,a,i,o){a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var s=[],l=o.left,u=o.top,c=o.bottom,f=o.right,d=r+f-l,h=n+c-u;return e&&e.forEach(function(v){var p=Kr(v)?v:{pos:v};s.push({type:"horizontal",pos:[l,Et(p.pos-i+u,.1)],size:d,className:p.className})}),t&&t.forEach(function(v){var p=Kr(v)?v:{pos:v};s.push({type:"vertical",pos:[Et(p.pos-a+l,.1),u],size:h,className:p.className})}),s}function n_(e,t){if(!t.length)return[];var r=e.state,n=r.containerClientRect,a=r.targetClientRect,i=a.top,o=a.left,s=r.rootMatrix,l=r.is3d,u=l?4:3,c=T2(s,n,u),f=c[0],d=c[1],h=Dr(r),v=En(h),p=v.minX,g=v.minY,b=gt([p,g],Gn(s,[o-f,i-d],u)).map(function(C){return p2(C)}),y=b[0],S=b[1];return t.map(function(C){var T=C.element.getBoundingClientRect(),D=T.left-f,P=T.top-d,G=P+T.height,W=D+T.width,L=Gn(s,[D,P],u),X=L[0],M=L[1],oe=Gn(s,[W,G],u),re=oe[0],be=oe[1];return fe(fe({},C),{rect:{left:X+y,right:re+y,top:M+S,bottom:be+S,center:(X+re)/2+y,middle:(M+be)/2+S}})})}function ki(e){var t=e.state,r=t.container,n=e.props.snapContainer||r;if(t.snapContainer===n&&t.guidelines&&t.guidelines.length)return!1;var a=t.containerClientRect,i={left:0,top:0,bottom:0,right:0};if(r!==n){var o=Un(n,!0);if(o){var s=Ta(o),l=Du(t,[s.left-a.left,s.top-a.top]),u=Du(t,[s.right-a.right,s.bottom-a.bottom]);i.left=Et(l[0],1e-5),i.top=Et(l[1],1e-5),i.right=Et(u[0],1e-5),i.bottom=Et(u[1],1e-5)}}return t.snapContainer=n,t.snapOffset=i,t.guidelines=ks(e),t.enableSnap=!0,!0}function af(e,t,r,n,a,i){var o=Mn(e,t,r,i?4:3),s=tr(o,n);return ll(o,gt(a,s))}function a_(e,t,r,n,a,i){var o=i.fixedDirection,s=I2(r,o,n),l=hl(e,t,r,n),u=xt(xt([],Z2(e,t,s,n,a,i),!0),tf(e,l,i),!0),c=Wi(u,0),f=Wi(u,1);return{width:{isBound:c.isBound,offset:c.offset[0]},height:{isBound:f.isBound,offset:f.offset[1]}}}function i_(e,t,r,n,a,i,o,s,l){var u=tr(t,o),c=mo(e,s,{vertical:[u[0]],horizontal:[u[1]]}),f=c.horizontal.offset,d=c.vertical.offset;if(Et(d,bs)||Et(f,bs)){var h=un({datas:l,distX:-d,distY:-f}),v=h[0],p=h[1],g=Math.min(a||1/0,r+o[0]*v),b=Math.min(i||1/0,n+o[1]*p);return[g-r,b-n]}return[0,0]}function of(e,t,r,n,a,i,o,s){for(var l=Dr(e.state),u=e.props.keepRatio,c=0,f=0,d=0;d<2;++d){var h=t(c,f),v=a_(e,h,a,u,o,s),p=v.width,g=v.height,b=p.isBound,y=g.isBound,S=p.offset,C=g.offset;if(d===1&&(b||(S=0),y||(C=0)),d===0&&o&&!b&&!y)return[0,0];if(u){var T=Math.abs(S)*(r?1/r:1),D=Math.abs(C)*(n?1/n:1),P=b&&y?T<D:y||!b&&T<D;P?S=r*C/n:C=n*S/r}c+=S,f+=C}if(a[0]&&a[1]){var G=J2(e,l,a,i,s),W=G.maxWidth,L=G.maxHeight,X=i_(e,t(c,f).map(function(re){return re.map(function(be){return Et(be,bs)})}),r+c,n+f,W,L,a,o,s),S=X[0],C=X[1];c+=S,f+=C}return[c,f]}function o_(e,t,r){if(!ba(e,"rotatable"))return{isSnap:!1,rotation:r};var n=t.pos1,a=t.pos2,i=t.pos3,o=t.pos4,s=t.origin,l=r*Math.PI/180,u=[n,a,i,o].map(function(h){return gt(h,s)}),c=u.map(function(h){return ai(h,l)}),f=xt(xt([],H2(e,u,c,s,r),!0),$2(e,u,c,s,r),!0);f.sort(function(h,v){return Math.abs(h-r)-Math.abs(v-r)});var d=f.length>0;return{isSnap:d,rotation:d?f[0]:r}}function s_(e,t,r,n,a,i,o){if(!ba(e,"resizable"))return[0,0];var s=o.fixedDirection,l=o.nextAllMatrix,u=e.state,c=u.allMatrix,f=u.is3d;return of(e,function(d,h){return af(l||c,t+d,r+h,s,a,f)},t,r,n,a,i,o)}function l_(e,t,r,n,a){if(!ba(e,"scalable"))return[0,0];var i=a.startOffsetWidth,o=a.startOffsetHeight,s=a.fixedPosition,l=a.fixedDirection,u=a.is3d,c=of(e,function(f,d){return af(Jm(a,At(t,[f/i,d/o])),i,o,l,s,u)},i,o,r,s,n,a);return[c[0]/i,c[1]/o]}function u_(e,t){t.absolutePoses=Dr(e.state)}function Vu(e){var t=[];return e.forEach(function(r){r.guidelineInfos.forEach(function(n){var a=n.guideline;t.indexOf(a)>-1||t.push(a)})}),t}function Hu(e,t,r,n,a,i){var o=gl(go(e,i),t,r),s=o.vertical,l=o.horizontal;s.forEach(function(d){d.isBound&&n.push({type:"bounds",pos:d.pos})}),l.forEach(function(d){d.isBound&&a.push({type:"bounds",pos:d.pos})});var u=N2(e),c=u.vertical,f=u.horizontal;c.forEach(function(d){dn(n,function(h){var v=h.type,p=h.pos;return v==="bounds"&&p===d})>=0||n.push({type:"bounds",pos:d})}),f.forEach(function(d){dn(a,function(h){var v=h.type,p=h.pos;return v==="bounds"&&p===d})>=0||a.push({type:"bounds",pos:d})})}var c_=cl("",["resizable","scalable"]),f_={name:"snappable",dragRelation:"strong",props:{snappable:[Boolean,Array],snapContainer:Object,snapDirections:[Boolean,Object],elementSnapDirections:[Boolean,Object],snapGap:Boolean,snapGridWidth:Number,snapGridHeight:Number,isDisplaySnapDigit:Boolean,isDisplayInnerSnapDigit:Boolean,snapDigit:Number,snapThreshold:Number,snapRenderThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object,snapDistFormat:Function,maxSnapElementGuidelineDistance:Number,maxSnapElementGapDistance:Number},events:{onSnap:"snap"},css:[`:host {
    --bounds-color: #d66;
}
.guideline {
    pointer-events: none;
    z-index: 2;
}
.guideline.bounds {
    background: #d66;
    background: var(--bounds-color);
}
.guideline-group {
    position: absolute;
    top: 0;
    left: 0;
}
.guideline-group .size-value {
    position: absolute;
    color: #f55;
    font-size: 12px;
    font-weight: bold;
}
.guideline-group.horizontal .size-value {
    transform-origin: 50% 100%;
    transform: translateX(-50%);
    left: 50%;
    bottom: 5px;
}
.guideline-group.vertical .size-value {
    transform-origin: 0% 50%;
    top: 50%;
    transform: translateY(-50%);
    left: 5px;
}
.guideline.gap {
    background: #f55;
}
.size-value.gap {
    color: #f55;
}
`],render:function(e,t){var r=e.state,n=r.top,a=r.left,i=r.pos1,o=r.pos2,s=r.pos3,l=r.pos4,u=r.snapRenderInfo,c=e.props.snapRenderThreshold,f=c===void 0?1:c;if(!u||!u.render||!ba(e,""))return[];r.guidelines=ks(e);var d=Math.min(i[0],o[0],s[0],l[0]),h=Math.min(i[1],o[1],s[1],l[1]),v=u.externalPoses||[],p=Dr(e.state),g=[],b=[],y=[],S=[],C=[],T=Vr(p),D=T.width,P=T.height,G=T.top,W=T.left,L=T.bottom,X=T.right,M={left:W,right:X,top:G,bottom:L,center:(W+X)/2,middle:(G+L)/2},oe=v.length>0,re=oe?Vr(v):{};if(!u.request){if(u.direction&&C.push(A2(e,p,u.direction,f)),u.snap){var be=Vr(p);u.center&&(be.middle=(be.top+be.bottom)/2,be.center=(be.left+be.right)/2),C.push(Au(e,be,f))}oe&&(u.center&&(re.middle=(re.top+re.bottom)/2,re.center=(re.left+re.right)/2),C.push(Au(e,re,f))),C.forEach(function(Ne){var Me=Ne.vertical.posInfos,Pe=Ne.horizontal.posInfos;g.push.apply(g,Me.filter(function(Se){var ve=Se.guidelineInfos;return ve.some(function(j){var we=j.guideline;return!we.hide})}).map(function(Se){return{type:"snap",pos:Se.pos}})),b.push.apply(b,Pe.filter(function(Se){var ve=Se.guidelineInfos;return ve.some(function(j){var we=j.guideline;return!we.hide})}).map(function(Se){return{type:"snap",pos:Se.pos}})),y.push.apply(y,Vu(Me)),S.push.apply(S,Vu(Pe))})}Hu(e,[W,X],[G,L],g,b),oe&&Hu(e,[re.left,re.right],[re.top,re.bottom],g,b,u.externalBounds);var ze=xt(xt([],y,!0),S,!0),Ue=ze.filter(function(Ne){return Ne.element&&!Ne.gapRects}),Ge=ze.filter(function(Ne){return Ne.gapRects}).sort(function(Ne,Me){return Ne.gap-Me.gap});return ft(e,"onSnap",{guidelines:ze.filter(function(Ne){var Me=Ne.element;return!Me}),elements:Ue,gaps:Ge},!0),xt(xt(xt(xt(xt(xt([],X2(e,Ue,[d,h],M,t),!0),Y2(e,Ge,[d,h],M,t),!0),$u(e,"horizontal",S,[a,n],M,t),!0),$u(e,"vertical",y,[a,n],M,t),!0),Fu(e,"horizontal",b,d,n,D,0,t),!0),Fu(e,"vertical",g,h,a,P,1,t),!0)},dragStart:function(e,t){e.state.snapRenderInfo={request:t.isRequest,snap:!0,center:!0},ki(e)},drag:function(e){var t=e.state;ki(e)||(t.guidelines=ks(e)),t.snapRenderInfo&&(t.snapRenderInfo.render=!0)},pinchStart:function(e){this.unset(e)},dragEnd:function(e){this.unset(e)},dragControlCondition:function(e,t){if(c_(e,t)||Rs(e,t))return!0;if(!t.isRequest&&t.inputEvent)return cr(t.inputEvent.target,bt("snap-control"))},dragControlStart:function(e){e.state.snapRenderInfo=null,ki(e)},dragControl:function(e){this.drag(e)},dragControlEnd:function(e){this.unset(e)},dragGroupStart:function(e,t){this.dragStart(e,t)},dragGroup:function(e){this.drag(e)},dragGroupEnd:function(e){this.unset(e)},dragGroupControlStart:function(e){e.state.snapRenderInfo=null,ki(e)},dragGroupControl:function(e){this.drag(e)},dragGroupControlEnd:function(e){this.unset(e)},unset:function(e){var t=e.state;t.enableSnap=!1,t.guidelines=[],t.snapRenderInfo=null,t.elementRects=[]}};function sf(e,t,r,n){var a=e.getState(),i=a.renderPoses,o=a.rotation,s=a.direction,l=Yn(e.props,t).zoom,u=s>0?1:-1,c=o/Math.PI*180,f={},d=e.renderState;d.renderDirectionMap||(d.renderDirectionMap={});var h=d.renderDirectionMap;return r.forEach(function(v){var p=v.dir;f[p]=!0}),r.map(function(v){var p=v.data,g=v.classNames,b=v.dir,y=al[b];if(!y||!f[b])return null;h[b]=!0;var S=(Et(c,15)+u*Cc[b]+720)%180,C={};return ma(p).forEach(function(T){C["data-".concat(T)]=p[T]}),n.createElement("div",fe({className:bt.apply(void 0,xt(["control","direction",b,t],g,!1)),"data-rotation":S,"data-direction":b},C,{key:"direction-".concat(b),style:sl.apply(void 0,xt([o,l],y.map(function(T){return i[T]}),!1))}))})}function lf(e,t,r,n){var a=Yn(e.props,r).renderDirections,i=a===void 0?t:a;if(!i)return[];var o=i===!0?nl:i;return sf(e,r,o.map(function(s){return{data:{},classNames:[],dir:s}}),n)}function d_(e,t){var r=e.renderState;r.renderDirectionMap||(r.renderDirectionMap={});var n=e.getState(),a=n.renderPoses,i=n.rotation,o=n.direction,s=r.renderDirectionMap,l=e.props.zoom,u=o>0?1:-1,c=i/Math.PI*180;return ma(s).map(function(f){var d=al[f];if(!d)return null;var h=(Et(c,15)+u*Cc[f]+720)%180;return t.createElement("div",{className:bt("around-control"),"data-rotation":h,"data-direction":f,key:"direction-around-".concat(f),style:sl.apply(void 0,xt([i,l],d.map(function(v){return a[v]}),!1))})})}function Xa(e,t,r,n,a,i){for(var o=[],s=6;s<arguments.length;s++)o[s-6]=arguments[s];var l=rr(r,n),u=t?Et(l/Math.PI*180,15)%180:-1;return e.createElement("div",{key:"line-".concat(i),className:bt.apply(void 0,xt(["line","direction",t?"edge":"",t],o,!1)),"data-rotation":u,"data-line-key":i,"data-direction":t,style:ka(r,n,a,l)})}function uf(e,t,r,n,a){var i=r===!0?Wm:r;return i.map(function(o,s){var l=al[o],u=l[0],c=l[1];if(c!=null)return Xa(e,o,n[u],n[c],a,"".concat(t,"Edge").concat(s),t)}).filter(Boolean)}function cf(e){return function(t,r){var n=Yn(t.props,e).edge;return n&&(n===!0||n.length)?xt(xt([],uf(r,e,n,t.getState().renderPoses,t.props.zoom),!0),v_(t,e,r),!0):ff(t,e,r)}}function ff(e,t,r){return lf(e,nl,t,r)}function v_(e,t,r){return lf(e,["nw","ne","sw","se"],t,r)}var Sr={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number,startDragRotate:Number,edgeDraggable:Boolean},events:{onDragStart:"dragStart",onDrag:"drag",onDragEnd:"dragEnd",onDragGroupStart:"dragGroupStart",onDragGroup:"dragGroup",onDragGroupEnd:"dragGroupEnd"},requestStyle:function(){return["left","top","right","bottom"]},render:function(e,t){var r=e.props,n=r.throttleDragRotate,a=r.zoom,i=e.getState(),o=i.dragInfo,s=i.beforeOrigin;if(!n||!o)return[];var l=o.dist;if(!l[0]&&!l[1])return[];var u=jr(l),c=rr(l,[0,0]);return[t.createElement("div",{className:bt("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(u,"px"),transform:"translate(".concat(s[0],"px, ").concat(s[1],"px) rotate(").concat(c,"rad) scaleY(").concat(a,")")}})]},dragStart:function(e,t){var r=t.datas,n=t.parentEvent,a=t.parentGesto,i=e.state,o=i.gestos,s=i.style;if(o.draggable)return!1;o.draggable=a||e.targetGesto,r.datas={},r.left=parseFloat(s.left||"")||0,r.top=parseFloat(s.top||"")||0,r.bottom=parseFloat(s.bottom||"")||0,r.right=parseFloat(s.right||"")||0,r.startValue=[0,0],Qn(e,t),fo(t,"translate"),u_(e,r),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0];var l=Mt(e,t,fe({set:function(c){r.startValue=c}},co(t))),u=n||ft(e,"onDragStart",l);return u!==!1?(r.isDrag=!0,e.state.dragInfo={startRect:e.getRect(),dist:[0,0]}):(o.draggable=null,r.isPinch=!1),r.isDrag?l:!1},drag:function(e,t){if(t){lo(t,"translate");var r=t.datas,n=t.parentEvent,a=t.parentFlag,i=t.isPinch,o=t.isRequest,s=t.deltaOffset,l=t.distX,u=t.distY,c=r.isDrag,f=r.prevDist,d=r.prevBeforeDist,h=r.startValue;if(c){s&&(l+=s[0],u+=s[1]);var v=e.props,p=v.parentMoveable,g=n?0:v.throttleDrag||0,b=n?0:v.throttleDragRotate||0,y=0,S=!1,C=!1,T=!1,D=!1;if(!n&&b>0&&(l||u)){var P=v.startDragRotate||0,G=Et(P+rr([0,0],[l,u])*180/Math.PI,b)-P,W=u*Math.abs(Math.cos((G-90)/180*Math.PI)),L=l*Math.abs(Math.cos(G/180*Math.PI)),X=jr([L,W]);y=G*Math.PI/180,l=X*Math.cos(y),u=X*Math.sin(y)}if(!i&&!n&&!a){var M=q2(e,l,u,b,o||s,r),oe=M[0],re=M[1];S=oe.isSnap,C=oe.isBound,T=re.isSnap,D=re.isBound;var be=oe.offset,ze=re.offset;l+=be,u+=ze}var Ue=At(Tc({datas:r,distX:l,distY:u}),h),Ge=At(Um({datas:r,distX:l,distY:u}),h);mu(Ge,Cr),mu(Ue,Cr),b||(!S&&!C&&(Ge[0]=Et(Ge[0],g),Ue[0]=Et(Ue[0],g)),!T&&!D&&(Ge[1]=Et(Ge[1],g),Ue[1]=Et(Ue[1],g)));var Ne=gt(Ue,h),Me=gt(Ge,h),Pe=gt(Me,f),Se=gt(Ne,d);r.prevDist=Me,r.prevBeforeDist=Ne,r.passDelta=Pe,r.passDist=Me;var ve=r.left+Ne[0],j=r.top+Ne[1],we=r.right-Ne[0],A=r.bottom-Ne[1],F=uo(r,"translate(".concat(Ge[0],"px, ").concat(Ge[1],"px)"),"translate(".concat(Me[0],"px, ").concat(Me[1],"px)"));if(il(t,F),e.state.dragInfo.dist=n?[0,0]:Me,!(!n&&!p&&Pe.every(function(De){return!De})&&Se.some(function(De){return!De}))){var _=e.state,Y=_.width,ce=_.height,xe=Mt(e,t,fe({transform:F,dist:Me,delta:Pe,translate:Ge,beforeDist:Ne,beforeDelta:Se,beforeTranslate:Ue,left:ve,top:j,right:we,bottom:A,width:Y,height:ce,isPinch:i},wr({transform:F},t)));return!n&&ft(e,"onDrag",xe),xe}}}},dragAfter:function(e,t){var r=t.datas,n=r.deltaOffset;return n[0]||n[1]?(r.deltaOffset=[0,0],this.drag(e,fe(fe({},t),{deltaOffset:n}))):!1},dragEnd:function(e,t){var r=t.parentEvent,n=t.datas;if(e.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var a=Fr(e,t,{});return!r&&ft(e,"onDragEnd",a),a}},dragGroupStart:function(e,t){var r=t.datas,n=t.clientX,a=t.clientY,i=this.dragStart(e,t);if(!i)return!1;var o=Ho(e,this,"dragStart",[n||0,a||0],t,!1,"draggable"),s=fe(fe({},i),{targets:e.props.targets,events:o}),l=ft(e,"onDragGroupStart",s);return r.isDrag=l!==!1,r.isDrag?i:!1},dragGroup:function(e,t){var r=t.datas;if(r.isDrag){var n=this.drag(e,t),a=t.datas.passDelta,i=Ho(e,this,"drag",a,t,!1,"draggable");if(n){var o=fe({targets:e.props.targets,events:i},n);return ft(e,"onDragGroup",o),o}}},dragGroupEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isDrag){this.dragEnd(e,t);var a=Ho(e,this,"dragEnd",[0,0],t,!1,"draggable");return ft(e,"onDragGroupEnd",Fr(e,t,{targets:e.props.targets,events:a})),r}},request:function(e){var t={},r=e.getRect(),n=0,a=0;return{isControl:!1,requestStart:function(){return{datas:t}},request:function(i){return"x"in i?n=i.x-r.left:"deltaX"in i&&(n+=i.deltaX),"y"in i?a=i.y-r.top:"deltaY"in i&&(a+=i.deltaY),{datas:t,distX:n,distY:a}},requestEnd:function(){return{datas:t,isDrag:!0}}}},unset:function(e){e.state.gestos.draggable=null,e.state.dragInfo=null}},Gu=cl("resizable"),Ts={name:"resizable",ableGroup:"size",canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,keepRatio:Boolean,resizeFormat:Function,keepRatioFinally:Boolean,edge:Boolean,checkResizableError:Boolean},events:{onResizeStart:"resizeStart",onBeforeResize:"beforeResize",onResize:"resize",onResizeEnd:"resizeEnd",onResizeGroupStart:"resizeGroupStart",onBeforeResizeGroup:"beforeResizeGroup",onResizeGroup:"resizeGroup",onResizeGroupEnd:"resizeGroupEnd"},render:cf("resizable"),dragControlCondition:Gu,viewClassName:ul("resizable"),dragControlStart:function(e,t){var r,n=t.inputEvent,a=t.isPinch,i=t.isGroup,o=t.parentDirection,s=t.parentGesto,l=t.datas,u=t.parentFixedDirection,c=t.parentEvent,f=Gc(o,a,n,l),d=e.state,h=d.target,v=d.width,p=d.height,g=d.gestos;if(!f||!h||g.resizable)return!1;g.resizable=s||e.controlGesto,!a&&Qn(e,t),l.datas={},l.direction=f,l.startOffsetWidth=v,l.startOffsetHeight=p,l.prevWidth=0,l.prevHeight=0,l.minSize=[0,0],l.startWidth=d.inlineCSSWidth||d.cssWidth,l.startHeight=d.inlineCSSHeight||d.cssHeight,l.maxSize=[1/0,1/0],i||(l.minSize=[d.minOffsetWidth,d.minOffsetHeight],l.maxSize=[d.maxOffsetWidth,d.maxOffsetHeight]);var b=e.props.transformOrigin||"% %";l.transformOrigin=b&&Lr(b)?b.split(" "):b,l.startOffsetMatrix=d.offsetMatrix,l.startTransformOrigin=d.transformOrigin,l.isWidth=(r=t==null?void 0:t.parentIsWidth)!==null&&r!==void 0?r:!f[0]&&!f[1]||f[0]||!f[1];function y(W){l.ratio=W&&isFinite(W)?W:0}l.startPositions=Dr(e.state);function S(W){l.fixedDirection=W,l.fixedPosition=tr(l.startPositions,W)}function C(W){var L=e.state,X=L.width,M=L.height;l.fixedPosition=W,l.fixedDirection=Bc(W,X,M)}function T(W){l.minSize=[Yt("".concat(W[0]),0)||0,Yt("".concat(W[1]),0)||0]}function D(W){var L=[W[0]||1/0,W[1]||1/0];(!ts(L[0])||isFinite(L[0]))&&(L[0]=Yt("".concat(L[0]),0)||1/0),(!ts(L[1])||isFinite(L[1]))&&(L[1]=Yt("".concat(L[1]),0)||1/0),l.maxSize=L}y(v/p),S(u||[-f[0],-f[1]]),l.setFixedDirection=S,l.setFixedPosition=C,l.setMin=T,l.setMax=D;var P=Mt(e,t,{direction:f,startRatio:l.ratio,set:function(W){var L=W[0],X=W[1];l.startWidth=L,l.startHeight=X},setMin:T,setMax:D,setRatio:y,setFixedDirection:S,setFixedPosition:C,setOrigin:function(W){l.transformOrigin=W},dragStart:Sr.dragStart(e,new ua().dragStart([0,0],t))}),G=c||ft(e,"onResizeStart",P);return l.startFixedDirection=l.fixedDirection,l.startFixedPosition=l.fixedPosition,G!==!1&&(l.isResize=!0,e.state.snapRenderInfo={request:t.isRequest,direction:f}),l.isResize?P:!1},dragControl:function(e,t){var r,n=t.datas,a=t.parentFlag,i=t.isPinch,o=t.parentKeepRatio,s=t.dragClient,l=t.parentDist,u=t.isRequest,c=t.isGroup,f=t.parentEvent,d=t.resolveMatrix,h=n.isResize,v=n.transformOrigin,p=n.startWidth,g=n.startHeight,b=n.prevWidth,y=n.prevHeight,S=n.minSize,C=n.maxSize,T=n.ratio,D=n.startOffsetWidth,P=n.startOffsetHeight,G=n.isWidth;if(!h)return;if(d){var W=e.state.is3d,L=n.startOffsetMatrix,X=n.startTransformOrigin,M=W?4:3,oe=el(Dc(t)),re=Math.sqrt(oe.length);M!==re&&(oe=an(oe,re,M));var be=li(L,oe,X,M),ze=Mn(be,D,P,M);n.startPositions=ze,n.nextTargetMatrix=oe,n.nextAllMatrix=be}var Ue=Yn(e.props,"resizable"),Ge=Ue.resizeFormat,Ne=Ue.throttleResize,Me=Ne===void 0?a?0:1:Ne,Pe=Ue.parentMoveable,Se=Ue.keepRatioFinally,ve=n.direction,j=ve,we=0,A=0;!ve[0]&&!ve[1]&&(j=[1,1]);var F=T&&(o??Ue.keepRatio)||!1;function _(){var pe=n.fixedDirection,me=qc(j,F,n,t);we=me.distWidth,A=me.distHeight;var J=j[0]-pe[0]||F?Math.max(D+we,Cr):D,$e=j[1]-pe[1]||F?Math.max(P+A,Cr):P;return F&&D&&P&&(G?$e=J/T:J=$e*T),[J,$e]}var Y=_(),ce=Y[0],xe=Y[1];f||(n.setFixedDirection(n.fixedDirection),ft(e,"onBeforeResize",Mt(e,t,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(pe){var me;return n.setFixedDirection(pe),me=_(),ce=me[0],xe=me[1],[ce,xe]},setFixedPosition:function(pe){var me;return n.setFixedPosition(pe),me=_(),ce=me[0],xe=me[1],[ce,xe]},boundingWidth:ce,boundingHeight:xe,setSize:function(pe){ce=pe[0],xe=pe[1]}},!0)));var De=s;s||(!a&&i?De=Pc(e,[0,0]):De=n.fixedPosition);var He=[0,0];i||(He=s_(e,ce,xe,ve,De,u,n)),l&&(!l[0]&&(He[0]=0),!l[1]&&(He[1]=0));function Ze(){var pe;Ge&&(pe=Ge([ce,xe]),ce=pe[0],xe=pe[1]),ce=Et(ce,Me),xe=Et(xe,Me)}if(F){j[0]&&j[1]&&He[0]&&He[1]&&(Math.abs(He[0])>Math.abs(He[1])?He[1]=0:He[0]=0);var je=!He[0]&&!He[1];je&&Ze(),j[0]&&!j[1]||He[0]&&!He[1]||je&&G?(ce+=He[0],xe=ce/T):(!j[0]&&j[1]||!He[0]&&He[1]||je&&!G)&&(xe+=He[1],ce=xe*T)}else ce+=He[0],xe+=He[1],ce=Math.max(0,ce),xe=Math.max(0,xe);r=Tg([ce,xe],S,C,F?T:!1),ce=r[0],xe=r[1],Ze(),F&&(c||Se)&&(G?xe=ce/T:ce=xe*T),we=ce-D,A=xe-P;var Fe=[we-b,A-y];n.prevWidth=we,n.prevHeight=A;var pt=r2(e,ce,xe,De,v,n);if(!(!Pe&&Fe.every(function(pe){return!pe})&&pt.every(function(pe){return!pe}))){var Je=Sr.drag(e,si(t,e.state,pt,!!i,!1,"draggable")),at=Je.transform,Ke=p+we,yt=g+A,V=Mt(e,t,fe({width:Ke,height:yt,offsetWidth:Math.round(ce),offsetHeight:Math.round(xe),startRatio:T,boundingWidth:ce,boundingHeight:xe,direction:ve,dist:[we,A],delta:Fe,isPinch:!!i,drag:Je},Xc({style:{width:"".concat(Ke,"px"),height:"".concat(yt,"px")},transform:at},Je,t)));return!f&&ft(e,"onResize",V),V}},dragControlAfter:function(e,t){var r=t.datas,n=r.isResize,a=r.startOffsetWidth,i=r.startOffsetHeight,o=r.prevWidth,s=r.prevHeight;if(!(!n||e.props.checkResizableError===!1)){var l=e.state,u=l.width,c=l.height,f=u-(a+o),d=c-(i+s),h=Math.abs(f)>3,v=Math.abs(d)>3;if(h&&(r.startWidth+=f,r.startOffsetWidth+=f,r.prevWidth+=f),v&&(r.startHeight+=d,r.startOffsetHeight+=d,r.prevHeight+=d),h||v)return this.dragControl(e,t)}},dragControlEnd:function(e,t){var r=t.datas,n=t.parentEvent;if(r.isResize){r.isResize=!1;var a=Fr(e,t,{});return!n&&ft(e,"onResizeEnd",a),a}},dragGroupControlCondition:Gu,dragGroupControlStart:function(e,t){var r=t.datas,n=this.dragControlStart(e,fe(fe({},t),{isGroup:!0}));if(!n)return!1;var a=qr(e,"resizable",t);function i(v,p){var g=r.fixedDirection,b=r.fixedPosition,y=p.datas.startPositions||Dr(v.state),S=tr(y,g),C=gr(la(-e.rotation/180*Math.PI,3),[S[0]-b[0],S[1]-b[1],1],3),T=C[0],D=C[1];return p.datas.originalX=T,p.datas.originalY=D,p}var o=r.startOffsetWidth,s=r.startOffsetHeight;function l(){var v=r.minSize;a.forEach(function(p){var g=p.datas,b=g.minSize,y=g.startOffsetWidth,S=g.startOffsetHeight,C=o*(y?b[0]/y:0),T=s*(S?b[1]/S:0);v[0]=Math.max(v[0],C),v[1]=Math.max(v[1],T)})}function u(){var v=r.maxSize;a.forEach(function(p){var g=p.datas,b=g.maxSize,y=g.startOffsetWidth,S=g.startOffsetHeight,C=o*(y?b[0]/y:0),T=s*(S?b[1]/S:0);v[0]=Math.min(v[0],C),v[1]=Math.min(v[1],T)})}var c=fn(e,this,"dragControlStart",t,function(v,p){return i(v,p)});l(),u();var f=function(v){n.setFixedDirection(v),c.forEach(function(p,g){p.setFixedDirection(v),i(p.moveable,a[g])})};r.setFixedDirection=f;var d=fe(fe({},n),{targets:e.props.targets,events:c.map(function(v){return fe(fe({},v),{setMin:function(p){v.setMin(p),l()},setMax:function(p){v.setMax(p),u()}})}),setFixedDirection:f,setMin:function(v){n.setMin(v),l()},setMax:function(v){n.setMax(v),u()}}),h=ft(e,"onResizeGroupStart",d);return r.isResize=h!==!1,r.isResize?n:!1},dragGroupControl:function(e,t){var r=t.datas;if(r.isResize){var n=Yn(e.props,"resizable");po(e,"onBeforeResize",function(h){ft(e,"onBeforeResizeGroup",Mt(e,t,fe(fe({},h),{targets:n.targets}),!0))});var a=this.dragControl(e,fe(fe({},t),{isGroup:!0}));if(a){var i=a.boundingWidth,o=a.boundingHeight,s=a.dist,l=n.keepRatio,u=[i/(i-s[0]),o/(o-s[1])],c=r.fixedPosition,f=fn(e,this,"dragControl",t,function(h,v){var p=gr(la(e.rotation/180*Math.PI,3),[v.datas.originalX*u[0],v.datas.originalY*u[1],1],3),g=p[0],b=p[1];return fe(fe({},v),{parentDist:null,parentScale:u,dragClient:At(c,[g,b]),parentKeepRatio:l})}),d=fe({targets:n.targets,events:f},a);return ft(e,"onResizeGroup",d),d}}},dragGroupControlEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isResize){this.dragControlEnd(e,t);var a=fn(e,this,"dragControlEnd",t),i=Fr(e,t,{targets:e.props.targets,events:a});return ft(e,"onResizeGroupEnd",i),r}},request:function(e){var t={},r=0,n=0,a=e.getRect();return{isControl:!0,requestStart:function(i){var o;return{datas:t,parentDirection:i.direction||[1,1],parentIsWidth:(o=i==null?void 0:i.horizontal)!==null&&o!==void 0?o:!0}},request:function(i){return"offsetWidth"in i?r=i.offsetWidth-a.offsetWidth:"deltaWidth"in i&&(r+=i.deltaWidth),"offsetHeight"in i?n=i.offsetHeight-a.offsetHeight:"deltaHeight"in i&&(n+=i.deltaHeight),{datas:t,parentDist:[r,n],parentKeepRatio:i.keepRatio}},requestEnd:function(){return{datas:t,isDrag:!0}}}},unset:function(e){e.state.gestos.resizable=null}};function Go(e,t,r,n,a){var i=e.props.groupable,o=e.state,s=o.is3d?4:3,l=t.origin,u=ur(e.state.rootMatrix,gt([l[0],l[1]],i?[0,0]:[o.left,o.top]),s),c=At([a.left,a.top],u);t.startAbsoluteOrigin=c,t.prevDeg=rr(c,[r,n])/Math.PI*180,t.defaultDeg=t.prevDeg,t.prevSnapDeg=0,t.loop=0,t.startDist=Ur(c,[r,n])}function Li(e,t,r){var n=r.defaultDeg,a=r.prevDeg,i=a%360,o=Math.floor(a/360);i<0&&(i+=360),i>e&&i>270&&e<90?++o:i<e&&i<90&&e>270&&--o;var s=t*(o*360+e-n);return r.prevDeg=n+s,s}function Wo(e,t,r,n){return Li(rr(n.startAbsoluteOrigin,[e,t])/Math.PI*180,r,n)}function Xo(e,t,r,n,a,i){var o=e.props.throttleRotate,s=o===void 0?0:o,l=r.prevSnapDeg,u=0,c=!1;if(i){var f=o_(e,t,n);c=f.isSnap,u=a+f.rotation}c||(u=Et(a+n,s));var d=u-a;return r.prevSnapDeg=d,[d-l,d,u]}function df(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3];if(e==="none")return[];if(or(e))return e.map(function(p){return df(p,[n,a,i,o],r)[0]});var s=(e||"top").split("-"),l=s[0],u=s[1],c=[n,a];l==="left"?c=[i,n]:l==="right"?c=[a,o]:l==="bottom"&&(c=[o,i]);var f=[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2],d=Vc(c,r);if(u){var h=u==="top"||u==="left",v=l==="bottom"||l==="left";f=c[h&&!v||!h&&v?0:1]}return[[f,d]]}function Rs(e,t){if(t.isRequest)return t.requestAble==="rotatable";var r=t.inputEvent.target;if(cr(r,bt("rotation-control"))||cr(r,bt("around-control"))||cr(r,bt("control"))&&cr(r,bt("rotatable")))return!0;var n=e.props.rotationTarget;return n?fl(n,!0).some(function(a){return a?r===a||r.contains(a):!1}):!1}var p_=nl.map(function(e){var t="",r="",n="center",a="center";return e.indexOf("n")>-1&&(t="top: -20px;",a="bottom"),e.indexOf("s")>-1&&(t="top: 0px;",a="top"),e.indexOf("w")>-1&&(r="left: -20px;",n="right"),e.indexOf("e")>-1&&(r="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(e,`"] {
        `).concat(r).concat(t,`
        transform-origin: `).concat(n," ").concat(a,`;
    }`)}).join(`
`),h_=`.rotation {
    position: absolute;
    height: 40px;
    width: 1px;
    transform-origin: 50% 100%;
    height: calc(40px * var(--zoom));
    top: auto;
    left: 0;
    bottom: 100%;
    will-change: transform;
}
.rotation .rotation-line {
    display: block;
    width: 100%;
    height: 100%;
    transform-origin: 50% 50%;
}
.rotation .rotation-control {
    border-color: #4af;
    border-color: var(--moveable-color);
    background:#fff;
    cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
    cursor: alias;
}
.around-control {
    position: absolute;
    will-change: transform;
    width: 20px;
    height: 20px;
    left: -10px;
    top: -10px;
    box-sizing: border-box;
    background: transparent;
    z-index: 8;
    cursor: alias;
    transform-origin: center center;
}
.rotatable.direction.control.move {
    cursor: move;
}
`.concat(p_,`
`),g_={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number,renderDirections:Object,rotationTarget:Object,rotateAroundControls:Boolean,edge:Boolean,resolveAblesWithRotatable:Object},events:{onRotateStart:"rotateStart",onBeforeRotate:"beforeRotate",onRotate:"rotate",onRotateEnd:"rotateEnd",onRotateGroupStart:"rotateGroupStart",onBeforeRotateGroup:"beforeRotateGroup",onRotateGroup:"rotateGroup",onRotateGroupEnd:"rotateGroupEnd"},css:[h_],viewClassName:function(e){return e.isDragging("rotatable")?bt("view-rotation-dragging"):""},render:function(e,t){var r=Yn(e.props,"rotatable"),n=r.rotatable,a=r.rotationPosition,i=r.zoom,o=r.renderDirections,s=r.rotateAroundControls,l=r.resolveAblesWithRotatable,u=e.getState(),c=u.renderPoses,f=u.direction;if(!n)return null;var d=df(a,c,f),h=[];if(d.forEach(function(b,y){var S=b[0],C=b[1];h.push(t.createElement("div",{key:"rotation".concat(y),className:bt("rotation"),style:{transform:"translate(-50%) translate(".concat(S[0],"px, ").concat(S[1],"px) rotate(").concat(C,"rad)")}},t.createElement("div",{className:bt("line rotation-line"),style:{transform:"scaleX(".concat(i,")")}}),t.createElement("div",{className:bt("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(i,")")}})))}),o){var v=ma(l||{}),p={};v.forEach(function(b){l[b].forEach(function(y){p[y]=b})});var g=[];or(o)&&(g=o.map(function(b){var y=p[b];return{data:y?{resolve:y}:{},classNames:y?["move"]:[],dir:b}})),h.push.apply(h,sf(e,"rotatable",g,t))}return s&&h.push.apply(h,d_(e,t)),h},dragControlCondition:Rs,dragControlStart:function(e,t){var r,n,a=t.datas,i=t.clientX,o=t.clientY,s=t.parentRotate,l=t.parentFlag,u=t.isPinch,c=t.isRequest,f=e.state,d=f.target,h=f.left,v=f.top,p=f.direction,g=f.beforeDirection,b=f.targetTransform,y=f.moveableClientRect,S=f.offsetMatrix,C=f.targetMatrix,T=f.allMatrix,D=f.width,P=f.height;if(!c&&!d)return!1;var G=e.getRect();a.rect=G,a.transform=b,a.left=h,a.top=v;var W=function(we){var A=e.state,F=A.allMatrix,_=A.is3d,Y=A.width,ce=A.height,xe=Bc(we,Y,ce);a.fixedDirection=xe,a.fixedPosition=ur(F,we,_?4:3),Pe&&Pe.setFixedPosition(we)},L=function(we){a.fixedDirection=we,a.fixedPosition=Oc(e,we),Pe&&Pe.setFixedDirection(we)},X=i,M=o;if(c||u||l){var oe=s||0;a.beforeInfo={origin:G.beforeOrigin,prevDeg:oe,defaultDeg:oe,prevSnapDeg:0,startDist:0},a.afterInfo=fe(fe({},a.beforeInfo),{origin:G.origin}),a.absoluteInfo=fe(fe({},a.beforeInfo),{origin:G.origin,startValue:oe})}else{var re=(n=t.inputEvent)===null||n===void 0?void 0:n.target;if(re){var be=re.getAttribute("data-direction")||"",ze=Xm[be];if(ze){a.isControl=!0,a.isAroundControl=cr(re,bt("around-control")),a.controlDirection=ze;var Ue=re.getAttribute("data-resolve");Ue&&(a.resolveAble=Ue);var Ge=v2(f.rootMatrix,f.renderPoses,y);r=tr(Ge,ze),X=r[0],M=r[1]}}a.beforeInfo={origin:G.beforeOrigin},a.afterInfo={origin:G.origin},a.absoluteInfo={origin:G.origin,startValue:G.rotation};var Ne=W;W=function(we){var A=f.is3d?4:3,F=At(vc(C,A),we),_=F[0],Y=F[1],ce=gr(S,Xn([_,Y],A)),xe=gr(T,Xn([we[0],we[1]],A));Ne(we);var De=f.posDelta;a.beforeInfo.origin=gt(ce,De),a.afterInfo.origin=gt(xe,De),a.absoluteInfo.origin=gt(xe,De),Go(e,a.beforeInfo,X,M,y),Go(e,a.afterInfo,X,M,y),Go(e,a.absoluteInfo,X,M,y)},L=function(we){var A=tr([[0,0],[D,0],[0,P],[D,P]],we);W(A)}}a.startClientX=X,a.startClientY=M,a.direction=p,a.beforeDirection=g,a.startValue=0,a.datas={},fo(t,"rotate");var Me=!1,Pe=!1;if(a.isControl&&a.resolveAble){var Se=a.resolveAble;Se==="resizable"&&(Pe=Ts.dragControlStart(e,fe(fe({},new ua("resizable").dragStart([0,0],t)),{parentPosition:a.controlPosition,parentFixedPosition:a.fixedPosition})))}Pe||(Me=Sr.dragStart(e,new ua().dragStart([0,0],t))),W(f.transformOrigin);var ve=Mt(e,t,fe(fe({set:function(we){a.startValue=we*Math.PI/180},setFixedDirection:L,setFixedPosition:W},co(t)),{dragStart:Me,resizeStart:Pe})),j=ft(e,"onRotateStart",ve);return a.isRotate=j!==!1,f.snapRenderInfo={request:t.isRequest},a.isRotate?ve:!1},dragControl:function(e,t){var r,n,a,i=t.datas,o=t.clientDistX,s=t.clientDistY,l=t.parentRotate,u=t.parentFlag,c=t.isPinch,f=t.groupDelta,d=i.beforeDirection,h=i.beforeInfo,v=i.afterInfo,p=i.absoluteInfo,g=i.isRotate,b=i.startValue,y=i.rect,S=i.startClientX,C=i.startClientY;if(g){lo(t,"rotate");var T=Ym(t),D=d*T,P=e.props.parentMoveable,G=0,W,L,X=0,M,oe,re=0,be,ze,Ue=180/Math.PI*b,Ge=p.startValue,Ne=!1,Me=S+o,Pe=C+s;if(!u&&"parentDist"in t){var Se=t.parentDist;W=Se,M=Se,be=Se}else c||u?(W=Li(l,d,h),M=Li(l,D,v),be=Li(l,D,p)):(W=Wo(Me,Pe,d,h),M=Wo(Me,Pe,D,v),be=Wo(Me,Pe,D,p),Ne=!0);if(L=Ue+W,oe=Ue+M,ze=Ge+be,ft(e,"onBeforeRotate",Mt(e,t,{beforeRotation:L,rotation:oe,absoluteRotation:ze,setRotation:function(De){M=De-Ue,W=M,be=M}},!0)),r=Xo(e,y,h,W,Ue,Ne),G=r[0],W=r[1],L=r[2],n=Xo(e,y,v,M,Ue,Ne),X=n[0],M=n[1],oe=n[2],a=Xo(e,y,p,be,Ge,Ne),re=a[0],be=a[1],ze=a[2],!(!re&&!X&&!G&&!P)){var ve=uo(i,"rotate(".concat(oe,"deg)"),"rotate(".concat(M,"deg)")),j=t2(e,M,i),we=gt(At(f||[0,0],j),i.prevInverseDist||[0,0]);i.prevInverseDist=j,i.requestValue=null;var A=Ac(e,ve,we,c,t),F=A,_=Ur([Me,Pe],p.startAbsoluteOrigin)-p.startDist,Y=void 0;if(i.resolveAble==="resizable"){var ce=Ts.dragControl(e,fe(fe({},si(t,e.state,[t.deltaX,t.deltaY],!!c,!1,"resizable")),{resolveMatrix:!0,parentDistance:_}));ce&&(Y=ce,F=Xc(F,ce,t))}var xe=Mt(e,t,fe(fe({delta:X,dist:M,rotate:oe,rotation:oe,beforeDist:W,beforeDelta:G,beforeRotate:L,beforeRotation:L,absoluteDist:be,absoluteDelta:re,absoluteRotate:ze,absoluteRotation:ze,isPinch:!!c,resize:Y},A),F));return ft(e,"onRotate",xe),xe}}},dragControlEnd:function(e,t){var r=t.datas;if(r.isRotate){r.isRotate=!1;var n=Fr(e,t,{});return ft(e,"onRotateEnd",n),n}},dragGroupControlCondition:Rs,dragGroupControlStart:function(e,t){var r=t.datas,n=e.state,a=n.left,i=n.top,o=n.beforeOrigin,s=this.dragControlStart(e,t);if(!s)return!1;s.set(r.beforeDirection*e.rotation);var l=fn(e,this,"dragControlStart",t,function(f,d){var h=f.state,v=h.left,p=h.top,g=h.beforeOrigin,b=At(gt([v,p],[a,i]),gt(g,o));return d.datas.startGroupClient=b,d.datas.groupClient=b,fe(fe({},d),{parentRotate:0})}),u=fe(fe({},s),{targets:e.props.targets,events:l}),c=ft(e,"onRotateGroupStart",u);return r.isRotate=c!==!1,r.isRotate?s:!1},dragGroupControl:function(e,t){var r=t.datas;if(r.isRotate){po(e,"onBeforeRotate",function(u){ft(e,"onBeforeRotateGroup",Mt(e,t,fe(fe({},u),{targets:e.props.targets}),!0))});var n=this.dragControl(e,t);if(n){var a=r.beforeDirection,i=n.beforeDist,o=i/180*Math.PI,s=fn(e,this,"dragControl",t,function(u,c){var f=c.datas.startGroupClient,d=c.datas.groupClient,h=d[0],v=d[1],p=ai(f,o*a),g=p[0],b=p[1],y=[g-h,b-v];return c.datas.groupClient=[g,b],fe(fe({},c),{parentRotate:i,groupDelta:y})});e.rotation=a*n.beforeRotation;var l=fe({targets:e.props.targets,events:s,set:function(u){e.rotation=u},setGroupRotation:function(u){e.rotation=u}},n);return ft(e,"onRotateGroup",l),l}}},dragGroupControlEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isRotate){this.dragControlEnd(e,t);var a=fn(e,this,"dragControlEnd",t),i=Fr(e,t,{targets:e.props.targets,events:a});return ft(e,"onRotateGroupEnd",i),r}},request:function(e){var t={},r=0,n=e.getRotation();return{isControl:!0,requestStart:function(){return{datas:t}},request:function(a){return"deltaRotate"in a?r+=a.deltaRotate:"rotate"in a&&(r=a.rotate-n),{datas:t,parentDist:r}},requestEnd:function(){return{datas:t,isDrag:!0}}}}},Wu=cl("scalable"),m_={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean,edge:Boolean},events:{onScaleStart:"scaleStart",onBeforeScale:"beforeScale",onScale:"scale",onScaleEnd:"scaleEnd",onScaleGroupStart:"scaleGroupStart",onBeforeScaleGroup:"beforeScaleGroup",onScaleGroup:"scaleGroup",onScaleGroupEnd:"scaleGroupEnd"},render:cf("scalable"),dragControlCondition:Wu,viewClassName:ul("scalable"),dragControlStart:function(e,t){var r=t.datas,n=t.isPinch,a=t.inputEvent,i=t.parentDirection,o=Gc(i,n,a,r),s=e.state,l=s.width,u=s.height,c=s.targetTransform,f=s.target,d=s.pos1,h=s.pos2,v=s.pos4;if(!o||!f)return!1;n||Qn(e,t),r.datas={},r.transform=c,r.prevDist=[1,1],r.direction=o,r.startOffsetWidth=l,r.startOffsetHeight=u,r.startValue=[1,1];var p=Ur(d,h),g=Ur(h,v),b=!o[0]&&!o[1]||o[0]||!o[1];r.scaleWidth=p,r.scaleHeight=g,r.scaleXRatio=p/l,r.scaleYRatio=g/u,fo(t,"scale"),r.isWidth=b;function y(D){r.ratio=D&&isFinite(D)?D:0}r.startPositions=Dr(e.state);function S(D){r.fixedDirection=D,r.fixedPosition=tr(r.startPositions,D)}r.setFixedDirection=S,y(Ur(d,h)/Ur(h,v)),S([-o[0],-o[1]]);var C=Mt(e,t,fe(fe({direction:o,set:function(D){r.startValue=D},setRatio:y,setFixedDirection:S},co(t)),{dragStart:Sr.dragStart(e,new ua().dragStart([0,0],t))})),T=ft(e,"onScaleStart",C);return r.startFixedDirection=r.fixedDirection,T!==!1&&(r.isScale=!0,e.state.snapRenderInfo={request:t.isRequest,direction:o}),r.isScale?C:!1},dragControl:function(e,t){lo(t,"scale");var r=t.datas,n=t.parentKeepRatio,a=t.parentFlag,i=t.isPinch,o=t.dragClient,s=t.isRequest,l=r.prevDist,u=r.direction,c=r.startOffsetWidth,f=r.startOffsetHeight,d=r.isScale,h=r.startValue,v=r.isWidth,p=r.ratio;if(!d)return!1;var g=e.props,b=g.throttleScale,y=g.parentMoveable,S=u;!u[0]&&!u[1]&&(S=[1,1]);var C=p&&(n??g.keepRatio)||!1,T=e.state;function D(){var Pe=qc(S,C,r,t),Se=Pe.distWidth,ve=Pe.distHeight,j=c?(c+Se)/c:1,we=f?(f+ve)/f:1;return j=S[0]||C?j*h[0]:h[0],we=S[1]||C?we*h[1]:h[1],j===0&&(j=(l[0]>0?1:-1)*xi),we===0&&(we=(l[1]>0?1:-1)*xi),[j,we]}var P=D();if(!i&&e.props.groupable){var G=T.snapRenderInfo||{},W=G.direction;or(W)&&(W[0]||W[1])&&(T.snapRenderInfo={direction:u,request:t.isRequest})}ft(e,"onBeforeScale",Mt(e,t,{scale:P,setFixedDirection:function(Pe){return r.setFixedDirection(Pe),P=D(),P},startFixedDirection:r.startFixedDirection,setScale:function(Pe){P=Pe}},!0));var L=[P[0]/h[0],P[1]/h[1]],X=o,M=[0,0];if(o||(!a&&i?X=Pc(e,[0,0]):X=r.fixedPosition),i||(M=l_(e,L,u,s,r)),C){S[0]&&S[1]&&M[0]&&M[1]&&(Math.abs(M[0]*c)>Math.abs(M[1]*f)?M[1]=0:M[0]=0);var oe=!M[0]&&!M[1];if(oe&&(v?L[0]=Et(L[0]*h[0],b)/h[0]:L[1]=Et(L[1]*h[1],b)/h[1]),S[0]&&!S[1]||M[0]&&!M[1]||oe&&v){L[0]+=M[0];var re=c*L[0]*h[0]/p;L[1]=re/f/h[1]}else if(!S[0]&&S[1]||!M[0]&&M[1]||oe&&!v){L[1]+=M[1];var be=f*L[1]*h[1]*p;L[0]=be/c/h[0]}}else L[0]+=M[0],L[1]+=M[1],M[0]||(L[0]=Et(L[0]*h[0],b)/h[0]),M[1]||(L[1]=Et(L[1]*h[1],b)/h[1]);L[0]===0&&(L[0]=(l[0]>0?1:-1)*xi),L[1]===0&&(L[1]=(l[1]>0?1:-1)*xi);var ze=[L[0]/l[0],L[1]/l[1]];P=a2(L,h);var Ue=e2(e,L,r.fixedDirection,X,r),Ge=gt(Ue,r.prevInverseDist||[0,0]);if(r.prevDist=L,r.prevInverseDist=Ue,P[0]===l[0]&&P[1]===l[1]&&Ge.every(function(Pe){return!Pe})&&!y)return!1;var Ne=uo(r,"scale(".concat(P.join(", "),")"),"scale(".concat(L.join(", "),")")),Me=Mt(e,t,fe({offsetWidth:c,offsetHeight:f,direction:u,scale:P,dist:L,delta:ze,isPinch:!!i},Ac(e,Ne,Ge,i,t)));return ft(e,"onScale",Me),Me},dragControlEnd:function(e,t){var r=t.datas;if(!r.isScale)return!1;r.isScale=!1;var n=Fr(e,t,{});return ft(e,"onScaleEnd",n),n},dragGroupControlCondition:Wu,dragGroupControlStart:function(e,t){var r=t.datas,n=this.dragControlStart(e,t);if(!n)return!1;var a=qr(e,"resizable",t);function i(c,f){var d=r.fixedDirection,h=r.fixedPosition,v=f.datas.startPositions||Dr(c.state),p=tr(v,d),g=gr(la(-e.rotation/180*Math.PI,3),[p[0]-h[0],p[1]-h[1],1],3),b=g[0],y=g[1];return f.datas.originalX=b,f.datas.originalY=y,f}r.moveableScale=e.scale;var o=fn(e,this,"dragControlStart",t,function(c,f){return i(c,f)}),s=function(c){n.setFixedDirection(c),o.forEach(function(f,d){f.setFixedDirection(c),i(f.moveable,a[d])})};r.setFixedDirection=s;var l=fe(fe({},n),{targets:e.props.targets,events:o,setFixedDirection:s}),u=ft(e,"onScaleGroupStart",l);return r.isScale=u!==!1,r.isScale?l:!1},dragGroupControl:function(e,t){var r=t.datas;if(r.isScale){po(e,"onBeforeScale",function(f){ft(e,"onBeforeScaleGroup",Mt(e,t,fe(fe({},f),{targets:e.props.targets}),!0))});var n=this.dragControl(e,t);if(n){var a=r.moveableScale;e.scale=[n.scale[0]*a[0],n.scale[1]*a[1]];var i=e.props.keepRatio,o=n.dist,s=n.scale,l=r.fixedPosition,u=fn(e,this,"dragControl",t,function(f,d){var h=gr(la(e.rotation/180*Math.PI,3),[d.datas.originalX*o[0],d.datas.originalY*o[1],1],3),v=h[0],p=h[1];return fe(fe({},d),{parentDist:null,parentScale:s,parentKeepRatio:i,dragClient:At(l,[v,p])})}),c=fe({targets:e.props.targets,events:u},n);return ft(e,"onScaleGroup",c),c}}},dragGroupControlEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isScale){this.dragControlEnd(e,t);var a=fn(e,this,"dragControlEnd",t),i=Fr(e,t,{targets:e.props.targets,events:a});return ft(e,"onScaleGroupEnd",i),r}},request:function(){var e={},t=0,r=0;return{isControl:!0,requestStart:function(n){return{datas:e,parentDirection:n.direction||[1,1]}},request:function(n){return t+=n.deltaWidth,r+=n.deltaHeight,{datas:e,parentDist:[t,r],parentKeepRatio:n.keepRatio}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function mn(e,t){return e.map(function(r,n){return Pn(r,t[n],1,2)})}function Xu(e,t,r){var n=rr(e,t),a=rr(e,r),i=a-n;return i>=0?i:i+2*Math.PI}function __(e,t){var r=Xu(e[0],e[1],e[2]),n=Xu(t[0],t[1],t[2]),a=Math.PI;return!(r>=a&&n<=a||r<=a&&n>=a)}var b_={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array,edge:Boolean},events:{onWarpStart:"warpStart",onWarp:"warp",onWarpEnd:"warpEnd"},viewClassName:ul("warpable"),render:function(e,t){var r=e.props,n=r.resizable,a=r.scalable,i=r.warpable,o=r.zoom;if(n||a||!i)return[];var s=e.state,l=s.pos1,u=s.pos2,c=s.pos3,f=s.pos4,d=mn(l,u),h=mn(u,l),v=mn(l,c),p=mn(c,l),g=mn(c,f),b=mn(f,c),y=mn(u,f),S=mn(f,u);return xt([t.createElement("div",{className:bt("line"),key:"middeLine1",style:ka(d,g,o)}),t.createElement("div",{className:bt("line"),key:"middeLine2",style:ka(h,b,o)}),t.createElement("div",{className:bt("line"),key:"middeLine3",style:ka(v,y,o)}),t.createElement("div",{className:bt("line"),key:"middeLine4",style:ka(p,S,o)})],ff(e,"warpable",t),!0)},dragControlCondition:function(e,t){if(t.isRequest)return!1;var r=t.inputEvent.target;return cr(r,bt("direction"))&&cr(r,bt("warpable"))},dragControlStart:function(e,t){var r=t.datas,n=t.inputEvent,a=e.props.target,i=n.target,o=Wc(i,r);if(!o||!a)return!1;var s=e.state,l=s.transformOrigin,u=s.is3d,c=s.targetTransform,f=s.targetMatrix,d=s.width,h=s.height,v=s.left,p=s.top;r.datas={},r.targetTransform=c,r.warpTargetMatrix=u?f:an(f,3,4),r.targetInverseMatrix=dc(nn(r.warpTargetMatrix,4),3,4),r.direction=o,r.left=v,r.top=p,r.poses=[[0,0],[d,0],[0,h],[d,h]].map(function(y){return gt(y,l)}),r.nextPoses=r.poses.map(function(y){var S=y[0],C=y[1];return gr(r.warpTargetMatrix,[S,C,0,1],4)}),r.startValue=Jt(4),r.prevMatrix=Jt(4),r.absolutePoses=Dr(s),r.posIndexes=Rc(o),Qn(e,t),fo(t,"matrix3d"),s.snapRenderInfo={request:t.isRequest,direction:o};var g=Mt(e,t,fe({set:function(y){r.startValue=y}},co(t))),b=ft(e,"onWarpStart",g);return b!==!1&&(r.isWarp=!0),r.isWarp},dragControl:function(e,t){var r=t.datas,n=t.isRequest,a=t.distX,i=t.distY,o=r.targetInverseMatrix,s=r.prevMatrix,l=r.isWarp,u=r.startValue,c=r.poses,f=r.posIndexes,d=r.absolutePoses;if(!l)return!1;if(lo(t,"matrix3d"),ba(e,"warpable")){var h=f.map(function(W){return d[W]});h.length>1&&h.push([(h[0][0]+h[1][0])/2,(h[0][1]+h[1][1])/2]);var v=mo(e,n,{horizontal:h.map(function(W){return W[1]+i}),vertical:h.map(function(W){return W[0]+a})}),p=v.horizontal,g=v.vertical;i-=p.offset,a-=g.offset}var b=un({datas:r,distX:a,distY:i},!0),y=r.nextPoses.slice();if(f.forEach(function(W){y[W]=At(y[W],b)}),!Gm.every(function(W){return __(W.map(function(L){return c[L]}),W.map(function(L){return y[L]}))}))return!1;var S=Js(c[0],c[2],c[1],c[3],y[0],y[2],y[1],y[3]);if(!S.length)return!1;var C=Wt(o,S,4),T=kc(r,C,!0),D=Wt(nn(s,4),T,4);r.prevMatrix=T;var P=Wt(u,T,4),G=uo(r,"matrix3d(".concat(P.join(", "),")"),"matrix3d(".concat(T.join(", "),")"));return il(t,G),ft(e,"onWarp",Mt(e,t,fe({delta:D,matrix:P,dist:T,multiply:Wt,transform:G},wr({transform:G},t)))),!0},dragControlEnd:function(e,t){var r=t.datas,n=t.isDrag;return r.isWarp?(r.isWarp=!1,ft(e,"onWarpEnd",Fr(e,t,{})),n):!1}},y_=bt("area-pieces"),Ti=bt("area-piece"),vf=bt("avoid"),x_=bt("view-dragging");function Yo(e){var t=e.areaElement;if(t){var r=e.state,n=r.width,a=r.height;J0(t,vf),t.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(a,"px")}}function Yu(e){return e.createElement("div",{key:"area_pieces",className:y_},e.createElement("div",{className:Ti}),e.createElement("div",{className:Ti}),e.createElement("div",{className:Ti}),e.createElement("div",{className:Ti}))}var pf={name:"dragArea",props:{dragArea:Boolean,passDragArea:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},render:function(e,t){var r=e.props,n=r.target,a=r.dragArea,i=r.groupable,o=r.passDragArea,s=e.getState(),l=s.width,u=s.height,c=s.renderPoses,f=o?bt("area","pass"):bt("area");if(i)return[t.createElement("div",{key:"area",ref:tn(e,"areaElement"),className:f}),Yu(t)];if(!n||!a)return[];var d=Js([0,0],[l,0],[0,u],[l,u],c[0],c[1],c[2],c[3]),h=d.length?vo(d,!0):"none";return[t.createElement("div",{key:"area",ref:tn(e,"areaElement"),className:f,style:{top:"0px",left:"0px",width:"".concat(l,"px"),height:"".concat(u,"px"),transformOrigin:"0 0",transform:h}}),Yu(t)]},dragStart:function(e,t){var r=t.datas,n=t.clientX,a=t.clientY,i=t.inputEvent;if(!i)return!1;r.isDragArea=!1;var o=e.areaElement,s=e.state,l=s.moveableClientRect,u=s.renderPoses,c=s.rootMatrix,f=s.is3d,d=l.left,h=l.top,v=Vr(u),p=v.left,g=v.top,b=v.width,y=v.height,S=f?4:3,C=Gn(c,[n-d,a-h],S),T=C[0],D=C[1];T-=p,D-=g;var P=[{left:p,top:g,width:b,height:D-10},{left:p,top:g,width:T-10,height:y},{left:p,top:g+D+10,width:b,height:y-D-10},{left:p+T+10,top:g,width:b-T-10,height:y}],G=[].slice.call(o.nextElementSibling.children);P.forEach(function(W,L){G[L].style.cssText="left: ".concat(W.left,"px;top: ").concat(W.top,"px; width: ").concat(W.width,"px; height: ").concat(W.height,"px;")}),Q0(o,vf),s.disableNativeEvent=!0},drag:function(e,t){var r=t.datas,n=t.inputEvent;if(this.enableNativeEvent(e),!n)return!1;r.isDragArea||(r.isDragArea=!0,Yo(e))},dragEnd:function(e,t){this.enableNativeEvent(e);var r=t.inputEvent,n=t.datas;if(!r)return!1;n.isDragArea||Yo(e)},dragGroupStart:function(e,t){return this.dragStart(e,t)},dragGroup:function(e,t){return this.drag(e,t)},dragGroupEnd:function(e,t){return this.dragEnd(e,t)},unset:function(e){Yo(e),e.state.disableNativeEvent=!1},enableNativeEvent:function(e){var t=e.state;t.disableNativeEvent&&Z0(function(){t.disableNativeEvent=!1})}},S_=oi("origin",{render:function(e,t){var r=e.props.zoom,n=e.getState(),a=n.beforeOrigin,i=n.rotation;return[t.createElement("div",{className:bt("control","origin"),style:sl(i,r,a),key:"beforeOrigin"})]}});function w_(e){var t=e.scrollContainer;return[t.scrollLeft,t.scrollTop]}var C_={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number,scrollThrottleTime:Number,getScrollPosition:Function,scrollOptions:Object},events:{onScroll:"scroll",onScrollGroup:"scrollGroup"},dragRelation:"strong",dragStart:function(e,t){var r=e.props,n=r.scrollContainer,a=n===void 0?e.getContainer():n,i=r.scrollOptions,o=new ym,s=Un(a,!0);t.datas.dragScroll=o,e.state.dragScroll=o;var l=t.isControl?"controlGesto":"targetGesto",u=t.targets;o.on("scroll",function(c){var f=c.container,d=c.direction,h=Mt(e,t,{scrollContainer:f,direction:d}),v=u?"onScrollGroup":"onScroll";u&&(h.targets=u),ft(e,v,h)}).on("move",function(c){var f=c.offsetX,d=c.offsetY,h=c.inputEvent;e[l].scrollBy(f,d,h.inputEvent,!0)}).on("scrollDrag",function(c){var f=c.next;f(e[l].getCurrentEvent())}),o.dragStart(t,fe({container:s},i))},checkScroll:function(e,t){var r=t.datas.dragScroll;if(r){var n=e.props,a=n.scrollContainer,i=a===void 0?e.getContainer():a,o=n.scrollThreshold,s=o===void 0?0:o,l=n.scrollThrottleTime,u=l===void 0?0:l,c=n.getScrollPosition,f=c===void 0?w_:c,d=n.scrollOptions;return r.drag(t,fe({container:i,threshold:s,throttleTime:u,getScrollPosition:function(h){return f({scrollContainer:h.container,direction:h.direction})}},d)),!0}},drag:function(e,t){return this.checkScroll(e,t)},dragEnd:function(e,t){t.datas.dragScroll.dragEnd(),t.datas.dragScroll=null},dragControlStart:function(e,t){return this.dragStart(e,fe(fe({},t),{isControl:!0}))},dragControl:function(e,t){return this.drag(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupStart:function(e,t){return this.dragStart(e,fe(fe({},t),{targets:e.props.targets}))},dragGroup:function(e,t){return this.drag(e,fe(fe({},t),{targets:e.props.targets}))},dragGroupEnd:function(e,t){return this.dragEnd(e,fe(fe({},t),{targets:e.props.targets}))},dragGroupControlStart:function(e,t){return this.dragStart(e,fe(fe({},t),{targets:e.props.targets,isControl:!0}))},dragGroupControl:function(e,t){return this.drag(e,fe(fe({},t),{targets:e.props.targets}))},dragGroupControEnd:function(e,t){return this.dragEnd(e,fe(fe({},t),{targets:e.props.targets}))},unset:function(e){var t,r=e.state;(t=r.dragScroll)===null||t===void 0||t.dragEnd(),r.dragScroll=null}},hf={name:"",props:{target:Object,dragTarget:Object,container:Object,portalContainer:Object,rootContainer:Object,useResizeObserver:Boolean,zoom:Number,transformOrigin:Array,edge:Object,ables:Array,className:String,pinchThreshold:Number,pinchOutside:Boolean,triggerAblesSimultaneously:Boolean,checkInput:Boolean,cspNonce:String,translateZ:Number,hideDefaultLines:Boolean,props:Object,flushSync:Function,stopPropagation:Boolean,preventClickEventOnDrag:Boolean,preventClickDefault:Boolean,viewContainer:Object,persistData:Object,useAccuratePosition:Boolean,firstRenderState:Object,linePadding:Boolean},events:{onChangeTargets:"changeTargets"}},E_=oi("padding",{render:function(e,t){var r=e.props;if(r.dragArea)return[];var n=r.padding||{},a=n.left,i=a===void 0?0:a,o=n.top,s=o===void 0?0:o,l=n.right,u=l===void 0?0:l,c=n.bottom,f=c===void 0?0:c,d=e.getState(),h=d.renderPoses,v=d.pos1,p=d.pos2,g=d.pos3,b=d.pos4,y=[v,p,g,b],S=[];return i>0&&S.push([0,2]),s>0&&S.push([0,1]),u>0&&S.push([1,3]),f>0&&S.push([2,3]),S.map(function(C,T){var D=C[0],P=C[1],G=y[D],W=y[P],L=h[D],X=h[P],M=Js([0,0],[100,0],[0,100],[100,100],G,W,L,X);if(M.length)return t.createElement("div",{key:"padding".concat(T),className:bt("padding"),style:{transform:vo(M,!0)}})})}}),Uu=["nw","ne","se","sw"];function Ri(e,t){var r=e[0]+e[1],n=r>t?t/r:1;return e[0]*=n,e[1]=t-e[1]*n,e}var M_=[1,2,5,6],k_=[0,3,4,7],Fn=[1,-1,-1,1],$n=[1,1,-1,-1];function _l(e,t,r,n,a,i,o,s){a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o=r),s===void 0&&(s=n);var l=[],u=!1,c=e.filter(function(d){return!d.virtual}),f=c.map(function(d){var h=d.horizontal,v=d.vertical,p=d.pos;if(v&&!u&&(u=!0,l.push("/")),u){var g=Math.max(0,v===1?p[1]-i:s-p[1]);return l.push(Xr(g,n,t)),g}else{var g=Math.max(0,h===1?p[0]-a:o-p[0]);return l.push(Xr(g,r,t)),g}});return{radiusPoses:c,styles:l,raws:f}}function gf(e){for(var t=[0,0],r=[0,0],n=e.length,a=0;a<n;++a){var i=e[a];i.sub&&(i.horizontal&&(t[1]===0&&(t[0]=a),t[1]=a-t[0]+1,r[0]=a+1),i.vertical&&(r[1]===0&&(r[0]=a),r[1]=a-r[0]+1))}return{horizontalRange:t,verticalRange:r}}function mf(e,t,r,n,a,i,o){var s,l,u,c;i===void 0&&(i=[0,0]),o===void 0&&(o=!1);var f=e.indexOf("/"),d=(f>-1?e.slice(0,f):e).length,h=e.slice(0,d),v=e.slice(d+1),p=h.length,g=v.length,b=g>0,y=h[0],S=y===void 0?"0px":y,C=h[1],T=C===void 0?S:C,D=h[2],P=D===void 0?S:D,G=h[3],W=G===void 0?T:G,L=v[0],X=L===void 0?S:L,M=v[1],oe=M===void 0?b?X:T:M,re=v[2],be=re===void 0?b?X:P:re,ze=v[3],Ue=ze===void 0?b?oe:W:ze,Ge=[S,T,P,W].map(function(j){return Yt(j,t)}),Ne=[X,oe,be,Ue].map(function(j){return Yt(j,r)}),Me=Ge.slice(),Pe=Ne.slice();s=Ri([Me[0],Me[1]],t),Me[0]=s[0],Me[1]=s[1],l=Ri([Me[3],Me[2]],t),Me[3]=l[0],Me[2]=l[1],u=Ri([Pe[0],Pe[3]],r),Pe[0]=u[0],Pe[3]=u[1],c=Ri([Pe[1],Pe[2]],r),Pe[1]=c[0],Pe[2]=c[1];var Se=o?Me:Me.slice(0,Math.max(i[0],p)),ve=o?Pe:Pe.slice(0,Math.max(i[1],g));return xt(xt([],Se.map(function(j,we){var A=Uu[we];return{virtual:we>=p,horizontal:Fn[we],vertical:0,pos:[n+j,a+($n[we]===-1?r:0)],sub:!0,raw:Ge[we],direction:A}}),!0),ve.map(function(j,we){var A=Uu[we];return{virtual:we>=g,horizontal:0,vertical:$n[we],pos:[n+(Fn[we]===-1?t:0),a+j],sub:!0,raw:Ne[we],direction:A}}),!0)}function T_(e,t,r,n,a){a===void 0&&(a=t.length);var i=gf(e.slice(n)),o=i.horizontalRange,s=i.verticalRange,l=r-n,u=0;if(l===0)u=a;else if(l>0&&l<o[1])u=o[1]-l;else if(l>=s[0])u=s[0]+s[1]-l;else return;e.splice(r,u),t.splice(r,u)}function R_(e,t,r,n,a,i,o,s,l,u,c){u===void 0&&(u=0),c===void 0&&(c=0);var f=gf(e.slice(r)),d=f.horizontalRange,h=f.verticalRange;if(n>-1)for(var v=Fn[n]===1?i-u:s-i,p=d[1];p<=n;++p){var g=$n[p]===1?c:l,b=0;if(n===p?b=i:p===0?b=u+v:Fn[p]===-1&&(b=s-(t[r][0]-u)),e.splice(r+p,0,{horizontal:Fn[p],vertical:0,pos:[b,g]}),t.splice(r+p,0,[b,g]),p===0)break}else if(a>-1){var y=$n[a]===1?o-c:l-o;if(d[1]===0&&h[1]===0){var S=[u+y,c];e.push({horizontal:Fn[0],vertical:0,pos:S}),t.push(S)}for(var C=h[0],p=h[1];p<=a;++p){var b=Fn[p]===1?u:s,g=0;if(a===p?g=o:p===0?g=c+y:$n[p]===1?g=t[r+C][1]:$n[p]===-1&&(g=l-(t[r+C][1]-c)),e.push({horizontal:0,vertical:$n[p],pos:[b,g]}),t.push([b,g]),p===0)break}}}function D_(e,t){t===void 0&&(t=e.map(function(a){return a.raw}));var r=e.map(function(a,i){return a.horizontal?t[i]:null}).filter(function(a){return a!=null}),n=e.map(function(a,i){return a.vertical?t[i]:null}).filter(function(a){return a!=null});return{horizontals:r,verticals:n}}var A_=[[0,-1,"n"],[1,0,"e"]],I_=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function bl(e,t,r){var n=e.props.clipRelative,a=e.state,i=a.width,o=a.height,s=t,l=s.type,u=s.poses,c=l==="rect",f=l==="circle";if(l==="polygon")return r.map(function(D){return"".concat(Xr(D[0],i,n)," ").concat(Xr(D[1],o,n))});if(c||l==="inset"){var d=r[1][1],h=r[3][0],v=r[7][0],p=r[5][1];if(c)return[d,h,p,v].map(function(D){return"".concat(D,"px")});var g=[d,i-h,o-p,v].map(function(D,P){return Xr(D,P%2?i:o,n)});if(r.length>8){var b=gt(r[4],r[0]),y=b[0],S=b[1];g.push.apply(g,xt(["round"],_l(u.slice(8).map(function(D,P){return fe(fe({},D),{pos:r[P]})}),n,y,S,v,d,h,p).styles,!1))}return g}else if(f||l==="ellipse"){var C=r[0],T=Xr(Math.abs(r[1][1]-C[1]),f?Math.sqrt((i*i+o*o)/2):o,n),g=f?[T]:[Xr(Math.abs(r[2][0]-C[0]),i,n),T];return g.push("at",Xr(C[0],i,n),Xr(C[1],o,n)),g}}function Yi(e,t,r,n){var a=[n,(n+t)/2,t],i=[e,(e+r)/2,r];return I_.map(function(o){var s=o[0],l=o[1],u=o[2],c=a[s+1],f=i[l+1];return{vertical:Math.abs(l),horizontal:Math.abs(s),direction:u,pos:[c,f]}})}function _f(e){var t=[1/0,-1/0],r=[1/0,-1/0];return e.forEach(function(n){var a=n.pos;t[0]=Math.min(t[0],a[0]),t[1]=Math.max(t[1],a[0]),r[0]=Math.min(r[0],a[1]),r[1]=Math.max(r[1],a[1])}),[Math.abs(t[1]-t[0]),Math.abs(r[1]-r[0])]}function ju(e,t,r,n,a){var i,o,s,l,u,c,f;if(e){var d=a;if(!d){var h=getComputedStyle(e),v=h.clipPath;d=v!=="none"?v:h.clip}if(!((!d||d==="none"||d==="auto")&&(d=n,!d))){var p=K0(d),g=p.prefix,b=g===void 0?d:g,y=p.value,S=y===void 0?"":y,C=b==="circle",T=" ";if(b==="polygon"){var D=Hn(S||"0% 0%, 100% 0%, 100% 100%, 0% 100%");T=",";var P=D.map(function(Je){var at=Je.split(" "),Ke=at[0],yt=at[1];return{vertical:1,horizontal:1,pos:[Yt(Ke,t),Yt(yt,r)]}}),G=En(P.map(function(Je){return Je.pos}));return{type:b,clipText:d,poses:P,splitter:T,left:G.minX,right:G.maxX,top:G.minY,bottom:G.maxY}}else if(C||b==="ellipse"){var W="",L="",X=0,M=0,D=Cn(S);if(C){var oe="";i=D[0],oe=i===void 0?"50%":i,o=D[2],W=o===void 0?"50%":o,s=D[3],L=s===void 0?"50%":s,X=Yt(oe,Math.sqrt((t*t+r*r)/2)),M=X}else{var re="",be="";l=D[0],re=l===void 0?"50%":l,u=D[1],be=u===void 0?"50%":u,c=D[3],W=c===void 0?"50%":c,f=D[4],L=f===void 0?"50%":f,X=Yt(re,t),M=Yt(be,r)}var ze=[Yt(W,t),Yt(L,r)],P=xt([{vertical:1,horizontal:1,pos:ze,direction:"nesw"}],A_.slice(0,C?1:2).map(function(Ke){return{vertical:Math.abs(Ke[1]),horizontal:Ke[0],direction:Ke[2],sub:!0,pos:[ze[0]+Ke[0]*X,ze[1]+Ke[1]*M]}}),!0);return{type:b,clipText:d,radiusX:X,radiusY:M,left:ze[0]-X,top:ze[1]-M,right:ze[0]+X,bottom:ze[1]+M,poses:P,splitter:T}}else if(b==="inset"){var D=Cn(S||"0 0 0 0"),Ue=D.indexOf("round"),Ge=(Ue>-1?D.slice(0,Ue):D).length,Ne=D.slice(Ge+1),Me=D.slice(0,Ge),Pe=Me[0],Se=Me[1],ve=Se===void 0?Pe:Se,j=Me[2],we=j===void 0?Pe:j,A=Me[3],F=A===void 0?ve:A,_=[Pe,we].map(function(Ke){return Yt(Ke,r)}),Y=_[0],ce=_[1],xe=[F,ve].map(function(Ke){return Yt(Ke,t)}),De=xe[0],He=xe[1],Ze=t-He,je=r-ce,Fe=mf(Ne,Ze-De,je-Y,De,Y),P=xt(xt([],Yi(Y,Ze,je,De),!0),Fe,!0);return{type:"inset",clipText:d,poses:P,top:Y,left:De,right:Ze,bottom:je,radius:Ne,splitter:T}}else if(b==="rect"){var D=Hn(S||"0px, ".concat(t,"px, ").concat(r,"px, 0px"));T=",";var pt=D.map(function(me){var J=ti(me).value;return J}),Y=pt[0],He=pt[1],ce=pt[2],De=pt[3],P=Yi(Y,He,ce,De);return{type:"rect",clipText:d,poses:P,top:Y,right:He,bottom:ce,left:De,values:D,splitter:T}}}}}function B_(e,t,r,n,a){var i=e[t],o=i.direction,s=i.sub,l=e.map(function(){return[0,0]}),u=o?o.split(""):[];if(n&&t<8){var c=u.filter(function(oe){return oe==="w"||oe==="e"}),f=u.filter(function(oe){return oe==="n"||oe==="s"}),d=c[0],h=f[0];l[t]=r;var v=_f(e),p=v[0],g=v[1],b=p&&g?p/g:0;if(b&&a){var y=(t+4)%8,S=e[y].pos,C=[0,0];o.indexOf("w")>-1?C[0]=-1:o.indexOf("e")>-1&&(C[0]=1),o.indexOf("n")>-1?C[1]=-1:o.indexOf("s")>-1&&(C[1]=1);var T=jc([p,g],r,b,C,!0),D=p+T[0],P=g+T[1],G=S[1],W=S[1],L=S[0],X=S[0];C[0]===-1?L=X-D:C[0]===1?X=L+D:(L=L-D/2,X=X+D/2),C[1]===-1?G=W-P:(C[1]===1||(G=W-P/2),W=G+P);var M=Yi(G,X,W,L);e.forEach(function(oe,re){l[re][0]=M[re].pos[0]-oe.pos[0],l[re][1]=M[re].pos[1]-oe.pos[1]})}else e.forEach(function(oe,re){var be=oe.direction;be&&(be.indexOf(d)>-1&&(l[re][0]=r[0]),be.indexOf(h)>-1&&(l[re][1]=r[1]))}),d&&(l[1][0]=r[0]/2,l[5][0]=r[0]/2),h&&(l[3][1]=r[1]/2,l[7][1]=r[1]/2)}else o&&!s?u.forEach(function(oe){var re=oe==="n"||oe==="s";e.forEach(function(be,ze){var Ue=be.direction,Ge=be.horizontal,Ne=be.vertical;!Ue||Ue.indexOf(oe)===-1||(l[ze]=[re||!Ge?0:r[0],!re||!Ne?0:r[1]])})}):l[t]=r;return l}function O_(e,t){var r=Mc(e,t),n=r[0],a=r[1],i=t.datas,o=i.clipPath,s=i.clipIndex,l=o,u=l.type,c=l.poses,f=l.splitter,d=c.map(function(y){return y.pos});if(u==="polygon")d.splice(s,0,[n,a]);else if(u==="inset"){var h=M_.indexOf(s),v=k_.indexOf(s),p=c.length;if(R_(c,d,8,h,v,n,a,d[4][0],d[4][1],d[0][0],d[0][1]),p===c.length)return}else return;var g=bl(e,o,d),b="".concat(u,"(").concat(g.join(f),")");ft(e,"onClip",Mt(e,t,fe({clipEventType:"added",clipType:u,poses:d,clipStyles:g,clipStyle:b,distX:0,distY:0},wr({clipPath:b},t))))}function P_(e,t){var r=t.datas,n=r.clipPath,a=r.clipIndex,i=n,o=i.type,s=i.poses,l=i.splitter,u=s.map(function(h){return h.pos}),c=u.length;if(o==="polygon")s.splice(a,1),u.splice(a,1);else if(o==="inset"){if(a<8||(T_(s,u,a,8,c),c===s.length))return}else return;var f=bl(e,n,u),d="".concat(o,"(").concat(f.join(l),")");ft(e,"onClip",Mt(e,t,fe({clipEventType:"removed",clipType:o,poses:u,clipStyles:f,clipStyle:d,distX:0,distY:0},wr({clipPath:d},t))))}var L_={name:"clippable",props:{clippable:Boolean,defaultClipPath:String,customClipPath:String,keepRatio:Boolean,clipRelative:Boolean,clipArea:Boolean,dragWithClip:Boolean,clipTargetBounds:Boolean,clipVerticalGuidelines:Array,clipHorizontalGuidelines:Array,clipSnapThreshold:Boolean},events:{onClipStart:"clipStart",onClip:"clip",onClipEnd:"clipEnd"},css:[`.control.clip-control {
    background: #6d6;
    cursor: pointer;
}
.control.clip-control.clip-radius {
    background: #d66;
}
.line.clip-line {
    background: #6e6;
    cursor: move;
    z-index: 1;
}
.clip-area {
    position: absolute;
    top: 0;
    left: 0;
}
.clip-ellipse {
    position: absolute;
    cursor: move;
    border: 1px solid #6d6;
    border: var(--zoompx) solid #6d6;
    border-radius: 50%;
    transform-origin: 0px 0px;
}`,`:host {
    --bounds-color: #d66;
}`,`.guideline {
    pointer-events: none;
    z-index: 2;
}`,`.line.guideline.bounds {
    background: #d66;
    background: var(--bounds-color);
}`],render:function(e,t){var r=e.props,n=r.customClipPath,a=r.defaultClipPath,i=r.clipArea,o=r.zoom,s=r.groupable,l=e.getState(),u=l.target,c=l.width,f=l.height,d=l.allMatrix,h=l.is3d,v=l.left,p=l.top,g=l.pos1,b=l.pos2,y=l.pos3,S=l.pos4,C=l.clipPathState,T=l.snapBoundInfos,D=l.rotation;if(!u||s)return[];var P=ju(u,c,f,a||"inset",C||n);if(!P)return[];var G=h?4:3,W=P.type,L=P.poses,X=L.map(function(je){var Fe=ur(d,je.pos,G);return[Fe[0]-v,Fe[1]-p]}),M=[],oe=[],re=W==="rect",be=W==="inset",ze=W==="polygon";if(re||be||ze){var Ue=be?X.slice(0,8):X;oe=Ue.map(function(je,Fe){var pt=Fe===0?Ue[Ue.length-1]:Ue[Fe-1],Je=rr(pt,je),at=Nc(pt,je);return t.createElement("div",{key:"clipLine".concat(Fe),className:bt("line","clip-line","snap-control"),"data-clip-index":Fe,style:{width:"".concat(at,"px"),transform:"translate(".concat(pt[0],"px, ").concat(pt[1],"px) rotate(").concat(Je,"rad) scaleY(").concat(o,")")}})})}if(M=X.map(function(je,Fe){return t.createElement("div",{key:"clipControl".concat(Fe),className:bt("control","clip-control","snap-control"),"data-clip-index":Fe,style:{transform:"translate(".concat(je[0],"px, ").concat(je[1],"px) rotate(").concat(D,"rad) scale(").concat(o,")")}})}),be&&M.push.apply(M,X.slice(8).map(function(je,Fe){return t.createElement("div",{key:"clipRadiusControl".concat(Fe),className:bt("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Fe,style:{transform:"translate(".concat(je[0],"px, ").concat(je[1],"px) rotate(").concat(D,"rad) scale(").concat(o,")")}})})),W==="circle"||W==="ellipse"){var Ge=P.left,Ne=P.top,Me=P.radiusX,Pe=P.radiusY,Se=gt(ur(d,[Ge,Ne],G),ur(d,[0,0],G)),ve=Se[0],j=Se[1],we="none";if(!i){for(var A=Math.max(10,Me/5,Pe/5),F=[],_=0;_<=A;++_){var Y=Math.PI*2/A*_;F.push([Me+(Me-o)*Math.cos(Y),Pe+(Pe-o)*Math.sin(Y)])}F.push([Me,-2]),F.push([-2,-2]),F.push([-2,Pe*2+2]),F.push([Me*2+2,Pe*2+2]),F.push([Me*2+2,-2]),F.push([Me,-2]),we="polygon(".concat(F.map(function(je){return"".concat(je[0],"px ").concat(je[1],"px")}).join(", "),")")}M.push(t.createElement("div",{key:"clipEllipse",className:bt("clip-ellipse","snap-control"),style:{width:"".concat(Me*2,"px"),height:"".concat(Pe*2,"px"),clipPath:we,transform:"translate(".concat(-v+ve,"px, ").concat(-p+j,"px) ").concat(vo(d))}}))}if(i){var ce=Vr(xt([g,b,y,S],X,!0)),xe=ce.width,De=ce.height,He=ce.left,Ze=ce.top;if(ze||re||be){var F=be?X.slice(0,8):X;M.push(t.createElement("div",{key:"clipArea",className:bt("clip-area","snap-control"),style:{width:"".concat(xe,"px"),height:"".concat(De,"px"),transform:"translate(".concat(He,"px, ").concat(Ze,"px)"),clipPath:"polygon(".concat(F.map(function(Fe){return"".concat(Fe[0]-He,"px ").concat(Fe[1]-Ze,"px")}).join(", "),")")}}))}}return T&&["vertical","horizontal"].forEach(function(je){var Fe=T[je],pt=je==="horizontal";Fe.isSnap&&oe.push.apply(oe,Fe.snap.posInfos.map(function(Je,at){var Ke=Je.pos,yt=gt(ur(d,pt?[0,Ke]:[Ke,0],G),[v,p]),V=gt(ur(d,pt?[c,Ke]:[Ke,f],G),[v,p]);return Xa(t,"",yt,V,o,"clip".concat(je,"snap").concat(at),"guideline")})),Fe.isBound&&oe.push.apply(oe,Fe.bounds.map(function(Je,at){var Ke=Je.pos,yt=gt(ur(d,pt?[0,Ke]:[Ke,0],G),[v,p]),V=gt(ur(d,pt?[c,Ke]:[Ke,f],G),[v,p]);return Xa(t,"",yt,V,o,"clip".concat(je,"bounds").concat(at),"guideline","bounds","bold")}))}),xt(xt([],M,!0),oe,!0)},dragControlCondition:function(e,t){return t.inputEvent&&(t.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(e,t){var r=e.props,n=r.dragWithClip,a=n===void 0?!0:n;return a?!1:this.dragControlStart(e,t)},drag:function(e,t){return this.dragControl(e,fe(fe({},t),{isDragTarget:!0}))},dragEnd:function(e,t){return this.dragControlEnd(e,t)},dragControlStart:function(e,t){var r=e.state,n=e.props,a=n.defaultClipPath,i=n.customClipPath,o=r.target,s=r.width,l=r.height,u=t.inputEvent?t.inputEvent.target:null,c=u&&u.getAttribute("class")||"",f=t.datas,d=ju(o,s,l,a||"inset",i);if(!d)return!1;var h=d.clipText,v=d.type,p=d.poses,g=ft(e,"onClipStart",Mt(e,t,{clipType:v,clipStyle:h,poses:p.map(function(b){return b.pos})}));return g===!1?(f.isClipStart=!1,!1):(f.isControl=c&&c.indexOf("clip-control")>-1,f.isLine=c.indexOf("clip-line")>-1,f.isArea=c.indexOf("clip-area")>-1||c.indexOf("clip-ellipse")>-1,f.clipIndex=u?parseInt(u.getAttribute("data-clip-index"),10):-1,f.clipPath=d,f.isClipStart=!0,r.clipPathState=h,Qn(e,t),!0)},dragControl:function(e,t){var r,n,a=t.datas,i=t.originalDatas,o=t.isDragTarget;if(!a.isClipStart)return!1;var s=a,l=s.isControl,u=s.isLine,c=s.isArea,f=s.clipIndex,d=s.clipPath;if(!d)return!1;var h=Yn(e.props,"clippable"),v=h.keepRatio,p=0,g=0,b=i.draggable,y=un(t);o&&b?(r=b.prevBeforeDist,p=r[0],g=r[1]):(p=y[0],g=y[1]);var S=[p,g],C=e.state,T=C.width,D=C.height,P=!c&&!l&&!u,G=d.type,W=d.poses,L=d.splitter,X=W.map(function(ne){return ne.pos});P&&(p=-p,g=-g);var M=!l||W[f].direction==="nesw",oe=G==="inset"||G==="rect",re=W.map(function(){return[0,0]});if(l&&!M){var be=W[f],ze=be.horizontal,Ue=be.vertical,Ge=[p*Math.abs(ze),g*Math.abs(Ue)];re=B_(W,f,Ge,oe,v)}else M&&(re=X.map(function(){return[p,g]}));var Ne=X.map(function(ne,z){return At(ne,re[z])}),Me=xt([],Ne,!0);C.snapBoundInfos=null;var Pe=d.type==="circle",Se=d.type==="ellipse";if(Pe||Se){var ve=Vr(Ne),j=Math.abs(ve.bottom-ve.top),we=Math.abs(Se?ve.right-ve.left:j),A=Ne[0][1]+j,F=Ne[0][0]-we,_=Ne[0][0]+we;Pe&&(Me.push([_,ve.bottom]),re.push([1,0])),Me.push([ve.left,A]),re.push([0,1]),Me.push([F,ve.bottom]),re.push([1,0])}var Y=nf((h.clipHorizontalGuidelines||[]).map(function(ne){return Yt("".concat(ne),D)}),(h.clipVerticalGuidelines||[]).map(function(ne){return Yt("".concat(ne),T)}),T,D),ce=[],xe=[];if(Pe||Se)ce=[Me[4][0],Me[2][0]],xe=[Me[1][1],Me[3][1]];else if(oe){var De=[Me[0],Me[2],Me[4],Me[6]],He=[re[0],re[2],re[4],re[6]];ce=De.filter(function(ne,z){return He[z][0]}).map(function(ne){return ne[0]}),xe=De.filter(function(ne,z){return He[z][1]}).map(function(ne){return ne[1]})}else ce=Me.filter(function(ne,z){return re[z][0]}).map(function(ne){return ne[0]}),xe=Me.filter(function(ne,z){return re[z][1]}).map(function(ne){return ne[1]});var Ze=[0,0],je=Nu(Y,h.clipTargetBounds&&{left:0,top:0,right:T,bottom:D},ce,xe,5),Fe=je.horizontal,pt=je.vertical,Je=Fe.offset,at=pt.offset;if(Fe.isBound&&(Ze[1]+=Je),pt.isBound&&(Ze[0]+=at),(Se||Pe)&&re[0][0]===0&&re[0][1]===0){var ve=Vr(Ne),Ke=ve.bottom-ve.top,yt=Se?ve.right-ve.left:Ke,V=pt.isBound?Math.abs(at):pt.snapIndex===0?-at:at,pe=Fe.isBound?Math.abs(Je):Fe.snapIndex===0?-Je:Je;yt-=V,Ke-=pe,Pe&&(Ke=Qc(pt,Fe)>0?Ke:yt,yt=Ke);var me=Me[0];Me[1][1]=me[1]-Ke,Me[2][0]=me[0]+yt,Me[3][1]=me[1]+Ke,Me[4][0]=me[0]-yt}else if(oe&&v&&l){var J=_f(W),$e=J[0],K=J[1],ie=$e&&K?$e/K:0,Oe=W[f],he=Oe.direction||"",Be=Me[1][1],A=Me[5][1],F=Me[7][0],_=Me[3][0];Je<=at?Je=at/ie:at=Je*ie,he.indexOf("w")>-1?F-=at:he.indexOf("e")>-1?_-=at:(F+=at/2,_-=at/2),he.indexOf("n")>-1?Be-=Je:he.indexOf("s")>-1?A-=Je:(Be+=Je/2,A-=Je/2);var te=Yi(Be,_,A,F);Me.forEach(function(N,k){var Q;Q=te[k].pos,N[0]=Q[0],N[1]=Q[1]})}else Me.forEach(function(ne,z){var I=re[z];I[0]&&(ne[0]-=at),I[1]&&(ne[1]-=Je)});var Le=bl(e,d,Ne),le="".concat(G,"(").concat(Le.join(L),")");if(C.clipPathState=le,Pe||Se)ce=[Me[4][0],Me[2][0]],xe=[Me[1][1],Me[3][1]];else if(oe){var De=[Me[0],Me[2],Me[4],Me[6]];ce=De.map(function(z){return z[0]}),xe=De.map(function(z){return z[1]})}else ce=Me.map(function(ne){return ne[0]}),xe=Me.map(function(ne){return ne[1]});if(C.snapBoundInfos=Nu(Y,h.clipTargetBounds&&{left:0,top:0,right:T,bottom:D},ce,xe,1),b){var ae=C.is3d,m=C.allMatrix,R=ae?4:3,U=Ze;o&&(U=[S[0]+Ze[0]-y[0],S[1]+Ze[1]-y[1]]),b.deltaOffset=Wt(m,[U[0],U[1],0,0],R)}return ft(e,"onClip",Mt(e,t,fe({clipEventType:"changed",clipType:G,poses:Ne,clipStyle:le,clipStyles:Le,distX:p,distY:g},wr((n={},n[G==="rect"?"clip":"clipPath"]=le,n),t)))),!0},dragControlEnd:function(e,t){this.unset(e);var r=t.isDrag,n=t.datas,a=t.isDouble,i=n.isLine,o=n.isClipStart,s=n.isControl;return o?(ft(e,"onClipEnd",Fr(e,t,{})),a&&(s?P_(e,t):i&&O_(e,t)),a||r):!1},unset:function(e){e.state.clipPathState="",e.state.snapBoundInfos=null}},F_={name:"originDraggable",props:{originDraggable:Boolean,originRelative:Boolean},events:{onDragOriginStart:"dragOriginStart",onDragOrigin:"dragOrigin",onDragOriginEnd:"dragOriginEnd"},css:[`:host[data-able-origindraggable] .control.origin {
    pointer-events: auto;
}`],dragControlCondition:function(e,t){return t.isRequest?t.requestAble==="originDraggable":cr(t.inputEvent.target,bt("origin"))},dragControlStart:function(e,t){var r=t.datas;Qn(e,t);var n=Mt(e,t,{dragStart:Sr.dragStart(e,new ua().dragStart([0,0],t))}),a=ft(e,"onDragOriginStart",n);return r.startOrigin=e.state.transformOrigin,r.startTargetOrigin=e.state.targetOrigin,r.prevOrigin=[0,0],r.isDragOrigin=!0,a===!1?(r.isDragOrigin=!1,!1):n},dragControl:function(e,t){var r=t.datas,n=t.isPinch,a=t.isRequest;if(!r.isDragOrigin)return!1;var i=un(t),o=i[0],s=i[1],l=e.state,u=l.width,c=l.height,f=l.offsetMatrix,d=l.targetMatrix,h=l.is3d,v=e.props.originRelative,p=v===void 0?!0:v,g=h?4:3,b=[o,s];if(a){var y=t.distOrigin;(y[0]||y[1])&&(b=y)}var S=At(r.startOrigin,b),C=At(r.startTargetOrigin,b),T=gt(b,r.prevOrigin),D=li(f,d,S,g),P=e.getRect(),G=Vr(Mn(D,u,c,g)),W=[P.left-G.left,P.top-G.top];r.prevOrigin=b;var L=[Xr(C[0],u,p),Xr(C[1],c,p)].join(" "),X=Sr.drag(e,si(t,e.state,W,!!n)),M=Mt(e,t,fe(fe({width:u,height:c,origin:S,dist:b,delta:T,transformOrigin:L,drag:X},wr({transformOrigin:L,transform:X.transform},t)),{afterTransform:X.transform}));return ft(e,"onDragOrigin",M),M},dragControlEnd:function(e,t){var r=t.datas;return r.isDragOrigin?(ft(e,"onDragOriginEnd",Fr(e,t,{})),!0):!1},dragGroupControlCondition:function(e,t){return this.dragControlCondition(e,t)},dragGroupControlStart:function(e,t){var r=this.dragControlStart(e,t);return!!r},dragGroupControl:function(e,t){var r=this.dragControl(e,t);return r?(e.transformOrigin=r.transformOrigin,!0):!1},request:function(e){var t={},r=e.getRect(),n=0,a=0,i=r.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:t}},request:function(s){return"deltaOrigin"in s?(o[0]+=s.deltaOrigin[0],o[1]+=s.deltaOrigin[1]):"origin"in s?(o[0]=s.origin[0]-i[0],o[1]=s.origin[1]-i[1]):("x"in s?n=s.x-r.left:"deltaX"in s&&(n+=s.deltaX),"y"in s?a=s.y-r.top:"deltaY"in s&&(a+=s.deltaY)),{datas:t,distX:n,distY:a,distOrigin:o}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function $_(e,t,r,n){var a=e.filter(function(l){var u=l.virtual,c=l.horizontal;return c&&!u}).length,i=e.filter(function(l){var u=l.virtual,c=l.vertical;return c&&!u}).length,o=-1;if(t===0&&(a===0?o=0:a===1&&(o=1)),t===2&&(a<=2?o=2:a<=3&&(o=3)),t===3&&(i===0?o=4:i<4&&(o=7)),t===1&&(i<=1?o=5:i<=2&&(o=6)),!(o===-1||!e[o].virtual)){var s=e[o];N_(e,o),o<4?s.pos[0]=r:s.pos[1]=n}}function N_(e,t){t<4?e.slice(0,t+1).forEach(function(r){r.virtual=!1}):(e[0].virtual&&(e[0].virtual=!1),e.slice(4,t+1).forEach(function(r){r.virtual=!1}))}function z_(e,t){t<4?e.slice(t,4).forEach(function(r){r.virtual=!0}):e.slice(t).forEach(function(r){r.virtual=!0})}function qu(e,t,r,n,a){n===void 0&&(n=[0,0]);var i=[];return!e||e==="0px"?i=[]:i=Cn(e),mf(i,t,r,0,0,n,a)}function Ku(e,t,r,n,a){var i=e.state,o=i.width,s=i.height,l=_l(a,e.props.roundRelative,o,s),u=l.raws,c=l.styles,f=l.radiusPoses,d=D_(f,u),h=d.horizontals,v=d.verticals,p=c.join(" ");i.borderRadiusState=p;var g=Mt(e,t,fe({horizontals:h,verticals:v,borderRadius:p,width:o,height:s,delta:n,dist:r},wr({borderRadius:p},t)));return ft(e,"onRound",g),g}function Zu(e){var t=e.getState().style,r=t.borderRadius||"";if(!r&&e.props.groupable){var n=e.getTargets()[0];n&&(r=getComputedStyle(n).borderRadius,t.borderRadius=r)}return r}var V_={name:"roundable",props:{roundable:Boolean,roundRelative:Boolean,minRoundControls:Array,maxRoundControls:Array,roundClickable:Boolean,roundPadding:Number,isDisplayShadowRoundControls:Boolean},events:{onRoundStart:"roundStart",onRound:"round",onRoundEnd:"roundEnd",onRoundGroupStart:"roundGroupStart",onRoundGroup:"roundGroup",onRoundGroupEnd:"roundGroupEnd"},css:[`.control.border-radius {
    background: #d66;
    cursor: pointer;
    z-index: 3;
}`,`.control.border-radius.vertical {
    background: #d6d;
    z-index: 2;
}`,`.control.border-radius.virtual {
    opacity: 0.5;
    z-index: 1;
}`,`:host.round-line-clickable .line.direction {
    cursor: pointer;
}`],className:function(e){var t=e.props.roundClickable;return t===!0||t==="line"?bt("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},render:function(e,t){var r=e.getState(),n=r.target,a=r.width,i=r.height,o=r.allMatrix,s=r.is3d,l=r.left,u=r.top,c=r.borderRadiusState,f=e.props,d=f.minRoundControls,h=d===void 0?[0,0]:d,v=f.maxRoundControls,p=v===void 0?[4,4]:v,g=f.zoom,b=f.roundPadding,y=b===void 0?0:b,S=f.isDisplayShadowRoundControls,C=f.groupable;if(!n)return null;var T=c||Zu(e),D=s?4:3,P=qu(T,a,i,h,!0);if(!P)return null;var G=0,W=0,L=C?[0,0]:[l,u];return P.map(function(X,M){var oe=X.horizontal,re=X.vertical,be=X.direction||"",ze=xt([],X.pos,!0);W+=Math.abs(oe),G+=Math.abs(re),oe&&be.indexOf("n")>-1&&(ze[1]-=y),re&&be.indexOf("w")>-1&&(ze[0]-=y),oe&&be.indexOf("s")>-1&&(ze[1]+=y),re&&be.indexOf("e")>-1&&(ze[0]+=y);var Ue=gt(ur(o,ze,D),L),Ge=X.vertical?G<=p[1]&&(S||!X.virtual):W<=p[0]&&(S||!X.virtual);return t.createElement("div",{key:"borderRadiusControl".concat(M),className:bt("control","border-radius",X.vertical?"vertical":"",X.virtual?"virtual":""),"data-radius-index":M,style:{display:Ge?"block":"none",transform:"translate(".concat(Ue[0],"px, ").concat(Ue[1],"px) scale(").concat(g,")")}})})},dragControlCondition:function(e,t){if(!t.inputEvent||t.isRequest)return!1;var r=t.inputEvent.target.getAttribute("class")||"";return r.indexOf("border-radius")>-1||r.indexOf("moveable-line")>-1&&r.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(e,t){return this.dragControlCondition(e,t)},dragControlStart:function(e,t){var r=t.inputEvent,n=t.datas,a=r.target,i=a.getAttribute("class")||"",o=i.indexOf("border-radius")>-1,s=i.indexOf("moveable-line")>-1&&i.indexOf("moveable-direction")>-1,l=o?parseInt(a.getAttribute("data-radius-index"),10):-1,u=-1;if(s){var c=a.getAttribute("data-line-key")||"";c&&(u=parseInt(c.replace(/render-line-/g,""),10),isNaN(u)&&(u=-1))}if(!o&&!s)return!1;var f=Mt(e,t,{}),d=ft(e,"onRoundStart",f);if(d===!1)return!1;n.lineIndex=u,n.controlIndex=l,n.isControl=o,n.isLine=s,Qn(e,t);var h=e.props,v=h.roundRelative,p=h.minRoundControls,g=p===void 0?[0,0]:p,b=e.state,y=b.width,S=b.height;n.isRound=!0,n.prevDist=[0,0];var C=Zu(e),T=qu(C||"",y,S,g,!0)||[];return n.controlPoses=T,b.borderRadiusState=_l(T,v,y,S).styles.join(" "),f},dragControl:function(e,t){var r=t.datas,n=r.controlPoses;if(!r.isRound||!r.isControl||!n.length)return!1;var a=r.controlIndex,i=un(t),o=i[0],s=i[1],l=[o,s],u=gt(l,r.prevDist),c=e.props.maxRoundControls,f=c===void 0?[4,4]:c,d=e.state,h=d.width,v=d.height,p=n[a],g=p.vertical,b=p.horizontal,y=n.map(function(C){var T=C.horizontal,D=C.vertical,P=[T*b*l[0],D*g*l[1]];if(T){if(f[0]===1)return P;if(f[0]<4&&T!==b)return P}else{if(f[1]===0)return P[1]=D*b*l[0]/h*v,P;if(g){if(f[1]===1)return P;if(f[1]<4&&D!==g)return P}}return[0,0]});y[a]=l;var S=n.map(function(C,T){return fe(fe({},C),{pos:At(C.pos,y[T])})});return a<4?S.slice(0,a+1).forEach(function(C){C.virtual=!1}):S.slice(4,a+1).forEach(function(C){C.virtual=!1}),r.prevDist=[o,s],Ku(e,t,l,u,S)},dragControlEnd:function(e,t){var r=e.state;r.borderRadiusState="";var n=t.datas,a=t.isDouble;if(!n.isRound)return!1;var i=n.isControl,o=n.controlIndex,s=n.isLine,l=n.lineIndex,u=n.controlPoses,c=u.filter(function(b){var y=b.virtual;return y}).length,f=e.props.roundClickable,d=f===void 0?!0:f;if(a&&d){if(i&&(d===!0||d==="control"))z_(u,o);else if(s&&(d===!0||d==="line")){var h=Mc(e,t),v=h[0],p=h[1];$_(u,l,v,p)}c!==u.filter(function(b){var y=b.virtual;return y}).length&&Ku(e,t,[0,0],[0,0],u)}var g=Fr(e,t,{});return ft(e,"onRoundEnd",g),r.borderRadiusState="",g},dragGroupControlStart:function(e,t){var r=this.dragControlStart(e,t);if(!r)return!1;var n=e.moveables,a=e.props.targets,i=qr(e,"roundable",t),o=fe({targets:e.props.targets,events:i.map(function(s,l){return fe(fe({},s),{target:a[l],moveable:n[l],currentTarget:n[l]})})},r);return ft(e,"onRoundGroupStart",o),r},dragGroupControl:function(e,t){var r=this.dragControl(e,t);if(!r)return!1;var n=e.moveables,a=e.props.targets,i=qr(e,"roundable",t),o=fe({targets:e.props.targets,events:i.map(function(s,l){return fe(fe(fe({},s),{target:a[l],moveable:n[l],currentTarget:n[l]}),wr({borderRadius:r.borderRadius},s))})},r);return ft(e,"onRoundGroup",o),o},dragGroupControlEnd:function(e,t){var r=e.moveables,n=e.props.targets,a=qr(e,"roundable",t);po(e,"onRound",function(s){var l=fe({targets:e.props.targets,events:a.map(function(u,c){return fe(fe(fe({},u),{target:n[c],moveable:r[c],currentTarget:r[c]}),wr({borderRadius:s.borderRadius},u))})},s);ft(e,"onRoundGroup",l)});var i=this.dragControlEnd(e,t);if(!i)return!1;var o=fe({targets:e.props.targets,events:a.map(function(s,l){var u;return fe(fe({},s),{target:n[l],moveable:r[l],currentTarget:r[l],lastEvent:(u=s.datas)===null||u===void 0?void 0:u.lastEvent})})},i);return ft(e,"onRoundGroupEnd",o),o},unset:function(e){e.state.borderRadiusState=""}};function H_(e,t){var r=t?4:3,n=Jt(r),a="matrix".concat(t?"3d":"","(").concat(n.join(","),")");return e===a||e==="matrix(1,0,0,1,0,0)"}var bf={isPinch:!0,name:"beforeRenderable",props:{},events:{onBeforeRenderStart:"beforeRenderStart",onBeforeRender:"beforeRender",onBeforeRenderEnd:"beforeRenderEnd",onBeforeRenderGroupStart:"beforeRenderGroupStart",onBeforeRenderGroup:"beforeRenderGroup",onBeforeRenderGroupEnd:"beforeRenderGroupEnd"},dragRelation:"weak",setTransform:function(e,t){var r=e.state,n=r.is3d,a=r.target,i=r.targetMatrix,o=a==null?void 0:a.style.transform,s=n?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(pc(i,!0),")"),l=!o||o==="none"?s:o;t.datas.startTransforms=H_(l,n)?[]:Cn(l)},resetStyle:function(e){var t=e.datas;t.nextStyle={},t.nextTransforms=e.datas.startTransforms,t.nextTransformAppendedIndexes=[]},fillDragStartParams:function(e,t){return Mt(e,t,{setTransform:function(r){t.datas.startTransforms=or(r)?r:Cn(r)},isPinch:!!t.isPinch})},fillDragParams:function(e,t){return Mt(e,t,{isPinch:!!t.isPinch})},dragStart:function(e,t){this.setTransform(e,t),this.resetStyle(t),ft(e,"onBeforeRenderStart",this.fillDragStartParams(e,t))},drag:function(e,t){this.resetStyle(t),ft(e,"onBeforeRender",Mt(e,t,{isPinch:!!t.isPinch}))},dragEnd:function(e,t){ft(e,"onBeforeRenderEnd",Mt(e,t,{isPinch:!!t.isPinch,isDrag:t.isDrag}))},dragGroupStart:function(e,t){var r=this;this.dragStart(e,t);var n=qr(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(o,s){var l=a[s];return r.setTransform(l,o),r.resetStyle(o),r.fillDragStartParams(l,o)});ft(e,"onBeforeRenderGroupStart",Mt(e,t,{isPinch:!!t.isPinch,targets:e.props.targets,setTransform:function(){},events:i}))},dragGroup:function(e,t){var r=this;this.drag(e,t);var n=qr(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(o,s){var l=a[s];return r.resetStyle(o),r.fillDragParams(l,o)});ft(e,"onBeforeRenderGroup",Mt(e,t,{isPinch:!!t.isPinch,targets:e.props.targets,events:i}))},dragGroupEnd:function(e,t){this.dragEnd(e,t),ft(e,"onBeforeRenderGroupEnd",Mt(e,t,{isPinch:!!t.isPinch,isDrag:t.isDrag,targets:e.props.targets}))},dragControlStart:function(e,t){return this.dragStart(e,t)},dragControl:function(e,t){return this.drag(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupControlStart:function(e,t){return this.dragGroupStart(e,t)},dragGroupControl:function(e,t){return this.dragGroup(e,t)},dragGroupControlEnd:function(e,t){return this.dragGroupEnd(e,t)}},yf={name:"renderable",props:{},events:{onRenderStart:"renderStart",onRender:"render",onRenderEnd:"renderEnd",onRenderGroupStart:"renderGroupStart",onRenderGroup:"renderGroup",onRenderGroupEnd:"renderGroupEnd"},dragRelation:"weak",dragStart:function(e,t){ft(e,"onRenderStart",Mt(e,t,{isPinch:!!t.isPinch}))},drag:function(e,t){ft(e,"onRender",this.fillDragParams(e,t))},dragAfter:function(e,t){if(t.resultCount)return this.drag(e,t)},dragEnd:function(e,t){ft(e,"onRenderEnd",this.fillDragEndParams(e,t))},dragGroupStart:function(e,t){ft(e,"onRenderGroupStart",Mt(e,t,{isPinch:!!t.isPinch,targets:e.props.targets}))},dragGroup:function(e,t){var r=this,n=qr(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(o,s){var l=a[s];return r.fillDragParams(l,o)});ft(e,"onRenderGroup",Mt(e,t,fe(fe({isPinch:!!t.isPinch,targets:e.props.targets,transform:Si(t)},wr(wi(t))),{events:i})))},dragGroupEnd:function(e,t){var r=this,n=qr(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(o,s){var l=a[s];return r.fillDragEndParams(l,o)});ft(e,"onRenderGroupEnd",Mt(e,t,fe({isPinch:!!t.isPinch,isDrag:t.isDrag,targets:e.props.targets,events:i,transform:Si(t)},wr(wi(t)))))},dragControlStart:function(e,t){return this.dragStart(e,t)},dragControl:function(e,t){return this.drag(e,t)},dragControlAfter:function(e,t){return this.dragAfter(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupControlStart:function(e,t){return this.dragGroupStart(e,t)},dragGroupControl:function(e,t){return this.dragGroup(e,t)},dragGroupControlEnd:function(e,t){return this.dragGroupEnd(e,t)},fillDragParams:function(e,t){return Mt(e,t,fe({isPinch:!!t.isPinch,transform:Si(t)},wr(wi(t))))},fillDragEndParams:function(e,t){return Mt(e,t,fe({isPinch:!!t.isPinch,isDrag:t.isDrag,transform:Si(t)},wr(wi(t))))}};function Pa(e,t,r,n,a,i,o){var s=a==="Start",l=e.state.target,u=i.isRequest;if(!l||s&&n.indexOf("Control")>-1&&!u&&e.areaElement===i.inputEvent.target)return!1;var c="".concat(r).concat(n).concat(a),f="".concat(r).concat(n,"Condition"),d=a==="End",h=a==="After",v=s&&(!e.targetGesto||!e.controlGesto||!e.targetGesto.isFlag()||!e.controlGesto.isFlag());v&&e.updateRect(a,!0,!1),i.clientDistX=i.distX,i.clientDistY=i.distY,a===""&&!u&&m2(e.state,i);var p=xt([],e[t],!0);if(u){var g=i.requestAble;p.some(function(M){return M.name===g})||p.push.apply(p,e.props.ables.filter(function(M){return M.name===g}))}if(!p.length||p.every(function(M){return M.dragRelation}))return!1;var b=xt(xt([bf],p,!0),[yf],!1).filter(function(M){return M[c]}),y=i.datas;v&&b.forEach(function(M){M.unset&&M.unset(e)});var S=i.inputEvent,C;d&&S&&(C=document.elementFromPoint(i.clientX,i.clientY)||S.target);var T=0,D=!1,P=function(){var M;D=!0,(M=i.stop)===null||M===void 0||M.call(i)},G=b.filter(function(M){var oe=M.name,re=y[oe]||(y[oe]={});if(s&&(re.isEventStart=!M[f]||M[f](e,i)),re.isEventStart){var be=M[c](e,fe(fe({},i),{stop:P,resultCount:T,datas:re,originalDatas:y,inputTarget:C}));return e._emitter.off(),s&&be===!1&&(re.isEventStart=!1),T+=be||re.isEventStart?1:0,be}return!1}),W=G.length,L=!1;if(D&&(L=!0),!L&&s&&b.length&&!W&&(L=b.filter(function(M){var oe=M.name,re=y[oe];return re.isEventStart?M.dragRelation!=="strong":!1}).length),(d||L)&&(e.state.gestos={},e.moveables&&e.moveables.forEach(function(M){M.state.gestos={}}),b.forEach(function(M){M.unset&&M.unset(e)})),s&&!L&&!u&&W&&(i==null||i.preventDefault()),e.isUnmounted||L)return!1;if(!s&&W&&!o||d){var X=e.props.flushSync||Lc;X(function(){e.updateRect(d?a:"",!0,!1),e.forceUpdate()})}return!s&&!d&&!h&&W&&!o&&Pa(e,t,r,n,a+"After",i),!0}function Ds(e){return function(t){var r=e.props.dragTarget,n=t.inputEvent.target,a=e.areaElement;return r&&(n===r||r.contains(n))||n===a||!e.isMoveableElement(n)&&!e.controlBox.getElement().contains(n)||cr(n,"moveable-area")||cr(n,"moveable-padding")||cr(n,"moveable-edgeDraggable")}}function xf(e,t,r){var n=e.controlBox.getElement(),a=[],i=e.props.dragTarget;return a.push(n),(!e.props.dragArea||i)&&a.push(t),yl(e,a,"targetAbles",r,{dragStart:Ds(e),pinchStart:Ds(e)})}function yl(e,t,r,n,a){a===void 0&&(a={});var i=r==="targetAbles",o=e.props,s=o.pinchOutside,l=o.pinchThreshold,u=o.preventClickEventOnDrag,c=o.preventClickDefault,f=o.checkInput,d={preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,container:window,pinchThreshold:l,pinchOutside:s,preventClickEventOnDrag:i?u:!1,preventClickEventOnDragStart:i?c:!1,preventClickEventByCondition:i?null:function(p){return e.controlBox.getElement().contains(p.target)},checkInput:i?f:!1},h=new Mm(t,d),v=n==="Control";return["drag","pinch"].forEach(function(p){["Start","","End"].forEach(function(g){h.on("".concat(p).concat(g),function(b){var y,S=b.eventType;if(a[S]&&!a[S](b)){b.stop();return}var C=Pa(e,r,p,n,g,b);C?(e.props.stopPropagation||g==="Start"&&v)&&((y=b==null?void 0:b.inputEvent)===null||y===void 0||y.stopPropagation()):b.stop()})})}),h}var G_=function(){function e(r,n,a){var i=this;this.target=r,this.moveable=n,this.eventName=a,this.ables=[],this._onEvent=function(o){var s=i.eventName,l=i.moveable;l.state.disableNativeEvent||i.ables.forEach(function(u){u[s](l,{inputEvent:o})})},r.addEventListener(a.toLowerCase(),this._onEvent)}var t=e.prototype;return t.setAbles=function(r){this.ables=r},t.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},e}();function W_(e){if(e&&e.getRootNode){var t=e.getRootNode();if(t.nodeType===11)return t}}function Qu(e,t,r){for(var n=e,a=[],i=document.documentElement||document.body,o=!r&&e===t||e===i,s=o,l=!1,u=3,c,f,d,h=!1,v=Wa(t,t,!0).offsetParent,p=1;n&&!s;){s=o;var g=getComputedStyle(n),b=g.position,y=Fc(n,g),S=nm(i2(y)),C=b==="fixed",T={hasTransform:!1,fixedContainer:null};C&&(h=!0,T=u2(n),v=T.fixedContainer);var D=S.length;!l&&D===16&&(l=!0,u=4,Ss(a),d&&(d=an(d,3,4))),l&&D===9&&(S=an(S,3,4));var P=l2(n,e,g),G=P.tagName,W=P.hasOffset,L=P.isSVG,X=P.origin,M=P.targetOrigin,oe=P.offset,re=oe[0],be=oe[1];G==="svg"&&d&&(a.push({type:"target",target:n,matrix:c2(n,u)}),a.push({type:"offset",target:n,matrix:Jt(u)}));var ze=void 0,Ue=!1,Ge=!1,Ne=parseFloat(g.zoom)||1;if(C)ze=T.fixedContainer,Ue=!0;else{var Me=Wa(n,t,!1,!0,g),Pe=Me.offsetZoom;if(ze=Me.offsetParent,Ue=Me.isEnd,Ge=Me.isStatic,p*=Pe,Pe!==1&&Ge)re-=ze.offsetLeft,be-=ze.offsetTop;else if(zm){var Se=Me.parentSlotElement;if(Se){for(var ve=ze,j=0,we=0;ve&&W_(ve);)j+=ve.offsetLeft,we+=ve.offsetTop,ve=ve.offsetParent;re-=j,be-=we}}}Sc&&!Vm&&W&&!L&&Ge&&(b==="relative"||b==="static")&&(re-=ze.offsetLeft,be-=ze.offsetTop,o=o||Ue);var A=0,F=0,_=0,Y=0;if(C)W&&T.hasTransform&&(_=ze.clientLeft,Y=ze.clientTop);else if(W&&v!==ze&&(A=ze.clientLeft,F=ze.clientTop),W&&ze===i){var ce=$c(n,!1,g);re+=ce[0],be+=ce[1]}if(a.push({type:"target",target:n,matrix:Vi(S,u,X)}),W){var xe=n===e,De=xe?0:n.scrollLeft,He=xe?0:n.scrollTop;a.push({type:"offset",target:n,matrix:Ga([re-De+A-_,be-He+F-Y],u)})}else a.push({type:"offset",target:n,origin:X});if(Ne!==1&&a.push({type:"zoom",target:n,matrix:Vi(Qs([Ne,Ne],u),u,[0,0])}),d||(d=S),c||(c=X),f||(f=M),s||C)break;n=ze,o=Ue,(!r||n===i)&&(s=o)}return d||(d=Jt(u)),c||(c=[0,0]),f||(f=[0,0]),{zoom:p,offsetContainer:v,matrixes:a,targetMatrix:d,transformOrigin:c,targetOrigin:f,is3d:l,hasFixed:h}}function X_(e,t,r,n){var a;r===void 0&&(r=t);var i=Qu(e,t),o=i.matrixes,s=i.is3d,l=i.targetMatrix,u=i.transformOrigin,c=i.targetOrigin,f=i.offsetContainer,d=i.hasFixed,h=i.zoom,v=Qu(f,r,!0),p=v.matrixes,g=v.is3d,b=v.offsetContainer,y=v.zoom,S=n,C=4,T=e.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in e,D=l,P=Jt(C),G=Jt(C),W=Jt(C),L=Jt(C),X=o.length;p.reverse(),o.reverse(),!s&&S&&(D=an(D,3,4),Ss(o)),!g&&S&&Ss(p),p.forEach(function(Ge){G=Wt(G,Ge.matrix,C)});var M=r||document.body,oe=((a=p[0])===null||a===void 0?void 0:a.target)||Wa(M,M,!0).offsetParent,re=p.slice(1).reduce(function(Ge,Ne){return Wt(Ge,Ne.matrix,C)},Jt(C));o.forEach(function(Ge,Ne){if(X-2===Ne&&(W=P.slice()),X-1===Ne&&(L=P.slice()),!Ge.matrix){var Me=o[Ne+1],Pe=d2(Ge,Me,oe,C,Wt(re,P,C));Ge.matrix=Ga(Pe,C)}P=Wt(P,Ge.matrix,C)});var be=!T&&s;D||(D=Jt(be?4:3));var ze=vo(T&&D.length===16?an(D,4,3):D,be),Ue=G;return G=dc(G,C,C),{hasZoom:h!==1||y!==1,hasFixed:d,rootMatrix:G,originalRootMatrix:Ue,beforeMatrix:W,offsetMatrix:L,allMatrix:P,targetMatrix:D,targetTransform:ze,transformOrigin:u,targetOrigin:c,is3d:S,offsetContainer:f,offsetRootContainer:b}}function Y_(e,t,r,n){r===void 0&&(r=t);var a=0,i=0,o=0,s={},l=zc(e);if(e&&(a=l.offsetWidth,i=l.offsetHeight),e){var u=X_(e,t,r,n),c=oa(u.allMatrix,u.transformOrigin,a,i);s=fe(fe({},u),c);var f=oa(u.allMatrix,[50,50],100,100);o=Vc([f.pos1,f.pos2],f.direction)}var d=4;return fe(fe(fe({hasZoom:!1,width:a,height:i,rotation:o},l),{originalRootMatrix:Jt(d),rootMatrix:Jt(d),beforeMatrix:Jt(d),offsetMatrix:Jt(d),allMatrix:Jt(d),targetMatrix:Jt(d),targetTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!n,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null}),s)}function As(e,t,r,n,a,i){i===void 0&&(i=[]);var o=1,s=[0,0],l=Ci(),u=Ci(),c=Ci(),f=Ci(),d=[0,0],h={},v=Y_(t,r,a,!0);if(t){var p=getComputedStyle(t);i.forEach(function(M){h[M]=p[M]});var g=v.is3d?4:3,b=oa(v.offsetMatrix,At(v.transformOrigin,vc(v.targetMatrix,g)),v.width,v.height);o=b.direction,s=At(b.origin,[b.left-v.left,b.top-v.top]),f=Ta(v.offsetRootContainer);var y=Wa(n,n,!0).offsetParent||v.offsetRootContainer;if(v.hasZoom){var S=oa(Wt(v.originalRootMatrix,v.allMatrix),v.transformOrigin,v.width,v.height),C=oa(v.originalRootMatrix,Hi(getComputedStyle(y)).map(function(M){return parseFloat(M)}),y.offsetWidth,y.offsetHeight);if(l=Vo(S,f),c=Vo(C,f,y,!0),e){var T=S.left,D=S.top;u=Vo({left:T,top:D,bottom:D,right:D},f)}}else{l=Ta(t),c=Ta(y,!0),e&&(u=Ta(e));var P=c.left,G=c.top,W=c.clientLeft,L=c.clientTop,X=[l.left-P,l.top-G];d=gt(Gn(v.rootMatrix,X,4),[W+v.left,L+v.top])}}return fe({targetClientRect:l,containerClientRect:c,moveableClientRect:u,rootContainerClientRect:f,beforeDirection:o,beforeOrigin:s,originalBeforeOrigin:s,target:t,style:h,offsetDelta:d},v)}function Ju(e){var t=e.pos1,r=e.pos2,n=e.pos3,a=e.pos4;if(!t||!r||!n||!a)return null;var i=En([t,r,n,a]),o=[i.minX,i.minY],s=gt(e.origin,o);return t=gt(t,o),r=gt(r,o),n=gt(n,o),a=gt(a,o),fe(fe({},e),{left:e.left,top:e.top,posDelta:o,pos1:t,pos2:r,pos3:n,pos4:a,origin:s,beforeOrigin:s,isPersisted:!0})}var fa=function(e){ii(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.state=fe({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},As(null)),n.renderState={},n.enabledAbles=[],n.targetAbles=[],n.controlAbles=[],n.rotation=0,n.scale=[1,1],n.isMoveableMounted=!1,n.isUnmounted=!1,n.events={mouseEnter:null,mouseLeave:null},n._emitter=new so,n._prevTarget=null,n._prevDragArea=!1,n._isPropTargetChanged=!1,n._hasFirstTarget=!1,n._observer=null,n._observerId=0,n._rootContainer=null,n._viewContainer=null,n._viewClassNames=[],n.checkUpdateRect=function(){if(!n.isDragging()){var a=n.props.parentMoveable;if(a){a.checkUpdateRect();return}kg(n._observerId),n._observerId=Z0(function(){n.isDragging()||n.updateRect()})}},n._onPreventClick=function(a){a.stopPropagation(),a.preventDefault()},n}var r=t.prototype;return r.render=function(){var n=this.props,a=this.getState(),i=n.parentPosition,o=n.className,s=n.target,l=n.zoom,u=n.cspNonce,c=n.translateZ,f=n.cssStyled,d=n.portalContainer,h=n.groupable,v=n.linePadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var p=i||[0,0],g=p[0],b=p[1],y=a.left,S=a.top,C=a.target,T=a.direction,D=a.hasFixed,P=a.offsetDelta,G=n.targets,W=this.isDragging(),L={};this.getEnabledAbles().forEach(function(ze){L["data-able-".concat(ze.name.toLowerCase())]=!0});var X=this._getAbleClassName(),M=G&&G.length&&(C||h)||s||!this._hasFirstTarget&&this.state.isPersisted,oe=this.controlBox||this.props.firstRenderState||this.props.persistData,re=[y-g,S-b];!h&&n.useAccuratePosition&&(re[0]+=P[0],re[1]+=P[1]);var be={position:D?"fixed":"absolute",display:M?"block":"none",visibility:oe?"visible":"hidden",transform:"translate3d(".concat(re[0],"px, ").concat(re[1],"px, ").concat(c,")"),"--zoom":l,"--zoompx":"".concat(l,"px")};return v&&(be["--moveable-line-padding"]=v),zr(f,fe({cspNonce:u,ref:tn(this,"controlBox"),className:"".concat(bt("control-box",T===-1?"reverse":"",W?"dragging":"")," ").concat(X," ").concat(o)},L,{onClick:this._onPreventClick,portalContainer:d,style:be}),this.renderAbles(),this._renderLines())},r.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1,this.controlBox.getElement();var n=this.props,a=n.parentMoveable,i=n.container,o=n.wrapperMoveable;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!a&&!o&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},r.componentDidUpdate=function(n){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateEvents(),this._updateTargets(),this.updateCheckInput(),this._updateObserver(n)},r.componentWillUnmount=function(){this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off();var n=this._viewContainer;n&&this._changeAbleViewClassNames([]),aa(this,"targetGesto"),aa(this,"controlGesto");var a=this.events;for(var i in a){var o=a[i];o&&o.destroy()}},r.getTargets=function(){var n=this.props.target;return n?[n]:[]},r.getAble=function(n){var a=this.props.ables||[];return vn(a,function(i){return i.name===n})},r.getContainer=function(){var n=this.props,a=n.parentMoveable,i=n.wrapperMoveable,o=n.container;return o||i&&i.getContainer()||a&&a.getContainer()||this.controlBox.getElement().parentElement},r.isMoveableElement=function(n){var a;return n&&(((a=n.getAttribute)===null||a===void 0?void 0:a.call(n,"class"))||"").indexOf(rl)>-1},r.dragStart=function(n){var a=this.targetGesto,i=this.controlGesto;return a&&Ds(this)({inputEvent:n})?a.isFlag()||a.triggerDragStart(n):i&&this.isMoveableElement(n.target)&&(i.isFlag()||i.triggerDragStart(n)),this},r.hitTest=function(n){var a=this.state,i=a.target,o=a.pos1,s=a.pos2,l=a.pos3,u=a.pos4,c=a.targetClientRect;if(!i)return 0;var f;if(n instanceof Element){var d=n.getBoundingClientRect();f={left:d.left,top:d.top,width:d.width,height:d.height}}else f=fe({width:0,height:0},n);var h=f.left,v=f.top,p=f.width,g=f.height,b=Cu([o,s,u,l],c),y=gm(b,[[h,v],[h+p,v],[h+p,v+g],[h,v+g]]),S=mc(b);return!y||!S?0:Math.min(100,y/S*100)},r.isInside=function(n,a){var i=this.state,o=i.target,s=i.pos1,l=i.pos2,u=i.pos3,c=i.pos4,f=i.targetClientRect;return o?fs([n,a],Cu([s,l,c,u],f)):!1},r.updateRect=function(n,a,i){i===void 0&&(i=!0);var o=this.props,s=o.parentMoveable,l=this.state,u=l.target||this.props.target,c=this.getContainer(),f=s?s._rootContainer:this._rootContainer,d=As(this.controlBox&&this.controlBox.getElement(),u,c,c,f||c,this._getRequestStyles());if(!u&&this._hasFirstTarget&&o.persistData){var h=Ju(o.persistData);for(var v in h)d[v]=h[v]}this.updateState(d,s?!1:i)},r.isDragging=function(n){var a,i,o=this.targetGesto,s=this.controlGesto;if(o!=null&&o.isFlag()){if(!n)return!0;var l=o.getEventData();return!!(!((a=l[n])===null||a===void 0)&&a.isEventStart)}if(s!=null&&s.isFlag()){if(!n)return!0;var l=s.getEventData();return!!(!((i=l[n])===null||i===void 0)&&i.isEventStart)}return!1},r.updateTarget=function(n){this.updateRect(n,!0)},r.getRect=function(){var n=this.state,a=Dr(this.state),i=a[0],o=a[1],s=a[2],l=a[3],u=Vr(a),c=n.width,f=n.height,d=u.width,h=u.height,v=u.left,p=u.top,g=[n.left,n.top],b=At(g,n.origin),y=At(g,n.beforeOrigin),S=n.transformOrigin;return{width:d,height:h,left:v,top:p,pos1:i,pos2:o,pos3:s,pos4:l,offsetWidth:c,offsetHeight:f,beforeOrigin:y,origin:b,transformOrigin:S,rotation:this.getRotation()}},r.getManager=function(){return this},r.stopDrag=function(n){var a,i;(!n||n==="target")&&((a=this.targetGesto)===null||a===void 0||a.stop()),(!n||n==="control")&&((i=this.controlGesto)===null||i===void 0||i.stop())},r.getRotation=function(){var n=this.state,a=n.pos1,i=n.pos2,o=n.direction;return x2(a,i,o)},r.request=function(n,a,i){a===void 0&&(a={});var o=this.props,s=o.ables,l=o.groupable,u=s.filter(function(g){return g.name===n})[0];if(this.isDragging()||!u||!u.request)return{request:function(){return this},requestEnd:function(){return this}};var c=this,f=u.request(this),d=i||a.isInstant,h=f.isControl?"controlAbles":"targetAbles",v="".concat(l?"Group":"").concat(f.isControl?"Control":""),p={request:function(g){return Pa(c,h,"drag",v,"",fe(fe({},f.request(g)),{requestAble:n,isRequest:!0}),d),this},requestEnd:function(){return Pa(c,h,"drag",v,"End",fe(fe({},f.requestEnd()),{requestAble:n,isRequest:!0}),d),this}};return Pa(c,h,"drag",v,"Start",fe(fe({},f.requestStart(a)),{requestAble:n,isRequest:!0}),d),d?p.request(a).requestEnd():p},r.destroy=function(){this.componentWillUnmount()},r.updateRenderPoses=function(){var n=this.getState(),a=this.props,i=n.originalBeforeOrigin,o=n.transformOrigin,s=n.allMatrix,l=n.is3d,u=n.pos1,c=n.pos2,f=n.pos3,d=n.pos4,h=n.left,v=n.top,p=n.isPersisted,g=a.padding||{},b=g.left,y=b===void 0?0:b,S=g.top,C=S===void 0?0:S,T=g.bottom,D=T===void 0?0:T,P=g.right,G=P===void 0?0:P,W=l?4:3,L=[];p?L=o:this.controlBox&&a.groupable?L=i:L=At(i,[h,v]),n.renderPoses=[At(u,Mi(s,[-y,-C],o,L,W)),At(c,Mi(s,[G,-C],o,L,W)),At(f,Mi(s,[-y,D],o,L,W)),At(d,Mi(s,[G,D],o,L,W))]},r.checkUpdate=function(){this._isPropTargetChanged=!1;var n=this.props,a=n.target,i=n.container,o=n.parentMoveable,s=this.state,l=s.target,u=s.container;if(!(!l&&!a)){this.updateAbles();var c=!ws(l,a),f=c||!ws(u,i);if(f){var d=i||this.controlBox;d&&this.unsetAbles(),this.updateState({target:a,container:i}),!o&&d&&this.updateRect("End",!1,!1),this._isPropTargetChanged=c}}},r.waitToChangeTarget=function(){return new Promise(function(){})},r.triggerEvent=function(n,a){this._emitter.trigger(n,a);var i=this.props[n];return i&&i(a)},r.useCSS=function(n,a){var i=this.props.customStyledMap,o=n+a;return i[o]||(i[o]=xc(n,a)),i[o]},r.getState=function(){var n,a=this.props;(a.target||!((n=a.targets)===null||n===void 0)&&n.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,o=a.persistData,s=a.firstRenderState;if(s&&!i)return s;if(!this._hasFirstTarget&&o){var l=Ju(o);if(l)return this.updateState(l,!1),this.state}return this.state.isPersisted=!1,this.state},r.updateSelectors=function(){},r.unsetAbles=function(){var n=this;this.targetAbles.forEach(function(a){a.unset&&a.unset(n)})},r.updateAbles=function(n,a){n===void 0&&(n=this.props.ables),a===void 0&&(a="");var i=this.props,o=i.triggerAblesSimultaneously,s=this.getEnabledAbles(n),l="drag".concat(a,"Start"),u="pinch".concat(a,"Start"),c="drag".concat(a,"ControlStart"),f=Ei(s,[l,u],o),d=Ei(s,[c],o);this.enabledAbles=s,this.targetAbles=f,this.controlAbles=d},r.updateState=function(n,a){if(a){if(this.isUnmounted)return;this.setState(n)}else{var i=this.state;for(var o in n)i[o]=n[o]}},r.getEnabledAbles=function(n){n===void 0&&(n=this.props.ables);var a=this.props;return n.filter(function(i){return i&&(i.always&&a[i.name]!==!1||a[i.name])})},r.renderAbles=function(){var n=this,a=this.props,i=a.triggerAblesSimultaneously,o={createElement:zr};return this.renderState={},g2(Uc(Ei(this.getEnabledAbles(),["render"],i).map(function(s){var l=s.render;return l(n,o)||[]})).filter(function(s){return s}),function(s){var l=s.key;return l}).map(function(s){return s[0]})},r.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},r._getRequestStyles=function(){var n=this.getEnabledAbles().reduce(function(a,i){var o,s,l=(s=(o=i.requestStyle)===null||o===void 0?void 0:o.call(i))!==null&&s!==void 0?s:[];return xt(xt([],a,!0),l,!0)},[]);return n},r._updateObserver=function(n){var a,i=this.props,o=i.target;if(!window.ResizeObserver||!o||!i.useResizeObserver){(a=this._observer)===null||a===void 0||a.disconnect();return}if(!(n.target===o&&this._observer)){var s=new ResizeObserver(this.checkUpdateRect);s.observe(o,{box:"border-box"}),this._observer=s}},r._updateEvents=function(){var n=this.controlBox.getElement(),a=this.targetAbles.length,i=this.controlAbles.length,o=this.props,s=o.dragTarget||o.target,l=!a&&this.targetGesto||this._isTargetChanged(!0);l&&(aa(this,"targetGesto"),this.updateState({gesto:null})),i||aa(this,"controlGesto"),s&&a&&!this.targetGesto&&(this.targetGesto=xf(this,s,"")),!this.controlGesto&&i&&(this.controlGesto=yl(this,n,"controlAbles","Control"))},r._updateTargets=function(){var n=this.props;this._prevTarget=n.dragTarget||n.target,this._prevDragArea=n.dragArea},r._renderLines=function(){var n=this.props,a=n,i=a.zoom,o=a.hideDefaultLines,s=a.hideChildMoveableDefaultLines,l=a.parentMoveable;if(o||l&&s)return[];var u=this.getState().renderPoses,c={createElement:zr};return[[0,1],[1,3],[3,2],[2,0]].map(function(f,d){var h=f[0],v=f[1];return Xa(c,"",u[h],u[v],i,"render-line-".concat(d))})},r._isTargetChanged=function(n){var a=this.props,i=a.dragTarget||a.target,o=this._prevTarget,s=this._prevDragArea,l=a.dragArea,u=!l&&o!==i,c=(n||l)&&s!==l;return u||c},r._updateNativeEvents=function(){var n=this,a=this.props,i=a.dragArea?this.areaElement:this.state.target,o=this.events,s=ma(o);if(this._isTargetChanged())for(var l in o){var u=o[l];u&&u.destroy(),o[l]=null}if(i){var c=this.enabledAbles;s.forEach(function(f){var d=Ei(c,[f]),h=d.length>0,v=o[f];if(!h){v&&(v.destroy(),o[f]=null);return}v||(v=new G_(i,n,f),o[f]=v),v.setAbles(d)})}},r._checkUpdateRootContainer=function(){var n=this.props.rootContainer;!this._rootContainer&&n&&(this._rootContainer=Un(n,!0))},r._checkUpdateViewContainer=function(){var n=this.props.viewContainer;!this._viewContainer&&n&&(this._viewContainer=Un(n,!0));var a=this._viewContainer;a&&this._changeAbleViewClassNames(xt(xt([],this._getAbleViewClassNames(),!0),[this.isDragging()?x_:""],!1))},r._changeAbleViewClassNames=function(n){var a=this._viewContainer,i=Yc(n.filter(Boolean),function(c){return c}).map(function(c){var f=c[0];return f}),o=this._viewClassNames,s=Ja(o,i),l=s.removed,u=s.added;l.forEach(function(c){J0(a,o[c])}),u.forEach(function(c){Q0(a,i[c])}),this._viewClassNames=i},r._getAbleViewClassNames=function(){var n=this;return(this.getEnabledAbles().map(function(a){var i;return((i=a.viewClassName)===null||i===void 0?void 0:i.call(a,n))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},r._getAbleClassName=function(n){var a=this;n===void 0&&(n="");var i=this.getEnabledAbles(),o=this.targetGesto,s=this.controlGesto,l=o!=null&&o.isFlag()?o.getEventData():{},u=s!=null&&s.isFlag()?s.getEventData():{};return i.map(function(c){var f,d,h,v=c.name,p=((f=c.className)===null||f===void 0?void 0:f.call(c,a))||"";return(!((d=l[v])===null||d===void 0)&&d.isEventStart||!((h=u[v])===null||h===void 0)&&h.isEventStart)&&(p+=" ".concat(bt("".concat(v).concat(n,"-dragging")))),p.trim()}).filter(Boolean).join(" ")},t.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,portalContainer:null,useResizeObserver:!1,linePadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Lc,firstRenderState:null,persistData:null,viewContainer:null,useAccuratePosition:!1},t}(qs),xl={name:"groupable",props:{defaultGroupRotate:Number,defaultGroupOrigin:String,groupable:Boolean,groupableProps:Object,targetGroups:Object,hideChildMoveableDefaultLines:Boolean},events:{},render:function(e,t){var r,n=e.props,a=n.targets||[];e.moveables=[];var i=e.getState(),o=i.left,s=i.top,l=i.isPersisted,u=[o,s],c=n.zoom||1,f=e.renderGroupRects,d=((r=n.persistData)===null||r===void 0?void 0:r.children)||[];return l?a=d.map(function(){return null}):d=[],xt(xt([],a.map(function(h,v){return t.createElement(fa,{key:"moveable"+v,ref:U0(e,"moveables",v),target:h,origin:!1,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:e,parentPosition:u,persistData:d[v],zoom:c})}),!0),Uc(f.map(function(h,v){var p=h.pos1,g=h.pos2,b=h.pos3,y=h.pos4,S=[p,g,b,y];return[[0,1],[1,3],[3,2],[2,0]].map(function(C,T){var D=C[0],P=C[1];return Xa(t,"",gt(S[D],u),gt(S[P],u),c,"group-rect-".concat(v,"-").concat(T))})})),!0)}},U_=oi("clickable",{props:{clickable:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(e,t){t.datas.inputTarget=t.inputEvent&&t.inputEvent.target},dragEnd:function(e,t){var r=e.props.target,n=t.inputEvent,a=t.inputTarget,i=e.isMoveableElement(a),o=!i&&e.controlBox.getElement().contains(a);if(!(!n||!a||t.isDrag||e.isMoveableElement(a)||o)){var s=r.contains(a);ft(e,"onClick",Mt(e,t,{isDouble:t.isDouble,inputTarget:a,isTarget:r===a,moveableTarget:e.props.target,containsTarget:s}))}},dragGroupEnd:function(e,t){var r=t.inputEvent,n=t.inputTarget;if(!(!r||!n||t.isDrag||e.isMoveableElement(n)||t.datas.inputTarget===n)){var a=e.props.targets,i=a.indexOf(n),o=i>-1,s=!1;i===-1&&(i=dn(a,function(l){return l.contains(n)}),s=i>-1),ft(e,"onClickGroup",Mt(e,t,{isDouble:t.isDouble,targets:a,inputTarget:n,targetIndex:i,isTarget:o,containsTarget:s,moveableTarget:a[i]}))}},dragControlEnd:function(e,t){this.dragEnd(e,t)},dragGroupControlEnd:function(e,t){this.dragEnd(e,t)}});function ea(e){var t=e.originalDatas.draggable;return t||(e.originalDatas.draggable={},t=e.originalDatas.draggable),fe(fe({},e),{datas:t})}var j_=oi("edgeDraggable",{css:[`.edge.edgeDraggable.line {
    cursor: move;
}`],render:function(e,t){var r=e.props,n=r.edgeDraggable;return n?uf(t,"edgeDraggable",n,e.getState().renderPoses,r.zoom):[]},dragCondition:function(e,t){var r,n=e.props,a=(r=t.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!a?!1:!n.draggable&&cr(a,bt("direction"))&&cr(a,bt("edge"))&&cr(a,bt("edgeDraggable"))},dragStart:function(e,t){return Sr.dragStart(e,ea(t))},drag:function(e,t){return Sr.drag(e,ea(t))},dragEnd:function(e,t){return Sr.dragEnd(e,ea(t))},dragGroupCondition:function(e,t){var r,n=e.props,a=(r=t.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!a?!1:!n.draggable&&cr(a,bt("direction"))&&cr(a,bt("line"))},dragGroupStart:function(e,t){return Sr.dragGroupStart(e,ea(t))},dragGroup:function(e,t){return Sr.dragGroup(e,ea(t))},dragGroupEnd:function(e,t){return Sr.dragGroupEnd(e,ea(t))},unset:function(e){return Sr.unset(e)}}),Sf={name:"individualGroupable",props:{individualGroupable:Boolean},events:{}},Sl=[bf,hf,f_,C2,Sr,j_,Ts,m_,b_,g_,C_,E_,S_,F_,L_,V_,xl,Sf,U_,pf,yf],q_=Sl.reduce(function(e,t){return fe(fe({},e),"events"in t?t.events:{})},{}),K_=Sl.reduce(function(e,t){return fe(fe({},e),t.props)},{}),Z_=_2(q_),Q_=Object.keys(Z_),J_=Object.keys(K_);function e0(e,t){var r=e[0],n=e[1],a=e[2];return(r*t[0]+n*t[1]+a)/Math.sqrt(r*r+n*n)}function Di(e,t){var r=e[0],n=e[1];return-r*t[0]-n*t[1]}function t0(e,t){return Math.max.apply(Math,e.map(function(r){var n=r[0],a=r[1],i=r[2],o=r[3];return Math.max(n[t],a[t],i[t],o[t])}))}function r0(e,t){return Math.min.apply(Math,e.map(function(r){var n=r[0],a=r[1],i=r[2],o=r[3];return Math.min(n[t],a[t],i[t],o[t])}))}function e3(e,t){var r,n=[0,0],a=[0,0],i=[0,0],o=[0,0],s=0,l=0;if(!e.length)return{pos1:n,pos2:a,pos3:i,pos4:o,minX:0,minY:0,maxX:0,maxY:0,width:s,height:l,rotation:t};var u=Et(t,Cr);if(u%90){var c=u/180*Math.PI,f=Math.tan(c),d=-1/f,h=[ys,Tu],v=[[0,0],[0,0]],p=[ys,Tu],g=[[0,0],[0,0]];e.forEach(function(Ne){Ne.forEach(function(Me){var Pe=e0([-f,1,0],Me),Se=e0([-d,1,0],Me);h[0]>Pe&&(v[0]=Me,h[0]=Pe),h[1]<Pe&&(v[1]=Me,h[1]=Pe),p[0]>Se&&(g[0]=Me,p[0]=Se),p[1]<Se&&(g[1]=Me,p[1]=Se)})});var b=v[0],y=v[1],S=g[0],C=g[1],T=[-f,1,Di([-f,1],b)],D=[-f,1,Di([-f,1],y)],P=[-d,1,Di([-d,1],S)],G=[-d,1,Di([-d,1],C)];r=[[T,P],[T,G],[D,P],[D,G]].map(function(Ne){var Me=Ne[0],Pe=Ne[1];return tl(Me,Pe)[0]}),n=r[0],a=r[1],i=r[2],o=r[3],s=p[1]-p[0],l=h[1]-h[0]}else{var W=r0(e,0),L=r0(e,1),X=t0(e,0),M=t0(e,1);if(n=[W,L],a=[X,L],i=[W,M],o=[X,M],s=X-W,l=M-L,u%180){var oe=[i,n,o,a];n=oe[0],a=oe[1],i=oe[2],o=oe[3],s=M-L,l=X-W}}if(u%360>180){var oe=[o,i,a,n];n=oe[0],a=oe[1],i=oe[2],o=oe[3]}var re=En([n,a,i,o]),be=re.minX,ze=re.minY,Ue=re.maxX,Ge=re.maxY;return{pos1:n,pos2:a,pos3:i,pos4:o,width:s,height:l,minX:be,minY:ze,maxX:Ue,maxY:Ge,rotation:t}}function wf(e,t){var r=t.map(function(n){if(or(n)){var a=wf(e,n),i=a.length;return i>1?a:i===1?a[0]:null}else{var o=vn(e,function(s){var l=s.manager;return l.props.target===n});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return r.length===1&&or(r[0])?r[0]:r}var t3=function(e){ii(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.differ=new gc,n.moveables=[],n.transformOrigin="50% 50%",n.renderGroupRects=[],n._targetGroups=[],n._hasFirstTargets=!1,n}var r=t.prototype;return r.componentDidMount=function(){e.prototype.componentDidMount.call(this)},r.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},r.getTargets=function(){return this.props.targets},r.updateRect=function(n,a,i){var o;i===void 0&&(i=!0);var s=this.state;if(!this.controlBox||s.isPersisted)return;this.moveables.forEach(function(_){_.updateRect(n,!1,!1)});var l=this.props,u=this.moveables,c=s.target||l.target,f=u.map(function(_){return{finded:!1,manager:_}}),d=this.props.targetGroups||[],h=wf(f,d);h.push.apply(h,f.filter(function(_){var Y=_.finded;return!Y}).map(function(_){var Y=_.manager;return Y}));var v=[],p=!a||n!==""&&l.updateGroup,g=l.defaultGroupRotate||0;if(!this._hasFirstTargets){var b=(o=this.props.persistData)===null||o===void 0?void 0:o.rotation;b!=null&&(g=b)}function y(_,Y,ce){var xe=_.map(function(Je){if(or(Je)){var at=y(Je,Y),Ke=[at.pos1,at.pos2,at.pos3,at.pos4];return v.push(at),{poses:Ke,rotation:at.rotation}}else return{poses:Dr(Je.state),rotation:Je.getRotation()}}),De=xe.map(function(Je){var at=Je.rotation;return at}),He=0,Ze=De[0],je=De.every(function(Je){return Math.abs(Ze-Je)<.1});p?He=je?Ze:g:He=!ce&&je?Ze:Y;var Fe=xe.map(function(Je){var at=Je.poses;return at}),pt=e3(Fe,He);return pt}var S=y(h,this.rotation,!0);p&&(this.rotation=S.rotation,this.transformOrigin=l.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=d,this.renderGroupRects=v;var C=this.transformOrigin,T=this.rotation,D=this.scale,P=S.width,G=S.height,W=S.minX,L=S.minY,X=w2([[0,0],[P,0],[0,G],[P,G]],S2(C,P,G),this.rotation/180*Math.PI),M=En(X.result),oe=M.minX,re=M.minY,be=" rotate(".concat(T,"deg)")+" scale(".concat(D[0]>=0?1:-1,", ").concat(D[1]>=0?1:-1,")"),ze="translate(".concat(-oe,"px, ").concat(-re,"px)").concat(be);this.controlBox.getElement().style.transform="translate3d(".concat(W,"px, ").concat(L,"px, ").concat(this.props.translateZ||0,")"),c.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(C,";")+"width:".concat(P,"px;height:").concat(G,"px;")+"transform: ".concat(ze),s.width=P,s.height=G;var Ue=this.getContainer(),Ge=As(this.controlBox.getElement(),c,this.controlBox.getElement(),this.getContainer(),this._rootContainer||Ue,[]),Ne=[Ge.left,Ge.top],Me=Dr(Ge),Pe=Me[0],Se=Me[1],ve=Me[2],j=Me[3],we=En([Pe,Se,ve,j]),A=[we.minX,we.minY],F=D[0]*D[1]>0?1:-1;Ge.pos1=gt(Pe,A),Ge.pos2=gt(Se,A),Ge.pos3=gt(ve,A),Ge.pos4=gt(j,A),Ge.left=W-Ge.left+A[0],Ge.top=L-Ge.top+A[1],Ge.origin=gt(At(Ne,Ge.origin),A),Ge.beforeOrigin=gt(At(Ne,Ge.beforeOrigin),A),Ge.originalBeforeOrigin=At(Ne,Ge.originalBeforeOrigin),Ge.transformOrigin=gt(At(Ne,Ge.transformOrigin),A),c.style.transform="translate(".concat(-oe-A[0],"px, ").concat(-re-A[1],"px)")+be,this.updateState(fe(fe({},Ge),{posDelta:A,direction:F,beforeDirection:F}),i)},r.getRect=function(){return fe(fe({},e.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},r.triggerEvent=function(n,a,i){if(i||n.indexOf("Group")>-1)return e.prototype.triggerEvent.call(this,n,a);this._emitter.trigger(n,a)},r.updateAbles=function(){e.prototype.updateAbles.call(this,xt(xt([],this.props.ables,!0),[xl],!1),"Group")},r._updateTargets=function(){e.prototype._updateTargets.call(this),this._prevTarget=this.props.dragTarget||this.areaElement},r._updateEvents=function(){var n=this.state,a=this.props,i=this._prevTarget,o=a.dragTarget||this.areaElement;i!==o&&(aa(this,"targetGesto"),aa(this,"controlGesto"),n.target=null),n.target||(n.target=this.areaElement,this.controlBox.getElement().style.display="block"),n.target&&(this.targetGesto||(this.targetGesto=xf(this,o,"Group")),this.controlGesto||(this.controlGesto=yl(this,this.controlBox.getElement(),"controlAbles","GroupControl")));var s=!ws(n.container,a.container);s&&(n.container=a.container);var l=a.targets,u=this.differ.update(l),c=u.added,f=u.changed,d=u.removed,h=c.length||d.length;(s||h||this.transformOrigin!==(a.defaultGroupOrigin||"50% 50%")||f.length||l.length&&!Kc(this._targetGroups,a.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!h},r._updateObserver=function(){},t.defaultProps=fe(fe({},fa.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),t}(fa),r3=function(e){ii(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.moveables=[],n}var r=t.prototype;return r.render=function(){var n=this,a,i=this.props,o=i.cspNonce,s=i.cssStyled,l=i.persistData,u=i.targets||[],c=u.length,f=this.isUnmounted||!c,d=(a=l==null?void 0:l.children)!==null&&a!==void 0?a:[];return f&&!c&&d.length?u=d.map(function(){return null}):f||(d=[]),zr(s,{cspNonce:o,ref:tn(this,"controlBox"),className:bt("control-box")},u.map(function(h,v){return zr(fa,fe({key:"moveable"+v,ref:U0(n,"moveables",v)},n.props,{target:h,wrapperMoveable:n,isWrapperMounted:n.isMoveableMounted,persistData:d[v]}))}))},r.componentDidUpdate=function(){},r.getTargets=function(){return this.props.targets},r.updateRect=function(n,a,i){i===void 0&&(i=!0),this.moveables.forEach(function(o){o.updateRect(n,a,i)})},r.getRect=function(){return fe(fe({},e.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},r.request=function(){return{request:function(){return this},requestEnd:function(){return this}}},r.dragStart=function(){return this},r.hitTest=function(){return 0},r.isInside=function(){return!1},r.isDragging=function(){return!1},r.updateRenderPoses=function(){},r.checkUpdate=function(){},r.triggerEvent=function(){},r.updateAbles=function(){},r._updateEvents=function(){},r._updateObserver=function(){},t}(fa);function Cf(e,t){var r=[];return e.forEach(function(n){if(n){if(Lr(n)){t[n]&&r.push.apply(r,t[n]);return}or(n)?r.push.apply(r,Cf(n,t)):r.push(n)}}),r}function Ef(e,t){var r=[];return e.forEach(function(n){if(n){if(Lr(n)){t[n]&&r.push.apply(r,t[n]);return}or(n)?r.push(Ef(n,t)):r.push(n)}}),r}function Mf(e,t){return e.length!==t.length||e.some(function(r,n){var a=t[n];return!r&&!a?!1:r!=a?or(r)&&or(a)?Mf(r,a):!0:!1})}var n3=function(e){ii(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.refTargets=[],n.selectorMap={},n._differ=new gc,n._elementTargets=[],n._onChangeTargets=null,n}var r=t.prototype;return t.makeStyled=function(){var n={},a=this.getTotalAbles();a.forEach(function(o){var s=o.css;s&&s.forEach(function(l){n[l]=!0})});var i=ma(n).join(`
`);this.defaultStyled=xc("div",lg(rl,Hm+i))},t.getTotalAbles=function(){return xt([hf,xl,Sf,pf],this.defaultAbles,!0)},r.render=function(){var n,a=this.constructor;a.defaultStyled||a.makeStyled();var i=this.props,o=i.ables,s=i.props,l=Lm(i,["ables","props"]),u=this._updateRefs(!0),c=Cf(u,this.selectorMap),f=c.length>1,d=a.getTotalAbles(),h=xt(xt([],d,!0),o||[],!0),v=fe(fe(fe({},l),s||{}),{ables:h,cssStyled:a.defaultStyled,customStyledMap:a.customStyledMap});this._elementTargets=c;var p=null,g=this.moveable,b=l.persistData;if(b!=null&&b.children&&(f=!0),f){if(l.individualGroupable)return zr(r3,fe({key:"individual-group",ref:tn(this,"moveable")},v,{target:null,targets:c}));var y=Ef(u,this.selectorMap);if(g&&!g.props.groupable&&!g.props.individualGroupable){var S=g.props.target;S&&c.indexOf(S)>-1&&(p=fe({},g.state))}return zr(t3,fe({key:"group",ref:tn(this,"moveable")},v,(n=l.groupableProps)!==null&&n!==void 0?n:{},{target:null,targets:c,targetGroups:y,firstRenderState:p}))}else{var C=c[0];if(g&&(g.props.groupable||g.props.individualGroupable)){var T=g.moveables||[],D=vn(T,function(P){return P.props.target===C});D&&(p=fe({},D.state))}return zr(fa,fe({key:"single",ref:tn(this,"moveable")},v,{target:C,firstRenderState:p}))}},r.componentDidMount=function(){this._checkChangeTargets(),this._updateRefs()},r.componentDidUpdate=function(){this._checkChangeTargets()},r.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},r.getTargets=function(){var n,a;return(a=(n=this.moveable)===null||n===void 0?void 0:n.getTargets())!==null&&a!==void 0?a:[]},r.updateSelectors=function(){this.selectorMap={},this._updateRefs()},r.waitToChangeTarget=function(){var n=this,a;return this._onChangeTargets=function(){n._onChangeTargets=null,a()},new Promise(function(i){a=i})},r.waitToChangeTargets=function(){return this.waitToChangeTarget()},r.getManager=function(){return this.moveable},r._updateRefs=function(n){var a=this.refTargets,i=fl(this.props.target||this.props.targets),o=typeof document<"u",s=Mf(a,i),l=this.selectorMap,u={};return this.refTargets.forEach(function c(f){if(Lr(f)){var d=l[f];d?u[f]=l[f]:o&&(s=!0,u[f]=[].slice.call(document.querySelectorAll(f)))}else or(f)&&f.forEach(c)}),this.refTargets=i,this.selectorMap=u,!n&&s&&this.forceUpdate(),i},r._checkChangeTargets=function(){var n,a,i,o=this._differ.update(this._elementTargets),s=o.added,l=o.removed,u=s.length||l.length;u&&((a=(n=this.props).onChangeTargets)===null||a===void 0||a.call(n,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this)),this._updateRefs()},t.defaultAbles=[],t.customStyledMap={},t.defaultStyled=null,Fm([ug(Ec)],t.prototype,"moveable",void 0),t}(qs),a3=function(e){ii(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.defaultAbles=Sl,t}(n3),i3=a3;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Is=function(e,t){return Is=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},Is(e,t)};function wl(e,t){Is(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ya=function(){return Ya=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ya.apply(this,arguments)};function o3(e,t,r,n){var a=arguments.length,i=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}var s3=function(e){wl(t,e);function t(n){var a=e.call(this,n)||this;return a.state={},a.state=a.props,a}var r=t.prototype;return r.render=function(){return Xg(zr(i3,Ya({ref:tn(this,"moveable")},this.state)),this.state.parentElement)},t}(js),Ui=J_,kf=Ec,Tf=Q_,l3=function(e){wl(t,e);function t(n,a){a===void 0&&(a={});var i=e.call(this)||this;i.tempElement=document.createElement("div");var o=Ya({},a),s={};Tf.forEach(function(u){s[Mg("on ".concat(u))]=function(c){return i.trigger(u,c)}}),Su(zr(s3,Ya({ref:tn(i,"innerMoveable"),parentElement:n},o,s)),i.tempElement);var l=o.target;return or(l)&&l.length>1&&i.updateRect(),i}var r=t.prototype;return r.setState=function(n,a){this.innerMoveable.setState(n,a)},r.forceUpdate=function(n){this.innerMoveable.forceUpdate(n)},r.dragStart=function(n){var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(n)},r.destroy=function(){Su(null,this.tempElement),this.off(),this.tempElement=null,this.innerMoveable=null},r.getMoveable=function(){return this.innerMoveable.moveable},t=o3([hu(kf,function(n,a){n[a]||(n[a]=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s=this.getMoveable();if(!(!s||!s[a]))return s[a].apply(s,i)})}),hu(Ui,function(n,a){Object.defineProperty(n,a,{get:function(){return this.getMoveable().props[a]},set:function(i){var o;this.setState((o={},o[a]=i,o))},enumerable:!0,configurable:!0})})],t),t}(so),u3=function(e){wl(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(l3),La=function(){return La=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},La.apply(this,arguments)},Rf={};kf.forEach(function(e){Rf[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=this.$_moveable)[e].apply(t,r)}});var Df={};Ui.forEach(function(e){Df[e]=function(t){this.$_moveable[e]=t}});var Cl=vt({name:"moveable",methods:Rf,props:Ui,watch:Df,mounted:function(){var e=this,t={},r=this.$props;Ui.forEach(function(o){var s=r[o];ei(s)||(t[o]=r[o])});var n=this.$refs,a=n.moveableElement,i=new u3(a,La(La({},t),{portalContainer:a}));Tf.forEach(function(o){i.on(o,function(s){e.$emit(o,La({},s))})}),this.$_moveable=i},beforeUnmount:function(){this.$_moveable.destroy()}});const c3={ref:"moveableElement"};function f3(e,t,r,n,a,i){return se(),Te("div",c3,null,512)}Cl.render=f3;Cl.__file="src/Moveable.vue";const d3=["data-eleId","data-lineIndex","data-itemIndex","onClick","onMousedown"],v3=vt({__name:"PlayerMoveable",props:{canvasSize:{type:Object,default(){return{width:0,height:0}}}},setup(e){const t=Nr(),r=sr(),n=rt(),a=rt(),i=rt(),o=Xe(()=>{if(t.playerHeight===0&&t.playerWidth===0)return[];const d=[];return r.trackList.forEach(({list:h,type:v},p)=>{if(v==="audio")return;const g=h.findIndex((y,S)=>!!(t.playStartFrame>=y.start&&t.playStartFrame<=y.end&&y.draw)),b=h[g];b&&d.unshift({lineIndex:p,itemIndex:g,id:b.id,scale:b.scale/100,x:b.centerX,y:b.centerY,w:b.width,h:b.height,left:t.playerWidth/2-b.width/2,top:t.playerHeight/2-b.height/2})}),a.value&&a.value.updateRect(),d}),s=hr({target:i,className:"cc-move",container:n.value,...Jd});function l(d){console.log("🚀 ~ selectItem ~ Element Id:",d),t.isPause=!0,r.selectTrackById(d)}function u(d){let{target:h,transform:v,translate:p}=d;const{lineindex:g,itemindex:b}=h.dataset,[y,S]=p;r.trackList[g].list[b].centerX=y,r.trackList[g].list[b].centerY=S,h.style.transform=v}function c(d){let{target:h,scale:v,transform:p}=d;const{lineindex:g,itemindex:b}=h.dataset,y=Math.max(Math.round(v[0]*100),1);r.trackList[g].list[b].scale=y,h.style.transform=p}function f(d,h){d.stopPropagation(),t.isPause=!0,r.selectTrackById(h),i.value=d.currentTarget,Tr(()=>{a.value.dragStart(d)})}return Nt([r.selectTrackItem,o],()=>{if(n.value&&r.selectTrackItem.line!==-1&&r.selectTrackItem.index!==-1){const d=r.trackList[r.selectTrackItem.line].list[r.selectTrackItem.index];d&&o.value.find(h=>h.id===d.id)?i.value=n.value.querySelector(`.move-target[data-eleid='${d.id}']`):i.value=null}else i.value=null},{immediate:!0,flush:"post"}),(d,h)=>(se(),Te("div",{ref_key:"moveContainer",ref:n,class:"absolute left-0 right-0 top-0 bottom-0 m-auto"},[(se(!0),Te(jt,null,er(o.value,(v,p)=>(se(),Te("div",{key:v.id,"data-eleId":v.id,"data-lineIndex":v.lineIndex,"data-itemIndex":v.itemIndex,style:Ct({zIndex:p,top:`${v.top}px`,left:`${v.left}px`,width:`${v.w}px`,height:`${v.h}px`,transform:`translate(${v.x}px, ${v.y}px) scale(${v.scale})`}),class:"move-target absolute",onClick:ar(g=>l(v.id),["stop"]),onMousedown:g=>f(g,v.id)},null,44,d3))),128)),Z(B(Cl),Wn({ref_key:"moveable",ref:a},s,{onDrag:u,onScale:c}),null,16)],512))}}),p3={class:"flex items-center justify-center h-8 my-2"},h3={class:"m-auto flex items-center gap-4"},g3={class:"text-xs text-purple inline-block"},m3={class:"text-xs"},_3=vt({__name:"PlayerControl",setup(e){const t=Nr(),r=sr(),n=Xe(()=>Zl(t.playStartFrame)),a=Xe(()=>Zl(r.frameCount)),i=Xe(()=>[{title:"回退1s [<-]",disable:r.frameCount===0,icon:"BackwardIcon",handler:()=>{r.frameCount!==0&&t.backward()}},{title:"播放/暂停 [Space]",disable:r.frameCount===0,icon:t.isPause?"PauseIcon":"PlayIcon",handler:()=>{r.frameCount!==0&&(t.isPause=!t.isPause)}},{title:"快进1s [->]",disable:r.frameCount===0,icon:"ForwardIcon",handler:()=>{r.frameCount!==0&&t.forward()}}]);return(o,s)=>{const l=Ht,u=va;return se(),Te("div",p3,[ue("div",h3,[ue("span",g3,dt(B(n)),1),(se(!0),Te(jt,null,er(B(i),(c,f)=>(se(),_t(u,{key:f,effect:"light",content:c.title},{default:Ce(()=>[Z(l,{size:18,class:Ye(["cursor-pointer box-content",[c.disable?"cursor-not-allowed":"cursor-pointer"]]),onClick:c.handler},{default:Ce(()=>[(se(),_t(en(c.icon)))]),_:2},1032,["class","onClick"])]),_:2},1032,["content"]))),128)),ue("span",m3,dt(B(a)),1)])])}}});var $r,Af,If,Bf,Of,Bs;class b3{constructor(t){$l(this,$r);this.playerStore=Nr(),this.trackState=sr(),this.canvasSize=hr({width:0,height:0}),this.playerTimer=0,this.playerContext=null,this.audioPlayAt=0,this.audioContext=new AudioContext,this.captureAudioDest=this.audioContext.createMediaStreamDestination(),this.playingAudioCache=new Set,this.player=t.player,this.playerContext=this.player.value.getContext("bitmaprenderer"),Nt([()=>this.trackState.trackList,()=>this.canvasSize,()=>this.playerStore.playStartFrame],()=>In(this,$r,Af).call(this),{deep:!0}),Nt(()=>this.playerStore.isPause,()=>{this.playerStore.isPause?In(this,$r,Bs).call(this):In(this,$r,Of).call(this)})}}$r=new WeakSet,Af=async function(){if(this.playerStore.ingLoadingCount!==0)return;const t=[],r=[];this.playerStore.playingTracks.forEach(async n=>{n instanceof Dd?r.push(n):t.unshift(n)}),t.push(...r),In(this,$r,If).call(this,t),this.playerStore.isPause||In(this,$r,Bf).call(this,r)},If=async function(t){const r=new OffscreenCanvas(this.playerStore.playerWidth,this.playerStore.playerHeight),n=r.getContext("2d");for(const a of t)await a.draw(n,this.playerStore.playerWidth,this.playerStore.playerHeight,this.playerStore.playStartFrame);this.playerContext&&this.playerContext.transferFromImageBitmap(r.transferToImageBitmap())},Bf=async function(t){var i;const r=[];for(const o of t){const s=await o.render(this.audioContext,this.playerStore.playStartFrame);s&&r.push(s)}const n=Math.max(this.audioContext.currentTime,this.audioPlayAt);let a=0;for(const o of r)o.start(n),o.connect(this.audioContext.destination),o.connect(this.captureAudioDest),this.playingAudioCache.add(o),o.onended=()=>{o.disconnect(),this.playingAudioCache.delete(o)},a=Math.max(a,((i=o.buffer)==null?void 0:i.duration)??0);this.audioPlayAt=n+a},Of=function(){this.playerStore.playStartFrame>=this.trackState.frameCount&&(this.playerStore.playStartFrame=0),this.audioContext.resume(),this.audioPlayAt=0,this.playerTimer=Rd(()=>{this.playerStore.playStartFrame++,this.playerStore.playStartFrame>=this.trackState.frameCount&&In(this,$r,Bs).call(this)},1e3/br)},Bs=function(){var t;(t=this.playerTimer)==null||t.cancel(),this.audioContext.suspend();for(const r of this.playingAudioCache)r.stop(),r.disconnect();this.playingAudioCache.clear()};const y3={class:"h-full flex flex-col dark:bg-night bg-gray-100"},x3={class:"flex-1 relative overflow-hidden"},S3={key:0,class:"absolute left-0 right-0 top-0 bottom-0 z-20 flex justify-center items-center"},w3=vt({__name:"Player",props:{containerSize:{type:Object,default(){return{width:0,height:0}}}},setup(e){const t=e,r=Nr(),{playerWidth:n,playerHeight:a}=Ad(r),i=sr(),o=rt(),s=rt(),l=Xe(()=>{let{width:u,height:c}=t.containerSize;return c-=70,u-=10,Math.min(u/n.value,c/a.value)});return Gr(()=>{s.value=new b3({player:o})}),(u,c)=>{const f=Ht;return se(),Te("div",y3,[ue("div",x3,[Kt(ue("canvas",{ref_key:"playerCanvas",ref:o,class:"absolute left-0 right-0 top-0 bottom-0 m-auto bg-gray-900",id:"player",style:Ct({zoom:B(l),width:`${B(n)}px`,height:`${B(a)}px`})},null,4),[[Hr,B(i).frameCount>0]]),B(i).frameCount===0?(se(),Te("div",S3,[Z(f,{size:144,class:"box-content opacity-50",style:{color:"#FDE68A"}},{default:Ce(()=>[Z(B(Id))]),_:1})])):ct("",!0),Z(v3,{style:Ct({zoom:B(l),width:`${B(n)}px`,height:`${B(a)}px`})},null,8,["style"])]),Z(_3)])}}}),C3=vt({__name:"CanvasPlayer",setup(e){const t=pa(),r=Nr(),n=sr(),a=rt(),i=hr({width:0,height:0});function o(l){l.stopPropagation(),n.selectTrackItem.line=-1,n.selectTrackItem.index=-1}function s(){const{width:l,height:u}=a.value.getBoundingClientRect();i.width=l,i.height=u}return Gr(()=>{s()}),window.addEventListener("resize",s,!1),Nt(()=>[t.trackHeight,t.attrWidth],()=>{s()}),Nt([()=>r.playerHeight,()=>r.playerWidth],()=>{s()}),(l,u)=>(se(),Te("div",{ref_key:"playerContent",ref:a,class:"flex-1 overflow-hidden relative",onClick:o},[Z(w3,{"container-size":i},null,8,["container-size"])],512))}}),E3={class:"px-4 w-full h-10 border-b dark:border-night-light"},M3={class:"float-left h-9 w-32 flex flex-row gap-3 flex-nowrap items-center justify-around"},k3=["onClick"],T3={class:"float-right flex w-52 h-9 justify-center items-center gap-4"},R3=vt({__name:"TrackControl",props:{modelValue:{type:Number,default:30}},emits:{"update:modelValue":e=>e!==null},setup(e,{emit:t}){const r=e,n=t,a=Xe({get(){return r.modelValue},set(c){n("update:modelValue",c)}}),i=sr();Nr();const o=rt({fontSize:"1.75rem",padding:"0.25rem",boxSizing:"content-box"}),s=hr({showTooltip:!1,size:"small",step:10,max:100,min:0});function l(c){let f=a.value+c;f>s.max&&(f=s.max),f<s.min&&(f=s.min),a.value=f}const u=Xe(()=>[{title:"撤销[Ctrl+Z]",icon:"UndoIcon",handler:i._undo},{title:"恢复[Ctrl+Shift+Z]",icon:"RedoIcon",handler:i._redo},{title:"左链接[L]",disable:i.selectTrackItem.index===-1,icon:"LeftLinkIcon",handler:i.leftLink},{title:"分割[S]",disable:i.selectTrackItem.index===-1,icon:"SplitIcon",handler:i.splitTrack},{title:"删除[Backspace]",disable:i.selectTrackItem.index===-1,icon:"DeleteIcon",handler:i.removeTrack},{title:"文字[T]",disable:!1,icon:"AddTextIcon",handler:i.addText}]);return(c,f)=>{const d=Ht,h=va,v=Bd,p=Ka,g=Od;return se(),Te("div",E3,[ue("div",M3,[(se(!0),Te(jt,null,er(u.value,b=>(se(),Te("div",{key:b.title,onClick:b.handler},[Z(h,{effect:"light",content:b.title},{default:Ce(()=>[Z(d,{size:"15",class:Ye(["focus:outline-0",b.disable?"cursor-not-allowed text-gray-400":"cursor-pointer"])},{default:Ce(()=>[(se(),_t(en(b.icon)))]),_:2},1032,["class"])]),_:2},1032,["content"])],8,k3))),128))]),ue("div",T3,[Z(v,{style:Ct(o.value),class:"cursor-pointer",onClick:f[0]||(f[0]=b=>l(-10))},null,8,["style"]),Z(p,Wn({modelValue:a.value,"onUpdate:modelValue":f[1]||(f[1]=b=>a.value=b)},s),null,16,["modelValue"]),Z(g,{style:Ct(o.value),class:"cursor-pointer",onClick:f[2]||(f[2]=b=>l(10))},null,8,["style"])])])}}}),El=e=>new Map([[100,100],[90,50],[80,20],[70,10],[60,80],[50,40],[40,20],[30,10],[20,40],[10,25],[0,10]]).get(e)||100,xr=(e,t)=>{let n=El(e)*t;return e<70&&(n=n/br),e<30&&(n=n/6),n},D3=(e,t)=>e>60?t:10,A3=(e,t)=>{let r=e;return t<30?r*=60:t<70&&(r*=10),Pd(r*1e3).str},I3=(e,t,r)=>{const n=e%t;let a="";return r<70?"":(a=r>80?n===0?"":`${n<10?"0":""}${n}f`:"",a)},Ai=.5,Nn=(e,t,r)=>{const n=El(t);return t<70&&(e*=r),t<30&&(e*=6),Math.round(e/n)},B3=(e,t,r)=>{const{start:n,scale:a,step:i,focusPosition:o}=t,{ratio:s,bgColor:l,width:u,height:c,textColor:f,subTextColor:d,textSize:h,textScale:v,focusColor:p,longColor:g,shortColor:b}=r,y=D3(a,i);e.scale(s,s),e.clearRect(0,0,u,c),e.fillStyle=l,e.fillRect(0,0,u,c);const S=El(a),C=S*y,T=Math.floor(n/S)*S,D=Math.floor(n/C)*C,P=T-n,G=D-n,W=n+Math.ceil(u);if(o){let L=o.start,X=o.end-o.start;a<70&&(L=L/i,X=X/i),a<30&&(L=L/6,X=X/6);const M=L*S+Ai-n,oe=X*S-Ai;oe>S&&(e.fillStyle=p,e.fillRect(M,0,oe,c*3/8))}e.beginPath(),e.fillStyle=f,e.strokeStyle=g;for(let L=D,X=0;L<W;L+=C,X++){const M=G+X*C+Ai;e.moveTo(M,0),e.save(),e.translate(M,c*.4),e.scale(v/s,v/s);const oe=A3(L/C,a),re=oe.length*5*v*s,be=h/s*v/s/2;e.fillText(oe,re,be),e.restore(),e.lineTo(M,c*10/16/s)}e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=d,e.strokeStyle=b;for(let L=T,X=0;L<W;L+=S,X++){const M=P+X*S+Ai;e.moveTo(M,0);const oe=I3(L/S,y,a);if(oe){e.save(),e.translate(M,c*.4),e.scale(v/s,v/s);const re=oe.length*5*v*s,be=h/s*v/s/2;e.fillText(oe,re,be),e.restore()}L%C!==0&&e.lineTo(M,c/3/s)}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},O3=vt({__name:"TimeLine",props:{start:{type:Number,default:0},step:{type:Number,default:br},scale:{type:Number,default:0},focusPosition:{type:Object,default(){return{start:0,end:0}}}},emits:{selectFrame(e){return e!==null}},setup(e,{emit:t}){const r=e,n=t,a=rt(),i=rt();let o={};const{isDark:s}=Ki(pa()),l=Xe(()=>({bgColor:s.value?"#374151":"#E5E7EB",ratio:window.devicePixelRatio||1,textSize:12,textScale:.83,lineWidth:1,textBaseline:"middle",textAlign:"center",longColor:s.value?"#E5E7EB":"#374151",shortColor:s.value?"#9CA3AF":"#6B7280",textColor:s.value?"#E5E7EB":"#374151",subTextColor:s.value?"#9CA3AF":"#6B7280",focusColor:s.value?"#6D28D9":"#C4B5FD"})),u=hr({width:0,height:0}),c=Xe(()=>({width:`${u.width/l.value.ratio}px`,height:`${u.height/l.value.ratio}px`}));function f(){B3(o,{...r},{...u,...l.value})}function d(){o=i.value.getContext("2d"),o.font=`${l.value.textSize*l.value.ratio}px -apple-system, ".SFNSText-Regular", "SF UI Text", "PingFang SC", "Hiragino Sans GB", "Helvetica Neue", "WenQuanYi Zen Hei", "Microsoft YaHei", Arial, sans-serif`,o.lineWidth=l.value.lineWidth,o.textBaseline=l.value.textBaseline,o.textAlign=l.value.textAlign}function h(){const{width:p,height:g}=a.value.getBoundingClientRect();u.width=p*l.value.ratio,u.height=g*l.value.ratio,Tr(()=>{d(),f()})}function v(p){const g=p.offsetX,b=Nn(r.start+g,r.scale,r.step);n("selectFrame",b)}return Gr(()=>{h()}),Nt(l,f),Nt(r,f),window.addEventListener("resize",h,!1),(p,g)=>(se(),Te("div",{ref_key:"canvasContainer",ref:a,class:"sticky top-0 left-0 right-0 h-5 text-center leading-5 text-sm z-20"},[ue("canvas",Wn({style:c.value},u,{ref_key:"timeLine",ref:i,onClick:v}),null,16)],512))}}),P3=vt({__name:"TrackHandler",props:{isActive:{type:Boolean,default:!1},lineIndex:{type:Number,default:0},itemIndex:{type:Number,default:0}},setup(e){const t=e,r=sr(),n=Nr(),a=Xe(()=>r.trackList[t.lineIndex].list[t.itemIndex]),i=rt();let o=0,s={isVA:!1,start:0,end:0,offsetR:0,offsetL:0,minStart:0,maxStart:0,minEnd:0,maxEnd:0},l=!1,u=[];function c(g,b=10){const y=[];u.forEach(C=>{Math.abs(C.left-g)<=b&&y.push({position:C.left,frame:C.start}),Math.abs(C.right-g)<=b&&y.push({position:C.right,frame:C.end})});const S=xr(r.trackScale,n.playStartFrame);return Math.abs(S-g)<=b&&y.push({position:S,frame:n.playStartFrame}),y}function f(g,b){return b.length===0?void 0:b.reduce((S,C)=>Math.abs(C.position-g)<Math.abs(S.position-g)?C:S,{position:Number.MAX_SAFE_INTEGER,frame:0})}const d=Xe(()=>xr(r.trackScale,1));function h(g,b){const y=t.itemIndex>0?g[t.itemIndex-1]:null,S=t.itemIndex<g.length?g[t.itemIndex+1]:null,C=["video","audio"].includes(b.type),T={isVA:C,start:b.start,end:b.end,offsetR:b.offsetR,offsetL:b.offsetL,minStart:y?y.end:0,maxStart:b.end-1,minEnd:b.start+1,maxEnd:S?S.start:br*60*60};if(C){const D=b.frameCount-T.offsetL,P=b.frameCount-T.offsetR;T.maxEnd=S?Math.min(S.start,T.start+D):Math.min(D+T.start,br*60*60),T.minStart=y?Math.max(y.end,T.end-P):Math.max(T.end-P,0)}Object.assign(s,{...T})}function v(g,b){const{isVA:y,start:S,end:C,offsetR:T,offsetL:D,minStart:P,maxStart:G,minEnd:W,maxEnd:L}=s,X=C-S,M=D+X,oe=T+X;if(b==="left"){let re=S+g;re>G&&(re=G),re<P&&(re=P);let be=re-S;y?(C-re>M&&(re=C-M,be=re-S),r.trackList[t.lineIndex].list[t.itemIndex].offsetL=Math.max(D+be,0)):r.trackList[t.lineIndex].list[t.itemIndex].frameCount=C-re,r.trackList[t.lineIndex].list[t.itemIndex].start=re}else{let re=C+g;if(re>L&&(re=L),re<W&&(re=W),y){re-S>oe&&(re=S+oe);const be=re-C;r.trackList[t.lineIndex].list[t.itemIndex].offsetR=Math.max(T-be,0)}else r.trackList[t.lineIndex].list[t.itemIndex].frameCount=re-S;r.trackList[t.lineIndex].list[t.itemIndex].end=re}}function p(g,b){var P;g.preventDefault(),g.stopPropagation(),u=[];for(let G=0;G<r.trackList.length;G++)for(let W=0;W<r.trackList[G].list.length;W++)if(G!==t.lineIndex||W!==t.itemIndex){const L=r.trackList[G].list[W];u.push({start:L.start,end:L.end,left:xr(r.trackScale,L.start),right:xr(r.trackScale,L.end)})}n.isPause=!0;const{pageX:y}=g;o=y,l=!0,h(((P=r.trackList[t.lineIndex])==null?void 0:P.list)||[],a.value);const S=a.value.start,C=a.value.end,T=i.value.closest(".trackItem"),D=b==="left"?T.offsetLeft:T.offsetLeft+T.offsetWidth;document.onmousemove=G=>{if(!l)return;const{pageX:W}=G,L=o-W,X=c(D-L);r.dragData.fixLines=[X];const M=f(D-L,X),oe=M!=null&&M.frame?b==="left"?M.frame-S:M.frame-C:-Math.round(L/d.value);v(oe,b)},document.onmouseup=()=>{l=!1,document.onmouseup=null,document.onmousemove=null}}return(g,b)=>Kt((se(),Te("div",{class:Ye(["absolute left-0 right-0 top-0 bottom-0 border z-20",{"dark:border-gray-100 border-gray-600":e.isActive}]),ref_key:"el",ref:i},[ue("div",{class:"cursor-c-resize flex flex-col justify-center absolute -top-px -bottom-px -left-2 text-center rounded-tl rounded-bl w-2 dark:bg-gray-100 bg-gray-500 dark:text-gray-800 text-gray-100",ref:"handlerLeft",onMousedown:b[0]||(b[0]=y=>p(y,"left"))},b[2]||(b[2]=[ue("span",null,"|",-1)]),544),ue("div",{class:"cursor-c-resize flex flex-col justify-center absolute -top-px -bottom-px -right-2 text-center rounded-tr rounded-br w-2 dark:bg-gray-100 bg-gray-500 dark:text-gray-800 text-gray-100",ref:"handlerRight",onMousedown:b[1]||(b[1]=y=>p(y,"right"))},b[3]||(b[3]=[ue("span",null,"|",-1)]),544)],2)),[[Hr,e.isActive]])}}),L3={},F3={class:"loading absolute top-0 left-0 right-0 bottom-0 bg-gray-600 flex flex-row justify-start items-center"};function $3(e,t){return se(),Te("div",F3,t[0]||(t[0]=[ue("span",null,null,-1),ue("span",null,null,-1),ue("span",null,null,-1),ue("span",null,null,-1),ue("span",null,null,-1)]))}const Ml=ln(L3,[["render",$3],["__scopeId","data-v-5979cec8"]]),N3={class:"flex flex-col rounded overflow-hidden h-full"},z3={class:"flex items-center text-xs pl-2 overflow-hidden h-5 leading-5 bg-[#4b4f54] text-white"},V3={key:0,class:"mr-4 shrink-0"},H3={class:"shrink-0"},G3=["src"],W3={key:0,class:"pl-2 overflow-hidden h-4 flex items-center bg-gray-700 relative text-xs overflow-ellipsis whitespace-nowrap text-white"},X3=vt({__name:"VideoItem",props:{trackItem:{type:Object}},setup(e){const t=e,r=Nr(),n=sr(),a=rt(),i=rt(!0),o=rt([]),s=Xe(()=>t.trackItem.resource);async function l(){if(!s.value){console.error("Video resource not found");return}try{r.ingLoadingCount++,i.value=!0;const u=xr(n.trackScale,t.trackItem.frameCount),c=Math.ceil(u/50),f=Math.ceil(s.value.duration*1e6/c),d=await Ld.thumbnails(t.trackItem,n.trackScale,f);o.value=d.map(({img:h})=>URL.createObjectURL(h))}finally{i.value=!1,r.ingLoadingCount--}}return Nt(()=>[t.trackItem,s.value],l,{immediate:!0,flush:"post"}),k0(()=>{o.value.forEach(u=>{URL.revokeObjectURL(u)})}),(u,c)=>{var h;const f=$s,d=Ht;return se(),Te("div",N3,[ue("div",z3,[Z(d,{size:"18"},{default:Ce(()=>[Z(f,{class:"inline-block mr-2 shrink-0"})]),_:1}),B(s)?(se(),Te("span",V3," ["+dt(B(s).duration.toFixed(1))+"s] ",1)):ct("",!0),ue("span",H3,dt(`${e.trackItem.name}.${e.trackItem.format}`),1)]),ue("div",{ref_key:"container",ref:a,class:"bg-gray-400 bg-opacity-70 flex-1 relative whitespace-nowrap overflow-hidden",style:Ct({left:`-${B(xr)(B(n).trackScale,e.trackItem.offsetL)}px`})},[(se(!0),Te(jt,null,er(B(o),(v,p)=>(se(),Te("img",{key:p,src:v,alt:"",class:"image-item",draggable:"false"},null,8,G3))),128))],4),(h=B(s).meta)!=null&&h.prompt?(se(),Te("div",W3,[ue("span",null,dt(B(s).meta.prompt),1)])):ct("",!0),Kt(Z(Ml,{class:"pl-12 bg-opacity-70"},null,512),[[Hr,B(i)||e.trackItem.loading]])])}}});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function fr(e,t,r,n){return new(r||(r=Promise))(function(a,i){function o(u){try{l(n.next(u))}catch(c){i(c)}}function s(u){try{l(n.throw(u))}catch(c){i(c)}}function l(u){var c;u.done?a(u.value):(c=u.value,c instanceof r?c:new r(function(f){f(c)})).then(o,s)}l((n=n.apply(e,[])).next())})}class ui{constructor(){this.listeners={}}on(t,r,n){if(this.listeners[t]||(this.listeners[t]=new Set),this.listeners[t].add(r),n==null?void 0:n.once){const a=()=>{this.un(t,a),this.un(t,r)};return this.on(t,a),a}return()=>this.un(t,r)}un(t,r){var n;(n=this.listeners[t])===null||n===void 0||n.delete(r)}once(t,r){return this.on(t,r,{once:!0})}unAll(){this.listeners={}}emit(t,...r){this.listeners[t]&&this.listeners[t].forEach(n=>n(...r))}}const n0={decode:function(e,t){return fr(this,void 0,void 0,function*(){const r=new AudioContext({sampleRate:t});return r.decodeAudioData(e).finally(()=>r.close())})},createBuffer:function(e,t){return typeof e[0]=="number"&&(e=[e]),function(r){const n=r[0];if(n.some(a=>a>1||a<-1)){const a=n.length;let i=0;for(let o=0;o<a;o++){const s=Math.abs(n[o]);s>i&&(i=s)}for(const o of r)for(let s=0;s<a;s++)o[s]/=i}}(e),{duration:t,length:e[0].length,sampleRate:e[0].length/t,numberOfChannels:e.length,getChannelData:r=>e==null?void 0:e[r],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function Pf(e,t){const r=t.xmlns?document.createElementNS(t.xmlns,e):document.createElement(e);for(const[n,a]of Object.entries(t))if(n==="children")for(const[i,o]of Object.entries(t))typeof o=="string"?r.appendChild(document.createTextNode(o)):r.appendChild(Pf(i,o));else n==="style"?Object.assign(r.style,a):n==="textContent"?r.textContent=a:r.setAttribute(n,a.toString());return r}function a0(e,t,r){const n=Pf(e,t||{});return r==null||r.appendChild(n),n}var Y3=Object.freeze({__proto__:null,createElement:a0,default:a0});const U3={fetchBlob:function(e,t,r){return fr(this,void 0,void 0,function*(){const n=yield fetch(e,r);if(n.status>=400)throw new Error(`Failed to fetch ${e}: ${n.status} (${n.statusText})`);return function(a,i){fr(this,void 0,void 0,function*(){if(!a.body||!a.headers)return;const o=a.body.getReader(),s=Number(a.headers.get("Content-Length"))||0;let l=0;const u=f=>fr(this,void 0,void 0,function*(){l+=(f==null?void 0:f.length)||0;const d=Math.round(l/s*100);i(d)}),c=()=>fr(this,void 0,void 0,function*(){let f;try{f=yield o.read()}catch{return}f.done||(u(f.value),yield c())});c()})}(n.clone(),t),n.blob()})}};class j3 extends ui{constructor(t){super(),this.isExternalMedia=!1,t.media?(this.media=t.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),t.mediaControls&&(this.media.controls=!0),t.autoplay&&(this.media.autoplay=!0),t.playbackRate!=null&&this.onMediaEvent("canplay",()=>{t.playbackRate!=null&&(this.media.playbackRate=t.playbackRate)},{once:!0})}onMediaEvent(t,r,n){return this.media.addEventListener(t,r,n),()=>this.media.removeEventListener(t,r,n)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const t=this.getSrc();t.startsWith("blob:")&&URL.revokeObjectURL(t)}canPlayType(t){return this.media.canPlayType(t)!==""}setSrc(t,r){if(this.getSrc()===t)return;this.revokeSrc();const n=r instanceof Blob&&this.canPlayType(r.type)?URL.createObjectURL(r):t;this.media.src=n}destroy(){this.media.pause(),this.isExternalMedia||(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(t){this.media=t}play(){return fr(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(t){this.media.currentTime=t}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(t){this.media.volume=t}getMuted(){return this.media.muted}setMuted(t){this.media.muted=t}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(t,r){r!=null&&(this.media.preservesPitch=r),this.media.playbackRate=t}getMediaElement(){return this.media}setSinkId(t){return this.media.setSinkId(t)}}class _o extends ui{constructor(t,r){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.subscriptions=[],this.options=t;const n=this.parentFromOptionsContainer(t.container);this.parent=n;const[a,i]=this.initHtml();n.appendChild(a),this.container=a,this.scrollContainer=i.querySelector(".scroll"),this.wrapper=i.querySelector(".wrapper"),this.canvasWrapper=i.querySelector(".canvases"),this.progressWrapper=i.querySelector(".progress"),this.cursor=i.querySelector(".cursor"),r&&i.appendChild(r),this.initEvents()}parentFromOptionsContainer(t){let r;if(typeof t=="string"?r=document.querySelector(t):t instanceof HTMLElement&&(r=t),!r)throw new Error("Container not found");return r}initEvents(){const t=n=>{const a=this.wrapper.getBoundingClientRect(),i=n.clientX-a.left,o=n.clientX-a.left;return[i/a.width,o/a.height]};this.wrapper.addEventListener("click",n=>{const[a,i]=t(n);this.emit("click",a,i)}),this.wrapper.addEventListener("dblclick",n=>{const[a,i]=t(n);this.emit("dblclick",a,i)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:n,scrollWidth:a,clientWidth:i}=this.scrollContainer,o=n/a,s=(n+i)/a;this.emit("scroll",o,s)});const r=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{r().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}onContainerResize(){const t=this.parent.clientWidth;t===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=t,this.reRender())}initDrag(){this.subscriptions.push(function(t,r,n,a,i=3,o=0,s=100){if(!t)return()=>{};const l=matchMedia("(pointer: coarse)").matches;let u=()=>{};const c=f=>{if(f.button!==o)return;f.preventDefault(),f.stopPropagation();let d=f.clientX,h=f.clientY,v=!1;const p=Date.now(),g=T=>{if(T.preventDefault(),T.stopPropagation(),l&&Date.now()-p<s)return;const D=T.clientX,P=T.clientY,G=D-d,W=P-h;if(v||Math.abs(G)>i||Math.abs(W)>i){const L=t.getBoundingClientRect(),{left:X,top:M}=L;v||(n==null||n(d-X,h-M),v=!0),r(G,W,D-X,P-M),d=D,h=P}},b=T=>{if(v){const D=T.clientX,P=T.clientY,G=t.getBoundingClientRect(),{left:W,top:L}=G;a==null||a(D-W,P-L)}u()},y=T=>{T.relatedTarget&&T.relatedTarget!==document.documentElement||b(T)},S=T=>{v&&(T.stopPropagation(),T.preventDefault())},C=T=>{v&&T.preventDefault()};document.addEventListener("pointermove",g),document.addEventListener("pointerup",b),document.addEventListener("pointerout",y),document.addEventListener("pointercancel",y),document.addEventListener("touchmove",C,{passive:!1}),document.addEventListener("click",S,{capture:!0}),u=()=>{document.removeEventListener("pointermove",g),document.removeEventListener("pointerup",b),document.removeEventListener("pointerout",y),document.removeEventListener("pointercancel",y),document.removeEventListener("touchmove",C),setTimeout(()=>{document.removeEventListener("click",S,{capture:!0})},10)}};return t.addEventListener("pointerdown",c),()=>{u(),t.removeEventListener("pointerdown",c)}}(this.wrapper,(t,r,n)=>{this.emit("drag",Math.max(0,Math.min(1,n/this.wrapper.getBoundingClientRect().width)))},t=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,t/this.wrapper.getBoundingClientRect().width)))},t=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,t/this.wrapper.getBoundingClientRect().width)))}))}getHeight(t){return t==null?128:isNaN(Number(t))?t==="auto"&&this.parent.clientHeight||128:Number(t)}initHtml(){const t=document.createElement("div"),r=t.attachShadow({mode:"open"});return r.innerHTML=`
      <style>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[t,r]}setOptions(t){if(this.options.container!==t.container){const r=this.parentFromOptionsContainer(t.container);r.appendChild(this.container),this.parent=r}t.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=t,this.reRender()}getWrapper(){return this.wrapper}getScroll(){return this.scrollContainer.scrollLeft}setScroll(t){this.scrollContainer.scrollLeft=t}setScrollPercentage(t){const{scrollWidth:r}=this.scrollContainer,n=r*t;this.setScroll(n)}destroy(){var t;this.subscriptions.forEach(r=>r()),this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect()}createDelay(t=10){let r,n;const a=()=>{r&&clearTimeout(r),n&&n()};return this.timeouts.push(a),()=>new Promise((i,o)=>{a(),n=o,r=setTimeout(()=>{r=void 0,n=void 0,i()},t)})}convertColorValues(t){if(!Array.isArray(t))return t||"";if(t.length<2)return t[0]||"";const r=document.createElement("canvas"),n=r.getContext("2d"),a=r.height*(window.devicePixelRatio||1),i=n.createLinearGradient(0,0,0,a),o=1/(t.length-1);return t.forEach((s,l)=>{const u=l*o;i.addColorStop(u,s)}),i}renderBarWaveform(t,r,n,a){const i=t[0],o=t[1]||t[0],s=i.length,{width:l,height:u}=n.canvas,c=u/2,f=window.devicePixelRatio||1,d=r.barWidth?r.barWidth*f:1,h=r.barGap?r.barGap*f:r.barWidth?d/2:0,v=r.barRadius||0,p=l/(d+h)/s,g=v&&"roundRect"in n?"roundRect":"rect";n.beginPath();let b=0,y=0,S=0;for(let C=0;C<=s;C++){const T=Math.round(C*p);if(T>b){const G=Math.round(y*c*a),W=G+Math.round(S*c*a)||1;let L=c-G;r.barAlign==="top"?L=0:r.barAlign==="bottom"&&(L=u-W),n[g](b*(d+h),L,d,W,v),b=T,y=0,S=0}const D=Math.abs(i[C]||0),P=Math.abs(o[C]||0);D>y&&(y=D),P>S&&(S=P)}n.fill(),n.closePath()}renderLineWaveform(t,r,n,a){const i=o=>{const s=t[o]||t[0],l=s.length,{height:u}=n.canvas,c=u/2,f=n.canvas.width/l;n.moveTo(0,c);let d=0,h=0;for(let v=0;v<=l;v++){const p=Math.round(v*f);if(p>d){const b=c+(Math.round(h*c*a)||1)*(o===0?-1:1);n.lineTo(d,b),d=p,h=0}const g=Math.abs(s[v]||0);g>h&&(h=g)}n.lineTo(d,c)};n.beginPath(),i(0),i(1),n.fill(),n.closePath()}renderWaveform(t,r,n){if(n.fillStyle=this.convertColorValues(r.waveColor),r.renderFunction)return void r.renderFunction(t,n);let a=r.barHeight||1;if(r.normalize){const i=Array.from(t[0]).reduce((o,s)=>Math.max(o,Math.abs(s)),0);a=i?1/i:1}r.barWidth||r.barGap||r.barAlign?this.renderBarWaveform(t,r,n,a):this.renderLineWaveform(t,r,n,a)}renderSingleCanvas(t,r,n,a,i,o,s,l){const u=window.devicePixelRatio||1,c=document.createElement("canvas"),f=t[0].length;c.width=Math.round(n*(o-i)/f),c.height=a*u,c.style.width=`${Math.floor(c.width/u)}px`,c.style.height=`${a}px`,c.style.left=`${Math.floor(i*n/u/f)}px`,s.appendChild(c);const d=c.getContext("2d");if(this.renderWaveform(t.map(h=>h.slice(i,o)),r,d),c.width>0&&c.height>0){const h=c.cloneNode(),v=h.getContext("2d");v.drawImage(c,0,0),v.globalCompositeOperation="source-in",v.fillStyle=this.convertColorValues(r.progressColor),v.fillRect(0,0,c.width,c.height),l.appendChild(h)}}renderChannel(t,r,n,a){var{overlay:i}=r,o=function(s,l){var u={};for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&l.indexOf(c)<0&&(u[c]=s[c]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function"){var f=0;for(c=Object.getOwnPropertySymbols(s);f<c.length;f++)l.indexOf(c[f])<0&&Object.prototype.propertyIsEnumerable.call(s,c[f])&&(u[c[f]]=s[c[f]])}return u}(r,["overlay"]);return fr(this,void 0,void 0,function*(){const s=document.createElement("div"),l=this.getHeight(o.height);s.style.height=`${l}px`,i&&a>0&&(s.style.marginTop=`-${l}px`),this.canvasWrapper.style.minHeight=`${l}px`,this.canvasWrapper.appendChild(s);const u=s.cloneNode();this.progressWrapper.appendChild(u);const c=t[0].length,f=(C,T)=>{this.renderSingleCanvas(t,o,n,l,Math.max(0,C),Math.min(T,c),s,u)};if(!this.isScrollable)return void f(0,c);const{scrollLeft:d,scrollWidth:h,clientWidth:v}=this.scrollContainer,p=c/h;let g=Math.min(_o.MAX_CANVAS_WIDTH,v);if(o.barWidth||o.barGap){const C=o.barWidth||.5,T=C+(o.barGap||C/2);g%T!=0&&(g=Math.floor(g/T)*T)}const b=Math.floor(Math.abs(d)*p),y=Math.floor(b+g*p),S=y-b;S<=0||(f(b,y),yield Promise.all([fr(this,void 0,void 0,function*(){if(b===0)return;const C=this.createDelay();for(let T=b;T>=0;T-=S)yield C(),f(Math.max(0,T-S),T)}),fr(this,void 0,void 0,function*(){if(y===c)return;const C=this.createDelay();for(let T=y;T<c;T+=S)yield C(),f(T,Math.min(c,T+S))})]))})}render(t){return fr(this,void 0,void 0,function*(){this.timeouts.forEach(s=>s()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const r=window.devicePixelRatio||1,n=this.scrollContainer.clientWidth,a=Math.ceil(t.duration*(this.options.minPxPerSec||0));this.isScrollable=a>n;const i=this.options.fillParent&&!this.isScrollable,o=(i?n:a)*r;this.wrapper.style.width=i?"100%":`${a}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=t,this.emit("render");try{if(this.options.splitChannels)yield Promise.all(Array.from({length:t.numberOfChannels}).map((s,l)=>{var u;const c=Object.assign(Object.assign({},this.options),(u=this.options.splitChannels)===null||u===void 0?void 0:u[l]);return this.renderChannel([t.getChannelData(l)],c,o,l)}));else{const s=[t.getChannelData(0)];t.numberOfChannels>1&&s.push(t.getChannelData(1)),yield this.renderChannel(s,this.options,o,0)}}catch{return}this.emit("rendered")})}reRender(){if(!this.audioData)return;const{scrollWidth:t}=this.scrollContainer,{right:r}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&t!==this.scrollContainer.scrollWidth){const{right:n}=this.progressWrapper.getBoundingClientRect();let a=n-r;a*=2,a=a<0?Math.floor(a):Math.ceil(a),a/=2,this.scrollContainer.scrollLeft+=a}}zoom(t){this.options.minPxPerSec=t,this.reRender()}scrollIntoView(t,r=!1){const{scrollLeft:n,scrollWidth:a,clientWidth:i}=this.scrollContainer,o=t*a,s=n,l=n+i,u=i/2;if(this.isDragging)o+30>l?this.scrollContainer.scrollLeft+=30:o-30<s&&(this.scrollContainer.scrollLeft-=30);else{(o<s||o>l)&&(this.scrollContainer.scrollLeft=o-(this.options.autoCenter?u:0));const c=o-n-u;r&&this.options.autoCenter&&c>0&&(this.scrollContainer.scrollLeft+=Math.min(c,10))}{const c=this.scrollContainer.scrollLeft,f=c/a,d=(c+i)/a;this.emit("scroll",f,d)}}renderProgress(t,r){if(isNaN(t))return;const n=100*t;this.canvasWrapper.style.clipPath=`polygon(${n}% 0, 100% 0, 100% 100%, ${n}% 100%)`,this.progressWrapper.style.width=`${n}%`,this.cursor.style.left=`${n}%`,this.cursor.style.transform=`translateX(-${Math.round(n)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(t,r)}exportImage(t,r,n){return fr(this,void 0,void 0,function*(){const a=this.canvasWrapper.querySelectorAll("canvas");if(!a.length)throw new Error("No waveform data");if(n==="dataURL"){const i=Array.from(a).map(o=>o.toDataURL(t,r));return Promise.resolve(i)}return Promise.all(Array.from(a).map(i=>new Promise((o,s)=>{i.toBlob(l=>{l?o(l):s(new Error("Could not export image"))},t,r)})))})}}_o.MAX_CANVAS_WIDTH=4e3;class q3 extends ui{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}class i0 extends ui{constructor(t=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=t,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return fr(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(t){if(this.currentSrc=t,this._duration=void 0,!t)return this.buffer=null,void this.emit("emptied");fetch(t).then(r=>{if(r.status>=400)throw new Error(`Failed to fetch ${t}: ${r.status} (${r.statusText})`);return r.arrayBuffer()}).then(r=>this.currentSrc!==t?null:this.audioContext.decodeAudioData(r)).then(r=>{this.currentSrc===t&&(this.buffer=r,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var t;if(!this.paused)return;this.paused=!1,(t=this.bufferNode)===null||t===void 0||t.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let r=this.playedDuration*this._playbackRate;r>=this.duration&&(r=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,r),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var t;this.paused=!0,(t=this.bufferNode)===null||t===void 0||t.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return fr(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(t){var r,n;const a=t-this.currentTime;(r=this.bufferNode)===null||r===void 0||r.stop(this.audioContext.currentTime+a),(n=this.bufferNode)===null||n===void 0||n.addEventListener("ended",()=>{this.bufferNode=null,this.pause()},{once:!0})}setSinkId(t){return fr(this,void 0,void 0,function*(){return this.audioContext.setSinkId(t)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this.bufferNode&&(this.bufferNode.playbackRate.value=t)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(t){const r=!this.paused;r&&this._pause(),this.playedDuration=t/this._playbackRate,r&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var t,r;return(t=this._duration)!==null&&t!==void 0?t:((r=this.buffer)===null||r===void 0?void 0:r.duration)||0}set duration(t){this._duration=t}get volume(){return this.gainNode.gain.value}set volume(t){this.gainNode.gain.value=t,this.emit("volumechange")}get muted(){return this._muted}set muted(t){this._muted!==t&&(this._muted=t,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(t){return/^(audio|video)\//.test(t)}getGainNode(){return this.gainNode}getChannelData(){const t=[];if(!this.buffer)return t;const r=this.buffer.numberOfChannels;for(let n=0;n<r;n++)t.push(this.buffer.getChannelData(n));return t}}const K3={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class Ua extends j3{static create(t){return new Ua(t)}constructor(t){const r=t.media||(t.backend==="WebAudio"?new i0:void 0);super({media:r,mediaControls:t.mediaControls,autoplay:t.autoplay,playbackRate:t.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},K3,t),this.timer=new q3;const n=r?void 0:this.getMediaElement();this.renderer=new _o(this.options,n),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins(),Promise.resolve().then(()=>{this.emit("init");const a=this.options.url||this.getSrc()||"";(a||this.options.peaks&&this.options.duration)&&this.load(a,this.options.peaks,this.options.duration).catch(()=>null)})}updateProgress(t=this.getCurrentTime()){return this.renderer.renderProgress(t/this.getDuration(),this.isPlaying()),t}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const t=this.updateProgress();this.emit("timeupdate",t),this.emit("audioprocess",t)}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const t=this.updateProgress();this.emit("timeupdate",t)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",t=>{this.emit("error",t.error)}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(t,r)=>{this.options.interact&&(this.seekTo(t),this.emit("interaction",t*this.getDuration()),this.emit("click",t,r))}),this.renderer.on("dblclick",(t,r)=>{this.emit("dblclick",t,r)}),this.renderer.on("scroll",(t,r)=>{const n=this.getDuration();this.emit("scroll",t*n,r*n)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",t=>{this.emit("dragstart",t)}),this.renderer.on("dragend",t=>{this.emit("dragend",t)}));{let t;this.subscriptions.push(this.renderer.on("drag",r=>{if(!this.options.interact)return;let n;this.renderer.renderProgress(r),clearTimeout(t),this.isPlaying()?n=0:this.options.dragToSeek===!0?n=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(n=this.options.dragToSeek.debounceTime),t=setTimeout(()=>{this.seekTo(r)},n),this.emit("interaction",r*this.getDuration()),this.emit("drag",r)}))}}initPlugins(){var t;!((t=this.options.plugins)===null||t===void 0)&&t.length&&this.options.plugins.forEach(r=>{this.registerPlugin(r)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(t=>t()),this.mediaSubscriptions=[]}setOptions(t){this.options=Object.assign({},this.options,t),this.renderer.setOptions(this.options),t.audioRate&&this.setPlaybackRate(t.audioRate),t.mediaControls!=null&&(this.getMediaElement().controls=t.mediaControls)}registerPlugin(t){return t._init(this),this.plugins.push(t),this.subscriptions.push(t.once("destroy",()=>{this.plugins=this.plugins.filter(r=>r!==t)})),t}getWrapper(){return this.renderer.getWrapper()}getScroll(){return this.renderer.getScroll()}setScrollTime(t){const r=t/this.getDuration();this.renderer.setScrollPercentage(r)}getActivePlugins(){return this.plugins}loadAudio(t,r,n,a){var i;return fr(this,void 0,void 0,function*(){if(this.emit("load",t),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!r&&!n){const s=this.options.fetchParams||{};window.AbortController&&!s.signal&&(this.abortController=new AbortController,s.signal=(i=this.abortController)===null||i===void 0?void 0:i.signal);const l=u=>this.emit("loading",u);r=yield U3.fetchBlob(t,l,s)}this.setSrc(t,r);const o=a||this.getDuration()||(yield new Promise(s=>{this.onMediaEvent("loadedmetadata",()=>s(this.getDuration()),{once:!0})}));if(!t&&!r){const s=this.getMediaElement();s instanceof i0&&(s.duration=o)}if(n)this.decodedData=n0.createBuffer(n,o||0);else if(r){const s=yield r.arrayBuffer();this.decodedData=yield n0.decode(s,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(t,r,n){return fr(this,void 0,void 0,function*(){try{return yield this.loadAudio(t,void 0,r,n)}catch(a){throw this.emit("error",a),a}})}loadBlob(t,r,n){return fr(this,void 0,void 0,function*(){try{return yield this.loadAudio("blob",t,r,n)}catch(a){throw this.emit("error",a),a}})}zoom(t){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(t),this.emit("zoom",t)}getDecodedData(){return this.decodedData}exportPeaks({channels:t=2,maxLength:r=8e3,precision:n=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const a=Math.min(t,this.decodedData.numberOfChannels),i=[];for(let o=0;o<a;o++){const s=this.decodedData.getChannelData(o),l=[],u=Math.round(s.length/r);for(let c=0;c<r;c++){const f=s.slice(c*u,(c+1)*u);let d=0;for(let h=0;h<f.length;h++){const v=f[h];Math.abs(v)>Math.abs(d)&&(d=v)}l.push(Math.round(d*n)/n)}i.push(l)}return i}getDuration(){let t=super.getDuration()||0;return t!==0&&t!==1/0||!this.decodedData||(t=this.decodedData.duration),t}toggleInteraction(t){this.options.interact=t}setTime(t){super.setTime(t),this.updateProgress(t),this.emit("timeupdate",t)}seekTo(t){const r=this.getDuration()*t;this.setTime(r)}playPause(){return fr(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(t){this.setTime(this.getCurrentTime()+t)}empty(){this.load("",[[0]],.001)}setMediaElement(t){this.unsubscribePlayerEvents(),super.setMediaElement(t),this.initPlayerEvents()}exportImage(t="image/png",r=1,n="dataURL"){return fr(this,void 0,void 0,function*(){return this.renderer.exportImage(t,r,n)})}destroy(){var t;this.emit("destroy"),(t=this.abortController)===null||t===void 0||t.abort(),this.plugins.forEach(r=>r.destroy()),this.subscriptions.forEach(r=>r()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}Ua.BasePlugin=class extends ui{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}},Ua.dom=Y3;const Z3={class:"flex flex-col rounded overflow-hidden h-full"},Q3={class:"flex items-center text-xs pl-2 overflow-hidden h-5 leading-5 bg-[#395c96] text-gray-100"},J3={class:"mr-4 shrink-0"},eb={class:"overflow-hidden bg-blue-900 bg-opacity-60 flex-1 relative"},tb={key:0,class:"pl-2 overflow-hidden h-4 bg-gray-600 relative text-xs text-white"},rb=vt({__name:"AudioItem",props:{trackItem:{type:Object,default(){return{showWidth:"0px",showLeft:"0px"}}}},setup(e){const t=e,r=Nr(),n=Xe(()=>t.trackItem.resource),a=Xe(()=>{const{start:l,end:u,offsetL:c,offsetR:f,frameCount:d}=t.trackItem,h=u-l;return{transformOrigin:"left top",left:`-${c/h*100}%`,right:`-${f/h*100}%`}}),i=rt(!0),o=rt();async function s(){var l;if(!((l=n.value)!=null&&l.url)){console.error("Audio resource URL not found");return}r.ingLoadingCount++;try{Ua.create({container:o.value,url:n.value.url,...Fd})}finally{i.value=!1,r.ingLoadingCount--}}return Nt(()=>n.value&&o.value,()=>{o.value&&s()},{immediate:!0}),(l,u)=>{var d,h;const c=T0,f=Ht;return se(),Te("div",Z3,[ue("div",Q3,[Z(f,{size:"18"},{default:Ce(()=>[Z(c,{class:"inline-block mr-2 shrink-0"})]),_:1}),ue("span",J3,dt(`${e.trackItem.name}.${e.trackItem.format}`),1)]),ue("div",eb,[ue("div",{style:Ct(B(a)),class:"absolute",ref_key:"waveRef",ref:o},null,4)]),(h=(d=B(n))==null?void 0:d.meta)!=null&&h.prompt?(se(),Te("div",tb,[ue("span",null,dt(B(n).meta.prompt),1)])):ct("",!0),Kt(Z(Ml,{class:"pl-12 bg-opacity-70"},null,512),[[Hr,B(i)||e.trackItem.loading]])])}}}),nb={class:"flex flex-col rounded overflow-hidden h-full"},ab={class:"flex items-center text-xs pl-2 overflow-hidden h-6 leading-6 bg-red-900 bg-opacity-70 text-gray-300"},ib={class:"mr-4 shrink-0"},ob=vt({__name:"TextItem",props:{trackItem:{type:Object,default(){return{width:"0px",left:"0px"}}}},setup(e){const t=e;return(r,n)=>{const a=R0,i=Ht;return se(),Te("div",nb,[ue("div",ab,[Z(i,{size:"18"},{default:Ce(()=>[Z(a,{class:"inline-block mr-2 shrink-0"})]),_:1}),ue("span",ib,dt(t.trackItem.text),1)])])}}}),sb={class:"flex flex-col rounded overflow-hidden h-full"},lb={class:"flex items-center text-xs pl-2 overflow-hidden h-full leading-6 bg-yellow-700 bg-opacity-70 text-white"},ub=["src"],cb={class:"mr-4 shrink-0 flex flex-col gap-1"},fb={class:"text-xs h-4"},db=vt({__name:"ImageItem",props:{trackItem:{type:Object,default(){return{width:"0px",left:"0px"}}}},setup(e){const t=e,r=Xe(()=>t.trackItem.resource);return(n,a)=>{var i;return se(),Te("div",sb,[ue("div",lb,[ue("img",{src:(i=B(r))==null?void 0:i.url,class:"h-full inline-block mr-2 shrink-0",alt:"",draggable:"false"},null,8,ub),ue("div",cb,[ue("div",fb,dt(e.trackItem.name),1)])]),Kt(Z(Ml,{class:"pl-12 bg-opacity-70"},null,512),[[Hr,e.trackItem.loading]])])}}}),vb=["data-type","data-line","data-index"],pb=vt({__name:"TrackItem",props:{trackType:{type:String,default:""},lineIndex:{type:Number,default:0},itemIndex:{type:Number,default:0},trackItem:{type:Object,default(){return{width:"0px",left:"0px"}}}},setup(e){const t=e,r=sr(),n=Xe(()=>r.selectTrackItem.line===t.lineIndex&&r.selectTrackItem.index===t.itemIndex),a=new Map([["video",X3],["audio",rb],["text",ob],["image",db]]),i=Xe(()=>r.moveTrackData.lineIndex===t.lineIndex&&r.moveTrackData.itemIndex===t.itemIndex);function o(l){l.preventDefault(),l.stopPropagation(),r.selectTrackItem.line=t.lineIndex,r.selectTrackItem.index=t.itemIndex}const s=Xe(()=>i.value?{width:t.trackItem.showWidth,left:`${parseInt(t.trackItem.showLeft)+r.dragData.moveX}px`,top:`${r.dragData.moveY}px`}:{width:t.trackItem.showWidth,left:t.trackItem.showLeft});return(l,u)=>(se(),Te("div",{class:Ye(["text-left text-sm top-0 absolute trackItem",[B(Ns).get(t.trackItem.type),i.value?"z-50 isDrag":"z-10"]]),style:Ct([s.value]),"data-type":t.trackItem.type,"data-line":e.lineIndex,"data-index":e.itemIndex,onClick:o},[Z(P3,{isActive:n.value,lineIndex:e.lineIndex,itemIndex:e.itemIndex},null,8,["isActive","lineIndex","itemIndex"]),(se(),_t(en(B(a).get(e.trackItem.type)),{trackItem:e.trackItem},null,8,["trackItem"]))],14,vb))}}),hb=["data-index","data-type"],gb=vt({__name:"TrackLine",props:{isMain:{type:Boolean,default:!1},lineType:{type:String,default:""},lineIndex:{type:Number,default:0},lineData:{type:Array,default(){return[]}}},setup(e){const t=e,r=sr(),n=Xe(()=>r.selectTrackItem.line===t.lineIndex);return(a,i)=>(se(),Te("div",{class:Ye(["mb-1 mt-1 relative ml-2 trackLine",[B(Ns).get(e.lineType),B(n)?"dark:bg-gray-700 bg-gray-400 bg-opacity-20":"bg-gray-200 bg-opacity-10",e.isMain?"bg-blue-500 bg-opacity-20":""]]),"data-index":e.lineIndex,"data-type":e.lineType},[(se(!0),Te(jt,null,er(e.lineData,(o,s)=>(se(),_t(pb,{key:o.id,lineIndex:e.lineIndex,itemIndex:s,trackItem:o},null,8,["lineIndex","itemIndex","trackItem"]))),128))],10,hb))}}),mb=ln(gb,[["__scopeId","data-v-f61e98b9"]]),_b={class:"absolute pt-10 pb-5 min-w-full flex flex-col justify-center min-h-full overflow-x-hidden left-0 right-0"},bb=["title"],yb=vt({__name:"TrackListIcon",props:{listData:{type:Array,default(){return[]}},offsetTop:{type:Number,default:0}},setup(e){const t=e,r=new Map([["video",$s],["audio",T0],["text",R0],["image",$d]]),n=rt();return Nt(()=>t.offsetTop,()=>{n.value.scrollTop=t.offsetTop}),(a,i)=>{const o=Ht;return se(),Te("div",{ref_key:"iconList",ref:n,class:"relative w-12 flex h-full flex-col items-center justify-start overflow-y-hidden overflow-x-scroll border-r-2 dark:border-gray-700 border-gray-300 border-t"},[i[0]||(i[0]=ue("span",{class:"w-full h-5 sticky top-0 left-0 right-0 z-20"},null,-1)),ue("div",_b,[(se(!0),Te(jt,null,er(e.listData,(s,l)=>(se(),Te("div",{key:l,class:Ye(["z-10 flex justify-center items-center w-12 text-center mb-1 mt-1",[B(Ns).get(s.type),s.main?"bg-blue-500 bg-opacity-20":""]]),title:s.main?"主轨道":""},[Z(o,{size:"20"},{default:Ce(()=>[(se(),_t(en(B(r).get(s.type))))]),_:2},1024)],10,bb))),128))])],512)}}}),xb=vt({__name:"TrackPlayPoint",setup(e){const t={left:10},r=sr(),n=Nr(),a=Xe(()=>({left:`${t.left}px`,transform:`translate(${xr(r.trackScale,n.playStartFrame)}px, 0px)`})),i=rt(!1);function o(u){u.stopPropagation(),u.preventDefault(),n.isPause=!0,i.value=!0}function s(u){if(i.value){const c=document.getElementById("track-container").getBoundingClientRect(),d=Nn(u.pageX-t.left-c.left,r.trackScale,30)-1,h=d<0?0:d>r.frameCount?r.frameCount:d;n.playStartFrame=h}}document.addEventListener("mousemove",s);function l(u){i.value=!1}return document.addEventListener("mouseup",l),(u,c)=>(se(),Te("div",{class:"z-30 w-px absolute -top-5 bottom-0 bg-gray-700 dark:bg-gray-100 transition-transform duration-75",id:"trackPlayPoint",style:Ct(a.value),onMousedown:o},c[0]||(c[0]=[ue("span",{class:"playPoint block border-1 border-gray-600 bg-gray-600 h-3 w-2.5 dark:border-gray-100 dark:bg-gray-100 sticky top-0 right-0 left-0 cursor-move"},null,-1)]),36))}}),Sb=ln(xb,[["__scopeId","data-v-86d34692"]]),wb={class:"trackList flex flex-1 flex-row w-full overflow-x-hidden overflow-y-auto relative"},Cb={key:0,class:"flex justify-center items-center h-24 m-auto w-2/3 dark:bg-gray-500 bg-gray-200 rounded-md text-sm border-dashed border-2 dark:border-gray-500 border-gray-200 hover:dark:border-blue-300 hover:border-blue-400"},Eb=vt({__name:"TrackList",setup(e){const t=sr(),r=Nr(),n=rt(),a=rt(),i={left:10,right:200},o=rt(0-i.left),s=rt(0),l=Xe(()=>t.trackScale),u=Xe(()=>({width:xr(l.value,t.frameCount)+i.right})),c=rt(-1),f=rt(0),d=rt(!0),h=Xe(()=>t.dragData.dragPoint);let v=rt(0);const p=Xe(()=>t.trackList.map((Se,ve)=>{Se.main&&(v.value=ve);const j=Se.list.map(we=>({...we,showWidth:`${xr(l.value,we.end-we.start)}px`,showLeft:`${xr(l.value,we.start)}px`}));return{...Se,list:j}}));function g(Se,ve,j){Se.preventDefault(),Se.stopPropagation(),t.selectTrackItem.line=ve,t.selectTrackItem.index=j}function b(Se){const ve=Se-1,j=ve<0?0:ve;r.isPause=!0,r.playStartFrame=j}let y=0;const S=Na(()=>{t.trackScale-=y>0?10:-10,y=0},100),C=Se=>{(Se.ctrlKey||Se.metaKey)&&(Se.preventDefault(),y||(y=Se.deltaY),S())};function T(){const{scrollLeft:Se,scrollTop:ve}=n.value;o.value=Se-i.left,s.value=ve}let D={left:0,right:0,start:0,end:0},P=[],G;function W(Se){const ve=window.getComputedStyle(Se);return{left:parseInt(ve.left),right:parseInt(ve.left)+parseInt(ve.width)}}function L(Se){if(G=Se.target.closest(".trackItem"),!G)return;r.isPause=!0;const ve=Number(G.dataset.line),j=Number(G.dataset.index);t.dragData.dragPoint.x=Se.pageX,t.dragData.dragPoint.y=Se.pageY,t.dragData.dataInfo=t.trackList[ve].list[j],t.dragData.dragType=G.dataset.type,t.moveTrackData.lineIndex=ve,t.moveTrackData.itemIndex=j,t.selectTrackItem.line=-1,t.selectTrackItem.index=0;const we=t.trackList[ve].list[j];D={start:we.start,end:we.end,left:xr(t.trackScale,we.start),right:xr(t.trackScale,we.end)},P=[];for(let A=0;A<t.trackList.length;A++)for(let F=0;F<t.trackList[A].list.length;F++)if(A!==ve||F!==j){const _=t.trackList[A].list[F];P.push({start:_.start,end:_.end,left:xr(t.trackScale,_.start),right:xr(t.trackScale,_.end)})}}function X(Se,ve,{start:j,end:we}){if(Se.type!==ve.type)return{overlap:!0,index:0};const A=ve.list.filter(F=>F.id!==Se.id);if(A.length===0)return{overlap:!1,index:0};if(A[0].start>=we)return{overlap:!1,index:0};if(A[A.length-1].end<=j)return{overlap:!1,index:A.length};for(let F=0;F<A.length-1;F++){const _=A[F],Y=A[F+1];if(j>=_.end&&we<=Y.start)return{overlap:!1,index:F+1}}return{overlap:!0,index:0}}function M(){const Se=G.offsetTop+G.offsetHeight/2+G.offsetParent.offsetTop,ve=Array.from(document.querySelectorAll(".trackLine"));if(ve[0].offsetTop>Se)return{isNewLine:!0,insertIndex:0};for(let j=0;j<ve.length;j++){const we=ve[j];if(we.offsetTop<=Se&&we.offsetTop+we.offsetHeight>=Se)return{isNewLine:!1,insertIndex:j,elem:we};if(j+1!==ve.length){const A=ve[j+1];if(we.offsetTop+we.offsetHeight<=Se&&A.offsetTop>=Se)return{isNewLine:!0,insertIndex:j+1}}}return{isNewLine:!0,insertIndex:ve.length}}let oe={left:0,right:0,start:0,end:0};function re(){let{isNewLine:Se,insertIndex:ve,elem:j}=M();const we=W(G),A=oe.left||we.left,F=oe.right||we.right,_=oe.start||Nn(A,t.trackScale,br),Y=oe.end||Nn(F,t.trackScale,br);if(!j)return{insertIndex:ve,itemIndex:0,left:A,right:F,isNewLine:Se,start:_,end:Y};const ce=t.dragData.dataInfo,xe=t.trackList[ve],{overlap:De,index:He}=X(ce,xe,{start:_,end:Y});return De&&(Se=!0,j.offsetLeft+j.offsetWidth/2<G.offsetTop+G.offsetParent.offsetTop+G.offsetHeight/2&&(ve-=1)),{insertIndex:ve,itemIndex:He,left:A,right:F,isNewLine:Se,start:_,end:Y}}function be(Se,ve=10){const j=[];P.forEach(A=>{Math.abs(A.left-Se)<=ve&&j.push({position:A.left,frame:A.start}),Math.abs(A.right-Se)<=ve&&j.push({position:A.right,frame:A.end})});const we=xr(t.trackScale,r.playStartFrame);return Math.abs(we-Se)<=ve&&j.push({position:we,frame:r.playStartFrame}),j}function ze({left:Se,right:ve},j){if(oe={left:0,right:0,start:0,end:0},j[0].length===0&&j[1].length===0)return;const we=j[0].reduce((F,_)=>Math.abs(_.position-Se)<Math.abs(F.position-Se)?_:F,{position:Number.MAX_SAFE_INTEGER,frame:0}),A=j[1].reduce((F,_)=>Math.abs(_.position-ve)<Math.abs(F.position-ve)?_:F,{position:Number.MAX_SAFE_INTEGER,frame:0});Math.abs(we.position-Se)<Math.abs(A.position-ve)?(oe.left=we.position,oe.start=we.frame,t.dragData.moveX=we.position-D.left):(oe.right=A.position,oe.end=A.frame,t.dragData.moveX=A.position-D.right)}function Ue(Se){if(G){t.dragData.moveX=Se.pageX-t.dragData.dragPoint.x,t.dragData.moveY=Se.pageY-t.dragData.dragPoint.y;const ve=t.dragData.moveX+D.left,j=t.dragData.moveX+D.right;t.dragData.fixLines=[be(ve),be(j)],ze({left:ve,right:j},t.dragData.fixLines)}}function Ge(Se){let ve=t.dragData.dataInfo;const j=Math.max(oe.right!==0?Nn(Se.right,t.trackScale,br)-(ve.end-ve.start):Nn(Se.left,t.trackScale,br),0);ve.end=j+(ve.end-ve.start),ve.start=j;const we=ve;let A=0,F=0;t.trackList.forEach((Y,ce)=>{Y.list.forEach((xe,De)=>{xe.id===ve.id&&(A=ce,F=De)})}),t.trackList[A].list.splice(F,1),Se.isNewLine?t.trackList.splice(Se.insertIndex,0,{type:we.type,list:[we]}):t.trackList[Se.insertIndex].list.splice(Se.itemIndex,0,we);const _=t.trackList.findIndex(Y=>Y.list.length===0);_!==-1&&t.trackList.splice(_,1)}function Ne(Se){if(G){t.dragData.moveX=Se.pageX-t.dragData.dragPoint.x,t.dragData.moveY=Se.pageY-t.dragData.dragPoint.y;const ve=t.dragData.moveX+D.left,j=t.dragData.moveX+D.right;t.dragData.fixLines=[be(ve),be(j)],ze({left:ve,right:j},t.dragData.fixLines);const we=re();Ge(we),G=null}t.dragData.fixLines=[],t.moveTrackData.lineIndex=-1,t.moveTrackData.itemIndex=-1,t.dragData.moveX=0,t.dragData.moveY=0}function Me(Se){const ve=a.value,{left:j}=ve.getBoundingClientRect(),{clientX:we}=Se,{x:A}=h.value,F=we-j-A;f.value=F<0?0:F}async function Pe(){const Se=Nn(f.value,t.trackScale,br),ve=await t.createTrack(t.dragData.dataInfo,Se);t.addTrack(ve),f.value=0,t.dragData.dataInfo={},t.moveTrackData.lineIndex=-1,t.moveTrackData.itemIndex=-1,t.dragData.moveX=0,t.dragData.moveY=0}return(Se,ve)=>(se(),Te("div",wb,[Z(yb,{listData:p.value,offsetTop:s.value},null,8,["listData","offsetTop"]),ue("div",{class:"flex-1 overflow-x-scroll overflow-y-auto flex-col shrink-0 grow relative",ref_key:"trackList",ref:n,onScroll:T,onWheel:C,onClick:ve[0]||(ve[0]=j=>g(j,-1,-1))},[Z(O3,{start:o.value,scale:l.value,step:B(br),focusPosition:B(t).selectTrack,onSelectFrame:b},null,8,["start","scale","step","focusPosition"]),ue("div",{class:"absolute top-5 flex shrink-0 grow min-w-full",style:{"min-height":"calc(100% - 20px)"},ref_key:"trackListContainer",ref:a,onMousedown:L,onMousemove:Ue,onMouseup:Ne,onMouseleave:Ne,onDragover:ar(Me,["stop","prevent"]),onDrop:Pe},[p.value.length===0?(se(),Te("div",Cb,[Z($s,{class:"text-xl mr-4"}),ve[1]||(ve[1]=Ut(" 将素材拖拽到这里，开始编辑你的大作吧~ "))])):(se(),Te("div",{key:1,class:"z-10 pt-5 pb-5 min-w-full flex shrink-0 grow flex-col justify-center min-h-full",style:Ct({width:`${u.value.width}px`}),id:"track-container"},[(se(!0),Te(jt,null,er(p.value,(j,we)=>(se(),_t(mb,{key:j.list.reduce((A,F)=>A+F.id,"line"),style:Ct({"margin-left":`${i.left}px`}),class:Ye([c.value===we?d.value?"showLine-t":"showLine-b":""]),lineType:j.type,isActive:B(t).selectTrackItem.line===we,lineIndex:we,isMain:j.main,lineData:j.list},null,8,["style","class","lineType","isActive","lineIndex","isMain","lineData"]))),128))],4)),Kt(Z(Sb,null,null,512),[[Hr,p.value.length!==0]]),p.value.length!==0?(se(!0),Te(jt,{key:2},er(B(t).dragData.fixLines.reduce((j,we)=>j.concat(we),[]),(j,we)=>(se(),Te("div",{key:we,class:"z-30 w-px absolute -top-5 bottom-0 bg-yellow-300 dark:bg-yellow-300 pointer-events-none",style:Ct({left:`${j.position+10}px`})},null,4))),128)):ct("",!0),p.value.length!==0&&f.value!==0?(se(),Te("div",{key:3,class:"z-30 w-px absolute -top-5 bottom-0 bg-yellow-300 dark:bg-yellow-300",style:Ct({left:`${f.value}px`})},null,4)):ct("",!0)],544)],544)]))}}),Mb=vt({__name:"TrackContainer",setup(e){const t=pa(),r=sr(),n=Xe(()=>({height:`${t.trackHeight}px`}));return(a,i)=>(se(),Te("div",{class:"overflow-hidden select-none relative pt-2 flex flex-col dark:bg-night-light bg-white rounded",style:Ct(B(n))},[Z(R3,{modelValue:B(r).trackScale,"onUpdate:modelValue":i[0]||(i[0]=o=>B(r).trackScale=o)},null,8,["modelValue"]),Z(Eb)],4))}}),o0=vt({__name:"SplitLine",props:{disabled:{type:Boolean,default:!1},newWidth:{type:Number,default:0},newHeight:{type:Number,default:0},direction:{type:String,default:"horizontal"},limitSize:{type:Object,default(){return{minHeight:0,maxHeight:999999,minWidth:0,maxWidth:999999}}}},emits:{"update:newWidth":e=>e!==null,"update:newHeight":e=>e!==null},setup(e,{emit:t}){const r=e,n=t,a=Xe({get(){return r.newWidth},set(h){n("update:newWidth",h)}}),i=Xe({get(){return r.newHeight},set(h){n("update:newHeight",h)}}),o=rt(),s=pa(),l=Xe(()=>r.direction==="vertical"),u=Xe(()=>s.isDark?"#E5E7EB":"#1F2937"),c={left:0,top:0};let f=!1;function d(){if(r.disabled)return;const{left:h,top:v}=o.value.getBoundingClientRect();c.left=parseInt(h),c.top=parseInt(v),f=!0,document.onmousemove=p=>{if(!f)return;const{pageX:g,pageY:b}=p,{top:y,left:S}=c,{minHeight:C,maxHeight:T,minWidth:D,maxWidth:P}=r.limitSize,G=g-S,W=b-y;if(c.left=g,c.top=b,l.value){const L=a.value-G;a.value=L>P?P:L<D?D:L}else{const L=i.value-W;i.value=L>T?T:L<C?C:L}},document.onmouseup=()=>{f=!1,document.onmouseup=null,document.onmousemove=null}}return(h,v)=>{const p=Ht;return se(),Te("div",{ref_key:"lineElement",ref:o,class:Ye(["flex justify-center items-center",[e.disabled?"cursor-no-drop":l.value?"cursor-c-resize":"cursor-r-resize",l.value?"w-2 h-full flex-col":"h-2 w-full flex-row"]]),onMousedown:d},[ue("span",{class:Ye(["absolute flex z-10 dark:bg-gray-800 bg-gray-200",l.value?"h-8 w-4 flex-col":"w-8 h-4 flex-row"])},[Z(p,{class:Ye(["flex-auto",l.value?"rotate-90":""]),color:u.value},{default:Ce(()=>[Z(B(Nd))]),_:1},8,["class","color"])],2)],34)}}}),kb={class:"flex items-center gap-2 w-full"},Tb=["onClick"],Lf=vt({__name:"MenuList",props:{activeIndex:{},menu:{}},emits:["update:activeIndex"],setup(e,{emit:t}){const r=t;function n(a){r("update:activeIndex",a)}return(a,i)=>{const o=Ht;return se(),Te("ul",kb,[(se(!0),Te(jt,null,er(a.menu,(s,l)=>(se(),Te("li",{key:s.key,class:"flex items-center p-2 cursor-pointer hover:dark:bg-gray-700 hover:bg-gray-200",onClick:u=>n(l)},[Z(o,{color:l===a.activeIndex?"#1473e6":"",size:s.iconSize??14,class:"flex-auto mr-1"},{default:Ce(()=>[(se(),_t(en(s.icon)))]),_:2},1032,["color","size"]),ue("span",{class:Ye(["ml-0.5 select-none text-xs font-bold",l===a.activeIndex?"text-[#1473e6]":"dark:text-gray-300 text-gray-500"])},dt(s.title),3)],8,Tb))),128))])}}}),Rb="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='44'%20height='44'%20viewBox='0%200%2044%2044'%20fill='none'%3e%3cpath%20d='M22%204C19.6362%204%2017.2956%204.46558%2015.1117%205.37017C12.9278%206.27475%2010.9435%207.60062%209.27208%209.27208C7.60062%2010.9435%206.27475%2012.9278%205.37017%2015.1117C4.46558%2017.2956%204%2019.6362%204%2022C4%2024.3638%204.46558%2026.7044%205.37017%2028.8883C6.27475%2031.0722%207.60062%2033.0565%209.27208%2034.7279C10.9435%2036.3994%2012.9278%2037.7253%2015.1117%2038.6298C17.2956%2039.5344%2019.6362%2040%2022%2040C26.7739%2040%2031.3523%2038.1036%2034.7279%2034.7279C38.1036%2031.3523%2040%2026.7739%2040%2022C40%2017.2261%2038.1036%2012.6477%2034.7279%209.27208C31.3523%205.89642%2026.7739%204%2022%204ZM0%2022C0%209.85%209.85%200%2022%200C34.15%200%2044%209.85%2044%2022C44%2034.15%2034.15%2044%2022%2044C9.85%2044%200%2034.15%200%2022ZM16%2014V22H12V14H16ZM32%2014V22H28V14H32ZM31.436%2025.56L30.936%2027.5C30.398%2029.59%2029.35%2031.29%2027.71%2032.434C26.098%2033.56%2024.126%2034%2022%2034H20V30H22C23.6%2030%2024.686%2029.666%2025.42%2029.154C26.126%2028.662%2026.714%2027.862%2027.064%2026.502L27.562%2024.564L31.436%2025.56Z'%20fill='%234D5FFF'/%3e%3c/svg%3e",Db=""+new URL("thinking-CeJ7EOuC.gif",import.meta.url).href;var Ff={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */(function(e,t){(function(n,a){e.exports=a()})(zd,function(){return function(){var r={686:function(i,o,s){s.d(o,{default:function(){return Pe}});var l=s(279),u=s.n(l),c=s(370),f=s.n(c),d=s(817),h=s.n(d);function v(Se){try{return document.execCommand(Se)}catch{return!1}}var p=function(ve){var j=h()(ve);return v("cut"),j},g=p;function b(Se){var ve=document.documentElement.getAttribute("dir")==="rtl",j=document.createElement("textarea");j.style.fontSize="12pt",j.style.border="0",j.style.padding="0",j.style.margin="0",j.style.position="absolute",j.style[ve?"right":"left"]="-9999px";var we=window.pageYOffset||document.documentElement.scrollTop;return j.style.top="".concat(we,"px"),j.setAttribute("readonly",""),j.value=Se,j}var y=function(ve,j){var we=b(ve);j.container.appendChild(we);var A=h()(we);return v("copy"),we.remove(),A},S=function(ve){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},we="";return typeof ve=="string"?we=y(ve,j):ve instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(ve==null?void 0:ve.type)?we=y(ve.value,j):(we=h()(ve),v("copy")),we},C=S;function T(Se){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?T=function(j){return typeof j}:T=function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},T(Se)}var D=function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},j=ve.action,we=j===void 0?"copy":j,A=ve.container,F=ve.target,_=ve.text;if(we!=="copy"&&we!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(F!==void 0)if(F&&T(F)==="object"&&F.nodeType===1){if(we==="copy"&&F.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(we==="cut"&&(F.hasAttribute("readonly")||F.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(_)return C(_,{container:A});if(F)return we==="cut"?g(F):C(F,{container:A})},P=D;function G(Se){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?G=function(j){return typeof j}:G=function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},G(Se)}function W(Se,ve){if(!(Se instanceof ve))throw new TypeError("Cannot call a class as a function")}function L(Se,ve){for(var j=0;j<ve.length;j++){var we=ve[j];we.enumerable=we.enumerable||!1,we.configurable=!0,"value"in we&&(we.writable=!0),Object.defineProperty(Se,we.key,we)}}function X(Se,ve,j){return ve&&L(Se.prototype,ve),j&&L(Se,j),Se}function M(Se,ve){if(typeof ve!="function"&&ve!==null)throw new TypeError("Super expression must either be null or a function");Se.prototype=Object.create(ve&&ve.prototype,{constructor:{value:Se,writable:!0,configurable:!0}}),ve&&oe(Se,ve)}function oe(Se,ve){return oe=Object.setPrototypeOf||function(we,A){return we.__proto__=A,we},oe(Se,ve)}function re(Se){var ve=Ue();return function(){var we=Ge(Se),A;if(ve){var F=Ge(this).constructor;A=Reflect.construct(we,arguments,F)}else A=we.apply(this,arguments);return be(this,A)}}function be(Se,ve){return ve&&(G(ve)==="object"||typeof ve=="function")?ve:ze(Se)}function ze(Se){if(Se===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Se}function Ue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Ge(Se){return Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(j){return j.__proto__||Object.getPrototypeOf(j)},Ge(Se)}function Ne(Se,ve){var j="data-clipboard-".concat(Se);if(ve.hasAttribute(j))return ve.getAttribute(j)}var Me=function(Se){M(j,Se);var ve=re(j);function j(we,A){var F;return W(this,j),F=ve.call(this),F.resolveOptions(A),F.listenClick(we),F}return X(j,[{key:"resolveOptions",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof A.action=="function"?A.action:this.defaultAction,this.target=typeof A.target=="function"?A.target:this.defaultTarget,this.text=typeof A.text=="function"?A.text:this.defaultText,this.container=G(A.container)==="object"?A.container:document.body}},{key:"listenClick",value:function(A){var F=this;this.listener=f()(A,"click",function(_){return F.onClick(_)})}},{key:"onClick",value:function(A){var F=A.delegateTarget||A.currentTarget,_=this.action(F)||"copy",Y=P({action:_,container:this.container,target:this.target(F),text:this.text(F)});this.emit(Y?"success":"error",{action:_,text:Y,trigger:F,clearSelection:function(){F&&F.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(A){return Ne("action",A)}},{key:"defaultTarget",value:function(A){var F=Ne("target",A);if(F)return document.querySelector(F)}},{key:"defaultText",value:function(A){return Ne("text",A)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(A){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return C(A,F)}},{key:"cut",value:function(A){return g(A)}},{key:"isSupported",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],F=typeof A=="string"?[A]:A,_=!!document.queryCommandSupported;return F.forEach(function(Y){_=_&&!!document.queryCommandSupported(Y)}),_}}]),j}(u()),Pe=Me},828:function(i){var o=9;if(typeof Element<"u"&&!Element.prototype.matches){var s=Element.prototype;s.matches=s.matchesSelector||s.mozMatchesSelector||s.msMatchesSelector||s.oMatchesSelector||s.webkitMatchesSelector}function l(u,c){for(;u&&u.nodeType!==o;){if(typeof u.matches=="function"&&u.matches(c))return u;u=u.parentNode}}i.exports=l},438:function(i,o,s){var l=s(828);function u(d,h,v,p,g){var b=f.apply(this,arguments);return d.addEventListener(v,b,g),{destroy:function(){d.removeEventListener(v,b,g)}}}function c(d,h,v,p,g){return typeof d.addEventListener=="function"?u.apply(null,arguments):typeof v=="function"?u.bind(null,document).apply(null,arguments):(typeof d=="string"&&(d=document.querySelectorAll(d)),Array.prototype.map.call(d,function(b){return u(b,h,v,p,g)}))}function f(d,h,v,p){return function(g){g.delegateTarget=l(g.target,h),g.delegateTarget&&p.call(d,g)}}i.exports=c},879:function(i,o){o.node=function(s){return s!==void 0&&s instanceof HTMLElement&&s.nodeType===1},o.nodeList=function(s){var l=Object.prototype.toString.call(s);return s!==void 0&&(l==="[object NodeList]"||l==="[object HTMLCollection]")&&"length"in s&&(s.length===0||o.node(s[0]))},o.string=function(s){return typeof s=="string"||s instanceof String},o.fn=function(s){var l=Object.prototype.toString.call(s);return l==="[object Function]"}},370:function(i,o,s){var l=s(879),u=s(438);function c(v,p,g){if(!v&&!p&&!g)throw new Error("Missing required arguments");if(!l.string(p))throw new TypeError("Second argument must be a String");if(!l.fn(g))throw new TypeError("Third argument must be a Function");if(l.node(v))return f(v,p,g);if(l.nodeList(v))return d(v,p,g);if(l.string(v))return h(v,p,g);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function f(v,p,g){return v.addEventListener(p,g),{destroy:function(){v.removeEventListener(p,g)}}}function d(v,p,g){return Array.prototype.forEach.call(v,function(b){b.addEventListener(p,g)}),{destroy:function(){Array.prototype.forEach.call(v,function(b){b.removeEventListener(p,g)})}}}function h(v,p,g){return u(document.body,v,p,g)}i.exports=c},817:function(i){function o(s){var l;if(s.nodeName==="SELECT")s.focus(),l=s.value;else if(s.nodeName==="INPUT"||s.nodeName==="TEXTAREA"){var u=s.hasAttribute("readonly");u||s.setAttribute("readonly",""),s.select(),s.setSelectionRange(0,s.value.length),u||s.removeAttribute("readonly"),l=s.value}else{s.hasAttribute("contenteditable")&&s.focus();var c=window.getSelection(),f=document.createRange();f.selectNodeContents(s),c.removeAllRanges(),c.addRange(f),l=c.toString()}return l}i.exports=o},279:function(i){function o(){}o.prototype={on:function(s,l,u){var c=this.e||(this.e={});return(c[s]||(c[s]=[])).push({fn:l,ctx:u}),this},once:function(s,l,u){var c=this;function f(){c.off(s,f),l.apply(u,arguments)}return f._=l,this.on(s,f,u)},emit:function(s){var l=[].slice.call(arguments,1),u=((this.e||(this.e={}))[s]||[]).slice(),c=0,f=u.length;for(c;c<f;c++)u[c].fn.apply(u[c].ctx,l);return this},off:function(s,l){var u=this.e||(this.e={}),c=u[s],f=[];if(c&&l)for(var d=0,h=c.length;d<h;d++)c[d].fn!==l&&c[d].fn._!==l&&f.push(c[d]);return f.length?u[s]=f:delete u[s],this}},i.exports=o,i.exports.TinyEmitter=o}},n={};function a(i){if(n[i])return n[i].exports;var o=n[i]={exports:{}};return r[i](o,o.exports,a),o.exports}return function(){a.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return a.d(o,{a:o}),o}}(),function(){a.d=function(i,o){for(var s in o)a.o(o,s)&&!a.o(i,s)&&Object.defineProperty(i,s,{enumerable:!0,get:o[s]})}}(),function(){a.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)}}(),a(686)}().default})})(Ff);var Ab=Ff.exports;const Ib=D0(Ab),$f=e=>({toClipboard(t,r){return new Promise((n,a)=>{const i=document.createElement("button"),o=new Ib(i,{text:()=>t,action:()=>"copy",container:r!==void 0?r:document.body});o.on("success",s=>{o.destroy(),n(s)}),o.on("error",s=>{o.destroy(),a(s)}),document.body.appendChild(i),i.click(),document.body.removeChild(i)})}}),Bb={class:"w-full h-full overflow-hidden flex flex-col items-center gap-4"},Ob={ref:"contentChatText",class:"flex-1 w-full flex flex-col mt-4 overflow-auto gap-4"},Pb={class:"avatar"},Lb={key:0,src:Rb},Fb={key:1,src:Db},$b={class:"chat-textbox"},Nb=["onClick"],zb={key:2,class:"flex items-center mt-2 gap-3"},Vb=["onClick"],Hb=["onClick"],Gb={class:"w-full"},Wb={class:"flex items-center w-full gap-2"},Xb={class:"w-22"},Yb={class:"flex-1"},Ub=vt({__name:"TextGenerate",setup(e){const{toClipboard:t}=$f();qn();const r=rt(!1),n=rt(""),a=rt(null),i=rt(),o=rt(""),s=hr({style:"Promotional video",messages:[]}),l=()=>{var v;(v=a.value)==null||v.click()},u=v=>{var b;const g=(b=v.target.files)==null?void 0:b[0];g&&(i.value=g,o.value=g.name)},c=()=>{if(!i.value&&!n.value){Zt.warning("请输入文字或上传文件");return}n.value?s.messages.push({role:"user",content:n.value}):s.messages.push({role:"user",content:"请解析该文件并扩写"}),s.messages.push({role:"system",content:"这是一个扩写后的文本内容示例。在前端模式下，暂不支持AI生成功能。",loading:0}),n.value="",i.value=null,o.value=""},f=v=>{s.messages.push({role:"user",content:"请输出分镜头脚本"}),s.messages.push({role:"system",content:"这是一个分镜头脚本示例。在前端模式下，暂不支持AI分镜头脚本生成功能。",loading:0})},d=async v=>{try{await t(v),Zt.success("复制成功")}catch(p){console.error(p)}},h=()=>{s.messages.pop(),c()};return(v,p)=>{const g=Gd,b=Ht,y=on,S=Kn,C=to,T=eo,D=I0,P=qa,G=rn,W=sn;return se(),Te("div",Bb,[ue("div",Ob,[(se(!0),Te(jt,null,er(s.messages,(L,X)=>(se(),Te("div",{key:X,class:Ye(["chat-item text-sm","chat-item-"+L.role])},[ue("div",Pb,[L.role==="system"&&!L.loading?(se(),Te("img",Lb)):ct("",!0),L.role==="system"&&L.loading?(se(),Te("img",Fb)):ct("",!0),L.role==="user"?(se(),_t(b,{key:2,size:"20",class:"mt-[-2px]"},{default:Ce(()=>[Z(g)]),_:1})):ct("",!0)]),ue("div",$b,[L.edit?(se(),_t(y,{key:1,type:"textarea",modelValue:L.content,"onUpdate:modelValue":M=>L.content=M,autosize:"",onMouseleave:M=>L.edit=!1,class:"text-xs text-white w-[250px]"},null,8,["modelValue","onUpdate:modelValue","onMouseleave"])):(se(),Te("div",{key:0,class:"text-xs select-text text-white",onClick:M=>L.edit=!0},dt(L.content),9,Nb)),L.role==="system"?(se(),Te("div",zb,[ue("button",{onClick:()=>d(L.content)},[Z(b,{color:"white"},{default:Ce(()=>[Z(B(A0))]),_:1})],8,Vb),X===s.messages.length-1?(se(),Te("button",{key:0,onClick:p[0]||(p[0]=()=>h())},[Z(b,{color:"white"},{default:Ce(()=>[Z(B(Vd))]),_:1})])):ct("",!0),ue("button",{onClick:()=>f(L.content)},[Z(b,{color:"white"},{default:Ce(()=>[Z(B(Hd))]),_:1})],8,Hb)])):ct("",!0)])],2))),128))],512),ue("div",Gb,[i.value?(se(),_t(S,{key:0,type:"primary",class:"my-2 text-xs dark:text-white",closable:"",onClose:p[1]||(p[1]=L=>i.value=null)},{default:Ce(()=>[ue("span",null,"上传文件："+dt(o.value),1)]),_:1})):ct("",!0),Kt((se(),Te("div",Wb,[ue("div",Xb,[Z(T,{modelValue:s.style,"onUpdate:modelValue":p[2]||(p[2]=L=>s.style=L),placeholder:"风格"},{default:Ce(()=>[Z(C,{value:"Promotional video",label:"宣传片"}),Z(C,{value:"Movie",label:"电影"}),Z(C,{value:"Ad",label:"广告"}),Z(C,{value:"E-commerce",label:"电商"}),Z(C,{value:"Custom",label:"自定义"})]),_:1},8,["modelValue"])]),ue("div",Yb,[Z(y,{modelValue:n.value,"onUpdate:modelValue":p[3]||(p[3]=L=>n.value=L),class:"mr-4",placeholder:i.value?`上传文件：${o.value}`:"输入提示词",disabled:i.value,onKeyup:Rr(c,["enter"])},{suffix:Ce(()=>[Z(b,{class:"cursor-pointer",size:"18",onClick:l},{default:Ce(()=>[Z(D)]),_:1}),ue("input",{ref_key:"fileInputRef",ref:a,class:"file-input",type:"file",name:"file",accept:".txt, .pdf, .doc, .docx",hidden:"",onChange:u},null,544)]),_:1},8,["modelValue","placeholder","disabled"])]),Z(G,{class:"dark:bg-purple-heavy",circle:"",onClick:c},{default:Ce(()=>[Z(P)]),_:1})])),[[W,r.value]])])])}}}),jb=ln(Ub,[["__scopeId","data-v-4a71f24c"]]),qb={class:"h-24 cursor-pointer center bg-night hover:border-2 hover:border-purple box-border overflow-hidden"},Kb=["src"],Zb={class:"flex-1 overflow-hidden flex gap-4 items-center"},Qb=["src"],Jb={key:2,class:"relative w-24"},e4={class:"h-24 flex flex-col cursor-pointer center hover:border-2 hover:border-purple box-border overflow-hidden"},t4={class:"w-20 text-center text-ellipsis overflow-hidden whitespace-nowrap"},r4={class:"whitespace-pre overflow-auto max-h-[600px] select-text"},n4=vt({__name:"ResourceItem",props:{resource:{},type:{},noAction:{type:Boolean}},setup(e){const t=e,r=sr(),n=qn(),{toClipboard:a}=$f(),i=rt(!1);async function o(c){c.stopPropagation(),r.dragData.dataInfo=t.resource,r.dragData.dragType=t.type,r.dragData.dragPoint.x=c.offsetX,r.dragData.dragPoint.y=c.offsetY,r.selectTrackItem.line=-1,r.selectTrackItem.index=-1}async function s(c){c.stopPropagation();const f=await r.createTrack(t.resource);r.addTrack(f)}const l=c=>c.result?c.result:c.type==="text"?c.content:"",u=async c=>{var f;try{const d=((f=window.getSelection())==null?void 0:f.toString())||"";await a(d===""?c:d),Zt.success("复制成功")}catch(d){console.error(d)}};return(c,f)=>{const d=ev,h=Xd,v=Ht,p=Za,g=Ht;return["image","video"].includes(c.type)?(se(),Te("div",{key:0,class:"relative w-24",draggable:"true",onDragstart:o},[ue("div",qb,[Z(d,{class:"max-h-full max-w-full","preview-teleported":"",src:"cover"in c.resource?c.resource.cover:c.resource.url,"preview-src-list":["cover"in c.resource?c.resource.cover:c.resource.url]},null,8,["src","preview-src-list"]),i.value?(se(),_t(h,{key:0,title:"原始视频",center:"",modelValue:i.value,"onUpdate:modelValue":f[0]||(f[0]=b=>i.value=b)},{default:Ce(()=>[ue("video",{controls:"",src:"url"in c.resource?c.resource.url:""},null,8,Kb)]),_:1},8,["modelValue"])):ct("",!0)]),Kt(ue("span",{class:"h-5 absolute bottom-1 right-2 text-xs text-gray-400"},dt("duration"in c.resource&&c.resource.duration?c.resource.duration.toFixed(1):0)+" s",513),[[Hr,"duration"in c.resource&&c.resource.duration]]),ue("div",{class:"absolute top-2 right-2 bg-red-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:f[1]||(f[1]=b=>B(n).removeResource(c.resource.id))},[Z(v,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:Ce(()=>[Z(B(ko))]),_:1})]),c.noAction?ct("",!0):(se(),Te("div",{key:0,class:"absolute bottom-2 right-1 bg-blue-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:s},[Z(v,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:Ce(()=>[Z(B(Ql))]),_:1})]))],32)):c.type==="audio"?(se(),Te("div",{key:1,class:"relative w-full h-10 flex items-center py-1 px-2 gap-2 overflow-hidden",draggable:"true",onDragstart:o},[ue("div",Zb,[Z(p,null,{reference:Ce(()=>[ue("audio",{class:"h-10",controls:"",preload:"metadata",src:"url"in c.resource?c.resource.url:""},null,8,Qb)]),default:Ce(()=>{var b;return[ue("div",null,dt((b=c.resource.meta)==null?void 0:b.prompt),1)]}),_:1})]),ue("div",{class:"bg-red-500 rounded-full w-6 h-6",onClick:f[2]||(f[2]=b=>B(n).removeResource(c.resource.id))},[Z(v,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:Ce(()=>[Z(B(ko))]),_:1})]),c.noAction?ct("",!0):(se(),Te("div",{key:0,class:"bg-blue-500 rounded-full w-6 h-6",onClick:s},[Z(v,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:Ce(()=>[Z(B(Ql))]),_:1})]))],32)):c.type==="text"?(se(),Te("div",Jb,[Z(p,{trigger:"click",placement:"right",width:400},{reference:Ce(()=>{var b;return[ue("div",e4,[Z(g,{size:"30"},{default:Ce(()=>[Z(B(Wd))]),_:1}),ue("div",t4,dt((b=c.resource.meta)==null?void 0:b.prompt),1)])]}),default:Ce(()=>[ue("div",r4,dt(l(c.resource)),1),ue("button",{class:"absolute top-4 right-6 bg-night-light",onClick:f[3]||(f[3]=()=>u(l(c.resource)))},[Z(g,{size:"18",color:"#1473e6"},{default:Ce(()=>[Z(B(A0))]),_:1})])]),_:1}),ue("div",{class:"absolute top-2 right-1 bg-red-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:f[4]||(f[4]=b=>B(n).removeResource(c.resource.id))},[Z(v,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:Ce(()=>[Z(B(ko))]),_:1})])])):ct("",!0)}}}),a4={class:"w-full flex flex-col mt-2"},i4={class:"flex flex-row flex-wrap gap-4 w-full"},ci=vt({__name:"ResourceList",props:{listData:{},type:{},noAction:{type:Boolean}},setup(e){return(t,r)=>(se(),Te("div",a4,[ue("ul",i4,[(se(!0),Te(jt,null,er(t.listData,(n,a)=>(se(),Te("li",{key:`${n.name}-${a}`,class:"flex flex-col max-w-full"},[Z(n4,{resource:n,type:t.type,"no-action":t.noAction},null,8,["resource","type","no-action"])]))),128))])]))}}),o4={class:"w-full h-full overflow-hidden flex flex-col items-center gap-4"},s4={class:"flex-1 w-full overflow-auto"},l4={class:"flex items-center w-full gap-2"},u4={class:"w-32"},c4={class:"grid-container2"},f4=["onClick"],d4={class:"grid-container"},v4=["onClick"],p4=["src"],h4=vt({__name:"ImageGenerate",setup(e){const t=qn(),{getResourcesByType:r}=t,n=rt(!1),a=hr({prompt:"",keywords:[],model:"doubao",size:""}),i=()=>{if(!a.prompt){Zt.error("请输入文字描述");return}Zt.info("前端模式下暂不支持AI图片生成功能")},o=s=>{a.keywords.includes(s)?a.keywords=a.keywords.filter(l=>l!=s):a.keywords.push(s)};return(s,l)=>{const u=to,c=eo,f=B0,d=Ht,h=Za,v=O0,p=on,g=qa,b=rn,y=sn;return se(),Te("div",o4,[ue("div",s4,[Z(ci,{"list-data":B(r)("image").value,type:"image"},null,8,["list-data"])]),Kt((se(),Te("div",l4,[ue("div",u4,[Z(c,{modelValue:a.model,"onUpdate:modelValue":l[0]||(l[0]=S=>a.model=S),placeholder:""},{default:Ce(()=>[Z(u,{value:"即梦",label:"doubao"})]),_:1},8,["modelValue"])]),Z(p,{modelValue:a.prompt,"onUpdate:modelValue":l[1]||(l[1]=S=>a.prompt=S),placeholder:"请输入提示词",onKeyup:Rr(i,["enter"])},{suffix:Ce(()=>[Z(h,{trigger:"click",width:"280"},{reference:Ce(()=>[Z(d,{size:18,class:"cursor-pointer mr-2"},{default:Ce(()=>[Z(f)]),_:1})]),default:Ce(()=>[ue("div",c4,[(se(!0),Te(jt,null,er(B(tv),(S,C)=>(se(),Te("div",{key:C,class:"item",onClick:T=>o(S)},[ue("span",{class:Ye(["text",{active:a.keywords.includes(S)}])},dt(S),3)],8,f4))),128))])]),_:1}),Z(h,{trigger:"click"},{reference:Ce(()=>[Z(d,{size:18,class:"cursor-pointer"},{default:Ce(()=>[Z(v)]),_:1})]),default:Ce(()=>[ue("div",d4,[(se(!0),Te(jt,null,er(B(Qo),(S,C)=>(se(),Te("div",{key:C,class:"item",onClick:T=>a.size=S.text},[ue("img",{class:"icon",src:S.img},null,8,p4),ue("span",{class:Ye(["text",{active:S.text==a.size}])},dt(S.text),3)],8,v4))),128))])]),_:1})]),_:1},8,["modelValue"]),Z(b,{class:"dark:bg-purple-heavy",circle:"",onClick:i},{default:Ce(()=>[Z(g)]),_:1})])),[[y,n.value]])])}}}),Nf=ln(h4,[["__scopeId","data-v-69d5a2ee"]]),g4={class:"w-full flex-1 overflow-hidden flex flex-col items-center gap-4"},m4={class:"flex-1 w-full overflow-auto"},_4={class:"flex items-center w-full gap-2"},b4={class:"w-20"},y4={class:"flex-1"},x4=["onClick"],S4=vt({__name:"MusicGenerate",setup(e){const t=qn(),{getResourcesByType:r}=t,n=rt(!1),a=hr({prompt:"",style:"Electronic music",len:4}),i=()=>{if(!a.prompt){Zt.error("请输入文字描述");return}Zt.info("前端模式下暂不支持AI音乐生成功能")};return(o,s)=>{const l=ci,u=to,c=eo,f=Yd,d=Ht,h=Za,v=on,p=qa,g=rn,b=sn;return se(),Te("div",g4,[ue("div",m4,[Z(l,{"list-data":B(r)("audio").value,type:"audio"},null,8,["list-data"])]),Kt((se(),Te("div",_4,[ue("div",b4,[Z(c,{modelValue:a.style,"onUpdate:modelValue":s[0]||(s[0]=y=>a.style=y),placeholder:"风格"},{default:Ce(()=>[(se(!0),Te(jt,null,er(B(rv),(y,S)=>(se(),_t(u,{key:S,value:y.value,label:y.text},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),ue("div",y4,[Z(v,{modelValue:a.prompt,"onUpdate:modelValue":s[1]||(s[1]=y=>a.prompt=y),placeholder:"请输入提示词",onKeyup:Rr(i,["enter"])},{suffix:Ce(()=>[Z(h,{trigger:"click",width:80},{reference:Ce(()=>[Z(d,{size:18,class:"cursor-pointer"},{default:Ce(()=>[Z(f)]),_:1})]),default:Ce(()=>[ue("div",null,[(se(!0),Te(jt,null,er(B(nv),(y,S)=>(se(),Te("div",{class:Ye(["time-text m-2 cursor-pointer",{active:y==a.len}]),key:S,onClick:C=>a.len=y},dt(y)+"s ",11,x4))),128))])]),_:1})]),_:1},8,["modelValue"])]),Z(g,{class:"dark:bg-purple-heavy",circle:"",onClick:i},{default:Ce(()=>[Z(p)]),_:1})])),[[b,n.value]])])}}}),zf=ln(S4,[["__scopeId","data-v-38d15245"]]),w4={class:"w-full h-full overflow-hidden flex flex-col items-center gap-4"},C4={class:"flex-1 w-full overflow-auto"},E4={class:"w-full"},M4=["title"],k4={class:"flex items-center w-full gap-2"},T4={class:"grid-container2"},R4=["onClick"],D4=["src"],A4={class:"grid-container"},I4=["onClick"],B4=["src"],O4=vt({__name:"VideoGenerate",setup(e){const t=qn(),r=rt(!1),n=rt(null),a=rt(""),i=hr({prompt:"",imageUrl:"",sizeStr:Qo[0].value,style:"Anime Style"}),o=()=>{var u;(u=n.value)==null||u.click()},s=u=>{var d;const f=(d=u.target.files)==null?void 0:d[0];f&&(a.value=f.name,i.imageUrl=URL.createObjectURL(f))},l=()=>{if(!i.prompt){Zt.error("请输入文字描述");return}i.imageUrl?Zt.info("前端模式下暂不支持图片生成视频功能"):Zt.info("前端模式下暂不支持文字生成视频功能")};return(u,c)=>{const f=ci,d=Kn,h=I0,v=Ht,p=B0,g=Za,b=O0,y=on,S=qa,C=rn,T=sn;return se(),Te("div",w4,[ue("div",C4,[Z(f,{"list-data":B(t).videoList,type:"video"},null,8,["list-data"])]),ue("div",E4,[B(i).imageUrl?(se(),_t(d,{key:0,type:"primary",class:"my-2 text-xs dark:text-white",closable:"",onClose:c[0]||(c[0]=D=>B(i).imageUrl="")},{default:Ce(()=>[ue("span",{title:B(a),class:"inline-block max-w-[300px] overflow-ellipsis overflow-hidden whitespace-nowrap"},"上传文件："+dt(B(a)),9,M4)]),_:1})):ct("",!0),Kt((se(),Te("div",k4,[Z(y,{modelValue:B(i).prompt,"onUpdate:modelValue":c[1]||(c[1]=D=>B(i).prompt=D),placeholder:"请输入提示词",onKeyup:Rr(l,["enter"])},{suffix:Ce(()=>[Z(v,{class:"cursor-pointer mr-2",size:"18",onClick:o},{default:Ce(()=>[Z(h)]),_:1}),ue("input",{ref_key:"fileInputRef",ref:n,class:"file-input",type:"file",name:"file",accept:"image/*",hidden:"",onChange:s},null,544),Z(g,{trigger:"click",width:"325"},{reference:Ce(()=>[Z(v,{size:18,class:"cursor-pointer mr-2"},{default:Ce(()=>[Z(p)]),_:1})]),default:Ce(()=>[ue("div",T4,[(se(!0),Te(jt,null,er(B(av),(D,P)=>(se(),Te("div",{key:P,class:"item",onClick:G=>B(i).style=D.value},[ue("img",{class:"img",src:D.img},null,8,D4),ue("span",{class:Ye(["text",{active:D.value==B(i).style}])},dt(D.text),3)],8,R4))),128))])]),_:1}),Z(g,{trigger:"click"},{reference:Ce(()=>[Z(v,{size:18,class:"cursor-pointer"},{default:Ce(()=>[Z(b)]),_:1})]),default:Ce(()=>[ue("div",A4,[(se(!0),Te(jt,null,er(B(Qo),(D,P)=>(se(),Te("div",{key:P,class:"item",onClick:G=>B(i).sizeStr=D.value},[ue("img",{class:"icon",src:D.img},null,8,B4),ue("span",{class:Ye(["text",{active:D.value==B(i).sizeStr}])},dt(D.text),3)],8,I4))),128))])]),_:1})]),_:1},8,["modelValue"]),Z(C,{class:"dark:bg-purple-heavy",circle:"",onClick:l},{default:Ce(()=>[Z(S)]),_:1})])),[[T,B(r)]])])])}}}),Vf=ln(O4,[["__scopeId","data-v-e6b42667"]]);var Hf={exports:{}};(function(e){(function(t){var r=typeof window=="object"&&!!window.document,n=r?window:Object;t(n,r),e.exports&&(e.exports=n.Recorder)})(function(t,r){var n=function(){},a=function(A){return typeof A=="number"},i=function(A){return JSON.stringify(A)},o=function(A){return new Ue(A)},s=o.LM="2024-10-20 22:15",l="https://github.com/xiangyuecn/Recorder",u="Recorder",c="getUserMedia",f="srcSampleRate",d="sampleRate",h="bitRate",v="catch",p=t[u];if(p&&p.LM==s){p.CLog(p.i18n.$T("K8zP::重复导入{1}",0,u),3);return}o.IsOpen=function(){var A=o.Stream;if(A){var F=oe(A),_=F[0];if(_){var Y=_.readyState;return Y=="live"||Y==_.LIVE}}return!1},o.BufferSize=4096,o.Destroy=function(){re(u+" Destroy"),X();for(var A in g)g[A]()};var g={};o.BindDestroy=function(A,F){g[A]=F},o.Support=function(){if(!r)return!1;var A=navigator.mediaDevices||{};return A[c]||(A=navigator,A[c]||(A[c]=A.webkitGetUserMedia||A.mozGetUserMedia||A.msGetUserMedia)),!(!A[c]||(o.Scope=A,!o.GetContext()))},o.GetContext=function(A){if(!r)return null;var F=window.AudioContext;if(F||(F=window.webkitAudioContext),!F)return null;var _=o.Ctx,Y=0;return _||(_=o.Ctx=new F,Y=1,o.NewCtxs=o.NewCtxs||[],o.BindDestroy("Ctx",function(){var ce=o.Ctx;ce&&ce.close&&(b(ce),o.Ctx=0);var xe=o.NewCtxs;o.NewCtxs=[];for(var De=0;De<xe.length;De++)b(xe[De])})),A&&_.close&&(Y||(_._useC||b(_),_=new F),_._useC=1,o.NewCtxs.push(_)),_},o.CloseNewCtx=function(A){if(A&&A.close){b(A);for(var F=o.NewCtxs||[],_=F.length,Y=0;Y<F.length;Y++)if(F[Y]==A){F.splice(Y,1);break}re(j("mSxV::剩{1}个GetContext未close",0,_+"-1="+F.length),F.length?3:0)}};var b=function(A){if(A&&A.close&&!A._isC&&(A._isC=1,A.state!="closed"))try{A.close()}catch(F){re("ctx close err",1,F)}},y=o.ResumeCtx=function(A,F,_,Y){var ce=0,xe=0,De=0,He=0,Ze="EventListener",je="ResumeCtx ",Fe=function(at,Ke){xe&&pt(),ce||(ce=1,at&&Y(at,He),Ke&&_(He)),Ke&&(!A._LsSC&&A["add"+Ze]&&A["add"+Ze]("statechange",Je),A._LsSC=1,De=1)},pt=function(at){if(!(at&&xe)){xe=at?1:0;for(var Ke=["focus","mousedown","mouseup","touchstart","touchend"],yt=0;yt<Ke.length;yt++)window[(at?"add":"remove")+Ze](Ke[yt],Je,!0)}},Je=function(){var at=A.state,Ke=S(at);if(!ce&&!F(Ke?++He:He))return Fe();Ke?(De&&re(je+"sc "+at,3),pt(1),A.resume().then(function(){De&&re(je+"sc "+A.state),Fe(0,1)})[v](function(yt){re(je+"error",1,yt),S(A.state)||Fe(yt.message||"error")})):at=="closed"?(De&&!A._isC&&re(je+"sc "+at,1),Fe("ctx closed")):Fe(0,1)};Je()},S=o.CtxSpEnd=function(A){return A=="suspended"||A=="interrupted"},C=function(A){var F=A.state,_="ctx.state="+F;return S(F)&&(_+=j("nMIy::（注意：ctx不是running状态，rec.open和start至少要有一个在用户操作(触摸、点击等)时进行调用，否则将在rec.start时尝试进行ctx.resume，可能会产生兼容性问题(仅iOS)，请参阅文档中runningContext配置）")),_},T="ConnectEnableWebM";o[T]=!0;var D="ConnectEnableWorklet";o[D]=!1;var P=function(A){var F=A.BufferSize||o.BufferSize,_=A.Stream,Y=_._c,ce=Y[d],xe={},De=oe(_),He=De[0],Ze=null,je="";if(He&&He.getSettings){Ze=He.getSettings();var Fe=Ze[d];Fe&&Fe!=ce&&(je=j("eS8i::Stream的采样率{1}不等于{2}，将进行采样率转换（注意：音质不会变好甚至可能变差），主要在移动端未禁用回声消除时会产生此现象，浏览器有回声消除时可能只会返回16k采样率的音频数据，",0,Fe,ce))}_._ts=Ze,re(je+"Stream TrackSet: "+i(Ze),je?3:0);var pt=function(ae){var m=_._m=Y.createMediaStreamSource(_),R=Y.destination,U="createMediaStreamDestination";Y[U]&&(R=_._d=Y[U]()),m.connect(ae),ae.connect(R)},Je,at,Ke,yt="",V=_._call,pe=function(ae,m){for(var R in V){if(m!=ce){xe.index=0,xe=o.SampleData([ae],m,ce,xe,{_sum:1});var U=xe.data,ne=xe._sum}else{xe={};for(var z=ae.length,U=new Int16Array(z),ne=0,I=0;I<z;I++){var N=Math.max(-1,Math.min(1,ae[I]));N=N<0?N*32768:N*32767,U[I]=N,ne+=Math.abs(N)}}for(var k in V)V[k](U,ne);return}},me="ScriptProcessor",J="audioWorklet",$e=u+" "+J,K="RecProc",ie="MediaRecorder",Oe=ie+".WebM.PCM",he=Y.createScriptProcessor||Y.createJavaScriptNode,Be=j("ZGlf::。由于{1}内部1秒375次回调，在移动端可能会有性能问题导致回调丢失录音变短，PC端无影响，暂不建议开启{1}。",0,J),te=function(){at=_.isWorklet=!1,W(_),re(j("7TU0::Connect采用老的{1}，",0,me)+ve.get(o[D]?j("JwCL::但已设置{1}尝试启用{2}",2):j("VGjB::可设置{1}尝试启用{2}",2),[u+"."+D+"=true",J])+yt+Be,3);var ae=_._p=he.call(Y,F,1,1);pt(ae),ae.onaudioprocess=function(m){var R=m.inputBuffer.getChannelData(0);pe(R,ce)}},Le=function(){Je=_.isWebM=!1,L(_),at=_.isWorklet=!he||o[D];var ae=window.AudioWorkletNode;if(!(at&&Y[J]&&ae)){te();return}var m=function(){var I=function(k){return k.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,$e)},N="class "+K+" extends AudioWorkletProcessor{";return N+="constructor "+I(function(k){DEL_super(k);var Q=this,w=k.processorOptions.bufferSize;Q.bufferSize=w,Q.buffer=new Float32Array(w*2),Q.pos=0,Q.port.onmessage=function(ye){ye.data.kill&&(Q.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",k)}),N+="process "+I(function(k,Q,w){var ye=this,O=ye.bufferSize,$=ye.buffer,H=ye.pos;if(k=(k[0]||[])[0]||[],k.length){$.set(k,H),H+=k.length;var q=~~(H/O)*O;if(q){this.port.postMessage({val:$.slice(0,q)});var de=$.subarray(q,H);$=new Float32Array(O*2),$.set(de),H=de.length,ye.buffer=$}ye.pos=H}return!ye.kill}),N+='}try{registerProcessor("'+K+'", '+K+')}catch(e){$C.error("'+$e+' Reg Error",e)}',N=N.replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(N)))},R=function(){return at&&_._na},U=_._na=function(){Ke!==""&&(clearTimeout(Ke),Ke=setTimeout(function(){Ke=0,R()&&(re(j("MxX1::{1}未返回任何音频，恢复使用{2}",0,J,me),3),he&&te())},500))},ne=function(){if(R()){var I=_._n=new ae(Y,K,{processorOptions:{bufferSize:F}});pt(I),I.port.onmessage=function(N){Ke&&(clearTimeout(Ke),Ke=""),R()?pe(N.data.val,ce):at||re(j("XUap::{1}多余回调",0,J),3)},re(j("yOta::Connect采用{1}，设置{2}可恢复老式{3}",0,J,u+"."+D+"=false",me)+yt+Be,3)}},z=function(){if(R()){if(Y[K]){ne();return}var I=m();Y[J].addModule(I).then(function(N){R()&&(Y[K]=1,ne(),Ke&&U())})[v](function(N){re(J+".addModule Error",1,N),R()&&te()})}};y(Y,function(){return R()},z,z)},le=function(){var ae=window[ie],m="ondataavailable",R="audio/webm; codecs=pcm";Je=_.isWebM=o[T];var U=ae&&m in ae.prototype&&ae.isTypeSupported(R);if(yt=U?"":j("VwPd::（此浏览器不支持{1}）",0,Oe),!Je||!U){Le();return}var ne=function(){return Je&&_._ra};_._ra=function(){Ke!==""&&(clearTimeout(Ke),Ke=setTimeout(function(){ne()&&(re(j("vHnb::{1}未返回任何音频，降级使用{2}",0,ie,J),3),Le())},500))};var z=Object.assign({mimeType:R},o.ConnectWebMOptions),I=_._r=new ae(_,z),N=_._rd={};I[m]=function(k){var Q=new FileReader;Q.onloadend=function(){if(ne()){var w=Ge(new Uint8Array(Q.result),N);if(!w)return;if(w==-1){Le();return}Ke&&(clearTimeout(Ke),Ke=""),pe(w,N.webmSR)}else Je||re(j("O9P7::{1}多余回调",0,ie),3)},Q.readAsArrayBuffer(k.data)},I.start(~~(F/48)),re(j("LMEm::Connect采用{1}，设置{2}可恢复使用{3}或老式{4}",0,Oe,u+"."+T+"=false",J,me))};le()},G=function(A){A._na&&A._na(),A._ra&&A._ra()},W=function(A){A._na=null,A._n&&(A._n.port.postMessage({kill:!0}),A._n.disconnect(),A._n=null)},L=function(A){if(A._ra=null,A._r){try{A._r.stop()}catch(F){re("mr stop err",1,F)}A._r=null}},X=function(A){A=A||o;var F=A==o,_=A.Stream;_&&(_._m&&(_._m.disconnect(),_._m=null),!_._RC&&_._c&&o.CloseNewCtx(_._c),_._RC=null,_._c=null,_._d&&(M(_._d.stream),_._d=null),_._p&&(_._p.disconnect(),_._p.onaudioprocess=_._p=null),W(_),L(_),F&&M(_)),A.Stream=0},M=o.StopS_=function(A){for(var F=oe(A),_=0;_<F.length;_++){var Y=F[_];Y.stop&&Y.stop()}A.stop&&A.stop()},oe=function(A){var F=0,_=0,Y=[];A.getAudioTracks&&(F=A.getAudioTracks(),_=A.getVideoTracks()),F||(F=A.audioTracks,_=A.videoTracks);for(var ce=0,xe=F?F.length:0;ce<xe;ce++)Y.push(F[ce]);for(var ce=0,xe=_?_.length:0;ce<xe;ce++)Y.push(_[ce]);return Y};o.SampleData=function(A,F,_,Y,ce){var xe="SampleData";Y||(Y={});var De=Y.index||0,He=Y.offset||0,Ze=Y.raisePrev||0,je=Y.filter;if(je&&je.fn&&(je.sr&&je.sr!=F||je.srn&&je.srn!=_)&&(je=null,re(j("d48C::{1}的filter采样率变了，重设滤波",0,xe),3)),!je)if(_<=F){var Fe=_>F*3/4?0:_/2*3/4;je={fn:Fe?o.IIRFilter(!0,F,Fe):0}}else{var Fe=F>_*3/4?0:F/2*3/4;je={fn:Fe?o.IIRFilter(!0,_,Fe):0}}je.sr=F,je.srn=_;var pt=je.fn,Je=Y.frameNext||[];ce||(ce={});var at=ce.frameSize||1;ce.frameType&&(at=ce.frameType=="mp3"?1152:1);var Ke=ce._sum,yt=0,V=A.length;De>V+1&&re(j("tlbC::{1}似乎传入了未重置chunk {2}",0,xe,De+">"+V),3);for(var pe=0,me=De;me<V;me++)pe+=A[me].length;var J=F/_;if(J>1)pe=Math.max(0,pe-Math.floor(He)),pe=Math.floor(pe/J);else if(J<1){var $e=1/J;pe=Math.floor(pe*$e)}pe+=Je.length;for(var K=new Int16Array(pe),ie=0,me=0;me<Je.length;me++)K[ie]=Je[me],ie++;for(;De<V;De++){var Oe=A[De],he=Oe instanceof Float32Array,me=He,Be=Oe.length,te=pt&&pt.Embed,Le=0,le=0,ae=0,m=0;if(J<1){for(var R=ie+me,U=Ze,ne=0;ne<Be;ne++){var z=Oe[ne];he&&(z=Math.max(-1,Math.min(1,z)),z=z<0?z*32768:z*32767);var I=Math.floor(R);R+=$e;for(var N=Math.floor(R),k=(z-U)/(N-I),Q=1;I<N;I++,Q++){var w=Math.floor(U+Q*k);te?(ae=w,m=te.b0*ae+te.b1*te.x1+te.b0*te.x2-te.a1*te.y1-te.a2*te.y2,te.x2=te.x1,te.x1=ae,te.y2=te.y1,te.y1=m,w=m):w=pt?pt(w):w,w>32767?w=32767:w<-32768&&(w=-32768),Ke&&(yt+=Math.abs(w)),K[I]=w,ie++}U=Ze=z,me+=$e}He=me%1;continue}for(var ne=0,ye=0;ne<Be;ne++,ye++){if(ye<Be){var z=Oe[ye];he&&(z=Math.max(-1,Math.min(1,z)),z=z<0?z*32768:z*32767),te?(ae=z,m=te.b0*ae+te.b1*te.x1+te.b0*te.x2-te.a1*te.y1-te.a2*te.y2,te.x2=te.x1,te.x1=ae,te.y2=te.y1,te.y1=m):m=pt?pt(z):z}if(Le=le,le=m,ye==0){ne--;continue}var O=Math.floor(me);if(ne==O){var $=Math.ceil(me),H=me-O,q=Le,de=$<Be?le:q,x=q+(de-q)*H;x>32767?x=32767:x<-32768&&(x=-32768),Ke&&(yt+=Math.abs(x)),K[ie]=x,ie++,me+=J}}He=Math.max(0,me-Be)}J<1&&ie+1==pe&&(pe--,K=new Int16Array(K.buffer.slice(0,pe*2))),ie-1!=pe&&ie!=pe&&re(xe+" idx:"+ie+" != size:"+pe,3),Je=null;var E=pe%at;if(E>0){var ke=(pe-E)*2;Je=new Int16Array(K.buffer.slice(ke)),K=new Int16Array(K.buffer.slice(0,ke))}var ge={index:De,offset:He,raisePrev:Ze,filter:je,frameNext:Je,sampleRate:_,data:K};return Ke&&(ge._sum=yt),ge},o.IIRFilter=function(A,F,_){var Y=2*Math.PI*_/F,ce=Math.sin(Y),xe=Math.cos(Y),De=ce/2,He=1+De,Ze=-2*xe/He,je=(1-De)/He;if(A)var Fe=(1-xe)/2/He,pt=(1-xe)/He;else var Fe=(1+xe)/2/He,pt=-(1+xe)/He;var Je=0,at=0,Ke=0,yt=0,V=0,pe=function(me){return Ke=Fe*me+pt*Je+Fe*at-Ze*yt-je*V,at=Je,Je=me,V=yt,yt=Ke,Ke};return pe.Embed={x1:0,x2:0,y1:0,y2:0,b0:Fe,b1:pt,a1:Ze,a2:je},pe},o.PowerLevel=function(A,F){var _=A/F||0,Y;return _<1251?Y=Math.round(_/1250*10):Y=Math.round(Math.min(100,Math.max(0,(1+Math.log(_/1e4)/Math.log(10))*100))),Y},o.PowerDBFS=function(A){var F=Math.max(.1,A||0),_=32767;return F=Math.min(F,_),F=20*Math.log(F/_)/Math.log(10),Math.max(-100,Math.round(F))},o.CLog=function(A,F){if(typeof console=="object"){var _=new Date,Y=("0"+_.getMinutes()).substr(-2)+":"+("0"+_.getSeconds()).substr(-2)+"."+("00"+_.getMilliseconds()).substr(-3),ce=this&&this.envIn&&this.envCheck&&this.id,xe=["["+Y+" "+u+(ce?":"+ce:"")+"]"+A],De=arguments,He=o.CLog,Ze=2,je=He.log||console.log;for(a(F)?je=F==1?He.error||console.error:F==3?He.warn||console.warn:je:Ze=1;Ze<De.length;Ze++)xe.push(De[Ze]);be?je&&je("[IsLoser]"+xe[0],xe.length>1?xe:""):je.apply(console,xe)}};var re=function(){o.CLog.apply(this,arguments)},be=!0;try{be=!console.log.apply}catch{}var ze=0;function Ue(A){var F=this;F.id=++ze,we();var _={type:"mp3",onProcess:n};for(var Y in A)_[Y]=A[Y];F.set=_;var ce=_[h],xe=_[d];(ce&&!a(ce)||xe&&!a(xe))&&F.CLog(j.G("IllegalArgs-1",[j("VtS4::{1}和{2}必须是数值",0,d,h)]),1,A),_[h]=+ce||16,_[d]=+xe||16e3,F.state=0,F._S=9,F.Sync={O:9,C:9}}o.Sync={O:9,C:9},o.prototype=Ue.prototype={CLog:re,_streamStore:function(){return this.set.sourceStream?this:o},_streamGet:function(){return this._streamStore().Stream},_streamCtx:function(){var A=this._streamGet();return A&&A._c},open:function(A,F){var _=this,Y=_.set,ce=_._streamStore(),xe=0;A=A||n;var De=function(ie,Oe){Oe=!!Oe,_.CLog(j("5tWi::录音open失败：")+ie+",isUserNotAllow:"+Oe,1),xe&&o.CloseNewCtx(xe),F&&F(ie,Oe)};_._streamTag=c;var He=function(){_.CLog("open ok, id:"+_.id+" stream:"+_._streamTag),A(),_._SO=0},Ze=ce.Sync,je=++Ze.O,Fe=Ze.C;_._O=_._O_=je,_._SO=_._S;var pt=function(){if(Fe!=Ze.C||!_._O){var ie=j("dFm8::open被取消");return je==Ze.O?_.close():ie=j("VtJO::open被中断"),De(ie),!0}};if(!r){De(j.G("NonBrowser-1",["open"])+j("EMJq::，可尝试使用RecordApp解决方案")+"("+l+"/tree/master/app-support-sample)");return}var Je=_.envCheck({envName:"H5",canProcess:!0});if(Je){De(j("A5bm::不能录音：")+Je);return}var at,Ke=function(){at=Y.runningContext,at||(at=xe=o.GetContext(!0))};if(Y.sourceStream){if(_._streamTag="set.sourceStream",!o.GetContext()){De(j("1iU7::不支持此浏览器从流中获取录音"));return}Ke(),X(ce);var yt=_.Stream=Y.sourceStream;yt._c=at,yt._RC=Y.runningContext,yt._call={};try{P(ce)}catch(ie){X(ce),De(j("BTW2::从流中打开录音失败：")+ie.message);return}He();return}var V=function(ie,Oe){try{window.top.a}catch{De(j("Nclz::无权录音(跨域，请尝试给iframe添加麦克风访问策略，如{1})",0,'allow="camera;microphone"'));return}pe(1,ie)&&(/Found/i.test(ie)?De(Oe+j("jBa9::，无可用麦克风")):De(Oe))},pe=function(ie,Oe){if(/Permission|Allow/i.test(Oe))ie&&De(j("gyO5::用户拒绝了录音权限"),!0);else if(window.isSecureContext===!1)ie&&De(j("oWNo::浏览器禁止不安全页面录音，可开启https解决"));else return 1};if(o.IsOpen()){He();return}if(!o.Support()){V("",j("COxc::此浏览器不支持录音"));return}Ke();var me=function(ie){setTimeout(function(){ie._call={};var Oe=o.Stream;Oe&&(X(),ie._call=Oe._call),o.Stream=ie,ie._c=at,ie._RC=Y.runningContext,!pt()&&(o.IsOpen()?(Oe&&_.CLog(j("upb8::发现同时多次调用open"),1),P(ce),He()):De(j("Q1GA::录音功能无效：无音频流")))},100)},J=function(ie){var Oe=ie.name||ie.message||ie.code+":"+ie,he="";$e==1&&pe(0,Oe)&&(he=j("KxE2::，将尝试禁用回声消除后重试")),_.CLog(j("xEQR::请求录音权限错误")+he+"|"+ie,he?3:1,ie),he?K(1):V(Oe,j("bDOG::无法录音：")+ie)},$e=0,K=function(ie){$e++;var Oe="audioTrackSet",he="autoGainControl",Be="echoCancellation",te="noiseSuppression",Le=Oe+":{"+Be+","+te+","+he+"}",le=JSON.parse(i(Y[Oe]||!0));_.CLog("open... "+$e+" "+Oe+":"+i(le)),ie&&(typeof le!="object"&&(le={}),le[he]=!1,le[Be]=!1,le[te]=!1),le[d]&&_.CLog(j("IjL3::注意：已配置{1}参数，可能会出现浏览器不能正确选用麦克风、移动端无法启用回声消除等现象",0,Oe+"."+d),3);var ae={audio:le,video:Y.videoTrackSet||!1};try{var m=o.Scope[c](ae,me,J)}catch(R){_.CLog(c,3,R),ae={audio:!0,video:!1},m=o.Scope[c](ae,me,J)}_.CLog(c+"("+i(ae)+") "+C(at)+j("RiWe::，未配置 {1} 时浏览器可能会自动启用回声消除，移动端未禁用回声消除时可能会降低系统播放音量（关闭录音后可恢复）和仅提供16k采样率的音频流（不需要回声消除时可明确配置成禁用来获得48k高音质的流），请参阅文档中{2}配置",0,Le,Oe)+"("+l+") LM:"+s+" UA:"+navigator.userAgent),m&&m.then&&m.then(me)[v](J)};K()},close:function(A){A=A||n;var F=this,_=F._streamStore();F._stop();var Y=" stream:"+F._streamTag,ce=_.Sync;if(F._O=0,F._O_!=ce.O){F.CLog(j("hWVz::close被忽略（因为同时open了多个rec，只有最后一个会真正close）")+Y,3),A();return}ce.C++,X(_),F.CLog("close,"+Y),A()},mock:function(A,F){var _=this;return _._stop(),_.isMock=1,_.mockEnvInfo=null,_.buffers=[A],_.recSize=A.length,_._setSrcSR(F),_._streamTag="mock",_},_setSrcSR:function(A){var F=this,_=F.set,Y=_[d];Y>A?_[d]=A:Y=0,F[f]=A,F.CLog(f+": "+A+" set."+d+": "+_[d]+(Y?" "+j("UHvm::忽略")+": "+Y:""),Y?3:0)},envCheck:function(A){var F,_=this,Y=_.set,ce="CPU_BE";if(!F&&!o[ce]&&typeof Int8Array=="function"&&!new Int8Array(new Int32Array([1]).buffer)[0]&&(we(ce),F=j("Essp::不支持{1}架构",0,ce)),!F){var xe=Y.type,De=_[xe+"_envCheck"];Y.takeoffEncodeChunk&&(De?A.canProcess||(F=j("7uMV::{1}环境不支持实时处理",0,A.envName)):F=j("2XBl::{1}类型不支持设置takeoffEncodeChunk",0,xe)+(_[xe]?"":j("LG7e::(未加载编码器)"))),!F&&De&&(F=_[xe+"_envCheck"](A,Y))}return F||""},envStart:function(A,F){var _=this,Y=_.set;if(_.isMock=A?1:0,_.mockEnvInfo=A,_.buffers=[],_.recSize=0,A&&(_._streamTag="env$"+A.envName),_.state=1,_.envInLast=0,_.envInFirst=0,_.envInFix=0,_.envInFixTs=[],_._setSrcSR(F),_.engineCtx=0,_[Y.type+"_start"]){var ce=_.engineCtx=_[Y.type+"_start"](Y);ce&&(ce.pcmDatas=[],ce.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(A,F){var _=this,Y=_.set,ce=_.engineCtx;if(_.state!=1){_.state||_.CLog("envIn at state=0",3);return}var xe=_[f],De=A.length,He=o.PowerLevel(F,De),Ze=_.buffers,je=Ze.length;Ze.push(A);var Fe=Ze,pt=je,Je=Date.now(),at=Math.round(De/xe*1e3);_.envInLast=Je,_.buffers.length==1&&(_.envInFirst=Je-at);var Ke=_.envInFixTs;Ke.splice(0,0,{t:Je,d:at});for(var yt=Je,V=0,pe=0;pe<Ke.length;pe++){var me=Ke[pe];if(Je-me.t>3e3){Ke.length=pe;break}yt=me.t,V+=me.d}var J=Ke[1],$e=Je-yt,K=$e-V;if(K>$e/3&&(J&&$e>1e3||Ke.length>=6)){var ie=Je-J.t-at;if(ie>at/5){var Oe=!Y.disableEnvInFix;if(_.CLog("["+Je+"]"+ve.get(j(Oe?"4Kfd::补偿{1}ms":"bM5i::未补偿{1}ms",1),[ie]),3),_.envInFix+=ie,Oe){var he=new Int16Array(ie*xe/1e3);De+=he.length,Ze.push(he)}}}var Be=_.recSize,te=De,Le=Be+te;if(_.recSize=Le,ce){var le=o.SampleData(Ze,xe,Y[d],ce.chunkInfo);ce.chunkInfo=le,Be=ce.pcmSize,te=le.data.length,Le=Be+te,ce.pcmSize=Le,Ze=ce.pcmDatas,je=Ze.length,Ze.push(le.data),xe=le[d]}var ae=Math.round(Le/xe*1e3),m=Ze.length,R=Fe.length,U=function(){for(var k=ne?0:-te,Q=Ze[0]==null,w=je;w<m;w++){var ye=Ze[w];ye==null?Q=1:(k+=ye.length,ce&&ye.length&&_[Y.type+"_encode"](ce,ye))}if(Q&&ce){var w=pt;for(Fe[0]&&(w=0);w<R;w++)Fe[w]=null}Q&&(k=ne?te:0,Ze[0]=null),ce?ce.pcmSize+=k:_.recSize+=k},ne=0,z="rec.set.onProcess";try{ne=Y.onProcess(Ze,He,ae,xe,je,U)}catch(k){console.error(z+j("gFUF::回调出错是不允许的，需保证不会抛异常"),k)}var I=Date.now()-Je;if(I>10&&_.envInFirst-Je>1e3&&_.CLog(z+j("2ghS::低性能，耗时{1}ms",0,I),3),ne===!0){for(var N=0,pe=je;pe<m;pe++)Ze[pe]==null?N=1:Ze[pe]=new Int16Array(0);N?_.CLog(j("ufqH::未进入异步前不能清除buffers"),3):ce?ce.pcmSize-=te:_.recSize-=te}else U()},start:function(){var A=this,F=1;if(A.set.sourceStream?A.Stream||(F=0):o.IsOpen()||(F=0),!F){A.CLog(j("6WmN::start失败：未open"),1);return}var _=A._streamCtx();if(A.CLog(j("kLDN::start 开始录音，")+C(_)+" stream:"+A._streamTag),A._stop(),A.envStart(null,_[d]),A.state=3,A._SO&&A._SO+1!=A._S){A.CLog(j("Bp2y::start被中断"),3);return}A._SO=0;var Y=function(){A.state==3&&(A.state=1,A.resume())},ce="AudioContext resume: ",xe=A._streamGet();xe._call[A.id]=function(){A.CLog(ce+_.state+"|stream ok"),Y()},y(_,function(De){return De&&A.CLog(ce+"wait..."),A.state==3},function(De){De&&A.CLog(ce+_.state),Y()},function(De){A.CLog(ce+_.state+j("upkE::，可能无法录音：")+De,1),Y()})},pause:function(){var A=this,F=A._streamGet();A.state&&(A.state=2,A.CLog("pause"),F&&delete F._call[A.id])},resume:function(){var A=this,F=A._streamGet(),_="resume",Y=_+"(wait ctx)";if(A.state==3)A.CLog(Y);else if(A.state){A.state=1,A.CLog(_),A.envResume(),F&&(F._call[A.id]=function(xe,De){A.state==1&&A.envIn(xe,De)},G(F));var ce=A._streamCtx();ce&&y(ce,function(xe){return xe&&A.CLog(Y+"..."),A.state==1},function(xe){xe&&A.CLog(Y+ce.state),G(F)},function(xe){A.CLog(Y+ce.state+"[err]"+xe,1)})}},_stop:function(A){var F=this,_=F.set;F.isMock||F._S++,F.state&&(F.pause(),F.state=0),!A&&F[_.type+"_stop"]&&(F[_.type+"_stop"](F.engineCtx),F.engineCtx=0)},stop:function(A,F,_){var Y=this,ce=Y.set,xe,De=Y.envInLast-Y.envInFirst,He=De&&Y.buffers.length;Y.CLog(j("Xq4s::stop 和start时差:")+(De?De+"ms "+j("3CQP::补偿:")+Y.envInFix+"ms envIn:"+He+" fps:"+(He/De*1e3).toFixed(1):"-")+" stream:"+Y._streamTag+" ("+l+") LM:"+s);var Ze=function(){Y._stop(),_&&Y.close()},je=function(me){Y.CLog(j("u8JG::结束录音失败：")+me,1),F&&F(me),Ze()},Fe=function(me,J,$e){var K="blob",ie="arraybuffer",Oe="dataType",he="DefaultDataType",Be=Y[Oe]||o[he]||K,te=Oe+"="+Be,Le=me instanceof ArrayBuffer,le=0,ae=Le?me.byteLength:me.size;if(Be==ie?Le||(le=1):Be==K?typeof Blob!="function"?le=j.G("NonBrowser-1",[te])+j("1skY::，请设置{1}",0,u+"."+he+'="'+ie+'"'):(Le&&(me=new Blob([me],{type:J})),me instanceof Blob||(le=1),J=me.type||J):le=j.G("NotSupport-1",[te]),Y.CLog(j("Wv7l::结束录音 编码花{1}ms 音频时长{2}ms 文件大小{3}b",0,Date.now()-xe,$e,ae)+" "+te+","+J),le){je(le!=1?le:j("Vkbd::{1}编码器返回的不是{2}",0,ce.type,Be)+", "+te);return}if(ce.takeoffEncodeChunk)Y.CLog(j("QWnr::启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据"),3);else if(ae<Math.max(50,$e/5)){je(j("Sz2H::生成的{1}无效",0,ce.type));return}A&&A(me,$e,J),Ze()};if(!Y.isMock){var pt=Y.state==3;if(!Y.state||pt){je(j("wf9t::未开始录音")+(pt?j("Dl2c::，开始录音前无用户交互导致AudioContext未运行"):""));return}}Y._stop(!0);var Je=Y.recSize;if(!Je){je(j("Ltz3::未采集到录音"));return}if(!Y[ce.type]){je(j("xGuI::未加载{1}编码器，请尝试到{2}的src/engine内找到{1}的编码器并加载",0,ce.type,u));return}if(Y.isMock){var at=Y.envCheck(Y.mockEnvInfo||{envName:"mock",canProcess:!1});if(at){je(j("AxOH::录音错误：")+at);return}}var Ke=Y.engineCtx;if(Y[ce.type+"_complete"]&&Ke){var pe=Math.round(Ke.pcmSize/ce[d]*1e3);xe=Date.now(),Y[ce.type+"_complete"](Ke,function(J,$e){Fe(J,$e,pe)},je);return}if(xe=Date.now(),!Y.buffers[0]){je(j("xkKd::音频buffers被释放"));return}var yt=o.SampleData(Y.buffers,Y[f],ce[d]);ce[d]=yt[d];var V=yt.data,pe=Math.round(V.length/ce[d]*1e3);Y.CLog(j("CxeT::采样:{1} 花:{2}ms",0,Je+"->"+V.length,Date.now()-xe)),setTimeout(function(){xe=Date.now(),Y[ce.type](V,function(me,J){Fe(me,J,pe)},function(me){je(me)})})}};var Ge=function(A,F){F.pos||(F.pos=[0],F.tracks={},F.bytes=[]);var _=F.tracks,Y=[F.pos[0]],ce=function(){F.pos[0]=Y[0]},xe=F.bytes.length,De=new Uint8Array(xe+A.length);if(De.set(F.bytes),De.set(A,xe),F.bytes=De,!F._ht){if(Pe(De,Y),Se(De,Y),!Ne(Pe(De,Y),[24,83,128,103]))return;for(Pe(De,Y);Y[0]<De.length;){var He=Pe(De,Y),Ze=Se(De,Y),je=[0],Fe=0;if(!Ze)return;if(Ne(He,[22,84,174,107])){for(;je[0]<Ze.length;){var pt=Pe(Ze,je),Je=Se(Ze,je),at=[0],Ke={channels:0,sampleRate:0};if(Ne(pt,[174]))for(;at[0]<Je.length;){var yt=Pe(Je,at),V=Se(Je,at),pe=[0];if(Ne(yt,[215])){var me=Me(V);Ke.number=me,_[me]=Ke}else if(Ne(yt,[131])){var me=Me(V);me==1?Ke.type="video":me==2?(Ke.type="audio",Fe||(F.track0=Ke),Ke.idx=Fe++):Ke.type="Type-"+me}else if(Ne(yt,[134])){for(var J="",$e=0;$e<V.length;$e++)J+=String.fromCharCode(V[$e]);Ke.codec=J}else if(Ne(yt,[225]))for(;pe[0]<V.length;){var K=Pe(V,pe),ie=Se(V,pe);if(Ne(K,[181])){var me=0,Oe=new Uint8Array(ie.reverse()).buffer;ie.length==4?me=new Float32Array(Oe)[0]:ie.length==8?me=new Float64Array(Oe)[0]:re("WebM Track !Float",1,ie),Ke[d]=Math.round(me)}else Ne(K,[98,100])?Ke.bitDepth=Me(ie):Ne(K,[159])&&(Ke.channels=Me(ie))}}}F._ht=1,re("WebM Tracks",_),ce();break}}}var he=F.track0;if(he){var Be=he[d];if(F.webmSR=Be,he.bitDepth==16&&/FLOAT/i.test(he.codec)&&(he.bitDepth=32,re("WebM 16->32 bit",3)),Be<8e3||he.bitDepth!=32||he.channels<1||!/(\b|_)PCM\b/i.test(he.codec))return F.bytes=[],F.bad||re("WebM Track Unexpected",3,F),F.bad=1,-1;for(var te=[],Le=0;Y[0]<De.length;){var pt=Pe(De,Y),Je=Se(De,Y);if(!Je)break;if(Ne(pt,[163])){var le=Je[0]&15,Ke=_[le];if(!Ke)re("WebM !Track"+le,1,_);else if(Ke.idx===0){for(var ae=new Uint8Array(Je.length-4),$e=4;$e<Je.length;$e++)ae[$e-4]=Je[$e];te.push(ae),Le+=ae.length}}ce()}if(Le){var m=new Uint8Array(De.length-F.pos[0]);m.set(De.subarray(F.pos[0])),F.bytes=m,F.pos[0]=0;for(var ae=new Uint8Array(Le),$e=0,R=0;$e<te.length;$e++)ae.set(te[$e],R),R+=te[$e].length;var Oe=new Float32Array(ae.buffer);if(he.channels>1){for(var U=[],$e=0;$e<Oe.length;)U.push(Oe[$e]),$e+=he.channels;Oe=new Float32Array(U)}return Oe}}},Ne=function(A,F){if(!A||A.length!=F.length)return!1;if(A.length==1)return A[0]==F[0];for(var _=0;_<A.length;_++)if(A[_]!=F[_])return!1;return!0},Me=function(A){for(var F="",_=0;_<A.length;_++){var Y=A[_];F+=(Y<16?"0":"")+Y.toString(16)}return parseInt(F,16)||0},Pe=function(A,F,_){var Y=F[0];if(!(Y>=A.length)){var ce=A[Y],xe=("0000000"+ce.toString(2)).substr(-8),De=/^(0*1)(\d*)$/.exec(xe);if(De){var He=De[1].length,Ze=[];if(!(Y+He>A.length)){for(var je=0;je<He;je++)Ze[je]=A[Y],Y++;return _&&(Ze[0]=parseInt(De[2]||"0",2)),F[0]=Y,Ze}}}},Se=function(A,F){var _=Pe(A,F,1);if(_){var Y=Me(_),ce=F[0],xe=[];if(Y<2147483647){if(ce+Y>A.length)return;for(var De=0;De<Y;De++)xe[De]=A[ce],ce++}return F[0]=ce,xe}},ve=o.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(A,F){var _=u+".i18n.put: ",Y=A.overwrite;Y=Y==null||Y;var ce=A.lang;if(ce=ve.alias[ce]||ce,!ce)throw new Error(_+"set.lang?");var xe=ve.locales[ce];xe||(xe={},ve.locales[ce]=xe);for(var De=/^([\w\-]+):/,He,Ze=0;Ze<F.length;Ze++){var Fe=F[Ze];if(He=De.exec(Fe),!He){re(_+"'key:'? "+Fe,3,A);continue}var je=He[1],Fe=Fe.substr(je.length+1);!Y&&xe[je]||(xe[je]=Fe)}},get:function(){return ve.v_G.apply(null,arguments)},v_G:function(A,F,_){F=F||[],_=_||ve.lang,_=ve.alias[_]||_;var Y=ve.locales[_],ce=Y&&Y[A]||"";return!ce&&_!="zh"?_=="en"?ve.v_G(A,F,"zh"):ve.v_G(A,F,"en"):(ve.lastLang=_,ce=="=Empty"?"":ce.replace(/\{(\d+)(\!?)\}/g,function(xe,De,He){return De=+De||0,xe=F[De-1],(De<1||De>F.length)&&(xe="{?}",re("i18n["+A+"] no {"+De+"}: "+ce,3)),He?"":xe}))},$T:function(){return ve.v_T.apply(null,arguments)},v_T:function(){for(var A=arguments,F="",_=[],Y=0,ce=u+".i18n.$T:",xe=/^([\w\-]*):/,De,He=0;He<A.length;He++){var Ze=A[He];if(He==0){if(De=xe.exec(Ze),F=De&&De[1],!F)throw new Error(ce+"0 'key:'?");Ze=Ze.substr(F.length+1)}if(Y===-1)_.push(Ze);else{if(Y)throw new Error(ce+" bad args");if(Ze===0)Y=-1;else if(a(Ze)){if(Ze<1)throw new Error(ce+" bad args");Y=Ze}else{var je=He==1?"en":He?"":"zh";if(De=xe.exec(Ze),De&&(je=De[1]||je,Ze=Ze.substr(De[1].length+1)),!De||!je)throw new Error(ce+He+" 'lang:'?");ve.put({lang:je,overwrite:!1},[F+":"+Ze])}}}return F?Y>0?F:ve.v_G(F,_):""}},j=ve.$T;j.G=ve.get,j("NonBrowser-1::非浏览器环境，不支持{1}",1),j("IllegalArgs-1::参数错误：{1}",1),j("NeedImport-2::调用{1}需要先导入{2}",2),j("NotSupport-1::不支持：{1}",1),o.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var we=o.Traffic=function(A){if(r){A=A?"/"+u+"/Report/"+A:"";var F=o.TrafficImgUrl;if(F){var _=o.Traffic,Y=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],ce=Y[1]||"http://file/",xe=(Y[0]||ce)+A;if(F.indexOf("//")==0&&(/^https:/i.test(xe)?F="https:"+F:F="http:"+F),A&&(F=F+"&cu="+encodeURIComponent(ce+A)),!_[xe]){_[xe]=1;var De=new Image;De.src=F,re("Traffic Analysis Image: "+(A||u+".TrafficImgUrl="+o.TrafficImgUrl))}}}};p&&(re(j("8HO5::覆盖导入{1}",0,u),1),p.Destroy()),t[u]=o})})(Hf);var P4=Hf.exports;const L4=D0(P4);(function(e){var t=typeof window=="object"&&!!window.document,r=t?window:Object,n=r.Recorder,a=n.i18n;e(n,a,a.$T,t)})(function(e,t,r,n){var a="48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000",i="8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 192, 224, 256, 320";e.prototype.enc_mp3={stable:!0,takeEC:"full",getTestMsg:function(){return r("Zm7L::采样率范围：{1}；比特率范围：{2}（不同比特率支持的采样率范围不同，小于32kbps时采样率需小于32000）",0,a,i)}};var o=function(v){var p=v.bitRate,g=v.sampleRate,b=g;if((" "+i+",").indexOf(" "+p+",")==-1&&e.CLog(r("eGB9::{1}不在mp3支持的取值范围：{2}",0,"bitRate="+p,i),3),(" "+a+",").indexOf(" "+g+",")==-1){for(var y=a.split(", "),S=[],C=0;C<y.length;C++)S.push({v:+y[C],s:Math.abs(y[C]-g)});S.sort(function(T,D){return T.s-D.s}),b=S[0].v,v.sampleRate=b,e.CLog(r("zLTa::sampleRate已更新为{1}，因为{2}不在mp3支持的取值范围：{3}",0,b,g,a),3)}},s=function(){return r.G("NeedImport-2",["mp3.js","src/engine/mp3-engine.js"])},l=n&&typeof Worker=="function";e.prototype.mp3=function(v,p,g){var b=this,y=b.set,S=v.length;if(!e.lamejs){g(s());return}if(l){var C=b.mp3_start(y);if(C){if(C.isW){b.mp3_encode(C,v),b.mp3_complete(C,p,g,1);return}b.mp3_stop(C)}}o(y);var T=new e.lamejs.Mp3Encoder(1,y.sampleRate,y.bitRate),D=57600,P=new Int8Array(5e5),G=0,W=0,L=0,X=function(){try{if(W<S)var M=T.encodeBuffer(v.subarray(W,W+D));else{L=1;var M=T.flush()}}catch(Ue){if(console.error(Ue),!L)try{T.flush()}catch(Ge){console.error(Ge)}g("MP3 Encoder: "+Ue.message);return}var oe=M.length;if(oe>0){if(G+oe>P.length){var re=new Int8Array(P.length+Math.max(5e5,oe));re.set(P.subarray(0,G)),P=re}P.set(M,G),G+=oe}if(W<S)W+=D,setTimeout(X);else{var be=[P.buffer.slice(0,G)],ze=d.fn(be,G,S,y.sampleRate);h(ze,y),p(be[0]||new ArrayBuffer(0),"audio/mp3")}};X()};var u;e.BindDestroy("mp3Worker",function(){u&&(e.CLog("mp3Worker Destroy"),u.terminate(),u=null)}),e.prototype.mp3_envCheck=function(v,p){var g="";return p.takeoffEncodeChunk&&(f()||(g=r("yhUs::当前浏览器版本太低，无法实时处理"))),!g&&!e.lamejs&&(g=s()),g},e.prototype.mp3_start=function(v){return f(v)};var c={id:0},f=function(v,p){var g=function(L){var X=L.data,M=S.wkScope.wk_ctxs,oe=S.wkScope.wk_lame,re=S.wkScope.wk_mp3TrimFix,be=M[X.id];if(X.action=="init")M[X.id]={sampleRate:X.sampleRate,bitRate:X.bitRate,takeoff:X.takeoff,pcmSize:0,memory:new Int8Array(5e5),mOffset:0,encObj:new oe.Mp3Encoder(1,X.sampleRate,X.bitRate)};else if(!be)return;var ze=function(Me){var Pe=Me.length;if(be.mOffset+Pe>be.memory.length){var Se=new Int8Array(be.memory.length+Math.max(5e5,Pe));Se.set(be.memory.subarray(0,be.mOffset)),be.memory=Se}be.memory.set(Me,be.mOffset),be.mOffset+=Pe};switch(X.action){case"stop":if(!be.isCp)try{be.encObj.flush()}catch(Me){console.error(Me)}be.encObj=null,delete M[X.id];break;case"encode":if(be.isCp)break;be.pcmSize+=X.pcm.length;try{var Ue=be.encObj.encodeBuffer(X.pcm)}catch(Me){be.err=Me,console.error(Me)}Ue&&Ue.length>0&&(be.takeoff?C.onmessage({action:"takeoff",id:X.id,chunk:Ue}):ze(Ue));break;case"complete":be.isCp=1;try{var Ue=be.encObj.flush()}catch(Me){be.err=Me,console.error(Me)}if(Ue&&Ue.length>0&&(be.takeoff?C.onmessage({action:"takeoff",id:X.id,chunk:Ue}):ze(Ue)),be.err){C.onmessage({action:X.action,id:X.id,err:"MP3 Encoder: "+be.err.message});break}var Ge=[be.memory.buffer.slice(0,be.mOffset)],Ne=re.fn(Ge,be.mOffset,be.pcmSize,be.sampleRate);C.onmessage({action:X.action,id:X.id,blob:Ge[0]||new ArrayBuffer(0),meta:Ne});break}},b=function(L){C.onmessage=function(X){var M=X;L&&(M=X.data);var oe=c[M.id];oe&&(M.action=="takeoff"?oe.set.takeoffEncodeChunk(new Uint8Array(M.chunk.buffer)):(oe.call&&oe.call(M),oe.call=null))}},y=function(){var L={worker:C,set:v};return v?(L.id=++c.id,c[L.id]=L,o(v),C.postMessage({action:"init",id:L.id,sampleRate:v.sampleRate,bitRate:v.bitRate,takeoff:!!v.takeoffEncodeChunk,x:new Int16Array(5)})):C.postMessage({x:new Int16Array(5)}),L},S,C=u;if(p||!l)return e.CLog(r("k9PT::当前环境不支持Web Worker，mp3实时编码器运行在主线程中"),3),C={postMessage:function(L){g({data:L})}},S={wkScope:{wk_ctxs:{},wk_lame:e.lamejs,wk_mp3TrimFix:d}},b(),y();try{if(!C){var T=(g+"").replace(/[\w\$]+\.onmessage/g,"self.postMessage");T=T.replace(/[\w\$]+\.wkScope/g,"wkScope");var D=");wk_lame();self.onmessage="+T;D+=";var wkScope={ wk_ctxs:{},wk_lame:wk_lame",D+=",wk_mp3TrimFix:{rm:"+d.rm+",fn:"+d.fn+"} }";var P=e.lamejs.toString(),G=(window.URL||webkitURL).createObjectURL(new Blob(["var wk_lame=(",P,D],{type:"text/javascript"}));C=new Worker(G),setTimeout(function(){(window.URL||webkitURL).revokeObjectURL(G)},1e4),b(1)}var W=y();return W.isW=1,u=C,W}catch(L){return C&&C.terminate(),console.error(L),f(v,1)}};e.prototype.mp3_stop=function(v){if(v&&v.worker){v.worker.postMessage({action:"stop",id:v.id}),v.worker=null,delete c[v.id];var p=-1;for(var g in c)p++;p&&e.CLog(r("fT6M::mp3 worker剩{1}个未stop",0,p),3)}},e.prototype.mp3_encode=function(v,p){v&&v.worker&&v.worker.postMessage({action:"encode",id:v.id,pcm:p})},e.prototype.mp3_complete=function(v,p,g,b){var y=this;v&&v.worker?(v.call=function(S){b&&y.mp3_stop(v),S.err?g(S.err):(h(S.meta,v.set),p(S.blob,"audio/mp3"))},v.worker.postMessage({action:"complete",id:v.id})):g(r("mPxH::mp3编码器未start"))},e.mp3ReadMeta=function(v,p){var g=typeof window<"u"&&window.parseInt||typeof self<"u"&&self.parseInt||parseInt,b=new Uint8Array(v[0]||[]);if(b.length<4)return null;var y=function(Me,Pe){return("0000000"+((Pe||b)[Me]||0).toString(2)).substr(-8)},S=y(0)+y(1),C=y(2)+y(3);if(!/^1{11}/.test(S))return null;var T={"00":2.5,10:2,11:1}[S.substr(11,2)],D={"01":3}[S.substr(13,2)],P={1:[44100,48e3,32e3],2:[22050,24e3,16e3],"2.5":[11025,12e3,8e3]}[T];P&&(P=P[g(C.substr(4,2),2)]);var G=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320]][T==1?1:0][g(C.substr(0,4),2)];if(!T||!D||!G||!P)return null;for(var W=Math.round(p*8/G),L=D==1?384:D==2||T==1?1152:576,X=L/P*1e3,M=Math.floor(L*G/8/P*1e3),oe=0,re=0,be=0;be<v.length;be++){var ze=v[be];if(re+=ze.byteLength,re>=M+3){var Ue=new Uint8Array(ze),Ge=ze.byteLength-(re-(M+3)+1),Ne=y(Ge,Ue);oe=Ne.charAt(6)=="1";break}}return oe&&M++,{version:T,layer:D,sampleRate:P,bitRate:G,duration:W,size:p,hasPadding:oe,frameSize:M,frameDurationFloat:X}};var d={rm:e.mp3ReadMeta,fn:function(v,p,g,b){var y=this.rm(v,p);if(!y)return{size:p,err:"mp3 unknown format"};var S=Math.round(g/b*1e3),C=Math.floor((y.duration-S)/y.frameDurationFloat);if(C>0){var T=C*y.frameSize-(y.hasPadding?1:0);p-=T;for(var D=0,P=[],G=0;G<v.length;G++){var W=v[G];if(T<=0)break;T>=W.byteLength?(T-=W.byteLength,P.push(W),v.splice(G,1),G--):(v[G]=W.slice(T),D=W,T=0)}var L=this.rm(v,p);if(!L){D&&(v[0]=D);for(var G=0;G<P.length;G++)v.splice(G,0,P[G]);y.err="mp3 fix error: 已还原，错误原因不明"}var X=y.trimFix={};X.remove=C,X.removeDuration=Math.round(C*y.frameDurationFloat),X.duration=Math.round(p*8/y.bitRate)}return y}},h=function(v,p){var g="MP3 Info: ";(v.sampleRate&&v.sampleRate!=p.sampleRate||v.bitRate&&v.bitRate!=p.bitRate)&&(e.CLog(g+r("uY9i::和设置的不匹配{1}，已更新成{2}",0,"set:"+p.bitRate+"kbps "+p.sampleRate+"hz","set:"+v.bitRate+"kbps "+v.sampleRate+"hz"),3,p),p.sampleRate=v.sampleRate,p.bitRate=v.bitRate);var b=v.trimFix;b?(g+=r("iMSm::Fix移除{1}帧",0,b.remove)+" "+b.removeDuration+"ms -> "+b.duration+"ms",b.remove>2&&(v.err=(v.err?v.err+", ":"")+r("b9zm::移除帧数过多"))):g+=(v.duration||"-")+"ms",v.err?e.CLog(g,v.size?1:0,v.err,v):e.CLog(g,v)}});(function(e){var t=typeof window=="object"&&!!window.document,r=t?window:Object,n=r.Recorder;e(n)})(function(e){function t(){var r=function(V){return Math.log(V)/Math.log(10)},n=function(V){throw new Error("abort("+V+")")};function a(V){return new Int8Array(V)}function i(V){return new Int16Array(V)}function o(V){return new Int32Array(V)}function s(V){return new Float32Array(V)}function l(V){return new Float64Array(V)}function u(V){if(V.length==1)return s(V[0]);var pe=V[0];V=V.slice(1);for(var me=[],J=0;J<pe;J++)me.push(u(V));return me}function c(V){if(V.length==1)return o(V[0]);var pe=V[0];V=V.slice(1);for(var me=[],J=0;J<pe;J++)me.push(c(V));return me}function f(V){if(V.length==1)return i(V[0]);var pe=V[0];V=V.slice(1);for(var me=[],J=0;J<pe;J++)me.push(f(V));return me}function d(V){if(V.length==1)return new Array(V[0]);var pe=V[0];V=V.slice(1);for(var me=[],J=0;J<pe;J++)me.push(d(V));return me}var h={};h.fill=function(V,pe,me,J){if(arguments.length==2)for(var $e=0;$e<V.length;$e++)V[$e]=arguments[1];else for(var $e=pe;$e<me;$e++)V[$e]=J};var v={};v.arraycopy=function(V,pe,me,J,$e){for(var K=pe+$e;pe<K;)me[J++]=V[pe++]};var p={};p.SQRT2=1.4142135623730951,p.FAST_LOG10=function(V){return r(V)},p.FAST_LOG10_X=function(V,pe){return r(V)*pe};function g(V){this.ordinal=V}g.short_block_allowed=new g(0),g.short_block_coupled=new g(1),g.short_block_dispensed=new g(2),g.short_block_forced=new g(3);var b={};b.MAX_VALUE=34028235e31;function y(V){this.ordinal=V}y.vbr_off=new y(0),y.vbr_mt=new y(1),y.vbr_rh=new y(2),y.vbr_abr=new y(3),y.vbr_mtrh=new y(4),y.vbr_default=y.vbr_mtrh;function S(V){var pe=V;this.ordinal=function(){return pe}}S.STEREO=new S(0),S.JOINT_STEREO=new S(1),S.DUAL_CHANNEL=new S(2),S.MONO=new S(3),S.NOT_SET=new S(4);function C(){var V=3,pe=98,me=4;this.getLameShortVersion=function(){return V+"."+pe+"."+me}}function T(){var V=null;this.qupvt=null,this.setModules=function(O){this.qupvt=O,V=O};function pe(O){this.bits=0|O}var me=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function J(O,$,H,q,de,x){var E=.5946/$;for(O=O>>1;O--!=0;)de[x++]=E>H[q++]?0:1,de[x++]=E>H[q++]?0:1}function $e(O,$,H,q,de,x){O=O>>1;var E=O%2;for(O=O>>1;O--!=0;){var ke,ge,Ee,Ve,qe,ee,Ae,Qe;ke=H[q++]*$,ge=H[q++]*$,qe=0|ke,Ee=H[q++]*$,ee=0|ge,Ve=H[q++]*$,Ae=0|Ee,ke+=V.adj43[qe],Qe=0|Ve,ge+=V.adj43[ee],de[x++]=0|ke,Ee+=V.adj43[Ae],de[x++]=0|ge,Ve+=V.adj43[Qe],de[x++]=0|Ee,de[x++]=0|Ve}if(E!=0){var ke,ge,qe,ee;ke=H[q++]*$,ge=H[q++]*$,qe=0|ke,ee=0|ge,ke+=V.adj43[qe],ge+=V.adj43[ee],de[x++]=0|ke,de[x++]=0|ge}}function K(O,$,H,q,de){var x,E,ke=0,ge,Ee=0,Ve=0,qe=0,ee=$,Ae=0,Qe=ee,st=0,kt=O,Lt=0;for(ge=de!=null&&q.global_gain==de.global_gain,q.block_type==_.SHORT_TYPE?E=38:E=21,x=0;x<=E;x++){var Dt=-1;if((ge||q.block_type==_.NORM_TYPE)&&(Dt=q.global_gain-(q.scalefac[x]+(q.preflag!=0?V.pretab[x]:0)<<q.scalefac_scale+1)-q.subblock_gain[q.window[x]]*8),ge&&de.step[x]==Dt)Ee!=0&&($e(Ee,H,kt,Lt,Qe,st),Ee=0),Ve!=0&&n();else{var Ft=q.width[x];if(ke+q.width[x]>q.max_nonzero_coeff){var qt;qt=q.max_nonzero_coeff-ke+1,h.fill($,q.max_nonzero_coeff,576,0),Ft=qt,Ft<0&&(Ft=0),x=E+1}if(Ee==0&&Ve==0&&(Qe=ee,st=Ae,kt=O,Lt=qe),de!=null&&de.sfb_count1>0&&x>=de.sfb_count1&&de.step[x]>0&&Dt>=de.step[x]?(Ee!=0&&($e(Ee,H,kt,Lt,Qe,st),Ee=0,Qe=ee,st=Ae,kt=O,Lt=qe),Ve+=Ft):(Ve!=0&&(J(Ve,H,kt,Lt,Qe,st),Ve=0,Qe=ee,st=Ae,kt=O,Lt=qe),Ee+=Ft),Ft<=0){Ve!=0&&n(),Ee!=0&&n();break}}x<=E&&(Ae+=q.width[x],qe+=q.width[x],ke+=q.width[x])}Ee!=0&&($e(Ee,H,kt,Lt,Qe,st),Ee=0),Ve!=0&&n()}function ie(O,$,H){var q=0,de=0;do{var x=O[$++],E=O[$++];q<x&&(q=x),de<E&&(de=E)}while($<H);return q<de&&(q=de),q}function Oe(O,$,H,q,de,x){var E=M.ht[q].xlen*65536+M.ht[de].xlen,ke=0,ge;do{var Ee=O[$++],Ve=O[$++];Ee!=0&&(Ee>14&&(Ee=15,ke+=E),Ee*=16),Ve!=0&&(Ve>14&&(Ve=15,ke+=E),Ee+=Ve),ke+=M.largetbl[Ee]}while($<H);return ge=ke&65535,ke>>=16,ke>ge&&(ke=ge,q=de),x.bits+=ke,q}function he(O,$,H,q){var de=0,x=M.ht[1].hlen;do{var E=O[$+0]*2+O[$+1];$+=2,de+=x[E]}while($<H);return q.bits+=de,1}function Be(O,$,H,q,de){var x=0,E,ke=M.ht[q].xlen,ge;q==2?ge=M.table23:ge=M.table56;do{var Ee=O[$+0]*ke+O[$+1];$+=2,x+=ge[Ee]}while($<H);return E=x&65535,x>>=16,x>E&&(x=E,q++),de.bits+=x,q}function te(O,$,H,q,de){var x=0,E=0,ke=0,ge=M.ht[q].xlen,Ee=M.ht[q].hlen,Ve=M.ht[q+1].hlen,qe=M.ht[q+2].hlen;do{var ee=O[$+0]*ge+O[$+1];$+=2,x+=Ee[ee],E+=Ve[ee],ke+=qe[ee]}while($<H);var Ae=q;return x>E&&(x=E,Ae++),x>ke&&(x=ke,Ae=q+2),de.bits+=x,Ae}var Le=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function le(O,$,H,q){var de=ie(O,$,H);switch(de){case 0:return de;case 1:return he(O,$,H,q);case 2:case 3:return Be(O,$,H,Le[de-1],q);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return te(O,$,H,Le[de-1],q);default:de>Pe.IXMAX_VAL&&n(),de-=15;var x;for(x=24;x<32&&!(M.ht[x].linmax>=de);x++);var E;for(E=x-8;E<24&&!(M.ht[E].linmax>=de);E++);return Oe(O,$,H,E,x,q)}}this.noquant_count_bits=function(O,$,H){var q=$.l3_enc,de=Math.min(576,$.max_nonzero_coeff+2>>1<<1);for(H!=null&&(H.sfb_count1=0);de>1&&!(q[de-1]|q[de-2]);de-=2);$.count1=de;for(var x=0,E=0;de>3;de-=4){var ke;if(((q[de-1]|q[de-2]|q[de-3]|q[de-4])&2147483647)>1)break;ke=((q[de-4]*2+q[de-3])*2+q[de-2])*2+q[de-1],x+=M.t32l[ke],E+=M.t33l[ke]}var ge=x;if($.count1table_select=0,x>E&&(ge=E,$.count1table_select=1),$.count1bits=ge,$.big_values=de,de==0)return ge;if($.block_type==_.SHORT_TYPE)x=3*O.scalefac_band.s[3],x>$.big_values&&(x=$.big_values),E=$.big_values;else if($.block_type==_.NORM_TYPE){if(x=$.region0_count=O.bv_scf[de-2],E=$.region1_count=O.bv_scf[de-1],E=O.scalefac_band.l[x+E+2],x=O.scalefac_band.l[x+1],E<de){var Ee=new pe(ge);$.table_select[2]=le(q,E,de,Ee),ge=Ee.bits}}else $.region0_count=7,$.region1_count=_.SBMAX_l-1-7-1,x=O.scalefac_band.l[8],E=de,x>E&&(x=E);if(x=Math.min(x,de),E=Math.min(E,de),0<x){var Ee=new pe(ge);$.table_select[0]=le(q,0,x,Ee),ge=Ee.bits}if(x<E){var Ee=new pe(ge);$.table_select[1]=le(q,x,E,Ee),ge=Ee.bits}if(O.use_best_huffman==2&&n(),H!=null&&$.block_type==_.NORM_TYPE){for(var Ve=0;O.scalefac_band.l[Ve]<$.big_values;)Ve++;H.sfb_count1=Ve}return ge},this.count_bits=function(O,$,H,q){var de=H.l3_enc,x=Pe.IXMAX_VAL/V.IPOW20(H.global_gain);return H.xrpow_max>x?Pe.LARGE_BITS:(K($,de,V.IPOW20(H.global_gain),H,q),O.substep_shaping&2&&n(),this.noquant_count_bits(O,H,q))};function ae(O,$,H,q,de,x,E){for(var ke=$.big_values,ge=0;ge<=22;ge++)q[ge]=Pe.LARGE_BITS;for(var ge=0;ge<16;ge++){var Ee=O.scalefac_band.l[ge+1];if(Ee>=ke)break;var Ve=0,qe=new pe(Ve),ee=le(H,0,Ee,qe);Ve=qe.bits;for(var Ae=0;Ae<8;Ae++){var Qe=O.scalefac_band.l[ge+Ae+2];if(Qe>=ke)break;var st=Ve;qe=new pe(st);var kt=le(H,Ee,Qe,qe);st=qe.bits,q[ge+Ae]>st&&(q[ge+Ae]=st,de[ge+Ae]=ge,x[ge+Ae]=ee,E[ge+Ae]=kt)}}}function m(O,$,H,q,de,x,E,ke){for(var ge=$.big_values,Ee=2;Ee<_.SBMAX_l+1;Ee++){var Ve=O.scalefac_band.l[Ee];if(Ve>=ge)break;var qe=de[Ee-2]+$.count1bits;if(H.part2_3_length<=qe)break;var ee=new pe(qe),Ae=le(q,Ve,ge,ee);qe=ee.bits,!(H.part2_3_length<=qe)&&(H.assign($),H.part2_3_length=qe,H.region0_count=x[Ee-2],H.region1_count=Ee-2-x[Ee-2],H.table_select[0]=E[Ee-2],H.table_select[1]=ke[Ee-2],H.table_select[2]=Ae)}}this.best_huffman_divide=function(O,$){var H=new ve,q=$.l3_enc,de=o(23),x=o(23),E=o(23),ke=o(23);if(!($.block_type==_.SHORT_TYPE&&O.mode_gr==1)){H.assign($),$.block_type==_.NORM_TYPE&&(ae(O,$,q,de,x,E,ke),m(O,H,$,q,de,x,E,ke));var ge=H.big_values;if(!(ge==0||(q[ge-2]|q[ge-1])>1)&&(ge=$.count1+2,!(ge>576))){H.assign($),H.count1=ge;for(var Ee=0,Ve=0;ge>H.big_values;ge-=4){var qe=((q[ge-4]*2+q[ge-3])*2+q[ge-2])*2+q[ge-1];Ee+=M.t32l[qe],Ve+=M.t33l[qe]}if(H.big_values=ge,H.count1table_select=0,Ee>Ve&&(Ee=Ve,H.count1table_select=1),H.count1bits=Ee,H.block_type==_.NORM_TYPE)m(O,H,$,q,de,x,E,ke);else{if(H.part2_3_length=Ee,Ee=O.scalefac_band.l[8],Ee>ge&&(Ee=ge),Ee>0){var ee=new pe(H.part2_3_length);H.table_select[0]=le(q,0,Ee,ee),H.part2_3_length=ee.bits}if(ge>Ee){var ee=new pe(H.part2_3_length);H.table_select[1]=le(q,Ee,ge,ee),H.part2_3_length=ee.bits}$.part2_3_length>H.part2_3_length&&$.assign(H)}}}};var R=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],U=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],ne=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],z=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];T.slen1_tab=ne,T.slen2_tab=z;function I(O,$){for(var H,q=$.tt[1][O],de=$.tt[0][O],x=0;x<M.scfsi_band.length-1;x++){for(H=M.scfsi_band[x];H<M.scfsi_band[x+1]&&!(de.scalefac[H]!=q.scalefac[H]&&q.scalefac[H]>=0);H++);if(H==M.scfsi_band[x+1]){for(H=M.scfsi_band[x];H<M.scfsi_band[x+1];H++)q.scalefac[H]=-1;$.scfsi[O][x]=1}}var E=0,ke=0;for(H=0;H<11;H++)q.scalefac[H]!=-1&&(ke++,E<q.scalefac[H]&&(E=q.scalefac[H]));for(var ge=0,Ee=0;H<_.SBPSY_l;H++)q.scalefac[H]!=-1&&(Ee++,ge<q.scalefac[H]&&(ge=q.scalefac[H]));for(var x=0;x<16;x++)if(E<R[x]&&ge<U[x]){var Ve=ne[x]*ke+z[x]*Ee;q.part2_length>Ve&&(q.part2_length=Ve,q.scalefac_compress=x)}}this.best_scalefac_store=function(O,$,H,q){var de=q.tt[$][H],x,E,ke,ge,Ee=0;for(ke=0,x=0;x<de.sfbmax;x++){var Ve=de.width[x];for(ke+=Ve,ge=-Ve;ge<0&&de.l3_enc[ge+ke]==0;ge++);ge==0&&(de.scalefac[x]=Ee=-2)}if(de.scalefac_scale==0&&de.preflag==0){var qe=0;for(x=0;x<de.sfbmax;x++)de.scalefac[x]>0&&(qe|=de.scalefac[x]);if(!(qe&1)&&qe!=0){for(x=0;x<de.sfbmax;x++)de.scalefac[x]>0&&(de.scalefac[x]>>=1);de.scalefac_scale=Ee=1}}if(de.preflag==0&&de.block_type!=_.SHORT_TYPE&&O.mode_gr==2){for(x=11;x<_.SBPSY_l&&!(de.scalefac[x]<V.pretab[x]&&de.scalefac[x]!=-2);x++);if(x==_.SBPSY_l){for(x=11;x<_.SBPSY_l;x++)de.scalefac[x]>0&&(de.scalefac[x]-=V.pretab[x]);de.preflag=Ee=1}}for(E=0;E<4;E++)q.scfsi[H][E]=0;for(O.mode_gr==2&&$==1&&q.tt[0][H].block_type!=_.SHORT_TYPE&&q.tt[1][H].block_type!=_.SHORT_TYPE&&(I(H,q),Ee=0),x=0;x<de.sfbmax;x++)de.scalefac[x]==-2&&(de.scalefac[x]=0);Ee!=0&&(O.mode_gr==2?this.scale_bitcount(de):this.scale_bitcount_lsf(O,de))};var N=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],k=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],Q=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(O){var $,H,q=0,de=0,x,E=O.scalefac;if(O.block_type==_.SHORT_TYPE)x=N,O.mixed_block_flag!=0&&(x=k);else if(x=Q,O.preflag==0){for(H=11;H<_.SBPSY_l&&!(E[H]<V.pretab[H]);H++);if(H==_.SBPSY_l)for(O.preflag=1,H=11;H<_.SBPSY_l;H++)E[H]-=V.pretab[H]}for(H=0;H<O.sfbdivide;H++)q<E[H]&&(q=E[H]);for(;H<O.sfbmax;H++)de<E[H]&&(de=E[H]);for(O.part2_length=Pe.LARGE_BITS,$=0;$<16;$++)q<R[$]&&de<U[$]&&O.part2_length>x[$]&&(O.part2_length=x[$],O.scalefac_compress=$);return O.part2_length==Pe.LARGE_BITS};var w=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(O,$){var H,q,de,x,E,ke,ge,Ee,Ve=o(4),qe=$.scalefac;for($.preflag!=0?H=2:H=0,ge=0;ge<4;ge++)Ve[ge]=0;if($.block_type==_.SHORT_TYPE){q=1;var ee=V.nr_of_sfb_block[H][q];for(Ee=0,de=0;de<4;de++)for(x=ee[de]/3,ge=0;ge<x;ge++,Ee++)for(E=0;E<3;E++)qe[Ee*3+E]>Ve[de]&&(Ve[de]=qe[Ee*3+E])}else{q=0;var ee=V.nr_of_sfb_block[H][q];for(Ee=0,de=0;de<4;de++)for(x=ee[de],ge=0;ge<x;ge++,Ee++)qe[Ee]>Ve[de]&&(Ve[de]=qe[Ee])}for(ke=!1,de=0;de<4;de++)Ve[de]>w[H][de]&&(ke=!0);if(!ke){var Ae,Qe,st,kt;for($.sfb_partition_table=V.nr_of_sfb_block[H][q],de=0;de<4;de++)$.slen[de]=ye[Ve[de]];switch(Ae=$.slen[0],Qe=$.slen[1],st=$.slen[2],kt=$.slen[3],H){case 0:$.scalefac_compress=(Ae*5+Qe<<4)+(st<<2)+kt;break;case 1:$.scalefac_compress=400+(Ae*5+Qe<<2)+st;break;case 2:$.scalefac_compress=500+Ae*3+Qe;break}}if(!ke)for($.part2_length=0,de=0;de<4;de++)$.part2_length+=$.slen[de]*$.sfb_partition_table[de];return ke};var ye=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(O){for(var $=2;$<=576;$+=2){for(var H=0,q;O.scalefac_band.l[++H]<$;);for(q=me[H][0];O.scalefac_band.l[q+1]>$;)q--;for(q<0&&(q=me[H][0]),O.bv_scf[$-2]=q,q=me[H][1];O.scalefac_band.l[q+O.bv_scf[$-2]+2]>$;)q--;q<0&&(q=me[H][1]),O.bv_scf[$-1]=q}}}D.STEPS_per_dB=100,D.MAX_dB=120,D.GAIN_NOT_ENOUGH_SAMPLES=-24601,D.GAIN_ANALYSIS_ERROR=0,D.GAIN_ANALYSIS_OK=1,D.INIT_GAIN_ANALYSIS_ERROR=0,D.INIT_GAIN_ANALYSIS_OK=1,D.YULE_ORDER=10,D.MAX_ORDER=D.YULE_ORDER,D.MAX_SAMP_FREQ=48e3,D.RMS_WINDOW_TIME_NUMERATOR=1,D.RMS_WINDOW_TIME_DENOMINATOR=20,D.MAX_SAMPLES_PER_WINDOW=D.MAX_SAMP_FREQ*D.RMS_WINDOW_TIME_NUMERATOR/D.RMS_WINDOW_TIME_DENOMINATOR+1;function D(){}function P(){function V(K,ie,Oe,he,Be,te,Le,le,ae,m,R,U,ne,z){this.quant_comp=ie,this.quant_comp_s=Oe,this.safejoint=he,this.nsmsfix=Be,this.st_lrm=te,this.st_s=Le,this.nsbass=le,this.scale=ae,this.masking_adj=m,this.ath_lower=R,this.ath_curve=U,this.interch=ne,this.sfscale=z}var pe;this.setModules=function(K){pe=K};function me(K,ie,Oe){n()}var J=[new V(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new V(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new V(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new V(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new V(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new V(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new V(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new V(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new V(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new V(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new V(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new V(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new V(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new V(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new V(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new V(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new V(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function $e(K,ie,Oe){var he=ie,Be=pe.nearestBitrateFullIndex(ie);if(K.VBR=y.vbr_abr,K.VBR_mean_bitrate_kbps=he,K.VBR_mean_bitrate_kbps=Math.min(K.VBR_mean_bitrate_kbps,320),K.VBR_mean_bitrate_kbps=Math.max(K.VBR_mean_bitrate_kbps,8),K.brate=K.VBR_mean_bitrate_kbps,K.VBR_mean_bitrate_kbps>320&&(K.disable_reservoir=!0),J[Be].safejoint>0&&(K.exp_nspsytune=K.exp_nspsytune|2),J[Be].sfscale>0&&(K.internal_flags.noise_shaping=2),Math.abs(J[Be].nsbass)>0){var te=int(J[Be].nsbass*4);te<0&&(te+=64),K.exp_nspsytune=K.exp_nspsytune|te<<2}return Oe!=0?K.quant_comp=J[Be].quant_comp:Math.abs(K.quant_comp- -1)>0||(K.quant_comp=J[Be].quant_comp),Oe!=0?K.quant_comp_short=J[Be].quant_comp_s:Math.abs(K.quant_comp_short- -1)>0||(K.quant_comp_short=J[Be].quant_comp_s),Oe!=0?K.msfix=J[Be].nsmsfix:Math.abs(K.msfix- -1)>0||(K.msfix=J[Be].nsmsfix),Oe!=0?K.internal_flags.nsPsy.attackthre=J[Be].st_lrm:Math.abs(K.internal_flags.nsPsy.attackthre- -1)>0||(K.internal_flags.nsPsy.attackthre=J[Be].st_lrm),Oe!=0?K.internal_flags.nsPsy.attackthre_s=J[Be].st_s:Math.abs(K.internal_flags.nsPsy.attackthre_s- -1)>0||(K.internal_flags.nsPsy.attackthre_s=J[Be].st_s),Oe!=0?K.scale=J[Be].scale:Math.abs(K.scale- -1)>0||(K.scale=J[Be].scale),Oe!=0?K.maskingadjust=J[Be].masking_adj:Math.abs(K.maskingadjust-0)>0||(K.maskingadjust=J[Be].masking_adj),J[Be].masking_adj>0?Oe!=0?K.maskingadjust_short=J[Be].masking_adj*.9:Math.abs(K.maskingadjust_short-0)>0||(K.maskingadjust_short=J[Be].masking_adj*.9):Oe!=0?K.maskingadjust_short=J[Be].masking_adj*1.1:Math.abs(K.maskingadjust_short-0)>0||(K.maskingadjust_short=J[Be].masking_adj*1.1),Oe!=0?K.ATHlower=-J[Be].ath_lower/10:Math.abs(-K.ATHlower*10-0)>0||(K.ATHlower=-J[Be].ath_lower/10),Oe!=0?K.ATHcurve=J[Be].ath_curve:Math.abs(K.ATHcurve- -1)>0||(K.ATHcurve=J[Be].ath_curve),Oe!=0?K.interChRatio=J[Be].interch:Math.abs(K.interChRatio- -1)>0||(K.interChRatio=J[Be].interch),ie}this.apply_preset=function(K,ie,Oe){switch(ie){case Fe.R3MIX:{ie=Fe.V3,K.VBR=y.vbr_mtrh;break}case Fe.MEDIUM:{ie=Fe.V4,K.VBR=y.vbr_rh;break}case Fe.MEDIUM_FAST:{ie=Fe.V4,K.VBR=y.vbr_mtrh;break}case Fe.STANDARD:{ie=Fe.V2,K.VBR=y.vbr_rh;break}case Fe.STANDARD_FAST:{ie=Fe.V2,K.VBR=y.vbr_mtrh;break}case Fe.EXTREME:{ie=Fe.V0,K.VBR=y.vbr_rh;break}case Fe.EXTREME_FAST:{ie=Fe.V0,K.VBR=y.vbr_mtrh;break}case Fe.INSANE:return ie=320,K.preset=ie,$e(K,ie,Oe),K.VBR=y.vbr_off,ie}switch(K.preset=ie,ie){case Fe.V9:return me(),ie;case Fe.V8:return me(),ie;case Fe.V7:return me(),ie;case Fe.V6:return me(),ie;case Fe.V5:return me(),ie;case Fe.V4:return me(),ie;case Fe.V3:return me(),ie;case Fe.V2:return me(),ie;case Fe.V1:return me(),ie;case Fe.V0:return me(),ie}return 8<=ie&&ie<=320?$e(K,ie,Oe):(K.preset=0,ie)}}function G(){var V;this.setModules=function(pe){V=pe},this.ResvFrameBegin=function(pe,me){var J=pe.internal_flags,$e,K=J.l3_side,ie=V.getframebits(pe);me.bits=(ie-J.sideinfo_len*8)/J.mode_gr;var Oe=8*256*J.mode_gr-8;pe.brate>320?n():($e=8*1440,pe.strict_ISO&&n()),J.ResvMax=$e-ie,J.ResvMax>Oe&&(J.ResvMax=Oe),(J.ResvMax<0||pe.disable_reservoir)&&(J.ResvMax=0);var he=me.bits*J.mode_gr+Math.min(J.ResvSize,J.ResvMax);return he>$e&&(he=$e),K.resvDrain_pre=0,J.pinfo!=null&&n(),he},this.ResvMaxBits=function(pe,me,J,$e){var K=pe.internal_flags,ie,Oe=K.ResvSize,he=K.ResvMax;$e!=0&&(Oe+=me),K.substep_shaping&1&&(he*=.9),J.bits=me,Oe*10>he*9?(ie=Oe-he*9/10,J.bits+=ie,K.substep_shaping|=128):(ie=0,K.substep_shaping&=127,!pe.disable_reservoir&&!(K.substep_shaping&1)&&(J.bits-=.1*me));var Be=Oe<K.ResvMax*6/10?Oe:K.ResvMax*6/10;return Be-=ie,Be<0&&(Be=0),Be},this.ResvAdjust=function(pe,me){pe.ResvSize-=me.part2_3_length+me.part2_length},this.ResvFrameEnd=function(pe,me){var J,$e=pe.l3_side;pe.ResvSize+=me*pe.mode_gr;var K=0;$e.resvDrain_post=0,$e.resvDrain_pre=0,(J=pe.ResvSize%8)!=0&&(K+=J),J=pe.ResvSize-K-pe.ResvMax,J>0&&(K+=J);{var ie=Math.min($e.main_data_begin*8,K)/8;$e.resvDrain_pre+=8*ie,K-=8*ie,pe.ResvSize-=8*ie,$e.main_data_begin-=ie}$e.resvDrain_post+=K,pe.ResvSize-=K}}W.NUMTOCENTRIES=100,W.MAXFRAMESIZE=2880;function W(){this.setModules=function(me,J,$e){};var V=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function pe(me,J){var $e=J^me;return J=J>>8^V[$e&255],J}this.updateMusicCRC=function(me,J,$e,K){for(var ie=0;ie<K;++ie)me[0]=pe(J[$e+ie],me[0])}}L.EQ=function(V,pe){return Math.abs(V)>Math.abs(pe)?Math.abs(V-pe)<=Math.abs(V)*1e-6:Math.abs(V-pe)<=Math.abs(pe)*1e-6},L.NEQ=function(V,pe){return!L.EQ(V,pe)};function L(){var V=this,pe=null,me=null;this.setModules=function(I,N,k,Q){pe=k,me=Q};var J=null,$e=0,K=0,ie=0;this.getframebits=function(I){var N=I.internal_flags,k;N.bitrate_index!=0?k=M.bitrate_table[I.version][N.bitrate_index]:k=I.brate;var Q=0|(I.version+1)*72e3*k/I.out_samplerate+N.padding;return 8*Q};function Oe(I){v.arraycopy(I.header[I.w_ptr].buf,0,J,K,I.sideinfo_len),K+=I.sideinfo_len,$e+=I.sideinfo_len*8,I.w_ptr=I.w_ptr+1&He.MAX_HEADER_BUF-1}function he(I,N,k){for(;k>0;){var Q;ie==0&&(ie=8,K++,I.header[I.w_ptr].write_timing==$e&&Oe(I),J[K]=0),Q=Math.min(k,ie),k-=Q,ie-=Q,J[K]|=N>>k<<ie,$e+=Q}}function Be(I,N){var k=I.internal_flags,Q;if(N>=8&&(he(k,76,8),N-=8),N>=8&&(he(k,65,8),N-=8),N>=8&&(he(k,77,8),N-=8),N>=8&&(he(k,69,8),N-=8),N>=32){var w=pe.getLameShortVersion();if(N>=32)for(Q=0;Q<w.length&&N>=8;++Q)N-=8,he(k,w.charCodeAt(Q),8)}for(;N>=1;N-=1)he(k,k.ancillary_flag,1),k.ancillary_flag^=I.disable_reservoir?0:1}function te(I,N,k){for(var Q=I.header[I.h_ptr].ptr;k>0;){var w=Math.min(k,8-(Q&7));k-=w,I.header[I.h_ptr].buf[Q>>3]|=N>>k<<8-(Q&7)-w,Q+=w}I.header[I.h_ptr].ptr=Q}function Le(I,N){var k=I.internal_flags,Q,w,ye;if(Q=k.l3_side,k.header[k.h_ptr].ptr=0,h.fill(k.header[k.h_ptr].buf,0,k.sideinfo_len,0),I.out_samplerate<16e3?te(k,4094,12):te(k,4095,12),te(k,I.version,1),te(k,1,2),te(k,I.error_protection?0:1,1),te(k,k.bitrate_index,4),te(k,k.samplerate_index,2),te(k,k.padding,1),te(k,I.extension,1),te(k,I.mode.ordinal(),2),te(k,k.mode_ext,2),te(k,I.copyright,1),te(k,I.original,1),te(k,I.emphasis,2),I.error_protection&&te(k,0,16),I.version==1){for(te(k,Q.main_data_begin,9),k.channels_out==2?te(k,Q.private_bits,3):te(k,Q.private_bits,5),ye=0;ye<k.channels_out;ye++){var O;for(O=0;O<4;O++)te(k,Q.scfsi[ye][O],1)}for(w=0;w<2;w++)for(ye=0;ye<k.channels_out;ye++){var $=Q.tt[w][ye];te(k,$.part2_3_length+$.part2_length,12),te(k,$.big_values/2,9),te(k,$.global_gain,8),te(k,$.scalefac_compress,4),$.block_type!=_.NORM_TYPE?(te(k,1,1),te(k,$.block_type,2),te(k,$.mixed_block_flag,1),$.table_select[0]==14&&($.table_select[0]=16),te(k,$.table_select[0],5),$.table_select[1]==14&&($.table_select[1]=16),te(k,$.table_select[1],5),te(k,$.subblock_gain[0],3),te(k,$.subblock_gain[1],3),te(k,$.subblock_gain[2],3)):(te(k,0,1),$.table_select[0]==14&&($.table_select[0]=16),te(k,$.table_select[0],5),$.table_select[1]==14&&($.table_select[1]=16),te(k,$.table_select[1],5),$.table_select[2]==14&&($.table_select[2]=16),te(k,$.table_select[2],5),te(k,$.region0_count,4),te(k,$.region1_count,3)),te(k,$.preflag,1),te(k,$.scalefac_scale,1),te(k,$.count1table_select,1)}}else for(te(k,Q.main_data_begin,8),te(k,Q.private_bits,k.channels_out),w=0,ye=0;ye<k.channels_out;ye++){var $=Q.tt[w][ye];te(k,$.part2_3_length+$.part2_length,12),te(k,$.big_values/2,9),te(k,$.global_gain,8),te(k,$.scalefac_compress,9),$.block_type!=_.NORM_TYPE?(te(k,1,1),te(k,$.block_type,2),te(k,$.mixed_block_flag,1),$.table_select[0]==14&&($.table_select[0]=16),te(k,$.table_select[0],5),$.table_select[1]==14&&($.table_select[1]=16),te(k,$.table_select[1],5),te(k,$.subblock_gain[0],3),te(k,$.subblock_gain[1],3),te(k,$.subblock_gain[2],3)):(te(k,0,1),$.table_select[0]==14&&($.table_select[0]=16),te(k,$.table_select[0],5),$.table_select[1]==14&&($.table_select[1]=16),te(k,$.table_select[1],5),$.table_select[2]==14&&($.table_select[2]=16),te(k,$.table_select[2],5),te(k,$.region0_count,4),te(k,$.region1_count,3)),te(k,$.scalefac_scale,1),te(k,$.count1table_select,1)}I.error_protection&&n();{var H=k.h_ptr;k.h_ptr=H+1&He.MAX_HEADER_BUF-1,k.header[k.h_ptr].write_timing=k.header[H].write_timing+N,k.h_ptr==k.w_ptr}}function le(I,N){var k=M.ht[N.count1table_select+32],Q,w=0,ye=N.big_values,O=N.big_values;for(Q=(N.count1-N.big_values)/4;Q>0;--Q){var $=0,H=0,q;q=N.l3_enc[ye+0],q!=0&&(H+=8,N.xr[O+0]<0&&$++),q=N.l3_enc[ye+1],q!=0&&(H+=4,$*=2,N.xr[O+1]<0&&$++),q=N.l3_enc[ye+2],q!=0&&(H+=2,$*=2,N.xr[O+2]<0&&$++),q=N.l3_enc[ye+3],q!=0&&(H++,$*=2,N.xr[O+3]<0&&$++),ye+=4,O+=4,he(I,$+k.table[H],k.hlen[H]),w+=k.hlen[H]}return w}function ae(I,N,k,Q,w){var ye=M.ht[N],O=0;if(N==0)return O;for(var $=k;$<Q;$+=2){var H=0,q=0,de=ye.xlen,x=ye.xlen,E=0,ke=w.l3_enc[$],ge=w.l3_enc[$+1];if(ke!=0&&(w.xr[$]<0&&E++,H--),N>15){if(ke>14){var Ee=ke-15;E|=Ee<<1,q=de,ke=15}if(ge>14){var Ve=ge-15;E<<=de,E|=Ve,q+=de,ge=15}x=16}ge!=0&&(E<<=1,w.xr[$+1]<0&&E++,H--),ke=ke*x+ge,q-=H,H+=ye.hlen[ke],he(I,ye.table[ke],H),he(I,E,q),O+=H+q}return O}function m(I,N){var k=3*I.scalefac_band.s[3];k>N.big_values&&(k=N.big_values);var Q=ae(I,N.table_select[0],0,k,N);return Q+=ae(I,N.table_select[1],k,N.big_values,N),Q}function R(I,N){var k,Q,w,ye;k=N.big_values;var O=N.region0_count+1;return w=I.scalefac_band.l[O],O+=N.region1_count+1,ye=I.scalefac_band.l[O],w>k&&(w=k),ye>k&&(ye=k),Q=ae(I,N.table_select[0],0,w,N),Q+=ae(I,N.table_select[1],w,ye,N),Q+=ae(I,N.table_select[2],ye,k,N),Q}function U(I){var N,k,Q,w,ye=0,O=I.internal_flags,$=O.l3_side;if(I.version==1)for(N=0;N<2;N++)for(k=0;k<O.channels_out;k++){var H=$.tt[N][k],q=T.slen1_tab[H.scalefac_compress],de=T.slen2_tab[H.scalefac_compress];for(w=0,Q=0;Q<H.sfbdivide;Q++)H.scalefac[Q]!=-1&&(he(O,H.scalefac[Q],q),w+=q);for(;Q<H.sfbmax;Q++)H.scalefac[Q]!=-1&&(he(O,H.scalefac[Q],de),w+=de);H.block_type==_.SHORT_TYPE?w+=m(O,H):w+=R(O,H),w+=le(O,H),ye+=w}else for(N=0,k=0;k<O.channels_out;k++){var H=$.tt[N][k],x,E,ke=0;if(w=0,Q=0,E=0,H.block_type==_.SHORT_TYPE){for(;E<4;E++){var ge=H.sfb_partition_table[E]/3,Ee=H.slen[E];for(x=0;x<ge;x++,Q++)he(O,Math.max(H.scalefac[Q*3+0],0),Ee),he(O,Math.max(H.scalefac[Q*3+1],0),Ee),he(O,Math.max(H.scalefac[Q*3+2],0),Ee),ke+=3*Ee}w+=m(O,H)}else{for(;E<4;E++){var ge=H.sfb_partition_table[E],Ee=H.slen[E];for(x=0;x<ge;x++,Q++)he(O,Math.max(H.scalefac[Q],0),Ee),ke+=Ee}w+=R(O,H)}w+=le(O,H),ye+=ke+w}return ye}function ne(){this.total=0}function z(I,N){var k=I.internal_flags,Q,w,ye;return k.w_ptr,ye=k.h_ptr-1,ye==-1&&(ye=He.MAX_HEADER_BUF-1),Q=k.header[ye].write_timing-$e,N.total=Q,Q>=0&&n(),w=V.getframebits(I),Q+=w,N.total+=w,N.total%8!=0?N.total=1+N.total/8:N.total=N.total/8,N.total+=K+1,Q}this.flush_bitstream=function(I){var N=I.internal_flags,k,Q;N.h_ptr-1,k=N.l3_side,!((Q=z(I,new ne))<0)&&(Be(I,Q),N.ResvSize=0,k.main_data_begin=0,N.findReplayGain&&n(),N.findPeakSample&&n())},this.format_bitstream=function(I){var N=I.internal_flags,k;k=N.l3_side;var Q=this.getframebits(I);Be(I,k.resvDrain_pre),Le(I,Q);var w=8*N.sideinfo_len;if(w+=U(I),Be(I,k.resvDrain_post),w+=k.resvDrain_post,k.main_data_begin+=(Q-w)/8,z(I,new ne)!=N.ResvSize,k.main_data_begin*8!=N.ResvSize&&(N.ResvSize=k.main_data_begin*8),$e>1e9){var ye;for(ye=0;ye<He.MAX_HEADER_BUF;++ye)N.header[ye].write_timing-=$e;$e=0}return 0},this.copy_buffer=function(I,N,k,Q,w){var ye=K+1;if(ye<=0)return 0;if(Q!=0&&ye>Q)return-1;if(v.arraycopy(J,0,N,k,ye),K=-1,ie=0,w!=0){var O=o(1);O[0]=I.nMusicCRC,me.updateMusicCRC(O,N,k,ye),I.nMusicCRC=O[0],ye>0&&(I.VBR_seek_table.nBytesWritten+=ye),I.decode_on_the_fly&&n()}return ye},this.init_bit_stream_w=function(I){J=a(Fe.LAME_MAXMP3BUFFER),I.h_ptr=I.w_ptr=0,I.header[I.h_ptr].write_timing=0,K=-1,ie=0,$e=0}}function X(V,pe,me,J){this.xlen=V,this.linmax=pe,this.table=me,this.hlen=J}var M={};M.t1HB=[1,1,1,0],M.t2HB=[1,2,1,3,1,1,3,2,0],M.t3HB=[3,2,1,1,1,1,3,2,0],M.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],M.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],M.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],M.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],M.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],M.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],M.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],M.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],M.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],M.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],M.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],M.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],M.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],M.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],M.t1l=[1,4,3,5],M.t2l=[1,4,7,4,5,7,6,7,8],M.t3l=[2,3,7,4,4,7,6,7,8],M.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],M.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],M.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],M.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],M.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],M.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],M.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],M.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],M.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],M.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],M.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],M.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],M.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],M.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],M.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],M.ht=[new X(0,0,null,null),new X(2,0,M.t1HB,M.t1l),new X(3,0,M.t2HB,M.t2l),new X(3,0,M.t3HB,M.t3l),new X(0,0,null,null),new X(4,0,M.t5HB,M.t5l),new X(4,0,M.t6HB,M.t6l),new X(6,0,M.t7HB,M.t7l),new X(6,0,M.t8HB,M.t8l),new X(6,0,M.t9HB,M.t9l),new X(8,0,M.t10HB,M.t10l),new X(8,0,M.t11HB,M.t11l),new X(8,0,M.t12HB,M.t12l),new X(16,0,M.t13HB,M.t13l),new X(0,0,null,M.t16_5l),new X(16,0,M.t15HB,M.t15l),new X(1,1,M.t16HB,M.t16l),new X(2,3,M.t16HB,M.t16l),new X(3,7,M.t16HB,M.t16l),new X(4,15,M.t16HB,M.t16l),new X(6,63,M.t16HB,M.t16l),new X(8,255,M.t16HB,M.t16l),new X(10,1023,M.t16HB,M.t16l),new X(13,8191,M.t16HB,M.t16l),new X(4,15,M.t24HB,M.t24l),new X(5,31,M.t24HB,M.t24l),new X(6,63,M.t24HB,M.t24l),new X(7,127,M.t24HB,M.t24l),new X(8,255,M.t24HB,M.t24l),new X(9,511,M.t24HB,M.t24l),new X(11,2047,M.t24HB,M.t24l),new X(13,8191,M.t24HB,M.t24l),new X(0,0,M.t32HB,M.t32l),new X(0,0,M.t33HB,M.t33l)],M.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],M.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],M.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],M.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],M.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],M.scfsi_band=[0,6,11,16,21];function oe(V){this.bits=V}function re(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function be(){this.setModules=function(V,pe){}}function ze(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=s(_.SBMAX_l),this.s=s(_.SBMAX_s),this.psfb21=s(_.PSFB21),this.psfb12=s(_.PSFB12),this.cb_l=s(_.CBANDS),this.cb_s=s(_.CBANDS),this.eql_w=s(_.BLKSIZE/2)}function Ue(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=S.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function Ge(V){var pe=V;this.quantize=pe,this.iteration_loop=function(me,J,$e,K){var ie=me.internal_flags,Oe=s(j.SFBMAX),he=s(576),Be=o(2),te=0,Le=ie.l3_side,le=new oe(te);this.quantize.rv.ResvFrameBegin(me,le),te=le.bits;for(var ae=0;ae<ie.mode_gr;ae++){this.quantize.qupvt.on_pe(me,J,Be,te,ae,ae),ie.mode_ext==_.MPG_MD_MS_LR&&n();for(var m=0;m<ie.channels_out;m++){var R,U,ne=Le.tt[ae][m];ne.block_type!=_.SHORT_TYPE?(R=0,U=ie.PSY.mask_adjust-R):(R=0,U=ie.PSY.mask_adjust_short-R),ie.masking_lower=Math.pow(10,U*.1),this.quantize.init_outer_loop(ie,ne),this.quantize.init_xrpow(ie,ne,he)&&(this.quantize.qupvt.calc_xmin(me,K[ae][m],ne,Oe),this.quantize.outer_loop(me,ne,Oe,he,m,Be[m])),this.quantize.iteration_finish_one(ie,ae,m)}}this.quantize.rv.ResvFrameEnd(ie,te)}}function Ne(){}function Me(V,pe,me,J){this.l=o(1+_.SBMAX_l),this.s=o(1+_.SBMAX_s),this.psfb21=o(1+_.PSFB21),this.psfb12=o(1+_.PSFB12);var $e=this.l,K=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],v.arraycopy(this.arrL,0,$e,0,Math.min(this.arrL.length,this.l.length)),v.arraycopy(this.arrS,0,K,0,Math.min(this.arrS.length,this.s.length)),v.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),v.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}Pe.Q_MAX=257,Pe.Q_MAX2=116,Pe.LARGE_BITS=1e5,Pe.IXMAX_VAL=8206;function Pe(){var V=null,pe=null,me=null;this.setModules=function(z,I,N){V=z,pe=I,me=N};function J(z){return Le[z+Pe.Q_MAX2]}this.IPOW20=function(z){return le[z]};var $e=2220446049250313e-31,K=Pe.IXMAX_VAL,ie=K+2,Oe=Pe.Q_MAX,he=Pe.Q_MAX2,Be=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var te=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=te,this.sfBandIndex=[new Me([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Me([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Me([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Me([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Me([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Me([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Me([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Me([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Me([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var Le=s(Oe+he+1),le=s(Oe),ae=s(ie),m=s(ie);this.adj43=m;function R(z,I){var N=me.ATHformula(I,z);return N-=Be,N=Math.pow(10,N/10+z.ATHlower),N}function U(z){for(var I=z.internal_flags.ATH.l,N=z.internal_flags.ATH.psfb21,k=z.internal_flags.ATH.s,Q=z.internal_flags.ATH.psfb12,w=z.internal_flags,ye=z.out_samplerate,O=0;O<_.SBMAX_l;O++){var $=w.scalefac_band.l[O],H=w.scalefac_band.l[O+1];I[O]=b.MAX_VALUE;for(var q=$;q<H;q++){var de=q*ye/1152,x=R(z,de);I[O]=Math.min(I[O],x)}}for(var O=0;O<_.PSFB21;O++){var $=w.scalefac_band.psfb21[O],H=w.scalefac_band.psfb21[O+1];N[O]=b.MAX_VALUE;for(var q=$;q<H;q++){var de=q*ye/1152,x=R(z,de);N[O]=Math.min(N[O],x)}}for(var O=0;O<_.SBMAX_s;O++){var $=w.scalefac_band.s[O],H=w.scalefac_band.s[O+1];k[O]=b.MAX_VALUE;for(var q=$;q<H;q++){var de=q*ye/384,x=R(z,de);k[O]=Math.min(k[O],x)}k[O]*=w.scalefac_band.s[O+1]-w.scalefac_band.s[O]}for(var O=0;O<_.PSFB12;O++){var $=w.scalefac_band.psfb12[O],H=w.scalefac_band.psfb12[O+1];Q[O]=b.MAX_VALUE;for(var q=$;q<H;q++){var de=q*ye/384,x=R(z,de);Q[O]=Math.min(Q[O],x)}Q[O]*=w.scalefac_band.s[13]-w.scalefac_band.s[12]}z.noATH&&n(),w.ATH.floor=10*r(R(z,-1))}this.iteration_init=function(z){var I=z.internal_flags,N=I.l3_side,k;if(I.iteration_init_init==0){for(I.iteration_init_init=1,N.main_data_begin=0,U(z),ae[0]=0,k=1;k<ie;k++)ae[k]=Math.pow(k,4/3);for(k=0;k<ie-1;k++)m[k]=k+1-Math.pow(.5*(ae[k]+ae[k+1]),.75);for(m[k]=.5,k=0;k<Oe;k++)le[k]=Math.pow(2,(k-210)*-.1875);for(k=0;k<=Oe+he;k++)Le[k]=Math.pow(2,(k-210-he)*.25);V.huffman_init(I);{var Q,w,ye,O;for(k=z.exp_nspsytune>>2&63,k>=32&&(k-=64),Q=Math.pow(10,k/4/10),k=z.exp_nspsytune>>8&63,k>=32&&(k-=64),w=Math.pow(10,k/4/10),k=z.exp_nspsytune>>14&63,k>=32&&(k-=64),ye=Math.pow(10,k/4/10),k=z.exp_nspsytune>>20&63,k>=32&&(k-=64),O=ye*Math.pow(10,k/4/10),k=0;k<_.SBMAX_l;k++){var $;k<=6?$=Q:k<=13?$=w:k<=20?$=ye:$=O,I.nsPsy.longfact[k]=$}for(k=0;k<_.SBMAX_s;k++){var $;k<=5?$=Q:k<=10?$=w:k<=11?$=ye:$=O,I.nsPsy.shortfact[k]=$}}}},this.on_pe=function(z,I,N,k,Q,w){var ye=z.internal_flags,O=0,$,H=o(2),q,de=new oe(O),x=pe.ResvMaxBits(z,k,de,w);O=de.bits;var E=O+x;for(E>He.MAX_BITS_PER_GRANULE&&(E=He.MAX_BITS_PER_GRANULE),$=0,q=0;q<ye.channels_out;++q)N[q]=Math.min(He.MAX_BITS_PER_CHANNEL,O/ye.channels_out),H[q]=0|N[q]*I[Q][q]/700-N[q],H[q]>k*3/4&&(H[q]=k*3/4),H[q]<0&&(H[q]=0),H[q]+N[q]>He.MAX_BITS_PER_CHANNEL&&(H[q]=Math.max(0,He.MAX_BITS_PER_CHANNEL-N[q])),$+=H[q];if($>x)for(q=0;q<ye.channels_out;++q)H[q]=x*H[q]/$;for(q=0;q<ye.channels_out;++q)N[q]+=H[q],x-=H[q];for($=0,q=0;q<ye.channels_out;++q)$+=N[q];return $>He.MAX_BITS_PER_GRANULE&&n(),E},this.athAdjust=function(z,I,N){var k=90.30873362,Q=94.82444863,w=p.FAST_LOG10_X(I,10),ye=z*z,O=0;return w-=N,ye>1e-20&&(O=1+p.FAST_LOG10_X(ye,10/k)),O<0&&(O=0),w*=O,w+=N+k-Q,Math.pow(10,.1*w)},this.calc_xmin=function(z,I,N,k){var Q=0,w=z.internal_flags,ye,O=0,$=0,H=w.ATH,q=N.xr,de=z.VBR==y.vbr_mtrh?1:0,x=w.masking_lower;for((z.VBR==y.vbr_mtrh||z.VBR==y.vbr_mt)&&(x=1),ye=0;ye<N.psy_lmax;ye++){var E,ke,ge,Ee,Ve,qe;z.VBR==y.vbr_rh||z.VBR==y.vbr_mtrh?ke=athAdjust(H.adjust,H.l[ye],H.floor):ke=H.adjust*H.l[ye],Ve=N.width[ye],ge=ke/Ve,Ee=$e,qe=Ve>>1,E=0;do{var ee,Ae;ee=q[O]*q[O],E+=ee,Ee+=ee<ge?ee:ge,O++,Ae=q[O]*q[O],E+=Ae,Ee+=Ae<ge?Ae:ge,O++}while(--qe>0);if(E>ke&&$++,ye==_.SBPSY_l&&n(),de!=0&&(ke=Ee),!z.ATHonly){var Qe=I.en.l[ye];if(Qe>0){var st;st=E*I.thm.l[ye]*x/Qe,de!=0&&(st*=w.nsPsy.longfact[ye]),ke<st&&(ke=st)}}de!=0?k[Q++]=ke:k[Q++]=ke*w.nsPsy.longfact[ye]}var kt=575;if(N.block_type!=_.SHORT_TYPE)for(var Lt=576;Lt--!=0&&L.EQ(q[Lt],0);)kt=Lt;N.max_nonzero_coeff=kt;for(var Dt=N.sfb_smin;ye<N.psymax;Dt++,ye+=3){var Ve,Ft,qt;for(z.VBR==y.vbr_rh||z.VBR==y.vbr_mtrh?qt=athAdjust(H.adjust,H.s[Dt],H.floor):qt=H.adjust*H.s[Dt],Ve=N.width[ye],Ft=0;Ft<3;Ft++){var E=0,ke,ge,Ee,qe=Ve>>1;ge=qt/Ve,Ee=$e;do{var ee,Ae;ee=q[O]*q[O],E+=ee,Ee+=ee<ge?ee:ge,O++,Ae=q[O]*q[O],E+=Ae,Ee+=Ae<ge?Ae:ge,O++}while(--qe>0);if(E>qt&&$++,Dt==_.SBPSY_s&&n(),de!=0?ke=Ee:ke=qt,!z.ATHonly&&!z.ATHshort){var Qe=I.en.s[Dt][Ft];if(Qe>0){var st;st=E*I.thm.s[Dt][Ft]*x/Qe,de!=0&&(st*=w.nsPsy.shortfact[Dt]),ke<st&&(ke=st)}}de!=0?k[Q++]=ke:k[Q++]=ke*w.nsPsy.shortfact[Dt]}z.useTemporal&&(k[Q-3]>k[Q-3+1]&&(k[Q-3+1]+=(k[Q-3]-k[Q-3+1])*w.decay),k[Q-3+1]>k[Q-3+2]&&(k[Q-3+2]+=(k[Q-3+1]-k[Q-3+2])*w.decay))}return $};function ne(z){this.s=z}this.calc_noise_core=function(z,I,N,k){var Q=0,w=I.s,ye=z.l3_enc;if(w>z.count1)for(;N--!=0;){var O;O=z.xr[w],w++,Q+=O*O,O=z.xr[w],w++,Q+=O*O}else if(w>z.big_values){var $=s(2);for($[0]=0,$[1]=k;N--!=0;){var O;O=Math.abs(z.xr[w])-$[ye[w]],w++,Q+=O*O,O=Math.abs(z.xr[w])-$[ye[w]],w++,Q+=O*O}}else for(;N--!=0;){var O;O=Math.abs(z.xr[w])-ae[ye[w]]*k,w++,Q+=O*O,O=Math.abs(z.xr[w])-ae[ye[w]]*k,w++,Q+=O*O}return I.s=w,Q},this.calc_noise=function(z,I,N,k,Q){var w=0,ye=0,O,$,H=0,q=0,de=0,x=-20,E=0,ke=z.scalefac,ge=0;for(k.over_SSD=0,O=0;O<z.psymax;O++){var Ee=z.global_gain-(ke[ge++]+(z.preflag!=0?te[O]:0)<<z.scalefac_scale+1)-z.subblock_gain[z.window[O]]*8,Ve=0;if(Q!=null&&Q.step[O]==Ee)Ve=Q.noise[O],E+=z.width[O],N[w++]=Ve/I[ye++],Ve=Q.noise_log[O];else{var qe=J(Ee);if($=z.width[O]>>1,E+z.width[O]>z.max_nonzero_coeff){var ee;ee=z.max_nonzero_coeff-E+1,ee>0?$=ee>>1:$=0}var Ae=new ne(E);Ve=this.calc_noise_core(z,Ae,$,qe),E=Ae.s,Q!=null&&(Q.step[O]=Ee,Q.noise[O]=Ve),Ve=N[w++]=Ve/I[ye++],Ve=p.FAST_LOG10(Math.max(Ve,1e-20)),Q!=null&&(Q.noise_log[O]=Ve)}if(Q!=null&&(Q.global_gain=z.global_gain),de+=Ve,Ve>0){var Qe;Qe=Math.max(0|Ve*10+.5,1),k.over_SSD+=Qe*Qe,H++,q+=Ve}x=Math.max(x,Ve)}return k.over_count=H,k.tot_noise=de,k.over_noise=q,k.max_noise=x,H}}function Se(){this.global_gain=0,this.sfb_count1=0,this.step=o(39),this.noise=s(39),this.noise_log=s(39)}function ve(){this.xr=s(576),this.l3_enc=o(576),this.scalefac=o(j.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=o(3),this.subblock_gain=o(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=o(j.SFBMAX),this.window=o(j.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=o(4),this.max_nonzero_coeff=0;var V=this;function pe(J){return new Int32Array(J)}function me(J){return new Float32Array(J)}this.assign=function(J){V.xr=me(J.xr),V.l3_enc=pe(J.l3_enc),V.scalefac=pe(J.scalefac),V.xrpow_max=J.xrpow_max,V.part2_3_length=J.part2_3_length,V.big_values=J.big_values,V.count1=J.count1,V.global_gain=J.global_gain,V.scalefac_compress=J.scalefac_compress,V.block_type=J.block_type,V.mixed_block_flag=J.mixed_block_flag,V.table_select=pe(J.table_select),V.subblock_gain=pe(J.subblock_gain),V.region0_count=J.region0_count,V.region1_count=J.region1_count,V.preflag=J.preflag,V.scalefac_scale=J.scalefac_scale,V.count1table_select=J.count1table_select,V.part2_length=J.part2_length,V.sfb_lmax=J.sfb_lmax,V.sfb_smin=J.sfb_smin,V.psy_lmax=J.psy_lmax,V.sfbmax=J.sfbmax,V.psymax=J.psymax,V.sfbdivide=J.sfbdivide,V.width=pe(J.width),V.window=pe(J.window),V.count1bits=J.count1bits,V.sfb_partition_table=J.sfb_partition_table.slice(0),V.slen=pe(J.slen),V.max_nonzero_coeff=J.max_nonzero_coeff}}var j={};j.SFBMAX=_.SBMAX_s*3;function we(){this.rv=null;var V;this.qupvt=null;var pe,me=new be,J;this.setModules=function(m,R,U,ne){V=R,this.rv=R,pe=U,this.qupvt=U,J=ne,me.setModules(pe,J)};function $e(m,R,U,ne){ne=0;for(var z=0;z<=U;++z){var I=Math.abs(m.xr[z]);ne+=I,R[z]=Math.sqrt(I*Math.sqrt(I)),R[z]>m.xrpow_max&&(m.xrpow_max=R[z])}return ne}this.init_xrpow=function(m,R,U){var ne=0,z=0|R.max_nonzero_coeff;if(R.xrpow_max=0,h.fill(U,z,576,0),ne=$e(R,U,z,ne),ne>1e-20){var I=0;m.substep_shaping&2&&(I=1);for(var N=0;N<R.psymax;N++)m.pseudohalf[N]=I;return!0}return h.fill(R.l3_enc,0,576,0),!1};function K(m,R){var U=m.ATH,ne=R.xr;if(R.block_type!=_.SHORT_TYPE)for(var z=!1,I=_.PSFB21-1;I>=0&&!z;I--){var N=m.scalefac_band.psfb21[I],k=m.scalefac_band.psfb21[I+1],Q=pe.athAdjust(U.adjust,U.psfb21[I],U.floor);m.nsPsy.longfact[21]>1e-12&&(Q*=m.nsPsy.longfact[21]);for(var w=k-1;w>=N;w--)if(Math.abs(ne[w])<Q)ne[w]=0;else{z=!0;break}}else for(var ye=0;ye<3;ye++)for(var z=!1,I=_.PSFB12-1;I>=0&&!z;I--){var N=m.scalefac_band.s[12]*3+(m.scalefac_band.s[13]-m.scalefac_band.s[12])*ye+(m.scalefac_band.psfb12[I]-m.scalefac_band.psfb12[0]),k=N+(m.scalefac_band.psfb12[I+1]-m.scalefac_band.psfb12[I]),O=pe.athAdjust(U.adjust,U.psfb12[I],U.floor);m.nsPsy.shortfact[12]>1e-12&&(O*=m.nsPsy.shortfact[12]);for(var w=k-1;w>=N;w--)if(Math.abs(ne[w])<O)ne[w]=0;else{z=!0;break}}}this.init_outer_loop=function(m,R){R.part2_3_length=0,R.big_values=0,R.count1=0,R.global_gain=210,R.scalefac_compress=0,R.table_select[0]=0,R.table_select[1]=0,R.table_select[2]=0,R.subblock_gain[0]=0,R.subblock_gain[1]=0,R.subblock_gain[2]=0,R.subblock_gain[3]=0,R.region0_count=0,R.region1_count=0,R.preflag=0,R.scalefac_scale=0,R.count1table_select=0,R.part2_length=0,R.sfb_lmax=_.SBPSY_l,R.sfb_smin=_.SBPSY_s,R.psy_lmax=m.sfb21_extra?_.SBMAX_l:_.SBPSY_l,R.psymax=R.psy_lmax,R.sfbmax=R.sfb_lmax,R.sfbdivide=11;for(var U=0;U<_.SBMAX_l;U++)R.width[U]=m.scalefac_band.l[U+1]-m.scalefac_band.l[U],R.window[U]=3;if(R.block_type==_.SHORT_TYPE){var ne=s(576);R.sfb_smin=0,R.sfb_lmax=0,R.mixed_block_flag!=0&&n(),R.psymax=R.sfb_lmax+3*((m.sfb21_extra?_.SBMAX_s:_.SBPSY_s)-R.sfb_smin),R.sfbmax=R.sfb_lmax+3*(_.SBPSY_s-R.sfb_smin),R.sfbdivide=R.sfbmax-18,R.psy_lmax=R.sfb_lmax;var z=m.scalefac_band.l[R.sfb_lmax];v.arraycopy(R.xr,0,ne,0,576);for(var U=R.sfb_smin;U<_.SBMAX_s;U++)for(var I=m.scalefac_band.s[U],N=m.scalefac_band.s[U+1],k=0;k<3;k++)for(var Q=I;Q<N;Q++)R.xr[z++]=ne[3*Q+k];for(var w=R.sfb_lmax,U=R.sfb_smin;U<_.SBMAX_s;U++)R.width[w]=R.width[w+1]=R.width[w+2]=m.scalefac_band.s[U+1]-m.scalefac_band.s[U],R.window[w]=0,R.window[w+1]=1,R.window[w+2]=2,w+=3}R.count1bits=0,R.sfb_partition_table=pe.nr_of_sfb_block[0][0],R.slen[0]=0,R.slen[1]=0,R.slen[2]=0,R.slen[3]=0,R.max_nonzero_coeff=575,h.fill(R.scalefac,0),K(m,R)};function ie(m){this.ordinal=m}ie.BINSEARCH_NONE=new ie(0),ie.BINSEARCH_UP=new ie(1),ie.BINSEARCH_DOWN=new ie(2);function Oe(m,R,U,ne,z){var I,N=m.CurrentStep[ne],k=!1,Q=m.OldValue[ne],w=ie.BINSEARCH_NONE;for(R.global_gain=Q,U-=R.part2_length;;){var ye;if(I=J.count_bits(m,z,R,null),N==1||I==U)break;I>U?(w==ie.BINSEARCH_DOWN&&(k=!0),k&&(N/=2),w=ie.BINSEARCH_UP,ye=N):(w==ie.BINSEARCH_UP&&(k=!0),k&&(N/=2),w=ie.BINSEARCH_DOWN,ye=-N),R.global_gain+=ye,R.global_gain<0&&n(),R.global_gain>255&&n()}for(;I>U&&R.global_gain<255;)R.global_gain++,I=J.count_bits(m,z,R,null);return m.CurrentStep[ne]=Q-R.global_gain>=4?4:2,m.OldValue[ne]=R.global_gain,R.part2_3_length=I,I}function he(m){for(var R=0;R<m.sfbmax;R++)if(m.scalefac[R]+m.subblock_gain[m.window[R]]==0)return!1;return!0}function Be(m,R,U,ne,z){var I;switch(m){default:case 9:{R.over_count>0?(I=U.over_SSD<=R.over_SSD,U.over_SSD==R.over_SSD&&(I=U.bits<R.bits)):I=U.max_noise<0&&U.max_noise*10+U.bits<=R.max_noise*10+R.bits;break}case 0:I=U.over_count<R.over_count||U.over_count==R.over_count&&U.over_noise<R.over_noise||U.over_count==R.over_count&&L.EQ(U.over_noise,R.over_noise)&&U.tot_noise<R.tot_noise;break;case 8:n();case 1:I=U.max_noise<R.max_noise;break;case 2:I=U.tot_noise<R.tot_noise;break;case 3:I=U.tot_noise<R.tot_noise&&U.max_noise<R.max_noise;break;case 4:I=U.max_noise<=0&&R.max_noise>.2||U.max_noise<=0&&R.max_noise<0&&R.max_noise>U.max_noise-.2&&U.tot_noise<R.tot_noise||U.max_noise<=0&&R.max_noise>0&&R.max_noise>U.max_noise-.2&&U.tot_noise<R.tot_noise+R.over_noise||U.max_noise>0&&R.max_noise>-.05&&R.max_noise>U.max_noise-.1&&U.tot_noise+U.over_noise<R.tot_noise+R.over_noise||U.max_noise>0&&R.max_noise>-.1&&R.max_noise>U.max_noise-.15&&U.tot_noise+U.over_noise+U.over_noise<R.tot_noise+R.over_noise+R.over_noise;break;case 5:I=U.over_noise<R.over_noise||L.EQ(U.over_noise,R.over_noise)&&U.tot_noise<R.tot_noise;break;case 6:I=U.over_noise<R.over_noise||L.EQ(U.over_noise,R.over_noise)&&(U.max_noise<R.max_noise||L.EQ(U.max_noise,R.max_noise)&&U.tot_noise<=R.tot_noise);break;case 7:I=U.over_count<R.over_count||U.over_noise<R.over_noise;break}return R.over_count==0&&(I=I&&U.bits<R.bits),I}function te(m,R,U,ne,z){var I=m.internal_flags,N;R.scalefac_scale==0?N=1.2968395546510096:N=1.6817928305074292;for(var k=0,Q=0;Q<R.sfbmax;Q++)k<U[Q]&&(k=U[Q]);var w=I.noise_shaping_amp;switch(w==3&&n(),w){case 2:break;case 1:k>1?k=Math.pow(k,.5):k*=.95;break;case 0:default:k>1?k=1:k*=.95;break}for(var ye=0,Q=0;Q<R.sfbmax;Q++){var O=R.width[Q],$;if(ye+=O,!(U[Q]<k)){for(I.substep_shaping&2&&n(),R.scalefac[Q]++,$=-O;$<0;$++)ne[ye+$]*=N,ne[ye+$]>R.xrpow_max&&(R.xrpow_max=ne[ye+$]);if(I.noise_shaping_amp==2)return}}}function Le(m,R){for(var U=1.2968395546510096,ne=0,z=0;z<m.sfbmax;z++){var I=m.width[z],N=m.scalefac[z];if(m.preflag!=0&&(N+=pe.pretab[z]),ne+=I,N&1){N++;for(var k=-I;k<0;k++)R[ne+k]*=U,R[ne+k]>m.xrpow_max&&(m.xrpow_max=R[ne+k])}m.scalefac[z]=N>>1}m.preflag=0,m.scalefac_scale=1}function le(m,R,U){var ne,z=R.scalefac;for(ne=0;ne<R.sfb_lmax;ne++)if(z[ne]>=16)return!0;for(var I=0;I<3;I++){var N=0,k=0;for(ne=R.sfb_lmax+I;ne<R.sfbdivide;ne+=3)N<z[ne]&&(N=z[ne]);for(;ne<R.sfbmax;ne+=3)k<z[ne]&&(k=z[ne]);if(!(N<16&&k<8)){if(R.subblock_gain[I]>=7)return!0;R.subblock_gain[I]++;var Q=m.scalefac_band.l[R.sfb_lmax];for(ne=R.sfb_lmax+I;ne<R.sfbmax;ne+=3){var w,ye=R.width[ne],O=z[ne];if(O=O-(4>>R.scalefac_scale),O>=0){z[ne]=O,Q+=ye*3;continue}z[ne]=0;{var $=210+(O<<R.scalefac_scale+1);w=pe.IPOW20($)}Q+=ye*(I+1);for(var H=-ye;H<0;H++)U[Q+H]*=w,U[Q+H]>R.xrpow_max&&(R.xrpow_max=U[Q+H]);Q+=ye*(3-I-1)}{var w=pe.IPOW20(202);Q+=R.width[ne]*(I+1);for(var H=-R.width[ne];H<0;H++)U[Q+H]*=w,U[Q+H]>R.xrpow_max&&(R.xrpow_max=U[Q+H])}}}return!1}function ae(m,R,U,ne,z){var I=m.internal_flags;te(m,R,U,ne);var N=he(R);return N?!1:(I.mode_gr==2?N=J.scale_bitcount(R):N=J.scale_bitcount_lsf(I,R),N?(I.noise_shaping>1&&(h.fill(I.pseudohalf,0),R.scalefac_scale==0?(Le(R,ne),N=!1):R.block_type==_.SHORT_TYPE&&I.subblock_gain>0&&(N=le(I,R,ne)||he(R))),N||(I.mode_gr==2?N=J.scale_bitcount(R):N=J.scale_bitcount_lsf(I,R)),!N):!0)}this.outer_loop=function(m,R,U,ne,z,I){var N=m.internal_flags,k=new ve,Q=s(576),w=s(j.SFBMAX),ye=new re,O,$=new Se,H=9999999,q=!1,de=!1,x=0;if(Oe(N,R,I,z,ne),N.noise_shaping==0)return 100;pe.calc_noise(R,U,w,ye,$),ye.bits=R.part2_3_length,k.assign(R);var E=0;for(v.arraycopy(ne,0,Q,0,576);!q;){do{var ke=new re,ge,Ee=255;if(N.substep_shaping&2?ge=20:ge=3,N.sfb21_extra&&n(),!ae(m,k,w,ne))break;k.scalefac_scale!=0&&(Ee=254);var Ve=I-k.part2_length;if(Ve<=0)break;for(;(k.part2_3_length=J.count_bits(N,ne,k,$))>Ve&&k.global_gain<=Ee;)k.global_gain++;if(k.global_gain>Ee)break;if(ye.over_count==0){for(;(k.part2_3_length=J.count_bits(N,ne,k,$))>H&&k.global_gain<=Ee;)k.global_gain++;if(k.global_gain>Ee)break}if(pe.calc_noise(k,U,w,ke,$),ke.bits=k.part2_3_length,R.block_type!=_.SHORT_TYPE?O=m.quant_comp:O=m.quant_comp_short,O=Be(O,ye,ke)?1:0,O!=0)H=R.part2_3_length,ye=ke,R.assign(k),E=0,v.arraycopy(ne,0,Q,0,576);else if(N.full_outer_loop==0&&(++E>ge&&ye.over_count==0||N.noise_shaping_amp==3&&de&&E>30||N.noise_shaping_amp==3&&de&&k.global_gain-x>15))break}while(k.global_gain+k.scalefac_scale<255);N.noise_shaping_amp==3?n():q=!0}return m.VBR==y.vbr_rh||m.VBR==y.vbr_mtrh?v.arraycopy(Q,0,ne,0,576):N.substep_shaping&1&&n(),ye.over_count},this.iteration_finish_one=function(m,R,U){var ne=m.l3_side,z=ne.tt[R][U];J.best_scalefac_store(m,R,U,ne),m.use_best_huffman==1&&J.best_huffman_divide(m,z),V.ResvAdjust(m,z)}}function A(){var V=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*p.SQRT2*.5/2384e-9,.017876148*p.SQRT2*.5/2384e-9,.003134727*p.SQRT2*.5/2384e-9,.002457142*p.SQRT2*.5/2384e-9,971317e-9*p.SQRT2*.5/2384e-9,218868e-9*p.SQRT2*.5/2384e-9,101566e-9*p.SQRT2*.5/2384e-9,13828e-9*p.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],pe=12,me=36,J=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],$e=J[_.SHORT_TYPE],K=J[_.SHORT_TYPE],ie=J[_.SHORT_TYPE],Oe=J[_.SHORT_TYPE],he=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function Be(le,ae,m){for(var R=10,U=ae+238-14-286,ne=-15;ne<0;ne++){var z,I,N;z=V[R+-10],I=le[U+-224]*z,N=le[ae+224]*z,z=V[R+-9],I+=le[U+-160]*z,N+=le[ae+160]*z,z=V[R+-8],I+=le[U+-96]*z,N+=le[ae+96]*z,z=V[R+-7],I+=le[U+-32]*z,N+=le[ae+32]*z,z=V[R+-6],I+=le[U+32]*z,N+=le[ae+-32]*z,z=V[R+-5],I+=le[U+96]*z,N+=le[ae+-96]*z,z=V[R+-4],I+=le[U+160]*z,N+=le[ae+-160]*z,z=V[R+-3],I+=le[U+224]*z,N+=le[ae+-224]*z,z=V[R+-2],I+=le[ae+-256]*z,N-=le[U+256]*z,z=V[R+-1],I+=le[ae+-192]*z,N-=le[U+192]*z,z=V[R+0],I+=le[ae+-128]*z,N-=le[U+128]*z,z=V[R+1],I+=le[ae+-64]*z,N-=le[U+64]*z,z=V[R+2],I+=le[ae+0]*z,N-=le[U+0]*z,z=V[R+3],I+=le[ae+64]*z,N-=le[U+-64]*z,z=V[R+4],I+=le[ae+128]*z,N-=le[U+-128]*z,z=V[R+5],I+=le[ae+192]*z,N-=le[U+-192]*z,I*=V[R+6],z=N-I,m[30+ne*2]=N+I,m[31+ne*2]=V[R+7]*z,R+=18,ae--,U++}{var I,N,k,Q;N=le[ae+-16]*V[R+-10],I=le[ae+-32]*V[R+-2],N+=(le[ae+-48]-le[ae+16])*V[R+-9],I+=le[ae+-96]*V[R+-1],N+=(le[ae+-80]+le[ae+48])*V[R+-8],I+=le[ae+-160]*V[R+0],N+=(le[ae+-112]-le[ae+80])*V[R+-7],I+=le[ae+-224]*V[R+1],N+=(le[ae+-144]+le[ae+112])*V[R+-6],I-=le[ae+32]*V[R+2],N+=(le[ae+-176]-le[ae+144])*V[R+-5],I-=le[ae+96]*V[R+3],N+=(le[ae+-208]+le[ae+176])*V[R+-4],I-=le[ae+160]*V[R+4],N+=(le[ae+-240]-le[ae+208])*V[R+-3],I-=le[ae+224],k=I-N,Q=I+N,N=m[14],I=m[15]-N,m[31]=Q+N,m[30]=k+I,m[15]=k-I,m[14]=Q-N}{var w;w=m[28]-m[0],m[0]+=m[28],m[28]=w*V[R+-2*18+7],w=m[29]-m[1],m[1]+=m[29],m[29]=w*V[R+-2*18+7],w=m[26]-m[2],m[2]+=m[26],m[26]=w*V[R+-4*18+7],w=m[27]-m[3],m[3]+=m[27],m[27]=w*V[R+-4*18+7],w=m[24]-m[4],m[4]+=m[24],m[24]=w*V[R+-6*18+7],w=m[25]-m[5],m[5]+=m[25],m[25]=w*V[R+-6*18+7],w=m[22]-m[6],m[6]+=m[22],m[22]=w*p.SQRT2,w=m[23]-m[7],m[7]+=m[23],m[23]=w*p.SQRT2-m[7],m[7]-=m[6],m[22]-=m[7],m[23]-=m[22],w=m[6],m[6]=m[31]-w,m[31]=m[31]+w,w=m[7],m[7]=m[30]-w,m[30]=m[30]+w,w=m[22],m[22]=m[15]-w,m[15]=m[15]+w,w=m[23],m[23]=m[14]-w,m[14]=m[14]+w,w=m[20]-m[8],m[8]+=m[20],m[20]=w*V[R+-10*18+7],w=m[21]-m[9],m[9]+=m[21],m[21]=w*V[R+-10*18+7],w=m[18]-m[10],m[10]+=m[18],m[18]=w*V[R+-12*18+7],w=m[19]-m[11],m[11]+=m[19],m[19]=w*V[R+-12*18+7],w=m[16]-m[12],m[12]+=m[16],m[16]=w*V[R+-14*18+7],w=m[17]-m[13],m[13]+=m[17],m[17]=w*V[R+-14*18+7],w=-m[20]+m[24],m[20]+=m[24],m[24]=w*V[R+-12*18+7],w=-m[21]+m[25],m[21]+=m[25],m[25]=w*V[R+-12*18+7],w=m[4]-m[8],m[4]+=m[8],m[8]=w*V[R+-12*18+7],w=m[5]-m[9],m[5]+=m[9],m[9]=w*V[R+-12*18+7],w=m[0]-m[12],m[0]+=m[12],m[12]=w*V[R+-4*18+7],w=m[1]-m[13],m[1]+=m[13],m[13]=w*V[R+-4*18+7],w=m[16]-m[28],m[16]+=m[28],m[28]=w*V[R+-4*18+7],w=-m[17]+m[29],m[17]+=m[29],m[29]=w*V[R+-4*18+7],w=p.SQRT2*(m[2]-m[10]),m[2]+=m[10],m[10]=w,w=p.SQRT2*(m[3]-m[11]),m[3]+=m[11],m[11]=w,w=p.SQRT2*(-m[18]+m[26]),m[18]+=m[26],m[26]=w-m[18],w=p.SQRT2*(-m[19]+m[27]),m[19]+=m[27],m[27]=w-m[19],w=m[2],m[19]-=m[3],m[3]-=w,m[2]=m[31]-w,m[31]+=w,w=m[3],m[11]-=m[19],m[18]-=w,m[3]=m[30]-w,m[30]+=w,w=m[18],m[27]-=m[11],m[19]-=w,m[18]=m[15]-w,m[15]+=w,w=m[19],m[10]-=w,m[19]=m[14]-w,m[14]+=w,w=m[10],m[11]-=w,m[10]=m[23]-w,m[23]+=w,w=m[11],m[26]-=w,m[11]=m[22]-w,m[22]+=w,w=m[26],m[27]-=w,m[26]=m[7]-w,m[7]+=w,w=m[27],m[27]=m[6]-w,m[6]+=w,w=p.SQRT2*(m[0]-m[4]),m[0]+=m[4],m[4]=w,w=p.SQRT2*(m[1]-m[5]),m[1]+=m[5],m[5]=w,w=p.SQRT2*(m[16]-m[20]),m[16]+=m[20],m[20]=w,w=p.SQRT2*(m[17]-m[21]),m[17]+=m[21],m[21]=w,w=-p.SQRT2*(m[8]-m[12]),m[8]+=m[12],m[12]=w-m[8],w=-p.SQRT2*(m[9]-m[13]),m[9]+=m[13],m[13]=w-m[9],w=-p.SQRT2*(m[25]-m[29]),m[25]+=m[29],m[29]=w-m[25],w=-p.SQRT2*(m[24]+m[28]),m[24]-=m[28],m[28]=w-m[24],w=m[24]-m[16],m[24]=w,w=m[20]-w,m[20]=w,w=m[28]-w,m[28]=w,w=m[25]-m[17],m[25]=w,w=m[21]-w,m[21]=w,w=m[29]-w,m[29]=w,w=m[17]-m[1],m[17]=w,w=m[9]-w,m[9]=w,w=m[25]-w,m[25]=w,w=m[5]-w,m[5]=w,w=m[21]-w,m[21]=w,w=m[13]-w,m[13]=w,w=m[29]-w,m[29]=w,w=m[1]-m[0],m[1]=w,w=m[16]-w,m[16]=w,w=m[17]-w,m[17]=w,w=m[8]-w,m[8]=w,w=m[9]-w,m[9]=w,w=m[24]-w,m[24]=w,w=m[25]-w,m[25]=w,w=m[4]-w,m[4]=w,w=m[5]-w,m[5]=w,w=m[20]-w,m[20]=w,w=m[21]-w,m[21]=w,w=m[12]-w,m[12]=w,w=m[13]-w,m[13]=w,w=m[28]-w,m[28]=w,w=m[29]-w,m[29]=w,w=m[0],m[0]+=m[31],m[31]-=w,w=m[1],m[1]+=m[30],m[30]-=w,w=m[16],m[16]+=m[15],m[15]-=w,w=m[17],m[17]+=m[14],m[14]-=w,w=m[8],m[8]+=m[23],m[23]-=w,w=m[9],m[9]+=m[22],m[22]-=w,w=m[24],m[24]+=m[7],m[7]-=w,w=m[25],m[25]+=m[6],m[6]-=w,w=m[4],m[4]+=m[27],m[27]-=w,w=m[5],m[5]+=m[26],m[26]-=w,w=m[20],m[20]+=m[11],m[11]-=w,w=m[21],m[21]+=m[10],m[10]-=w,w=m[12],m[12]+=m[19],m[19]-=w,w=m[13],m[13]+=m[18],m[18]-=w,w=m[28],m[28]+=m[3],m[3]-=w,w=m[29],m[29]+=m[2],m[2]-=w}}function te(le,ae){for(var m=0;m<3;m++){var R,U,ne,z,I,N;z=le[ae+2*3]*J[_.SHORT_TYPE][0]-le[ae+5*3],R=le[ae+0*3]*J[_.SHORT_TYPE][2]-le[ae+3*3],U=z+R,ne=z-R,z=le[ae+5*3]*J[_.SHORT_TYPE][0]+le[ae+2*3],R=le[ae+3*3]*J[_.SHORT_TYPE][2]+le[ae+0*3],I=z+R,N=-z+R,R=(le[ae+1*3]*J[_.SHORT_TYPE][1]-le[ae+4*3])*2069978111953089e-26,z=(le[ae+4*3]*J[_.SHORT_TYPE][1]+le[ae+1*3])*2069978111953089e-26,le[ae+3*0]=U*190752519173728e-25+R,le[ae+3*5]=-I*190752519173728e-25+z,ne=ne*.8660254037844387*1907525191737281e-26,I=I*.5*1907525191737281e-26+z,le[ae+3*1]=ne-I,le[ae+3*2]=ne+I,U=U*.5*1907525191737281e-26-R,N=N*.8660254037844387*1907525191737281e-26,le[ae+3*3]=U+N,le[ae+3*4]=U-N,ae++}}function Le(le,ae,m){var R,U;{var ne,z,I,N,k,Q,w,ye;ne=m[17]-m[9],I=m[15]-m[11],N=m[14]-m[12],k=m[0]+m[8],Q=m[1]+m[7],w=m[2]+m[6],ye=m[3]+m[5],le[ae+17]=k+w-ye-(Q-m[4]),U=(k+w-ye)*K[19]+(Q-m[4]),R=(ne-I-N)*K[18],le[ae+5]=R+U,le[ae+6]=R-U,z=(m[16]-m[10])*K[18],Q=Q*K[19]+m[4],R=ne*K[12]+z+I*K[13]+N*K[14],U=-k*K[16]+Q-w*K[17]+ye*K[15],le[ae+1]=R+U,le[ae+2]=R-U,R=ne*K[13]-z-I*K[14]+N*K[12],U=-k*K[17]+Q-w*K[15]+ye*K[16],le[ae+9]=R+U,le[ae+10]=R-U,R=ne*K[14]-z+I*K[12]-N*K[13],U=k*K[15]-Q+w*K[16]-ye*K[17],le[ae+13]=R+U,le[ae+14]=R-U}{var O,$,H,q,de,x,E,ke;O=m[8]-m[0],H=m[6]-m[2],q=m[5]-m[3],de=m[17]+m[9],x=m[16]+m[10],E=m[15]+m[11],ke=m[14]+m[12],le[ae+0]=de+E+ke+(x+m[13]),R=(de+E+ke)*K[19]-(x+m[13]),U=(O-H+q)*K[18],le[ae+11]=R+U,le[ae+12]=R-U,$=(m[7]-m[1])*K[18],x=m[13]-x*K[19],R=de*K[15]-x+E*K[16]+ke*K[17],U=O*K[14]+$+H*K[12]+q*K[13],le[ae+3]=R+U,le[ae+4]=R-U,R=-de*K[17]+x-E*K[15]-ke*K[16],U=O*K[13]+$-H*K[14]-q*K[12],le[ae+7]=R+U,le[ae+8]=R-U,R=-de*K[16]+x-E*K[17]-ke*K[15],U=O*K[12]-$+H*K[13]-q*K[14],le[ae+15]=R+U,le[ae+16]=R-U}}this.mdct_sub48=function(le,ae,m){for(var R=ae,U=286,ne=0;ne<le.channels_out;ne++){for(var z=0;z<le.mode_gr;z++){for(var I,N=le.l3_side.tt[z][ne],k=N.xr,Q=0,w=le.sb_sample[ne][1-z],ye=0,O=0;O<18/2;O++)for(Be(R,U,w[ye]),Be(R,U+32,w[ye+1]),ye+=2,U+=64,I=1;I<32;I+=2)w[ye-1][I]*=-1;for(I=0;I<32;I++,Q+=18){var $=N.block_type,H=le.sb_sample[ne][z],q=le.sb_sample[ne][1-z];if(N.mixed_block_flag!=0&&I<2&&($=0),le.amp_filter[I]<1e-12)h.fill(k,Q+0,Q+18,0);else if(le.amp_filter[I]<1&&n(),$==_.SHORT_TYPE){for(var O=-pe/4;O<0;O++){var de=J[_.SHORT_TYPE][O+3];k[Q+O*3+9]=H[9+O][he[I]]*de-H[8-O][he[I]],k[Q+O*3+18]=H[14-O][he[I]]*de+H[15+O][he[I]],k[Q+O*3+10]=H[15+O][he[I]]*de-H[14-O][he[I]],k[Q+O*3+19]=q[2-O][he[I]]*de+q[3+O][he[I]],k[Q+O*3+11]=q[3+O][he[I]]*de-q[2-O][he[I]],k[Q+O*3+20]=q[8-O][he[I]]*de+q[9+O][he[I]]}te(k,Q)}else{for(var x=s(18),O=-me/4;O<0;O++){var E,ke;E=J[$][O+27]*q[O+9][he[I]]+J[$][O+36]*q[8-O][he[I]],ke=J[$][O+9]*H[O+9][he[I]]-J[$][O+18]*H[8-O][he[I]],x[O+9]=E-ke*$e[3+O+9],x[O+18]=E*$e[3+O+9]+ke}Le(k,Q,x)}if($!=_.SHORT_TYPE&&I!=0)for(var O=7;O>=0;--O){var ge,Ee;ge=k[Q+O]*ie[20+O]+k[Q+-1-O]*Oe[28+O],Ee=k[Q+O]*Oe[28+O]-k[Q+-1-O]*ie[20+O],k[Q+-1-O]=ge,k[Q+O]=Ee}}}if(R=m,U=286,le.mode_gr==1)for(var Ve=0;Ve<18;Ve++)v.arraycopy(le.sb_sample[ne][1][Ve],0,le.sb_sample[ne][0][Ve],0,32)}}}function F(){this.thm=new xe,this.en=new xe}_.ENCDELAY=576,_.POSTDELAY=1152,_.MDCTDELAY=48,_.FFTOFFSET=224+_.MDCTDELAY,_.DECDELAY=528,_.SBLIMIT=32,_.CBANDS=64,_.SBPSY_l=21,_.SBPSY_s=12,_.SBMAX_l=22,_.SBMAX_s=13,_.PSFB21=6,_.PSFB12=6,_.BLKSIZE=1024,_.HBLKSIZE=_.BLKSIZE/2+1,_.BLKSIZE_s=256,_.HBLKSIZE_s=_.BLKSIZE_s/2+1,_.NORM_TYPE=0,_.START_TYPE=1,_.SHORT_TYPE=2,_.STOP_TYPE=3,_.MPG_MD_LR_LR=0,_.MPG_MD_LR_I=1,_.MPG_MD_MS_LR=2,_.MPG_MD_MS_I=3,_.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function _(){var V=_.MPG_MD_MS_LR,pe=null;this.psy=null;var me=null,J=null;this.setModules=function(he,Be,te,Le){pe=he,this.psy=Be,me=Be,J=Le};var $e=new A;function K(he){var Be,te;if(he.ATH.useAdjust==0){he.ATH.adjust=1;return}if(te=he.loudness_sq[0][0],Be=he.loudness_sq[1][0],he.channels_out==2?n():(te+=te,Be+=Be),he.mode_gr==2&&(te=Math.max(te,Be)),te*=.5,te*=he.ATH.aaSensitivityP,te>.03125)he.ATH.adjust>=1?he.ATH.adjust=1:he.ATH.adjust<he.ATH.adjustLimit&&(he.ATH.adjust=he.ATH.adjustLimit),he.ATH.adjustLimit=1;else{var Le=31.98*te+625e-6;he.ATH.adjust>=Le?(he.ATH.adjust*=Le*.075+.925,he.ATH.adjust<Le&&(he.ATH.adjust=Le)):he.ATH.adjustLimit>=Le?he.ATH.adjust=Le:he.ATH.adjust<he.ATH.adjustLimit&&(he.ATH.adjust=he.ATH.adjustLimit),he.ATH.adjustLimit=Le}}function ie(he){var Be,te;for(he.bitrate_stereoMode_Hist[he.bitrate_index][4]++,he.bitrate_stereoMode_Hist[15][4]++,he.channels_out==2&&n(),Be=0;Be<he.mode_gr;++Be)for(te=0;te<he.channels_out;++te){var Le=he.l3_side.tt[Be][te].block_type|0;he.l3_side.tt[Be][te].mixed_block_flag!=0&&(Le=4),he.bitrate_blockType_Hist[he.bitrate_index][Le]++,he.bitrate_blockType_Hist[he.bitrate_index][5]++,he.bitrate_blockType_Hist[15][Le]++,he.bitrate_blockType_Hist[15][5]++}}function Oe(he,Be){var te=he.internal_flags,Le,le;if(te.lame_encode_frame_init==0){var ae,m,R=s(2014),U=s(2014);for(te.lame_encode_frame_init=1,ae=0,m=0;ae<286+576*(1+te.mode_gr);++ae)ae<576*te.mode_gr?(R[ae]=0,te.channels_out==2&&(U[ae]=0)):(R[ae]=Be[0][m],te.channels_out==2&&(U[ae]=Be[1][m]),++m);for(le=0;le<te.mode_gr;le++)for(Le=0;Le<te.channels_out;Le++)te.l3_side.tt[le][Le].block_type=_.SHORT_TYPE;$e.mdct_sub48(te,R,U)}}this.lame_encode_mp3_frame=function(he,Be,te,Le,le,ae){var m,R=d([2,2]);R[0][0]=new F,R[0][1]=new F,R[1][0]=new F,R[1][1]=new F;var U=d([2,2]);U[0][0]=new F,U[0][1]=new F,U[1][0]=new F,U[1][1]=new F;var ne,z=[null,null],I=he.internal_flags,N=u([2,4]),k=[.5,.5],Q=[[0,0],[0,0]],w=[[0,0],[0,0]],ye,O,$;if(z[0]=Be,z[1]=te,I.lame_encode_frame_init==0&&Oe(he,z),I.padding=0,(I.slot_lag-=I.frac_SpF)<0&&(I.slot_lag+=he.out_samplerate,I.padding=1),I.psymodel!=0){var H,q=[null,null],de=0,x=o(2);for($=0;$<I.mode_gr;$++){for(O=0;O<I.channels_out;O++)q[O]=z[O],de=576+$*576-_.FFTOFFSET;if(he.VBR==y.vbr_mtrh||he.VBR==y.vbr_mt?n():H=me.L3psycho_anal_ns(he,q,de,$,R,U,Q[$],w[$],N[$],x),H!=0)return-4;for(he.mode==S.JOINT_STEREO&&n(),O=0;O<I.channels_out;O++){var E=I.l3_side.tt[$][O];E.block_type=x[O],E.mixed_block_flag=0}}}else n();if(K(I),$e.mdct_sub48(I,z[0],z[1]),I.mode_ext=_.MPG_MD_LR_LR,he.force_ms?I.mode_ext=_.MPG_MD_MS_LR:he.mode==S.JOINT_STEREO&&n(),I.mode_ext==V?(ne=U,ye=w):(ne=R,ye=Q),he.analysis&&I.pinfo!=null&&n(),he.VBR==y.vbr_off||he.VBR==y.vbr_abr){var ke,ge;for(ke=0;ke<18;ke++)I.nsPsy.pefirbuf[ke]=I.nsPsy.pefirbuf[ke+1];for(ge=0,$=0;$<I.mode_gr;$++)for(O=0;O<I.channels_out;O++)ge+=ye[$][O];for(I.nsPsy.pefirbuf[18]=ge,ge=I.nsPsy.pefirbuf[9],ke=0;ke<9;ke++)ge+=(I.nsPsy.pefirbuf[ke]+I.nsPsy.pefirbuf[18-ke])*_.fircoef[ke];for(ge=670*5*I.mode_gr*I.channels_out/ge,$=0;$<I.mode_gr;$++)for(O=0;O<I.channels_out;O++)ye[$][O]*=ge}return I.iteration_loop.iteration_loop(he,ye,k,ne),pe.format_bitstream(he),m=pe.copy_buffer(I,Le,le,ae,1),he.bWriteVbrTag&&J.addVbrFrame(he),he.analysis&&I.pinfo!=null&&n(),ie(I),m}}function Y(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function ce(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[o(4),o(4)];for(var V=0;V<2;V++)for(var pe=0;pe<2;pe++)this.tt[V][pe]=new ve}function xe(){this.l=s(_.SBMAX_l),this.s=u([_.SBMAX_s,3]);var V=this;this.assign=function(pe){v.arraycopy(pe.l,0,V.l,0,_.SBMAX_l);for(var me=0;me<_.SBMAX_s;me++)for(var J=0;J<3;J++)V.s[me][J]=pe.s[me][J]}}function De(){this.last_en_subshort=u([4,9]),this.lastAttacks=o(4),this.pefirbuf=s(19),this.longfact=s(_.SBMAX_l),this.shortfact=s(_.SBMAX_s),this.attackthre=0,this.attackthre_s=0}He.MFSIZE=3*1152+_.ENCDELAY-_.MDCTDELAY,He.MAX_HEADER_BUF=256,He.MAX_BITS_PER_CHANNEL=4095,He.MAX_BITS_PER_GRANULE=7680,He.BPC=320;function He(){var V=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=u([2,He.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new ce,this.ms_ratio=s(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=o(2),this.CurrentStep=o(2),this.masking_lower=0,this.bv_scf=o(576),this.pseudohalf=o(j.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*He.BPC+1),this.itime=l(2),this.sideinfo_len=0,this.sb_sample=u([2,2,18,_.SBLIMIT]),this.amp_filter=s(32);function pe(){this.write_timing=0,this.ptr=0,this.buf=a(V)}this.header=new Array(He.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Me,this.minval_l=s(_.CBANDS),this.minval_s=s(_.CBANDS),this.nb_1=u([4,_.CBANDS]),this.nb_2=u([4,_.CBANDS]),this.nb_s1=u([4,_.CBANDS]),this.nb_s2=u([4,_.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=s(4),this.loudness_sq=u([2,2]),this.loudness_sq_save=s(2),this.mld_l=s(_.SBMAX_l),this.mld_s=s(_.SBMAX_s),this.bm_l=o(_.SBMAX_l),this.bo_l=o(_.SBMAX_l),this.bm_s=o(_.SBMAX_s),this.bo_s=o(_.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=c([_.CBANDS,2]),this.s3ind_s=c([_.CBANDS,2]),this.numlines_s=o(_.CBANDS),this.numlines_l=o(_.CBANDS),this.rnumlines_l=s(_.CBANDS),this.mld_cb_l=s(_.CBANDS),this.mld_cb_s=s(_.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=s(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=o(2),this.nsPsy=new De,this.VBR_seek_table=new Y,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=c([16,5]),this.bitrate_blockType_Hist=c([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var me=0;me<this.en.length;me++)this.en[me]=new xe;for(var me=0;me<this.thm.length;me++)this.thm[me]=new xe;for(var me=0;me<this.header.length;me++)this.header[me]=new pe}function Ze(){var V=s(_.BLKSIZE),pe=s(_.BLKSIZE_s/2),me=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function J(K,ie,Oe){var he=0,Be,te,Le;Oe<<=1;var le=ie+Oe;Be=4;do{var ae,m,R,U,ne,z,I;I=Be>>1,U=Be,ne=Be<<1,z=ne+U,Be=ne<<1,te=ie,Le=te+I;do{var N,k,Q,w;k=K[te+0]-K[te+U],N=K[te+0]+K[te+U],w=K[te+ne]-K[te+z],Q=K[te+ne]+K[te+z],K[te+ne]=N-Q,K[te+0]=N+Q,K[te+z]=k-w,K[te+U]=k+w,k=K[Le+0]-K[Le+U],N=K[Le+0]+K[Le+U],w=p.SQRT2*K[Le+z],Q=p.SQRT2*K[Le+ne],K[Le+ne]=N-Q,K[Le+0]=N+Q,K[Le+z]=k-w,K[Le+U]=k+w,Le+=Be,te+=Be}while(te<le);for(m=me[he+0],ae=me[he+1],R=1;R<I;R++){var ye,O;ye=1-2*ae*ae,O=2*ae*m,te=ie+R,Le=ie+U-R;do{var $,H,q,N,k,de,Q,x,w,E;H=O*K[te+U]-ye*K[Le+U],$=ye*K[te+U]+O*K[Le+U],k=K[te+0]-$,N=K[te+0]+$,de=K[Le+0]-H,q=K[Le+0]+H,H=O*K[te+z]-ye*K[Le+z],$=ye*K[te+z]+O*K[Le+z],w=K[te+ne]-$,Q=K[te+ne]+$,E=K[Le+ne]-H,x=K[Le+ne]+H,H=ae*Q-m*E,$=m*Q+ae*E,K[te+ne]=N-$,K[te+0]=N+$,K[Le+z]=de-H,K[Le+U]=de+H,H=m*x-ae*w,$=ae*x+m*w,K[Le+ne]=q-$,K[Le+0]=q+$,K[te+z]=k-H,K[te+U]=k+H,Le+=Be,te+=Be}while(te<le);ye=m,m=ye*me[he+0]-ae*me[he+1],ae=ye*me[he+1]+ae*me[he+0]}he+=2}while(Be<Oe)}var $e=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(K,ie,Oe,he,Be){for(var te=0;te<3;te++){var Le=_.BLKSIZE_s/2,le=65535&576/3*(te+1),ae=_.BLKSIZE_s/8-1;do{var m,R,U,ne,z,I=$e[ae<<2]&255;m=pe[I]*he[Oe][Be+I+le],z=pe[127-I]*he[Oe][Be+I+le+128],R=m-z,m=m+z,U=pe[I+64]*he[Oe][Be+I+le+64],z=pe[63-I]*he[Oe][Be+I+le+192],ne=U-z,U=U+z,Le-=4,ie[te][Le+0]=m+U,ie[te][Le+2]=m-U,ie[te][Le+1]=R+ne,ie[te][Le+3]=R-ne,m=pe[I+1]*he[Oe][Be+I+le+1],z=pe[126-I]*he[Oe][Be+I+le+129],R=m-z,m=m+z,U=pe[I+65]*he[Oe][Be+I+le+65],z=pe[62-I]*he[Oe][Be+I+le+193],ne=U-z,U=U+z,ie[te][Le+_.BLKSIZE_s/2+0]=m+U,ie[te][Le+_.BLKSIZE_s/2+2]=m-U,ie[te][Le+_.BLKSIZE_s/2+1]=R+ne,ie[te][Le+_.BLKSIZE_s/2+3]=R-ne}while(--ae>=0);J(ie[te],Le,_.BLKSIZE_s/2)}},this.fft_long=function(K,ie,Oe,he,Be){var te=_.BLKSIZE/8-1,Le=_.BLKSIZE/2;do{var le,ae,m,R,U,ne=$e[te]&255;le=V[ne]*he[Oe][Be+ne],U=V[ne+512]*he[Oe][Be+ne+512],ae=le-U,le=le+U,m=V[ne+256]*he[Oe][Be+ne+256],U=V[ne+768]*he[Oe][Be+ne+768],R=m-U,m=m+U,Le-=4,ie[Le+0]=le+m,ie[Le+2]=le-m,ie[Le+1]=ae+R,ie[Le+3]=ae-R,le=V[ne+1]*he[Oe][Be+ne+1],U=V[ne+513]*he[Oe][Be+ne+513],ae=le-U,le=le+U,m=V[ne+257]*he[Oe][Be+ne+257],U=V[ne+769]*he[Oe][Be+ne+769],R=m-U,m=m+U,ie[Le+_.BLKSIZE/2+0]=le+m,ie[Le+_.BLKSIZE/2+2]=le-m,ie[Le+_.BLKSIZE/2+1]=ae+R,ie[Le+_.BLKSIZE/2+3]=ae-R}while(--te>=0);J(ie,Le,_.BLKSIZE/2)},this.init_fft=function(K){for(var ie=0;ie<_.BLKSIZE;ie++)V[ie]=.42-.5*Math.cos(2*Math.PI*(ie+.5)/_.BLKSIZE)+.08*Math.cos(4*Math.PI*(ie+.5)/_.BLKSIZE);for(var ie=0;ie<_.BLKSIZE_s/2;ie++)pe[ie]=.5*(1-Math.cos(2*Math.PI*(ie+.5)/_.BLKSIZE_s))}}function je(){var V=new Ze,pe=2.302585092994046,me=2,J=16,$e=2,K=16,ie=.34,Oe=1/(14752*14752)/(_.BLKSIZE/2),he=.01,Be=.8,te=.6,Le=.3,le=3.5,ae=21,m=.2302585093;function R(Ie,_e){for(var Re=0,it=0;it<_.BLKSIZE/2;++it)Re+=Ie[it]*_e.ATH.eql_w[it];return Re*=Oe,Re}function U(Ie,_e,Re,it,nt,We,et,tt,ot,St,lt){var Vt=Ie.internal_flags;ot<2?(V.fft_long(Vt,it[nt],ot,St,lt),V.fft_short(Vt,We[et],ot,St,lt)):ot==2&&n(),_e[0]=it[nt+0][0],_e[0]*=_e[0];for(var Rt=_.BLKSIZE/2-1;Rt>=0;--Rt){var zt=it[nt+0][_.BLKSIZE/2-Rt],Xt=it[nt+0][_.BLKSIZE/2+Rt];_e[_.BLKSIZE/2-Rt]=(zt*zt+Xt*Xt)*.5}for(var It=2;It>=0;--It){Re[It][0]=We[et+0][It][0],Re[It][0]*=Re[It][0];for(var Rt=_.BLKSIZE_s/2-1;Rt>=0;--Rt){var zt=We[et+0][It][_.BLKSIZE_s/2-Rt],Xt=We[et+0][It][_.BLKSIZE_s/2+Rt];Re[It][_.BLKSIZE_s/2-Rt]=(zt*zt+Xt*Xt)*.5}}{for(var mt=0,Rt=11;Rt<_.HBLKSIZE;Rt++)mt+=_e[Rt];Vt.tot_ener[ot]=mt}Ie.analysis&&n(),Ie.athaa_loudapprox==2&&ot<2&&(Vt.loudness_sq[tt][ot]=Vt.loudness_sq_save[ot],Vt.loudness_sq_save[ot]=R(_e,Vt))}var ne=8,z=23,I=15,N,k,Q,w=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function ye(){N=Math.pow(10,(ne+1)/16),k=Math.pow(10,(z+1)/16),Q=Math.pow(10,I/10)}var O=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],$=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],H=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function q(Ie,_e,Re,it,nt,We){var et;if(_e>Ie)if(_e<Ie*k)et=_e/Ie;else return Ie+_e;else{if(Ie>=_e*k)return Ie+_e;et=Ie/_e}if(Ie+=_e,it+3<=6){if(et>=N)return Ie;var tt=0|p.FAST_LOG10_X(et,16);return Ie*$[tt]}var tt=0|p.FAST_LOG10_X(et,16);if(_e=nt.ATH.cb_l[Re]*nt.ATH.adjust,Ie<Q*_e){if(Ie>_e){var ot,St;return ot=1,tt<=13&&(ot=H[tt]),St=p.FAST_LOG10_X(Ie/_e,10/15),Ie*((O[tt]-ot)*St+ot)}return tt>13?Ie:Ie*H[tt]}return Ie*O[tt]}function de(Ie,_e,Re,it,nt){var We,et,tt=0,ot=0;for(We=et=0;We<_.SBMAX_s;++et,++We){for(var St=Ie.bo_s[We],lt=Ie.npart_s,Vt=St<lt?St:lt;et<Vt;)tt+=_e[et],ot+=Re[et],et++;if(Ie.en[it].s[We][nt]=tt,Ie.thm[it].s[We][nt]=ot,et>=lt){++We;break}{var Rt=Ie.PSY.bo_s_weight[We],zt=1-Rt;tt=Rt*_e[et],ot=Rt*Re[et],Ie.en[it].s[We][nt]+=tt,Ie.thm[it].s[We][nt]+=ot,tt=zt*_e[et],ot=zt*Re[et]}}for(;We<_.SBMAX_s;++We)Ie.en[it].s[We][nt]=0,Ie.thm[it].s[We][nt]=0}function x(Ie,_e,Re,it){var nt,We,et=0,tt=0;for(nt=We=0;nt<_.SBMAX_l;++We,++nt){for(var ot=Ie.bo_l[nt],St=Ie.npart_l,lt=ot<St?ot:St;We<lt;)et+=_e[We],tt+=Re[We],We++;if(Ie.en[it].l[nt]=et,Ie.thm[it].l[nt]=tt,We>=St){++nt;break}{var Vt=Ie.PSY.bo_l_weight[nt],Rt=1-Vt;et=Vt*_e[We],tt=Vt*Re[We],Ie.en[it].l[nt]+=et,Ie.thm[it].l[nt]+=tt,et=Rt*_e[We],tt=Rt*Re[We]}}for(;nt<_.SBMAX_l;++nt)Ie.en[it].l[nt]=0,Ie.thm[it].l[nt]=0}function E(Ie,_e,Re,it,nt,We){var et=Ie.internal_flags,tt,ot;for(ot=tt=0;ot<et.npart_s;++ot){for(var St=0,lt=et.numlines_s[ot],Vt=0;Vt<lt;++Vt,++tt){var Rt=_e[We][tt];St+=Rt}Re[ot]=St}for(tt=ot=0;ot<et.npart_s;ot++){var zt=et.s3ind_s[ot][0],Xt=et.s3_ss[tt++]*Re[zt];for(++zt;zt<=et.s3ind_s[ot][1];)Xt+=et.s3_ss[tt]*Re[zt],++tt,++zt;{var It=$e*et.nb_s1[nt][ot];it[ot]=Math.min(Xt,It)}if(et.blocktype_old[nt&1]==_.SHORT_TYPE){var It=K*et.nb_s2[nt][ot],mt=it[ot];it[ot]=Math.min(It,mt)}et.nb_s2[nt][ot]=et.nb_s1[nt][ot],et.nb_s1[nt][ot]=Xt}for(;ot<=_.CBANDS;++ot)Re[ot]=0,it[ot]=0}function ke(Ie,_e,Re,it){var nt=Ie.internal_flags;Ie.short_blocks==g.short_block_coupled&&!(_e[0]!=0&&_e[1]!=0)&&(_e[0]=_e[1]=0);for(var We=0;We<nt.channels_out;We++)it[We]=_.NORM_TYPE,Ie.short_blocks==g.short_block_dispensed&&(_e[We]=1),Ie.short_blocks==g.short_block_forced&&(_e[We]=0),_e[We]!=0?nt.blocktype_old[We]==_.SHORT_TYPE&&(it[We]=_.STOP_TYPE):(it[We]=_.SHORT_TYPE,nt.blocktype_old[We]==_.NORM_TYPE&&(nt.blocktype_old[We]=_.START_TYPE),nt.blocktype_old[We]==_.STOP_TYPE&&(nt.blocktype_old[We]=_.SHORT_TYPE)),Re[We]=nt.blocktype_old[We],nt.blocktype_old[We]=it[We]}function ge(Ie,_e,Re){return Re>=1?Ie:Re<=0?_e:_e>0?Math.pow(Ie/_e,Re)*_e:0}var Ee=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function Ve(Ie,_e){for(var Re=309.07,it=0;it<_.SBMAX_s-1;it++)for(var nt=0;nt<3;nt++){var We=Ie.thm.s[it][nt];if(We>0){var et=We*_e,tt=Ie.en.s[it][nt];tt>et&&(tt>et*1e10?Re+=Ee[it]*(10*pe):Re+=Ee[it]*p.FAST_LOG10(tt/et))}}return Re}var qe=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function ee(Ie,_e){for(var Re=281.0575,it=0;it<_.SBMAX_l-1;it++){var nt=Ie.thm.l[it];if(nt>0){var We=nt*_e,et=Ie.en.l[it];et>We&&(et>We*1e10?Re+=qe[it]*(10*pe):Re+=qe[it]*p.FAST_LOG10(et/We))}}return Re}function Ae(Ie,_e,Re,it,nt){var We,et;for(We=et=0;We<Ie.npart_l;++We){var tt=0,ot=0,St;for(St=0;St<Ie.numlines_l[We];++St,++et){var lt=_e[et];tt+=lt,ot<lt&&(ot=lt)}Re[We]=tt,it[We]=ot,nt[We]=tt*Ie.rnumlines_l[We]}}function Qe(Ie,_e,Re,it){var nt=w.length-1,We=0,et=Re[We]+Re[We+1];if(et>0){var tt=_e[We];tt<_e[We+1]&&(tt=_e[We+1]),et=20*(tt*2-et)/(et*(Ie.numlines_l[We]+Ie.numlines_l[We+1]-1));var ot=0|et;ot>nt&&(ot=nt),it[We]=ot}else it[We]=0;for(We=1;We<Ie.npart_l-1;We++)if(et=Re[We-1]+Re[We]+Re[We+1],et>0){var tt=_e[We-1];tt<_e[We]&&(tt=_e[We]),tt<_e[We+1]&&(tt=_e[We+1]),et=20*(tt*3-et)/(et*(Ie.numlines_l[We-1]+Ie.numlines_l[We]+Ie.numlines_l[We+1]-1));var ot=0|et;ot>nt&&(ot=nt),it[We]=ot}else it[We]=0;if(et=Re[We-1]+Re[We],et>0){var tt=_e[We-1];tt<_e[We]&&(tt=_e[We]),et=20*(tt*2-et)/(et*(Ie.numlines_l[We-1]+Ie.numlines_l[We]-1));var ot=0|et;ot>nt&&(ot=nt),it[We]=ot}else it[We]=0}var st=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(Ie,_e,Re,it,nt,We,et,tt,ot,St){var lt=Ie.internal_flags,Vt=u([2,_.BLKSIZE]),Rt=u([2,3,_.BLKSIZE_s]),zt=s(_.CBANDS+1),Xt=s(_.CBANDS+1),It=s(_.CBANDS+2),mt=o(2),$t=o(2),lr,ut,wt,ht,Gt,hn,Er,Ot,fi=u([2,576]),Ar,Rn=o(_.CBANDS+2),Jn=o(_.CBANDS+2);for(h.fill(Jn,0),lr=lt.channels_out,Ie.mode==S.JOINT_STEREO&&(lr=4),Ie.VBR==y.vbr_off?Ar=lt.ResvMax==0?0:lt.ResvSize/lt.ResvMax*.5:Ie.VBR==y.vbr_rh||Ie.VBR==y.vbr_mtrh||Ie.VBR==y.vbr_mt?Ar=.6:Ar=1,ut=0;ut<lt.channels_out;ut++){var ya=_e[ut],xa=Re+576-350-ae+192;for(ht=0;ht<576;ht++){var bo,yo;for(bo=ya[xa+ht+10],yo=0,Gt=0;Gt<(ae-1)/2-1;Gt+=2)bo+=st[Gt]*(ya[xa+ht+Gt]+ya[xa+ht+ae-Gt]),yo+=st[Gt+1]*(ya[xa+ht+Gt+1]+ya[xa+ht+ae-Gt-1]);fi[ut][ht]=bo+yo}nt[it][ut].en.assign(lt.en[ut]),nt[it][ut].thm.assign(lt.thm[ut]),lr>2&&n()}for(ut=0;ut<lr;ut++){var kl,Tl,Ir=s(12),gn=[0,0,0,0],xo=s(12),Rl=1,Dl,Al=s(_.CBANDS),Il=s(_.CBANDS),Qt=[0,0,0,0],Bl=s(_.HBLKSIZE),Ol=u([3,_.HBLKSIZE_s]);for(ht=0;ht<3;ht++)Ir[ht]=lt.nsPsy.last_en_subshort[ut][ht+6],xo[ht]=Ir[ht]/lt.nsPsy.last_en_subshort[ut][ht+4],gn[0]+=Ir[ht];ut==2&&n();{var Pl=fi[ut&1],Sa=0;for(ht=0;ht<9;ht++){for(var Gf=Sa+64,dr=1;Sa<Gf;Sa++)dr<Math.abs(Pl[Sa])&&(dr=Math.abs(Pl[Sa]));lt.nsPsy.last_en_subshort[ut][ht]=Ir[ht+3]=dr,gn[1+ht/3]+=dr,dr>Ir[ht+3-2]?dr=dr/Ir[ht+3-2]:Ir[ht+3-2]>dr*10?dr=Ir[ht+3-2]/(dr*10):dr=0,xo[ht+3]=dr}}for(Ie.analysis&&n(),Dl=ut==3?lt.nsPsy.attackthre_s:lt.nsPsy.attackthre,ht=0;ht<12;ht++)Qt[ht/3]==0&&xo[ht]>Dl&&(Qt[ht/3]=ht%3+1);for(ht=1;ht<4;ht++){var So;gn[ht-1]>gn[ht]?So=gn[ht-1]/gn[ht]:So=gn[ht]/gn[ht-1],So<1.7&&(Qt[ht]=0,ht==1&&(Qt[0]=0))}for(Qt[0]!=0&&lt.nsPsy.lastAttacks[ut]!=0&&(Qt[0]=0),(lt.nsPsy.lastAttacks[ut]==3||Qt[0]+Qt[1]+Qt[2]+Qt[3]!=0)&&(Rl=0,Qt[1]!=0&&Qt[0]!=0&&(Qt[1]=0),Qt[2]!=0&&Qt[1]!=0&&(Qt[2]=0),Qt[3]!=0&&Qt[2]!=0&&(Qt[3]=0)),ut<2?$t[ut]=Rl:n(),ot[ut]=lt.tot_ener[ut],Tl=Rt,kl=Vt,U(Ie,Bl,Ol,kl,ut&1,Tl,ut&1,it,ut,_e,Re),Ae(lt,Bl,zt,Al,Il),Qe(lt,Al,Il,Rn),Ot=0;Ot<3;Ot++){var wo,Mr;for(E(Ie,Ol,Xt,It,ut,Ot),de(lt,Xt,It,ut,Ot),Er=0;Er<_.SBMAX_s;Er++){if(Mr=lt.thm[ut].s[Er][Ot],Mr*=Be,Qt[Ot]>=2||Qt[Ot+1]==1){var wa=Ot!=0?Ot-1:2,dr=ge(lt.thm[ut].s[Er][wa],Mr,te*Ar);Mr=Math.min(Mr,dr)}if(Qt[Ot]==1){var wa=Ot!=0?Ot-1:2,dr=ge(lt.thm[ut].s[Er][wa],Mr,Le*Ar);Mr=Math.min(Mr,dr)}else if(Ot!=0&&Qt[Ot-1]==3||Ot==0&&lt.nsPsy.lastAttacks[ut]==3){var wa=Ot!=2?Ot+1:0,dr=ge(lt.thm[ut].s[Er][wa],Mr,Le*Ar);Mr=Math.min(Mr,dr)}wo=Ir[Ot*3+3]+Ir[Ot*3+4]+Ir[Ot*3+5],Ir[Ot*3+5]*6<wo&&(Mr*=.5,Ir[Ot*3+4]*6<wo&&(Mr*=.5)),lt.thm[ut].s[Er][Ot]=Mr}}for(lt.nsPsy.lastAttacks[ut]=Qt[2],hn=0,wt=0;wt<lt.npart_l;wt++){for(var Dn=lt.s3ind[wt][0],Co=zt[Dn]*w[Rn[Dn]],An=lt.s3_ll[hn++]*Co;++Dn<=lt.s3ind[wt][1];)Co=zt[Dn]*w[Rn[Dn]],An=q(An,lt.s3_ll[hn++]*Co,Dn,Dn-wt,lt);An*=.158489319246111,lt.blocktype_old[ut&1]==_.SHORT_TYPE?It[wt]=An:It[wt]=ge(Math.min(An,Math.min(me*lt.nb_1[ut][wt],J*lt.nb_2[ut][wt])),An,Ar),lt.nb_2[ut][wt]=lt.nb_1[ut][wt],lt.nb_1[ut][wt]=An}for(;wt<=_.CBANDS;++wt)zt[wt]=0,It[wt]=0;x(lt,zt,It,ut)}for((Ie.mode==S.STEREO||Ie.mode==S.JOINT_STEREO)&&n(),Ie.mode==S.JOINT_STEREO&&n(),ke(Ie,$t,St,mt),ut=0;ut<lr;ut++){var di,vi=0,Ll,Eo;ut>1?n():(di=et,vi=0,Ll=St[ut],Eo=nt[it][ut]),Ll==_.SHORT_TYPE?di[vi+ut]=Ve(Eo,lt.masking_lower):di[vi+ut]=ee(Eo,lt.masking_lower),Ie.analysis&&(lt.pinfo.pe[it][ut]=di[vi+ut])}return 0};function kt(Ie){var _e,Re,it,nt;return _e=Ie,_e>=0?_e*=3:_e*=1.5,_e>=.5&&_e<=2.5?(nt=_e-.5,Re=8*(nt*nt-2*nt)):Re=0,_e+=.474,it=15.811389+7.5*_e-17.5*Math.sqrt(1+_e*_e),it<=-60?0:(_e=Math.exp((Re+it)*m),_e/=.6609193,_e)}function Lt(Ie){return Ie<0&&(Ie=0),Ie=Ie*.001,13*Math.atan(.76*Ie)+3.5*Math.atan(Ie*Ie/(7.5*7.5))}function Dt(Ie,_e,Re,it,nt,We,et,tt,ot,St,lt,Vt){var Rt=s(_.CBANDS+1),zt=tt/(Vt>15?2*576:2*192),Xt=o(_.HBLKSIZE),It;tt/=ot;var mt=0,$t=0;for(It=0;It<_.CBANDS;It++){var lr,ut;for(lr=Lt(tt*mt),Rt[It]=tt*mt,ut=mt;Lt(tt*ut)-lr<ie&&ut<=ot/2;ut++);for(Ie[It]=ut-mt,$t=It+1;mt<ut;)Xt[mt++]=It;if(mt>ot/2){mt=ot/2,++It;break}}Rt[It]=tt*mt;for(var wt=0;wt<Vt;wt++){var ht,Gt,hn,Er,Ot;hn=St[wt],Er=St[wt+1],ht=0|Math.floor(.5+lt*(hn-.5)),ht<0&&(ht=0),Gt=0|Math.floor(.5+lt*(Er-.5)),Gt>ot/2&&(Gt=ot/2),Re[wt]=(Xt[ht]+Xt[Gt])/2,_e[wt]=Xt[Gt];var fi=zt*Er;et[wt]=(fi-Rt[_e[wt]])/(Rt[_e[wt]+1]-Rt[_e[wt]]),et[wt]<0?et[wt]=0:et[wt]>1&&(et[wt]=1),Ot=Lt(tt*St[wt]*lt),Ot=Math.min(Ot,15.5)/15.5,We[wt]=Math.pow(10,1.25*(1-Math.cos(Math.PI*Ot))-2.5)}mt=0;for(var Ar=0;Ar<$t;Ar++){var Rn=Ie[Ar],lr,Jn;lr=Lt(tt*mt),Jn=Lt(tt*(mt+Rn-1)),it[Ar]=.5*(lr+Jn),lr=Lt(tt*(mt-.5)),Jn=Lt(tt*(mt+Rn-.5)),nt[Ar]=Jn-lr,mt+=Rn}return $t}function Ft(Ie,_e,Re,it,nt,We){var et=u([_.CBANDS,_.CBANDS]),tt,ot=0;if(We)for(var St=0;St<_e;St++)for(tt=0;tt<_e;tt++){var lt=kt(Re[St]-Re[tt])*it[tt];et[St][tt]=lt*nt[St]}else n();for(var St=0;St<_e;St++){for(tt=0;tt<_e&&!(et[St][tt]>0);tt++);for(Ie[St][0]=tt,tt=_e-1;tt>0&&!(et[St][tt]>0);tt--);Ie[St][1]=tt,ot+=Ie[St][1]-Ie[St][0]+1}for(var Vt=s(ot),Rt=0,St=0;St<_e;St++)for(tt=Ie[St][0];tt<=Ie[St][1];tt++)Vt[Rt++]=et[St][tt];return Vt}function qt(Ie){var _e=Lt(Ie);return _e=Math.min(_e,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*_e))-2.5)}this.psymodel_init=function(Ie){var _e=Ie.internal_flags,Re,it=!0,nt=13,We=24,et=0,tt=0,ot=-8.25,St=-4.5,lt=s(_.CBANDS),Vt=s(_.CBANDS),Rt=s(_.CBANDS),zt=Ie.out_samplerate;switch(Ie.experimentalZ){default:case 0:it=!0;break;case 1:it=!(Ie.VBR==y.vbr_mtrh||Ie.VBR==y.vbr_mt);break;case 2:it=!1;break;case 3:nt=8,et=-1.75,tt=-.0125,ot=-8.25,St=-2.25;break}for(_e.ms_ener_ratio_old=.25,_e.blocktype_old[0]=_e.blocktype_old[1]=_.NORM_TYPE,Re=0;Re<4;++Re){for(var mt=0;mt<_.CBANDS;++mt)_e.nb_1[Re][mt]=1e20,_e.nb_2[Re][mt]=1e20,_e.nb_s1[Re][mt]=_e.nb_s2[Re][mt]=1;for(var Xt=0;Xt<_.SBMAX_l;Xt++)_e.en[Re].l[Xt]=1e20,_e.thm[Re].l[Xt]=1e20;for(var mt=0;mt<3;++mt){for(var Xt=0;Xt<_.SBMAX_s;Xt++)_e.en[Re].s[Xt][mt]=1e20,_e.thm[Re].s[Xt][mt]=1e20;_e.nsPsy.lastAttacks[Re]=0}for(var mt=0;mt<9;mt++)_e.nsPsy.last_en_subshort[Re][mt]=10}for(_e.loudness_sq_save[0]=_e.loudness_sq_save[1]=0,_e.npart_l=Dt(_e.numlines_l,_e.bo_l,_e.bm_l,lt,Vt,_e.mld_l,_e.PSY.bo_l_weight,zt,_.BLKSIZE,_e.scalefac_band.l,_.BLKSIZE/(2*576),_.SBMAX_l),Re=0;Re<_e.npart_l;Re++){var It=et;lt[Re]>=nt&&(It=tt*(lt[Re]-nt)/(We-nt)+et*(We-lt[Re])/(We-nt)),Rt[Re]=Math.pow(10,It/10),_e.numlines_l[Re]>0?_e.rnumlines_l[Re]=1/_e.numlines_l[Re]:_e.rnumlines_l[Re]=0}_e.s3_ll=Ft(_e.s3ind,_e.npart_l,lt,Vt,Rt,it);var mt=0;for(Re=0;Re<_e.npart_l;Re++){var $t;$t=b.MAX_VALUE;for(var lr=0;lr<_e.numlines_l[Re];lr++,mt++){var ut=zt*mt/(1e3*_.BLKSIZE),wt;wt=this.ATHformula(ut*1e3,Ie)-20,wt=Math.pow(10,.1*wt),wt*=_e.numlines_l[Re],$t>wt&&($t=wt)}_e.ATH.cb_l[Re]=$t,$t=-20+lt[Re]*20/10,$t>6&&($t=100),$t<-15&&($t=-15),$t-=8,_e.minval_l[Re]=Math.pow(10,$t/10)*_e.numlines_l[Re]}for(_e.npart_s=Dt(_e.numlines_s,_e.bo_s,_e.bm_s,lt,Vt,_e.mld_s,_e.PSY.bo_s_weight,zt,_.BLKSIZE_s,_e.scalefac_band.s,_.BLKSIZE_s/(2*192),_.SBMAX_s),mt=0,Re=0;Re<_e.npart_s;Re++){var $t,It=ot;lt[Re]>=nt&&(It=St*(lt[Re]-nt)/(We-nt)+ot*(We-lt[Re])/(We-nt)),Rt[Re]=Math.pow(10,It/10),$t=b.MAX_VALUE;for(var lr=0;lr<_e.numlines_s[Re];lr++,mt++){var ut=zt*mt/(1e3*_.BLKSIZE_s),wt;wt=this.ATHformula(ut*1e3,Ie)-20,wt=Math.pow(10,.1*wt),wt*=_e.numlines_s[Re],$t>wt&&($t=wt)}_e.ATH.cb_s[Re]=$t,$t=-7+lt[Re]*7/12,lt[Re]>12&&($t*=1+Math.log(1+$t)*3.1),lt[Re]<12&&($t*=1+Math.log(1-$t)*2.3),$t<-15&&($t=-15),$t-=8,_e.minval_s[Re]=Math.pow(10,$t/10)*_e.numlines_s[Re]}_e.s3_ss=Ft(_e.s3ind_s,_e.npart_s,lt,Vt,Rt,it),ye(),V.init_fft(_e),_e.decay=Math.exp(-1*pe/(he*zt/192));{var ht;ht=le,Ie.exp_nspsytune&2&&(ht=1),Math.abs(Ie.msfix)>0&&(ht=Ie.msfix),Ie.msfix=ht;for(var Gt=0;Gt<_e.npart_l;Gt++)_e.s3ind[Gt][1]>_e.npart_l-1&&(_e.s3ind[Gt][1]=_e.npart_l-1)}var hn=576*_e.mode_gr/zt;if(_e.ATH.decay=Math.pow(10,-12/10*hn),_e.ATH.adjust=.01,_e.ATH.adjustLimit=1,Ie.ATHtype!=-1){var ut,Er=Ie.out_samplerate/_.BLKSIZE,Ot=0;for(ut=0,Re=0;Re<_.BLKSIZE/2;++Re)ut+=Er,_e.ATH.eql_w[Re]=1/Math.pow(10,this.ATHformula(ut,Ie)/10),Ot+=_e.ATH.eql_w[Re];for(Ot=1/Ot,Re=_.BLKSIZE/2;--Re>=0;)_e.ATH.eql_w[Re]*=Ot}{for(var Gt=mt=0;Gt<_e.npart_s;++Gt)for(Re=0;Re<_e.numlines_s[Gt];++Re)++mt;for(var Gt=mt=0;Gt<_e.npart_l;++Gt)for(Re=0;Re<_e.numlines_l[Gt];++Re)++mt}for(mt=0,Re=0;Re<_e.npart_l;Re++){var ut=zt*(mt+_e.numlines_l[Re]/2)/(1*_.BLKSIZE);_e.mld_cb_l[Re]=qt(ut),mt+=_e.numlines_l[Re]}for(;Re<_.CBANDS;++Re)_e.mld_cb_l[Re]=1;for(mt=0,Re=0;Re<_e.npart_s;Re++){var ut=zt*(mt+_e.numlines_s[Re]/2)/(1*_.BLKSIZE_s);_e.mld_cb_s[Re]=qt(ut),mt+=_e.numlines_s[Re]}for(;Re<_.CBANDS;++Re)_e.mld_cb_s[Re]=1;return 0};function Wr(Ie,_e){Ie<-.3&&(Ie=3410),Ie/=1e3,Ie=Math.max(.1,Ie);var Re=3.64*Math.pow(Ie,-.8)-6.8*Math.exp(-.6*Math.pow(Ie-3.4,2))+6*Math.exp(-.15*Math.pow(Ie-8.7,2))+(.6+.04*_e)*.001*Math.pow(Ie,4);return Re}this.ATHformula=function(Ie,_e){var Re;switch(_e.ATHtype){case 0:Re=Wr(Ie,9);break;case 1:Re=Wr(Ie,-1);break;case 2:Re=Wr(Ie,0);break;case 3:Re=Wr(Ie,1)+6;break;case 4:Re=Wr(Ie,_e.ATHcurve);break;default:Re=Wr(Ie,0);break}return Re}}function Fe(){var V=this,pe=128*1024;Fe.V9=410,Fe.V8=420,Fe.V7=430,Fe.V6=440,Fe.V5=450,Fe.V4=460,Fe.V3=470,Fe.V2=480,Fe.V1=490,Fe.V0=500,Fe.R3MIX=1e3,Fe.STANDARD=1001,Fe.EXTREME=1002,Fe.INSANE=1003,Fe.STANDARD_FAST=1004,Fe.EXTREME_FAST=1005,Fe.MEDIUM=1006,Fe.MEDIUM_FAST=1007;var me=16384+pe;Fe.LAME_MAXMP3BUFFER=me;var J,$e,K,ie,Oe,he=new je,Be,te;this.enc=new _,this.setModules=function(x,E,ke,ge,Ee,Ve,qe,ee,Ae){J=x,$e=E,K=ke,ie=ge,Oe=Ee,Be=Ve,te=ee,this.enc.setModules($e,he,ie,Be)};function Le(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=s(_.SBMAX_l),this.bo_s_weight=s(_.SBMAX_s)}function le(){this.lowerlimit=0}function ae(x,E){this.lowpass=E}var m=4294479419;function R(x){var E;return x.class_id=m,E=x.internal_flags=new He,x.mode=S.NOT_SET,x.original=1,x.in_samplerate=44100,x.num_channels=2,x.num_samples=-1,x.bWriteVbrTag=!0,x.quality=-1,x.short_blocks=null,E.subblock_gain=-1,x.lowpassfreq=0,x.highpassfreq=0,x.lowpasswidth=-1,x.highpasswidth=-1,x.VBR=y.vbr_off,x.VBR_q=4,x.ATHcurve=-1,x.VBR_mean_bitrate_kbps=128,x.VBR_min_bitrate_kbps=0,x.VBR_max_bitrate_kbps=0,x.VBR_hard_min=0,E.VBR_min_bitrate=1,E.VBR_max_bitrate=13,x.quant_comp=-1,x.quant_comp_short=-1,x.msfix=-1,E.resample_ratio=1,E.OldValue[0]=180,E.OldValue[1]=180,E.CurrentStep[0]=4,E.CurrentStep[1]=4,E.masking_lower=1,E.nsPsy.attackthre=-1,E.nsPsy.attackthre_s=-1,x.scale=-1,x.athaa_type=-1,x.ATHtype=-1,x.athaa_loudapprox=-1,x.athaa_sensitivity=0,x.useTemporal=null,x.interChRatio=-1,E.mf_samples_to_encode=_.ENCDELAY+_.POSTDELAY,x.encoder_padding=0,E.mf_size=_.ENCDELAY-_.MDCTDELAY,x.findReplayGain=!1,x.decode_on_the_fly=!1,E.decode_on_the_fly=!1,E.findReplayGain=!1,E.findPeakSample=!1,E.RadioGain=0,E.AudiophileGain=0,E.noclipGainChange=0,E.noclipScale=-1,x.preset=0,x.write_id3tag_automatic=!0,0}this.lame_init=function(){var x=new Ue;return R(x),x.lame_allocated_gfp=1,x};function U(x){return x>1?0:x<=0?1:Math.cos(Math.PI/2*x)}this.nearestBitrateFullIndex=function(x){var E=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],ke=0,ge=0,Ee=0,Ve=0;Ve=E[16],Ee=16,ge=E[16],ke=16;for(var qe=0;qe<16;qe++)if(Math.max(x,E[qe+1])!=x){Ve=E[qe+1],Ee=qe+1,ge=E[qe],ke=qe;break}return Ve-x>x-ge?ke:Ee};function ne(x,E){switch(x){case 44100:return E.version=1,0;case 48e3:return E.version=1,1;case 32e3:return E.version=1,2;case 22050:return E.version=0,0;case 24e3:return E.version=0,1;case 16e3:return E.version=0,2;case 11025:return E.version=0,0;case 12e3:return E.version=0,1;case 8e3:return E.version=0,2;default:return E.version=0,-1}}function z(x,E,ke){ke<16e3&&(E=2);for(var ge=M.bitrate_table[E][1],Ee=2;Ee<=14;Ee++)M.bitrate_table[E][Ee]>0&&Math.abs(M.bitrate_table[E][Ee]-x)<Math.abs(ge-x)&&(ge=M.bitrate_table[E][Ee]);return ge}function I(x,E,ke){ke<16e3&&(E=2);for(var ge=0;ge<=14;ge++)if(M.bitrate_table[E][ge]>0&&M.bitrate_table[E][ge]==x)return ge;return-1}function N(x,E){var ke=[new ae(8,2e3),new ae(16,3700),new ae(24,3900),new ae(32,5500),new ae(40,7e3),new ae(48,7500),new ae(56,1e4),new ae(64,11e3),new ae(80,13500),new ae(96,15100),new ae(112,15600),new ae(128,17e3),new ae(160,17500),new ae(192,18600),new ae(224,19400),new ae(256,19700),new ae(320,20500)],ge=V.nearestBitrateFullIndex(E);x.lowerlimit=ke[ge].lowpass}function k(x){var E=x.internal_flags,ke=32;if(E.lowpass1>0){for(var ge=999,Ee=0;Ee<=31;Ee++){var Ve=Ee/31;Ve>=E.lowpass2&&(ke=Math.min(ke,Ee)),E.lowpass1<Ve&&Ve<E.lowpass2&&(ge=Math.min(ge,Ee))}ge==999?E.lowpass1=(ke-.75)/31:E.lowpass1=(ge-.75)/31,E.lowpass2=ke/31}E.highpass2>0&&n(),E.highpass2>0&&n();for(var Ee=0;Ee<32;Ee++){var qe,ee,Ve=Ee/31;E.highpass2>E.highpass1?n():qe=1,E.lowpass2>E.lowpass1?ee=U((Ve-E.lowpass1)/(E.lowpass2-E.lowpass1+1e-20)):ee=1,E.amp_filter[Ee]=qe*ee}}function Q(x){var E=x.internal_flags;switch(x.quality){default:case 9:E.psymodel=0,E.noise_shaping=0,E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.use_best_huffman=0,E.full_outer_loop=0;break;case 8:x.quality=7;case 7:E.psymodel=1,E.noise_shaping=0,E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.use_best_huffman=0,E.full_outer_loop=0;break;case 6:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=0,E.full_outer_loop=0;break;case 5:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=0,E.full_outer_loop=0;break;case 4:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 3:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=1,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 2:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.substep_shaping==0&&(E.substep_shaping=2),E.noise_shaping_amp=1,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 1:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.substep_shaping==0&&(E.substep_shaping=2),E.noise_shaping_amp=2,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 0:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.substep_shaping==0&&(E.substep_shaping=2),E.noise_shaping_amp=2,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break}}function w(x){var E=x.internal_flags;x.frameNum=0,x.write_id3tag_automatic&&te.id3tag_write_v2(x),E.bitrate_stereoMode_Hist=c([16,5]),E.bitrate_blockType_Hist=c([16,6]),E.PeakSample=0,x.bWriteVbrTag&&Be.InitVbrTag(x)}this.lame_init_params=function(x){var E=x.internal_flags;if(E.Class_ID=0,E.ATH==null&&(E.ATH=new ze),E.PSY==null&&(E.PSY=new Le),E.rgdata==null&&(E.rgdata=new Ne),E.channels_in=x.num_channels,E.channels_in==1&&(x.mode=S.MONO),E.channels_out=x.mode==S.MONO?1:2,E.mode_ext=_.MPG_MD_MS_LR,x.mode==S.MONO&&(x.force_ms=!1),x.VBR==y.vbr_off&&x.VBR_mean_bitrate_kbps!=128&&x.brate==0&&(x.brate=x.VBR_mean_bitrate_kbps),x.VBR==y.vbr_off||x.VBR==y.vbr_mtrh||x.VBR==y.vbr_mt||(x.free_format=!1),x.VBR==y.vbr_off&&x.brate==0&&n(),x.VBR==y.vbr_off&&x.compression_ratio>0&&n(),x.out_samplerate!=0&&(x.out_samplerate<16e3?(x.VBR_mean_bitrate_kbps=Math.max(x.VBR_mean_bitrate_kbps,8),x.VBR_mean_bitrate_kbps=Math.min(x.VBR_mean_bitrate_kbps,64)):x.out_samplerate<32e3?(x.VBR_mean_bitrate_kbps=Math.max(x.VBR_mean_bitrate_kbps,8),x.VBR_mean_bitrate_kbps=Math.min(x.VBR_mean_bitrate_kbps,160)):(x.VBR_mean_bitrate_kbps=Math.max(x.VBR_mean_bitrate_kbps,32),x.VBR_mean_bitrate_kbps=Math.min(x.VBR_mean_bitrate_kbps,320))),x.lowpassfreq==0){var ke=16e3;switch(x.VBR){case y.vbr_off:{var ge=new le;N(ge,x.brate),ke=ge.lowerlimit;break}case y.vbr_abr:{var ge=new le;N(ge,x.VBR_mean_bitrate_kbps),ke=ge.lowerlimit;break}case y.vbr_rh:n();default:n()}x.mode==S.MONO&&(x.VBR==y.vbr_off||x.VBR==y.vbr_abr)&&(ke*=1.5),x.lowpassfreq=ke|0}switch(x.out_samplerate==0&&n(),x.lowpassfreq=Math.min(20500,x.lowpassfreq),x.lowpassfreq=Math.min(x.out_samplerate/2,x.lowpassfreq),x.VBR==y.vbr_off&&(x.compression_ratio=x.out_samplerate*16*E.channels_out/(1e3*x.brate)),x.VBR==y.vbr_abr&&n(),x.bWriteVbrTag||(x.findReplayGain=!1,x.decode_on_the_fly=!1,E.findPeakSample=!1),E.findReplayGain=x.findReplayGain,E.decode_on_the_fly=x.decode_on_the_fly,E.decode_on_the_fly&&(E.findPeakSample=!0),E.findReplayGain&&n(),E.decode_on_the_fly&&!x.decode_only&&n(),E.mode_gr=x.out_samplerate<=24e3?1:2,x.framesize=576*E.mode_gr,x.encoder_delay=_.ENCDELAY,E.resample_ratio=x.in_samplerate/x.out_samplerate,x.VBR){case y.vbr_mt:case y.vbr_rh:case y.vbr_mtrh:{var Ee=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];x.compression_ratio=Ee[x.VBR_q]}break;case y.vbr_abr:x.compression_ratio=x.out_samplerate*16*E.channels_out/(1e3*x.VBR_mean_bitrate_kbps);break;default:x.compression_ratio=x.out_samplerate*16*E.channels_out/(1e3*x.brate);break}x.mode==S.NOT_SET&&(x.mode=S.JOINT_STEREO),x.highpassfreq>0?n():(E.highpass1=0,E.highpass2=0),x.lowpassfreq>0?(E.lowpass2=2*x.lowpassfreq,x.lowpasswidth>=0?n():E.lowpass1=1*2*x.lowpassfreq,E.lowpass1/=x.out_samplerate,E.lowpass2/=x.out_samplerate):n(),k(x),E.samplerate_index=ne(x.out_samplerate,x),E.samplerate_index<0&&n(),x.VBR==y.vbr_off?x.free_format?E.bitrate_index=0:(x.brate=z(x.brate,x.version,x.out_samplerate),E.bitrate_index=I(x.brate,x.version,x.out_samplerate),E.bitrate_index<=0&&n()):E.bitrate_index=1,x.analysis&&(x.bWriteVbrTag=!1),E.pinfo!=null&&(x.bWriteVbrTag=!1),$e.init_bit_stream_w(E);for(var Ve=E.samplerate_index+3*x.version+6*(x.out_samplerate<16e3?1:0),qe=0;qe<_.SBMAX_l+1;qe++)E.scalefac_band.l[qe]=ie.sfBandIndex[Ve].l[qe];for(var qe=0;qe<_.PSFB21+1;qe++){var ee=(E.scalefac_band.l[22]-E.scalefac_band.l[21])/_.PSFB21,Ae=E.scalefac_band.l[21]+qe*ee;E.scalefac_band.psfb21[qe]=Ae}E.scalefac_band.psfb21[_.PSFB21]=576;for(var qe=0;qe<_.SBMAX_s+1;qe++)E.scalefac_band.s[qe]=ie.sfBandIndex[Ve].s[qe];for(var qe=0;qe<_.PSFB12+1;qe++){var ee=(E.scalefac_band.s[13]-E.scalefac_band.s[12])/_.PSFB12,Ae=E.scalefac_band.s[12]+qe*ee;E.scalefac_band.psfb12[qe]=Ae}E.scalefac_band.psfb12[_.PSFB12]=192,x.version==1?E.sideinfo_len=E.channels_out==1?21:36:E.sideinfo_len=E.channels_out==1?13:21,x.error_protection&&(E.sideinfo_len+=2),w(x),E.Class_ID=m;{var Qe;for(Qe=0;Qe<19;Qe++)E.nsPsy.pefirbuf[Qe]=700*E.mode_gr*E.channels_out;x.ATHtype==-1&&(x.ATHtype=4)}switch(x.VBR){case y.vbr_mt:x.VBR=y.vbr_mtrh;case y.vbr_mtrh:{x.useTemporal==null&&(x.useTemporal=!1),K.apply_preset(x,500-x.VBR_q*10,0),x.quality<0&&(x.quality=LAME_DEFAULT_QUALITY),x.quality<5&&(x.quality=0),x.quality>5&&(x.quality=5),E.PSY.mask_adjust=x.maskingadjust,E.PSY.mask_adjust_short=x.maskingadjust_short,x.experimentalY?E.sfb21_extra=!1:E.sfb21_extra=x.out_samplerate>44e3,E.iteration_loop=new VBRNewIterationLoop(Oe);break}case y.vbr_rh:{K.apply_preset(x,500-x.VBR_q*10,0),E.PSY.mask_adjust=x.maskingadjust,E.PSY.mask_adjust_short=x.maskingadjust_short,x.experimentalY?E.sfb21_extra=!1:E.sfb21_extra=x.out_samplerate>44e3,x.quality>6&&(x.quality=6),x.quality<0&&(x.quality=LAME_DEFAULT_QUALITY),E.iteration_loop=new VBROldIterationLoop(Oe);break}default:{var st;E.sfb21_extra=!1,x.quality<0&&(x.quality=LAME_DEFAULT_QUALITY),st=x.VBR,st==y.vbr_off&&(x.VBR_mean_bitrate_kbps=x.brate),K.apply_preset(x,x.VBR_mean_bitrate_kbps,0),x.VBR=st,E.PSY.mask_adjust=x.maskingadjust,E.PSY.mask_adjust_short=x.maskingadjust_short,st==y.vbr_off?E.iteration_loop=new Ge(Oe):n();break}}return x.VBR!=y.vbr_off&&n(),x.tune&&n(),Q(x),x.athaa_type<0?E.ATH.useAdjust=3:E.ATH.useAdjust=x.athaa_type,E.ATH.aaSensitivityP=Math.pow(10,x.athaa_sensitivity/-10),x.short_blocks==null&&(x.short_blocks=g.short_block_allowed),x.short_blocks==g.short_block_allowed&&(x.mode==S.JOINT_STEREO||x.mode==S.STEREO)&&(x.short_blocks=g.short_block_coupled),x.quant_comp<0&&(x.quant_comp=1),x.quant_comp_short<0&&(x.quant_comp_short=0),x.msfix<0&&(x.msfix=0),x.exp_nspsytune=x.exp_nspsytune|1,x.internal_flags.nsPsy.attackthre<0&&(x.internal_flags.nsPsy.attackthre=je.NSATTACKTHRE),x.internal_flags.nsPsy.attackthre_s<0&&(x.internal_flags.nsPsy.attackthre_s=je.NSATTACKTHRE_S),x.scale<0&&(x.scale=1),x.ATHtype<0&&(x.ATHtype=4),x.ATHcurve<0&&(x.ATHcurve=4),x.athaa_loudapprox<0&&(x.athaa_loudapprox=2),x.interChRatio<0&&(x.interChRatio=0),x.useTemporal==null&&(x.useTemporal=!0),E.slot_lag=E.frac_SpF=0,x.VBR==y.vbr_off&&(E.slot_lag=E.frac_SpF=(x.version+1)*72e3*x.brate%x.out_samplerate|0),ie.iteration_init(x),he.psymodel_init(x),0};function ye(x,E){(x.in_buffer_0==null||x.in_buffer_nsamples<E)&&(x.in_buffer_0=s(E),x.in_buffer_1=s(E),x.in_buffer_nsamples=E)}this.lame_encode_flush=function(x,E,ke,ge){var Ee=x.internal_flags,Ve=f([2,1152]),qe=0,ee,Ae,Qe,st,kt=Ee.mf_samples_to_encode-_.POSTDELAY,Lt=O(x);if(Ee.mf_samples_to_encode<1)return 0;for(ee=0,x.in_samplerate!=x.out_samplerate&&n(),Qe=x.framesize-kt%x.framesize,Qe<576&&(Qe+=x.framesize),x.encoder_padding=Qe,st=(kt+Qe)/x.framesize;st>0&&qe>=0;){var Dt=Lt-Ee.mf_size,Ft=x.frameNum;Dt*=x.in_samplerate,Dt/=x.out_samplerate,Dt>1152&&(Dt=1152),Dt<1&&(Dt=1),Ae=ge-ee,ge==0&&(Ae=0),qe=this.lame_encode_buffer(x,Ve[0],Ve[1],Dt,E,ke,Ae),ke+=qe,ee+=qe,st-=Ft!=x.frameNum?1:0}return Ee.mf_samples_to_encode=0,qe<0||(Ae=ge-ee,ge==0&&(Ae=0),$e.flush_bitstream(x),qe=$e.copy_buffer(Ee,E,ke,Ae,1),qe<0)?qe:(ke+=qe,ee+=qe,Ae=ge-ee,ge==0&&(Ae=0),x.write_id3tag_automatic&&n(),ee)},this.lame_encode_buffer=function(x,E,ke,ge,Ee,Ve,qe){var ee=x.internal_flags,Ae=[null,null];if(ee.Class_ID!=m)return-3;if(ge==0)return 0;ye(ee,ge),Ae[0]=ee.in_buffer_0,Ae[1]=ee.in_buffer_1;for(var Qe=0;Qe<ge;Qe++)Ae[0][Qe]=E[Qe],ee.channels_in>1&&(Ae[1][Qe]=ke[Qe]);return $(x,Ae[0],Ae[1],ge,Ee,Ve,qe)};function O(x){var E=_.BLKSIZE+x.framesize-_.FFTOFFSET;return E=Math.max(E,512+x.framesize-32),E}function $(x,E,ke,ge,Ee,Ve,qe){var ee=x.internal_flags,Ae=0,Qe,st,kt,Lt,Dt,Ft=[null,null],qt=[null,null];if(ee.Class_ID!=m)return-3;if(ge==0)return 0;if(Dt=$e.copy_buffer(ee,Ee,Ve,qe,0),Dt<0)return Dt;if(Ve+=Dt,Ae+=Dt,qt[0]=E,qt[1]=ke,L.NEQ(x.scale,0)&&L.NEQ(x.scale,1))for(st=0;st<ge;++st)qt[0][st]*=x.scale,ee.channels_out==2&&(qt[1][st]*=x.scale);if(L.NEQ(x.scale_left,0)&&L.NEQ(x.scale_left,1))for(st=0;st<ge;++st)qt[0][st]*=x.scale_left;if(L.NEQ(x.scale_right,0)&&L.NEQ(x.scale_right,1))for(st=0;st<ge;++st)qt[1][st]*=x.scale_right;x.num_channels==2&&ee.channels_out==1&&n(),Lt=O(x),Ft[0]=ee.mfbuf[0],Ft[1]=ee.mfbuf[1];for(var Wr=0;ge>0;){var Ie=[null,null],_e=0,Re=0;Ie[0]=qt[0],Ie[1]=qt[1];var it=new q;if(de(x,Ft,Ie,Wr,ge,it),_e=it.n_in,Re=it.n_out,ee.findReplayGain&&!ee.decode_on_the_fly&&J.AnalyzeSamples(ee.rgdata,Ft[0],ee.mf_size,Ft[1],ee.mf_size,Re,ee.channels_out)==D.GAIN_ANALYSIS_ERROR)return-6;if(ge-=_e,Wr+=_e,ee.channels_out==2,ee.mf_size+=Re,ee.mf_samples_to_encode<1&&n(),ee.mf_samples_to_encode+=Re,ee.mf_size>=Lt){var nt=qe-Ae;if(qe==0&&(nt=0),Qe=H(x,Ft[0],Ft[1],Ee,Ve,nt),Qe<0)return Qe;for(Ve+=Qe,Ae+=Qe,ee.mf_size-=x.framesize,ee.mf_samples_to_encode-=x.framesize,kt=0;kt<ee.channels_out;kt++)for(st=0;st<ee.mf_size;st++)Ft[kt][st]=Ft[kt][st+x.framesize]}}return Ae}function H(x,E,ke,ge,Ee,Ve){var qe=V.enc.lame_encode_mp3_frame(x,E,ke,ge,Ee,Ve);return x.frameNum++,qe}function q(){this.n_in=0,this.n_out=0}function de(x,E,ke,ge,Ee,Ve){var qe=x.internal_flags;if(qe.resample_ratio<.9999||qe.resample_ratio>1.0001)n();else{Ve.n_out=Math.min(x.framesize,Ee),Ve.n_in=Ve.n_out;for(var ee=0;ee<Ve.n_out;++ee)E[0][qe.mf_size+ee]=ke[0][ge+ee],qe.channels_out==2&&(E[1][qe.mf_size+ee]=ke[1][ge+ee])}}}function pt(){this.setModules=function(V,pe){}}function Je(){this.setModules=function(V,pe,me){}}function at(){}function Ke(){this.setModules=function(V,pe){}}function yt(V,pe,me){V!=1&&n("fix cc: only supports mono");var J=new Fe,$e=new pt,K=new D,ie=new L,Oe=new P,he=new Pe,Be=new we,te=new W,Le=new C,le=new Ke,ae=new G,m=new T,R=new Je,U=new at;J.setModules(K,ie,Oe,he,Be,te,Le,le,U),ie.setModules(K,U,Le,te),le.setModules(ie,Le),Oe.setModules(J),Be.setModules(ie,ae,he,m),he.setModules(m,ae,J.enc.psy),ae.setModules(ie),m.setModules(he),te.setModules(J,ie,Le),$e.setModules(R,U),R.setModules(Le,le,Oe);var ne=J.lame_init();ne.num_channels=V,ne.in_samplerate=pe,ne.out_samplerate=pe,ne.brate=me,ne.mode=S.STEREO,ne.quality=3,ne.bWriteVbrTag=!1,ne.disable_reservoir=!0,ne.write_id3tag_automatic=!1,J.lame_init_params(ne);var z=1152,I=0|1.25*z+7200,N=a(I);this.encodeBuffer=function(k,Q){V==1&&(Q=k),k.length>z&&(z=k.length,I=0|1.25*z+7200,N=a(I));var w=J.lame_encode_buffer(ne,k,Q,k.length,N,0,I);return new Int8Array(N.subarray(0,w))},this.flush=function(){var k=J.lame_encode_flush(ne,N,0,I);return new Int8Array(N.subarray(0,k))}}j.SFBMAX=_.SBMAX_s*3,t.Mp3Encoder=yt}t(),e.lamejs=t});(function(e){var t=typeof window=="object"&&!!window.document,r=t?window:Object,n=r.Recorder,a=n.i18n;e(n,a,a.$T,t)})(function(e,t,r,n){var a=function(s){return new o(s)},i="WaveView",o=function(s){var l=this,u={scale:2,speed:9,phase:21.8,fps:20,keep:!0,lineWidth:3,linear1:[0,"rgba(150,96,238,1)",.2,"rgba(170,79,249,1)",1,"rgba(53,199,253,1)"],linear2:[0,"rgba(209,130,255,0.6)",1,"rgba(53,199,255,0.6)"],linearBg:[0,"rgba(255,255,255,0.2)",1,"rgba(54,197,252,0.2)"]};for(var c in s)u[c]=s[c];l.set=s=u;var f="compatibleCanvas";if(s[f])var d=l.canvas=s[f];else{if(!n)throw new Error(r.G("NonBrowser-1",[i]));var h=s.elem;h&&(typeof h=="string"?h=document.querySelector(h):h.length&&(h=h[0])),h&&(s.width=h.offsetWidth,s.height=h.offsetHeight);var v=l.elem=document.createElement("div");v.style.fontSize=0,v.innerHTML='<canvas style="width:100%;height:100%;"/>';var d=l.canvas=v.querySelector("canvas");h&&(h.innerHTML="",h.appendChild(v))}var p=s.scale,g=s.width*p,b=s.height*p;if(!g||!b)throw new Error(r.G("IllegalArgs-1",[i+" width=0 height=0"]));d.width=g,d.height=b;var y=l.ctx=d.getContext("2d");l.linear1=l.genLinear(y,g,s.linear1),l.linear2=l.genLinear(y,g,s.linear2),l.linearBg=l.genLinear(y,b,s.linearBg,!0),l._phase=0};o.prototype=a.prototype={genLinear:function(s,l,u,c){for(var f=s.createLinearGradient(0,0,c?0:l,c?l:0),d=0;d<u.length;)f.addColorStop(u[d++],u[d++]);return f},genPath:function(s,l,u){for(var c=[],f=this,d=f.set,h=d.scale,v=d.width*h,p=d.height*h/2,g=0;g<=v;g+=h){var b=(1+Math.cos(Math.PI+g/v*2*Math.PI))/2,y=b*p*l*Math.sin(2*Math.PI*(g/v)*s+u)+p;c.push(y)}return c},input:function(s,l,u){var c=this;c.sampleRate=u,c.pcmData=s,c.pcmPos=0,c.inputTime=Date.now(),c.schedule()},schedule:function(){var s=this,l=s.set,u=Math.floor(1e3/l.fps);s.timer||(s.timer=setInterval(function(){s.schedule()},u));var c=Date.now(),f=s.drawTime||0;if(!(c-f<u)){s.drawTime=c;for(var d=s.sampleRate/l.fps,h=s.pcmData,v=s.pcmPos,p=Math.max(0,Math.min(d,h.length-v)),g=0,b=0;b<p;b++,v++)g+=Math.abs(h[v]);s.pcmPos=v,(p||!l.keep)&&s.draw(e.PowerLevel(g,p)),!p&&c-s.inputTime>1300&&(clearInterval(s.timer),s.timer=0)}},draw:function(s){var l=this,u=l.set,c=l.ctx,f=u.scale,d=u.width*f,h=u.height*f,v=u.speed/u.fps,p=l._phase-=v,g=p+v*u.phase,b=s/100,y=l.genPath(2,b,p),S=l.genPath(1.8,b,g);c.clearRect(0,0,d,h),c.beginPath();for(var C=0,T=0;T<=d;C++,T+=f)T==0?c.moveTo(T,y[C]):c.lineTo(T,y[C]);C--;for(var T=d-1;T>=0;C--,T-=f)c.lineTo(T,S[C]);c.closePath(),c.fillStyle=l.linearBg,c.fill(),l.drawPath(S,l.linear2),l.drawPath(y,l.linear1)},drawPath:function(s,l){var u=this,c=u.set,f=u.ctx,d=c.scale,h=c.width*d;f.beginPath();for(var v=0,p=0;p<=h;v++,p+=d)p==0?f.moveTo(p,s[v]):f.lineTo(p,s[v]);f.lineWidth=c.lineWidth*d,f.strokeStyle=l,f.stroke()}},e[i]=a});const F4={class:"w-full h-full overflow-hidden flex flex-col gap-4"},$4={class:"flex-1 w-full overflow-auto"},N4={key:0,class:"text-xs text-left"},z4={class:"flex items-center w-full gap-2"},V4={class:"w-20 shrink-0"},H4={class:"flex-1"},G4={class:"flex items-center cursor-pointer gap-2"},W4=vt({__name:"SpeechGenerate",setup(e){const t=qn(),r=rt(!1),n=rt([]),a=hr({prompt:"",voiceUrl:""}),i=rt(""),o=rt(null),s=rt(),l=rt(!1),u=()=>{o.value=L4({type:"mp3",sampleRate:16e3,bitRate:16}),o.value.open(()=>{console.log("录音已打开"),o.value.start(),l.value=!0,console.log("已开始录音")},(p,g)=>{console.log((g?"UserNotAllow，":"")+"无法录音:"+p)})},c=()=>{if(!o.value){console.error("未打开录音");return}o.value.stop((p,g)=>{l.value=!1,s.value=p;var b=(window.URL||webkitURL).createObjectURL(p);console.log("录音成功",p,b,"时长:"+g+"ms"),o.value.close(),o.value=null},p=>{console.error("结束录音出错："+p),o.value.close(),o.value=null})},f=()=>{var p=URL.createObjectURL(s.value),g=document.createElement("audio");g.controls=!0,document.body.appendChild(g),g.src=p,g.play(),setTimeout(function(){URL.revokeObjectURL(g.src)},5e3)},d=()=>{if(!i.value){Zt.error("请先填写音色名称");return}Zt.info("前端模式下暂不支持音色克隆功能")},h=()=>{if(!a.prompt){Zt.error("请输入文字描述");return}Zt.info("前端模式下暂不支持AI语音生成功能")},v=()=>{n.value=[{voiceName:"默认音色1",voiceUrl:"default1"},{voiceName:"默认音色2",voiceUrl:"default2"}],n.value.push({voiceName:"自定义",voiceUrl:"custom"}),a.voiceUrl=n.value[0].voiceUrl};return Gr(()=>{v()}),(p,g)=>{const b=ci,y=to,S=eo,C=on,T=qa,D=rn,P=Ud,G=Ht,W=va,L=jd,X=qd,M=Kd,oe=sn;return se(),Te("div",F4,[ue("div",$4,[Z(b,{"list-data":B(t).speechList,type:"speech"},null,8,["list-data"])]),a.voiceUrl==="custom"?(se(),Te("div",N4," 朗读内容：清晨的阳光透过窗帘洒在桌上，温暖而明亮 ")):ct("",!0),Kt((se(),Te("div",z4,[ue("div",V4,[Z(S,{modelValue:a.voiceUrl,"onUpdate:modelValue":g[0]||(g[0]=re=>a.voiceUrl=re),placeholder:"音色"},{default:Ce(()=>[(se(!0),Te(jt,null,er(n.value,(re,be)=>(se(),_t(y,{key:be,value:re.voiceUrl,label:re.voiceName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),a.voiceUrl!=="custom"?(se(),Te(jt,{key:0},[ue("div",H4,[Z(C,{modelValue:a.prompt,"onUpdate:modelValue":g[1]||(g[1]=re=>a.prompt=re),placeholder:"请输入提示词",onKeyup:Rr(h,["enter"])},null,8,["modelValue"])]),ue("div",null,[Z(D,{class:"dark:bg-purple-heavy",circle:"",onClick:h},{default:Ce(()=>[Z(T)]),_:1})])],64)):(se(),Te(jt,{key:1},[Z(C,{modelValue:i.value,"onUpdate:modelValue":g[2]||(g[2]=re=>i.value=re),placeholder:"请输入音色名称"},null,8,["modelValue"]),ue("div",G4,[l.value?(se(),_t(W,{key:1,content:"停止录音"},{default:Ce(()=>[Z(G,{size:"18",onClick:c},{default:Ce(()=>[Z(L)]),_:1})]),_:1})):(se(),_t(W,{key:0,content:"开始/重新录音"},{default:Ce(()=>[Z(G,{size:"18",onClick:u},{default:Ce(()=>[Z(P)]),_:1})]),_:1})),s.value?(se(),_t(W,{key:2,content:"试听录音"},{default:Ce(()=>[Z(G,{size:"18",onClick:f},{default:Ce(()=>[Z(X)]),_:1})]),_:1})):ct("",!0),s.value?(se(),_t(W,{key:3,content:"克隆录音"},{default:Ce(()=>[Z(D,{type:"primary",circle:"",onClick:d},{default:Ce(()=>[Z(M),g[3]||(g[3]=Ut(" >"))]),_:1})]),_:1})):ct("",!0)])],64))])),[[oe,r.value]])])}}}),X4=ln(W4,[["__scopeId","data-v-6a0d04d6"]]),s0=[{title:"文本",key:"text",icon:"TextIcon",component:jb},{title:"图片",key:"image",fileType:"image/*",icon:"ImageIcon",component:Nf},{title:"音频",key:"audio",fileType:"audio/*",icon:"AudioIcon",component:zf},{title:"旁白",key:"speech",fileType:"audio/*",icon:"VoiceIcon",component:X4},{title:"视频",key:"video",fileType:"video/*",icon:"VideoIcon",component:Vf}],l0=[{title:"图片",key:"image",fileType:"image/*",icon:"ImageIcon",component:Nf},{title:"音频",key:"audio",fileType:"audio/*",icon:"AudioIcon",component:zf},{title:"视频",key:"video",fileType:"video/*",icon:"VideoIcon",component:Vf}],Y4={class:"flex h-full overflow-hidden relative container-box !p-0 bg-transparent"},U4={class:"flex flex-col gap-2 w-full"},j4=vt({__name:"GenerateContainer",setup(e){const t=rt(0),r=Xe(()=>s0[t.value]);return(n,a)=>(se(),Te("div",Y4,[ue("div",U4,[Z(Lf,{"active-index":B(t),"onUpdate:activeIndex":a[0]||(a[0]=i=>Zo(t)?t.value=i:null),menu:B(s0)},null,8,["active-index","menu"]),(se(),_t(Zd,null,[(se(),_t(en(B(r).component),{key:B(r).key}))],1024))])]))}}),q4=P0(),Br=sr(),Ea=Nr(),K4=()=>{Or("backspace,delete",(e,t)=>{Br.removeTrack(),e.preventDefault()}),Or("space",(e,t)=>{Ea.isPause=!Ea.isPause,e.preventDefault()}),Or("right",(e,t)=>{Ea.forward(),e.preventDefault()}),Or("left",(e,t)=>{Ea.backward(),e.preventDefault()}),Or("t|T",(e,t)=>{Br.addText(),e.preventDefault()}),Or("l",(e,t)=>{Br.leftLink(),e.preventDefault()}),Or("s",(e,t)=>{Br.splitTrack(),e.preventDefault()}),Or("ctrl+c",(e,t)=>{Br.selectTrack&&(Br.copyData=Br.selectTrack,e.preventDefault())}),Or("ctrl+v",(e,t)=>{(async()=>{if(Br.copyData){const r=await Br.copyTrack(Br.copyData),n=r.end-r.start;r.start=Ea.playStartFrame,r.end=r.start+n,Br.addTrack(r),e.preventDefault()}})()}),Or("ctrl+s",(e,t)=>{q4.saveProject().then(()=>{Zt.success("保存成功")}),e.preventDefault()}),Or("ctrl+z",(e,t)=>{Br._undo(),e.preventDefault()}),Or("ctrl+shift+z",(e,t)=>{Br._redo(),e.preventDefault()})},Z4=()=>{Or.deleteScope("all")},Q4={class:"w-full h-full overflow-hidden flex flex-col items-center"},J4={class:"flex-1 w-full overflow-auto"},ey={class:"w-full upload-container"},ty=vt({__name:"UploadContainer",setup(e){const t=qn(),r=rt([]),n=rt(!1),a=rt(0),i=Xe(()=>t.getResourcesByType(o.value.key).value||[]),o=Xe(()=>l0.filter(l=>l.fileType)[a.value]),s=async()=>{if(r.value.length===0){Zt.error("请选择文件再上传");return}n.value=!0;try{const l=r.value[0].raw;if(!l){Zt.error("文件无效");return}await t.createResource(l),Zt.success("文件上传成功"),r.value=[]}catch(l){console.error("Upload error:",l),Zt.error("文件上传失败")}finally{n.value=!1}};return Nt(()=>r.value,()=>{r.value.length>0&&s()}),(l,u)=>{const c=ci,f=Ht,d=Sp,h=sn;return se(),Te("div",Q4,[Z(Lf,{"active-index":B(a),"onUpdate:activeIndex":u[0]||(u[0]=v=>Zo(a)?a.value=v:null),menu:B(l0)},null,8,["active-index","menu"]),ue("div",J4,[Z(c,{"list-data":B(i),type:B(o).key},null,8,["list-data","type"])]),Kt((se(),Te("div",ey,[Z(d,{"file-list":B(r),"onUpdate:fileList":u[1]||(u[1]=v=>Zo(r)?r.value=v:null),class:"w-full",drag:"",action:"","show-file-list":!1,"auto-upload":!1,accept:B(o).fileType,limit:1},{default:Ce(()=>[Z(f,{class:"el-icon--upload mt-2",size:"40"},{default:Ce(()=>[Z(B(Qd))]),_:1}),u[2]||(u[2]=ue("div",{class:"el-upload__text !mt-[-10px] mb-4"},[Ut(" 拖拽文件到此 或 "),ue("em",null,"点击上传")],-1))]),_:1},8,["file-list","accept"])])),[[h,B(n)]])])}}}),ry=ln(ty,[["__scopeId","data-v-8aca2d5a"]]),ny={class:"flex flex-1 overflow-hidden gap-4 p-4 h-full"},ay={class:"w-[370px] flex flex-col rounded overflow-hidden"},iy={class:"flex flex-1 flex-col overflow-hidden gap-2"},oy={class:"flex flex-1 flex-row flex-nowrap container-box gap-2"},fy=vt({__name:"index",setup(e){const t=pa(),r=P0(),n=rt(),a=hr({minHeight:200,maxHeight:document.body.getBoundingClientRect().height-200,minWidth:300,maxWidth:600});return Gr(()=>{K4(),n.value=setInterval(async()=>{await r.saveProject()},30*1e3)}),k0(()=>{Z4(),clearInterval(n.value)}),(i,o)=>{const s=E0,l=M0;return se(),Te("div",ny,[ue("div",ay,[Z(l,{type:"border-card",class:"flex-1 overflow-hidden"},{default:Ce(()=>[Z(s,{class:"h-full",label:"生成区"},{default:Ce(()=>[Z(j4)]),_:1}),Z(s,{class:"h-full",label:"上传区"},{default:Ce(()=>[Z(ry)]),_:1})]),_:1})]),ue("div",iy,[ue("div",oy,[Z(C3),Z(o0,{"new-width":B(t).attrWidth,"onUpdate:newWidth":o[0]||(o[0]=u=>B(t).attrWidth=u),direction:"vertical","limit-size":B(a)},null,8,["new-width","limit-size"]),Z(og)]),Z(o0,{"new-height":B(t).trackHeight,"onUpdate:newHeight":o[1]||(o[1]=u=>B(t).trackHeight=u),direction:"horizontal","limit-size":B(a)},null,8,["new-height","limit-size"]),Z(Mb)])])}}});export{fy as default};
