import{d as z,a as v,b as E,u as B,o as i,e as r,f as e,g as s,w as x,h as a,F as U,i as T,j as b,t as A,E as G,k as R,l as $,n as J,s as j,v as S,x as C,y as M,z as N,A as I,B as H,C as K,D as O,G as P,H as Z,I as q,J as Q,K as W,L as X}from"./index-D1slywUk.js";import{E as Y,a as ee,b as te,c as le}from"./el-progress-p4TbarQk.js";const se=z("taskState",()=>{const k=v(),o=v();return{taskId:k,startTimer:(n,c=5)=>{o.value&&clearInterval(o.value),n(),o.value=setInterval(n,1e3*c)},endTimer:()=>{o.value&&clearInterval(o.value)}}}),ne={key:0,class:"flex flex-col gap-4"},oe={class:"w-20 h-full flex justify-center items-center"},ae={class:"flex-1 h-full"},ie={class:"mt-2"},re={key:1,class:"flex flex-col gap-4"},de={class:"flex-1 h-full"},ue={class:"mt-2"},ce={class:"flex justify-center gap-6 mb-6"},me=E({__name:"Annotation",setup(k){const o=B(),u=se(),d=v(),n=async()=>{await A(o.model),c()},c=async()=>{const m=G.service({target:d.value});u.startTimer(async()=>{try{const l=await R(o.model);m.setText(`[${l.percent}/100] ${l.status}`),l.percent===100&&(o.refreshList(),$.success("训练完成"),m.close(),u.endTimer())}catch{m.close(),u.endTimer()}},5)};return(m,l)=>{const h=Y,g=C,t=J,w=j;return i(),r("div",{class:"container-box !p-6 w-full my-text text-xs flex flex-col",ref_key:"containerRef",ref:d},[l[2]||(l[2]=e("div",null,"步骤二：模型训练",-1)),s(t,{class:"m-10 flex-1 overflow-auto"},{default:x(()=>[a(o).model.modelUuid?(i(),r("div",ne,[(i(!0),r(U,null,T(a(o).model.trainParam.imgcaptionAndId.imgCaptionList,(f,p)=>(i(),r("div",{key:p,class:"flex justify-center h-20 mr-4 gap-4"},[e("div",oe,[s(h,{class:"max-w-full max-h-full",src:f.url,"preview-src-list":[f.url],"zoom-rate":1.2,"max-scale":7,"min-scale":.2},null,8,["src","preview-src-list"])]),e("div",ae,[e("div",ie,"Caption "+S(p+1)+": "+S(f.name),1),s(g,{class:"dark:bg-night-lighter rounded mt-4",modelValue:f.caption,"onUpdate:modelValue":_=>f.caption=_},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])):(i(),r("div",re,[(i(!0),r(U,null,T(Array(6),(f,p)=>(i(),r("div",{key:p,class:"flex justify-center h-20 mr-4"},[l[0]||(l[0]=e("img",{class:"w-20 h-full mr-4 dark:bg-gray-600",alt:""},null,-1)),e("div",de,[e("div",ue,"Caption "+S(p+1),1),s(g,{class:"dark:bg-night-lighter rounded mt-4"})])]))),128))]))]),_:1}),e("div",ce,[s(w,{class:"font-semibold px-6 py-4",color:"#805DFF",onClick:n},{default:x(()=>l[1]||(l[1]=[b(" 开始训练 ")])),_:1})])],512)}}}),fe={class:"container-box flex-1 !p-6 my-text text-xs"},pe={class:"w-full flex mt-8 gap-10"},_e={class:"w-1/3"},ve={class:"mt-4"},xe={class:"mt-4"},ge={class:"w-1/3"},ye={class:"mt-4"},we={class:"w-1/3"},he={key:0,class:"my-4 h-20 w-full flex gap-4"},ke=["src"],be={key:1,class:"my-4 h-20 w-full flex gap-4"},$e={class:"flex justify-center"},Ve=E({__name:"ModelUsage",setup(k){const o=B(),u=v(!1),d=M(()=>o.modelList),n=v(0),c=v(""),m=v([]),l=async()=>{var g;if(c.value===""){$.warning("请输入提示词");return}u.value=!0;try{const t=d.value[n.value],w=await H({modelUuid:t==null?void 0:t.modelUuid,domain:t==null?void 0:t.domain,prompt:c.value,trigger:(g=t==null?void 0:t.trainParam)==null?void 0:g.conceptSentence});m.value.push(...w)}finally{u.value=!1}},h=async()=>{K.confirm("确定保存所选模型？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await O(d.value[n.value]),$.success("保存成功")})};return(g,t)=>{var L,F;const w=te,f=ee,p=C,_=j,D=P;return N((i(),r("div",fe,[t[9]||(t[9]=e("div",null,"步骤三：模型保存",-1)),e("div",pe,[e("div",_e,[t[2]||(t[2]=e("div",null,"模型选择",-1)),e("div",ve,[s(f,{modelValue:a(n),"onUpdate:modelValue":t[0]||(t[0]=y=>I(n)?n.value=y:null),class:"dark:bg-night-lighter rounded"},{default:x(()=>[(i(!0),r(U,null,T(a(d),(y,V)=>(i(),Z(w,{key:V,label:y.modelName+" - "+y.modelUuid,value:V},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),t[3]||(t[3]=e("div",{class:"mt-5"},"模型触发词",-1)),e("div",xe,[s(p,{disabled:"",value:(F=(L=a(d)[a(n)])==null?void 0:L.trainParam)==null?void 0:F.conceptSentence,class:"dark:bg-night-lighter rounded"},null,8,["value"])])]),e("div",ge,[t[4]||(t[4]=e("div",null,"描述词",-1)),e("div",ye,[s(p,{modelValue:a(c),"onUpdate:modelValue":t[1]||(t[1]=y=>I(c)?c.value=y:null),type:"textarea",class:"dark:bg-night-lighter rounded",rows:5,resize:"none"},null,8,["modelValue"])])]),e("div",we,[t[8]||(t[8]=e("div",null,"示例参考图",-1)),a(m).length?(i(),r("div",he,[(i(!0),r(U,null,T(a(m),(y,V)=>(i(),r("div",{key:V,class:"flex max-h-full max-w-full"},[e("img",{src:y,alt:""},null,8,ke)]))),128))])):(i(),r("div",be,t[5]||(t[5]=[e("div",{class:"flex-1 dark:bg-gray-500"},null,-1),e("div",{class:"flex-1 dark:bg-gray-500"},null,-1),e("div",{class:"flex-1 dark:bg-gray-500"},null,-1)]))),e("div",$e,[s(_,{class:"font-semibold px-6",onClick:l},{default:x(()=>t[6]||(t[6]=[b("使用模型")])),_:1}),s(_,{class:"font-semibold px-6",color:"#805DFF",onClick:h},{default:x(()=>t[7]||(t[7]=[b("保存模型")])),_:1})])])])])),[[D,a(u)]])}}}),Ue={class:"container-box !p-6 w-full my-text text-xs"},Te={class:"flex justify-center mt-6"},Ee={class:"flex justify-center mt-6"},Se={class:"flex justify-center mt-4 mb-10"},Ie={class:"flex justify-center gap-6"},Be=E({__name:"UploadImage",setup(k){const o=B(),u=v(!1),d=v([]),n=q({modelName:"",trigger:"",file:null}),c=async()=>{u.value=!0;try{if(d.value.length!=1){$.warning("请上传文件");return}n.file=d.value[0].raw;const m=await Q(n);o.model=m,$.success("上传成功")}finally{u.value=!1}};return(m,l)=>{const h=C,g=W,t=X,w=le,f=j,p=P;return N((i(),r("div",Ue,[l[6]||(l[6]=e("div",null,"步骤一：模型配置",-1)),l[7]||(l[7]=e("div",{class:"text-center mt-11"},"模型命名",-1)),e("div",Te,[s(h,{modelValue:a(n).modelName,"onUpdate:modelValue":l[0]||(l[0]=_=>a(n).modelName=_),class:"dark:bg-night-lighter rounded !w-3/4"},null,8,["modelValue"])]),l[8]||(l[8]=e("div",{class:"text-center mt-10"},"触发词设定",-1)),e("div",Ee,[s(h,{modelValue:a(n).trigger,"onUpdate:modelValue":l[1]||(l[1]=_=>a(n).trigger=_),class:"dark:bg-night-lighter rounded !w-3/4"},null,8,["modelValue"])]),l[9]||(l[9]=e("div",{class:"text-center mt-10"},"上传图片",-1)),e("div",Se,[s(w,{class:"!w-3/4","file-list":a(d),"onUpdate:fileList":l[2]||(l[2]=_=>I(d)?d.value=_:null),drag:"",accept:".zip",limit:1,"auto-upload":!1},{tip:x(()=>l[3]||(l[3]=[e("div",{class:"el-upload__tip text-center !mt-4 text-sm"}," 文件类型：ZIP压缩包，图片格式为JPG或PNG；图片数量6~30张最宜，单图不超过 2MB。 ",-1)])),default:x(()=>[s(t,{class:"el-icon--upload"},{default:x(()=>[s(g)]),_:1}),l[4]||(l[4]=e("div",{class:"el-upload__text !text-sm"},[b(" 拖拽图片压缩包 或 "),e("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),e("div",Ie,[s(f,{onClick:c,class:"font-semibold px-6 py-4",color:"#805DFF"},{default:x(()=>l[5]||(l[5]=[b("上传配置")])),_:1})])])),[[p,a(u)]])}}}),je={class:"p-4 flex flex-1 gap-4 overflow-hidden"},Ce={class:"w-[400px] h-full flex flex-col gap-4"},Le={class:"flex-1 h-full flex flex-col gap-4 overflow-visible"},Pe=E({__name:"index",setup(k){return(o,u)=>(i(),r("div",je,[e("div",Ce,[s(Be,{class:"h-full custom-shadow"})]),e("div",Le,[s(me,{class:"h-3/4 overflow-hidden custom-shadow"}),s(Ve,{class:"custom-shadow"})])]))}});export{Pe as default};
