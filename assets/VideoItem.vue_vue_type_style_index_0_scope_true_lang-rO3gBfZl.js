import{d as b,N as I,D as L,r as p,G as _,O as S,B as V,g as s,h as o,u as e,I as g,i as v,F as C,l as U,s as B,q as D,V as N,f as O,e as r,af as R}from"./index-C9HzHbyJ.js";import{L as j}from"./Loading-BYHt-F-H.js";import{g as x}from"./canvasUtil-Buwp7mdT.js";const F={class:"flex flex-col rounded overflow-hidden h-full"},$={class:"flex items-center text-xs pl-2 overflow-hidden h-5 leading-5 bg-[#4b4f54] text-white"},z={key:0,class:"mr-4 shrink-0"},E={class:"shrink-0"},G=["src"],M={key:0,class:"pl-2 overflow-hidden h-4 flex items-center bg-gray-700 relative text-xs overflow-ellipsis whitespace-nowrap text-white"},W=b({__name:"VideoItem",props:{trackItem:{type:Object}},setup(a){const n=a,k=I(),d=L(),y=p(),m=p(!0),u=p([]),t=_(()=>n.trackItem.resource);async function w(){if(!t.value){console.error("Video resource not found");return}try{k.ingLoadingCount++,m.value=!0;const i=x(d.trackScale,n.trackItem.frameCount),c=Math.ceil(i/50),l=Math.ceil(t.value.duration*1e6/c),f=await R.thumbnails(n.trackItem,d.trackScale,l);u.value=f.map(({img:h})=>URL.createObjectURL(h))}finally{m.value=!1,k.ingLoadingCount--}}return S(()=>[n.trackItem,t.value],w,{immediate:!0,flush:"post"}),V(()=>{u.value.forEach(i=>{URL.revokeObjectURL(i)})}),(i,c)=>{var l;return r(),s("div",F,[o("div",$,[c[0]||(c[0]=o("i",{class:"i-mdi-video",style:{"font-size":"18px","margin-right":"8px","flex-shrink":"0"}},null,-1)),e(t)?(r(),s("span",z," ["+g(e(t).duration.toFixed(1))+"s] ",1)):v("",!0),o("span",E,g(`${a.trackItem.name}.${a.trackItem.format}`),1)]),o("div",{ref_key:"container",ref:y,class:"bg-gray-400 bg-opacity-70 flex-1 relative whitespace-nowrap overflow-hidden",style:B({left:`-${e(x)(e(d).trackScale,a.trackItem.offsetL)}px`})},[(r(!0),s(C,null,U(e(u),(f,h)=>(r(),s("img",{key:h,src:f,alt:"",class:"image-item",draggable:"false"},null,8,G))),128))],4),(l=e(t).meta)!=null&&l.prompt?(r(),s("div",M,[o("span",null,g(e(t).meta.prompt),1)])):v("",!0),D(O(j,{class:"pl-12 bg-opacity-70"},null,512),[[N,e(m)||a.trackItem.loading]])])}}});export{W as _};
