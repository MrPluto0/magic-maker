import{Q as M,j as D,X as _}from"./chunk-5XSOKW54-CaorZWLv.js";import{S as q}from"./chunk-UFIBX7QP-BEQ8o-gL.js";import"./chunk-66ULMTWW-Cy_bNfUz.js";import"./chunk-LA3PGSPR-BEmwtCFu.js";import"./chunk-LA5IGN2Q-CstV3dW2.js";import{m as B}from"./chunk-4IXHFASB-GdfMpUzR.js";import{E as R,I as P,a as Q,b as c,X as d,V as x,w as Y,Y as O,c as A,n as C,i as I,q as X}from"./dist-QNDTTFGF-BY-EVaVA.js";import{c as V,r as S}from"./index-DUIAo018.js";V();S(R(),1);S(P(),1);S(Q(),1);var T=i=>X.sanitizeText(i,d()),k={dividerMargin:10,padding:5,textHeight:10,curve:void 0},z=function(i,l,p,n){let e=Object.keys(i);c.info("keys:",e),c.info(i),e.forEach(function(s){var t,r;let a=i[s],o={shape:"rect",id:a.id,domId:a.domId,labelText:T(a.id),labelStyle:"",style:"fill: none; stroke: black",padding:((t=d().flowchart)==null?void 0:t.padding)??((r=d().class)==null?void 0:r.padding)};l.setNode(a.id,o),$(a.classes,l,p,n,a.id),c.info("setNode",o)})},$=function(i,l,p,n,e){let s=Object.keys(i);c.info("keys:",s),c.info(i),s.filter(t=>i[t].parent==e).forEach(function(t){var r,a;let o=i[t],g=o.cssClasses.join(" "),b=A(o.styles),h=o.label??o.id,f=0,u="class_box",y={labelStyle:b.labelStyle,shape:u,labelText:T(h),classData:o,rx:f,ry:f,class:g,style:b.style,id:o.id,domId:o.domId,tooltip:n.db.getTooltip(o.id,e)||"",haveCallback:o.haveCallback,link:o.link,width:o.type==="group"?500:void 0,type:o.type,padding:((r=d().flowchart)==null?void 0:r.padding)??((a=d().class)==null?void 0:a.padding)};l.setNode(o.id,y),e&&l.setParent(o.id,e),c.info("setNode",y)})},F=function(i,l,p,n){c.info(i),i.forEach(function(e,s){var t,r;let a=e,o="",g={labelStyle:"",style:""},b=a.text,h=0,f="note",u={labelStyle:g.labelStyle,shape:f,labelText:T(b),noteData:a,rx:h,ry:h,class:o,style:g.style,id:a.id,domId:a.id,tooltip:"",type:"note",padding:((t=d().flowchart)==null?void 0:t.padding)??((r=d().class)==null?void 0:r.padding)};if(l.setNode(a.id,u),c.info("setNode",u),!a.class||!(a.class in n))return;let y=p+s,w={id:`edgeNote${y}`,classes:"relation",pattern:"dotted",arrowhead:"none",startLabelRight:"",endLabelLeft:"",arrowTypeStart:"none",arrowTypeEnd:"none",style:"fill:none",labelStyle:"",curve:C(k.curve,I)};l.setEdge(a.id,a.class,w,y)})},G=function(i,l){let p=d().flowchart,n=0;i.forEach(function(e){var s;n++;let t={classes:"relation",pattern:e.relation.lineType==1?"dashed":"solid",id:`id_${e.id1}_${e.id2}_${n}`,arrowhead:e.type==="arrow_open"?"none":"normal",startLabelRight:e.relationTitle1==="none"?"":e.relationTitle1,endLabelLeft:e.relationTitle2==="none"?"":e.relationTitle2,arrowTypeStart:N(e.relation.type1),arrowTypeEnd:N(e.relation.type2),style:"fill:none",labelStyle:"",curve:C(p==null?void 0:p.curve,I)};if(c.info(t,e),e.style!==void 0){let r=A(e.style);t.style=r.style,t.labelStyle=r.labelStyle}e.text=e.title,e.text===void 0?e.style!==void 0&&(t.arrowheadStyle="fill: #333"):(t.arrowheadStyle="fill: #333",t.labelpos="c",((s=d().flowchart)==null?void 0:s.htmlLabels)??d().htmlLabels?(t.labelType="html",t.label='<span class="edgeLabel">'+e.text+"</span>"):(t.labelType="text",t.label=e.text.replace(X.lineBreakRegex,`
`),e.style===void 0&&(t.style=t.style||"stroke: #333; stroke-width: 1.5px;fill:none"),t.labelStyle=t.labelStyle.replace("color:","fill:"))),l.setEdge(e.id1,e.id2,t,n)})},H=function(i){k={...k,...i}},J=async function(i,l,p,n){c.info("Drawing class - ",l);let e=d().flowchart??d().class,s=d().securityLevel;c.info("config:",e);let t=(e==null?void 0:e.nodeSpacing)??50,r=(e==null?void 0:e.rankSpacing)??50,a=new B({multigraph:!0,compound:!0}).setGraph({rankdir:n.db.getDirection(),nodesep:t,ranksep:r,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),o=n.db.getNamespaces(),g=n.db.getClasses(),b=n.db.getRelations(),h=n.db.getNotes();c.info(b),z(o,a,l,n),$(g,a,l,n),G(b,a),F(h,a,b.length+1,g);let f;s==="sandbox"&&(f=x("#i"+l));let u=s==="sandbox"?x(f.nodes()[0].contentDocument.body):x("body"),y=u.select(`[id="${l}"]`),w=u.select("#"+l+" g");if(await q(w,a,["aggregation","extension","composition","dependency","lollipop"],"classDiagram",l),Y.insertTitle(y,"classTitleText",(e==null?void 0:e.titleTopMargin)??5,n.db.getDiagramTitle()),O(a,y,e==null?void 0:e.diagramPadding,e==null?void 0:e.useMaxWidth),!(e!=null&&e.htmlLabels)){let E=s==="sandbox"?f.nodes()[0].contentDocument:document,j=E.querySelectorAll('[id="'+l+'"] .edgeLabel .label');for(let v of j){let L=v.getBBox(),m=E.createElementNS("http://www.w3.org/2000/svg","rect");m.setAttribute("rx",0),m.setAttribute("ry",0),m.setAttribute("width",L.width),m.setAttribute("height",L.height),v.insertBefore(m,v.firstChild)}}};function N(i){let l;switch(i){case 0:l="aggregation";break;case 1:l="extension";break;case 2:l="composition";break;case 3:l="dependency";break;case 4:l="lollipop";break;default:l="none"}return l}var K={setConf:H,draw:J},oe={parser:M,db:D,renderer:K,styles:_,init:i=>{i.class||(i.class={}),i.class.arrowMarkerAbsolute=i.arrowMarkerAbsolute,D.clear()}};export{oe as diagram};
