var ll=e=>{throw TypeError(e)};var Ic=(e,t,r)=>t.has(e)||ll("Cannot "+r);var ul=(e,t,r)=>t.has(e)?ll("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r);var wn=(e,t,r)=>(Ic(e,t,"access private method"),r);import{b as bn,d as Le,t as Oc,B as io,F as wa,e as se,u as zr,D as ie,I as nn,G as We,bS as cl,a4 as un,aq as Ti,a as me,o as bt,f as Dt,M as mt,n as ne,g as P,j as Te,k as Yr,ap as Pc,c4 as Lc,be as Fc,bi as vi,ad as An,bh as ma,bf as zc,cm as fl,ah as b0,ak as Nc,R as Ke,$ as nr,bj as Vc,bl as $c,bm as Ba,by as Hc,b_ as Gc,ax as Pr,s as _i,H as Gn,at as x0,J as Ee,K as Tt,a0 as rr,ao as Jr,L as et,i as xe,aj as Ur,aB as Gr,ay as Ye,aa as ye,ab as jn,P as Ue,bo as Wc,a1 as vn,Q as so,bx as Di,au as ys,w as oo,cn as Xc,co as y0,c5 as Yc,cp as S0,bd as w0,h as hr,X as Ln,bt as lo,a9 as C0,v as Ss,cq as pr,O as dn,cr as Uc,W as jc,aH as qc,cs as Kc,c2 as dl,ct as vl,cu as Zc,cv as Qc,bX as Jc,cw as tf,bs as hl,c7 as $n,cx as ef,c9 as rf,cj as ur,cy as gr,aR as jr,az as qe,cz as Br,cA as nf,cB as af,cC as sf,aL as qr,cD as Jn,bb as E0,bc as M0,cE as pl,cF as of,cG as lf,cH as uf,cI as cf,cJ as ff,cK as df,cL as vf,bw as hf,aU as k0,cM as pf,cN as uo,cO as gf,cP as T0,cQ as D0,cR as co,cS as mf,am as _f,aK as ta,cl as bf,cT as xf,cU as yf,cV as Sf,cW as R0,cX as Ia,cY as A0,cZ as B0,c_ as wf,ci as Cf,c$ as Ef,d0 as Mf,d1 as kf,d2 as Tf,aI as ws,d3 as Df,aw as I0,d4 as Rf}from"./index-DUIAo018.js";import{a as Ri,E as Oa,d as Af,G as Bf,I as Cs,M as If,T as Of,R as Pf,h as Tr}from"./hotkeys.esm-oEmevXoJ.js";import{C as Lf,i as Ff,c as Ai,d as ea,b as zf,E as Bi,a as Ii,u as Nf,_ as Pa}from"./ResourceList.vue_vue_type_script_setup_true_lang-BQff5Ghx.js";import{g as fo}from"./el-image-viewer-Bs5Miiwj.js";const Vf=bn({color:{type:Le(Object),required:!0},vertical:{type:Boolean,default:!1}});let ns=!1;function Ca(e,t){if(!Oc)return;const r=function(i){var s;(s=t.drag)==null||s.call(t,i)},n=function(i){var s;document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",n),document.removeEventListener("touchmove",r),document.removeEventListener("touchend",n),document.onselectstart=null,document.ondragstart=null,ns=!1,(s=t.end)==null||s.call(t,i)},a=function(i){var s;ns||(i.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",r),document.addEventListener("mouseup",n),document.addEventListener("touchmove",r),document.addEventListener("touchend",n),ns=!0,(s=t.start)==null||s.call(t,i))};e.addEventListener("mousedown",a),e.addEventListener("touchstart",a,{passive:!1})}const $f=e=>{const t=Ti(),{t:r}=io(),n=wa(),a=wa(),i=se(()=>e.color.get("alpha")),s=se(()=>r("el.colorpicker.alphaLabel"));function o(f){var d;f.target!==n.value&&l(f),(d=n.value)==null||d.focus()}function l(f){if(!a.value||!n.value)return;const p=t.vnode.el.getBoundingClientRect(),{clientX:v,clientY:h}=fo(f);if(e.vertical){let m=h-p.top;m=Math.max(n.value.offsetHeight/2,m),m=Math.min(m,p.height-n.value.offsetHeight/2),e.color.set("alpha",Math.round((m-n.value.offsetHeight/2)/(p.height-n.value.offsetHeight)*100))}else{let m=v-p.left;m=Math.max(n.value.offsetWidth/2,m),m=Math.min(m,p.width-n.value.offsetWidth/2),e.color.set("alpha",Math.round((m-n.value.offsetWidth/2)/(p.width-n.value.offsetWidth)*100))}}function u(f){const{code:d,shiftKey:p}=f,v=p?10:1;switch(d){case un.left:case un.down:f.preventDefault(),f.stopPropagation(),c(-v);break;case un.right:case un.up:f.preventDefault(),f.stopPropagation(),c(v);break}}function c(f){let d=i.value+f;d=d<0?0:d>100?100:d,e.color.set("alpha",d)}return{thumb:n,bar:a,alpha:i,alphaLabel:s,handleDrag:l,handleClick:o,handleKeydown:u}},Hf=(e,{bar:t,thumb:r,handleDrag:n})=>{const a=Ti(),i=zr("color-alpha-slider"),s=ie(0),o=ie(0),l=ie();function u(){if(!r.value||e.vertical)return 0;const y=a.vnode.el,S=e.color.get("alpha");return y?Math.round(S*(y.offsetWidth-r.value.offsetWidth/2)/100):0}function c(){if(!r.value)return 0;const y=a.vnode.el;if(!e.vertical)return 0;const S=e.color.get("alpha");return y?Math.round(S*(y.offsetHeight-r.value.offsetHeight/2)/100):0}function f(){if(e.color&&e.color.value){const{r:y,g:S,b:C}=e.color.toRgb();return`linear-gradient(to right, rgba(${y}, ${S}, ${C}, 0) 0%, rgba(${y}, ${S}, ${C}, 1) 100%)`}return""}function d(){s.value=u(),o.value=c(),l.value=f()}nn(()=>{if(!t.value||!r.value)return;const y={drag:S=>{n(S)},end:S=>{n(S)}};Ca(t.value,y),Ca(r.value,y),d()}),We(()=>e.color.get("alpha"),()=>d()),We(()=>e.color.value,()=>d());const p=se(()=>[i.b(),i.is("vertical",e.vertical)]),v=se(()=>i.e("bar")),h=se(()=>i.e("thumb")),m=se(()=>({background:l.value})),b=se(()=>({left:cl(s.value),top:cl(o.value)}));return{rootKls:p,barKls:v,barStyle:m,thumbKls:h,thumbStyle:b,update:d}},Gf="ElColorAlphaSlider",Wf=me({name:Gf}),Xf=me({...Wf,props:Vf,setup(e,{expose:t}){const r=e,{alpha:n,alphaLabel:a,bar:i,thumb:s,handleDrag:o,handleClick:l,handleKeydown:u}=$f(r),{rootKls:c,barKls:f,barStyle:d,thumbKls:p,thumbStyle:v,update:h}=Hf(r,{bar:i,thumb:s,handleDrag:o});return t({update:h,bar:i,thumb:s}),(m,b)=>(bt(),Dt("div",{class:ne(P(c))},[mt("div",{ref_key:"bar",ref:i,class:ne(P(f)),style:Te(P(d)),onClick:P(l)},null,14,["onClick"]),mt("div",{ref_key:"thumb",ref:s,class:ne(P(p)),style:Te(P(v)),"aria-label":P(a),"aria-valuenow":P(n),"aria-orientation":m.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:P(u)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var Yf=Yr(Xf,[["__file","alpha-slider.vue"]]);const Uf=me({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=zr("color-hue-slider"),r=Ti(),n=ie(),a=ie(),i=ie(0),s=ie(0),o=se(()=>e.color.get("hue"));We(()=>o.value,()=>{d()});function l(p){p.target!==n.value&&u(p)}function u(p){if(!a.value||!n.value)return;const h=r.vnode.el.getBoundingClientRect(),{clientX:m,clientY:b}=fo(p);let y;if(e.vertical){let S=b-h.top;S=Math.min(S,h.height-n.value.offsetHeight/2),S=Math.max(n.value.offsetHeight/2,S),y=Math.round((S-n.value.offsetHeight/2)/(h.height-n.value.offsetHeight)*360)}else{let S=m-h.left;S=Math.min(S,h.width-n.value.offsetWidth/2),S=Math.max(n.value.offsetWidth/2,S),y=Math.round((S-n.value.offsetWidth/2)/(h.width-n.value.offsetWidth)*360)}e.color.set("hue",y)}function c(){if(!n.value)return 0;const p=r.vnode.el;if(e.vertical)return 0;const v=e.color.get("hue");return p?Math.round(v*(p.offsetWidth-n.value.offsetWidth/2)/360):0}function f(){if(!n.value)return 0;const p=r.vnode.el;if(!e.vertical)return 0;const v=e.color.get("hue");return p?Math.round(v*(p.offsetHeight-n.value.offsetHeight/2)/360):0}function d(){i.value=c(),s.value=f()}return nn(()=>{if(!a.value||!n.value)return;const p={drag:v=>{u(v)},end:v=>{u(v)}};Ca(a.value,p),Ca(n.value,p),d()}),{bar:a,thumb:n,thumbLeft:i,thumbTop:s,hueValue:o,handleClick:l,update:d,ns:t}}});function jf(e,t,r,n,a,i){return bt(),Dt("div",{class:ne([e.ns.b(),e.ns.is("vertical",e.vertical)])},[mt("div",{ref:"bar",class:ne(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),mt("div",{ref:"thumb",class:ne(e.ns.e("thumb")),style:Te({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var qf=Yr(Uf,[["render",jf],["__file","hue-slider.vue"]]);const Kf=bn({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:Pc,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:Lc.teleported,predefine:{type:Le(Array)},validateEvent:{type:Boolean,default:!0},...Fc(["ariaLabel"])}),Zf={[vi]:e=>An(e)||ma(e),[zc]:e=>An(e)||ma(e),activeChange:e=>An(e)||ma(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},O0=Symbol("colorPickerContextKey"),gl=function(e,t,r){return[e,t*r/((e=(2-t)*r)<1?e:2-e)||0,e/2]},Qf=function(e){return An(e)&&e.includes(".")&&Number.parseFloat(e)===1},Jf=function(e){return An(e)&&e.includes("%")},Yn=function(e,t){Qf(e)&&(e="100%");const r=Jf(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),r&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},ml={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},hi=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),r=e%16;return`${ml[t]||t}${ml[r]||r}`},_l=function({r:e,g:t,b:r}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+r)?"":`#${hi(e)}${hi(t)}${hi(r)}`},as={A:10,B:11,C:12,D:13,E:14,F:15},Cn=function(e){return e.length===2?(as[e[0].toUpperCase()]||+e[0])*16+(as[e[1].toUpperCase()]||+e[1]):as[e[1].toUpperCase()]||+e[1]},td=function(e,t,r){t=t/100,r=r/100;let n=t;const a=Math.max(r,.01);r*=2,t*=r<=1?r:2-r,n*=a<=1?a:2-a;const i=(r+t)/2,s=r===0?2*n/(a+n):2*t/(r+t);return{h:e,s:s*100,v:i*100}},bl=(e,t,r)=>{e=Yn(e,255),t=Yn(t,255),r=Yn(r,255);const n=Math.max(e,t,r),a=Math.min(e,t,r);let i;const s=n,o=n-a,l=n===0?0:o/n;if(n===a)i=0;else{switch(n){case e:{i=(t-r)/o+(t<r?6:0);break}case t:{i=(r-e)/o+2;break}case r:{i=(e-t)/o+4;break}}i/=6}return{h:i*360,s:l*100,v:s*100}},fa=function(e,t,r){e=Yn(e,360)*6,t=Yn(t,100),r=Yn(r,100);const n=Math.floor(e),a=e-n,i=r*(1-t),s=r*(1-a*t),o=r*(1-(1-a)*t),l=n%6,u=[r,s,i,i,o,r][l],c=[o,r,r,s,i,i][l],f=[i,i,o,r,r,s][l];return{r:Math.round(u*255),g:Math.round(c*255),b:Math.round(f*255)}};class _a{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const r in t)fl(t,r)&&(this[r]=t[r]);t.value?this.fromString(t.value):this.doOnChange()}set(t,r){if(arguments.length===1&&typeof t=="object"){for(const n in t)fl(t,n)&&this.set(n,t[n]);return}this[`_${t}`]=r,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return fa(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const r=(n,a,i)=>{this._hue=Math.max(0,Math.min(360,n)),this._saturation=Math.max(0,Math.min(100,a)),this._value=Math.max(0,Math.min(100,i)),this.doOnChange()};if(t.includes("hsl")){const n=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,i)=>i>2?Number.parseFloat(a):Number.parseInt(a,10));if(n.length===4?this._alpha=Number.parseFloat(n[3])*100:n.length===3&&(this._alpha=100),n.length>=3){const{h:a,s:i,v:s}=td(n[0],n[1],n[2]);r(a,i,s)}}else if(t.includes("hsv")){const n=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,i)=>i>2?Number.parseFloat(a):Number.parseInt(a,10));n.length===4?this._alpha=Number.parseFloat(n[3])*100:n.length===3&&(this._alpha=100),n.length>=3&&r(n[0],n[1],n[2])}else if(t.includes("rgb")){const n=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,i)=>i>2?Number.parseFloat(a):Number.parseInt(a,10));if(n.length===4?this._alpha=Number.parseFloat(n[3])*100:n.length===3&&(this._alpha=100),n.length>=3){const{h:a,s:i,v:s}=bl(n[0],n[1],n[2]);r(a,i,s)}}else if(t.includes("#")){const n=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(n))return;let a,i,s;n.length===3?(a=Cn(n[0]+n[0]),i=Cn(n[1]+n[1]),s=Cn(n[2]+n[2])):(n.length===6||n.length===8)&&(a=Cn(n.slice(0,2)),i=Cn(n.slice(2,4)),s=Cn(n.slice(4,6))),n.length===8?this._alpha=Cn(n.slice(6))/255*100:(n.length===3||n.length===6)&&(this._alpha=100);const{h:o,s:l,v:u}=bl(a,i,s);r(o,l,u)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:r,_value:n,_alpha:a,format:i}=this;if(this.enableAlpha)switch(i){case"hsl":{const s=gl(t,r/100,n/100);this.value=`hsla(${t}, ${Math.round(s[1]*100)}%, ${Math.round(s[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(r)}%, ${Math.round(n)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${_l(fa(t,r,n))}${hi(a*255/100)}`;break}default:{const{r:s,g:o,b:l}=fa(t,r,n);this.value=`rgba(${s}, ${o}, ${l}, ${this.get("alpha")/100})`}}else switch(i){case"hsl":{const s=gl(t,r/100,n/100);this.value=`hsl(${t}, ${Math.round(s[1]*100)}%, ${Math.round(s[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(r)}%, ${Math.round(n)}%)`;break}case"rgb":{const{r:s,g:o,b:l}=fa(t,r,n);this.value=`rgb(${s}, ${o}, ${l})`;break}default:this.value=_l(fa(t,r,n))}}}const ed=me({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const t=zr("color-predefine"),{currentColor:r}=b0(O0),n=ie(i(e.colors,e.color));We(()=>r.value,s=>{const o=new _a;o.fromString(s),n.value.forEach(l=>{l.selected=o.compare(l)})}),Nc(()=>{n.value=i(e.colors,e.color)});function a(s){e.color.fromString(e.colors[s])}function i(s,o){return s.map(l=>{const u=new _a;return u.enableAlpha=e.enableAlpha,u.format="rgba",u.fromString(l),u.selected=u.value===o.value,u})}return{rgbaColors:n,handleSelect:a,ns:t}}});function rd(e,t,r,n,a,i){return bt(),Dt("div",{class:ne(e.ns.b())},[mt("div",{class:ne(e.ns.e("colors"))},[(bt(!0),Dt(Ke,null,nr(e.rgbaColors,(s,o)=>(bt(),Dt("div",{key:e.colors[o],class:ne([e.ns.e("color-selector"),e.ns.is("alpha",s._alpha<100),{selected:s.selected}]),onClick:l=>e.handleSelect(o)},[mt("div",{style:Te({backgroundColor:s.value})},null,4)],10,["onClick"]))),128))],2)],2)}var nd=Yr(ed,[["render",rd],["__file","predefine.vue"]]);const ad=me({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=zr("color-svpanel"),r=Ti(),n=ie(0),a=ie(0),i=ie("hsl(0, 100%, 50%)"),s=se(()=>{const u=e.color.get("hue"),c=e.color.get("value");return{hue:u,value:c}});function o(){const u=e.color.get("saturation"),c=e.color.get("value"),f=r.vnode.el,{clientWidth:d,clientHeight:p}=f;a.value=u*d/100,n.value=(100-c)*p/100,i.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function l(u){const f=r.vnode.el.getBoundingClientRect(),{clientX:d,clientY:p}=fo(u);let v=d-f.left,h=p-f.top;v=Math.max(0,v),v=Math.min(v,f.width),h=Math.max(0,h),h=Math.min(h,f.height),a.value=v,n.value=h,e.color.set({saturation:v/f.width*100,value:100-h/f.height*100})}return We(()=>s.value,()=>{o()}),nn(()=>{Ca(r.vnode.el,{drag:u=>{l(u)},end:u=>{l(u)}}),o()}),{cursorTop:n,cursorLeft:a,background:i,colorValue:s,handleDrag:l,update:o,ns:t}}});function id(e,t,r,n,a,i){return bt(),Dt("div",{class:ne(e.ns.b()),style:Te({backgroundColor:e.background})},[mt("div",{class:ne(e.ns.e("white"))},null,2),mt("div",{class:ne(e.ns.e("black"))},null,2),mt("div",{class:ne(e.ns.e("cursor")),style:Te({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[mt("div")],6)],6)}var sd=Yr(ad,[["render",id],["__file","sv-panel.vue"]]);const od=me({name:"ElColorPicker"}),ld=me({...od,props:Kf,emits:Zf,setup(e,{expose:t,emit:r}){const n=e,{t:a}=io(),i=zr("color"),{formItem:s}=Vc(),o=$c(),l=Ba(),{inputId:u,isLabeledByFormItem:c}=Hc(n,{formItemContext:s}),f=ie(),d=ie(),p=ie(),v=ie(),h=ie(),m=ie(),{isFocused:b,handleFocus:y,handleBlur:S}=Gc(h,{beforeFocus(){return l.value},beforeBlur(Y){var ot;return(ot=v.value)==null?void 0:ot.isFocusInsideContent(Y)},afterBlur(){pt(!1),Nt()}});let C=!0;const R=Pr(new _a({enableAlpha:n.showAlpha,format:n.colorFormat||"",value:n.modelValue})),D=ie(!1),I=ie(!1),W=ie(""),G=se(()=>!n.modelValue&&!I.value?"transparent":J(R,n.showAlpha)),F=se(()=>!n.modelValue&&!I.value?"":R.value),X=se(()=>c.value?void 0:n.ariaLabel||a("el.colorpicker.defaultLabel")),M=se(()=>c.value?s==null?void 0:s.labelId:void 0),st=se(()=>[i.b("picker"),i.is("disabled",l.value),i.bm("picker",o.value),i.is("focused",b.value)]);function J(Y,ot){if(!(Y instanceof _a))throw new TypeError("color should be instance of _color Class");const{r:_t,g:Ct,b:Vt}=Y.toRgb();return ot?`rgba(${_t}, ${Ct}, ${Vt}, ${Y.get("alpha")/100})`:`rgb(${_t}, ${Ct}, ${Vt})`}function pt(Y){D.value=Y}const zt=_i(pt,100,{leading:!0});function Xt(){l.value||pt(!0)}function Ht(){zt(!1),Nt()}function Nt(){Gn(()=>{n.modelValue?R.fromString(n.modelValue):(R.value="",Gn(()=>{I.value=!1}))})}function yt(){l.value||zt(!D.value)}function It(){R.fromString(W.value)}function Rt(){const Y=R.value;r(vi,Y),r("change",Y),n.validateEvent&&(s==null||s.validate("change").catch(ot=>ys())),zt(!1),Gn(()=>{const ot=new _a({enableAlpha:n.showAlpha,format:n.colorFormat||"",value:n.modelValue});R.compare(ot)||Nt()})}function Mt(){zt(!1),r(vi,null),r("change",null),n.modelValue!==null&&n.validateEvent&&(s==null||s.validate("change").catch(Y=>ys())),Nt()}function lt(){D.value&&(Ht(),b.value&&V())}function Bt(Y){Y.preventDefault(),Y.stopPropagation(),pt(!1),Nt()}function O(Y){switch(Y.code){case un.enter:case un.numpadEnter:case un.space:Y.preventDefault(),Y.stopPropagation(),Xt(),m.value.focus();break;case un.esc:Bt(Y);break}}function V(){h.value.focus()}function _(){h.value.blur()}return nn(()=>{n.modelValue&&(W.value=F.value)}),We(()=>n.modelValue,Y=>{Y?Y&&Y!==R.value&&(C=!1,R.fromString(Y)):I.value=!1}),We(()=>[n.colorFormat,n.showAlpha],()=>{R.enableAlpha=n.showAlpha,R.format=n.colorFormat||R.format,R.doOnChange(),r(vi,R.value)}),We(()=>F.value,Y=>{W.value=Y,C&&r("activeChange",Y),C=!0}),We(()=>R.value,()=>{!n.modelValue&&!I.value&&(I.value=!0)}),We(()=>D.value,()=>{Gn(()=>{var Y,ot,_t;(Y=f.value)==null||Y.update(),(ot=d.value)==null||ot.update(),(_t=p.value)==null||_t.update()})}),x0(O0,{currentColor:F}),t({color:R,show:Xt,hide:Ht,focus:V,blur:_}),(Y,ot)=>(bt(),Ee(P(Di),{ref_key:"popper",ref:v,visible:D.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[P(i).be("picker","panel"),P(i).b("dropdown"),Y.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:Y.teleported,transition:`${P(i).namespace.value}-zoom-in-top`,persistent:"",onHide:_t=>pt(!1)},{content:Tt(()=>[rr((bt(),Dt("div",{onKeydown:Jr(Bt,["esc"])},[mt("div",{class:ne(P(i).be("dropdown","main-wrapper"))},[et(qf,{ref_key:"hue",ref:f,class:"hue-slider",color:P(R),vertical:""},null,8,["color"]),et(sd,{ref_key:"sv",ref:d,color:P(R)},null,8,["color"])],2),Y.showAlpha?(bt(),Ee(Yf,{key:0,ref_key:"alpha",ref:p,color:P(R)},null,8,["color"])):xe("v-if",!0),Y.predefine?(bt(),Ee(nd,{key:1,ref:"predefine","enable-alpha":Y.showAlpha,color:P(R),colors:Y.predefine},null,8,["enable-alpha","color","colors"])):xe("v-if",!0),mt("div",{class:ne(P(i).be("dropdown","btns"))},[mt("span",{class:ne(P(i).be("dropdown","value"))},[et(P(Ur),{ref_key:"inputRef",ref:m,modelValue:W.value,"onUpdate:modelValue":_t=>W.value=_t,"validate-event":!1,size:"small",onKeyup:Jr(It,["enter"]),onBlur:It},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),et(P(Gr),{class:ne(P(i).be("dropdown","link-btn")),text:"",size:"small",onClick:Mt},{default:Tt(()=>[Ye(ye(P(a)("el.colorpicker.clear")),1)]),_:1},8,["class"]),et(P(Gr),{plain:"",size:"small",class:ne(P(i).be("dropdown","btn")),onClick:Rt},{default:Tt(()=>[Ye(ye(P(a)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[P(Lf),lt]])]),default:Tt(()=>[mt("div",jn({id:P(u),ref_key:"triggerRef",ref:h},Y.$attrs,{class:P(st),role:"button","aria-label":P(X),"aria-labelledby":P(M),"aria-description":P(a)("el.colorpicker.description",{color:Y.modelValue||""}),"aria-disabled":P(l),tabindex:P(l)?-1:Y.tabindex,onKeydown:O,onFocus:P(y),onBlur:P(S)}),[P(l)?(bt(),Dt("div",{key:0,class:ne(P(i).be("picker","mask"))},null,2)):xe("v-if",!0),mt("div",{class:ne(P(i).be("picker","trigger")),onClick:yt},[mt("span",{class:ne([P(i).be("picker","color"),P(i).is("alpha",Y.showAlpha)])},[mt("span",{class:ne(P(i).be("picker","color-inner")),style:Te({backgroundColor:P(G)})},[rr(et(P(Ue),{class:ne([P(i).be("picker","icon"),P(i).is("icon-arrow-down")])},{default:Tt(()=>[et(P(Wc))]),_:1},8,["class"]),[[vn,Y.modelValue||I.value]]),rr(et(P(Ue),{class:ne([P(i).be("picker","empty"),P(i).is("icon-close")])},{default:Tt(()=>[et(P(so))]),_:1},8,["class"]),[[vn,!Y.modelValue&&!I.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var ud=Yr(ld,[["__file","color-picker.vue"]]);const cd=oo(ud),fd=bn({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:Le(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:Le([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:Le(Function),default:e=>`${e}%`}}),dd=me({name:"ElProgress"}),vd=me({...dd,props:fd,setup(e){const t=e,r={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},n=zr("progress"),a=se(()=>{const S={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},C=y(t.percentage);return C.includes("gradient")?S.background=C:S.backgroundColor=C,S}),i=se(()=>(t.strokeWidth/t.width*100).toFixed(1)),s=se(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(i.value)/2}`,10):0),o=se(()=>{const S=s.value,C=t.type==="dashboard";return`
          M 50 50
          m 0 ${C?"":"-"}${S}
          a ${S} ${S} 0 1 1 0 ${C?"-":""}${S*2}
          a ${S} ${S} 0 1 1 0 ${C?"":"-"}${S*2}
          `}),l=se(()=>2*Math.PI*s.value),u=se(()=>t.type==="dashboard"?.75:1),c=se(()=>`${-1*l.value*(1-u.value)/2}px`),f=se(()=>({strokeDasharray:`${l.value*u.value}px, ${l.value}px`,strokeDashoffset:c.value})),d=se(()=>({strokeDasharray:`${l.value*u.value*(t.percentage/100)}px, ${l.value}px`,strokeDashoffset:c.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),p=se(()=>{let S;return t.color?S=y(t.percentage):S=r[t.status]||r.default,S}),v=se(()=>t.status==="warning"?Xc:t.type==="line"?t.status==="success"?y0:Yc:t.status==="success"?S0:so),h=se(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),m=se(()=>t.format(t.percentage));function b(S){const C=100/S.length;return S.map((D,I)=>An(D)?{color:D,percentage:(I+1)*C}:D).sort((D,I)=>D.percentage-I.percentage)}const y=S=>{var C;const{color:R}=t;if(w0(R))return R(S);if(An(R))return R;{const D=b(R);for(const I of D)if(I.percentage>S)return I.color;return(C=D[D.length-1])==null?void 0:C.color}};return(S,C)=>(bt(),Dt("div",{class:ne([P(n).b(),P(n).m(S.type),P(n).is(S.status),{[P(n).m("without-text")]:!S.showText,[P(n).m("text-inside")]:S.textInside}]),role:"progressbar","aria-valuenow":S.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[S.type==="line"?(bt(),Dt("div",{key:0,class:ne(P(n).b("bar"))},[mt("div",{class:ne(P(n).be("bar","outer")),style:Te({height:`${S.strokeWidth}px`})},[mt("div",{class:ne([P(n).be("bar","inner"),{[P(n).bem("bar","inner","indeterminate")]:S.indeterminate},{[P(n).bem("bar","inner","striped")]:S.striped},{[P(n).bem("bar","inner","striped-flow")]:S.stripedFlow}]),style:Te(P(a))},[(S.showText||S.$slots.default)&&S.textInside?(bt(),Dt("div",{key:0,class:ne(P(n).be("bar","innerText"))},[hr(S.$slots,"default",{percentage:S.percentage},()=>[mt("span",null,ye(P(m)),1)])],2)):xe("v-if",!0)],6)],6)],2)):(bt(),Dt("div",{key:1,class:ne(P(n).b("circle")),style:Te({height:`${S.width}px`,width:`${S.width}px`})},[(bt(),Dt("svg",{viewBox:"0 0 100 100"},[mt("path",{class:ne(P(n).be("circle","track")),d:P(o),stroke:`var(${P(n).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":S.strokeLinecap,"stroke-width":P(i),fill:"none",style:Te(P(f))},null,14,["d","stroke","stroke-linecap","stroke-width"]),mt("path",{class:ne(P(n).be("circle","path")),d:P(o),stroke:P(p),fill:"none",opacity:S.percentage?1:0,"stroke-linecap":S.strokeLinecap,"stroke-width":P(i),style:Te(P(d))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(S.showText||S.$slots.default)&&!S.textInside?(bt(),Dt("div",{key:2,class:ne(P(n).e("text")),style:Te({fontSize:`${P(h)}px`})},[hr(S.$slots,"default",{percentage:S.percentage},()=>[S.status?(bt(),Ee(P(Ue),{key:1},{default:Tt(()=>[(bt(),Ee(Ln(P(v))))]),_:1})):(bt(),Dt("span",{key:0},ye(P(m)),1))])],6)):xe("v-if",!0)],10,["aria-valuenow"]))}});var hd=Yr(vd,[["__file","progress.vue"]]);const pd=oo(hd),P0=Symbol("uploadContextKey"),gd="ElUpload";class md extends Error{constructor(t,r,n,a){super(t),this.name="UploadAjaxError",this.status=r,this.method=n,this.url=a}}function xl(e,t,r){let n;return r.response?n=`${r.response.error||r.response}`:r.responseText?n=`${r.responseText}`:n=`fail to ${t.method} ${e} ${r.status}`,new md(n,r.status,t.method,e)}function _d(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const bd=e=>{typeof XMLHttpRequest>"u"&&lo(gd,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,r=e.action;t.upload&&t.upload.addEventListener("progress",i=>{const s=i;s.percent=i.total>0?i.loaded/i.total*100:0,e.onProgress(s)});const n=new FormData;if(e.data)for(const[i,s]of Object.entries(e.data))C0(s)&&s.length?n.append(i,...s):n.append(i,s);n.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(xl(r,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(xl(r,e,t));e.onSuccess(_d(t))}),t.open(e.method,r,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const a=e.headers||{};if(a instanceof Headers)a.forEach((i,s)=>t.setRequestHeader(s,i));else for(const[i,s]of Object.entries(a))ma(s)||t.setRequestHeader(i,String(s));return t.send(n),t},L0=["text","picture","picture-card"];let xd=1;const Es=()=>Date.now()+xd++,F0=bn({action:{type:String,default:"#"},headers:{type:Le(Object)},method:{type:String,default:"post"},data:{type:Le([Object,Function,Promise]),default:()=>Ss({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:Le(Array),default:()=>Ss([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:L0,default:"text"},httpRequest:{type:Le(Function),default:bd},disabled:Boolean,limit:Number}),yd=bn({...F0,beforeUpload:{type:Le(Function),default:pr},beforeRemove:{type:Le(Function)},onRemove:{type:Le(Function),default:pr},onChange:{type:Le(Function),default:pr},onPreview:{type:Le(Function),default:pr},onSuccess:{type:Le(Function),default:pr},onProgress:{type:Le(Function),default:pr},onError:{type:Le(Function),default:pr},onExceed:{type:Le(Function),default:pr},crossorigin:{type:Le(String)}}),Sd=bn({files:{type:Le(Array),default:()=>Ss([])},disabled:{type:Boolean,default:!1},handlePreview:{type:Le(Function),default:pr},listType:{type:String,values:L0,default:"text"},crossorigin:{type:Le(String)}}),wd={remove:e=>!!e},Cd=me({name:"ElUploadList"}),Ed=me({...Cd,props:Sd,emits:wd,setup(e,{emit:t}){const r=e,{t:n}=io(),a=zr("upload"),i=zr("icon"),s=zr("list"),o=Ba(),l=ie(!1),u=se(()=>[a.b("list"),a.bm("list",r.listType),a.is("disabled",r.disabled)]),c=f=>{t("remove",f)};return(f,d)=>(bt(),Ee(Kc,{tag:"ul",class:ne(P(u)),name:P(s).b()},{default:Tt(()=>[(bt(!0),Dt(Ke,null,nr(f.files,(p,v)=>(bt(),Dt("li",{key:p.uid||p.name,class:ne([P(a).be("list","item"),P(a).is(p.status),{focusing:l.value}]),tabindex:"0",onKeydown:Jr(h=>!P(o)&&c(p),["delete"]),onFocus:h=>l.value=!0,onBlur:h=>l.value=!1,onClick:h=>l.value=!1},[hr(f.$slots,"default",{file:p,index:v},()=>[f.listType==="picture"||p.status!=="uploading"&&f.listType==="picture-card"?(bt(),Dt("img",{key:0,class:ne(P(a).be("list","item-thumbnail")),src:p.url,crossorigin:f.crossorigin,alt:""},null,10,["src","crossorigin"])):xe("v-if",!0),p.status==="uploading"||f.listType!=="picture-card"?(bt(),Dt("div",{key:1,class:ne(P(a).be("list","item-info"))},[mt("a",{class:ne(P(a).be("list","item-name")),onClick:dn(h=>f.handlePreview(p),["prevent"])},[et(P(Ue),{class:ne(P(i).m("document"))},{default:Tt(()=>[et(P(Uc))]),_:1},8,["class"]),mt("span",{class:ne(P(a).be("list","item-file-name")),title:p.name},ye(p.name),11,["title"])],10,["onClick"]),p.status==="uploading"?(bt(),Ee(P(pd),{key:0,type:f.listType==="picture-card"?"circle":"line","stroke-width":f.listType==="picture-card"?6:2,percentage:Number(p.percentage),style:Te(f.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):xe("v-if",!0)],2)):xe("v-if",!0),mt("label",{class:ne(P(a).be("list","item-status-label"))},[f.listType==="text"?(bt(),Ee(P(Ue),{key:0,class:ne([P(i).m("upload-success"),P(i).m("circle-check")])},{default:Tt(()=>[et(P(y0))]),_:1},8,["class"])):["picture-card","picture"].includes(f.listType)?(bt(),Ee(P(Ue),{key:1,class:ne([P(i).m("upload-success"),P(i).m("check")])},{default:Tt(()=>[et(P(S0))]),_:1},8,["class"])):xe("v-if",!0)],2),P(o)?xe("v-if",!0):(bt(),Ee(P(Ue),{key:2,class:ne(P(i).m("close")),onClick:h=>c(p)},{default:Tt(()=>[et(P(so))]),_:2},1032,["class","onClick"])),xe(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),xe(" This is a bug which needs to be fixed "),xe(" TODO: Fix the incorrect navigation interaction "),P(o)?xe("v-if",!0):(bt(),Dt("i",{key:3,class:ne(P(i).m("close-tip"))},ye(P(n)("el.upload.deleteTip")),3)),f.listType==="picture-card"?(bt(),Dt("span",{key:4,class:ne(P(a).be("list","item-actions"))},[mt("span",{class:ne(P(a).be("list","item-preview")),onClick:h=>f.handlePreview(p)},[et(P(Ue),{class:ne(P(i).m("zoom-in"))},{default:Tt(()=>[et(P(jc))]),_:1},8,["class"])],10,["onClick"]),P(o)?xe("v-if",!0):(bt(),Dt("span",{key:0,class:ne(P(a).be("list","item-delete")),onClick:h=>c(p)},[et(P(Ue),{class:ne(P(i).m("delete"))},{default:Tt(()=>[et(P(qc))]),_:1},8,["class"])],10,["onClick"]))],2)):xe("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),hr(f.$slots,"append")]),_:3},8,["class","name"]))}});var yl=Yr(Ed,[["__file","upload-list.vue"]]);const Md=bn({disabled:{type:Boolean,default:!1}}),kd={file:e=>C0(e)},z0="ElUploadDrag",Td=me({name:z0}),Dd=me({...Td,props:Md,emits:kd,setup(e,{emit:t}){b0(P0)||lo(z0,"usage: <el-upload><el-upload-dragger /></el-upload>");const n=zr("upload"),a=ie(!1),i=Ba(),s=l=>{if(i.value)return;a.value=!1,l.stopPropagation();const u=Array.from(l.dataTransfer.files);t("file",u)},o=()=>{i.value||(a.value=!0)};return(l,u)=>(bt(),Dt("div",{class:ne([P(n).b("dragger"),P(n).is("dragover",a.value)]),onDrop:dn(s,["prevent"]),onDragover:dn(o,["prevent"]),onDragleave:dn(c=>a.value=!1,["prevent"])},[hr(l.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var Rd=Yr(Dd,[["__file","upload-dragger.vue"]]);const Ad=bn({...F0,beforeUpload:{type:Le(Function),default:pr},onRemove:{type:Le(Function),default:pr},onStart:{type:Le(Function),default:pr},onSuccess:{type:Le(Function),default:pr},onProgress:{type:Le(Function),default:pr},onError:{type:Le(Function),default:pr},onExceed:{type:Le(Function),default:pr}}),Bd=me({name:"ElUploadContent",inheritAttrs:!1}),Id=me({...Bd,props:Ad,setup(e,{expose:t}){const r=e,n=zr("upload"),a=Ba(),i=wa({}),s=wa(),o=h=>{if(h.length===0)return;const{autoUpload:m,limit:b,fileList:y,multiple:S,onStart:C,onExceed:R}=r;if(b&&y.length+h.length>b){R(h,y);return}S||(h=h.slice(0,1));for(const D of h){const I=D;I.uid=Es(),C(I),m&&l(I)}},l=async h=>{if(s.value.value="",!r.beforeUpload)return c(h);let m,b={};try{const S=r.data,C=r.beforeUpload(h);b=dl(r.data)?vl(r.data):r.data,m=await C,dl(r.data)&&Ff(S,b)&&(b=vl(r.data))}catch{m=!1}if(m===!1){r.onRemove(h);return}let y=h;m instanceof Blob&&(m instanceof File?y=m:y=new File([m],h.name,{type:h.type})),c(Object.assign(y,{uid:h.uid}),b)},u=async(h,m)=>w0(h)?h(m):h,c=async(h,m)=>{const{headers:b,data:y,method:S,withCredentials:C,name:R,action:D,onProgress:I,onSuccess:W,onError:G,httpRequest:F}=r;try{m=await u(m??y,h)}catch{r.onRemove(h);return}const{uid:X}=h,M={headers:b||{},withCredentials:C,file:h,data:m,method:S,filename:R,action:D,onProgress:J=>{I(J,h)},onSuccess:J=>{W(J,h),delete i.value[X]},onError:J=>{G(J,h),delete i.value[X]}},st=F(M);i.value[X]=st,st instanceof Promise&&st.then(M.onSuccess,M.onError)},f=h=>{const m=h.target.files;m&&o(Array.from(m))},d=()=>{a.value||(s.value.value="",s.value.click())},p=()=>{d()};return t({abort:h=>{Zc(i.value).filter(h?([b])=>String(h.uid)===b:()=>!0).forEach(([b,y])=>{y instanceof XMLHttpRequest&&y.abort(),delete i.value[b]})},upload:l}),(h,m)=>(bt(),Dt("div",{class:ne([P(n).b(),P(n).m(h.listType),P(n).is("drag",h.drag),P(n).is("disabled",P(a))]),tabindex:P(a)?"-1":"0",onClick:d,onKeydown:Jr(dn(p,["self"]),["enter","space"])},[h.drag?(bt(),Ee(Rd,{key:0,disabled:P(a),onFile:o},{default:Tt(()=>[hr(h.$slots,"default")]),_:3},8,["disabled"])):hr(h.$slots,"default",{key:1}),mt("input",{ref_key:"inputRef",ref:s,class:ne(P(n).e("input")),name:h.name,disabled:P(a),multiple:h.multiple,accept:h.accept,type:"file",onChange:f,onClick:dn(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var Sl=Yr(Id,[["__file","upload-content.vue"]]);const wl="ElUpload",Cl=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},Od=(e,t)=>{const r=Qc(e,"fileList",void 0,{passive:!0}),n=p=>r.value.find(v=>v.uid===p.uid);function a(p){var v;(v=t.value)==null||v.abort(p)}function i(p=["ready","uploading","success","fail"]){r.value=r.value.filter(v=>!p.includes(v.status))}function s(p){r.value=r.value.filter(v=>v!==p)}const o=(p,v)=>{const h=n(v);h&&(console.error(p),h.status="fail",s(h),e.onError(p,h,r.value),e.onChange(h,r.value))},l=(p,v)=>{const h=n(v);h&&(e.onProgress(p,h,r.value),h.status="uploading",h.percentage=Math.round(p.percent))},u=(p,v)=>{const h=n(v);h&&(h.status="success",h.response=p,e.onSuccess(p,h,r.value),e.onChange(h,r.value))},c=p=>{ma(p.uid)&&(p.uid=Es());const v={name:p.name,percentage:0,status:"ready",size:p.size,raw:p,uid:p.uid};if(e.listType==="picture-card"||e.listType==="picture")try{v.url=URL.createObjectURL(p)}catch(h){ys(wl,h.message),e.onError(h,v,r.value)}r.value=[...r.value,v],e.onChange(v,r.value)},f=async p=>{const v=p instanceof File?n(p):p;v||lo(wl,"file to be removed not found");const h=m=>{a(m),s(m),e.onRemove(m,r.value),Cl(m)};e.beforeRemove?await e.beforeRemove(v,r.value)!==!1&&h(v):h(v)};function d(){r.value.filter(({status:p})=>p==="ready").forEach(({raw:p})=>{var v;return p&&((v=t.value)==null?void 0:v.upload(p))})}return We(()=>e.listType,p=>{p!=="picture-card"&&p!=="picture"||(r.value=r.value.map(v=>{const{raw:h,url:m}=v;if(!m&&h)try{v.url=URL.createObjectURL(h)}catch(b){e.onError(b,v,r.value)}return v}))}),We(r,p=>{for(const v of p)v.uid||(v.uid=Es()),v.status||(v.status="success")},{immediate:!0,deep:!0}),{uploadFiles:r,abort:a,clearFiles:i,handleError:o,handleProgress:l,handleStart:c,handleSuccess:u,handleRemove:f,submit:d,revokeFileObjectURL:Cl}},Pd=me({name:"ElUpload"}),Ld=me({...Pd,props:yd,setup(e,{expose:t}){const r=e,n=Ba(),a=wa(),{abort:i,submit:s,clearFiles:o,uploadFiles:l,handleStart:u,handleError:c,handleRemove:f,handleSuccess:d,handleProgress:p,revokeFileObjectURL:v}=Od(r,a),h=se(()=>r.listType==="picture-card"),m=se(()=>({...r,fileList:l.value,onStart:u,onProgress:p,onSuccess:d,onError:c,onRemove:f}));return Jc(()=>{l.value.forEach(v)}),x0(P0,{accept:tf(r,"accept")}),t({abort:i,submit:s,clearFiles:o,handleStart:u,handleRemove:f}),(b,y)=>(bt(),Dt("div",null,[P(h)&&b.showFileList?(bt(),Ee(yl,{key:0,disabled:P(n),"list-type":b.listType,files:P(l),crossorigin:b.crossorigin,"handle-preview":b.onPreview,onRemove:P(f)},hl({append:Tt(()=>[et(Sl,jn({ref_key:"uploadRef",ref:a},P(m)),{default:Tt(()=>[b.$slots.trigger?hr(b.$slots,"trigger",{key:0}):xe("v-if",!0),!b.$slots.trigger&&b.$slots.default?hr(b.$slots,"default",{key:1}):xe("v-if",!0)]),_:3},16)]),_:2},[b.$slots.file?{name:"default",fn:Tt(({file:S,index:C})=>[hr(b.$slots,"file",{file:S,index:C})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):xe("v-if",!0),!P(h)||P(h)&&!b.showFileList?(bt(),Ee(Sl,jn({key:1,ref_key:"uploadRef",ref:a},P(m)),{default:Tt(()=>[b.$slots.trigger?hr(b.$slots,"trigger",{key:0}):xe("v-if",!0),!b.$slots.trigger&&b.$slots.default?hr(b.$slots,"default",{key:1}):xe("v-if",!0)]),_:3},16)):xe("v-if",!0),b.$slots.trigger?hr(b.$slots,"default",{key:2}):xe("v-if",!0),hr(b.$slots,"tip"),!P(h)&&b.showFileList?(bt(),Ee(yl,{key:3,disabled:P(n),"list-type":b.listType,files:P(l),crossorigin:b.crossorigin,"handle-preview":b.onPreview,onRemove:P(f)},hl({_:2},[b.$slots.file?{name:"default",fn:Tt(({file:S,index:C})=>[hr(b.$slots,"file",{file:S,index:C})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):xe("v-if",!0)]))}});var Fd=Yr(Ld,[["__file","upload.vue"]]);const zd=oo(Fd),Nd={class:"flex flex-1 gap-3 items-center"},Vd={class:"font-semibold flex-shrink-0"},Me=me({__name:"AttrCol",props:{name:{},nowrap:{type:Boolean}},setup(e){return(t,r)=>(bt(),Dt("div",Nd,[mt("div",Vd,ye(t.name),1),mt("div",{class:ne(["flex-1 overflow-hidden font-thin",{"overflow-ellipsis whitespace-nowrap":t.nowrap}])},[hr(t.$slots,"default")],2)]))}}),$d=["rgba(0,0,0,0)","#000","#fff","#fafafa","#f5f5f5","#EBEBEB","#D9D9D9","#BFBFBF","#8C8C8C","#595959","#262626","#1E2026","#292C34","#31353E","#3A3F49","#4C525D","#7A808B","#AAAFBB","#C7CBD5","#EDEEF2","#3f3ddf","#3875FF","#21B0FF","#1CD2C8","#F6BD15","#FF9846","#E96452","#896AFF","#5E7092","#213474"],Hd="";function ra(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}const na=function(e,t){const{componentPrefix:r=Hd}=t||{};e.component(`${r}${this.name}`,this)},is={};var La={name:"Checkboard",props:{size:{type:[Number,String],default:8},white:{type:String,default:"#fff"},grey:{type:String,default:"#e6e6e6"}},computed:{bgStyle(){return{"background-image":`url(${Wd(this.white,this.grey,this.size)})`}}}};function Gd(e,t,r){if(typeof document>"u")return null;const n=document.createElement("canvas");n.width=n.height=r*2;const a=n.getContext("2d");return a?(a.fillStyle=e,a.fillRect(0,0,n.width,n.height),a.fillStyle=t,a.fillRect(0,0,r,r),a.translate(r,r),a.fillRect(0,0,r,r),n.toDataURL()):null}function Wd(e,t,r){const n=`${e},${t},${r}`;if(is[n])return is[n];const a=Gd(e,t,r);return is[n]=a,a}function Xd(e,t,r,n,a,i){return bt(),Dt("div",{class:"vc-checkerboard",style:Te(i.bgStyle)},null,4)}var Yd=".vc-checkerboard{background-size:contain;bottom:0;left:0;position:absolute;right:0;top:0}";ra(Yd);La.render=Xd;La.__file="src/components/checkboard/checkboard.vue";La.install=na;var Oi={name:"Alpha",components:{Checkboard:La},props:{value:Object,onChange:Function},computed:{colors(){return this.value},gradientColor(){const{rgba:e}=this.colors,t=[e.r,e.g,e.b].join(",");return`linear-gradient(to right, rgba(${t}, 0) 0%, rgba(${t}, 1) 100%)`}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:r}=this.$refs;if(!r)return;const n=r.clientWidth,a=r.getBoundingClientRect().left+window.pageXOffset,s=(e.pageX||(e.touches?e.touches[0].pageX:0))-a;let o;s<0?o=0:s>n?o=1:o=Math.round(s*100/n)/100,this.colors.a!==o&&this.$emit("change",{h:this.colors.hsl.h,s:this.colors.hsl.s,l:this.colors.hsl.l,a:o,source:"rgba"})},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const Ud={class:"vc-alpha"},jd={class:"vc-alpha-checkboard-wrap"},qd=mt("div",{class:"vc-alpha-picker"},null,-1),Kd=[qd];function Zd(e,t,r,n,a,i){const s=$n("Checkboard");return bt(),Dt("div",Ud,[mt("div",jd,[et(s)]),mt("div",{class:"vc-alpha-gradient",style:Te({background:i.gradientColor})},null,4),mt("div",{ref:"container",class:"vc-alpha-container",onMousedown:t[0]||(t[0]=(...o)=>i.handleMouseDown&&i.handleMouseDown(...o)),onTouchmove:t[1]||(t[1]=(...o)=>i.handleChange&&i.handleChange(...o)),onTouchstart:t[2]||(t[2]=(...o)=>i.handleChange&&i.handleChange(...o))},[mt("div",{class:"vc-alpha-pointer",style:Te({left:`${i.colors.a*100}%`})},Kd,4)],544)])}var Qd=".vc-alpha,.vc-alpha-checkboard-wrap{bottom:0;left:0;position:absolute;right:0;top:0}.vc-alpha-checkboard-wrap{overflow:hidden}.vc-alpha-gradient{bottom:0;left:0;position:absolute;right:0;top:0}.vc-alpha-container{cursor:pointer;height:100%;margin:0 3px;position:relative;z-index:2}.vc-alpha-pointer{position:absolute;z-index:2}.vc-alpha-picker{background:#fff;border-radius:1px;box-shadow:0 0 2px rgba(0,0,0,.6);cursor:pointer;height:8px;margin-top:1px;transform:translateX(-2px);width:4px}";ra(Qd);Oi.render=Zd;Oi.__file="src/components/alpha/alpha.vue";Oi.install=na;function ln(...e){return new ef(...e)}function ss(e,t){const r=e&&e.a;let n;e&&e.hsl?n=ln(e.hsl):e&&e.hex&&e.hex.length>0?n=ln(e.hex):e&&e.hsv?n=ln(e.hsv):e&&e.rgba?n=ln(e.rgba):e&&e.rgb?n=ln(e.rgb):n=ln(e),n&&(n._a===void 0||n._a===null)&&n.setAlpha(r||n.getAlpha());const a=n.toHsl(),i=n.toHsv();return a.s===0&&(i.h=a.h=e.h||e.hsl&&e.hsl.h||t||0),i.v<.0164&&(i.h=e.h||e.hsv&&e.hsv.h||0,i.s=e.s||e.hsv&&e.hsv.s||0),a.l<.01&&(a.h=e.h||e.hsl&&e.hsl.h||0,a.s=e.s||e.hsl&&e.hsl.s||0),{hsl:a,hex:n.toHexString().toUpperCase(),hex8:n.toHex8String().toUpperCase(),rgba:n.toRgb(),hsv:i,oldHue:e.h||t||a.h,source:e.source,a:n.getAlpha()}}var Jd={model:{prop:"modelValue",event:"update:modelValue"},props:["modelValue"],data(){return{val:ss(this.modelValue)}},computed:{colors:{get(){return this.val},set(e){this.val=e,this.$emit("update:modelValue",e)}}},watch:{modelValue(e){this.val=ss(e)}},methods:{colorChange(e,t){this.oldHue=this.colors.hsl.h,this.colors=ss(e,t||this.oldHue)},isValidHex(e){return ln(e).isValid},simpleCheckForValidColor(e){const t=["r","g","b","a","h","s","l","v"];let r=0,n=0;for(let a=0;a<t.length;a++){const i=t[a];e[i]&&(r++,isNaN(e[i])||n++)}if(r===n)return e},paletteUpperCase(e){return e.map(t=>t.toUpperCase())},isTransparent(e){return ln(e).getAlpha()===0}}},Pi={name:"EditableInput",props:{label:String,labelText:String,desc:String,value:[String,Number],max:Number,min:Number,arrowOffset:{type:Number,default:1}},computed:{val:{get(){return this.value},set(e){if(this.max!==void 0&&+e>this.max)this.$refs.input.value=this.max;else return e}},labelId(){return`input__label__${this.label}__${Math.random().toString().slice(2,5)}`},labelSpanText(){return this.labelText||this.label}},methods:{update(e){this.handleChange(e.target.value)},handleChange(e){const t={};t[this.label]=e,t.hex===void 0&&t["#"]===void 0?this.$emit("change",t):e.length>5&&this.$emit("change",t)},handleKeyDown(e){let{val:t}=this;const r=Number(t);if(r){const n=this.arrowOffset||1;e.keyCode===38&&(t=r+n,this.handleChange(t),e.preventDefault()),e.keyCode===40&&(t=r-n,this.handleChange(t),e.preventDefault())}}}};const t1={class:"vc-editable-input"},e1=["aria-labelledby"],r1=["id","for"],n1={class:"vc-input__desc"};function a1(e,t,r,n,a,i){return bt(),Dt("div",t1,[rr(mt("input",{ref:"input","onUpdate:modelValue":t[0]||(t[0]=s=>i.val=s),"aria-labelledby":i.labelId,class:"vc-input__input",onKeydown:t[1]||(t[1]=(...s)=>i.handleKeyDown&&i.handleKeyDown(...s)),onInput:t[2]||(t[2]=(...s)=>i.update&&i.update(...s))},null,40,e1),[[rf,i.val]]),mt("span",{id:i.labelId,for:r.label,class:"vc-input__label"},ye(i.labelSpanText),9,r1),mt("span",n1,ye(r.desc),1)])}var i1=".vc-editable-input{position:relative}.vc-input__input{border:0;outline:none;padding:0}.vc-input__label{text-transform:capitalize}";ra(i1);Pi.render=a1;Pi.__file="src/components/editable-input/editable-input.vue";Pi.install=na;function os(e,t,r){return t<r?e<t?t:e>r?r:e:e<r?r:e>t?t:e}var Li={name:"Saturation",props:{value:Object},computed:{colors(){return this.value},bgColor(){return`hsl(${this.colors.hsv.h}, 100%, 50%)`},pointerTop(){return`${-(this.colors.hsv.v*100)+1+100}%`},pointerLeft(){return`${this.colors.hsv.s*100}%`}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:r}=this.$refs;if(!r)return;const n=r.clientWidth,a=r.clientHeight,i=r.getBoundingClientRect().left+window.pageXOffset,s=r.getBoundingClientRect().top+window.pageYOffset,o=e.pageX||(e.touches?e.touches[0].pageX:0),l=e.pageY||(e.touches?e.touches[0].pageY:0),u=os(o-i,0,n),c=os(l-s,0,a),f=u/n,d=os(-(c/a)+1,0,1);this.onChange({h:this.colors.hsv.h,s:f,v:d,a:this.colors.hsv.a,source:"hsva"})},onChange(e){this.$emit("change",e)},handleMouseDown(e){window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const s1=mt("div",{class:"vc-saturation--white"},null,-1),o1=mt("div",{class:"vc-saturation--black"},null,-1),l1=mt("div",{class:"vc-saturation-circle"},null,-1),u1=[l1];function c1(e,t,r,n,a,i){return bt(),Dt("div",{ref:"container",class:"vc-saturation",style:Te({background:i.bgColor}),onMousedown:t[0]||(t[0]=(...s)=>i.handleMouseDown&&i.handleMouseDown(...s)),onTouchmove:t[1]||(t[1]=(...s)=>i.handleChange&&i.handleChange(...s)),onTouchstart:t[2]||(t[2]=(...s)=>i.handleChange&&i.handleChange(...s))},[s1,o1,mt("div",{class:"vc-saturation-pointer",style:Te({top:i.pointerTop,left:i.pointerLeft})},u1,4)],36)}var f1=".vc-saturation,.vc-saturation--black,.vc-saturation--white{bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.vc-saturation--white{background:linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.vc-saturation--black{background:linear-gradient(0deg,#000,transparent)}.vc-saturation-pointer{cursor:pointer;position:absolute}.vc-saturation-circle{border-radius:50%;box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgba(0,0,0,.3),0 0 1px 2px rgba(0,0,0,.4);cursor:head;height:4px;transform:translate(-2px,-2px);width:4px}";ra(f1);Li.render=c1;Li.__file="src/components/saturation/saturation.vue";Li.install=na;var Fi={name:"Hue",props:{value:Object,direction:{type:String,default:"horizontal"}},data(){return{oldHue:0,pullDirection:""}},computed:{colors(){return this.value},directionClass(){return{"vc-hue--horizontal":this.direction==="horizontal","vc-hue--vertical":this.direction==="vertical"}},pointerTop(){return this.direction==="vertical"?this.colors.hsl.h===0&&this.pullDirection==="right"?0:`${-(this.colors.hsl.h*100/360)+100}%`:0},pointerLeft(){return this.direction==="vertical"?0:this.colors.hsl.h===0&&this.pullDirection==="right"?"100%":`${this.colors.hsl.h*100/360}%`}},watch:{value:{handler(e,t){const{h:r}=e.hsl;r!==0&&r-this.oldHue>0&&(this.pullDirection="right"),r!==0&&r-this.oldHue<0&&(this.pullDirection="left"),this.oldHue=r},deep:!0,immediate:!0}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:r}=this.$refs;if(!r)return;const n=r.clientWidth,a=r.clientHeight,i=r.getBoundingClientRect().left+window.pageXOffset,s=r.getBoundingClientRect().top+window.pageYOffset,o=e.pageX||(e.touches?e.touches[0].pageX:0),l=e.pageY||(e.touches?e.touches[0].pageY:0),u=o-i,c=l-s;let f,d;this.direction==="vertical"?(c<0?f=360:c>a?f=0:(d=-(c*100/a)+100,f=360*d/100),this.colors.hsl.h!==f&&this.$emit("change",{h:f,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"})):(u<0?f=0:u>n?f=360:(d=u*100/n,f=360*d/100),this.colors.hsl.h!==f&&this.$emit("change",{h:f,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"}))},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const d1=["aria-valuenow"],v1=mt("div",{class:"vc-hue-picker"},null,-1),h1=[v1];function p1(e,t,r,n,a,i){return bt(),Dt("div",{class:ne(["vc-hue",[i.directionClass]])},[mt("div",{ref:"container",class:"vc-hue-container",role:"slider","aria-valuenow":i.colors.hsl.h,"aria-valuemin":"0","aria-valuemax":"360",onMousedown:t[0]||(t[0]=(...s)=>i.handleMouseDown&&i.handleMouseDown(...s)),onTouchmove:t[1]||(t[1]=(...s)=>i.handleChange&&i.handleChange(...s)),onTouchstart:t[2]||(t[2]=(...s)=>i.handleChange&&i.handleChange(...s))},[mt("div",{class:"vc-hue-pointer",style:Te({top:i.pointerTop,left:i.pointerLeft}),role:"presentation"},h1,4)],40,d1)],2)}var g1=".vc-hue{border-radius:2px;bottom:0;left:0;position:absolute;right:0;top:0}.vc-hue--horizontal{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.vc-hue--vertical{background:linear-gradient(0deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.vc-hue-container{cursor:pointer;height:100%;margin:0 2px;position:relative}.vc-hue-pointer{position:absolute;z-index:2}.vc-hue-picker{background:#fff;border-radius:1px;box-shadow:0 0 2px rgba(0,0,0,.6);cursor:pointer;height:8px;margin-top:1px;transform:translateX(-2px);width:4px}";ra(g1);Fi.render=p1;Fi.__file="src/components/hue/hue.vue";Fi.install=na;const m1=["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF","rgba(0,0,0,0)"];var zi={name:"Sketch",components:{Saturation:Li,Hue:Fi,Alpha:Oi,EdIn:Pi,Checkboard:La},mixins:[Jd],props:{presetColors:{type:Array,default(){return m1}},disableAlpha:{type:Boolean,default:!1},disableFields:{type:Boolean,default:!1}},computed:{hex(){let e;return this.colors.a<1?e=this.colors.hex8:e=this.colors.hex,e.replace("#","")},activeColor(){const{rgba:e}=this.colors;return`rgba(${[e.r,e.g,e.b,e.a].join(",")})`}},methods:{handlePreset(e){this.colorChange(e)},childChange(e){this.colorChange(e)},inputChange(e){e&&(e.hex?this.isValidHex(e.hex)&&this.colorChange({hex:e.hex,source:"hex"}):(e.r||e.g||e.b||e.a)&&this.colorChange({r:e.r||this.colors.rgba.r,g:e.g||this.colors.rgba.g,b:e.b||this.colors.rgba.b,a:e.a||this.colors.rgba.a,source:"rgba"}))}}};const _1={class:"vc-sketch-saturation-wrap"},b1={class:"vc-sketch-controls"},x1={class:"vc-sketch-sliders"},y1={class:"vc-sketch-hue-wrap"},S1={key:0,class:"vc-sketch-alpha-wrap"},w1={class:"vc-sketch-color-wrap"},C1=["aria-label"],E1={key:0,class:"vc-sketch-field"},M1={class:"vc-sketch-field--double"},k1={class:"vc-sketch-field--single"},T1={class:"vc-sketch-field--single"},D1={class:"vc-sketch-field--single"},R1={key:0,class:"vc-sketch-field--single"},A1={class:"vc-sketch-presets",role:"group","aria-label":"A color preset, pick one to set as current color"},B1=["aria-label","onClick"],I1=["aria-label","onClick"];function O1(e,t,r,n,a,i){const s=$n("Saturation"),o=$n("Hue"),l=$n("Alpha"),u=$n("Checkboard"),c=$n("EdIn");return bt(),Dt("div",{role:"application","aria-label":"Sketch color picker",class:ne(["vc-sketch",[r.disableAlpha?"vc-sketch__disable-alpha":""]])},[mt("div",_1,[et(s,{value:e.colors,onChange:i.childChange},null,8,["value","onChange"])]),mt("div",b1,[mt("div",x1,[mt("div",y1,[et(o,{value:e.colors,onChange:i.childChange},null,8,["value","onChange"])]),r.disableAlpha?xe("v-if",!0):(bt(),Dt("div",S1,[et(l,{value:e.colors,onChange:i.childChange},null,8,["value","onChange"])]))]),mt("div",w1,[mt("div",{"aria-label":`Current color is ${i.activeColor}`,class:"vc-sketch-active-color",style:Te({background:i.activeColor})},null,12,C1),et(u)])]),r.disableFields?xe("v-if",!0):(bt(),Dt("div",E1,[xe(" rgba "),mt("div",M1,[et(c,{label:"hex",value:i.hex,onChange:i.inputChange},null,8,["value","onChange"])]),mt("div",k1,[et(c,{label:"r",value:e.colors.rgba.r,onChange:i.inputChange},null,8,["value","onChange"])]),mt("div",T1,[et(c,{label:"g",value:e.colors.rgba.g,onChange:i.inputChange},null,8,["value","onChange"])]),mt("div",D1,[et(c,{label:"b",value:e.colors.rgba.b,onChange:i.inputChange},null,8,["value","onChange"])]),r.disableAlpha?xe("v-if",!0):(bt(),Dt("div",R1,[et(c,{label:"a",value:e.colors.a,"arrow-offset":.01,max:1,onChange:i.inputChange},null,8,["value","arrow-offset","onChange"])]))])),mt("div",A1,[(bt(!0),Dt(Ke,null,nr(r.presetColors,f=>(bt(),Dt(Ke,null,[e.isTransparent(f)?(bt(),Dt("div",{key:f,"aria-label":`Color:${f}`,class:"vc-sketch-presets-color",onClick:d=>i.handlePreset(f)},[et(u)],8,I1)):(bt(),Dt("div",{key:`!${f}`,class:"vc-sketch-presets-color","aria-label":`Color:${f}`,style:Te({background:f}),onClick:d=>i.handlePreset(f)},null,12,B1))],64))),256))])],2)}var P1=".vc-sketch{background:#fff;border-radius:4px;box-shadow:0 0 0 1px rgba(0,0,0,.15),0 8px 16px rgba(0,0,0,.15);box-sizing:initial;padding:10px 10px 0;position:relative;width:200px}.vc-sketch-saturation-wrap{overflow:hidden;padding-bottom:75%;position:relative;width:100%}.vc-sketch-controls{display:flex}.vc-sketch-sliders{flex:1;padding:4px 0}.vc-sketch-sliders .vc-alpha-gradient,.vc-sketch-sliders .vc-hue{border-radius:2px}.vc-sketch-alpha-wrap,.vc-sketch-hue-wrap{height:10px;position:relative}.vc-sketch-alpha-wrap{margin-top:4px;overflow:hidden}.vc-sketch-color-wrap{border-radius:3px;height:24px;margin-left:4px;margin-top:4px;position:relative;width:24px}.vc-sketch-active-color{border-radius:2px;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.15),inset 0 0 4px rgba(0,0,0,.25);left:0;position:absolute;right:0;top:0;z-index:2}.vc-sketch-color-wrap .vc-checkerboard{background-size:auto}.vc-sketch-field{display:flex;padding-top:4px}.vc-sketch-field .vc-input__input{border:none;box-shadow:inset 0 0 0 1px #ccc;font-size:10px;padding:4px 0 3px 10%;width:90%}.vc-sketch-field .vc-input__label{color:#222;display:block;font-size:11px;padding-bottom:4px;padding-top:3px;text-align:center;text-transform:capitalize}.vc-sketch-field--single{flex:1;padding-left:6px}.vc-sketch-field--double{flex:2}.vc-sketch-presets{border-top:1px solid #eee;margin-left:-10px;margin-right:-10px;padding-left:10px;padding-top:10px}.vc-sketch-presets-color{cursor:pointer;display:inline-block;height:16px;margin:0 10px 10px 0;overflow:hidden;position:relative;vertical-align:top;width:16px}.vc-sketch-presets-color,.vc-sketch-presets-color .vc-checkerboard{border-radius:3px;box-shadow:inset 0 0 0 1px rgba(0,0,0,.15)}.vc-sketch__disable-alpha .vc-sketch-color-wrap{height:10px}";ra(P1);zi.render=O1;zi.__file="src/components/sketch/sketch.vue";zi.install=na;const L1={class:"flex flex-row items-center cursor-pointer"},F1={class:"not-italic"},ls=me({__name:"ColorPicker",props:{modelValue:{type:String,default(){return""}}},emits:{"update:modelValue":e=>e!==null},setup(e,{emit:t}){const r=t;function n(a){a.rgba.a===0?r("update:modelValue",""):r("update:modelValue",a.hex)}return(a,i)=>{const s=Ai;return bt(),Ee(s,{placement:"bottom",width:220,trigger:"click"},{reference:Tt(()=>[mt("div",L1,[mt("span",{class:"w-6 h-4 block mr-1 border border-gray-500",style:Te({backgroundColor:e.modelValue})},null,4),mt("span",F1,ye(e.modelValue),1)])]),default:Tt(()=>[et(P(zi),{"model-value":e.modelValue,"onUpdate:modelValue":n,"preset-colors":P($d)},null,8,["model-value","preset-colors"])]),_:1})}}}),z1={class:"text-[12px] leading-5 flex flex-col gap-5"},N1={class:"flex"},V1={class:"w-full grid grid-cols-2 gap-4"},$1={class:"flex flex-1 gap-2 items-center"},H1={class:"flex flex-1 gap-2 items-center"},G1={class:"flex items-center gap-2"},W1={class:"flex-shrink-0"},X1={class:"flex gap-4"},Y1={class:"flex gap-4"},U1=me({__name:"TextAttr",setup(e){const t=ie(!1),r=ur(),n=se(()=>r.selectTrack);return(a,i)=>{const s=ea,o=Ri,l=Oa,u=Ur,c=jr;return rr((bt(),Dt("div",z1,[mt("div",N1,[et(Me,{name:"时长"},{default:Tt(()=>[Ye(ye(((P(n).end-P(n).start)/P(gr)).toFixed(2))+" s ",1)]),_:1}),et(Me,{name:"类型"},{default:Tt(()=>[et(s,{size:"small"},{default:Tt(()=>[Ye(ye(P(n).type),1)]),_:1})]),_:1})]),et(Me,{name:"位置"},{default:Tt(()=>[mt("div",V1,[mt("div",$1,[i[8]||(i[8]=mt("span",null,"X",-1)),et(o,{class:"flex-1",controlsPosition:"right",modelValue:P(n).centerX,"onUpdate:modelValue":i[0]||(i[0]=f=>P(n).centerX=f)},null,8,["modelValue"])]),mt("div",H1,[i[9]||(i[9]=mt("span",null,"Y",-1)),et(o,{controlsPosition:"right",modelValue:P(n).centerY,"onUpdate:modelValue":i[1]||(i[1]=f=>P(n).centerY=f)},null,8,["modelValue"])])])]),_:1}),et(Me,{name:"缩放"},{default:Tt(()=>[mt("div",G1,[et(l,{min:1,max:200,step:1,modelValue:P(n).scale,"onUpdate:modelValue":i[2]||(i[2]=f=>P(n).scale=f)},null,8,["modelValue"]),mt("div",W1,ye(P(n).scale)+" %",1)])]),_:1}),et(Me,{name:"内容"},{default:Tt(()=>[et(u,{modelValue:P(n).text,"onUpdate:modelValue":i[3]||(i[3]=f=>P(n).text=f),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1}),mt("div",X1,[et(Me,{name:"字号"},{default:Tt(()=>[et(o,{class:"w-[90%]",controlsPosition:"right",modelValue:P(n).fontSize,"onUpdate:modelValue":i[4]||(i[4]=f=>P(n).fontSize=f)},null,8,["modelValue"])]),_:1}),et(Me,{name:"背景"},{default:Tt(()=>[et(ls,{modelValue:P(n).textBackgroundColor,"onUpdate:modelValue":i[5]||(i[5]=f=>P(n).textBackgroundColor=f)},null,8,["modelValue"])]),_:1})]),mt("div",Y1,[et(Me,{name:"字体颜色"},{default:Tt(()=>[et(ls,{modelValue:P(n).fill,"onUpdate:modelValue":i[6]||(i[6]=f=>P(n).fill=f)},null,8,["modelValue"])]),_:1}),et(Me,{name:"描边颜色"},{default:Tt(()=>[et(ls,{modelValue:P(n).stroke,"onUpdate:modelValue":i[7]||(i[7]=f=>P(n).stroke=f)},null,8,["modelValue"])]),_:1})])])),[[c,P(t)]])}}}),j1={class:"text-[12px] leading-5 flex flex-col gap-5"},q1={key:0,class:"flex"},K1={key:1,class:"flex"},Z1={class:"w-full grid grid-cols-2 gap-4"},Q1={class:"flex flex-1 gap-2 items-center"},J1={class:"flex flex-1 gap-2 items-center"},tv={class:"flex items-center gap-2"},ev={class:"flex-shrink-0"},rv=me({__name:"VideoAttr",setup(e){const t=ur(),r=se(()=>t.selectTrack),n=se(()=>t.selectTrack.resource),a=async()=>{if(!r.value){qe.error("缺少重新生成所需的提示词");return}try{r.value.loading=!0,qe.info("重新生成功能需要后端支持")}catch(i){console.error("重新生成失败:",i),qe.error("重新生成失败")}finally{r.value.loading=!1}};return(i,s)=>{var p,v;const o=ea,l=Ri,u=Oa,c=Ur,f=Gr,d=jr;return rr((bt(),Dt("div",j1,[et(Me,{name:"名称",nowrap:""},{default:Tt(()=>[Ye(ye(P(r).name),1)]),_:1}),P(r)?(bt(),Dt("div",q1,[et(Me,{name:"初始时间"},{default:Tt(()=>[Ye(ye(P(n).duration.toFixed(2))+" s ",1)]),_:1}),et(Me,{name:"当前时间"},{default:Tt(()=>[Ye(ye(((P(r).end-P(r).start)/P(gr)).toFixed(2))+" s ",1)]),_:1})])):xe("",!0),P(n)?(bt(),Dt("div",K1,[et(Me,{name:"类型"},{default:Tt(()=>[et(o,{size:"small"},{default:Tt(()=>[Ye(ye(P(r).type),1)]),_:1})]),_:1}),et(Me,{name:"分辨率"},{default:Tt(()=>[Ye(ye(P(n).width)+" × "+ye(P(n).height),1)]),_:1})])):xe("",!0),et(Me,{name:"位置"},{default:Tt(()=>[mt("div",Z1,[mt("div",Q1,[s[4]||(s[4]=mt("span",null,"X",-1)),et(l,{class:"flex-1",controlsPosition:"right",modelValue:P(r).centerX,"onUpdate:modelValue":s[0]||(s[0]=h=>P(r).centerX=h)},null,8,["modelValue"])]),mt("div",J1,[s[5]||(s[5]=mt("span",null,"Y",-1)),et(l,{controlsPosition:"right",modelValue:P(r).centerY,"onUpdate:modelValue":s[1]||(s[1]=h=>P(r).centerY=h)},null,8,["modelValue"])])])]),_:1}),et(Me,{name:"缩放"},{default:Tt(()=>[mt("div",tv,[et(u,{min:1,max:200,step:1,modelValue:P(r).scale,"onUpdate:modelValue":s[2]||(s[2]=h=>P(r).scale=h)},null,8,["modelValue"]),mt("div",ev,ye(P(r).scale)+" %",1)])]),_:1}),((p=P(n).meta)==null?void 0:p.prompt)!==void 0?(bt(),Ee(Me,{key:2,name:"描述"},{default:Tt(()=>[et(c,{modelValue:P(n).meta.prompt,"onUpdate:modelValue":s[3]||(s[3]=h=>P(n).meta.prompt=h),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1})):xe("",!0),((v=P(n).meta)==null?void 0:v.model)!=="upload"?(bt(),Ee(Me,{key:3,name:"操作"},{default:Tt(()=>[et(f,{type:"primary",onClick:a},{default:Tt(()=>s[6]||(s[6]=[Ye("重新生成")])),_:1})]),_:1})):xe("",!0)])),[[d,P(r).loading]])}}}),nv={class:"text-[12px] leading-5 flex flex-col gap-5"},av={class:"flex"},iv={class:"w-full grid grid-cols-2 gap-4"},sv={class:"flex flex-1 gap-2 items-center"},ov={class:"flex flex-1 gap-2 items-center"},lv={class:"flex items-center gap-2"},uv={class:"flex-shrink-0"},cv=me({__name:"ImageAttr",setup(e){const t=ur(),r=se(()=>t.selectTrack),n=()=>{qe.info("前端模式下暂不支持重新生成功能")},a=()=>{qe.info("前端模式下暂不支持图片生成视频功能")};return(i,s)=>{const o=ea,l=Ri,u=Oa,c=Ur,f=Gr,d=jr;return rr((bt(),Dt("div",nv,[et(Me,{name:"名称",nowrap:""},{default:Tt(()=>[Ye(ye(P(r).name),1)]),_:1}),et(Me,{name:"时长"},{default:Tt(()=>[Ye(ye(((P(r).end-P(r).start)/P(gr)).toFixed(2))+" s ",1)]),_:1}),mt("div",av,[et(Me,{name:"类型"},{default:Tt(()=>[et(o,{size:"small"},{default:Tt(()=>[Ye(ye(P(r).type),1)]),_:1})]),_:1}),et(Me,{name:"分辨率"},{default:Tt(()=>[Ye(ye(P(r).width)+" × "+ye(P(r).height),1)]),_:1})]),et(Me,{name:"位置"},{default:Tt(()=>[mt("div",iv,[mt("div",sv,[s[4]||(s[4]=mt("span",null,"X",-1)),et(l,{class:"flex-1",controlsPosition:"right",modelValue:P(r).centerX,"onUpdate:modelValue":s[0]||(s[0]=p=>P(r).centerX=p)},null,8,["modelValue"])]),mt("div",ov,[s[5]||(s[5]=mt("span",null,"Y",-1)),et(l,{controlsPosition:"right",modelValue:P(r).centerY,"onUpdate:modelValue":s[1]||(s[1]=p=>P(r).centerY=p)},null,8,["modelValue"])])])]),_:1}),et(Me,{name:"缩放"},{default:Tt(()=>[mt("div",lv,[et(u,{min:1,max:200,step:1,modelValue:P(r).scale,"onUpdate:modelValue":s[2]||(s[2]=p=>P(r).scale=p)},null,8,["modelValue"]),mt("div",uv,ye(P(r).scale)+" %",1)])]),_:1}),et(Me,{name:"描述"},{default:Tt(()=>[et(c,{modelValue:P(r).name,"onUpdate:modelValue":s[3]||(s[3]=p=>P(r).name=p),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1}),et(Me,{name:"操作"},{default:Tt(()=>[et(f,{type:"primary",onClick:n},{default:Tt(()=>s[6]||(s[6]=[Ye("重新生成")])),_:1}),et(f,{type:"primary",onClick:a},{default:Tt(()=>s[7]||(s[7]=[Ye("图生视频")])),_:1})]),_:1})])),[[d,P(r).loading]])}}}),fv={class:"text-[12px] leading-5 flex flex-col gap-5"},dv={class:"flex"},vv={class:"flex items-center gap-4"},hv={class:"flex-shrink-0"},pv={class:"flex"},gv={class:"flex"},mv={class:"flex"},_v=me({__name:"AudioAttr",setup(e){const t=Br(),r=ur(),n=se(()=>r.selectTrack),a=()=>{qe.info("前端模式下暂不支持重新生成功能")};return We(()=>n.value.volume,_i(()=>{t.isPause=!0,nf.updateVolume(n.value,n.value.volume)},100)),We(()=>n.value.subtitle,_i(async()=>{t.isPause=!0,await af.decode(n.value)},100),{deep:!0}),(i,s)=>{const o=ea,l=Oa,u=sf,c=Ri,f=cd,d=Ur,p=Gr,v=jr;return rr((bt(),Dt("div",fv,[et(Me,{name:"名称",nowrap:""},{default:Tt(()=>[Ye(ye(P(n).name),1)]),_:1}),mt("div",dv,[et(Me,{name:"初始时间"},{default:Tt(()=>[Ye(ye((P(n).frameCount/P(gr)).toFixed(2))+" s ",1)]),_:1}),et(Me,{name:"当前时间"},{default:Tt(()=>[Ye(ye(((P(n).end-P(n).start)/P(gr)).toFixed(2))+" s ",1)]),_:1})]),et(Me,{name:"类型"},{default:Tt(()=>[et(o,{size:"small"},{default:Tt(()=>[Ye(ye(P(n).type),1)]),_:1})]),_:1}),et(Me,{name:"音量"},{default:Tt(()=>[mt("div",vv,[et(l,{min:0,max:1,step:.1,modelValue:P(n).volume,"onUpdate:modelValue":s[0]||(s[0]=h=>P(n).volume=h)},null,8,["modelValue"]),mt("div",hv,ye(P(n).volume),1)])]),_:1}),mt("div",pv,[et(Me,{name:"静音"},{default:Tt(()=>[et(u,{modelValue:P(n).mute,"onUpdate:modelValue":s[1]||(s[1]=h=>P(n).mute=h)},null,8,["modelValue"])]),_:1}),et(Me,{name:"字幕"},{default:Tt(()=>[et(u,{modelValue:P(n).drawSub,"onUpdate:modelValue":s[2]||(s[2]=h=>P(n).drawSub=h)},null,8,["modelValue"])]),_:1})]),P(n).drawSub?(bt(),Dt(Ke,{key:0},[mt("div",gv,[et(Me,{name:"字号"},{default:Tt(()=>[et(c,{modelValue:P(n).subtitle.fontSize,"onUpdate:modelValue":s[3]||(s[3]=h=>P(n).subtitle.fontSize=h),class:"input-number",min:12,max:100,size:"small"},null,8,["modelValue"])]),_:1}),et(Me,{name:"字体颜色"},{default:Tt(()=>[et(f,{modelValue:P(n).subtitle.fontColor,"onUpdate:modelValue":s[4]||(s[4]=h=>P(n).subtitle.fontColor=h),size:"small"},null,8,["modelValue"])]),_:1})]),mt("div",mv,[et(Me,{name:"描边大小"},{default:Tt(()=>[et(c,{modelValue:P(n).subtitle.strokeSize,"onUpdate:modelValue":s[5]||(s[5]=h=>P(n).subtitle.strokeSize=h),class:"input-number",min:0,max:20,size:"small"},null,8,["modelValue"])]),_:1}),et(Me,{name:"描边颜色"},{default:Tt(()=>[et(f,{modelValue:P(n).subtitle.strokeColor,"onUpdate:modelValue":s[6]||(s[6]=h=>P(n).subtitle.strokeColor=h),size:"small"},null,8,["modelValue"])]),_:1})]),et(Me,{name:"底部边距"},{default:Tt(()=>[et(c,{modelValue:P(n).subtitle.bottomOffset,"onUpdate:modelValue":s[7]||(s[7]=h=>P(n).subtitle.bottomOffset=h),class:"input-number",min:0,max:200,size:"small"},null,8,["modelValue"])]),_:1})],64)):xe("",!0),et(Me,{name:"提示词"},{default:Tt(()=>[et(d,{modelValue:P(n).name,"onUpdate:modelValue":s[8]||(s[8]=h=>P(n).name=h),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1}),et(Me,{name:"操作"},{default:Tt(()=>[et(p,{type:"primary",onClick:a},{default:Tt(()=>s[9]||(s[9]=[Ye("重新生成")])),_:1})]),_:1})])),[[v,P(n).loading]])}}}),bv=qr(_v,[["__scopeId","data-v-c7e08463"]]),xv={key:0,class:"w-full h-full flex flex-col justify-center items-center"},yv={key:1,class:"absolute top-0 left-3 right-2 bottom-0 pr-2 overflow-auto"},Sv=me({__name:"AttributeContainer",setup(e){const t=Jn(),r=ur(),n=se(()=>({width:`${t.attrWidth}px`})),a={},i=Object.assign({});for(const o in i){const l=o.match(new RegExp("(?<=\\/)(\\w+)(?=\\.ts)"))||[];a[l[0]]=i[o].Options}const s=se(()=>r.selectTrack);return(o,l)=>{const u=zf,c=U1,f=E0,d=M0;return bt(),Dt("div",{class:"select-none relative pl-2 dark:bg-night bg-gray-100",style:Te(P(n))},[P(s)?(bt(),Dt("div",yv,[et(d,null,{default:Tt(()=>[et(f,{label:"基本信息"},{default:Tt(()=>[P(s).type==="video"?(bt(),Ee(rv,{key:0})):P(s).type==="image"?(bt(),Ee(cv,{key:1})):P(s).type==="audio"?(bt(),Ee(bv,{key:2})):P(s).type==="text"?(bt(),Ee(c,{key:3})):xe("",!0)]),_:1})]),_:1})])):(bt(),Dt("div",xv,[et(u,{description:"点击轨道进行编辑"})]))],4)}}});function wv(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map(function(n){return n.split(" ").map(function(a){return a?""+e+a:""}).join(" ")}).join(" ")}function Cv(e,t){return t.replace(/([^}{]*){/gm,function(r,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+e+"$1")+"{"})}function Hr(e,t){return function(r){r&&(e[t]=r)}}function N0(e,t,r){return function(n){n&&(e[t][r]=n)}}function El(e,t){return function(r){var n=r.prototype;e.forEach(function(a){t(n,a)})}}function Ev(e,t){return t===void 0&&(t={}),function(r,n){e.forEach(function(a){var i=t[a]||a;i in r||(r[i]=function(){for(var s,o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];var u=(s=this[n])[a].apply(s,o);return u===this[n]?this:u})})}}var Mv=function(){function e(){this.keys=[],this.values=[]}var t=e.prototype;return t.get=function(r){return this.values[this.keys.indexOf(r)]},t.set=function(r,n){var a=this.keys,i=this.values,s=a.indexOf(r),o=s===-1?a.length:s;a[o]=r,i[o]=n},e}(),kv=function(){function e(){this.object={}}var t=e.prototype;return t.get=function(r){return this.object[r]},t.set=function(r,n){this.object[r]=n},e}(),Tv=typeof Map=="function",Dv=function(){function e(){}var t=e.prototype;return t.connect=function(r,n){this.prev=r,this.next=n,r&&(r.next=this),n&&(n.prev=this)},t.disconnect=function(){var r=this.prev,n=this.next;r&&(r.next=n),n&&(n.prev=r)},t.getIndex=function(){for(var r=this,n=-1;r;)r=r.prev,++n;return n},e}();function Rv(e,t){var r=[],n=[];return e.forEach(function(a){var i=a[0],s=a[1],o=new Dv;r[i]=o,n[s]=o}),r.forEach(function(a,i){a.connect(r[i-1])}),e.filter(function(a,i){return!t[i]}).map(function(a,i){var s=a[0],o=a[1];if(s===o)return[0,0];var l=r[s],u=n[o-1],c=l.getIndex();l.disconnect(),u?l.connect(u,u.next):l.connect(void 0,r[0]);var f=l.getIndex();return[c,f]})}var Av=function(){function e(r,n,a,i,s,o,l,u){this.prevList=r,this.list=n,this.added=a,this.removed=i,this.changed=s,this.maintained=o,this.changedBeforeAdded=l,this.fixed=u}var t=e.prototype;return Object.defineProperty(t,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),t.caculateOrdered=function(){var r=Rv(this.changedBeforeAdded,this.fixed),n=this.changed,a=[];this.cacheOrdered=r.filter(function(i,s){var o=i[0],l=i[1],u=n[s],c=u[0],f=u[1];if(o!==l)return a.push([c,f]),!0}),this.cachePureChanged=a},e}();function Fa(e,t,r){var n=Tv?Map:r?kv:Mv,a=r||function(y){return y},i=[],s=[],o=[],l=e.map(a),u=t.map(a),c=new n,f=new n,d=[],p=[],v={},h=[],m=0,b=0;return l.forEach(function(y,S){c.set(y,S)}),u.forEach(function(y,S){f.set(y,S)}),l.forEach(function(y,S){var C=f.get(y);typeof C>"u"?(++b,s.push(S)):v[C]=b}),u.forEach(function(y,S){var C=c.get(y);typeof C>"u"?(i.push(S),++m):(o.push([C,S]),b=v[S]||0,d.push([C-b,S-m]),p.push(S===C),C!==S&&h.push([C,S]))}),s.reverse(),new Av(e,t,i,s,h,o,d,p)}var Bv=function(){function e(r,n){r===void 0&&(r=[]),this.findKeyCallback=n,this.list=[].slice.call(r)}var t=e.prototype;return t.update=function(r){var n=[].slice.call(r),a=Fa(this.list,n,this.findKeyCallback);return this.list=n,a},e}(),Iv="function",Ov="object",Pv="string",Lv="number",vo="undefined",V0=typeof window!==vo,Fv=typeof document!==vo&&document,zv=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],er=1e-7,Za={cm:function(e){return e*96/2.54},mm:function(e){return e*96/254},in:function(e){return e*96},pt:function(e){return e*96/72},pc:function(e){return e*96/6},"%":function(e,t){return e*t/100},vw:function(e,t){return t===void 0&&(t=window.innerWidth),e/100*t},vh:function(e,t){return t===void 0&&(t=window.innerHeight),e/100*t},vmax:function(e,t){return t===void 0&&(t=Math.max(window.innerWidth,window.innerHeight)),e/100*t},vmin:function(e,t){return t===void 0&&(t=Math.min(window.innerWidth,window.innerHeight)),e/100*t}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Nv(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],s=0,o=i.length;s<o;s++,a++)n[a]=i[s];return n}function En(e,t,r,n){return(e*n+t*r)/(r+n)}function za(e){return typeof e===vo}function $r(e){return e&&typeof e===Ov}function ar(e){return Array.isArray(e)}function Dr(e){return typeof e===Pv}function Ms(e){return typeof e===Lv}function ho(e){return typeof e===Iv}function Vv(e,t){var r=e===""||e==" ",n=t===""||t==" ";return n&&r||e===t}function $0(e,t,r,n,a){var i=po(e,t,r);return i?r:$v(e,t,r+1,n,a)}function po(e,t,r){if(!e.ignore)return null;var n=t.slice(Math.max(r-3,0),r+3).join("");return new RegExp(e.ignore).exec(n)}function $v(e,t,r,n,a){for(var i=function(u){var c=t[u].trim();if(c===e.close&&!po(e,t,u))return{value:u};var f=u,d=en(a,function(p){var v=p.open;return v===c});if(d&&(f=$0(d,t,u,n,a)),f===-1)return s=u,"break";u=f,s=u},s,o=r;o<n;++o){var l=i(o);if(o=s,typeof l=="object")return l.value;if(l==="break")break}return-1}function go(e,t){var r=Dr(t)?{separator:t}:t,n=r.separator,a=n===void 0?",":n,i=r.isSeparateFirst,s=r.isSeparateOnlyOpenClose,o=r.isSeparateOpenClose,l=o===void 0?s:o,u=r.openCloseCharacters,c=u===void 0?zv:u,f=c.map(function(I){var W=I.open,G=I.close;return W===G?W:W+"|"+G}).join("|"),d="(\\s*"+a+"\\s*|"+f+"|\\s+)",p=new RegExp(d,"g"),v=e.split(p).filter(function(I){return I&&I!=="undefined"}),h=v.length,m=[],b=[];function y(){return b.length?(m.push(b.join("")),b=[],!0):!1}for(var S=function(I){var W=v[I].trim(),G=I,F=en(c,function(st){var J=st.open;return J===W}),X=en(c,function(st){var J=st.close;return J===W});if(F){if(G=$0(F,v,I,h,c),G!==-1&&l)return y()&&i||(m.push(v.slice(I,G+1).join("")),I=G,i)?(C=I,"break"):(C=I,"continue")}else if(X&&!po(X,v,I)){var M=Nv(c);return M.splice(c.indexOf(X),1),{value:go(e,{separator:a,isSeparateFirst:i,isSeparateOnlyOpenClose:s,isSeparateOpenClose:l,openCloseCharacters:M})}}else if(Vv(W,a)&&!s)return y(),i?(C=I,"break"):(C=I,"continue");G===-1&&(G=h-1),b.push(v.slice(I,G+1).join("")),I=G,C=I},C,R=0;R<h;++R){var D=S(R);if(R=C,typeof D=="object")return D.value;if(D==="break")break}return b.length&&m.push(b.join("")),m}function hn(e){return go(e,"")}function Rn(e){return go(e,",")}function H0(e){var t=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(e);return!t||t.length<4?{}:{prefix:t[1],value:t[2],suffix:t[3]}}function Na(e){var t=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(e);if(!t)return{prefix:"",unit:"",value:NaN};var r=t[1],n=t[2],a=t[3];return{prefix:r,unit:a,value:parseFloat(n)}}function Hv(e){return e.replace(/[\s-_]+([^\s-_])/g,function(t,r){return r.toUpperCase()})}function pi(e,t){return e.replace(/([a-z])([A-Z])/g,function(r,n,a){return""+n+t+a.toLowerCase()})}function Ea(){return Date.now?Date.now():new Date().getTime()}function tn(e,t,r){r===void 0&&(r=-1);for(var n=e.length,a=0;a<n;++a)if(t(e[a],a,e))return a;return r}function en(e,t,r){var n=tn(e,t);return n>-1?e[n]:r}var G0=function(){var e=Ea(),t=V0&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return t?t.bind(window):function(r){var n=Ea(),a=setTimeout(function(){r(n-e)},1e3/60);return a}}(),Gv=function(){var e=V0&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return e?e.bind(window):function(t){clearTimeout(t)}}();function aa(e){return Object.keys(e)}function $e(e,t){var r=Na(e),n=r.value,a=r.unit;if($r(t)){var i=t[a];if(i){if(ho(i))return i(n);if(Za[a])return Za[a](n,i)}}else if(a==="%")return n*t/100;return Za[a]?Za[a](n):n}function ks(e,t,r){return Math.max(t,Math.min(e,r))}function Ml(e,t,r,n){return n===void 0&&(n=e[0]/e[1]),[[we(t[0],er),we(t[0]/n,er)],[we(t[1]*n,er),we(t[1],er)]].filter(function(a){return a.every(function(i,s){var o=t[s],l=we(o,er);return r?i<=o||i<=l:i>=o||i>=l})})[0]||e}function Wv(e,t,r,n){if(!n)return e.map(function(p,v){return ks(p,t[v],r[v])});var a=e[0],i=e[1],s=n===!0?a/i:n,o=Ml(e,t,!1,s),l=o[0],u=o[1],c=Ml(e,r,!0,s),f=c[0],d=c[1];return a<l||i<u?(a=l,i=u):(a>f||i>d)&&(a=f,i=d),[a,i]}function Xv(e){for(var t=e.length,r=0,n=t-1;n>=0;--n)r+=e[n];return r}function Ts(e){for(var t=e.length,r=0,n=t-1;n>=0;--n)r+=e[n];return t?r/t:0}function Qe(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=Math.atan2(n,r);return a>=0?a:a+Math.PI*2}function Yv(e){return[0,1].map(function(t){return Ts(e.map(function(r){return r[t]}))})}function Ds(e){var t=Yv(e),r=Qe(t,e[0]),n=Qe(t,e[1]);return r<n&&n-r<Math.PI||r>n&&n-r<-Math.PI?1:-1}function Fr(e,t){return Math.sqrt(Math.pow((t?t[0]:0)-e[0],2)+Math.pow((t?t[1]:0)-e[1],2))}function we(e,t){if(!t)return e;var r=1/t;return Math.round(e/t)/r}function kl(e,t){return e.forEach(function(r,n){e[n]=we(e[n],t)}),e}function or(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function W0(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function X0(e,t){if(e.classList)e.classList.remove(t);else{var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ")}}function vr(e,t,r,n){e.addEventListener(t,r,n)}function fr(e,t,r,n){e.removeEventListener(t,r,n)}function Uv(e){return(e==null?void 0:e.ownerDocument)||Fv}function us(e){var t;return((t=e==null?void 0:e.ownerDocument)===null||t===void 0?void 0:t.defaultView)||window}function jv(e){return e&&"postMessage"in e&&"blur"in e&&"self"in e}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Rs=function(e,t){return Rs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},Rs(e,t)};function Fn(e,t){Rs(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var cn=function(){return cn=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},cn.apply(this,arguments)};function Y0(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function qv(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],s=0,o=i.length;s<o;s++,a++)n[a]=i[s];return n}function As(e,t){if(e===t)return!1;for(var r in e)if(!(r in t))return!0;for(var r in t)if(e[r]!==t[r])return!0;return!1}function mo(e,t){var r=Object.keys(e),n=Object.keys(t),a=Fa(r,n,function(l){return l}),i={},s={},o={};return a.added.forEach(function(l){var u=n[l];i[u]=t[u]}),a.removed.forEach(function(l){var u=r[l];s[u]=e[u]}),a.maintained.forEach(function(l){var u=l[0],c=r[u],f=[e[c],t[c]];e[c]!==t[c]&&(o[c]=f)}),{added:i,removed:s,changed:o}}function U0(e){e.forEach(function(t){t()})}function Tl(e){var t=0;return e.map(function(r){return r==null?"$compat"+ ++t:""+r})}function Dl(e,t,r,n){if(Dr(e)||Ms(e))return new Jv("text_"+e,t,r,n,null,{});var a=typeof e.type=="string"?th:e.type.prototype.render?rh:eh;return new a(e.type,t,r,n,e.ref,e.props)}function j0(e){var t=[];return e.forEach(function(r){t=t.concat(ar(r)?j0(r):r)}),t}function Rl(e){var t=e.className,r=Y0(e,["className"]);return t!=null&&(r.class=t),delete r.style,delete r.children,r}function cs(e,t){if(!t)return e;for(var r in t)za(e[r])&&(e[r]=t[r]);return e}function Ir(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=t||{},i=a.key,s=a.ref,o=Y0(a,["key","ref"]);return{type:e,key:i,ref:s,props:cn(cn({},o),{children:j0(r).filter(function(l){return l!=null&&l!==!1})})}}var Va=function(){function e(r,n,a,i,s,o){o===void 0&&(o={}),this.type=r,this.key=n,this.index=a,this.container=i,this.ref=s,this.props=o,this._providers=[]}var t=e.prototype;return t._should=function(r,n){return!0},t._update=function(r,n,a,i){if(this.base&&!Dr(n)&&!i&&!this._should(n.props,a))return!1;this.original=n,this._setState(a);var s=this.props;return Dr(n)||(this.props=n.props,this.ref=n.ref),this._render(r,this.base?s:{},a),!0},t._mounted=function(){var r=this.ref;r&&r(this.base)},t._setState=function(r){},t._updated=function(){var r=this.ref;r&&r(this.base)},t._destroy=function(){var r=this.ref;r&&r(null)},e}();function Kv(e,t,r){var n=mo(e,t),a=n.added,i=n.removed,s=n.changed;for(var o in a)r.setAttribute(o,a[o]);for(var o in s)r.setAttribute(o,s[o][1]);for(var o in i)r.removeAttribute(o)}function Zv(e,t,r){var n=mo(e,t),a=n.added,i=n.removed,s=n.changed;for(var o in i)r.removeEventListener(o);for(var o in a)r.addEventListener(o,a[o]);for(var o in s)r.removeEventListener(o),r.addEventListener(o,s[o][1]);for(var o in i)r.removeEventListener(o)}function Qv(e,t,r){var n=r.style,a=mo(e,t),i=a.added,s=a.removed,o=a.changed;for(var l in i){var u=pi(l,"-");n.setProperty?n.setProperty(u,i[l]):n[u]=i[l]}for(var l in o){var u=pi(l,"-");n.setProperty?n.setProperty(u,o[l][1]):n[u]=o[l][1]}for(var l in s){var u=pi(l,"-");n.removeProperty?n.removeProperty(u):n[u]=""}}function Al(e){var t={},r={};for(var n in e)n.indexOf("on")===0?r[n.replace("on","").toLowerCase()]=e[n]:t[n]=e[n];return{attributes:t,events:r}}var Jv=function(e){Fn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r._render=function(n){var a=this,i=!this.base;return i&&(this.base=document.createTextNode(this.type.replace("text_",""))),n.push(function(){i?a._mounted():a._updated()}),!0},r._unmount=function(){this.base.parentNode.removeChild(this.base)},t}(Va),th=function(e){Fn(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.events={},n._isSVG=!1,n}var r=t.prototype;return r.addEventListener=function(n,a){var i=this.events;i[n]=function(s){s.nativeEvent=s,a(s)},this.base.addEventListener(n,i[n])},r.removeEventListener=function(n){var a=this.events;this.base.removeEventListener(n,a[n]),delete a[n]},r._should=function(n){return As(this.props,n)},r._render=function(n,a){var i=this,s=!this.base;if(s){var o=this._hasSVG();this._isSVG=o;var l=this.props.portalContainer;if(!l){var u=this.type;o?l=document.createElementNS("http://www.w3.org/2000/svg",u):l=document.createElement(u)}this.base=l}$a(this,this._providers,this.props.children,n,null);var c=this.base,f=Al(a),d=f.attributes,p=f.events,v=Al(this.props),h=v.attributes,m=v.events;return Kv(Rl(d),Rl(h),c),Zv(p,m,this),Qv(a.style||{},this.props.style||{},c),n.push(function(){s?i._mounted():i._updated()}),!0},r._unmount=function(){var n=this.events,a=this.base;for(var i in n)a.removeEventListener(i,n[i]);this._providers.forEach(function(s){s._unmount()}),this.events={},this.props.portalContainer||a.parentNode.removeChild(a)},r._hasSVG=function(){if(this._isSVG||this.type==="svg")return!0;var n=_o(this.container);return n&&"ownerSVGElement"in n},t}(Va);function _o(e){if(!e)return null;var t=e.base;return t instanceof Node?t:_o(e.container)}function Ma(e){if(!e)return null;if(e instanceof Node)return e;var t=e.$_provider._providers;return t.length?Ma(t[0].base):null}var eh=function(e){Fn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r._render=function(n){var a=this.type(this.props);return $a(this,this._providers,a?[a]:[],n),!0},r._unmount=function(){this._providers.forEach(function(n){n._unmount()})},t}(Va),q0=function(e){Fn(t,e);function t(n){var a=e.call(this,"container","container",0,null)||this;return a.base=n,a}var r=t.prototype;return r._render=function(){return!0},r._unmount=function(){},t}(Va),rh=function(e){Fn(t,e);function t(n,a,i,s,o,l){return l===void 0&&(l={}),e.call(this,n,a,i,s,o,cs(l,n.defaultProps))||this}var r=t.prototype;return r._should=function(n,a){return this.base.shouldComponentUpdate(cs(n,this.type.defaultProps),a||this.base.state)},r._render=function(n,a){var i=this;this.props=cs(this.props,this.type.defaultProps);var s=!this.base;s?(this.base=new this.type(this.props),this.base.$_provider=this):this.base.props=this.props;var o=this.base,l=o.state,u=o.render();u&&u.props&&!u.props.children.length&&(u.props.children=this.props.children),$a(this,this._providers,u?[u]:[],n),n.push(function(){s?(i._mounted(),o.componentDidMount()):(i._updated(),o.componentDidUpdate(a,l))})},r._setState=function(n){var a=this.base;!a||!n||(a.state=n)},r._unmount=function(){this._providers.forEach(function(n){n._unmount()}),clearTimeout(this.base.$_timer),this.base.componentWillUnmount()},t}(Va),bo=function(){function e(r){r===void 0&&(r={}),this.props=r,this.state={},this.$_timer=0,this.$_state={}}var t=e.prototype;return t.shouldComponentUpdate=function(r,n){return!0},t.render=function(){return null},t.setState=function(r,n,a){var i=this;this.$_timer||(this.$_state={}),clearTimeout(this.$_timer),this.$_timer=0,this.$_state=cn(cn({},this.$_state),r),a?this.$_setState(n,a):this.$_timer=setTimeout(function(){i.$_timer=0,i.$_setState(n,a)})},t.forceUpdate=function(r){this.setState({},r,!0)},t.componentDidMount=function(){},t.componentDidUpdate=function(r,n){},t.componentWillUnmount=function(){},t.$_setState=function(r,n){var a=[],i=this.$_provider,s=$a(i.container,[i],[i.original],a,cn(cn({},this.state),this.$_state),n);s&&(r&&a.push(r),U0(a))},e}(),xo=function(e){Fn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r.shouldComponentUpdate=function(n,a){return As(this.props,n)||As(this.state,a)},t}(bo),nh=function(e){Fn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r.componentDidMount=function(){var n=this.props,a=n.element,i=n.container;this._portalProvider=new q0(i),gi(a,i,this._portalProvider)},r.componentDidUpdate=function(){var n=this.props,a=n.element,i=n.container;gi(a,i,this._portalProvider)},r.componentWillUnmount=function(){var n=this.props.container;gi(null,n,this._portalProvider),this._portalProvider=null},t}(xo);function ah(e,t,r){var n=[];$a(e,e._providers,t,n,r),U0(n)}function ih(e,t){for(var r=e._providers,n=r.length,a=t.index+1;a<n;++a){var i=Ma(r[a].base);if(i)return i}return null}function sh(e,t,r){var n=r.map(function(l){return Dr(l)?null:l.key}),a=Tl(t.map(function(l){return l.key})),i=Tl(n),s=Fa(a,i,function(l){return l});s.removed.forEach(function(l){t.splice(l,1)[0]._unmount()}),s.ordered.forEach(function(l){var u=l[0],c=l[1],f=t.splice(u,1)[0];t.splice(c,0,f);var d=Ma(f.base),p=Ma(t[c+1]&&t[c+1].base);d&&d.parentNode.insertBefore(d,p)}),s.added.forEach(function(l){t.splice(l,0,Dl(r[l],n[l],l,e))});var o=s.maintained.filter(function(l){l[0];var u=l[1],c=r[u],f=t[u],d=Dr(c)?"text_"+c:c.type;return d!==f.type?(f._unmount(),t.splice(u,1,Dl(c,n[u],u,e)),!0):(f.index=u,!1)});return qv(s.added,o.map(function(l){l[0];var u=l[1];return u}))}function $a(e,t,r,n,a,i){var s=sh(e,t,r),o=t.filter(function(u,c){return u._update(n,r[c],a,i)}),l=_o(e);return l&&s.reverse().forEach(function(u){var c=t[u],f=Ma(c.base);if(f&&l!==f&&!f.parentNode){var d=ih(e,c);l.insertBefore(f,d)}}),o.length>0}function gi(e,t,r){r===void 0&&(r=t.__REACT_COMPAT__);var n=!!r;return r||(r=new q0(t)),ah(r,e?[e]:[]),n||(t.__REACT_COMPAT__=r),r}function Bl(e,t,r){var n=t.__REACT_COMPAT__;e&&!n&&(t.innerHTML=""),gi(e,t,n)}function oh(e,t){return Ir(nh,{element:e,container:t})}var lh="simple-1.1.0";function yo(e,t){for(var r=e.length,n=0;n<r;++n)if(t(e[n],n))return!0;return!1}function K0(e,t){for(var r=e.length,n=0;n<r;++n)if(t(e[n],n))return e[n];return null}function Z0(e){var t=e;if(typeof t>"u"){if(typeof navigator>"u"||!navigator)return"";t=navigator.userAgent||""}return t.toLowerCase()}function So(e,t){try{return new RegExp(e,"g").exec(t)}catch{return null}}function uh(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var e=navigator.userAgentData,t=e.brands||e.uaList;return!!(t&&t.length)}function ch(e,t){var r=So("("+e+")((?:\\/|\\s|:)([0-9|\\.|_]+))",t);return r?r[3]:""}function Bs(e){return e.replace(/_/g,".")}function va(e,t){var r=null,n="-1";return yo(e,function(a){var i=So("("+a.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",t);return!i||a.brand?!1:(r=a,n=i[3]||"-1",a.versionAlias?n=a.versionAlias:a.versionTest&&(n=ch(a.versionTest.toLowerCase(),t)||n),n=Bs(n),!0)}),{preset:r,version:n}}function Qa(e,t){var r={brand:"",version:"-1"};return yo(e,function(n){var a=Q0(t,n);return a?(r.brand=n.id,r.version=n.versionAlias||a.version,r.version!=="-1"):!1}),r}function Q0(e,t){return K0(e,function(r){var n=r.brand;return So(""+t.test,n.toLowerCase())})}var J0=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],tu=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],Is=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],eu=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],ru=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function nu(e){return!!va(eu,e).preset}function fh(e){var t=Z0(e),r=!!/mobi/g.exec(t),n={name:"unknown",version:"-1",majorVersion:-1,webview:nu(t),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},a={name:"unknown",version:"-1",majorVersion:-1},i=va(J0,t),s=i.preset,o=i.version,l=va(ru,t),u=l.preset,c=l.version,f=va(tu,t);if(n.chromium=!!f.preset,n.chromiumVersion=f.version,!n.chromium){var d=va(Is,t);n.webkit=!!d.preset,n.webkitVersion=d.version}return u&&(a.name=u.id,a.version=c,a.majorVersion=parseInt(c,10)),s&&(n.name=s.id,n.version=o,n.webview&&a.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:a,isMobile:r,isHints:!1}}function dh(e){var t=navigator.userAgentData,r=(t.uaList||t.brands).slice(),n=t.mobile||!1,a=r[0],i=(t.platform||navigator.platform).toLowerCase(),s={name:a.brand,version:a.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Qa(eu,r).brand||nu(Z0())},o={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&yo(Is,function(d){return Q0(r,d)});var l=Qa(tu,r);if(s.chromium=!!l.brand,s.chromiumVersion=l.version||"-1",!s.chromium){var u=Qa(Is,r);s.webkit=!!u.brand,s.webkitVersion=u.version||"-1"}var c=K0(ru,function(d){return new RegExp(""+d.test,"g").exec(i)});o.name=c?c.id:"";{var f=Qa(J0,r);s.name=f.brand||s.name,s.version=f.brand&&e?e.uaFullVersion:f.version}return s.webkit&&(o.name=n?"ios":"mac"),o.name==="ios"&&s.webview&&(s.version="-1"),o.version=Bs(o.version),s.version=Bs(s.version),o.majorVersion=parseInt(o.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:o,isMobile:n,isHints:!0}}function vh(e){return uh()?dh():fh(e)}function hh(e,t,r,n,a,i){for(var s=0;s<a;++s){var o=r+s*a,l=n+s*a;e[o]+=e[l]*i,t[o]+=t[l]*i}}function ph(e,t,r,n,a){for(var i=0;i<a;++i){var s=r+i*a,o=n+i*a,l=e[s],u=t[s];e[s]=e[o],e[o]=l,t[s]=t[o],t[o]=u}}function gh(e,t,r,n,a){for(var i=0;i<n;++i){var s=r+i*n;e[s]/=a,t[s]/=a}}function au(e,t,r){for(var n=e.slice(),a=0;a<r;++a)n[a*r+t-1]=0,n[(t-1)*r+a]=0;return n[(t-1)*(r+1)]=1,n}function Wr(e,t){t===void 0&&(t=Math.sqrt(e.length));for(var r=e.slice(),n=je(t),a=0;a<t;++a){var i=t*a+a;if(!we(r[i],er)){for(var s=a+1;s<t;++s)if(r[t*a+s]){ph(r,n,a,s,t);break}}if(!we(r[i],er))return[];gh(r,n,a,t,r[i]);for(var s=0;s<t;++s){var o=s,l=s+a*t,u=r[l];!we(u,er)||a===s||hh(r,n,o,a,t,-u)}}return n}function mh(e,t){t===void 0&&(t=Math.sqrt(e.length));for(var r=[],n=0;n<t;++n)for(var a=0;a<t;++a)r[a*t+n]=e[t*n+a];return r}function iu(e,t){t===void 0&&(t=Math.sqrt(e.length));for(var r=[],n=e[t*t-1],a=0;a<t-1;++a)r[a]=e[t*(t-1)+a]/n;return r[t-1]=0,r}function _h(e,t){for(var r=je(t),n=0;n<t-1;++n)r[t*(t-1)+n]=e[n]||0;return r}function In(e,t){for(var r=e.slice(),n=e.length;n<t-1;++n)r[n]=0;return r[t-1]=1,r}function Xr(e,t,r){if(t===void 0&&(t=Math.sqrt(e.length)),t===r)return e;for(var n=je(r),a=Math.min(t,r),i=0;i<a-1;++i){for(var s=0;s<a-1;++s)n[i*r+s]=e[i*t+s];n[(i+1)*r-1]=e[(i+1)*t-1],n[(r-1)*r+i]=e[(t-1)*t+i]}return n[r*r-1]=e[t*t-1],n}function Os(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=je(e);return t.forEach(function(a){n=ze(n,a,e)}),n}function ze(e,t,r){r===void 0&&(r=Math.sqrt(e.length));var n=[],a=e.length/r,i=t.length/a;if(a){if(!i)return e}else return t;for(var s=0;s<r;++s)for(var o=0;o<i;++o){n[o*r+s]=0;for(var l=0;l<a;++l)n[o*r+s]+=e[l*r+s]*t[o*a+l]}return n}function De(e,t){for(var r=Math.min(e.length,t.length),n=e.slice(),a=0;a<r;++a)n[a]=n[a]+t[a];return n}function fe(e,t){for(var r=Math.min(e.length,t.length),n=e.slice(),a=0;a<r;++a)n[a]=n[a]-t[a];return n}function bh(e,t){return t===void 0&&(t=e.length===6),t?[e[0],e[1],0,e[2],e[3],0,e[4],e[5],1]:e}function su(e,t){return t===void 0&&(t=e.length===9),t?[e[0],e[1],e[3],e[4],e[6],e[7]]:e}function dr(e,t,r){r===void 0&&(r=t.length);var n=ze(e,t,r),a=n[r-1];return n.map(function(i){return i/a})}function xh(e,t){return ze(e,[1,0,0,0,0,Math.cos(t),Math.sin(t),0,0,-Math.sin(t),Math.cos(t),0,0,0,0,1],4)}function yh(e,t){return ze(e,[Math.cos(t),0,-Math.sin(t),0,0,1,0,0,Math.sin(t),0,Math.cos(t),0,0,0,0,1],4)}function Sh(e,t){return ze(e,qn(t,4))}function Ja(e,t){var r=t[0],n=r===void 0?1:r,a=t[1],i=a===void 0?1:a,s=t[2],o=s===void 0?1:s;return ze(e,[n,0,0,0,0,i,0,0,0,0,o,0,0,0,0,1],4)}function Ha(e,t){return dr(qn(t,3),In(e,3))}function fs(e,t){var r=t[0],n=r===void 0?0:r,a=t[1],i=a===void 0?0:a,s=t[2],o=s===void 0?0:s;return ze(e,[1,0,0,0,0,1,0,0,0,0,1,0,n,i,o,1],4)}function Il(e,t){return ze(e,t,4)}function qn(e,t){var r=Math.cos(e),n=Math.sin(e),a=je(t);return a[0]=r,a[1]=n,a[t]=-n,a[t+1]=r,a}function je(e){for(var t=e*e,r=[],n=0;n<t;++n)r[n]=n%(e+1)?0:1;return r}function wo(e,t){for(var r=je(t),n=Math.min(e.length,t-1),a=0;a<n;++a)r[(t+1)*a]=e[a];return r}function ka(e,t){for(var r=je(t),n=Math.min(e.length,t-1),a=0;a<n;++a)r[t*(t-1)+a]=e[a];return r}function Co(e,t,r,n,a,i,s,o){var l=e[0],u=e[1],c=t[0],f=t[1],d=r[0],p=r[1],v=n[0],h=n[1],m=a[0],b=a[1],y=i[0],S=i[1],C=s[0],R=s[1],D=o[0],I=o[1],W=[l,0,c,0,d,0,v,0,u,0,f,0,p,0,h,0,1,0,1,0,1,0,1,0,0,l,0,c,0,d,0,v,0,u,0,f,0,p,0,h,0,1,0,1,0,1,0,1,-m*l,-b*l,-y*c,-S*c,-C*d,-R*d,-D*v,-I*v,-m*u,-b*u,-y*f,-S*f,-C*p,-R*p,-D*h,-I*h],G=Wr(W,8);if(!G.length)return[];var F=ze(G,[m,b,y,S,C,R,D,I],8);return F[8]=1,Xr(mh(F),3,4)}var ba=function(){return ba=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},ba.apply(this,arguments)};function wh(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Eo(e,t){return t===void 0&&(t=0),Hn(Mn(e,t))}function Ch(e,t){var r=dr(e,[t[0],t[1]||0,t[2]||0,1],4),n=r[3]||1;return[r[0]/n,r[1]/n,r[2]/n]}function Hn(e){var t=wh();return e.forEach(function(r){var n=r.matrixFunction,a=r.functionValue;n&&(t=n(t,a))}),t}function Mn(e,t){t===void 0&&(t=0);var r=ar(e)?e:hn(e);return r.map(function(n){var a=H0(n),i=a.prefix,s=a.value,o=null,l=i,u="";if(i==="translate"||i==="translateX"||i==="translate3d"){var c=$r(t)?ba(ba({},t),{"o%":t["%"]}):{"%":t,"o%":t},f=Rn(s).map(function(st,J){return J===0&&"x%"in c?c["%"]=t["x%"]:J===1&&"y%"in c?c["%"]=t["y%"]:c["%"]=t["o%"],$e(st,c)}),d=f[0],p=f[1],v=p===void 0?0:p,h=f[2],m=h===void 0?0:h;o=fs,u=[d,v,m]}else if(i==="translateY"){var b=$r(t)?ba({"%":t["y%"]},t):{"%":t},v=$e(s,b);o=fs,u=[0,v,0]}else if(i==="translateZ"){var m=parseFloat(s);o=fs,u=[0,0,m]}else if(i==="scale"||i==="scale3d"){var y=Rn(s).map(function(st){return parseFloat(st)}),S=y[0],C=y[1],R=C===void 0?S:C,D=y[2],I=D===void 0?1:D;o=Ja,u=[S,R,I]}else if(i==="scaleX"){var S=parseFloat(s);o=Ja,u=[S,1,1]}else if(i==="scaleY"){var R=parseFloat(s);o=Ja,u=[1,R,1]}else if(i==="scaleZ"){var I=parseFloat(s);o=Ja,u=[1,1,I]}else if(i==="rotate"||i==="rotateZ"||i==="rotateX"||i==="rotateY"){var W=Na(s),G=W.unit,F=W.value,X=G==="rad"?F:F*Math.PI/180;i==="rotate"||i==="rotateZ"?(l="rotateZ",o=Sh):i==="rotateX"?o=xh:i==="rotateY"&&(o=yh),u=X}else if(i==="matrix3d")o=Il,u=Rn(s).map(function(st){return parseFloat(st)});else if(i==="matrix"){var M=Rn(s).map(function(st){return parseFloat(st)});o=Il,u=[M[0],M[1],0,0,M[2],M[3],0,0,0,0,1,0,M[4],M[5],0,1]}else l="";return{name:i,functionName:l,value:s,matrixFunction:o,functionValue:u}})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ps=function(e,t){return Ps=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},Ps(e,t)};function Eh(e,t){Ps(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ou=typeof Map=="function"?void 0:function(){var e=0;return function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++e)}}(),lu=function(e){Eh(t,e);function t(r){return r===void 0&&(r=[]),e.call(this,r,ou)||this}return t}(Bv);function Mh(e,t){return Fa(e,t,ou)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function kh(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],s=0,o=i.length;s<o;s++,a++)n[a]=i[s];return n}function wr(e){return we(e,er)}function Th(e,t){return e.every(function(r,n){return wr(r-t[n])===0})}function Dh(e,t){return!wr(e[0]-t[0])&&!wr(e[1]-t[1])}function uu(e){return e.length<3?0:Math.abs(Xv(e.map(function(t,r){var n=e[r+1]||e[0];return t[0]*n[1]-n[0]*t[1]})))/2}function Ol(e,t){var r=t.width,n=t.height,a=t.left,i=t.top,s=pn(e),o=s.minX,l=s.minY,u=s.maxX,c=s.maxY,f=r/(u-o),d=n/(c-l);return e.map(function(p){return[a+(p[0]-o)*f,i+(p[1]-l)*d]})}function pn(e){var t=e.map(function(n){return n[0]}),r=e.map(function(n){return n[1]});return{minX:Math.min.apply(Math,t),minY:Math.min.apply(Math,r),maxX:Math.max.apply(Math,t),maxY:Math.max.apply(Math,r)}}function Ls(e,t,r){var n=e[0],a=e[1],i=pn(t),s=i.minX,o=i.maxX,l=[[s,a],[o,a]],u=bi(l[0],l[1]),c=Fs(t),f=[];if(c.forEach(function(v){var h=bi(v[0],v[1]),m=v[0];if(Th(u,h))f.push({pos:e,line:v,type:"line"});else{var b=cu(Mo(u,h),[l,v]);b.forEach(function(y){v.some(function(S){return Dh(S,y)})?f.push({pos:y,line:v,type:"point"}):wr(m[1]-a)!==0&&f.push({pos:y,line:v,type:"intersection"})})}}),en(f,function(v){return v[0]===n}))return!0;var d=0,p={};return f.forEach(function(v){var h=v.pos,m=v.type,b=v.line;if(!(h[0]>n))if(m==="intersection")++d;else{if(m==="line")return;if(m==="point"){var y=en(b,function(R){return R[1]!==a}),S=p[h[0]],C=y[1]>a?1:-1;S?S!==C&&++d:p[h[0]]=C}}}),d%2===1}function bi(e,t){var r=e[0],n=e[1],a=t[0],i=t[1],s=a-r,o=i-n;Math.abs(s)<er&&(s=0),Math.abs(o)<er&&(o=0);var l=0,u=0,c=0;return s?o?(l=-o/s,u=1,c=-l*r-n):(u=1,c=-n):o&&(l=-1,c=r),[l,u,c]}function Mo(e,t){var r=e[0],n=e[1],a=e[2],i=t[0],s=t[1],o=t[2],l=r===0&&i===0,u=n===0&&s===0,c=[];if(l&&u)return[];if(l){var f=-a/n,d=-o/s;return f!==d?[]:[[-1/0,f],[1/0,f]]}else if(u){var p=-a/r,v=-o/i;return p!==v?[]:[[p,-1/0],[p,1/0]]}else if(r===0){var h=-a/n,m=-(s*h+o)/i;c=[[m,h]]}else if(i===0){var h=-o/s,m=-(n*h+a)/r;c=[[m,h]]}else if(n===0){var m=-a/r,h=-(i*m+o)/s;c=[[m,h]]}else if(s===0){var m=-o/i,h=-(r*m+a)/n;c=[[m,h]]}else{var m=(n*o-s*a)/(s*r-n*i),h=-(r*m+a)/n;c=[[m,h]]}return c.map(function(b){return[b[0],b[1]]})}function cu(e,t){var r=t.map(function(f){return[0,1].map(function(d){return[Math.min(f[0][d],f[1][d]),Math.max(f[0][d],f[1][d])]})}),n=[];if(e.length===2){var a=e[0],i=a[0],s=a[1];if(wr(i-e[1][0])){if(!wr(s-e[1][1])){var u=Math.max.apply(Math,r.map(function(f){return f[0][0]})),c=Math.min.apply(Math,r.map(function(f){return f[0][1]}));if(wr(u-c)>0)return[];n=[[u,s],[c,s]]}}else{var o=Math.max.apply(Math,r.map(function(f){return f[1][0]})),l=Math.min.apply(Math,r.map(function(f){return f[1][1]}));if(wr(o-l)>0)return[];n=[[i,o],[i,l]]}}return n.length||(n=e.filter(function(f){var d=f[0],p=f[1];return r.every(function(v){return 0<=wr(d-v[0][0])&&0<=wr(v[0][1]-d)&&0<=wr(p-v[1][0])&&0<=wr(v[1][1]-p)})})),n.map(function(f){return[wr(f[0]),wr(f[1])]})}function Fs(e){return kh(e.slice(1),[e[0]]).map(function(t,r){return[e[r],t]})}function Rh(e,t){var r=e.slice(),n=t.slice();Ds(r)===-1&&r.reverse(),Ds(n)===-1&&n.reverse();var a=Fs(r),i=Fs(n),s=a.map(function(c){return bi(c[0],c[1])}),o=i.map(function(c){return bi(c[0],c[1])}),l=[];s.forEach(function(c,f){var d=a[f],p=[];o.forEach(function(v,h){var m=Mo(c,v),b=cu(m,[d,i[h]]);p.push.apply(p,b.map(function(y){return{index1:f,index2:h,pos:y,type:"intersection"}}))}),p.sort(function(v,h){return Fr(d[0],v.pos)-Fr(d[0],h.pos)}),l.push.apply(l,p),Ls(d[1],n)&&l.push({index1:f,index2:-1,pos:d[1],type:"inside"})}),i.forEach(function(c,f){if(Ls(c[1],r)){var d=!1,p=tn(l,function(v){var h=v.index2;return h===f?(d=!0,!1):!!d});p===-1&&(d=!1,p=tn(l,function(v){var h=v.index1,m=v.index2;return h===-1&&m+1===f?(d=!0,!1):!!d})),p===-1?l.push({index1:-1,index2:f,pos:c[1],type:"inside"}):l.splice(p,0,{index1:-1,index2:f,pos:c[1],type:"inside"})}});var u={};return l.filter(function(c){var f=c.pos,d=f[0]+"x"+f[1];return u[d]?!1:(u[d]=!0,!0)})}function Ah(e,t){var r=Rh(e,t);return r.map(function(n){var a=n.pos;return a})}function Bh(e,t){var r=Ah(e,t);return uu(r)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var zs=function(){return zs=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},zs.apply(this,arguments)};function Ih(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],s=0,o=i.length;s<o;s++,a++)n[a]=i[s];return n}var Ni=function(){function e(){this._events={}}var t=e.prototype;return t.on=function(r,n){if($r(r))for(var a in r)this.on(a,r[a]);else this._addEvent(r,n,{});return this},t.off=function(r,n){if(!r)this._events={};else if($r(r))for(var a in r)this.off(a);else if(!n)this._events[r]=[];else{var i=this._events[r];if(i){var s=tn(i,function(o){return o.listener===n});s>-1&&i.splice(s,1)}}return this},t.once=function(r,n){var a=this;return n&&this._addEvent(r,n,{once:!0}),new Promise(function(i){a._addEvent(r,i,{once:!0})})},t.emit=function(r,n){var a=this;n===void 0&&(n={});var i=this._events[r];if(!r||!i)return!0;var s=!1;return n.eventType=r,n.stop=function(){s=!0},n.currentTarget=this,Ih(i).forEach(function(o){o.listener(n),o.once&&a.off(r,o.listener)}),!s},t.trigger=function(r,n){return n===void 0&&(n={}),this.emit(r,n)},t._addEvent=function(r,n,a){var i=this._events;i[r]=i[r]||[];var s=i[r];s.push(zs({listener:n},a))},e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ns=function(e,t){return Ns=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},Ns(e,t)};function Oh(e,t){Ns(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Wn=function(){return Wn=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Wn.apply(this,arguments)};function Ph(e){var t=e.container;return t===document.body?[t.scrollLeft||document.documentElement.scrollLeft,t.scrollTop||document.documentElement.scrollTop]:[t.scrollLeft,t.scrollTop]}function Pl(e,t){return e.addEventListener("scroll",t),function(){e.removeEventListener("scroll",t)}}function ti(e){if(e){if(Dr(e))return document.querySelector(e)}else return null;if(ho(e))return e();if(e instanceof Element)return e;if("current"in e)return e.current;if("value"in e)return e.value}var Lh=function(e){Oh(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._startRect=null,n._startPos=[],n._prevTime=0,n._timer=0,n._prevScrollPos=[0,0],n._isWait=!1,n._flag=!1,n._currentOptions=null,n._lock=!1,n._unregister=null,n._onScroll=function(){var a=n._currentOptions;n._lock||!a||n.emit("scrollDrag",{next:function(i){n.checkScroll({container:a.container,inputEvent:i})}})},n}var r=t.prototype;return r.dragStart=function(n,a){var i=ti(a.container);if(!i){this._flag=!1;return}var s=0,o=0,l=0,u=0;if(i===document.body)l=window.innerWidth,u=window.innerHeight;else{var c=i.getBoundingClientRect();s=c.top,o=c.left,l=c.width,u=c.height}this._flag=!0,this._startPos=[n.clientX,n.clientY],this._startRect={top:s,left:o,width:l,height:u},this._prevScrollPos=this._getScrollPosition([0,0],a),this._currentOptions=a,this._registerScrollEvent(a)},r.drag=function(n,a){if(clearTimeout(this._timer),!!this._flag){var i=n.clientX,s=n.clientY,o=a.threshold,l=o===void 0?0:o,u=this,c=u._startRect,f=u._startPos;this._currentOptions=a;var d=[0,0];return c.top>s-l?(f[1]>c.top||s<f[1])&&(d[1]=-1):c.top+c.height<s+l&&(f[1]<c.top+c.height||s>f[1])&&(d[1]=1),c.left>i-l?(f[0]>c.left||i<f[0])&&(d[0]=-1):c.left+c.width<i+l&&(f[0]<c.left+c.width||i>f[0])&&(d[0]=1),!d[0]&&!d[1]?!1:this._continueDrag(Wn(Wn({},a),{direction:d,inputEvent:n,isDrag:!0}))}},r.checkScroll=function(n){var a=this;if(this._isWait)return!1;var i=n.prevScrollPos,s=i===void 0?this._prevScrollPos:i,o=n.direction,l=n.throttleTime,u=l===void 0?0:l,c=n.inputEvent,f=n.isDrag,d=this._getScrollPosition(o||[0,0],n),p=d[0]-s[0],v=d[1]-s[1],h=o||[p?Math.abs(p)/p:0,v?Math.abs(v)/v:0];return this._prevScrollPos=d,this._lock=!1,!p&&!v?!1:(this.emit("move",{offsetX:h[0]?p:0,offsetY:h[1]?v:0,inputEvent:c}),u&&f&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){a._continueDrag(n)},u)),!0)},r.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},r._getScrollPosition=function(n,a){var i=a.container,s=a.getScrollPosition,o=s===void 0?Ph:s;return o({container:ti(i),direction:n})},r._continueDrag=function(n){var a=this,i,s=n.container,o=n.direction,l=n.throttleTime,u=n.useScroll,c=n.isDrag,f=n.inputEvent;if(!(!this._flag||c&&this._isWait)){var d=Ea(),p=Math.max(l+this._prevTime-d,0);if(p>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){a._continueDrag(n)},p),!1;this._prevTime=d;var v=this._getScrollPosition(o,n);this._prevScrollPos=v,c&&(this._isWait=!0),u||(this._lock=!0);var h={container:ti(s),direction:o,inputEvent:f};return(i=n.requestScroll)===null||i===void 0||i.call(n,h),this.emit("scroll",h),this._isWait=!1,u||this.checkScroll(Wn(Wn({},n),{prevScrollPos:v,direction:o,inputEvent:f}))}},r._registerScrollEvent=function(n){this._unregisterScrollEvent();var a=n.checkScrollEvent;if(a){var i=a===!0?Pl:a,s=ti(n.container);a===!0&&(s===document.body||s===document.documentElement)?this._unregister=Pl(window,this._onScroll):this._unregister=i(s,this._onScroll)}},r._unregisterScrollEvent=function(){var n;(n=this._unregister)===null||n===void 0||n.call(this),this._unregister=null},t}(Ni);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Vs=function(e,t){return Vs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},Vs(e,t)};function Fh(e,t){Vs(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var tr=function(){return tr=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},tr.apply(this,arguments)};function zh(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=Math.atan2(n,r);return a>=0?a:a+Math.PI*2}function ds(e){return zh([e[0].clientX,e[0].clientY],[e[1].clientX,e[1].clientY])/Math.PI*180}function Nh(e){return e.touches&&e.touches.length>=2}function ei(e){return e?e.touches?$h(e.touches):[fu(e)]:[]}function Vh(e){return e&&(e.type.indexOf("mouse")>-1||"button"in e)}function Ll(e,t,r){var n=r.length,a=xa(e,n),i=a.clientX,s=a.clientY,o=a.originalClientX,l=a.originalClientY,u=xa(t,n),c=u.clientX,f=u.clientY,d=xa(r,n),p=d.clientX,v=d.clientY,h=i-c,m=s-f,b=i-p,y=s-v;return{clientX:o,clientY:l,deltaX:h,deltaY:m,distX:b,distY:y}}function vs(e){return Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2))}function $h(e){for(var t=Math.min(e.length,2),r=[],n=0;n<t;++n)r.push(fu(e[n]));return r}function fu(e){return{clientX:e.clientX,clientY:e.clientY}}function xa(e,t){t===void 0&&(t=e.length);for(var r={clientX:0,clientY:0,originalClientX:0,originalClientY:0},n=Math.min(e.length,t),a=0;a<n;++a){var i=e[a];r.originalClientX+="originalClientX"in i?i.originalClientX:i.clientX,r.originalClientY+="originalClientY"in i?i.originalClientY:i.clientY,r.clientX+=i.clientX,r.clientY+=i.clientY}return t?{clientX:r.clientX/t,clientY:r.clientY/t,originalClientX:r.originalClientX/t,originalClientY:r.originalClientY/t}:r}var hs=function(){function e(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}return e.prototype.getAngle=function(t){return t===void 0&&(t=this.prevClients),ds(t)},e.prototype.getRotation=function(t){return t===void 0&&(t=this.prevClients),ds(t)-ds(this.startClients)},e.prototype.getPosition=function(t,r){t===void 0&&(t=this.prevClients);var n=Ll(t||this.prevClients,this.prevClients,this.startClients),a=n.deltaX,i=n.deltaY;return this.movement+=Math.sqrt(a*a+i*i),this.prevClients=t,n},e.prototype.getPositions=function(t){t===void 0&&(t=this.prevClients);for(var r=this.prevClients,n=this.startClients,a=Math.min(this.length,r.length),i=[],s=0;s<a;++s)i[s]=Ll([t[s]],[r[s]],[n[s]]);return i},e.prototype.getMovement=function(t){var r=this.movement;if(!t)return r;var n=xa(t,this.length),a=xa(this.prevClients,this.length),i=n.clientX-a.clientX,s=n.clientY-a.clientY;return Math.sqrt(i*i+s*s)+r},e.prototype.getDistance=function(t){return t===void 0&&(t=this.prevClients),vs(t)},e.prototype.getScale=function(t){return t===void 0&&(t=this.prevClients),vs(t)/vs(this.startClients)},e.prototype.move=function(t,r){this.startClients.forEach(function(n){n.clientX-=t,n.clientY-=r}),this.prevClients.forEach(function(n){n.clientX-=t,n.clientY-=r})},e}(),Fl=["textarea","input"],Hh=function(e){Fh(t,e);function t(r,n){n===void 0&&(n={});var a=e.call(this)||this;a.options={},a.flag=!1,a.pinchFlag=!1,a.data={},a.isDrag=!1,a.isPinch=!1,a.clientStores=[],a.targets=[],a.prevTime=0,a.doubleFlag=!1,a._useMouse=!1,a._useTouch=!1,a._useDrag=!1,a._dragFlag=!1,a._isTrusted=!1,a._isMouseEvent=!1,a._isSecondaryButton=!1,a._preventMouseEvent=!1,a._prevInputEvent=null,a._isDragAPI=!1,a._isIdle=!0,a._preventMouseEventId=0,a._window=window,a.onDragStart=function(d,p){if(p===void 0&&(p=!0),!(!a.flag&&d.cancelable===!1)){var v=d.type.indexOf("drag")>=-1;if(!(a.flag&&v)){a._isDragAPI=!0;var h=a.options,m=h.container,b=h.pinchOutside,y=h.preventWheelClick,S=h.preventRightClick,C=h.preventDefault,R=h.checkInput,D=h.dragFocusedInput,I=h.preventClickEventOnDragStart,W=h.preventClickEventOnDrag,G=h.preventClickEventByCondition,F=a._useTouch,X=!a.flag;if(a._isSecondaryButton=d.which===3||d.button===2,y&&(d.which===2||d.button===1)||S&&(d.which===3||d.button===2))return a.stop(),!1;if(X){var M=a._window.document.activeElement,st=d.target;if(st){var J=st.tagName.toLowerCase(),pt=Fl.indexOf(J)>-1,zt=st.isContentEditable;if(pt||zt){if(R||!D&&M===st)return!1;if(M&&(M===st||zt&&M.isContentEditable&&M.contains(st)))if(D)st.blur();else return!1}else if((C||d.type==="touchstart")&&M){var Xt=M.tagName.toLowerCase();(M.isContentEditable||Fl.indexOf(Xt)>-1)&&M.blur()}(I||W||G)&&vr(a._window,"click",a._onClick,!0)}a.clientStores=[new hs(ei(d))],a._isIdle=!1,a.flag=!0,a.isDrag=!1,a._isTrusted=p,a._dragFlag=!0,a._prevInputEvent=d,a.data={},a.doubleFlag=Ea()-a.prevTime<200,a._isMouseEvent=Vh(d),!a._isMouseEvent&&a._preventMouseEvent&&a._allowMouseEvent();var Ht=a._preventMouseEvent||a.emit("dragStart",tr(tr({data:a.data,datas:a.data,inputEvent:d,isMouseEvent:a._isMouseEvent,isSecondaryButton:a._isSecondaryButton,isTrusted:p,isDouble:a.doubleFlag},a.getCurrentStore().getPosition()),{preventDefault:function(){d.preventDefault()},preventDrag:function(){a._dragFlag=!1}}));Ht===!1&&a.stop(),a._isMouseEvent&&a.flag&&C&&d.preventDefault()}if(!a.flag)return!1;var Nt=0;if(X?(a._attchDragEvent(),F&&b&&(Nt=setTimeout(function(){vr(m,"touchstart",a.onDragStart,{passive:!1})}))):F&&b&&fr(m,"touchstart",a.onDragStart),a.flag&&Nh(d)){if(clearTimeout(Nt),X&&d.touches.length!==d.changedTouches.length)return;a.pinchFlag||a.onPinchStart(d)}}}},a.onDrag=function(d,p){if(a.flag){var v=a.options.preventDefault;!a._isMouseEvent&&v&&d.preventDefault(),a._prevInputEvent=d;var h=ei(d),m=a.moveClients(h,d,!1);if(a._dragFlag){if(a.pinchFlag||m.deltaX||m.deltaY){var b=a._preventMouseEvent||a.emit("drag",tr(tr({},m),{isScroll:!!p,inputEvent:d}));if(b===!1){a.stop();return}}a.pinchFlag&&a.onPinch(d,h)}a.getCurrentStore().getPosition(h,!0)}},a.onDragEnd=function(d){if(a.flag){var p=a.options,v=p.pinchOutside,h=p.container,m=p.preventClickEventOnDrag,b=p.preventClickEventOnDragStart,y=p.preventClickEventByCondition,S=a.isDrag;(m||b||y)&&requestAnimationFrame(function(){a._allowClickEvent()}),!y&&!b&&m&&!S&&a._allowClickEvent(),a._useTouch&&v&&fr(h,"touchstart",a.onDragStart),a.pinchFlag&&a.onPinchEnd(d);var C=d!=null&&d.touches?ei(d):[],R=C.length;R===0||!a.options.keepDragging?a.flag=!1:a._addStore(new hs(C));var D=a._getPosition(),I=Ea(),W=!S&&a.doubleFlag;a._prevInputEvent=null,a.prevTime=S||W?0:I,a.flag||(a._dettachDragEvent(),a._preventMouseEvent||a.emit("dragEnd",tr({data:a.data,datas:a.data,isDouble:W,isDrag:S,isClick:!S,isMouseEvent:a._isMouseEvent,isSecondaryButton:a._isSecondaryButton,inputEvent:d,isTrusted:a._isTrusted},D)),a.clientStores=[],a._isMouseEvent||(a._preventMouseEvent=!0,clearTimeout(a._preventMouseEventId),a._preventMouseEventId=setTimeout(function(){a._preventMouseEvent=!1},200)),a._isIdle=!0)}},a.onBlur=function(){a.onDragEnd()},a._allowClickEvent=function(){fr(a._window,"click",a._onClick,!0)},a._onClick=function(d){a._allowClickEvent(),a._allowMouseEvent();var p=a.options.preventClickEventByCondition;p!=null&&p(d)||(d.stopPropagation(),d.preventDefault())},a._onContextMenu=function(d){var p=a.options;p.preventRightClick?a.onDragEnd(d):d.preventDefault()},a._passCallback=function(){};var i=[].concat(r),s=i[0];a._window=jv(s)?s:us(s),a.options=tr({checkInput:!1,container:s&&!("document"in s)?us(s):s,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var o=a.options,l=o.container,u=o.events,c=o.checkWindowBlur;if(a._useDrag=u.indexOf("drag")>-1,a._useTouch=u.indexOf("touch")>-1,a._useMouse=u.indexOf("mouse")>-1,a.targets=i,a._useDrag&&i.forEach(function(d){vr(d,"dragstart",a.onDragStart)}),a._useMouse&&(i.forEach(function(d){vr(d,"mousedown",a.onDragStart),vr(d,"mousemove",a._passCallback)}),vr(l,"contextmenu",a._onContextMenu)),c&&vr(us(),"blur",a.onBlur),a._useTouch){var f={passive:!1};i.forEach(function(d){vr(d,"touchstart",a.onDragStart,f),vr(d,"touchmove",a._passCallback,f)})}return a}return t.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},t.prototype.getMovement=function(r){return this.getCurrentStore().getMovement(r)+this.clientStores.slice(1).reduce(function(n,a){return n+a.movement},0)},t.prototype.isDragging=function(){return this.isDrag},t.prototype.isIdle=function(){return this._isIdle},t.prototype.isFlag=function(){return this.flag},t.prototype.isPinchFlag=function(){return this.pinchFlag},t.prototype.isDoubleFlag=function(){return this.doubleFlag},t.prototype.isPinching=function(){return this.isPinch},t.prototype.scrollBy=function(r,n,a,i){i===void 0&&(i=!0),this.flag&&(this.clientStores[0].move(r,n),i&&this.onDrag(a,!0))},t.prototype.move=function(r,n){var a=r[0],i=r[1],s=this.getCurrentStore(),o=s.prevClients;return this.moveClients(o.map(function(l){var u=l.clientX,c=l.clientY;return{clientX:u+a,clientY:c+i,originalClientX:u,originalClientY:c}}),n,!0)},t.prototype.triggerDragStart=function(r){this.onDragStart(r,!1)},t.prototype.setEventData=function(r){var n=this.data;for(var a in r)n[a]=r[a];return this},t.prototype.setEventDatas=function(r){return this.setEventData(r)},t.prototype.getCurrentEvent=function(r){return r===void 0&&(r=this._prevInputEvent),tr(tr({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:r})},t.prototype.getEventData=function(){return this.data},t.prototype.getEventDatas=function(){return this.data},t.prototype.unset=function(){var r=this,n=this.targets,a=this.options.container;this.off(),fr(this._window,"blur",this.onBlur),this._useDrag&&n.forEach(function(i){fr(i,"dragstart",r.onDragStart)}),this._useMouse&&(n.forEach(function(i){fr(i,"mousedown",r.onDragStart)}),fr(a,"contextmenu",this._onContextMenu)),this._useTouch&&(n.forEach(function(i){fr(i,"touchstart",r.onDragStart)}),fr(a,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},t.prototype.onPinchStart=function(r){var n=this,a=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>a)){var i=new hs(ei(r));this.pinchFlag=!0,this._addStore(i);var s=this.emit("pinchStart",tr(tr({data:this.data,datas:this.data,angle:i.getAngle(),touches:this.getCurrentStore().getPositions()},i.getPosition()),{inputEvent:r,isTrusted:this._isTrusted,preventDefault:function(){r.preventDefault()},preventDrag:function(){n._dragFlag=!1}}));s===!1&&(this.pinchFlag=!1)}},t.prototype.onPinch=function(r,n){if(!(!this.flag||!this.pinchFlag||n.length<2)){var a=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",tr(tr({data:this.data,datas:this.data,movement:this.getMovement(n),angle:a.getAngle(n),rotation:a.getRotation(n),touches:a.getPositions(n),scale:a.getScale(n),distance:a.getDistance(n)},a.getPosition(n)),{inputEvent:r,isTrusted:this._isTrusted}))}},t.prototype.onPinchEnd=function(r){if(this.pinchFlag){var n=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var a=this.getCurrentStore();this.emit("pinchEnd",tr(tr({data:this.data,datas:this.data,isPinch:n,touches:a.getPositions()},a.getPosition()),{inputEvent:r}))}},t.prototype.getCurrentStore=function(){return this.clientStores[0]},t.prototype.moveClients=function(r,n,a){var i=this._getPosition(r,a),s=this.isDrag;(i.deltaX||i.deltaY)&&(this.isDrag=!0);var o=!1;return!s&&this.isDrag&&(o=!0),tr(tr({data:this.data,datas:this.data},i),{movement:this.getMovement(r),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:n,isTrusted:this._isTrusted,isFirstDrag:o})},t.prototype._addStore=function(r){this.clientStores.splice(0,0,r)},t.prototype._getPosition=function(r,n){var a=this.getCurrentStore(),i=a.getPosition(r,n),s=this.clientStores.slice(1).reduce(function(u,c){var f=c.getPosition();return u.distX+=f.distX,u.distY+=f.distY,u},i),o=s.distX,l=s.distY;return tr(tr({},i),{distX:o,distY:l})},t.prototype._attchDragEvent=function(){var r=this._window,n=this.options.container,a={passive:!1};this._isDragAPI&&(vr(n,"dragover",this.onDrag,a),vr(r,"dragend",this.onDragEnd)),this._useMouse&&(vr(n,"mousemove",this.onDrag),vr(r,"mouseup",this.onDragEnd)),this._useTouch&&(vr(n,"touchmove",this.onDrag,a),vr(r,"touchend",this.onDragEnd,a),vr(r,"touchcancel",this.onDragEnd,a))},t.prototype._dettachDragEvent=function(){var r=this._window,n=this.options.container;this._isDragAPI&&(fr(n,"dragover",this.onDrag),fr(r,"dragend",this.onDragEnd)),this._useMouse&&(fr(n,"mousemove",this.onDrag),fr(r,"mouseup",this.onDragEnd)),this._useTouch&&(fr(n,"touchstart",this.onDragStart),fr(n,"touchmove",this.onDrag),fr(r,"touchend",this.onDragEnd),fr(r,"touchcancel",this.onDragEnd))},t.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},t}(Ni);function Gh(e){for(var t=5381,r=e.length;r;)t=t*33^e.charCodeAt(--r);return t>>>0}var Wh=Gh;function Xh(e){return Wh(e).toString(36)}function Yh(e){if(e&&e.getRootNode){var t=e.getRootNode();if(t.nodeType===11)return t}}function Uh(e,t,r){return r.original?t:t.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(n,a){var i=a.trim();return(i?Rn(i):[""]).map(function(s){var o=s.trim();return o.indexOf("@")===0?o:o.indexOf(":global")>-1?o.replace(/\:global/g,""):o.indexOf(":host")>-1?"".concat(o.replace(/\:host/g,".".concat(e))):o?".".concat(e," ").concat(o):".".concat(e)}).join(", ")+" {"})}function jh(e,t,r,n,a){var i=Uv(n),s=i.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",e),s.setAttribute("data-styled-count","1"),r.nonce&&s.setAttribute("nonce",r.nonce),s.innerHTML=Uh(e,t,r),(a||i.head||i.body).appendChild(s),s}function qh(e){var t="rCS"+Xh(e);return{className:t,inject:function(r,n){n===void 0&&(n={});var a=Yh(r),i=(a||r.ownerDocument||document).querySelector('style[data-styled-id="'.concat(t,'"]'));if(!i)i=jh(t,e,n,r,a);else{var s=parseFloat(i.getAttribute("data-styled-count"))||0;i.setAttribute("data-styled-count","".concat(s+1))}return{destroy:function(){var o,l=parseFloat(i.getAttribute("data-styled-count"))||0;l<=1?(i.remove?i.remove():(o=i.parentNode)===null||o===void 0||o.removeChild(i),i=null):i.setAttribute("data-styled-count","".concat(l-1))}}}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var $s=function(e,t){return $s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},$s(e,t)};function du(e,t){$s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Hs=function(){return Hs=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Hs.apply(this,arguments)};function Kh(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}var Zh=function(e){du(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.injectResult=null,n.tag="div",n}var r=t.prototype;return r.render=function(){var n=this.props,a=n.className,i=a===void 0?"":a;n.cspNonce;var s=n.portalContainer,o=Kh(n,["className","cspNonce","portalContainer"]),l=this.injector.className,u=this.tag,c={};return lh.indexOf("simple")>-1&&s&&(c={portalContainer:s}),Ir(u,Hs({ref:Hr(this,"element"),"data-styled-id":l,className:i+" "+l},c,o))},r.componentDidMount=function(){this.injectResult=this.injector.inject(this.element,{nonce:this.props.cspNonce})},r.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},r.getElement=function(){return this.element},t}(bo);function vu(e,t){var r=qh(t);return function(n){du(a,n);function a(){var i=n!==null&&n.apply(this,arguments)||this;return i.injector=r,i.tag=e,i}return a}(Zh)}var Gs=function(e,t){return Gs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Gs(e,t)};function Ga(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Gs(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var it=function(){return it=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},it.apply(this,arguments)};function Qh(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Jh(e,t,r,n){var a=arguments.length,i=a<3?t:n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(i=(a<3?s(i):a>3?s(t,r,i):s(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function ge(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function Wa(e,t){var r;return it({events:{},props:(r={},r[e]=Boolean,r),name:e},t)}function tp(e,t){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*e,'px" height="').concat(32*e,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(t,'deg);transform-origin: 16px 16px"></path></svg>')}function ep(e){var t=tp(1,e),r=Math.round(e/45)*45%180,n="ns-resize";return r===135?n="nwse-resize":r===45?n="nesw-resize":r===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(t,"') 16 16, ").concat(n,";")}var xi=vh(),hu=xi.browser.webkit,pu=hu&&function(){var e=typeof window>"u"?{userAgent:""}:window.navigator,t=/applewebkit\/([^\s]+)/g.exec(e.userAgent.toLowerCase());return t?parseFloat(t[1])<605:!1}(),rp=xi.browser.name==="firefox",np=parseInt(xi.browser.webkitVersion,10)>=612||parseInt(xi.browser.version,10)>=15,ko="moveable-",ap=`
{
	position: absolute;
	width: 1px;
	height: 1px;
	left: 0;
	top: 0;
    z-index: 3000;
    --moveable-color: #4af;
    --zoom: 1;
    --zoompx: 1px;
    will-change: transform;
    outline: 1px solid transparent;
}
.control-box {
    z-index: 0;
}
.line, .control {
    position: absolute;
	left: 0;
    top: 0;
    will-change: transform;
}
.control {
	width: 14px;
	height: 14px;
	border-radius: 50%;
	border: 2px solid #fff;
	box-sizing: border-box;
    background: #4af;
    background: var(--moveable-color);
	margin-top: -7px;
    margin-left: -7px;
    border: 2px solid #fff;
    z-index: 10;
}
.padding {
    position: absolute;
    top: 0px;
    left: 0px;
    width: 100px;
    height: 100px;
    transform-origin: 0 0;
}
.line {
	width: 1px;
    height: 1px;
    background: #4af;
    background: var(--moveable-color);
	transform-origin: 0px 50%;
}
.line.edge {
    z-index: 1;
    background: transparent;
}
.line.dashed {
    box-sizing: border-box;
    background: transparent;
}
.line.dashed.horizontal {
    border-top: 1px dashed #4af;
    border-top-color: #4af;
    border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
    border-left: 1px dashed #4af;
    border-left-color: #4af;
    border-left-color: var(--moveable-color);
}
.line.vertical {
    transform: translateX(-50%);
}
.line.horizontal {
    transform: translateY(-50%);
}
.line.vertical.bold {
    width: 2px;
}
.line.horizontal.bold {
    height: 2px;
}

.control.origin {
	border-color: #f55;
	background: #fff;
	width: 12px;
	height: 12px;
	margin-top: -6px;
    margin-left: -6px;
	pointer-events: none;
}
`.concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(e){return`
.direction[data-rotation="`.concat(e,'"], :global .view-control-rotation').concat(e,` {
	`).concat(ep(e),`
}
`)}).join(`
`),`

.line.direction:before {
    content: "";
    position: absolute;
    width: 100%;
    height: calc(var(--moveable-line-padding, 0) * 1px);
    bottom: 0;
    left: 0;
}
.group {
    z-index: -1;
}
.area {
    position: absolute;
}
.area-pieces {
    position: absolute;
    top: 0;
    left: 0;
    display: none;
}
.area.avoid, .area.pass {
    pointer-events: none;
}
.area.avoid+.area-pieces {
    display: block;
}
.area-piece {
    position: absolute;
}

`).concat(pu?`:global svg *:before {
	content:"";
	transform-origin: inherit;
}`:"",`
`),ip=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],Ws=1e-4,xr=1e-7,ri=1e-9,Xs=Math.pow(10,10),zl=-Xs,sp=["n","w","s","e"],To=["n","w","s","e","nw","ne","sw","se"],op={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},Do={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},gu={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},mu=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag"];function Xa(e,t,r,n,a,i){var s,o;i===void 0&&(i="draggable");var l=(o=(s=t.gestos[i])===null||s===void 0?void 0:s.move(r,e.inputEvent))!==null&&o!==void 0?o:{},u=l.originalDatas||l.datas,c=u[i]||(u[i]={});return it(it({},l),{isPinch:!!n,parentEvent:!0,datas:c,originalDatas:e.originalDatas})}var Kn=function(){function e(r){var n;r===void 0&&(r="draggable"),this.ableName=r,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(n={},n[r]={},n)}var t=e.prototype;return t.dragStart=function(r,n){this.isDrag=!1,this.isFlag=!1;var a=n.originalDatas;return this.datas=a,a[this.ableName]||(a[this.ableName]={}),it(it({},this.move(r,n.inputEvent)),{type:"dragstart"})},t.drag=function(r,n){return this.move([r[0]-this.prevX,r[1]-this.prevY],n)},t.move=function(r,n){var a,i,s=!1;if(!this.isFlag)this.prevX=r[0],this.prevY=r[1],this.startX=r[0],this.startY=r[1],a=r[0],i=r[1],this.isFlag=!0;else{var o=this.isDrag;a=this.prevX+r[0],i=this.prevY+r[1],(r[0]||r[1])&&(this.isDrag=!0),!o&&this.isDrag&&(s=!0)}return this.prevX=a,this.prevY=i,{type:"drag",clientX:a,clientY:i,inputEvent:n,isFirstDrag:s,isDrag:this.isDrag,distX:a-this.startX,distY:i-this.startY,deltaX:r[0],deltaY:r[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},e}();function _u(e,t){var r=t.clientX,n=t.clientY,a=t.datas,i=e.state,s=i.moveableClientRect,o=i.rootMatrix,l=i.is3d,u=i.pos1,c=s.left,f=s.top,d=l?4:3,p=fe(Bn(o,[r-c,n-f],d),u),v=p[0],h=p[1],m=Kr({datas:a,distX:v,distY:h}),b=m[0],y=m[1];return[b,y]}function zn(e,t){var r=t.datas,n=e.state,a=n.allMatrix,i=n.beforeMatrix,s=n.is3d,o=n.left,l=n.top,u=n.origin,c=n.offsetMatrix,f=n.targetMatrix,d=n.transformOrigin,p=s?4:3;r.is3d=s,r.matrix=a,r.targetMatrix=f,r.beforeMatrix=i,r.offsetMatrix=c,r.transformOrigin=d,r.inverseMatrix=Wr(a,p),r.inverseBeforeMatrix=Wr(i,p),r.absoluteOrigin=In(De([o,l],u),p),r.startDragBeforeDist=dr(r.inverseBeforeMatrix,r.absoluteOrigin,p),r.startDragDist=dr(r.inverseMatrix,r.absoluteOrigin,p)}function lp(e){return Un(e.datas.beforeTransform,[50,50],100,100).direction}function Vi(e,t){var r=e.datas,n=e.originalDatas.beforeRenderable,a=r.transformIndex,i=n.nextTransforms,s=i.length,o=n.nextTransformAppendedIndexes,l=0;a===-1?(t==="translate"?l=0:t==="rotate"&&(l=tn(i,function(d){return d.match(/scale\(/g)})),l===-1&&(l=i.length),r.transformIndex=l):en(o,function(d){return d.index===a&&d.functionName===t})?l=a:l=a+o.filter(function(d){return d.index<a}).length;var u=Pp(i,l),c=u.targetFunction,f=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=u.beforeFunctionTexts,r.afterFunctionTexts=u.afterFunctionTexts,r.beforeTransform=u.beforeFunctionMatrix,r.beforeTransform2=u.beforeFunctionMatrix2,r.targetTansform=u.targetFunctionMatrix,r.afterTransform=u.afterFunctionMatrix,r.afterTransform2=u.afterFunctionMatrix2,r.targetAllTransform=u.allFunctionMatrix,c.functionName===f?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):s>l&&(r.isAppendTransform=!0,n.nextTransformAppendedIndexes=ge(ge([],o,!0),[{functionName:t,index:l,isAppend:!0}],!1))}function $i(e,t,r){return"".concat(e.beforeFunctionTexts.join(" ")," ").concat(e.isAppendTransform?r:t," ").concat(e.afterFunctionTexts.join(" "))}function up(e){var t=e.datas,r=e.distX,n=e.distY,a=xu({datas:t,distX:r,distY:n}),i=a[0],s=a[1],o=bu(t,_h([i,s],4));return dr(o,In([0,0,0],4),4)}function bu(e,t,r){var n=e.beforeTransform,a=e.afterTransform,i=e.beforeTransform2,s=e.afterTransform2,o=e.targetAllTransform,l=r?ze(o,t,4):ze(t,o,4),u=ze(Wr(r?i:n,4),l,4),c=ze(u,Wr(r?s:a,4),4);return c}function xu(e){var t=e.datas,r=e.distX,n=e.distY,a=t.inverseBeforeMatrix,i=t.is3d,s=t.startDragBeforeDist,o=t.absoluteOrigin,l=i?4:3;return fe(dr(a,De(o,[r,n]),l),s)}function Kr(e,t){var r=e.datas,n=e.distX,a=e.distY,i=r.inverseBeforeMatrix,s=r.inverseMatrix,o=r.is3d,l=r.startDragBeforeDist,u=r.startDragDist,c=r.absoluteOrigin,f=o?4:3;return fe(dr(t?i:s,De(c,[n,a]),f),t?l:u)}function cp(e,t){var r=e.datas,n=e.distX,a=e.distY;r.beforeMatrix;var i=r.matrix,s=r.is3d;r.startDragBeforeDist;var o=r.startDragDist,l=r.absoluteOrigin,u=s?4:3;return fe(dr(i,De(o,[n,a]),u),l)}function fp(e,t,r,n,a,i){return n===void 0&&(n=t),a===void 0&&(a=r),i===void 0&&(i=[0,0]),e?e.map(function(s,o){var l=Na(s),u=l.value,c=l.unit,f=o?a:n,d=o?r:t;if(s==="%"||isNaN(u)){var p=f?i[o]/f:0;return d*p}else if(c!=="%")return u;return d*u/100}):i}function yu(e){var t=[];return e[1]>=0&&(e[0]>=0&&t.push(3),e[0]<=0&&t.push(2)),e[1]<=0&&(e[0]>=0&&t.push(1),e[0]<=0&&t.push(0)),t}function dp(e,t){return yu(t).map(function(r){return e[r]})}function Ze(e,t){var r=(t[0]+1)/2,n=(t[1]+1)/2,a=[En(e[0][0],e[1][0],r,1-r),En(e[0][1],e[1][1],r,1-r)],i=[En(e[2][0],e[3][0],r,1-r),En(e[2][1],e[3][1],r,1-r)];return[En(a[0],i[0],n,1-n),En(a[1],i[1],n,1-n)]}function vp(e,t,r,n,a,i){var s=gn(t,r,n,a),o=Ze(s,i),l=e[0]-o[0],u=e[1]-o[1];return[l,u]}function Ya(e,t,r,n){return ze(e,yi(t,n,r),n)}function hp(e,t,r){var n=e.transformOrigin,a=e.offsetMatrix,i=e.is3d,s=t.beforeTransform,o=t.afterTransform,l=i?4:3,u=Eo([r]);return Ya(a,Xr(ze(ze(s,u,4),o,4),4,l),n,l)}function pp(e,t){var r=e.transformOrigin,n=e.offsetMatrix,a=e.is3d,i=e.targetMatrix,s=a?4:3;return Ya(n,ze(i,wo(t,s),s),r,s)}function Hi(e){var t=ia(e);return{setTransform:function(r,n){n===void 0&&(n=-1),t.startTransforms=ar(r)?r:hn(r),Ys(e,n)},setTransformIndex:function(r){Ys(e,r)}}}function Gi(e,t){var r=ia(e),n=r.startTransforms;Ys(e,tn(n,function(a){return a.indexOf("".concat(t,"("))===0}))}function Ys(e,t){var r=ia(e),n=e.datas;if(n.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var i=Mn([a]);n.startValue=i[0].functionValue}}}function Ro(e,t){var r=ia(e);r.nextTransforms=hn(t)}function ia(e){return e.originalDatas.beforeRenderable}function Su(e){var t=e.originalDatas.beforeRenderable;return t.nextTransforms}function ni(e){return Su(e).join(" ")}function ai(e){return ia(e).nextStyle}function wu(e,t,r,n,a){Ro(a,t);var i=_r.drag(e,Xa(a,e.state,r,n)),s=i?i.transform:t;return it(it({transform:t,drag:i},br({transform:s},a)),{afterTransform:s})}function Cu(e,t,r,n,a){var i=e.state,s=i.left,o=i.top,l=e.props.groupable,u=hp(e.state,a,t),c=l?s:0,f=l?o:0,d=Mu(e,r,u),p=fe(n,d);return fe(p,[c,f])}function gp(e,t,r,n,a){var i=Cu(e,"scale(".concat(t.join(", "),")"),r,n,a);return i}function Eu(e,t,r){return[-1+e[0]/(t/2),-1+e[1]/(r/2)]}function Mu(e,t,r){r===void 0&&(r=e.state.allMatrix);var n=e.state,a=n.width,i=n.height,s=n.is3d,o=s?4:3,l=[a/2*(1+t[0]),i/2*(1+t[1])];return sr(r,l,o)}function mp(e,t,r){var n=r.fixedDirection,a=r.fixedPosition;return Cu(e,"rotate(".concat(t,"deg)"),n,a,r)}function _p(e,t,r,n,a,i){var s=e.props.groupable,o=e.state,l=o.transformOrigin,u=o.offsetMatrix,c=o.is3d,f=o.width,d=o.height,p=o.left,v=o.top,h=i.fixedDirection,m=i.nextTargetMatrix||o.targetMatrix,b=c?4:3,y=fp(a,t,r,f,d,l),S=s?p:0,C=s?v:0,R=Ya(u,m,y,b),D=vp(n,R,t,r,b,h);return fe(D,[S,C])}function ku(e,t){return Ze(Cr(e.state),t)}function bp(e,t){var r=e.targetGesto,n=e.controlGesto,a;return r!=null&&r.isFlag()&&(a=r.getEventData()[t]),!a&&(n!=null&&n.isFlag())&&(a=n.getEventData()[t]),a||{}}function xp(e,t){return[e[0]*t[0],e[1]*t[1]]}function pe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return wv.apply(void 0,ge([ko],e,!1))}function Tu(e){e()}function yp(e){return!e||e==="none"?[1,0,0,1,0,0]:$r(e)?e:Eo(e)}function yi(e,t,r){return Os(t,ka(r,t),e,ka(r.map(function(n){return-n}),t))}function Sp(e,t,r){if(t==="%"){var n=Ao(e.ownerSVGElement);return n[r?"width":"height"]/100}return 1}function wp(e){var t=Si(rn(e,":before"));return t.map(function(r,n){var a=Na(r),i=a.value,s=a.unit;return i*Sp(e,s,n===0)})}function Si(e){var t=e.transformOrigin;return t?t.split(" "):["0","0"]}function Du(e,t){t===void 0&&(t=rn(e));var r=t.transform;if(r&&r!=="none")return t.transform;if("transform"in e){var n=e.transform,a=n.baseVal;if(!a)return"";var i=a.length;if(!i)return"";for(var s=[],o=function(u){var c=a[u].matrix;s.push("matrix(".concat(["a","b","c","d","e","f"].map(function(f){return c[f]}).join(", "),")"))},l=0;l<i;++l)o(l);return s.join(" ")}return""}function Ta(e,t,r,n,a){var i,s,o,l=e&&e.ownerDocument?e.ownerDocument:document,u=l.documentElement||l.body,c=!1,f,d;if(!e||r)f=e;else{var p=(i=e==null?void 0:e.assignedSlot)===null||i===void 0?void 0:i.parentElement,v=e.parentElement;p?(c=!0,d=v,f=p):f=v}for(var h=!1,m=e===t||f===t,b="relative",y=1,S=parseFloat((s=a)===null||s===void 0?void 0:s.zoom)||1,C=a==null?void 0:a.position;f&&f!==u;){t===f&&(m=!0);var R=rn(f),D=f.tagName.toLowerCase(),I=Du(f,R),W=R.willChange,G=parseFloat(R.zoom)||1;if(b=R.position,n&&G!==1){y=G;break}if(!r&&n&&S!==1&&C&&C!=="absolute"||D==="svg"||b!=="static"||I&&I!=="none"||W==="transform")break;var F=(o=e==null?void 0:e.assignedSlot)===null||o===void 0?void 0:o.parentNode,X=f.parentNode;F&&(c=!0,d=X);var M=F||X;if(M&&M.nodeType===11){f=M.host,h=!0;break}f=M,b="relative"}return{offsetZoom:y,hasSlot:c,parentSlotElement:d,isCustomElement:h,isStatic:b==="static",isEnd:m||!f||f===u,offsetParent:f||u}}function Cp(e,t,r){var n,a=e.tagName.toLowerCase(),i=e.offsetLeft,s=e.offsetTop,o=za(i),l=!o,u,c;return!l&&a!=="svg"?(u=pu?wp(e):Si(r).map(function(f){return parseFloat(f)}),c=u.slice(),l=!0,n=kp(e,u,e===t&&t.tagName.toLowerCase()==="g"),i=n[0],s=n[1],u[0]=n[2],u[1]=n[3]):(u=Si(r).map(function(f){return parseFloat(f)}),c=u.slice()),{tagName:a,isSVG:o,hasOffset:l,offset:[i||0,s||0],origin:u,targetOrigin:c}}function Ru(e,t,r){r===void 0&&(r=rn(e));var n=rn(document.body),a=n.position;if(!t&&(!a||a==="static"))return[0,0];var i=parseInt(n.marginLeft,10),s=parseInt(n.marginTop,10);return r.position==="absolute"&&((r.top!=="auto"||r.bottom!=="auto")&&(s=0),(r.left!=="auto"||r.right!=="auto")&&(i=0)),[i,s]}function Us(e){e.forEach(function(t){var r=t.matrix;r&&(t.matrix=Xr(r,3,4))})}function Ep(e){for(var t=e.parentElement,r=!1;t;){var n=rn(t).transform;if(n&&n!=="none"){r=!0;break}if(t===document.body)break;t=t.parentElement}return{fixedContainer:t||document.body,hasTransform:r}}function Wi(e,t){return t===void 0&&(t=e.length>9),"".concat(t?"matrix3d":"matrix","(").concat(su(e,!t).join(","),")")}function Ao(e){var t=e.clientWidth,r=e.clientHeight;if(!e)return{x:0,y:0,width:0,height:0,clientWidth:t,clientHeight:r};var n=e.viewBox,a=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:a.x,y:a.y,width:a.width||t,height:a.height||r,clientWidth:t,clientHeight:r}}function Mp(e,t){var r=Ao(e),n=r.width,a=r.height,i=r.clientWidth,s=r.clientHeight,o=i/n,l=s/a,u=e.preserveAspectRatio.baseVal,c=u.align,f=u.meetOrSlice,d=[0,0],p=[o,l],v=[0,0];if(c!==1){var h=(c-2)%3,m=Math.floor((c-2)/3);d[0]=n*h/2,d[1]=a*m/2;var b=f===2?Math.max(l,o):Math.min(o,l);p[0]=b,p[1]=b,v[0]=(i-n)/2*h,v[1]=(s-a)/2*m}var y=wo(p,t);return y[t*(t-1)]=v[0],y[t*(t-1)+1]=v[1],yi(y,t,d)}function kp(e,t,r){if(!e.getBBox||!r&&e.tagName.toLowerCase()==="g")return[0,0,0,0];var n=e.getBBox(),a=Ao(e.ownerSVGElement),i=n.x-a.x,s=n.y-a.y;return[i,s,t[0]-i,t[1]-s]}function sr(e,t,r){return dr(e,In(t,r),r)}function gn(e,t,r,n){return[[0,0],[t,0],[0,r],[t,r]].map(function(a){return sr(e,a,n)})}function Or(e){var t=e.map(function(u){return u[0]}),r=e.map(function(u){return u[1]}),n=Math.min.apply(Math,t),a=Math.min.apply(Math,r),i=Math.max.apply(Math,t),s=Math.max.apply(Math,r),o=i-n,l=s-a;return{left:n,top:a,right:i,bottom:s,width:o,height:l}}function Nl(e,t,r,n){var a=gn(e,t,r,n);return Or(a)}function Tp(e,t,r,n,a){var i,s=e.target,o=e.origin,l=t.matrix,u=Bu(s),c=u.offsetWidth,f=u.offsetHeight,d=r.getBoundingClientRect(),p=[0,0];r===document.body&&(p=Ru(s,!0));for(var v=s.getBoundingClientRect(),h=v.left-d.left+r.scrollLeft-(r.clientLeft||0)+p[0],m=v.top-d.top+r.scrollTop-(r.clientTop||0)+p[1],b=v.width,y=v.height,S=Os(n,a,l),C=Nl(S,c,f,n),R=C.left,D=C.top,I=C.width,W=C.height,G=sr(S,o,n),F=fe(G,[R,D]),X=[h+F[0]*b/I,m+F[1]*y/W],M=[0,0],st=0;++st<10;){var J=Wr(a,n);i=fe(sr(J,X,n),sr(J,G,n)),M[0]=i[0],M[1]=i[1];var pt=Os(n,a,ka(M,n),l),zt=Nl(pt,c,f,n),Xt=zt.left,Ht=zt.top,Nt=Xt-h,yt=Ht-m;if(Math.abs(Nt)<2&&Math.abs(yt)<2)break;X[0]-=Nt,X[1]-=yt}return M.map(function(It){return Math.round(It)})}function Dp(e,t,r){var n=e.length===16,a=n?4:3,i=t.map(function(l){return sr(e,l,a)}),s=r.left,o=r.top;return i.map(function(l){return[l[0]+s,l[1]+o]})}function Un(e,t,r,n){var a=e.length===16,i=a?4:3,s=gn(e,r,n,i),o=s[0],l=o[0],u=o[1],c=s[1],f=c[0],d=c[1],p=s[2],v=p[0],h=p[1],m=s[3],b=m[0],y=m[1],S=sr(e,t,i),C=S[0],R=S[1],D=Math.min(l,f,v,b),I=Math.min(u,d,h,y),W=Math.max(l,f,v,b),G=Math.max(u,d,h,y);l=l-D||0,f=f-D||0,v=v-D||0,b=b-D||0,u=u-I||0,d=d-I||0,h=h-I||0,y=y-I||0,C=C-D||0,R=R-I||0;var F=Ds(gn(e,100,100,i));return{left:D,top:I,right:W,bottom:G,origin:[C,R],pos1:[l,u],pos2:[f,d],pos3:[v,h],pos4:[b,y],direction:F}}function Nr(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Au(e,t){return Nr([t[0]-e[0],t[1]-e[1]])}function ha(e,t,r,n){r===void 0&&(r=1),n===void 0&&(n=Qe(e,t));var a=Au(e,t);return{transform:"translateY(-50%) translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(n,"rad) scaleY(").concat(r,")"),width:"".concat(a,"px")}}function Bo(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=r.length,i=r.reduce(function(o,l){return o+l[0]},0)/a,s=r.reduce(function(o,l){return o+l[1]},0)/a;return{transform:"translateZ(0px) translate(".concat(i,"px, ").concat(s,"px) rotate(").concat(e,"rad) scale(").concat(t,")")}}function On(e,t){var r=e[t];return $r(r)?it(it({},e),r):e}function Bu(e,t){t===void 0&&(t=e?rn(e):null);var r=e&&!za(e.offsetWidth),n=0,a=0,i=0,s=0,o=0,l=0,u=0,c=0,f=0,d=0,p=0,v=0,h=1/0,m=1/0,b=1/0,y=1/0,S=0,C=0,R=!1;if(e)if(!r&&e.tagName.toLowerCase()!=="svg"){var D=e.getBBox();R=!0,n=D.width,a=D.height,o=n,l=a,u=n,c=a,i=n,s=a}else{var I=e.style,W=t.boxSizing==="border-box",G=parseFloat(t.borderLeftWidth)||0,F=parseFloat(t.borderRightWidth)||0,X=parseFloat(t.borderTopWidth)||0,M=parseFloat(t.borderBottomWidth)||0,st=parseFloat(t.paddingLeft)||0,J=parseFloat(t.paddingRight)||0,pt=parseFloat(t.paddingTop)||0,zt=parseFloat(t.paddingBottom)||0,Xt=st+J,Ht=pt+zt,Nt=G+F,yt=X+M,It=Xt+Nt,Rt=Ht+yt,Mt=t.position,lt=0,Bt=0;if("clientLeft"in e){var O=null;if(Mt==="absolute"){var V=Ta(e,document.body);O=V.offsetParent}else O=e.parentElement;if(O){var _=rn(O);lt=parseFloat(_.width),Bt=parseFloat(_.height)}}f=Math.max(Xt,$e(t.minWidth,lt)||0),d=Math.max(Ht,$e(t.minHeight,Bt)||0),h=$e(t.maxWidth,lt),m=$e(t.maxHeight,Bt),isNaN(h)&&(h=1/0),isNaN(m)&&(m=1/0),S=$e(I.width,0)||0,C=$e(I.height,0)||0,o=parseFloat(t.width)||0,l=parseFloat(t.height)||0,u=Math.abs(o-S)<1?ks(f,S||o,h):o,c=Math.abs(l-C)<1?ks(d,C||l,m):l,n=u,a=c,i=u,s=c,W?(b=h,y=m,p=f,v=d,u=n-It,c=a-Rt):(b=h+It,y=m+Rt,p=f+It,v=d+Rt,n=u+It,a=c+Rt),i=u+Xt,s=c+Ht}return{svg:R,offsetWidth:n,offsetHeight:a,clientWidth:i,clientHeight:s,contentWidth:u,contentHeight:c,inlineCSSWidth:S,inlineCSSHeight:C,cssWidth:o,cssHeight:l,minWidth:f,minHeight:d,maxWidth:h,maxHeight:m,minOffsetWidth:p,minOffsetHeight:v,maxOffsetWidth:b,maxOffsetHeight:y}}function Iu(e,t){return Qe(t>0?e[0]:e[1],t>0?e[1]:e[0])}function ii(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function Ou(e,t){var r=e===document.body||e===document.documentElement,n={clientLeft:e.clientLeft,clientTop:e.clientTop,clientWidth:e.clientWidth,clientHeight:e.clientHeight,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,overflow:!1};return r&&(n.clientHeight=Math.max(t.height,n.clientHeight),n.scrollHeight=Math.max(t.height,n.scrollHeight)),n.overflow=rn(e).overflow!=="visible",it(it({},t),n)}function ps(e,t,r,n){var a=e.left,i=e.right,s=e.top,o=e.bottom,l=t.top,u=t.left,c={left:u+a,top:l+s,right:u+i,bottom:l+o,width:i-a,height:o-s};return r&&n?Ou(r,c):c}function pa(e,t){var r=0,n=0,a=0,i=0;if(e){var s=e.getBoundingClientRect();r=s.left,n=s.top,a=s.width,i=s.height}var o={left:r,top:n,width:a,height:i,right:r+a,bottom:n+i};return e&&t?Ou(e,o):o}function Pu(e,t,r,n){var a;if(e)a=e;else if(t)a=[0,0];else{var i=r.target;a=Lu(i,n)}return a}function Lu(e,t){if(e){var r=e.getAttribute("data-rotation")||"",n=e.getAttribute("data-direction");if(t.deg=r,!!n){var a=[0,0];return n.indexOf("w")>-1&&(a[0]=-1),n.indexOf("e")>-1&&(a[0]=1),n.indexOf("n")>-1&&(a[1]=-1),n.indexOf("s")>-1&&(a[1]=1),a}}}function Io(e,t){return[De(t,e[0]),De(t,e[1]),De(t,e[2]),De(t,e[3])]}function Cr(e){var t=e.left,r=e.top,n=e.pos1,a=e.pos2,i=e.pos3,s=e.pos4;return Io([n,a,i,s],[t,r])}function Rp(e){return Math.round(e%1===-.5?e-1:e)}function Xn(e,t){var r;(r=e[t])===null||r===void 0||r.unset(),e[t]=null}function br(e,t){if(t){var r=ia(t);r.nextStyle=it(it({},r.nextStyle),e)}return{style:e,cssText:aa(e).map(function(n){return"".concat(pi(n,"-"),": ").concat(e[n],";")}).join("")}}function Fu(e,t,r){var n=t.afterTransform||t.transform;return it(it({},br(it(it(it({},e.style),t.style),{transform:n}),r)),{afterTransform:n,transform:e.transform})}function Ce(e,t,r,n){var a=t.datas;a.datas||(a.datas={});var i=it(it({},r),{target:e.state.target,clientX:t.clientX,clientY:t.clientY,inputEvent:t.inputEvent,currentTarget:e,moveable:e,datas:a.datas,isFirstDrag:!!t.isFirstDrag,isTrusted:t.isTrusted!==!1,stopAble:function(){a.isEventStart=!1},stopDrag:function(){var s;(s=t.stop)===null||s===void 0||s.call(t)}});return a.isStartEvent?n||(a.lastEvent=i):a.isStartEvent=!0,i}function Rr(e,t,r){var n=t.datas,a="isDrag"in r?r.isDrag:t.isDrag;return n.datas||(n.datas={}),it(it({isDrag:a},r),{moveable:e,target:e.state.target,clientX:t.clientX,clientY:t.clientY,inputEvent:t.inputEvent,currentTarget:e,lastEvent:n.lastEvent,isDouble:t.isDouble,datas:n.datas,isFirstDrag:!!t.isFirstDrag})}function Xi(e,t,r){e._emitter.on(t,r)}function le(e,t,r,n){return e.triggerEvent(t,r,n)}function rn(e,t){return window.getComputedStyle(e,t)}function si(e,t,r){var n={},a={};return e.filter(function(i){var s=i.name;if(n[s]||!t.some(function(o){return i[o]}))return!1;if(!r&&i.ableGroup){if(a[i.ableGroup])return!1;a[i.ableGroup]=!0}return n[s]=!0,!0})}function js(e,t){return e===t||e==null&&t==null}function Ap(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.length-1,n=0;n<r;++n){var a=e[n];if(!za(a))return a}return e[r]}function zu(e,t){var r=[],n=[];return e.forEach(function(a,i){var s=t(a,i,e),o=n.indexOf(s),l=r[o]||[];o===-1&&(n.push(s),r.push(l)),l.push(a)}),r}function Bp(e,t){var r=[],n={};return e.forEach(function(a,i){var s=t(a,i,e),o=n[s];o||(o=[],n[s]=o,r.push(o)),o.push(a)}),r}function Nu(e){return e.reduce(function(t,r){return t.concat(r)},[])}function Zn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.sort(function(r,n){return Math.abs(n)-Math.abs(r)}),e[0]}function Bn(e,t,r){return dr(Wr(e,r),In(t,r),r)}function Ip(e,t){var r,n=e.is3d,a=e.rootMatrix,i=n?4:3;return r=Bn(a,[t.distX,t.distY],i),t.distX=r[0],t.distY=r[1],t}function oi(e,t,r,n,a){return fe(sr(e,De(r,t),a),n)}function Lr(e,t,r){return r?"".concat(e/t*100,"%"):"".concat(e,"px")}function wi(e){return Math.abs(e)<=xr?0:e}function Oo(e){return function(t){if(!t.isDragging(e))return"";var r=bp(t,e),n=r.deg;return n?pe("view-control-rotation".concat(n)):""}}function Po(e,t){return t===void 0&&(t=[e]),function(r,n){if(n.isRequest)return t.some(function(i){return n.requestAble===i})?n.parentDirection:!1;var a=n.inputEvent.target;return or(a,pe("direction"))&&(!e||or(a,pe(e)))}}function Op(e){var t={};for(var r in e)t[e[r]]=r;return t}function Pp(e,t){var r=e.slice(0,t<0?void 0:t),n=e.slice(0,t<0?void 0:t+1),a=e[t]||"",i=t<0?[]:e.slice(t),s=t<0?[]:e.slice(t+1),o=Mn(r),l=Mn(n),u=Mn([a]),c=Mn(i),f=Mn(s),d=Hn(o),p=Hn(l),v=Hn(c),h=Hn(f),m=ze(d,v,4);return{transforms:e,beforeFunctionMatrix:d,beforeFunctionMatrix2:p,targetFunctionMatrix:Hn(u),afterFunctionMatrix:v,afterFunctionMatrix2:h,allFunctionMatrix:m,beforeFunctions:o,beforeFunctions2:l,targetFunction:u[0],afterFunctions:c,afterFunctions2:f,beforeFunctionTexts:r,beforeFunctionTexts2:n,targetFunctionText:a,afterFunctionTexts:i,afterFunctionTexts2:s}}function Lp(e){return!e||!$r(e)||e instanceof Element?!1:ar(e)||"length"in e}function Pn(e,t){return e?e instanceof Element?e:Dr(e)?t?document.querySelector(e):e:ho(e)?e():"current"in e?e.current:e:null}function Lo(e,t){if(!e)return[];var r=Lp(e)?[].slice.call(e):[e];return r.reduce(function(n,a){return Dr(a)&&t?ge(ge([],n,!0),[].slice.call(document.querySelectorAll(a)),!0):(ar(a)?n.push(Lo(a,t)):n.push(Pn(a,t)),n)},[])}function Fp(e,t,r){var n=Qe(e,t)/Math.PI*180;return n=r>=0?n:180-n,n=n>=0?n:360+n,n}function Vl(e,t){var r=e.rootMatrix,n=e.is3d,a=n?4:3,i=Wr(r,a);return n||(i=Xr(i,3,4)),i[12]=0,i[13]=0,i[14]=0,Ch(i,t)}function Vu(e,t,r,n,a){var i=e[0],s=e[1],o=0,l=0;if(a&&i&&s){var u=Qe([0,0],t),c=Qe([0,0],n),f=Nr(t),d=Math.cos(u-c)*f;if(!n[0])l=d,o=l*r;else if(!n[1])o=d,l=o/r;else{var p=n[0]*2*i,v=n[1]*2*s,h=Nr([p+t[0],v+t[1]])-Nr([p,v]),m=Qe([0,0],[r,1]);o=Math.cos(m)*h,l=Math.sin(m)*h}}else o=n[0]*t[0],l=n[1]*t[1];return[o,l]}function $u(e,t,r,n){var a,i=r.ratio,s=r.startOffsetWidth,o=r.startOffsetHeight,l=0,u=0,c=n.distX,f=n.distY,d=n.parentDistance,p=n.parentDist,v=n.parentScale,h=r.fixedDirection,m=[0,1].map(function(D){return Math.abs(e[D]-h[D])}),b=[0,1].map(function(D){var I=m[D];return I!==0&&(I=2/I),I});if(p)l=p[0],u=p[1],t&&(l?u||(u=l/i):l=u*i);else if(v)l=(v[0]-1)*s,u=(v[1]-1)*o;else if(d){var y=s*m[0],S=o*m[1],C=Nr([y,S]);l=d/C*y*b[0],u=d/C*S*b[1]}else{var R=Kr({datas:r,distX:c,distY:f});R=b.map(function(D,I){return R[I]*D}),a=Vu([s,o],R,i,e,t),l=a[0],u=a[1]}return{distWidth:l,distHeight:u}}function qs(e,t){if(t){if(e==="left")return{x:"0%",y:"50%"};if(e==="top")return{x:"50%",y:"50%"};if(e==="center")return{x:"50%",y:"50%"};if(e==="right")return{x:"100%",y:"50%"};if(e==="bottom")return{x:"50%",y:"100%"};var r=e.split(" "),n=r[0],a=r[1],i=qs(n||""),s=qs(a||""),o=it(it({},i),s),l={x:"50%",y:"50%"};return o.x&&(l.x=o.x),o.y&&(l.y=o.y),o.value&&(o.x&&!o.y&&(l.y=o.value),!o.x&&o.y&&(l.x=o.value)),l}return e==="left"?{x:"0%"}:e==="right"?{x:"100%"}:e==="top"?{y:"0%"}:e==="bottom"?{y:"100%"}:e?e==="center"?{value:"50%"}:{value:e}:{}}function zp(e,t,r){var n=qs(e,!0),a=n.x,i=n.y;return[$e(a,t)||0,$e(i,r)||0]}function Np(e,t,r){var n=e.map(function(i){return fe(i,t)}),a=n.map(function(i){return Ha(i,r)});return{prev:n,next:a,result:a.map(function(i){return De(i,t)})}}function Hu(e,t){return e.length===t.length&&e.every(function(r,n){var a=t[n],i=ar(r),s=ar(a);return i&&s?Hu(r,a):!i&&!s?r===a:!1})}var Vp=Wa("pinchable",{events:{onPinchStart:"pinchStart",onPinch:"pinch",onPinchEnd:"pinchEnd",onPinchGroupStart:"pinchGroupStart",onPinchGroup:"pinchGroup",onPinchGroupEnd:"pinchGroupEnd"},dragStart:function(){return!0},pinchStart:function(e,t){var r=t.datas,n=t.targets,a=t.angle,i=t.originalDatas,s=e.props,o=s.pinchable,l=s.ables;if(!o)return!1;var u="onPinch".concat(n?"Group":"","Start"),c="drag".concat(n?"Group":"","ControlStart"),f=(o===!0?e.controlAbles:l.filter(function(h){return o.indexOf(h.name)>-1})).filter(function(h){return h.canPinch&&h[c]}),d=Ce(e,t,{});n&&(d.targets=n);var p=le(e,u,d);r.isPinch=p!==!1,r.ables=f;var v=r.isPinch;return v?(f.forEach(function(h){if(i[h.name]=i[h.name]||{},!!h[c]){var m=it(it({},t),{datas:i[h.name],parentRotate:a,isPinch:!0});h[c](e,m)}}),e.state.snapRenderInfo={request:t.isRequest,direction:[0,0]},v):!1},pinch:function(e,t){var r=t.datas,n=t.scale,a=t.distance,i=t.originalDatas,s=t.inputEvent,o=t.targets,l=t.angle;if(r.isPinch){var u=a*(1-1/n),c=Ce(e,t,{});o&&(c.targets=o);var f="onPinch".concat(o?"Group":"");le(e,f,c);var d=r.ables,p="drag".concat(o?"Group":"","Control");return d.forEach(function(v){v[p]&&v[p](e,it(it({},t),{datas:i[v.name],inputEvent:s,parentDistance:u,parentRotate:l,isPinch:!0}))}),c}},pinchEnd:function(e,t){var r=t.datas,n=t.isPinch,a=t.inputEvent,i=t.targets,s=t.originalDatas;if(r.isPinch){var o="onPinch".concat(i?"Group":"","End"),l=Rr(e,t,{isDrag:n});i&&(l.targets=i),le(e,o,l);var u=r.ables,c="drag".concat(i?"Group":"","ControlEnd");return u.forEach(function(f){f[c]&&f[c](e,it(it({},t),{isDrag:n,datas:s[f.name],inputEvent:a,isPinch:!0}))}),n}},pinchGroupStart:function(e,t){return this.pinchStart(e,it(it({},t),{targets:e.props.targets}))},pinchGroup:function(e,t){return this.pinch(e,it(it({},t),{targets:e.props.targets}))},pinchGroupEnd:function(e,t){return this.pinchEnd(e,it(it({},t),{targets:e.props.targets}))}});function Vr(e,t,r){var n=r.originalDatas;n.groupable=n.groupable||{};var a=n.groupable;a.childDatas=a.childDatas||[];var i=a.childDatas;return e.moveables.map(function(s,o){return i[o]=i[o]||{},i[o][t]=i[o][t]||{},it(it({},r),{datas:i[o][t],originalDatas:i[o]})})}function gs(e,t,r,n,a,i,s){var o=!!r.match(/Start$/g),l=!!r.match(/End$/g),u=a.isPinch,c=a.datas,f=Vr(e,t.name,a),d=e.moveables,p=f.map(function(v,h){var m=d[h],b=m.state,y=b.gestos,S=v;if(o)S=new Kn(s).dragStart(n,v);else{if(y[s]||(y[s]=c.childGestos[h]),!y[s])return;S=Xa(v,b,n,u,i,s)}var C=t[r](m,it(it({},S),{parentFlag:!0}));return l&&(y[s]=null),C});return o&&(c.childGestos=d.map(function(v){return v.state.gestos[s]})),p}function Qr(e,t,r,n,a,i){a===void 0&&(a=function(c,f){return f});var s=!!r.match(/End$/g),o=Vr(e,t.name,n),l=e.moveables,u=o.map(function(c,f){var d=l[f],p=c;p=a(d,c);var v=t[r](d,it(it({},p),{parentFlag:!0}));return v&&i&&i(d,c,v,f),s&&(d.state.gestos={}),v});return u}var $p=["left","right","center"],Hp=["top","bottom","middle"],mn={start:"left",end:"right",center:"center"},_n={start:"top",end:"bottom",center:"middle"};function sa(e,t){var r=e.props,n=r.snappable,a=r.bounds,i=r.innerBounds,s=r.verticalGuidelines,o=r.horizontalGuidelines,l=r.snapGridWidth,u=r.snapGridHeight,c=e.state,f=c.guidelines,d=c.enableSnap;return!n||!d||t&&n!==!0&&n.indexOf(t)<0?!1:!!(l||u||a||i||f&&f.length||s&&s.length||o&&o.length)}function Fo(e){return e===!1?{}:e===!0||!e?{left:!0,right:!0,top:!0,bottom:!0}:e}function Gp(e,t){var r=Fo(e),n={};for(var a in r)a in t&&r[a]&&(n[a]=t[a]);return n}function zo(e,t){var r=Gp(e,t),n=Hp.filter(function(i){return i in r}),a=$p.filter(function(i){return i in r});return{horizontal:n.map(function(i){return r[i]}),vertical:a.map(function(i){return r[i]})}}function Wp(e,t,r){var n=sr(e,[t.clientLeft,t.clientTop],r);return[t.left+n[0],t.top+n[1]]}function Xp(e){var t=e[0],r=e[1],n=r[0]-t[0],a=r[1]-t[1];Math.abs(n)<er&&(n=0),Math.abs(a)<er&&(a=0);var i=0,s=0,o=0;return n?a?(i=-a/n,s=1,o=i*t[0]-t[1]):(s=1,o=-t[1]):(i=-1,o=t[0]),[i,s,o].map(function(l){return we(l,er)})}function Yi(e,t,r,n){var a=e.props,i=Ap(n,a.snapThreshold,5);return Gu(e.state.guidelines,t,r,i)}function Gu(e,t,r,n){return{vertical:Hl(e,"vertical",t,n),horizontal:Hl(e,"horizontal",r,n)}}function Yp(e,t,r){var n=r[0],a=r[1],i=t[0],s=t[1],o=fe(r,t),l=o[0],u=o[1],c=u>0,f=l>0;l=wi(l),u=wi(u);var d={isSnap:!1,offset:0,pos:0},p={isSnap:!1,offset:0,pos:0};if(l===0&&u===0)return{vertical:d,horizontal:p};var v=Yi(e,l?[n]:[],u?[a]:[]),h=v.vertical,m=v.horizontal;h.posInfos.filter(function(J){var pt=J.pos;return f?pt>=i:pt<=i}),m.posInfos.filter(function(J){var pt=J.pos;return c?pt>=s:pt<=s}),h.isSnap=h.posInfos.length>0,m.isSnap=m.posInfos.length>0;var b=Ks(h),y=b.isSnap,S=b.guideline,C=Ks(m),R=C.isSnap,D=C.guideline,I=R?D.pos[1]:0,W=y?S.pos[0]:0;if(l===0)R&&(p.isSnap=!0,p.pos=D.pos[1],p.offset=a-p.pos);else if(u===0)y&&(d.isSnap=!0,d.pos=W,d.offset=n-W);else{var G=u/l,F=r[1]-G*n,X=0,M=0,st=!1;y?(M=W,X=G*M+F,st=!0):R&&(X=I,M=(X-F)/G,st=!0),st&&(d.isSnap=!0,d.pos=M,d.offset=n-M,p.isSnap=!0,p.pos=X,p.offset=a-X)}return{vertical:d,horizontal:p}}function $l(e,t,r){var n=zo(e.props.snapDirections,t);return Yi(e,n.vertical,n.horizontal,r)}function Ks(e){var t=e.isSnap;if(!t)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var r=e.posInfos[0],n=r.guidelineInfos[0],a=n.offset,i=n.dist,s=n.guideline;return{isSnap:t,offset:a,dist:i,pos:r.pos,guideline:s}}function Hl(e,t,r,n){if(!e||!e.length)return{isSnap:!1,index:-1,posInfos:[]};var a=t==="vertical",i=a?0:1,s=r.map(function(l,u){var c=e.map(function(f){var d=f.pos,p=l-d[i];return{offset:p,dist:Math.abs(p),guideline:f}}).filter(function(f){var d=f.guideline,p=f.dist,v=d.type;return!(v!==t||p>n)}).sort(function(f,d){return f.dist-d.dist});return{pos:l,index:u,guidelineInfos:c}}).filter(function(l){return l.guidelineInfos.length>0}).sort(function(l,u){return l.guidelineInfos[0].dist-u.guidelineInfos[0].dist}),o=s.length>0;return{isSnap:o,index:o?s[0].index:-1,posInfos:s}}function Up(e,t,r,n){n===void 0&&(n=1);var a=[];if(r[0]&&r[1])a=[r,[-r[0],r[1]],[r[0],-r[1]]].map(function(o){return Ze(t,o)});else if(!r[0]&&!r[1])for(var i=[t[0],t[1],t[3],t[2],t[0]],s=0;s<4;++s)a.push(i[s]),a.push([(i[s][0]+i[s+1][0])/2,(i[s][1]+i[s+1][1])/2]);else e.props.keepRatio?a=[[-1,-1],[-1,1],[1,-1],[1,1],r].map(function(o){return Ze(t,o)}):(a=dp(t,r),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));return Yi(e,a.map(function(o){return o[0]}),a.map(function(o){return o[1]}),n)}function Wu(e,t){var r=Math.abs(e.offset),n=Math.abs(t.offset);return e.isBound&&t.isBound?n-r:e.isBound?-1:t.isBound?1:e.isSnap&&t.isSnap?n-r:e.isSnap?-1:t.isSnap||r<xr?1:n<xr?-1:r-n}function Ci(e,t){return e.slice().sort(function(r,n){var a=r.sign[t],i=n.sign[t],s=r.offset[t],o=n.offset[t];if(a){if(!i)return-1}else return 1;return Wu({isBound:r.isBound,isSnap:r.isSnap,offset:s},{isBound:n.isBound,isSnap:n.isSnap,offset:o})})[0]}function jp(e,t,r){var n=[];if(r)Math.abs(t[0])!==1||Math.abs(t[1])!==1?n.push([t,[-1,-1]],[t,[-1,1]],[t,[1,-1]],[t,[1,1]]):n.push([t,[e[0],-e[1]]],[t,[-e[0],e[1]]]),n.push([t,e]);else if(e[0]&&e[1]||!e[0]&&!e[1]){var a=e[0]?e:[1,1];[1,-1].forEach(function(s){[1,-1].forEach(function(o){var l=[s*a[0],o*a[1]];t[0]===l[0]&&t[1]===l[1]||n.push([t,l])})})}else if(e[0]){var i=Math.abs(t[0])===1?[1]:[1,-1];i.forEach(function(s){n.push([[t[0],-1],[s*e[0],-1]],[[t[0],0],[s*e[0],0]],[[t[0],1],[s*e[0],1]])})}else if(e[1]){var i=Math.abs(t[1])===1?[1]:[1,-1];i.forEach(function(o){n.push([[-1,t[1]],[-1,o*e[1]]],[[0,t[1]],[0,o*e[1]]],[[1,t[1]],[1,o*e[1]]])})}return n}function Xu(e,t){var r=Ts([t[0][0],t[1][0]]),n=Ts([t[0][1],t[1][1]]);return{vertical:r<=e[0],horizontal:n<=e[1]}}function No(e,t){var r=t[0],n=t[1],a=n[0]-r[0],i=n[1]-r[1];Math.abs(a)<xr&&(a=0),Math.abs(i)<xr&&(i=0);var s,o;if(!a)s=r[0],o=e[0];else if(!i)s=r[1],o=e[1];else{var l=i/a;s=l*(e[0]-r[0])+r[1],o=e[1]}return s-o}function Yu(e,t,r,n){return n===void 0&&(n=xr),e.every(function(a){var i=No(a,t),s=i<=0;return s===r||Math.abs(i)<=n})}function Gl(e,t,r,n,a){return a===void 0&&(a=0),n&&t-a<=e||!n&&e<=r+a?{isBound:!0,offset:n?t-e:r-e}:{isBound:!1,offset:0}}function qp(e,t){var r=t.line,n=t.centerSign,a=t.verticalSign,i=t.horizontalSign,s=t.lineConstants,o=e.props.innerBounds;if(!o)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var l=o.left,u=o.top,c=o.width,f=o.height,d=[[l,u],[l,u+f]],p=[[l,u],[l+c,u]],v=[[l+c,u],[l+c,u+f]],h=[[l,u+f],[l+c,u+f]];if(Yu([[l,u],[l+c,u],[l,u+f],[l+c,u+f]],r,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var m=fn(r,s,p,a),b=fn(r,s,h,a),y=fn(r,s,d,i),S=fn(r,s,v,i),C=m.isBound&&b.isBound,R=m.isBound||b.isBound,D=y.isBound&&S.isBound,I=y.isBound||S.isBound,W=Zn(m.offset,b.offset),G=Zn(y.offset,S.offset),F=[0,0],X=!1,M=!1;return Math.abs(G)<Math.abs(W)?(F=[W,0],X=R,M=C):(F=[0,G],X=I,M=D),{isAllBound:M,isVerticalBound:R,isHorizontalBound:I,isBound:X,offset:F}}function fn(e,t,r,n,a,i){var s=t[0],o=t[1],l=e[0],u=r[0],c=r[1],f=wi(c[1]-u[1]),d=wi(c[0]-u[0]),p=o,v=s,h=-s/o;if(d){if(!f){if(i&&!p)return{isBound:!1,offset:0};if(v){var S=(u[1]-l[1])/h+l[0];return Gl(S,u[0],c[0],n,a)}else{var b=u[1]-l[1],y=Math.abs(b)<=(a||0);return{isBound:y,offset:y?b:0}}}}else{if(i&&!v)return{isBound:!1,offset:0};if(p){var m=h*(u[0]-l[0])+l[1];return Gl(m,u[1],c[1],n,a)}else{var b=u[0]-l[0],y=Math.abs(b)<=(a||0);return{isBound:y,offset:y?b:0}}}return{isBound:!1,offset:0}}function Uu(e,t,r){return t.map(function(n){var a=qp(e,n),i=a.isBound,s=a.offset,o=a.isVerticalBound,l=a.isHorizontalBound,u=n.multiple,c=Kr({datas:r,distX:s[0],distY:s[1]}).map(function(f,d){return f*(u[d]?2/u[d]:0)});return{sign:u,isBound:i,isVerticalBound:o,isHorizontalBound:l,isSnap:!1,offset:c}})}function Kp(e,t,r){var n,a=Vo(e,t,[0,0],!1).map(function(d){return it(it({},d),{multiple:d.multiple.map(function(p){return Math.abs(p)*2})})}),i=Uu(e,a,r),s=Ci(i,0),o=Ci(i,1),l=0,u=0,c=s.isVerticalBound||o.isVerticalBound,f=s.isHorizontalBound||o.isHorizontalBound;return(c||f)&&(n=cp({datas:r,distX:-s.offset[0],distY:-o.offset[1]}),l=n[0],u=n[1]),{vertical:{isBound:c,offset:l},horizontal:{isBound:f,offset:u}}}function Zp(e,t){var r=[],n=e[0],a=e[1];return n&&a?r.push([[0,a*2],e,[-n,a]],[[n*2,0],e,[n,-a]]):n?(r.push([[n*2,0],[n,1],[n,-1]]),t&&r.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):a?(r.push([[0,a*2],[1,a],[-1,a]]),t&&r.push([[-1,0],[-1,a],[-1,-a]],[[1,0],[1,a],[1,-a]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r}function Vo(e,t,r,n){var a=e.state,i=a.allMatrix,s=a.is3d,o=gn(i,100,100,s?4:3),l=Ze(o,[0,0]);return Zp(r,n).map(function(u){var c=u[0],f=u[1],d=u[2],p=[Ze(o,f),Ze(o,d)],v=Xp(p),h=Xu(l,p),m=h.vertical,b=h.horizontal,y=No(l,p)<=0;return{multiple:c,centerSign:y,verticalSign:m,horizontalSign:b,lineConstants:v,line:[Ze(t,f),Ze(t,d)]}})}function Wl(e,t,r,n){var a=n?e.map(function(i){return Ha(i,n)}):e;return[[a[0],a[1]],[a[1],a[3]],[a[3],a[2]],[a[2],a[0]]].some(function(i){var s=No(r,i)<=0;return!Yu(t,i,s)})}function Qp(e){var t=e[0],r=e[1],n=r[0]-t[0],a=r[1]-t[1];if(!n)return Math.abs(t[0]);if(!a)return Math.abs(t[1]);var i=a/n;return Math.abs((-i*t[0]+t[1])/Math.sqrt(Math.pow(i,2)+1))}function Jp(e){var t=e[0],r=e[1],n=r[0]-t[0],a=r[1]-t[1];if(!n)return[t[0],0];if(!a)return[0,t[1]];var i=a/n,s=-i*t[0]+t[1];return[-s/(i+1/i),s/(i*i+1)]}function tg(e,t,r,n,a){var i=e.props.innerBounds,s=a*Math.PI/180;if(!i)return[];var o=i.left,l=i.top,u=i.width,c=i.height,f=o-n[0],d=o+u-n[0],p=l-n[1],v=l+c-n[1],h=[[f,p],[d,p],[f,v],[d,v]],m=Ze(r,[0,0]);if(!Wl(r,h,m,0))return[];var b=[],y=h.map(function(S){return[Nr(S),Qe([0,0],S)]});return[[r[0],r[1]],[r[1],r[3]],[r[3],r[2]],[r[2],r[0]]].forEach(function(S){var C=Qe([0,0],Jp(S)),R=Qp(S);b.push.apply(b,y.filter(function(D){var I=D[0];return I&&R<=I}).map(function(D){var I=D[0],W=D[1],G=Math.acos(I?R/I:0),F=W+G,X=W-G;return[s+F-C,s+X-C]}).reduce(function(D,I){return D.push.apply(D,I),D},[]).filter(function(D){return!Wl(t,h,m,D)}).map(function(D){return we(D*180/Math.PI,xr)}))}),b}function eg(e){var t=e.props.innerBounds;if(!t)return{vertical:[],horizontal:[]};var r=e.getRect(),n=r.pos1,a=r.pos2,i=r.pos3,s=r.pos4,o=[n,a,i,s],l=Ze(o,[0,0]),u=t.left,c=t.top,f=t.width,d=t.height,p=[[u,c],[u,c+d]],v=[[u,c],[u+f,c]],h=[[u+f,c],[u+f,c+d]],m=[[u,c+d],[u+f,c+d]],b=Vo(e,o,[0,0],!1),y=[],S=[],C={top:!1,bottom:!1,left:!1,right:!1};return b.forEach(function(R){var D=R.line,I=R.lineConstants,W=Xu(l,D),G=W.horizontal,F=W.vertical,X=fn(D,I,v,F,1,!0),M=fn(D,I,m,F,1,!0),st=fn(D,I,p,G,1,!0),J=fn(D,I,h,G,1,!0);X.isBound&&!C.top&&(y.push(c),C.top=!0),M.isBound&&!C.bottom&&(y.push(c+d),C.bottom=!0),st.isBound&&!C.left&&(S.push(u),C.left=!0),J.isBound&&!C.right&&(S.push(u+f),C.right=!0)}),{horizontal:y,vertical:S}}function $o(e,t,r){var n=e||{},a=n.position,i=a===void 0?"client":a,s=n.left,o=s===void 0?-1/0:s,l=n.top,u=l===void 0?-1/0:l,c=n.right,f=c===void 0?1/0:c,d=n.bottom,p=d===void 0?1/0:d,v={position:i,left:o,top:u,right:f,bottom:p};return{vertical:Xl(v,t,!0),horizontal:Xl(v,r,!1)}}function Ui(e,t){var r=e.state,n=r.containerClientRect,a=n.clientHeight,i=n.clientWidth,s=n.clientLeft,o=n.clientTop,l=r.snapOffset,u=l.left,c=l.top,f=l.right,d=l.bottom,p=t||e.props.bounds||{},v=p.position||"client",h=v==="css",m=p.left,b=m===void 0?-1/0:m,y=p.top,S=y===void 0?-1/0:y,C=p.right,R=C===void 0?h?-1/0:1/0:C,D=p.bottom,I=D===void 0?h?-1/0:1/0:D;return h&&(R=i+f-u-R,I=a+d-c-I),{left:b+u-s,right:R+u-s,top:S+c-o,bottom:I+c-o}}function rg(e,t,r){var n=Ui(e),a=n.left,i=n.top,s=n.right,o=n.bottom,l=r[0],u=r[1],c=fe(r,t),f=c[0],d=c[1];Math.abs(f)<xr&&(f=0),Math.abs(d)<xr&&(d=0);var p=d>0,v=f>0,h={isBound:!1,offset:0,pos:0},m={isBound:!1,offset:0,pos:0};if(f===0&&d===0)return{vertical:h,horizontal:m};if(f===0)p?o<u&&(m.pos=o,m.offset=u-o):i>u&&(m.pos=i,m.offset=u-i);else if(d===0)v?s<l&&(h.pos=s,h.offset=l-s):a>l&&(h.pos=a,h.offset=l-a);else{var b=d/f,y=r[1]-b*l,S=0,C=0,R=!1;v&&s<=l?(S=b*s+y,C=s,R=!0):!v&&l<=a&&(S=b*a+y,C=a,R=!0),R&&(S<i||S>o)&&(R=!1),R||(p&&o<=u?(S=o,C=(S-y)/b,R=!0):!p&&u<=i&&(S=i,C=(S-y)/b,R=!0)),R&&(h.isBound=!0,h.pos=C,h.offset=l-C,m.isBound=!0,m.pos=S,m.offset=u-S)}return{vertical:h,horizontal:m}}function Xl(e,t,r){var n=e[r?"left":"top"],a=e[r?"right":"bottom"],i=Math.min.apply(Math,t),s=Math.max.apply(Math,t),o=[];return n+1>i&&o.push({isBound:!0,offset:i-n,pos:n}),a-1<s&&o.push({isBound:!0,offset:s-a,pos:a}),o.length||o.push({isBound:!1,offset:0,pos:0}),o.sort(function(l,u){return Math.abs(u.offset)-Math.abs(l.offset)})}function Yl(e,t,r){var n=r?e.map(function(a){return Ha(a,r)}):e;return n.some(function(a){return a[0]<t.left&&Math.abs(a[0]-t.left)>.1||a[0]>t.right&&Math.abs(a[0]-t.right)>.1||a[1]<t.top&&Math.abs(a[1]-t.top)>.1||a[1]>t.bottom&&Math.abs(a[1]-t.bottom)>.1})}function ng(e,t,r){var n=Nr(e),a=Math.sqrt(n*n-t*t)||0;return[a,-a].sort(function(i,s){return Math.abs(i-e[r?0:1])-Math.abs(s-e[r?0:1])}).map(function(i){return Qe([0,0],r?[i,t]:[t,i])})}function ag(e,t,r,n,a){if(!e.props.bounds)return[];var i=a*Math.PI/180,s=Ui(e),o=s.left,l=s.top,u=s.right,c=s.bottom,f=o-n[0],d=u-n[0],p=l-n[1],v=c-n[1],h={left:f,top:p,right:d,bottom:v};if(!Yl(r,h,0))return[];var m=[];return[[f,0],[d,0],[p,1],[v,1]].forEach(function(b){var y=b[0],S=b[1];r.forEach(function(C){var R=Qe([0,0],C);m.push.apply(m,ng(C,y,S).map(function(D){return i+D-R}).filter(function(D){return!Yl(t,h,D)}).map(function(D){return we(D*180/Math.PI,xr)}))})}),m}function ig(e,t){var r,n=e.direction,a=e.classNames,i=e.size,s=e.pos,o=e.zoom,l=e.key,u=n==="horizontal",c=u?"Y":"X";return t.createElement("div",{key:l,className:a.join(" "),style:(r={},r[u?"width":"height"]="".concat(i),r.transform="translate(".concat(s[0],", ").concat(s[1],") translate").concat(c,"(-50%) scale").concat(c,"(").concat(o,")"),r)})}function Ho(e,t){return ig(it(it({},e),{classNames:ge([pe("line","guideline",e.direction)],e.classNames,!0).filter(function(r){return r}),size:e.size||"".concat(e.sizeValue,"px"),pos:e.pos||e.posValue.map(function(r){return"".concat(we(r,.1),"px")})}),t)}function Ul(e,t,r,n,a,i,s,o){var l=e.props.zoom;return r.map(function(u,c){var f=u.type,d=u.pos,p=[0,0];return p[s]=n,p[s?0:1]=-a+d,Ho({key:"".concat(t,"TargetGuideline").concat(c),classNames:[pe("target","bold",f)],posValue:p,sizeValue:i,zoom:l,direction:t},o)})}function jl(e,t,r,n,a,i){var s=e.props,o=s.zoom,l=s.isDisplayInnerSnapDigit,u=t==="horizontal"?mn:_n,c=a[u.start],f=a[u.end];return r.filter(function(d){var p=d.hide,v=d.elementRect;if(p)return!1;if(l&&v){var h=v.rect;if(h[u.start]<=c&&f<=h[u.end])return!1}return!0}).map(function(d,p){var v=d.pos,h=d.size,m=d.element,b=d.className,y=[-n[0]+v[0],-n[1]+v[1]];return Ho({key:"".concat(t,"-default-guideline-").concat(p),classNames:m?[pe("bold"),b]:[pe("normal"),b],direction:t,posValue:y,sizeValue:h,zoom:o},i)})}function ga(e,t,r,n,a,i,s,o){var l,u=e.props,c=u.snapDigit,f=c===void 0?0:c,d=u.isDisplaySnapDigit,p=d===void 0?!0:d,v=u.snapDistFormat,h=v===void 0?function(R,D){return R}:v,m=u.zoom,b=t==="horizontal"?"X":"Y",y=t==="vertical"?"height":"width",S=Math.abs(a),C=p?parseFloat(S.toFixed(f)):0;return o.createElement("div",{key:"".concat(t,"-").concat(r,"-guideline-").concat(n),className:pe("guideline-group",t),style:(l={left:"".concat(i[0],"px"),top:"".concat(i[1],"px")},l[y]="".concat(S,"px"),l)},Ho({direction:t,classNames:[pe(r),s],size:"100%",posValue:[0,0],sizeValue:S,zoom:m},o),o.createElement("div",{className:pe("size-value","gap"),style:{transform:"translate".concat(b,"(-50%) scale(").concat(m,")")}},C>0?h(C,t):""))}function sg(e,t,r,n){var a=e==="vertical"?0:1,i=e==="vertical"?1:0,s=a?mn:_n,o=r[s.start],l=r[s.end];return zu(t,function(u){return u.pos[a]}).map(function(u){var c=[],f=[],d=[];return u.forEach(function(p){var v,h,m=p.element,b=p.elementRect.rect;if(b[s.end]<o)c.push(p);else if(l<b[s.start])f.push(p);else if(b[s.start]<=o&&l<=b[s.end]&&n){var y=p.pos,S={element:m,rect:it(it({},b),(v={},v[s.end]=b[s.start],v))},C={element:m,rect:it(it({},b),(h={},h[s.start]=b[s.end],h))},R=[0,0],D=[0,0];R[a]=y[a],R[i]=y[i],D[a]=y[a],D[i]=y[i]+p.size,c.push({type:e,pos:R,size:0,elementRect:S}),f.push({type:e,pos:D,size:0,elementRect:C})}}),c.sort(function(p,v){return v.pos[i]-p.pos[i]}),f.sort(function(p,v){return p.pos[i]-v.pos[i]}),{total:u,start:c,end:f,inner:d}})}function og(e,t,r,n,a){var i=e.props.isDisplayInnerSnapDigit,s=[];return["vertical","horizontal"].forEach(function(o){var l=t.filter(function(m){return m.type===o}),u=o==="vertical"?1:0,c=u?0:1,f=sg(o,l,n,i),d=u?_n:mn,p=u?mn:_n,v=n[d.start],h=n[d.end];f.forEach(function(m){var b=m.total,y=m.start,S=m.end,C=m.inner,R=r[c]+b[0].pos[c]-n[p.start],D=n;y.forEach(function(I){var W=I.elementRect.rect,G=D[d.start]-W[d.end];if(G>0){var F=[0,0];F[u]=r[u]+D[d.start]-v-G,F[c]=R,s.push(ga(e,o,"dashed",s.length,G,F,I.className,a))}D=W}),D=n,S.forEach(function(I){var W=I.elementRect.rect,G=W[d.start]-D[d.end];if(G>0){var F=[0,0];F[u]=r[u]+D[d.end]-v,F[c]=R,s.push(ga(e,o,"dashed",s.length,G,F,I.className,a))}D=W}),C.forEach(function(I){var W=I.elementRect.rect,G=v-W[d.start],F=W[d.end]-h,X=[0,0],M=[0,0];X[u]=r[u]-G,X[c]=R,M[u]=r[u]+h-v,M[c]=R,s.push(ga(e,o,"dashed",s.length,G,X,I.className,a)),s.push(ga(e,o,"dashed",s.length,F,M,I.className,a))})})}),s}function lg(e,t,r,n,a){var i=[];return["horizontal","vertical"].forEach(function(s){var o=t.filter(function(m){return m.type===s}).slice(0,1),l=s==="vertical"?0:1,u=l?0:1,c=l?_n:mn,f=l?mn:_n,d=n[c.start],p=n[c.end],v=n[f.start],h=n[f.end];o.forEach(function(m){var b=m.gap,y=m.gapRects,S=Math.max.apply(Math,ge([v],y.map(function(D){var I=D.rect;return I[f.start]}),!1)),C=Math.min.apply(Math,ge([h],y.map(function(D){var I=D.rect;return I[f.end]}),!1)),R=(S+C)/2;S===C||R===(v+h)/2||y.forEach(function(D){var I=D.rect,W=D.className,G=[r[0],r[1]];if(I[c.end]<d)G[l]+=I[c.end]-d;else if(p<I[c.start])G[l]+=I[c.start]-d-b;else return;G[u]+=R-v,i.push(ga(e,l?"vertical":"horizontal","gap",i.length,b,G,W,a))})})}),i}function ug(e,t,r,n){var a=t[0]-e[0],i=t[1]-e[1];if(Math.abs(a)<er&&(a=0),Math.abs(i)<er&&(i=0),!a)return n?[0,0]:[0,r];if(!i)return n?[r,0]:[0,0];var s=i/a,o=e[1]-s*e[0];if(n){var l=s*(t[0]+r)+o;return[r,l-t[1]]}else{var u=(t[1]+r-o)/s;return[u-t[0],r]}}function Zs(e,t,r,n,a){var i=ug(e,t,r,n);if(!i)return{isOutside:!1,offset:[0,0]};var s=Fr(e,t),o=Fr(i,e),l=Fr(i,t),u=o>s||l>s,c=Kr({datas:a,distX:i[0],distY:i[1]}),f=c[0],d=c[1];return{offset:[f,d],isOutside:u}}function Ei(e,t){return e.isBound?e.offset:t.isSnap?Ks(t).offset:0}function cg(e,t,r,n,a){var i=t[0],s=t[1],o=r[0],l=r[1],u=n[0],c=n[1],f=a[0],d=a[1],p=-f,v=-d;if(e&&i&&s){p=0,v=0;var h=[];if(o&&l?h.push([0,d],[f,0]):o?h.push([f,0]):l?h.push([0,d]):u&&c?h.push([0,d],[f,0]):u?h.push([f,0]):c&&h.push([0,d]),h.length){h.sort(function(S,C){return Nr(fe([i,s],S))-Nr(fe([i,s],C))});var m=h[0];if(m[0]&&Math.abs(i)>er)p=-m[0],v=s*Math.abs(i+p)/Math.abs(i)-s;else if(m[1]&&Math.abs(s)>er){var b=s;v=-m[1],p=i*Math.abs(s+v)/Math.abs(b)-i}if(e&&l&&o)if(Math.abs(p)>er&&Math.abs(p)<Math.abs(f)){var y=Math.abs(f)/Math.abs(p);p*=y,v*=y}else if(Math.abs(v)>er&&Math.abs(v)<Math.abs(d)){var y=Math.abs(d)/Math.abs(v);p*=y,v*=y}else p=Zn(-f,p),v=Zn(-d,v)}}else p=i||o?-f:0,v=s||l?-d:0;return[p,v]}function fg(e,t,r,n,a,i){if(!sa(e,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var s=Io(i.absolutePoses,[t,r]),o=Or(s),l=o.left,u=o.right,c=o.top,f=o.bottom,d={horizontal:s.map(function(J){return J[1]}),vertical:s.map(function(J){return J[0]})},p=Fo(e.props.snapDirections),v=zo(p,{left:l,right:u,top:c,bottom:f,center:(l+u)/2,middle:(c+f)/2}),h=ji(e,a,v,d),m=h.vertical,b=h.horizontal,y=Kp(e,s,i),S=y.vertical,C=y.horizontal,R=m.isSnap,D=b.isSnap,I=m.isBound||S.isBound,W=b.isBound||C.isBound,G=Zn(m.offset,S.offset),F=Zn(b.offset,C.offset),X=cg(n,[t,r],[I,W],[R,D],[G,F]),M=X[0],st=X[1];return[{isBound:I,isSnap:R,offset:M},{isBound:W,isSnap:D,offset:st}]}function ji(e,t,r,n){n===void 0&&(n=r);var a=$o(Ui(e),n.vertical,n.horizontal),i=a.horizontal,s=a.vertical,o=t?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Yi(e,r.vertical,r.horizontal),l=o.horizontal,u=o.vertical,c=Ei(i[0],l),f=Ei(s[0],u),d=Math.abs(c),p=Math.abs(f);return{horizontal:{isBound:i[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:c,dist:d,bounds:i,snap:l},vertical:{isBound:s[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:f,dist:p,bounds:s,snap:u}}}function ql(e,t,r,n,a){var i=$o(t,r,n),s=i.horizontal,o=i.vertical,l=Gu(e,r,n,a),u=l.horizontal,c=l.vertical,f=Ei(s[0],u),d=Ei(o[0],c),p=Math.abs(f),v=Math.abs(d);return{horizontal:{isBound:s[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:f,dist:p,bounds:s,snap:u},vertical:{isBound:o[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:d,dist:v,bounds:o,snap:c}}}function dg(e,t,r,n){var a=Qe(e,t)/Math.PI*180,i=r.vertical,s=i.isBound,o=i.isSnap,l=i.dist,u=r.horizontal,c=u.isBound,f=u.isSnap,d=u.dist,p=a%180,v=p<3||p>177,h=p>87&&p<93;return d<l&&(s||o&&!h&&(!n||!v))?"vertical":c||f&&!v&&(!n||!h)?"horizontal":""}function vg(e,t,r,n,a,i){return r.map(function(s){var o=s[0],l=s[1],u=Ze(t,o),c=Ze(t,l),f=n?hg(e,u,c,a):ji(e,a,{vertical:[c[0]],horizontal:[c[1]]}),d=f.horizontal,p=d.offset,v=d.isBound,h=d.isSnap,m=f.vertical,b=m.offset,y=m.isBound,S=m.isSnap,C=fe(l,o);if(!b&&!p)return{isBound:y||v,isSnap:S||h,sign:C,offset:[0,0]};var R=dg(u,c,f,n);if(!R)return{sign:C,isBound:!1,isSnap:!1,offset:[0,0]};var D=R==="vertical",I=[0,0];return!n&&Math.abs(l[0])===1&&Math.abs(l[1])===1&&o[0]!==l[0]&&o[1]!==l[1]?I=Kr({datas:i,distX:-b,distY:-p}):I=Zs(u,c,-(D?b:p),D,i).offset,I=I.map(function(W,G){return W*(C[G]?2/C[G]:0)}),{sign:C,isBound:D?y:v,isSnap:D?S:h,offset:I}})}function Kl(e,t){return e.isBound?e.offset:t.isSnap?t.offset:0}function hg(e,t,r,n){var a=rg(e,t,r),i=a.horizontal,s=a.vertical,o=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:Yp(e,t,r),l=o.horizontal,u=o.vertical,c=Kl(i,l),f=Kl(s,u),d=Math.abs(c),p=Math.abs(f);return{horizontal:{isBound:i.isBound,isSnap:l.isSnap,offset:c,dist:d},vertical:{isBound:s.isBound,isSnap:u.isSnap,offset:f,dist:p}}}function pg(e,t,r,n,a){var i=[-r[0],-r[1]],s=e.state,o=s.width,l=s.height,u=e.props.bounds,c=1/0,f=1/0;if(u){var d=[[r[0],-r[1]],[-r[0],r[1]]],p=u.left,v=p===void 0?-1/0:p,h=u.top,m=h===void 0?-1/0:h,b=u.right,y=b===void 0?1/0:b,S=u.bottom,C=S===void 0?1/0:S;d.forEach(function(R){var D=R[0]!==i[0],I=R[1]!==i[1],W=Ze(t,R),G=Qe(n,W)*360/Math.PI;if(I){var F=W.slice();(Math.abs(G-360)<2||Math.abs(G-180)<2)&&(F[1]=n[1]);var X=Zs(n,F,(n[1]<W[1]?C:m)-W[1],!1,a),M=X.offset,st=M[1],J=X.isOutside;isNaN(st)||(f=l+(J?1:-1)*Math.abs(st))}if(D){var F=W.slice();(Math.abs(G-90)<2||Math.abs(G-270)<2)&&(F[0]=n[0]);var pt=Zs(n,F,(n[0]<W[0]?y:v)-W[0],!0,a),zt=pt.offset[0],Xt=pt.isOutside;isNaN(zt)||(c=o+(Xt?1:-1)*Math.abs(zt))}})}return{maxWidth:c,maxHeight:f}}function Qs(e){var t=e.state,r=t.containerClientRect,n=t.hasFixed,a=r.overflow,i=r.scrollHeight,s=r.scrollWidth,o=r.clientHeight,l=r.clientWidth,u=r.clientLeft,c=r.clientTop,f=e.props,d=f.snapGap,p=d===void 0?!0:d,v=f.verticalGuidelines,h=f.horizontalGuidelines,m=f.snapThreshold,b=m===void 0?5:m,y=f.snapGridWidth,S=y===void 0?0:y,C=f.snapGridHeight,R=C===void 0?0:C,D=f.maxSnapElementGuidelineDistance,I=D===void 0?1/0:D,W=Or(Cr(e.state)),G=W.top,F=W.left,X=W.bottom,M=W.right,st={top:G,left:F,bottom:X,right:M,center:(F+M)/2,middle:(G+X)/2},J=_g(e),pt=ge([],J,!0);p&&pt.push.apply(pt,gg(e,st,b)),pt.push.apply(pt,mg(S,R,a?s:l,a?i:o,u,c));var zt=it({},t.snapOffset||{left:0,top:0,bottom:0,right:0});if(n){var Xt=r.left,Ht=r.top;zt.left+=Xt,zt.top+=Ht,zt.right+=Xt,zt.bottom+=Ht}return pt.push.apply(pt,qu(h||!1,v||!1,a?s:l,a?i:o,u,c,zt)),pt=pt.filter(function(Nt){var yt=Nt.element,It=Nt.elementRect,Rt=Nt.type;if(!yt||!It)return!0;var Mt=It.rect;return ju(st,Mt,Rt,I)}),pt}function gg(e,t,r){var n=e.props,a=n.maxSnapElementGuidelineDistance,i=a===void 0?1/0:a,s=n.maxSnapElementGapDistance,o=s===void 0?1/0:s,l=e.state.elementRects,u=[];return[["vertical",mn,_n],["horizontal",_n,mn]].forEach(function(c){var f=c[0],d=c[1],p=c[2],v=t[d.start],h=t[d.end],m=t[d.center],b=t[p.start],y=t[p.end];function S(D){var I=D.rect;return I[d.end]<v+r?v-I[d.end]:h-r<I[d.start]?I[d.start]-h:-1}var C=l.filter(function(D){var I=D.rect;return I[p.start]>y||I[p.end]<b?!1:S(D)>0}).sort(function(D,I){return S(D)-S(I)}),R=[];C.forEach(function(D){C.forEach(function(I){if(D!==I){var W=D.rect,G=I.rect,F=W[p.start],X=W[p.end],M=G[p.start],st=G[p.end];F>st||M>X||R.push([D,I])}})}),R.forEach(function(D){var I=D[0],W=D[1],G=I.rect,F=W.rect,X=G[d.start],M=G[d.end],st=F[d.start],J=F[d.end],pt=0,zt=0,Xt=!1,Ht=!1,Nt=!1;if(M<=v&&h<=st){if(Ht=!0,pt=(st-M-(h-v))/2,zt=M+pt+(h-v)/2,Math.abs(zt-m)>r)return}else if(M<st&&J<v+r){if(Xt=!0,pt=st-M,zt=J+pt,Math.abs(zt-v)>r)return}else if(M<st&&h-r<X){if(Nt=!0,pt=st-M,zt=X-pt,Math.abs(zt-h)>r)return}else return;pt&&ju(t,F,f,i)&&(pt>o||u.push({type:f,pos:f==="vertical"?[zt,0]:[0,zt],element:W.element,size:0,className:W.className,isStart:Xt,isCenter:Ht,isEnd:Nt,gap:pt,hide:!0,gapRects:[I,W]}))})}),u}function mg(e,t,r,n,a,i){a===void 0&&(a=0),i===void 0&&(i=0);var s=[];if(t)for(var o=0;o<=n;o+=t)s.push({type:"horizontal",pos:[0,we(o-i,.1)],size:r,hide:!0});if(e)for(var o=0;o<=r;o+=e)s.push({type:"vertical",pos:[we(o-a,.1),0],size:n,hide:!0});return s}function ju(e,t,r,n){return r==="horizontal"?Math.abs(e.right-t.left)<=n||Math.abs(e.left-t.right)<=n||e.left<=t.right&&t.left<=e.right:r==="vertical"?Math.abs(e.bottom-t.top)<=n||Math.abs(e.top-t.bottom)<=n||e.top<=t.bottom&&t.top<=e.bottom:!0}function _g(e){var t=e.state,r=e.props.elementGuidelines,n=r===void 0?[]:r;if(!n.length)return t.elementRects=[],[];var a=(t.elementRects||[]).filter(function(d){return!d.refresh}),i=n.map(function(d){return $r(d)&&"element"in d?it(it({},d),{element:Pn(d.element,!0)}):{element:Pn(d,!0)}}).filter(function(d){return d.element}),s=Mh(a.map(function(d){return d.element}),i.map(function(d){return d.element})),o=s.maintained,l=s.added,u=[];o.forEach(function(d){var p=d[0],v=d[1];u[v]=a[p]}),bg(e,l.map(function(d){return i[d]})).map(function(d,p){u[l[p]]=d}),t.elementRects=u;var c=Fo(e.props.elementSnapDirections),f=[];return u.forEach(function(d){var p=d.element,v=d.top,h=v===void 0?c.top:v,m=d.left,b=m===void 0?c.left:m,y=d.right,S=y===void 0?c.right:y,C=d.bottom,R=C===void 0?c.bottom:C,D=d.center,I=D===void 0?c.center:D,W=d.middle,G=W===void 0?c.middle:W,F=d.className,X=d.rect,M=zo({top:h,right:S,left:b,bottom:R,center:I,middle:G},X),st=M.horizontal,J=M.vertical,pt=X.top,zt=X.left,Xt=X.right-zt,Ht=X.bottom-pt,Nt=[Xt,Ht];J.forEach(function(yt){f.push({type:"vertical",element:p,pos:[we(yt,.1),pt],size:Ht,sizes:Nt,className:F,elementRect:d})}),st.forEach(function(yt){f.push({type:"horizontal",element:p,pos:[zt,we(yt,.1)],size:Xt,sizes:Nt,className:F,elementRect:d})})}),f}function qu(e,t,r,n,a,i,s){a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s={left:0,top:0,right:0,bottom:0});var o=[],l=s.left,u=s.top,c=s.bottom,f=s.right,d=r+f-l,p=n+c-u;return e&&e.forEach(function(v){var h=$r(v)?v:{pos:v};o.push({type:"horizontal",pos:[l,we(h.pos-i+u,.1)],size:d,className:h.className})}),t&&t.forEach(function(v){var h=$r(v)?v:{pos:v};o.push({type:"vertical",pos:[we(h.pos-a+l,.1),u],size:p,className:h.className})}),o}function bg(e,t){if(!t.length)return[];var r=e.state,n=r.containerClientRect,a=r.targetClientRect,i=a.top,s=a.left,o=r.rootMatrix,l=r.is3d,u=l?4:3,c=Wp(o,n,u),f=c[0],d=c[1],p=Cr(r),v=pn(p),h=v.minX,m=v.minY,b=fe([h,m],Bn(o,[s-f,i-d],u)).map(function(C){return Rp(C)}),y=b[0],S=b[1];return t.map(function(C){var R=C.element.getBoundingClientRect(),D=R.left-f,I=R.top-d,W=I+R.height,G=D+R.width,F=Bn(o,[D,I],u),X=F[0],M=F[1],st=Bn(o,[G,W],u),J=st[0],pt=st[1];return it(it({},C),{rect:{left:X+y,right:J+y,top:M+S,bottom:pt+S,center:(X+J)/2+y,middle:(M+pt)/2+S}})})}function li(e){var t=e.state,r=t.container,n=e.props.snapContainer||r;if(t.snapContainer===n&&t.guidelines&&t.guidelines.length)return!1;var a=t.containerClientRect,i={left:0,top:0,bottom:0,right:0};if(r!==n){var s=Pn(n,!0);if(s){var o=pa(s),l=Vl(t,[o.left-a.left,o.top-a.top]),u=Vl(t,[o.right-a.right,o.bottom-a.bottom]);i.left=we(l[0],1e-5),i.top=we(l[1],1e-5),i.right=we(u[0],1e-5),i.bottom=we(u[1],1e-5)}}return t.snapContainer=n,t.snapOffset=i,t.guidelines=Qs(e),t.enableSnap=!0,!0}function Ku(e,t,r,n,a,i){var s=gn(e,t,r,i?4:3),o=Ze(s,n);return Io(s,fe(a,o))}function xg(e,t,r,n,a,i){var s=i.fixedDirection,o=jp(r,s,n),l=Vo(e,t,r,n),u=ge(ge([],vg(e,t,o,n,a,i),!0),Uu(e,l,i),!0),c=Ci(u,0),f=Ci(u,1);return{width:{isBound:c.isBound,offset:c.offset[0]},height:{isBound:f.isBound,offset:f.offset[1]}}}function yg(e,t,r,n,a,i,s,o,l){var u=Ze(t,s),c=ji(e,o,{vertical:[u[0]],horizontal:[u[1]]}),f=c.horizontal.offset,d=c.vertical.offset;if(we(d,Ws)||we(f,Ws)){var p=Kr({datas:l,distX:-d,distY:-f}),v=p[0],h=p[1],m=Math.min(a||1/0,r+s[0]*v),b=Math.min(i||1/0,n+s[1]*h);return[m-r,b-n]}return[0,0]}function Zu(e,t,r,n,a,i,s,o){for(var l=Cr(e.state),u=e.props.keepRatio,c=0,f=0,d=0;d<2;++d){var p=t(c,f),v=xg(e,p,a,u,s,o),h=v.width,m=v.height,b=h.isBound,y=m.isBound,S=h.offset,C=m.offset;if(d===1&&(b||(S=0),y||(C=0)),d===0&&s&&!b&&!y)return[0,0];if(u){var R=Math.abs(S)*(r?1/r:1),D=Math.abs(C)*(n?1/n:1),I=b&&y?R<D:y||!b&&R<D;I?S=r*C/n:C=n*S/r}c+=S,f+=C}if(a[0]&&a[1]){var W=pg(e,l,a,i,o),G=W.maxWidth,F=W.maxHeight,X=yg(e,t(c,f).map(function(J){return J.map(function(pt){return we(pt,Ws)})}),r+c,n+f,G,F,a,s,o),S=X[0],C=X[1];c+=S,f+=C}return[c,f]}function Sg(e,t,r){if(!sa(e,"rotatable"))return{isSnap:!1,rotation:r};var n=t.pos1,a=t.pos2,i=t.pos3,s=t.pos4,o=t.origin,l=r*Math.PI/180,u=[n,a,i,s].map(function(p){return fe(p,o)}),c=u.map(function(p){return Ha(p,l)}),f=ge(ge([],ag(e,u,c,o,r),!0),tg(e,u,c,o,r),!0);f.sort(function(p,v){return Math.abs(p-r)-Math.abs(v-r)});var d=f.length>0;return{isSnap:d,rotation:d?f[0]:r}}function wg(e,t,r,n,a,i,s){if(!sa(e,"resizable"))return[0,0];var o=s.fixedDirection,l=s.nextAllMatrix,u=e.state,c=u.allMatrix,f=u.is3d;return Zu(e,function(d,p){return Ku(l||c,t+d,r+p,o,a,f)},t,r,n,a,i,s)}function Cg(e,t,r,n,a){if(!sa(e,"scalable"))return[0,0];var i=a.startOffsetWidth,s=a.startOffsetHeight,o=a.fixedPosition,l=a.fixedDirection,u=a.is3d,c=Zu(e,function(f,d){return Ku(pp(a,De(t,[f/i,d/s])),i,s,l,o,u)},i,s,r,o,n,a);return[c[0]/i,c[1]/s]}function Eg(e,t){t.absolutePoses=Cr(e.state)}function Zl(e){var t=[];return e.forEach(function(r){r.guidelineInfos.forEach(function(n){var a=n.guideline;t.indexOf(a)>-1||t.push(a)})}),t}function Ql(e,t,r,n,a,i){var s=$o(Ui(e,i),t,r),o=s.vertical,l=s.horizontal;o.forEach(function(d){d.isBound&&n.push({type:"bounds",pos:d.pos})}),l.forEach(function(d){d.isBound&&a.push({type:"bounds",pos:d.pos})});var u=eg(e),c=u.vertical,f=u.horizontal;c.forEach(function(d){tn(n,function(p){var v=p.type,h=p.pos;return v==="bounds"&&h===d})>=0||n.push({type:"bounds",pos:d})}),f.forEach(function(d){tn(a,function(p){var v=p.type,h=p.pos;return v==="bounds"&&h===d})>=0||a.push({type:"bounds",pos:d})})}var Mg=Po("",["resizable","scalable"]),kg={name:"snappable",dragRelation:"strong",props:{snappable:[Boolean,Array],snapContainer:Object,snapDirections:[Boolean,Object],elementSnapDirections:[Boolean,Object],snapGap:Boolean,snapGridWidth:Number,snapGridHeight:Number,isDisplaySnapDigit:Boolean,isDisplayInnerSnapDigit:Boolean,snapDigit:Number,snapThreshold:Number,snapRenderThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object,snapDistFormat:Function,maxSnapElementGuidelineDistance:Number,maxSnapElementGapDistance:Number},events:{onSnap:"snap"},css:[`:host {
    --bounds-color: #d66;
}
.guideline {
    pointer-events: none;
    z-index: 2;
}
.guideline.bounds {
    background: #d66;
    background: var(--bounds-color);
}
.guideline-group {
    position: absolute;
    top: 0;
    left: 0;
}
.guideline-group .size-value {
    position: absolute;
    color: #f55;
    font-size: 12px;
    font-weight: bold;
}
.guideline-group.horizontal .size-value {
    transform-origin: 50% 100%;
    transform: translateX(-50%);
    left: 50%;
    bottom: 5px;
}
.guideline-group.vertical .size-value {
    transform-origin: 0% 50%;
    top: 50%;
    transform: translateY(-50%);
    left: 5px;
}
.guideline.gap {
    background: #f55;
}
.size-value.gap {
    color: #f55;
}
`],render:function(e,t){var r=e.state,n=r.top,a=r.left,i=r.pos1,s=r.pos2,o=r.pos3,l=r.pos4,u=r.snapRenderInfo,c=e.props.snapRenderThreshold,f=c===void 0?1:c;if(!u||!u.render||!sa(e,""))return[];r.guidelines=Qs(e);var d=Math.min(i[0],s[0],o[0],l[0]),p=Math.min(i[1],s[1],o[1],l[1]),v=u.externalPoses||[],h=Cr(e.state),m=[],b=[],y=[],S=[],C=[],R=Or(h),D=R.width,I=R.height,W=R.top,G=R.left,F=R.bottom,X=R.right,M={left:G,right:X,top:W,bottom:F,center:(G+X)/2,middle:(W+F)/2},st=v.length>0,J=st?Or(v):{};if(!u.request){if(u.direction&&C.push(Up(e,h,u.direction,f)),u.snap){var pt=Or(h);u.center&&(pt.middle=(pt.top+pt.bottom)/2,pt.center=(pt.left+pt.right)/2),C.push($l(e,pt,f))}st&&(u.center&&(J.middle=(J.top+J.bottom)/2,J.center=(J.left+J.right)/2),C.push($l(e,J,f))),C.forEach(function(Nt){var yt=Nt.vertical.posInfos,It=Nt.horizontal.posInfos;m.push.apply(m,yt.filter(function(Rt){var Mt=Rt.guidelineInfos;return Mt.some(function(lt){var Bt=lt.guideline;return!Bt.hide})}).map(function(Rt){return{type:"snap",pos:Rt.pos}})),b.push.apply(b,It.filter(function(Rt){var Mt=Rt.guidelineInfos;return Mt.some(function(lt){var Bt=lt.guideline;return!Bt.hide})}).map(function(Rt){return{type:"snap",pos:Rt.pos}})),y.push.apply(y,Zl(yt)),S.push.apply(S,Zl(It))})}Ql(e,[G,X],[W,F],m,b),st&&Ql(e,[J.left,J.right],[J.top,J.bottom],m,b,u.externalBounds);var zt=ge(ge([],y,!0),S,!0),Xt=zt.filter(function(Nt){return Nt.element&&!Nt.gapRects}),Ht=zt.filter(function(Nt){return Nt.gapRects}).sort(function(Nt,yt){return Nt.gap-yt.gap});return le(e,"onSnap",{guidelines:zt.filter(function(Nt){var yt=Nt.element;return!yt}),elements:Xt,gaps:Ht},!0),ge(ge(ge(ge(ge(ge([],og(e,Xt,[d,p],M,t),!0),lg(e,Ht,[d,p],M,t),!0),jl(e,"horizontal",S,[a,n],M,t),!0),jl(e,"vertical",y,[a,n],M,t),!0),Ul(e,"horizontal",b,d,n,D,0,t),!0),Ul(e,"vertical",m,p,a,I,1,t),!0)},dragStart:function(e,t){e.state.snapRenderInfo={request:t.isRequest,snap:!0,center:!0},li(e)},drag:function(e){var t=e.state;li(e)||(t.guidelines=Qs(e)),t.snapRenderInfo&&(t.snapRenderInfo.render=!0)},pinchStart:function(e){this.unset(e)},dragEnd:function(e){this.unset(e)},dragControlCondition:function(e,t){if(Mg(e,t)||to(e,t))return!0;if(!t.isRequest&&t.inputEvent)return or(t.inputEvent.target,pe("snap-control"))},dragControlStart:function(e){e.state.snapRenderInfo=null,li(e)},dragControl:function(e){this.drag(e)},dragControlEnd:function(e){this.unset(e)},dragGroupStart:function(e,t){this.dragStart(e,t)},dragGroup:function(e){this.drag(e)},dragGroupEnd:function(e){this.unset(e)},dragGroupControlStart:function(e){e.state.snapRenderInfo=null,li(e)},dragGroupControl:function(e){this.drag(e)},dragGroupControlEnd:function(e){this.unset(e)},unset:function(e){var t=e.state;t.enableSnap=!1,t.guidelines=[],t.snapRenderInfo=null,t.elementRects=[]}};function Qu(e,t,r,n){var a=e.getState(),i=a.renderPoses,s=a.rotation,o=a.direction,l=On(e.props,t).zoom,u=o>0?1:-1,c=s/Math.PI*180,f={},d=e.renderState;d.renderDirectionMap||(d.renderDirectionMap={});var p=d.renderDirectionMap;return r.forEach(function(v){var h=v.dir;f[h]=!0}),r.map(function(v){var h=v.data,m=v.classNames,b=v.dir,y=Do[b];if(!y||!f[b])return null;p[b]=!0;var S=(we(c,15)+u*gu[b]+720)%180,C={};return aa(h).forEach(function(R){C["data-".concat(R)]=h[R]}),n.createElement("div",it({className:pe.apply(void 0,ge(["control","direction",b,t],m,!1)),"data-rotation":S,"data-direction":b},C,{key:"direction-".concat(b),style:Bo.apply(void 0,ge([s,l],y.map(function(R){return i[R]}),!1))}))})}function Ju(e,t,r,n){var a=On(e.props,r).renderDirections,i=a===void 0?t:a;if(!i)return[];var s=i===!0?To:i;return Qu(e,r,s.map(function(o){return{data:{},classNames:[],dir:o}}),n)}function Tg(e,t){var r=e.renderState;r.renderDirectionMap||(r.renderDirectionMap={});var n=e.getState(),a=n.renderPoses,i=n.rotation,s=n.direction,o=r.renderDirectionMap,l=e.props.zoom,u=s>0?1:-1,c=i/Math.PI*180;return aa(o).map(function(f){var d=Do[f];if(!d)return null;var p=(we(c,15)+u*gu[f]+720)%180;return t.createElement("div",{className:pe("around-control"),"data-rotation":p,"data-direction":f,key:"direction-around-".concat(f),style:Bo.apply(void 0,ge([i,l],d.map(function(v){return a[v]}),!1))})})}function Da(e,t,r,n,a,i){for(var s=[],o=6;o<arguments.length;o++)s[o-6]=arguments[o];var l=Qe(r,n),u=t?we(l/Math.PI*180,15)%180:-1;return e.createElement("div",{key:"line-".concat(i),className:pe.apply(void 0,ge(["line","direction",t?"edge":"",t],s,!1)),"data-rotation":u,"data-line-key":i,"data-direction":t,style:ha(r,n,a,l)})}function tc(e,t,r,n,a){var i=r===!0?sp:r;return i.map(function(s,o){var l=Do[s],u=l[0],c=l[1];if(c!=null)return Da(e,s,n[u],n[c],a,"".concat(t,"Edge").concat(o),t)}).filter(Boolean)}function ec(e){return function(t,r){var n=On(t.props,e).edge;return n&&(n===!0||n.length)?ge(ge([],tc(r,e,n,t.getState().renderPoses,t.props.zoom),!0),Dg(t,e,r),!0):rc(t,e,r)}}function rc(e,t,r){return Ju(e,To,t,r)}function Dg(e,t,r){return Ju(e,["nw","ne","sw","se"],t,r)}var _r={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number,startDragRotate:Number,edgeDraggable:Boolean},events:{onDragStart:"dragStart",onDrag:"drag",onDragEnd:"dragEnd",onDragGroupStart:"dragGroupStart",onDragGroup:"dragGroup",onDragGroupEnd:"dragGroupEnd"},requestStyle:function(){return["left","top","right","bottom"]},render:function(e,t){var r=e.props,n=r.throttleDragRotate,a=r.zoom,i=e.getState(),s=i.dragInfo,o=i.beforeOrigin;if(!n||!s)return[];var l=s.dist;if(!l[0]&&!l[1])return[];var u=Nr(l),c=Qe(l,[0,0]);return[t.createElement("div",{className:pe("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(u,"px"),transform:"translate(".concat(o[0],"px, ").concat(o[1],"px) rotate(").concat(c,"rad) scaleY(").concat(a,")")}})]},dragStart:function(e,t){var r=t.datas,n=t.parentEvent,a=t.parentGesto,i=e.state,s=i.gestos,o=i.style;if(s.draggable)return!1;s.draggable=a||e.targetGesto,r.datas={},r.left=parseFloat(o.left||"")||0,r.top=parseFloat(o.top||"")||0,r.bottom=parseFloat(o.bottom||"")||0,r.right=parseFloat(o.right||"")||0,r.startValue=[0,0],zn(e,t),Gi(t,"translate"),Eg(e,r),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0];var l=Ce(e,t,it({set:function(c){r.startValue=c}},Hi(t))),u=n||le(e,"onDragStart",l);return u!==!1?(r.isDrag=!0,e.state.dragInfo={startRect:e.getRect(),dist:[0,0]}):(s.draggable=null,r.isPinch=!1),r.isDrag?l:!1},drag:function(e,t){if(t){Vi(t,"translate");var r=t.datas,n=t.parentEvent,a=t.parentFlag,i=t.isPinch,s=t.isRequest,o=t.deltaOffset,l=t.distX,u=t.distY,c=r.isDrag,f=r.prevDist,d=r.prevBeforeDist,p=r.startValue;if(c){o&&(l+=o[0],u+=o[1]);var v=e.props,h=v.parentMoveable,m=n?0:v.throttleDrag||0,b=n?0:v.throttleDragRotate||0,y=0,S=!1,C=!1,R=!1,D=!1;if(!n&&b>0&&(l||u)){var I=v.startDragRotate||0,W=we(I+Qe([0,0],[l,u])*180/Math.PI,b)-I,G=u*Math.abs(Math.cos((W-90)/180*Math.PI)),F=l*Math.abs(Math.cos(W/180*Math.PI)),X=Nr([F,G]);y=W*Math.PI/180,l=X*Math.cos(y),u=X*Math.sin(y)}if(!i&&!n&&!a){var M=fg(e,l,u,b,s||o,r),st=M[0],J=M[1];S=st.isSnap,C=st.isBound,R=J.isSnap,D=J.isBound;var pt=st.offset,zt=J.offset;l+=pt,u+=zt}var Xt=De(xu({datas:r,distX:l,distY:u}),p),Ht=De(up({datas:r,distX:l,distY:u}),p);kl(Ht,xr),kl(Xt,xr),b||(!S&&!C&&(Ht[0]=we(Ht[0],m),Xt[0]=we(Xt[0],m)),!R&&!D&&(Ht[1]=we(Ht[1],m),Xt[1]=we(Xt[1],m)));var Nt=fe(Xt,p),yt=fe(Ht,p),It=fe(yt,f),Rt=fe(Nt,d);r.prevDist=yt,r.prevBeforeDist=Nt,r.passDelta=It,r.passDist=yt;var Mt=r.left+Nt[0],lt=r.top+Nt[1],Bt=r.right-Nt[0],O=r.bottom-Nt[1],V=$i(r,"translate(".concat(Ht[0],"px, ").concat(Ht[1],"px)"),"translate(".concat(yt[0],"px, ").concat(yt[1],"px)"));if(Ro(t,V),e.state.dragInfo.dist=n?[0,0]:yt,!(!n&&!h&&It.every(function(Ct){return!Ct})&&Rt.some(function(Ct){return!Ct}))){var _=e.state,Y=_.width,ot=_.height,_t=Ce(e,t,it({transform:V,dist:yt,delta:It,translate:Ht,beforeDist:Nt,beforeDelta:Rt,beforeTranslate:Xt,left:Mt,top:lt,right:Bt,bottom:O,width:Y,height:ot,isPinch:i},br({transform:V},t)));return!n&&le(e,"onDrag",_t),_t}}}},dragAfter:function(e,t){var r=t.datas,n=r.deltaOffset;return n[0]||n[1]?(r.deltaOffset=[0,0],this.drag(e,it(it({},t),{deltaOffset:n}))):!1},dragEnd:function(e,t){var r=t.parentEvent,n=t.datas;if(e.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var a=Rr(e,t,{});return!r&&le(e,"onDragEnd",a),a}},dragGroupStart:function(e,t){var r=t.datas,n=t.clientX,a=t.clientY,i=this.dragStart(e,t);if(!i)return!1;var s=gs(e,this,"dragStart",[n||0,a||0],t,!1,"draggable"),o=it(it({},i),{targets:e.props.targets,events:s}),l=le(e,"onDragGroupStart",o);return r.isDrag=l!==!1,r.isDrag?i:!1},dragGroup:function(e,t){var r=t.datas;if(r.isDrag){var n=this.drag(e,t),a=t.datas.passDelta,i=gs(e,this,"drag",a,t,!1,"draggable");if(n){var s=it({targets:e.props.targets,events:i},n);return le(e,"onDragGroup",s),s}}},dragGroupEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isDrag){this.dragEnd(e,t);var a=gs(e,this,"dragEnd",[0,0],t,!1,"draggable");return le(e,"onDragGroupEnd",Rr(e,t,{targets:e.props.targets,events:a})),r}},request:function(e){var t={},r=e.getRect(),n=0,a=0;return{isControl:!1,requestStart:function(){return{datas:t}},request:function(i){return"x"in i?n=i.x-r.left:"deltaX"in i&&(n+=i.deltaX),"y"in i?a=i.y-r.top:"deltaY"in i&&(a+=i.deltaY),{datas:t,distX:n,distY:a}},requestEnd:function(){return{datas:t,isDrag:!0}}}},unset:function(e){e.state.gestos.draggable=null,e.state.dragInfo=null}},Jl=Po("resizable"),Js={name:"resizable",ableGroup:"size",canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,keepRatio:Boolean,resizeFormat:Function,keepRatioFinally:Boolean,edge:Boolean,checkResizableError:Boolean},events:{onResizeStart:"resizeStart",onBeforeResize:"beforeResize",onResize:"resize",onResizeEnd:"resizeEnd",onResizeGroupStart:"resizeGroupStart",onBeforeResizeGroup:"beforeResizeGroup",onResizeGroup:"resizeGroup",onResizeGroupEnd:"resizeGroupEnd"},render:ec("resizable"),dragControlCondition:Jl,viewClassName:Oo("resizable"),dragControlStart:function(e,t){var r,n=t.inputEvent,a=t.isPinch,i=t.isGroup,s=t.parentDirection,o=t.parentGesto,l=t.datas,u=t.parentFixedDirection,c=t.parentEvent,f=Pu(s,a,n,l),d=e.state,p=d.target,v=d.width,h=d.height,m=d.gestos;if(!f||!p||m.resizable)return!1;m.resizable=o||e.controlGesto,!a&&zn(e,t),l.datas={},l.direction=f,l.startOffsetWidth=v,l.startOffsetHeight=h,l.prevWidth=0,l.prevHeight=0,l.minSize=[0,0],l.startWidth=d.inlineCSSWidth||d.cssWidth,l.startHeight=d.inlineCSSHeight||d.cssHeight,l.maxSize=[1/0,1/0],i||(l.minSize=[d.minOffsetWidth,d.minOffsetHeight],l.maxSize=[d.maxOffsetWidth,d.maxOffsetHeight]);var b=e.props.transformOrigin||"% %";l.transformOrigin=b&&Dr(b)?b.split(" "):b,l.startOffsetMatrix=d.offsetMatrix,l.startTransformOrigin=d.transformOrigin,l.isWidth=(r=t==null?void 0:t.parentIsWidth)!==null&&r!==void 0?r:!f[0]&&!f[1]||f[0]||!f[1];function y(G){l.ratio=G&&isFinite(G)?G:0}l.startPositions=Cr(e.state);function S(G){l.fixedDirection=G,l.fixedPosition=Ze(l.startPositions,G)}function C(G){var F=e.state,X=F.width,M=F.height;l.fixedPosition=G,l.fixedDirection=Eu(G,X,M)}function R(G){l.minSize=[$e("".concat(G[0]),0)||0,$e("".concat(G[1]),0)||0]}function D(G){var F=[G[0]||1/0,G[1]||1/0];(!Ms(F[0])||isFinite(F[0]))&&(F[0]=$e("".concat(F[0]),0)||1/0),(!Ms(F[1])||isFinite(F[1]))&&(F[1]=$e("".concat(F[1]),0)||1/0),l.maxSize=F}y(v/h),S(u||[-f[0],-f[1]]),l.setFixedDirection=S,l.setFixedPosition=C,l.setMin=R,l.setMax=D;var I=Ce(e,t,{direction:f,startRatio:l.ratio,set:function(G){var F=G[0],X=G[1];l.startWidth=F,l.startHeight=X},setMin:R,setMax:D,setRatio:y,setFixedDirection:S,setFixedPosition:C,setOrigin:function(G){l.transformOrigin=G},dragStart:_r.dragStart(e,new Kn().dragStart([0,0],t))}),W=c||le(e,"onResizeStart",I);return l.startFixedDirection=l.fixedDirection,l.startFixedPosition=l.fixedPosition,W!==!1&&(l.isResize=!0,e.state.snapRenderInfo={request:t.isRequest,direction:f}),l.isResize?I:!1},dragControl:function(e,t){var r,n=t.datas,a=t.parentFlag,i=t.isPinch,s=t.parentKeepRatio,o=t.dragClient,l=t.parentDist,u=t.isRequest,c=t.isGroup,f=t.parentEvent,d=t.resolveMatrix,p=n.isResize,v=n.transformOrigin,h=n.startWidth,m=n.startHeight,b=n.prevWidth,y=n.prevHeight,S=n.minSize,C=n.maxSize,R=n.ratio,D=n.startOffsetWidth,I=n.startOffsetHeight,W=n.isWidth;if(!p)return;if(d){var G=e.state.is3d,F=n.startOffsetMatrix,X=n.startTransformOrigin,M=G?4:3,st=Eo(Su(t)),J=Math.sqrt(st.length);M!==J&&(st=Xr(st,J,M));var pt=Ya(F,st,X,M),zt=gn(pt,D,I,M);n.startPositions=zt,n.nextTargetMatrix=st,n.nextAllMatrix=pt}var Xt=On(e.props,"resizable"),Ht=Xt.resizeFormat,Nt=Xt.throttleResize,yt=Nt===void 0?a?0:1:Nt,It=Xt.parentMoveable,Rt=Xt.keepRatioFinally,Mt=n.direction,lt=Mt,Bt=0,O=0;!Mt[0]&&!Mt[1]&&(lt=[1,1]);var V=R&&(s??Xt.keepRatio)||!1;function _(){var ct=n.fixedDirection,ht=$u(lt,V,n,t);Bt=ht.distWidth,O=ht.distHeight;var Z=lt[0]-ct[0]||V?Math.max(D+Bt,xr):D,Lt=lt[1]-ct[1]||V?Math.max(I+O,xr):I;return V&&D&&I&&(W?Lt=Z/R:Z=Lt*R),[Z,Lt]}var Y=_(),ot=Y[0],_t=Y[1];f||(n.setFixedDirection(n.fixedDirection),le(e,"onBeforeResize",Ce(e,t,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(ct){var ht;return n.setFixedDirection(ct),ht=_(),ot=ht[0],_t=ht[1],[ot,_t]},setFixedPosition:function(ct){var ht;return n.setFixedPosition(ct),ht=_(),ot=ht[0],_t=ht[1],[ot,_t]},boundingWidth:ot,boundingHeight:_t,setSize:function(ct){ot=ct[0],_t=ct[1]}},!0)));var Ct=o;o||(!a&&i?Ct=ku(e,[0,0]):Ct=n.fixedPosition);var Vt=[0,0];i||(Vt=wg(e,ot,_t,Mt,Ct,u,n)),l&&(!l[0]&&(Vt[0]=0),!l[1]&&(Vt[1]=0));function jt(){var ct;Ht&&(ct=Ht([ot,_t]),ot=ct[0],_t=ct[1]),ot=we(ot,yt),_t=we(_t,yt)}if(V){lt[0]&&lt[1]&&Vt[0]&&Vt[1]&&(Math.abs(Vt[0])>Math.abs(Vt[1])?Vt[1]=0:Vt[0]=0);var Gt=!Vt[0]&&!Vt[1];Gt&&jt(),lt[0]&&!lt[1]||Vt[0]&&!Vt[1]||Gt&&W?(ot+=Vt[0],_t=ot/R):(!lt[0]&&lt[1]||!Vt[0]&&Vt[1]||Gt&&!W)&&(_t+=Vt[1],ot=_t*R)}else ot+=Vt[0],_t+=Vt[1],ot=Math.max(0,ot),_t=Math.max(0,_t);r=Wv([ot,_t],S,C,V?R:!1),ot=r[0],_t=r[1],jt(),V&&(c||Rt)&&(W?_t=ot/R:ot=_t*R),Bt=ot-D,O=_t-I;var Pt=[Bt-b,O-y];n.prevWidth=Bt,n.prevHeight=O;var de=_p(e,ot,_t,Ct,v,n);if(!(!It&&Pt.every(function(ct){return!ct})&&de.every(function(ct){return!ct}))){var Qt=_r.drag(e,Xa(t,e.state,de,!!i,!1,"draggable")),te=Qt.transform,Ut=h+Bt,_e=m+O,$=Ce(e,t,it({width:Ut,height:_e,offsetWidth:Math.round(ot),offsetHeight:Math.round(_t),startRatio:R,boundingWidth:ot,boundingHeight:_t,direction:Mt,dist:[Bt,O],delta:Pt,isPinch:!!i,drag:Qt},Fu({style:{width:"".concat(Ut,"px"),height:"".concat(_e,"px")},transform:te},Qt,t)));return!f&&le(e,"onResize",$),$}},dragControlAfter:function(e,t){var r=t.datas,n=r.isResize,a=r.startOffsetWidth,i=r.startOffsetHeight,s=r.prevWidth,o=r.prevHeight;if(!(!n||e.props.checkResizableError===!1)){var l=e.state,u=l.width,c=l.height,f=u-(a+s),d=c-(i+o),p=Math.abs(f)>3,v=Math.abs(d)>3;if(p&&(r.startWidth+=f,r.startOffsetWidth+=f,r.prevWidth+=f),v&&(r.startHeight+=d,r.startOffsetHeight+=d,r.prevHeight+=d),p||v)return this.dragControl(e,t)}},dragControlEnd:function(e,t){var r=t.datas,n=t.parentEvent;if(r.isResize){r.isResize=!1;var a=Rr(e,t,{});return!n&&le(e,"onResizeEnd",a),a}},dragGroupControlCondition:Jl,dragGroupControlStart:function(e,t){var r=t.datas,n=this.dragControlStart(e,it(it({},t),{isGroup:!0}));if(!n)return!1;var a=Vr(e,"resizable",t);function i(v,h){var m=r.fixedDirection,b=r.fixedPosition,y=h.datas.startPositions||Cr(v.state),S=Ze(y,m),C=dr(qn(-e.rotation/180*Math.PI,3),[S[0]-b[0],S[1]-b[1],1],3),R=C[0],D=C[1];return h.datas.originalX=R,h.datas.originalY=D,h}var s=r.startOffsetWidth,o=r.startOffsetHeight;function l(){var v=r.minSize;a.forEach(function(h){var m=h.datas,b=m.minSize,y=m.startOffsetWidth,S=m.startOffsetHeight,C=s*(y?b[0]/y:0),R=o*(S?b[1]/S:0);v[0]=Math.max(v[0],C),v[1]=Math.max(v[1],R)})}function u(){var v=r.maxSize;a.forEach(function(h){var m=h.datas,b=m.maxSize,y=m.startOffsetWidth,S=m.startOffsetHeight,C=s*(y?b[0]/y:0),R=o*(S?b[1]/S:0);v[0]=Math.min(v[0],C),v[1]=Math.min(v[1],R)})}var c=Qr(e,this,"dragControlStart",t,function(v,h){return i(v,h)});l(),u();var f=function(v){n.setFixedDirection(v),c.forEach(function(h,m){h.setFixedDirection(v),i(h.moveable,a[m])})};r.setFixedDirection=f;var d=it(it({},n),{targets:e.props.targets,events:c.map(function(v){return it(it({},v),{setMin:function(h){v.setMin(h),l()},setMax:function(h){v.setMax(h),u()}})}),setFixedDirection:f,setMin:function(v){n.setMin(v),l()},setMax:function(v){n.setMax(v),u()}}),p=le(e,"onResizeGroupStart",d);return r.isResize=p!==!1,r.isResize?n:!1},dragGroupControl:function(e,t){var r=t.datas;if(r.isResize){var n=On(e.props,"resizable");Xi(e,"onBeforeResize",function(p){le(e,"onBeforeResizeGroup",Ce(e,t,it(it({},p),{targets:n.targets}),!0))});var a=this.dragControl(e,it(it({},t),{isGroup:!0}));if(a){var i=a.boundingWidth,s=a.boundingHeight,o=a.dist,l=n.keepRatio,u=[i/(i-o[0]),s/(s-o[1])],c=r.fixedPosition,f=Qr(e,this,"dragControl",t,function(p,v){var h=dr(qn(e.rotation/180*Math.PI,3),[v.datas.originalX*u[0],v.datas.originalY*u[1],1],3),m=h[0],b=h[1];return it(it({},v),{parentDist:null,parentScale:u,dragClient:De(c,[m,b]),parentKeepRatio:l})}),d=it({targets:n.targets,events:f},a);return le(e,"onResizeGroup",d),d}}},dragGroupControlEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isResize){this.dragControlEnd(e,t);var a=Qr(e,this,"dragControlEnd",t),i=Rr(e,t,{targets:e.props.targets,events:a});return le(e,"onResizeGroupEnd",i),r}},request:function(e){var t={},r=0,n=0,a=e.getRect();return{isControl:!0,requestStart:function(i){var s;return{datas:t,parentDirection:i.direction||[1,1],parentIsWidth:(s=i==null?void 0:i.horizontal)!==null&&s!==void 0?s:!0}},request:function(i){return"offsetWidth"in i?r=i.offsetWidth-a.offsetWidth:"deltaWidth"in i&&(r+=i.deltaWidth),"offsetHeight"in i?n=i.offsetHeight-a.offsetHeight:"deltaHeight"in i&&(n+=i.deltaHeight),{datas:t,parentDist:[r,n],parentKeepRatio:i.keepRatio}},requestEnd:function(){return{datas:t,isDrag:!0}}}},unset:function(e){e.state.gestos.resizable=null}};function ms(e,t,r,n,a){var i=e.props.groupable,s=e.state,o=s.is3d?4:3,l=t.origin,u=sr(e.state.rootMatrix,fe([l[0],l[1]],i?[0,0]:[s.left,s.top]),o),c=De([a.left,a.top],u);t.startAbsoluteOrigin=c,t.prevDeg=Qe(c,[r,n])/Math.PI*180,t.defaultDeg=t.prevDeg,t.prevSnapDeg=0,t.loop=0,t.startDist=Fr(c,[r,n])}function mi(e,t,r){var n=r.defaultDeg,a=r.prevDeg,i=a%360,s=Math.floor(a/360);i<0&&(i+=360),i>e&&i>270&&e<90?++s:i<e&&i<90&&e>270&&--s;var o=t*(s*360+e-n);return r.prevDeg=n+o,o}function _s(e,t,r,n){return mi(Qe(n.startAbsoluteOrigin,[e,t])/Math.PI*180,r,n)}function bs(e,t,r,n,a,i){var s=e.props.throttleRotate,o=s===void 0?0:s,l=r.prevSnapDeg,u=0,c=!1;if(i){var f=Sg(e,t,n);c=f.isSnap,u=a+f.rotation}c||(u=we(a+n,o));var d=u-a;return r.prevSnapDeg=d,[d-l,d,u]}function nc(e,t,r){var n=t[0],a=t[1],i=t[2],s=t[3];if(e==="none")return[];if(ar(e))return e.map(function(h){return nc(h,[n,a,i,s],r)[0]});var o=(e||"top").split("-"),l=o[0],u=o[1],c=[n,a];l==="left"?c=[i,n]:l==="right"?c=[a,s]:l==="bottom"&&(c=[s,i]);var f=[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2],d=Iu(c,r);if(u){var p=u==="top"||u==="left",v=l==="bottom"||l==="left";f=c[p&&!v||!p&&v?0:1]}return[[f,d]]}function to(e,t){if(t.isRequest)return t.requestAble==="rotatable";var r=t.inputEvent.target;if(or(r,pe("rotation-control"))||or(r,pe("around-control"))||or(r,pe("control"))&&or(r,pe("rotatable")))return!0;var n=e.props.rotationTarget;return n?Lo(n,!0).some(function(a){return a?r===a||r.contains(a):!1}):!1}var Rg=To.map(function(e){var t="",r="",n="center",a="center";return e.indexOf("n")>-1&&(t="top: -20px;",a="bottom"),e.indexOf("s")>-1&&(t="top: 0px;",a="top"),e.indexOf("w")>-1&&(r="left: -20px;",n="right"),e.indexOf("e")>-1&&(r="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(e,`"] {
        `).concat(r).concat(t,`
        transform-origin: `).concat(n," ").concat(a,`;
    }`)}).join(`
`),Ag=`.rotation {
    position: absolute;
    height: 40px;
    width: 1px;
    transform-origin: 50% 100%;
    height: calc(40px * var(--zoom));
    top: auto;
    left: 0;
    bottom: 100%;
    will-change: transform;
}
.rotation .rotation-line {
    display: block;
    width: 100%;
    height: 100%;
    transform-origin: 50% 50%;
}
.rotation .rotation-control {
    border-color: #4af;
    border-color: var(--moveable-color);
    background:#fff;
    cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
    cursor: alias;
}
.around-control {
    position: absolute;
    will-change: transform;
    width: 20px;
    height: 20px;
    left: -10px;
    top: -10px;
    box-sizing: border-box;
    background: transparent;
    z-index: 8;
    cursor: alias;
    transform-origin: center center;
}
.rotatable.direction.control.move {
    cursor: move;
}
`.concat(Rg,`
`),Bg={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number,renderDirections:Object,rotationTarget:Object,rotateAroundControls:Boolean,edge:Boolean,resolveAblesWithRotatable:Object},events:{onRotateStart:"rotateStart",onBeforeRotate:"beforeRotate",onRotate:"rotate",onRotateEnd:"rotateEnd",onRotateGroupStart:"rotateGroupStart",onBeforeRotateGroup:"beforeRotateGroup",onRotateGroup:"rotateGroup",onRotateGroupEnd:"rotateGroupEnd"},css:[Ag],viewClassName:function(e){return e.isDragging("rotatable")?pe("view-rotation-dragging"):""},render:function(e,t){var r=On(e.props,"rotatable"),n=r.rotatable,a=r.rotationPosition,i=r.zoom,s=r.renderDirections,o=r.rotateAroundControls,l=r.resolveAblesWithRotatable,u=e.getState(),c=u.renderPoses,f=u.direction;if(!n)return null;var d=nc(a,c,f),p=[];if(d.forEach(function(b,y){var S=b[0],C=b[1];p.push(t.createElement("div",{key:"rotation".concat(y),className:pe("rotation"),style:{transform:"translate(-50%) translate(".concat(S[0],"px, ").concat(S[1],"px) rotate(").concat(C,"rad)")}},t.createElement("div",{className:pe("line rotation-line"),style:{transform:"scaleX(".concat(i,")")}}),t.createElement("div",{className:pe("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(i,")")}})))}),s){var v=aa(l||{}),h={};v.forEach(function(b){l[b].forEach(function(y){h[y]=b})});var m=[];ar(s)&&(m=s.map(function(b){var y=h[b];return{data:y?{resolve:y}:{},classNames:y?["move"]:[],dir:b}})),p.push.apply(p,Qu(e,"rotatable",m,t))}return o&&p.push.apply(p,Tg(e,t)),p},dragControlCondition:to,dragControlStart:function(e,t){var r,n,a=t.datas,i=t.clientX,s=t.clientY,o=t.parentRotate,l=t.parentFlag,u=t.isPinch,c=t.isRequest,f=e.state,d=f.target,p=f.left,v=f.top,h=f.direction,m=f.beforeDirection,b=f.targetTransform,y=f.moveableClientRect,S=f.offsetMatrix,C=f.targetMatrix,R=f.allMatrix,D=f.width,I=f.height;if(!c&&!d)return!1;var W=e.getRect();a.rect=W,a.transform=b,a.left=p,a.top=v;var G=function(Bt){var O=e.state,V=O.allMatrix,_=O.is3d,Y=O.width,ot=O.height,_t=Eu(Bt,Y,ot);a.fixedDirection=_t,a.fixedPosition=sr(V,Bt,_?4:3),It&&It.setFixedPosition(Bt)},F=function(Bt){a.fixedDirection=Bt,a.fixedPosition=Mu(e,Bt),It&&It.setFixedDirection(Bt)},X=i,M=s;if(c||u||l){var st=o||0;a.beforeInfo={origin:W.beforeOrigin,prevDeg:st,defaultDeg:st,prevSnapDeg:0,startDist:0},a.afterInfo=it(it({},a.beforeInfo),{origin:W.origin}),a.absoluteInfo=it(it({},a.beforeInfo),{origin:W.origin,startValue:st})}else{var J=(n=t.inputEvent)===null||n===void 0?void 0:n.target;if(J){var pt=J.getAttribute("data-direction")||"",zt=op[pt];if(zt){a.isControl=!0,a.isAroundControl=or(J,pe("around-control")),a.controlDirection=zt;var Xt=J.getAttribute("data-resolve");Xt&&(a.resolveAble=Xt);var Ht=Dp(f.rootMatrix,f.renderPoses,y);r=Ze(Ht,zt),X=r[0],M=r[1]}}a.beforeInfo={origin:W.beforeOrigin},a.afterInfo={origin:W.origin},a.absoluteInfo={origin:W.origin,startValue:W.rotation};var Nt=G;G=function(Bt){var O=f.is3d?4:3,V=De(iu(C,O),Bt),_=V[0],Y=V[1],ot=dr(S,In([_,Y],O)),_t=dr(R,In([Bt[0],Bt[1]],O));Nt(Bt);var Ct=f.posDelta;a.beforeInfo.origin=fe(ot,Ct),a.afterInfo.origin=fe(_t,Ct),a.absoluteInfo.origin=fe(_t,Ct),ms(e,a.beforeInfo,X,M,y),ms(e,a.afterInfo,X,M,y),ms(e,a.absoluteInfo,X,M,y)},F=function(Bt){var O=Ze([[0,0],[D,0],[0,I],[D,I]],Bt);G(O)}}a.startClientX=X,a.startClientY=M,a.direction=h,a.beforeDirection=m,a.startValue=0,a.datas={},Gi(t,"rotate");var yt=!1,It=!1;if(a.isControl&&a.resolveAble){var Rt=a.resolveAble;Rt==="resizable"&&(It=Js.dragControlStart(e,it(it({},new Kn("resizable").dragStart([0,0],t)),{parentPosition:a.controlPosition,parentFixedPosition:a.fixedPosition})))}It||(yt=_r.dragStart(e,new Kn().dragStart([0,0],t))),G(f.transformOrigin);var Mt=Ce(e,t,it(it({set:function(Bt){a.startValue=Bt*Math.PI/180},setFixedDirection:F,setFixedPosition:G},Hi(t)),{dragStart:yt,resizeStart:It})),lt=le(e,"onRotateStart",Mt);return a.isRotate=lt!==!1,f.snapRenderInfo={request:t.isRequest},a.isRotate?Mt:!1},dragControl:function(e,t){var r,n,a,i=t.datas,s=t.clientDistX,o=t.clientDistY,l=t.parentRotate,u=t.parentFlag,c=t.isPinch,f=t.groupDelta,d=i.beforeDirection,p=i.beforeInfo,v=i.afterInfo,h=i.absoluteInfo,m=i.isRotate,b=i.startValue,y=i.rect,S=i.startClientX,C=i.startClientY;if(m){Vi(t,"rotate");var R=lp(t),D=d*R,I=e.props.parentMoveable,W=0,G,F,X=0,M,st,J=0,pt,zt,Xt=180/Math.PI*b,Ht=h.startValue,Nt=!1,yt=S+s,It=C+o;if(!u&&"parentDist"in t){var Rt=t.parentDist;G=Rt,M=Rt,pt=Rt}else c||u?(G=mi(l,d,p),M=mi(l,D,v),pt=mi(l,D,h)):(G=_s(yt,It,d,p),M=_s(yt,It,D,v),pt=_s(yt,It,D,h),Nt=!0);if(F=Xt+G,st=Xt+M,zt=Ht+pt,le(e,"onBeforeRotate",Ce(e,t,{beforeRotation:F,rotation:st,absoluteRotation:zt,setRotation:function(Ct){M=Ct-Xt,G=M,pt=M}},!0)),r=bs(e,y,p,G,Xt,Nt),W=r[0],G=r[1],F=r[2],n=bs(e,y,v,M,Xt,Nt),X=n[0],M=n[1],st=n[2],a=bs(e,y,h,pt,Ht,Nt),J=a[0],pt=a[1],zt=a[2],!(!J&&!X&&!W&&!I)){var Mt=$i(i,"rotate(".concat(st,"deg)"),"rotate(".concat(M,"deg)")),lt=mp(e,M,i),Bt=fe(De(f||[0,0],lt),i.prevInverseDist||[0,0]);i.prevInverseDist=lt,i.requestValue=null;var O=wu(e,Mt,Bt,c,t),V=O,_=Fr([yt,It],h.startAbsoluteOrigin)-h.startDist,Y=void 0;if(i.resolveAble==="resizable"){var ot=Js.dragControl(e,it(it({},Xa(t,e.state,[t.deltaX,t.deltaY],!!c,!1,"resizable")),{resolveMatrix:!0,parentDistance:_}));ot&&(Y=ot,V=Fu(V,ot,t))}var _t=Ce(e,t,it(it({delta:X,dist:M,rotate:st,rotation:st,beforeDist:G,beforeDelta:W,beforeRotate:F,beforeRotation:F,absoluteDist:pt,absoluteDelta:J,absoluteRotate:zt,absoluteRotation:zt,isPinch:!!c,resize:Y},O),V));return le(e,"onRotate",_t),_t}}},dragControlEnd:function(e,t){var r=t.datas;if(r.isRotate){r.isRotate=!1;var n=Rr(e,t,{});return le(e,"onRotateEnd",n),n}},dragGroupControlCondition:to,dragGroupControlStart:function(e,t){var r=t.datas,n=e.state,a=n.left,i=n.top,s=n.beforeOrigin,o=this.dragControlStart(e,t);if(!o)return!1;o.set(r.beforeDirection*e.rotation);var l=Qr(e,this,"dragControlStart",t,function(f,d){var p=f.state,v=p.left,h=p.top,m=p.beforeOrigin,b=De(fe([v,h],[a,i]),fe(m,s));return d.datas.startGroupClient=b,d.datas.groupClient=b,it(it({},d),{parentRotate:0})}),u=it(it({},o),{targets:e.props.targets,events:l}),c=le(e,"onRotateGroupStart",u);return r.isRotate=c!==!1,r.isRotate?o:!1},dragGroupControl:function(e,t){var r=t.datas;if(r.isRotate){Xi(e,"onBeforeRotate",function(u){le(e,"onBeforeRotateGroup",Ce(e,t,it(it({},u),{targets:e.props.targets}),!0))});var n=this.dragControl(e,t);if(n){var a=r.beforeDirection,i=n.beforeDist,s=i/180*Math.PI,o=Qr(e,this,"dragControl",t,function(u,c){var f=c.datas.startGroupClient,d=c.datas.groupClient,p=d[0],v=d[1],h=Ha(f,s*a),m=h[0],b=h[1],y=[m-p,b-v];return c.datas.groupClient=[m,b],it(it({},c),{parentRotate:i,groupDelta:y})});e.rotation=a*n.beforeRotation;var l=it({targets:e.props.targets,events:o,set:function(u){e.rotation=u},setGroupRotation:function(u){e.rotation=u}},n);return le(e,"onRotateGroup",l),l}}},dragGroupControlEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isRotate){this.dragControlEnd(e,t);var a=Qr(e,this,"dragControlEnd",t),i=Rr(e,t,{targets:e.props.targets,events:a});return le(e,"onRotateGroupEnd",i),r}},request:function(e){var t={},r=0,n=e.getRotation();return{isControl:!0,requestStart:function(){return{datas:t}},request:function(a){return"deltaRotate"in a?r+=a.deltaRotate:"rotate"in a&&(r=a.rotate-n),{datas:t,parentDist:r}},requestEnd:function(){return{datas:t,isDrag:!0}}}}},t0=Po("scalable"),Ig={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean,edge:Boolean},events:{onScaleStart:"scaleStart",onBeforeScale:"beforeScale",onScale:"scale",onScaleEnd:"scaleEnd",onScaleGroupStart:"scaleGroupStart",onBeforeScaleGroup:"beforeScaleGroup",onScaleGroup:"scaleGroup",onScaleGroupEnd:"scaleGroupEnd"},render:ec("scalable"),dragControlCondition:t0,viewClassName:Oo("scalable"),dragControlStart:function(e,t){var r=t.datas,n=t.isPinch,a=t.inputEvent,i=t.parentDirection,s=Pu(i,n,a,r),o=e.state,l=o.width,u=o.height,c=o.targetTransform,f=o.target,d=o.pos1,p=o.pos2,v=o.pos4;if(!s||!f)return!1;n||zn(e,t),r.datas={},r.transform=c,r.prevDist=[1,1],r.direction=s,r.startOffsetWidth=l,r.startOffsetHeight=u,r.startValue=[1,1];var h=Fr(d,p),m=Fr(p,v),b=!s[0]&&!s[1]||s[0]||!s[1];r.scaleWidth=h,r.scaleHeight=m,r.scaleXRatio=h/l,r.scaleYRatio=m/u,Gi(t,"scale"),r.isWidth=b;function y(D){r.ratio=D&&isFinite(D)?D:0}r.startPositions=Cr(e.state);function S(D){r.fixedDirection=D,r.fixedPosition=Ze(r.startPositions,D)}r.setFixedDirection=S,y(Fr(d,p)/Fr(p,v)),S([-s[0],-s[1]]);var C=Ce(e,t,it(it({direction:s,set:function(D){r.startValue=D},setRatio:y,setFixedDirection:S},Hi(t)),{dragStart:_r.dragStart(e,new Kn().dragStart([0,0],t))})),R=le(e,"onScaleStart",C);return r.startFixedDirection=r.fixedDirection,R!==!1&&(r.isScale=!0,e.state.snapRenderInfo={request:t.isRequest,direction:s}),r.isScale?C:!1},dragControl:function(e,t){Vi(t,"scale");var r=t.datas,n=t.parentKeepRatio,a=t.parentFlag,i=t.isPinch,s=t.dragClient,o=t.isRequest,l=r.prevDist,u=r.direction,c=r.startOffsetWidth,f=r.startOffsetHeight,d=r.isScale,p=r.startValue,v=r.isWidth,h=r.ratio;if(!d)return!1;var m=e.props,b=m.throttleScale,y=m.parentMoveable,S=u;!u[0]&&!u[1]&&(S=[1,1]);var C=h&&(n??m.keepRatio)||!1,R=e.state;function D(){var It=$u(S,C,r,t),Rt=It.distWidth,Mt=It.distHeight,lt=c?(c+Rt)/c:1,Bt=f?(f+Mt)/f:1;return lt=S[0]||C?lt*p[0]:p[0],Bt=S[1]||C?Bt*p[1]:p[1],lt===0&&(lt=(l[0]>0?1:-1)*ri),Bt===0&&(Bt=(l[1]>0?1:-1)*ri),[lt,Bt]}var I=D();if(!i&&e.props.groupable){var W=R.snapRenderInfo||{},G=W.direction;ar(G)&&(G[0]||G[1])&&(R.snapRenderInfo={direction:u,request:t.isRequest})}le(e,"onBeforeScale",Ce(e,t,{scale:I,setFixedDirection:function(It){return r.setFixedDirection(It),I=D(),I},startFixedDirection:r.startFixedDirection,setScale:function(It){I=It}},!0));var F=[I[0]/p[0],I[1]/p[1]],X=s,M=[0,0];if(s||(!a&&i?X=ku(e,[0,0]):X=r.fixedPosition),i||(M=Cg(e,F,u,o,r)),C){S[0]&&S[1]&&M[0]&&M[1]&&(Math.abs(M[0]*c)>Math.abs(M[1]*f)?M[1]=0:M[0]=0);var st=!M[0]&&!M[1];if(st&&(v?F[0]=we(F[0]*p[0],b)/p[0]:F[1]=we(F[1]*p[1],b)/p[1]),S[0]&&!S[1]||M[0]&&!M[1]||st&&v){F[0]+=M[0];var J=c*F[0]*p[0]/h;F[1]=J/f/p[1]}else if(!S[0]&&S[1]||!M[0]&&M[1]||st&&!v){F[1]+=M[1];var pt=f*F[1]*p[1]*h;F[0]=pt/c/p[0]}}else F[0]+=M[0],F[1]+=M[1],M[0]||(F[0]=we(F[0]*p[0],b)/p[0]),M[1]||(F[1]=we(F[1]*p[1],b)/p[1]);F[0]===0&&(F[0]=(l[0]>0?1:-1)*ri),F[1]===0&&(F[1]=(l[1]>0?1:-1)*ri);var zt=[F[0]/l[0],F[1]/l[1]];I=xp(F,p);var Xt=gp(e,F,r.fixedDirection,X,r),Ht=fe(Xt,r.prevInverseDist||[0,0]);if(r.prevDist=F,r.prevInverseDist=Xt,I[0]===l[0]&&I[1]===l[1]&&Ht.every(function(It){return!It})&&!y)return!1;var Nt=$i(r,"scale(".concat(I.join(", "),")"),"scale(".concat(F.join(", "),")")),yt=Ce(e,t,it({offsetWidth:c,offsetHeight:f,direction:u,scale:I,dist:F,delta:zt,isPinch:!!i},wu(e,Nt,Ht,i,t)));return le(e,"onScale",yt),yt},dragControlEnd:function(e,t){var r=t.datas;if(!r.isScale)return!1;r.isScale=!1;var n=Rr(e,t,{});return le(e,"onScaleEnd",n),n},dragGroupControlCondition:t0,dragGroupControlStart:function(e,t){var r=t.datas,n=this.dragControlStart(e,t);if(!n)return!1;var a=Vr(e,"resizable",t);function i(c,f){var d=r.fixedDirection,p=r.fixedPosition,v=f.datas.startPositions||Cr(c.state),h=Ze(v,d),m=dr(qn(-e.rotation/180*Math.PI,3),[h[0]-p[0],h[1]-p[1],1],3),b=m[0],y=m[1];return f.datas.originalX=b,f.datas.originalY=y,f}r.moveableScale=e.scale;var s=Qr(e,this,"dragControlStart",t,function(c,f){return i(c,f)}),o=function(c){n.setFixedDirection(c),s.forEach(function(f,d){f.setFixedDirection(c),i(f.moveable,a[d])})};r.setFixedDirection=o;var l=it(it({},n),{targets:e.props.targets,events:s,setFixedDirection:o}),u=le(e,"onScaleGroupStart",l);return r.isScale=u!==!1,r.isScale?l:!1},dragGroupControl:function(e,t){var r=t.datas;if(r.isScale){Xi(e,"onBeforeScale",function(f){le(e,"onBeforeScaleGroup",Ce(e,t,it(it({},f),{targets:e.props.targets}),!0))});var n=this.dragControl(e,t);if(n){var a=r.moveableScale;e.scale=[n.scale[0]*a[0],n.scale[1]*a[1]];var i=e.props.keepRatio,s=n.dist,o=n.scale,l=r.fixedPosition,u=Qr(e,this,"dragControl",t,function(f,d){var p=dr(qn(e.rotation/180*Math.PI,3),[d.datas.originalX*s[0],d.datas.originalY*s[1],1],3),v=p[0],h=p[1];return it(it({},d),{parentDist:null,parentScale:o,parentKeepRatio:i,dragClient:De(l,[v,h])})}),c=it({targets:e.props.targets,events:u},n);return le(e,"onScaleGroup",c),c}}},dragGroupControlEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isScale){this.dragControlEnd(e,t);var a=Qr(e,this,"dragControlEnd",t),i=Rr(e,t,{targets:e.props.targets,events:a});return le(e,"onScaleGroupEnd",i),r}},request:function(){var e={},t=0,r=0;return{isControl:!0,requestStart:function(n){return{datas:e,parentDirection:n.direction||[1,1]}},request:function(n){return t+=n.deltaWidth,r+=n.deltaHeight,{datas:e,parentDist:[t,r],parentKeepRatio:n.keepRatio}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function on(e,t){return e.map(function(r,n){return En(r,t[n],1,2)})}function e0(e,t,r){var n=Qe(e,t),a=Qe(e,r),i=a-n;return i>=0?i:i+2*Math.PI}function Og(e,t){var r=e0(e[0],e[1],e[2]),n=e0(t[0],t[1],t[2]),a=Math.PI;return!(r>=a&&n<=a||r<=a&&n>=a)}var Pg={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array,edge:Boolean},events:{onWarpStart:"warpStart",onWarp:"warp",onWarpEnd:"warpEnd"},viewClassName:Oo("warpable"),render:function(e,t){var r=e.props,n=r.resizable,a=r.scalable,i=r.warpable,s=r.zoom;if(n||a||!i)return[];var o=e.state,l=o.pos1,u=o.pos2,c=o.pos3,f=o.pos4,d=on(l,u),p=on(u,l),v=on(l,c),h=on(c,l),m=on(c,f),b=on(f,c),y=on(u,f),S=on(f,u);return ge([t.createElement("div",{className:pe("line"),key:"middeLine1",style:ha(d,m,s)}),t.createElement("div",{className:pe("line"),key:"middeLine2",style:ha(p,b,s)}),t.createElement("div",{className:pe("line"),key:"middeLine3",style:ha(v,y,s)}),t.createElement("div",{className:pe("line"),key:"middeLine4",style:ha(h,S,s)})],rc(e,"warpable",t),!0)},dragControlCondition:function(e,t){if(t.isRequest)return!1;var r=t.inputEvent.target;return or(r,pe("direction"))&&or(r,pe("warpable"))},dragControlStart:function(e,t){var r=t.datas,n=t.inputEvent,a=e.props.target,i=n.target,s=Lu(i,r);if(!s||!a)return!1;var o=e.state,l=o.transformOrigin,u=o.is3d,c=o.targetTransform,f=o.targetMatrix,d=o.width,p=o.height,v=o.left,h=o.top;r.datas={},r.targetTransform=c,r.warpTargetMatrix=u?f:Xr(f,3,4),r.targetInverseMatrix=au(Wr(r.warpTargetMatrix,4),3,4),r.direction=s,r.left=v,r.top=h,r.poses=[[0,0],[d,0],[0,p],[d,p]].map(function(y){return fe(y,l)}),r.nextPoses=r.poses.map(function(y){var S=y[0],C=y[1];return dr(r.warpTargetMatrix,[S,C,0,1],4)}),r.startValue=je(4),r.prevMatrix=je(4),r.absolutePoses=Cr(o),r.posIndexes=yu(s),zn(e,t),Gi(t,"matrix3d"),o.snapRenderInfo={request:t.isRequest,direction:s};var m=Ce(e,t,it({set:function(y){r.startValue=y}},Hi(t))),b=le(e,"onWarpStart",m);return b!==!1&&(r.isWarp=!0),r.isWarp},dragControl:function(e,t){var r=t.datas,n=t.isRequest,a=t.distX,i=t.distY,s=r.targetInverseMatrix,o=r.prevMatrix,l=r.isWarp,u=r.startValue,c=r.poses,f=r.posIndexes,d=r.absolutePoses;if(!l)return!1;if(Vi(t,"matrix3d"),sa(e,"warpable")){var p=f.map(function(G){return d[G]});p.length>1&&p.push([(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2]);var v=ji(e,n,{horizontal:p.map(function(G){return G[1]+i}),vertical:p.map(function(G){return G[0]+a})}),h=v.horizontal,m=v.vertical;i-=h.offset,a-=m.offset}var b=Kr({datas:r,distX:a,distY:i},!0),y=r.nextPoses.slice();if(f.forEach(function(G){y[G]=De(y[G],b)}),!ip.every(function(G){return Og(G.map(function(F){return c[F]}),G.map(function(F){return y[F]}))}))return!1;var S=Co(c[0],c[2],c[1],c[3],y[0],y[2],y[1],y[3]);if(!S.length)return!1;var C=ze(s,S,4),R=bu(r,C,!0),D=ze(Wr(o,4),R,4);r.prevMatrix=R;var I=ze(u,R,4),W=$i(r,"matrix3d(".concat(I.join(", "),")"),"matrix3d(".concat(R.join(", "),")"));return Ro(t,W),le(e,"onWarp",Ce(e,t,it({delta:D,matrix:I,dist:R,multiply:ze,transform:W},br({transform:W},t)))),!0},dragControlEnd:function(e,t){var r=t.datas,n=t.isDrag;return r.isWarp?(r.isWarp=!1,le(e,"onWarpEnd",Rr(e,t,{})),n):!1}},Lg=pe("area-pieces"),ui=pe("area-piece"),ac=pe("avoid"),Fg=pe("view-dragging");function xs(e){var t=e.areaElement;if(t){var r=e.state,n=r.width,a=r.height;X0(t,ac),t.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(a,"px")}}function r0(e){return e.createElement("div",{key:"area_pieces",className:Lg},e.createElement("div",{className:ui}),e.createElement("div",{className:ui}),e.createElement("div",{className:ui}),e.createElement("div",{className:ui}))}var ic={name:"dragArea",props:{dragArea:Boolean,passDragArea:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},render:function(e,t){var r=e.props,n=r.target,a=r.dragArea,i=r.groupable,s=r.passDragArea,o=e.getState(),l=o.width,u=o.height,c=o.renderPoses,f=s?pe("area","pass"):pe("area");if(i)return[t.createElement("div",{key:"area",ref:Hr(e,"areaElement"),className:f}),r0(t)];if(!n||!a)return[];var d=Co([0,0],[l,0],[0,u],[l,u],c[0],c[1],c[2],c[3]),p=d.length?Wi(d,!0):"none";return[t.createElement("div",{key:"area",ref:Hr(e,"areaElement"),className:f,style:{top:"0px",left:"0px",width:"".concat(l,"px"),height:"".concat(u,"px"),transformOrigin:"0 0",transform:p}}),r0(t)]},dragStart:function(e,t){var r=t.datas,n=t.clientX,a=t.clientY,i=t.inputEvent;if(!i)return!1;r.isDragArea=!1;var s=e.areaElement,o=e.state,l=o.moveableClientRect,u=o.renderPoses,c=o.rootMatrix,f=o.is3d,d=l.left,p=l.top,v=Or(u),h=v.left,m=v.top,b=v.width,y=v.height,S=f?4:3,C=Bn(c,[n-d,a-p],S),R=C[0],D=C[1];R-=h,D-=m;var I=[{left:h,top:m,width:b,height:D-10},{left:h,top:m,width:R-10,height:y},{left:h,top:m+D+10,width:b,height:y-D-10},{left:h+R+10,top:m,width:b-R-10,height:y}],W=[].slice.call(s.nextElementSibling.children);I.forEach(function(G,F){W[F].style.cssText="left: ".concat(G.left,"px;top: ").concat(G.top,"px; width: ").concat(G.width,"px; height: ").concat(G.height,"px;")}),W0(s,ac),o.disableNativeEvent=!0},drag:function(e,t){var r=t.datas,n=t.inputEvent;if(this.enableNativeEvent(e),!n)return!1;r.isDragArea||(r.isDragArea=!0,xs(e))},dragEnd:function(e,t){this.enableNativeEvent(e);var r=t.inputEvent,n=t.datas;if(!r)return!1;n.isDragArea||xs(e)},dragGroupStart:function(e,t){return this.dragStart(e,t)},dragGroup:function(e,t){return this.drag(e,t)},dragGroupEnd:function(e,t){return this.dragEnd(e,t)},unset:function(e){xs(e),e.state.disableNativeEvent=!1},enableNativeEvent:function(e){var t=e.state;t.disableNativeEvent&&G0(function(){t.disableNativeEvent=!1})}},zg=Wa("origin",{render:function(e,t){var r=e.props.zoom,n=e.getState(),a=n.beforeOrigin,i=n.rotation;return[t.createElement("div",{className:pe("control","origin"),style:Bo(i,r,a),key:"beforeOrigin"})]}});function Ng(e){var t=e.scrollContainer;return[t.scrollLeft,t.scrollTop]}var Vg={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number,scrollThrottleTime:Number,getScrollPosition:Function,scrollOptions:Object},events:{onScroll:"scroll",onScrollGroup:"scrollGroup"},dragRelation:"strong",dragStart:function(e,t){var r=e.props,n=r.scrollContainer,a=n===void 0?e.getContainer():n,i=r.scrollOptions,s=new Lh,o=Pn(a,!0);t.datas.dragScroll=s,e.state.dragScroll=s;var l=t.isControl?"controlGesto":"targetGesto",u=t.targets;s.on("scroll",function(c){var f=c.container,d=c.direction,p=Ce(e,t,{scrollContainer:f,direction:d}),v=u?"onScrollGroup":"onScroll";u&&(p.targets=u),le(e,v,p)}).on("move",function(c){var f=c.offsetX,d=c.offsetY,p=c.inputEvent;e[l].scrollBy(f,d,p.inputEvent,!0)}).on("scrollDrag",function(c){var f=c.next;f(e[l].getCurrentEvent())}),s.dragStart(t,it({container:o},i))},checkScroll:function(e,t){var r=t.datas.dragScroll;if(r){var n=e.props,a=n.scrollContainer,i=a===void 0?e.getContainer():a,s=n.scrollThreshold,o=s===void 0?0:s,l=n.scrollThrottleTime,u=l===void 0?0:l,c=n.getScrollPosition,f=c===void 0?Ng:c,d=n.scrollOptions;return r.drag(t,it({container:i,threshold:o,throttleTime:u,getScrollPosition:function(p){return f({scrollContainer:p.container,direction:p.direction})}},d)),!0}},drag:function(e,t){return this.checkScroll(e,t)},dragEnd:function(e,t){t.datas.dragScroll.dragEnd(),t.datas.dragScroll=null},dragControlStart:function(e,t){return this.dragStart(e,it(it({},t),{isControl:!0}))},dragControl:function(e,t){return this.drag(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupStart:function(e,t){return this.dragStart(e,it(it({},t),{targets:e.props.targets}))},dragGroup:function(e,t){return this.drag(e,it(it({},t),{targets:e.props.targets}))},dragGroupEnd:function(e,t){return this.dragEnd(e,it(it({},t),{targets:e.props.targets}))},dragGroupControlStart:function(e,t){return this.dragStart(e,it(it({},t),{targets:e.props.targets,isControl:!0}))},dragGroupControl:function(e,t){return this.drag(e,it(it({},t),{targets:e.props.targets}))},dragGroupControEnd:function(e,t){return this.dragEnd(e,it(it({},t),{targets:e.props.targets}))},unset:function(e){var t,r=e.state;(t=r.dragScroll)===null||t===void 0||t.dragEnd(),r.dragScroll=null}},sc={name:"",props:{target:Object,dragTarget:Object,container:Object,portalContainer:Object,rootContainer:Object,useResizeObserver:Boolean,zoom:Number,transformOrigin:Array,edge:Object,ables:Array,className:String,pinchThreshold:Number,pinchOutside:Boolean,triggerAblesSimultaneously:Boolean,checkInput:Boolean,cspNonce:String,translateZ:Number,hideDefaultLines:Boolean,props:Object,flushSync:Function,stopPropagation:Boolean,preventClickEventOnDrag:Boolean,preventClickDefault:Boolean,viewContainer:Object,persistData:Object,useAccuratePosition:Boolean,firstRenderState:Object,linePadding:Boolean},events:{onChangeTargets:"changeTargets"}},$g=Wa("padding",{render:function(e,t){var r=e.props;if(r.dragArea)return[];var n=r.padding||{},a=n.left,i=a===void 0?0:a,s=n.top,o=s===void 0?0:s,l=n.right,u=l===void 0?0:l,c=n.bottom,f=c===void 0?0:c,d=e.getState(),p=d.renderPoses,v=d.pos1,h=d.pos2,m=d.pos3,b=d.pos4,y=[v,h,m,b],S=[];return i>0&&S.push([0,2]),o>0&&S.push([0,1]),u>0&&S.push([1,3]),f>0&&S.push([2,3]),S.map(function(C,R){var D=C[0],I=C[1],W=y[D],G=y[I],F=p[D],X=p[I],M=Co([0,0],[100,0],[0,100],[100,100],W,G,F,X);if(M.length)return t.createElement("div",{key:"padding".concat(R),className:pe("padding"),style:{transform:Wi(M,!0)}})})}}),n0=["nw","ne","se","sw"];function ci(e,t){var r=e[0]+e[1],n=r>t?t/r:1;return e[0]*=n,e[1]=t-e[1]*n,e}var Hg=[1,2,5,6],Gg=[0,3,4,7],kn=[1,-1,-1,1],Tn=[1,1,-1,-1];function Go(e,t,r,n,a,i,s,o){a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=r),o===void 0&&(o=n);var l=[],u=!1,c=e.filter(function(d){return!d.virtual}),f=c.map(function(d){var p=d.horizontal,v=d.vertical,h=d.pos;if(v&&!u&&(u=!0,l.push("/")),u){var m=Math.max(0,v===1?h[1]-i:o-h[1]);return l.push(Lr(m,n,t)),m}else{var m=Math.max(0,p===1?h[0]-a:s-h[0]);return l.push(Lr(m,r,t)),m}});return{radiusPoses:c,styles:l,raws:f}}function oc(e){for(var t=[0,0],r=[0,0],n=e.length,a=0;a<n;++a){var i=e[a];i.sub&&(i.horizontal&&(t[1]===0&&(t[0]=a),t[1]=a-t[0]+1,r[0]=a+1),i.vertical&&(r[1]===0&&(r[0]=a),r[1]=a-r[0]+1))}return{horizontalRange:t,verticalRange:r}}function lc(e,t,r,n,a,i,s){var o,l,u,c;i===void 0&&(i=[0,0]),s===void 0&&(s=!1);var f=e.indexOf("/"),d=(f>-1?e.slice(0,f):e).length,p=e.slice(0,d),v=e.slice(d+1),h=p.length,m=v.length,b=m>0,y=p[0],S=y===void 0?"0px":y,C=p[1],R=C===void 0?S:C,D=p[2],I=D===void 0?S:D,W=p[3],G=W===void 0?R:W,F=v[0],X=F===void 0?S:F,M=v[1],st=M===void 0?b?X:R:M,J=v[2],pt=J===void 0?b?X:I:J,zt=v[3],Xt=zt===void 0?b?st:G:zt,Ht=[S,R,I,G].map(function(lt){return $e(lt,t)}),Nt=[X,st,pt,Xt].map(function(lt){return $e(lt,r)}),yt=Ht.slice(),It=Nt.slice();o=ci([yt[0],yt[1]],t),yt[0]=o[0],yt[1]=o[1],l=ci([yt[3],yt[2]],t),yt[3]=l[0],yt[2]=l[1],u=ci([It[0],It[3]],r),It[0]=u[0],It[3]=u[1],c=ci([It[1],It[2]],r),It[1]=c[0],It[2]=c[1];var Rt=s?yt:yt.slice(0,Math.max(i[0],h)),Mt=s?It:It.slice(0,Math.max(i[1],m));return ge(ge([],Rt.map(function(lt,Bt){var O=n0[Bt];return{virtual:Bt>=h,horizontal:kn[Bt],vertical:0,pos:[n+lt,a+(Tn[Bt]===-1?r:0)],sub:!0,raw:Ht[Bt],direction:O}}),!0),Mt.map(function(lt,Bt){var O=n0[Bt];return{virtual:Bt>=m,horizontal:0,vertical:Tn[Bt],pos:[n+(kn[Bt]===-1?t:0),a+lt],sub:!0,raw:Nt[Bt],direction:O}}),!0)}function Wg(e,t,r,n,a){a===void 0&&(a=t.length);var i=oc(e.slice(n)),s=i.horizontalRange,o=i.verticalRange,l=r-n,u=0;if(l===0)u=a;else if(l>0&&l<s[1])u=s[1]-l;else if(l>=o[0])u=o[0]+o[1]-l;else return;e.splice(r,u),t.splice(r,u)}function Xg(e,t,r,n,a,i,s,o,l,u,c){u===void 0&&(u=0),c===void 0&&(c=0);var f=oc(e.slice(r)),d=f.horizontalRange,p=f.verticalRange;if(n>-1)for(var v=kn[n]===1?i-u:o-i,h=d[1];h<=n;++h){var m=Tn[h]===1?c:l,b=0;if(n===h?b=i:h===0?b=u+v:kn[h]===-1&&(b=o-(t[r][0]-u)),e.splice(r+h,0,{horizontal:kn[h],vertical:0,pos:[b,m]}),t.splice(r+h,0,[b,m]),h===0)break}else if(a>-1){var y=Tn[a]===1?s-c:l-s;if(d[1]===0&&p[1]===0){var S=[u+y,c];e.push({horizontal:kn[0],vertical:0,pos:S}),t.push(S)}for(var C=p[0],h=p[1];h<=a;++h){var b=kn[h]===1?u:o,m=0;if(a===h?m=s:h===0?m=c+y:Tn[h]===1?m=t[r+C][1]:Tn[h]===-1&&(m=l-(t[r+C][1]-c)),e.push({horizontal:0,vertical:Tn[h],pos:[b,m]}),t.push([b,m]),h===0)break}}}function Yg(e,t){t===void 0&&(t=e.map(function(a){return a.raw}));var r=e.map(function(a,i){return a.horizontal?t[i]:null}).filter(function(a){return a!=null}),n=e.map(function(a,i){return a.vertical?t[i]:null}).filter(function(a){return a!=null});return{horizontals:r,verticals:n}}var Ug=[[0,-1,"n"],[1,0,"e"]],jg=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function Wo(e,t,r){var n=e.props.clipRelative,a=e.state,i=a.width,s=a.height,o=t,l=o.type,u=o.poses,c=l==="rect",f=l==="circle";if(l==="polygon")return r.map(function(D){return"".concat(Lr(D[0],i,n)," ").concat(Lr(D[1],s,n))});if(c||l==="inset"){var d=r[1][1],p=r[3][0],v=r[7][0],h=r[5][1];if(c)return[d,p,h,v].map(function(D){return"".concat(D,"px")});var m=[d,i-p,s-h,v].map(function(D,I){return Lr(D,I%2?i:s,n)});if(r.length>8){var b=fe(r[4],r[0]),y=b[0],S=b[1];m.push.apply(m,ge(["round"],Go(u.slice(8).map(function(D,I){return it(it({},D),{pos:r[I]})}),n,y,S,v,d,p,h).styles,!1))}return m}else if(f||l==="ellipse"){var C=r[0],R=Lr(Math.abs(r[1][1]-C[1]),f?Math.sqrt((i*i+s*s)/2):s,n),m=f?[R]:[Lr(Math.abs(r[2][0]-C[0]),i,n),R];return m.push("at",Lr(C[0],i,n),Lr(C[1],s,n)),m}}function Mi(e,t,r,n){var a=[n,(n+t)/2,t],i=[e,(e+r)/2,r];return jg.map(function(s){var o=s[0],l=s[1],u=s[2],c=a[o+1],f=i[l+1];return{vertical:Math.abs(l),horizontal:Math.abs(o),direction:u,pos:[c,f]}})}function uc(e){var t=[1/0,-1/0],r=[1/0,-1/0];return e.forEach(function(n){var a=n.pos;t[0]=Math.min(t[0],a[0]),t[1]=Math.max(t[1],a[0]),r[0]=Math.min(r[0],a[1]),r[1]=Math.max(r[1],a[1])}),[Math.abs(t[1]-t[0]),Math.abs(r[1]-r[0])]}function a0(e,t,r,n,a){var i,s,o,l,u,c,f;if(e){var d=a;if(!d){var p=getComputedStyle(e),v=p.clipPath;d=v!=="none"?v:p.clip}if(!((!d||d==="none"||d==="auto")&&(d=n,!d))){var h=H0(d),m=h.prefix,b=m===void 0?d:m,y=h.value,S=y===void 0?"":y,C=b==="circle",R=" ";if(b==="polygon"){var D=Rn(S||"0% 0%, 100% 0%, 100% 100%, 0% 100%");R=",";var I=D.map(function(Qt){var te=Qt.split(" "),Ut=te[0],_e=te[1];return{vertical:1,horizontal:1,pos:[$e(Ut,t),$e(_e,r)]}}),W=pn(I.map(function(Qt){return Qt.pos}));return{type:b,clipText:d,poses:I,splitter:R,left:W.minX,right:W.maxX,top:W.minY,bottom:W.maxY}}else if(C||b==="ellipse"){var G="",F="",X=0,M=0,D=hn(S);if(C){var st="";i=D[0],st=i===void 0?"50%":i,s=D[2],G=s===void 0?"50%":s,o=D[3],F=o===void 0?"50%":o,X=$e(st,Math.sqrt((t*t+r*r)/2)),M=X}else{var J="",pt="";l=D[0],J=l===void 0?"50%":l,u=D[1],pt=u===void 0?"50%":u,c=D[3],G=c===void 0?"50%":c,f=D[4],F=f===void 0?"50%":f,X=$e(J,t),M=$e(pt,r)}var zt=[$e(G,t),$e(F,r)],I=ge([{vertical:1,horizontal:1,pos:zt,direction:"nesw"}],Ug.slice(0,C?1:2).map(function(Ut){return{vertical:Math.abs(Ut[1]),horizontal:Ut[0],direction:Ut[2],sub:!0,pos:[zt[0]+Ut[0]*X,zt[1]+Ut[1]*M]}}),!0);return{type:b,clipText:d,radiusX:X,radiusY:M,left:zt[0]-X,top:zt[1]-M,right:zt[0]+X,bottom:zt[1]+M,poses:I,splitter:R}}else if(b==="inset"){var D=hn(S||"0 0 0 0"),Xt=D.indexOf("round"),Ht=(Xt>-1?D.slice(0,Xt):D).length,Nt=D.slice(Ht+1),yt=D.slice(0,Ht),It=yt[0],Rt=yt[1],Mt=Rt===void 0?It:Rt,lt=yt[2],Bt=lt===void 0?It:lt,O=yt[3],V=O===void 0?Mt:O,_=[It,Bt].map(function(Ut){return $e(Ut,r)}),Y=_[0],ot=_[1],_t=[V,Mt].map(function(Ut){return $e(Ut,t)}),Ct=_t[0],Vt=_t[1],jt=t-Vt,Gt=r-ot,Pt=lc(Nt,jt-Ct,Gt-Y,Ct,Y),I=ge(ge([],Mi(Y,jt,Gt,Ct),!0),Pt,!0);return{type:"inset",clipText:d,poses:I,top:Y,left:Ct,right:jt,bottom:Gt,radius:Nt,splitter:R}}else if(b==="rect"){var D=Rn(S||"0px, ".concat(t,"px, ").concat(r,"px, 0px"));R=",";var de=D.map(function(ht){var Z=Na(ht).value;return Z}),Y=de[0],Vt=de[1],ot=de[2],Ct=de[3],I=Mi(Y,Vt,ot,Ct);return{type:"rect",clipText:d,poses:I,top:Y,right:Vt,bottom:ot,left:Ct,values:D,splitter:R}}}}}function qg(e,t,r,n,a){var i=e[t],s=i.direction,o=i.sub,l=e.map(function(){return[0,0]}),u=s?s.split(""):[];if(n&&t<8){var c=u.filter(function(st){return st==="w"||st==="e"}),f=u.filter(function(st){return st==="n"||st==="s"}),d=c[0],p=f[0];l[t]=r;var v=uc(e),h=v[0],m=v[1],b=h&&m?h/m:0;if(b&&a){var y=(t+4)%8,S=e[y].pos,C=[0,0];s.indexOf("w")>-1?C[0]=-1:s.indexOf("e")>-1&&(C[0]=1),s.indexOf("n")>-1?C[1]=-1:s.indexOf("s")>-1&&(C[1]=1);var R=Vu([h,m],r,b,C,!0),D=h+R[0],I=m+R[1],W=S[1],G=S[1],F=S[0],X=S[0];C[0]===-1?F=X-D:C[0]===1?X=F+D:(F=F-D/2,X=X+D/2),C[1]===-1?W=G-I:(C[1]===1||(W=G-I/2),G=W+I);var M=Mi(W,X,G,F);e.forEach(function(st,J){l[J][0]=M[J].pos[0]-st.pos[0],l[J][1]=M[J].pos[1]-st.pos[1]})}else e.forEach(function(st,J){var pt=st.direction;pt&&(pt.indexOf(d)>-1&&(l[J][0]=r[0]),pt.indexOf(p)>-1&&(l[J][1]=r[1]))}),d&&(l[1][0]=r[0]/2,l[5][0]=r[0]/2),p&&(l[3][1]=r[1]/2,l[7][1]=r[1]/2)}else s&&!o?u.forEach(function(st){var J=st==="n"||st==="s";e.forEach(function(pt,zt){var Xt=pt.direction,Ht=pt.horizontal,Nt=pt.vertical;!Xt||Xt.indexOf(st)===-1||(l[zt]=[J||!Ht?0:r[0],!J||!Nt?0:r[1]])})}):l[t]=r;return l}function Kg(e,t){var r=_u(e,t),n=r[0],a=r[1],i=t.datas,s=i.clipPath,o=i.clipIndex,l=s,u=l.type,c=l.poses,f=l.splitter,d=c.map(function(y){return y.pos});if(u==="polygon")d.splice(o,0,[n,a]);else if(u==="inset"){var p=Hg.indexOf(o),v=Gg.indexOf(o),h=c.length;if(Xg(c,d,8,p,v,n,a,d[4][0],d[4][1],d[0][0],d[0][1]),h===c.length)return}else return;var m=Wo(e,s,d),b="".concat(u,"(").concat(m.join(f),")");le(e,"onClip",Ce(e,t,it({clipEventType:"added",clipType:u,poses:d,clipStyles:m,clipStyle:b,distX:0,distY:0},br({clipPath:b},t))))}function Zg(e,t){var r=t.datas,n=r.clipPath,a=r.clipIndex,i=n,s=i.type,o=i.poses,l=i.splitter,u=o.map(function(p){return p.pos}),c=u.length;if(s==="polygon")o.splice(a,1),u.splice(a,1);else if(s==="inset"){if(a<8||(Wg(o,u,a,8,c),c===o.length))return}else return;var f=Wo(e,n,u),d="".concat(s,"(").concat(f.join(l),")");le(e,"onClip",Ce(e,t,it({clipEventType:"removed",clipType:s,poses:u,clipStyles:f,clipStyle:d,distX:0,distY:0},br({clipPath:d},t))))}var Qg={name:"clippable",props:{clippable:Boolean,defaultClipPath:String,customClipPath:String,keepRatio:Boolean,clipRelative:Boolean,clipArea:Boolean,dragWithClip:Boolean,clipTargetBounds:Boolean,clipVerticalGuidelines:Array,clipHorizontalGuidelines:Array,clipSnapThreshold:Boolean},events:{onClipStart:"clipStart",onClip:"clip",onClipEnd:"clipEnd"},css:[`.control.clip-control {
    background: #6d6;
    cursor: pointer;
}
.control.clip-control.clip-radius {
    background: #d66;
}
.line.clip-line {
    background: #6e6;
    cursor: move;
    z-index: 1;
}
.clip-area {
    position: absolute;
    top: 0;
    left: 0;
}
.clip-ellipse {
    position: absolute;
    cursor: move;
    border: 1px solid #6d6;
    border: var(--zoompx) solid #6d6;
    border-radius: 50%;
    transform-origin: 0px 0px;
}`,`:host {
    --bounds-color: #d66;
}`,`.guideline {
    pointer-events: none;
    z-index: 2;
}`,`.line.guideline.bounds {
    background: #d66;
    background: var(--bounds-color);
}`],render:function(e,t){var r=e.props,n=r.customClipPath,a=r.defaultClipPath,i=r.clipArea,s=r.zoom,o=r.groupable,l=e.getState(),u=l.target,c=l.width,f=l.height,d=l.allMatrix,p=l.is3d,v=l.left,h=l.top,m=l.pos1,b=l.pos2,y=l.pos3,S=l.pos4,C=l.clipPathState,R=l.snapBoundInfos,D=l.rotation;if(!u||o)return[];var I=a0(u,c,f,a||"inset",C||n);if(!I)return[];var W=p?4:3,G=I.type,F=I.poses,X=F.map(function(Gt){var Pt=sr(d,Gt.pos,W);return[Pt[0]-v,Pt[1]-h]}),M=[],st=[],J=G==="rect",pt=G==="inset",zt=G==="polygon";if(J||pt||zt){var Xt=pt?X.slice(0,8):X;st=Xt.map(function(Gt,Pt){var de=Pt===0?Xt[Xt.length-1]:Xt[Pt-1],Qt=Qe(de,Gt),te=Au(de,Gt);return t.createElement("div",{key:"clipLine".concat(Pt),className:pe("line","clip-line","snap-control"),"data-clip-index":Pt,style:{width:"".concat(te,"px"),transform:"translate(".concat(de[0],"px, ").concat(de[1],"px) rotate(").concat(Qt,"rad) scaleY(").concat(s,")")}})})}if(M=X.map(function(Gt,Pt){return t.createElement("div",{key:"clipControl".concat(Pt),className:pe("control","clip-control","snap-control"),"data-clip-index":Pt,style:{transform:"translate(".concat(Gt[0],"px, ").concat(Gt[1],"px) rotate(").concat(D,"rad) scale(").concat(s,")")}})}),pt&&M.push.apply(M,X.slice(8).map(function(Gt,Pt){return t.createElement("div",{key:"clipRadiusControl".concat(Pt),className:pe("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Pt,style:{transform:"translate(".concat(Gt[0],"px, ").concat(Gt[1],"px) rotate(").concat(D,"rad) scale(").concat(s,")")}})})),G==="circle"||G==="ellipse"){var Ht=I.left,Nt=I.top,yt=I.radiusX,It=I.radiusY,Rt=fe(sr(d,[Ht,Nt],W),sr(d,[0,0],W)),Mt=Rt[0],lt=Rt[1],Bt="none";if(!i){for(var O=Math.max(10,yt/5,It/5),V=[],_=0;_<=O;++_){var Y=Math.PI*2/O*_;V.push([yt+(yt-s)*Math.cos(Y),It+(It-s)*Math.sin(Y)])}V.push([yt,-2]),V.push([-2,-2]),V.push([-2,It*2+2]),V.push([yt*2+2,It*2+2]),V.push([yt*2+2,-2]),V.push([yt,-2]),Bt="polygon(".concat(V.map(function(Gt){return"".concat(Gt[0],"px ").concat(Gt[1],"px")}).join(", "),")")}M.push(t.createElement("div",{key:"clipEllipse",className:pe("clip-ellipse","snap-control"),style:{width:"".concat(yt*2,"px"),height:"".concat(It*2,"px"),clipPath:Bt,transform:"translate(".concat(-v+Mt,"px, ").concat(-h+lt,"px) ").concat(Wi(d))}}))}if(i){var ot=Or(ge([m,b,y,S],X,!0)),_t=ot.width,Ct=ot.height,Vt=ot.left,jt=ot.top;if(zt||J||pt){var V=pt?X.slice(0,8):X;M.push(t.createElement("div",{key:"clipArea",className:pe("clip-area","snap-control"),style:{width:"".concat(_t,"px"),height:"".concat(Ct,"px"),transform:"translate(".concat(Vt,"px, ").concat(jt,"px)"),clipPath:"polygon(".concat(V.map(function(Pt){return"".concat(Pt[0]-Vt,"px ").concat(Pt[1]-jt,"px")}).join(", "),")")}}))}}return R&&["vertical","horizontal"].forEach(function(Gt){var Pt=R[Gt],de=Gt==="horizontal";Pt.isSnap&&st.push.apply(st,Pt.snap.posInfos.map(function(Qt,te){var Ut=Qt.pos,_e=fe(sr(d,de?[0,Ut]:[Ut,0],W),[v,h]),$=fe(sr(d,de?[c,Ut]:[Ut,f],W),[v,h]);return Da(t,"",_e,$,s,"clip".concat(Gt,"snap").concat(te),"guideline")})),Pt.isBound&&st.push.apply(st,Pt.bounds.map(function(Qt,te){var Ut=Qt.pos,_e=fe(sr(d,de?[0,Ut]:[Ut,0],W),[v,h]),$=fe(sr(d,de?[c,Ut]:[Ut,f],W),[v,h]);return Da(t,"",_e,$,s,"clip".concat(Gt,"bounds").concat(te),"guideline","bounds","bold")}))}),ge(ge([],M,!0),st,!0)},dragControlCondition:function(e,t){return t.inputEvent&&(t.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(e,t){var r=e.props,n=r.dragWithClip,a=n===void 0?!0:n;return a?!1:this.dragControlStart(e,t)},drag:function(e,t){return this.dragControl(e,it(it({},t),{isDragTarget:!0}))},dragEnd:function(e,t){return this.dragControlEnd(e,t)},dragControlStart:function(e,t){var r=e.state,n=e.props,a=n.defaultClipPath,i=n.customClipPath,s=r.target,o=r.width,l=r.height,u=t.inputEvent?t.inputEvent.target:null,c=u&&u.getAttribute("class")||"",f=t.datas,d=a0(s,o,l,a||"inset",i);if(!d)return!1;var p=d.clipText,v=d.type,h=d.poses,m=le(e,"onClipStart",Ce(e,t,{clipType:v,clipStyle:p,poses:h.map(function(b){return b.pos})}));return m===!1?(f.isClipStart=!1,!1):(f.isControl=c&&c.indexOf("clip-control")>-1,f.isLine=c.indexOf("clip-line")>-1,f.isArea=c.indexOf("clip-area")>-1||c.indexOf("clip-ellipse")>-1,f.clipIndex=u?parseInt(u.getAttribute("data-clip-index"),10):-1,f.clipPath=d,f.isClipStart=!0,r.clipPathState=p,zn(e,t),!0)},dragControl:function(e,t){var r,n,a=t.datas,i=t.originalDatas,s=t.isDragTarget;if(!a.isClipStart)return!1;var o=a,l=o.isControl,u=o.isLine,c=o.isArea,f=o.clipIndex,d=o.clipPath;if(!d)return!1;var p=On(e.props,"clippable"),v=p.keepRatio,h=0,m=0,b=i.draggable,y=Kr(t);s&&b?(r=b.prevBeforeDist,h=r[0],m=r[1]):(h=y[0],m=y[1]);var S=[h,m],C=e.state,R=C.width,D=C.height,I=!c&&!l&&!u,W=d.type,G=d.poses,F=d.splitter,X=G.map(function(tt){return tt.pos});I&&(h=-h,m=-m);var M=!l||G[f].direction==="nesw",st=W==="inset"||W==="rect",J=G.map(function(){return[0,0]});if(l&&!M){var pt=G[f],zt=pt.horizontal,Xt=pt.vertical,Ht=[h*Math.abs(zt),m*Math.abs(Xt)];J=qg(G,f,Ht,st,v)}else M&&(J=X.map(function(){return[h,m]}));var Nt=X.map(function(tt,N){return De(tt,J[N])}),yt=ge([],Nt,!0);C.snapBoundInfos=null;var It=d.type==="circle",Rt=d.type==="ellipse";if(It||Rt){var Mt=Or(Nt),lt=Math.abs(Mt.bottom-Mt.top),Bt=Math.abs(Rt?Mt.right-Mt.left:lt),O=Nt[0][1]+lt,V=Nt[0][0]-Bt,_=Nt[0][0]+Bt;It&&(yt.push([_,Mt.bottom]),J.push([1,0])),yt.push([Mt.left,O]),J.push([0,1]),yt.push([V,Mt.bottom]),J.push([1,0])}var Y=qu((p.clipHorizontalGuidelines||[]).map(function(tt){return $e("".concat(tt),D)}),(p.clipVerticalGuidelines||[]).map(function(tt){return $e("".concat(tt),R)}),R,D),ot=[],_t=[];if(It||Rt)ot=[yt[4][0],yt[2][0]],_t=[yt[1][1],yt[3][1]];else if(st){var Ct=[yt[0],yt[2],yt[4],yt[6]],Vt=[J[0],J[2],J[4],J[6]];ot=Ct.filter(function(tt,N){return Vt[N][0]}).map(function(tt){return tt[0]}),_t=Ct.filter(function(tt,N){return Vt[N][1]}).map(function(tt){return tt[1]})}else ot=yt.filter(function(tt,N){return J[N][0]}).map(function(tt){return tt[0]}),_t=yt.filter(function(tt,N){return J[N][1]}).map(function(tt){return tt[1]});var jt=[0,0],Gt=ql(Y,p.clipTargetBounds&&{left:0,top:0,right:R,bottom:D},ot,_t,5),Pt=Gt.horizontal,de=Gt.vertical,Qt=Pt.offset,te=de.offset;if(Pt.isBound&&(jt[1]+=Qt),de.isBound&&(jt[0]+=te),(Rt||It)&&J[0][0]===0&&J[0][1]===0){var Mt=Or(Nt),Ut=Mt.bottom-Mt.top,_e=Rt?Mt.right-Mt.left:Ut,$=de.isBound?Math.abs(te):de.snapIndex===0?-te:te,ct=Pt.isBound?Math.abs(Qt):Pt.snapIndex===0?-Qt:Qt;_e-=$,Ut-=ct,It&&(Ut=Wu(de,Pt)>0?Ut:_e,_e=Ut);var ht=yt[0];yt[1][1]=ht[1]-Ut,yt[2][0]=ht[0]+_e,yt[3][1]=ht[1]+Ut,yt[4][0]=ht[0]-_e}else if(st&&v&&l){var Z=uc(G),Lt=Z[0],j=Z[1],nt=Lt&&j?Lt/j:0,At=G[f],ft=At.direction||"",kt=yt[1][1],O=yt[5][1],V=yt[7][0],_=yt[3][0];Qt<=te?Qt=te/nt:te=Qt*nt,ft.indexOf("w")>-1?V-=te:ft.indexOf("e")>-1?_-=te:(V+=te/2,_-=te/2),ft.indexOf("n")>-1?kt-=Qt:ft.indexOf("s")>-1?O-=Qt:(kt+=Qt/2,O-=Qt/2);var Q=Mi(kt,_,O,V);yt.forEach(function(z,k){var K;K=Q[k].pos,z[0]=K[0],z[1]=K[1]})}else yt.forEach(function(tt,N){var A=J[N];A[0]&&(tt[0]-=te),A[1]&&(tt[1]-=Qt)});var Ot=Wo(e,d,Nt),at="".concat(W,"(").concat(Ot.join(F),")");if(C.clipPathState=at,It||Rt)ot=[yt[4][0],yt[2][0]],_t=[yt[1][1],yt[3][1]];else if(st){var Ct=[yt[0],yt[2],yt[4],yt[6]];ot=Ct.map(function(N){return N[0]}),_t=Ct.map(function(N){return N[1]})}else ot=yt.map(function(tt){return tt[0]}),_t=yt.map(function(tt){return tt[1]});if(C.snapBoundInfos=ql(Y,p.clipTargetBounds&&{left:0,top:0,right:R,bottom:D},ot,_t,1),b){var rt=C.is3d,g=C.allMatrix,T=rt?4:3,U=jt;s&&(U=[S[0]+jt[0]-y[0],S[1]+jt[1]-y[1]]),b.deltaOffset=ze(g,[U[0],U[1],0,0],T)}return le(e,"onClip",Ce(e,t,it({clipEventType:"changed",clipType:W,poses:Nt,clipStyle:at,clipStyles:Ot,distX:h,distY:m},br((n={},n[W==="rect"?"clip":"clipPath"]=at,n),t)))),!0},dragControlEnd:function(e,t){this.unset(e);var r=t.isDrag,n=t.datas,a=t.isDouble,i=n.isLine,s=n.isClipStart,o=n.isControl;return s?(le(e,"onClipEnd",Rr(e,t,{})),a&&(o?Zg(e,t):i&&Kg(e,t)),a||r):!1},unset:function(e){e.state.clipPathState="",e.state.snapBoundInfos=null}},Jg={name:"originDraggable",props:{originDraggable:Boolean,originRelative:Boolean},events:{onDragOriginStart:"dragOriginStart",onDragOrigin:"dragOrigin",onDragOriginEnd:"dragOriginEnd"},css:[`:host[data-able-origindraggable] .control.origin {
    pointer-events: auto;
}`],dragControlCondition:function(e,t){return t.isRequest?t.requestAble==="originDraggable":or(t.inputEvent.target,pe("origin"))},dragControlStart:function(e,t){var r=t.datas;zn(e,t);var n=Ce(e,t,{dragStart:_r.dragStart(e,new Kn().dragStart([0,0],t))}),a=le(e,"onDragOriginStart",n);return r.startOrigin=e.state.transformOrigin,r.startTargetOrigin=e.state.targetOrigin,r.prevOrigin=[0,0],r.isDragOrigin=!0,a===!1?(r.isDragOrigin=!1,!1):n},dragControl:function(e,t){var r=t.datas,n=t.isPinch,a=t.isRequest;if(!r.isDragOrigin)return!1;var i=Kr(t),s=i[0],o=i[1],l=e.state,u=l.width,c=l.height,f=l.offsetMatrix,d=l.targetMatrix,p=l.is3d,v=e.props.originRelative,h=v===void 0?!0:v,m=p?4:3,b=[s,o];if(a){var y=t.distOrigin;(y[0]||y[1])&&(b=y)}var S=De(r.startOrigin,b),C=De(r.startTargetOrigin,b),R=fe(b,r.prevOrigin),D=Ya(f,d,S,m),I=e.getRect(),W=Or(gn(D,u,c,m)),G=[I.left-W.left,I.top-W.top];r.prevOrigin=b;var F=[Lr(C[0],u,h),Lr(C[1],c,h)].join(" "),X=_r.drag(e,Xa(t,e.state,G,!!n)),M=Ce(e,t,it(it({width:u,height:c,origin:S,dist:b,delta:R,transformOrigin:F,drag:X},br({transformOrigin:F,transform:X.transform},t)),{afterTransform:X.transform}));return le(e,"onDragOrigin",M),M},dragControlEnd:function(e,t){var r=t.datas;return r.isDragOrigin?(le(e,"onDragOriginEnd",Rr(e,t,{})),!0):!1},dragGroupControlCondition:function(e,t){return this.dragControlCondition(e,t)},dragGroupControlStart:function(e,t){var r=this.dragControlStart(e,t);return!!r},dragGroupControl:function(e,t){var r=this.dragControl(e,t);return r?(e.transformOrigin=r.transformOrigin,!0):!1},request:function(e){var t={},r=e.getRect(),n=0,a=0,i=r.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:t}},request:function(o){return"deltaOrigin"in o?(s[0]+=o.deltaOrigin[0],s[1]+=o.deltaOrigin[1]):"origin"in o?(s[0]=o.origin[0]-i[0],s[1]=o.origin[1]-i[1]):("x"in o?n=o.x-r.left:"deltaX"in o&&(n+=o.deltaX),"y"in o?a=o.y-r.top:"deltaY"in o&&(a+=o.deltaY)),{datas:t,distX:n,distY:a,distOrigin:s}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function t2(e,t,r,n){var a=e.filter(function(l){var u=l.virtual,c=l.horizontal;return c&&!u}).length,i=e.filter(function(l){var u=l.virtual,c=l.vertical;return c&&!u}).length,s=-1;if(t===0&&(a===0?s=0:a===1&&(s=1)),t===2&&(a<=2?s=2:a<=3&&(s=3)),t===3&&(i===0?s=4:i<4&&(s=7)),t===1&&(i<=1?s=5:i<=2&&(s=6)),!(s===-1||!e[s].virtual)){var o=e[s];e2(e,s),s<4?o.pos[0]=r:o.pos[1]=n}}function e2(e,t){t<4?e.slice(0,t+1).forEach(function(r){r.virtual=!1}):(e[0].virtual&&(e[0].virtual=!1),e.slice(4,t+1).forEach(function(r){r.virtual=!1}))}function r2(e,t){t<4?e.slice(t,4).forEach(function(r){r.virtual=!0}):e.slice(t).forEach(function(r){r.virtual=!0})}function i0(e,t,r,n,a){n===void 0&&(n=[0,0]);var i=[];return!e||e==="0px"?i=[]:i=hn(e),lc(i,t,r,0,0,n,a)}function s0(e,t,r,n,a){var i=e.state,s=i.width,o=i.height,l=Go(a,e.props.roundRelative,s,o),u=l.raws,c=l.styles,f=l.radiusPoses,d=Yg(f,u),p=d.horizontals,v=d.verticals,h=c.join(" ");i.borderRadiusState=h;var m=Ce(e,t,it({horizontals:p,verticals:v,borderRadius:h,width:s,height:o,delta:n,dist:r},br({borderRadius:h},t)));return le(e,"onRound",m),m}function o0(e){var t=e.getState().style,r=t.borderRadius||"";if(!r&&e.props.groupable){var n=e.getTargets()[0];n&&(r=getComputedStyle(n).borderRadius,t.borderRadius=r)}return r}var n2={name:"roundable",props:{roundable:Boolean,roundRelative:Boolean,minRoundControls:Array,maxRoundControls:Array,roundClickable:Boolean,roundPadding:Number,isDisplayShadowRoundControls:Boolean},events:{onRoundStart:"roundStart",onRound:"round",onRoundEnd:"roundEnd",onRoundGroupStart:"roundGroupStart",onRoundGroup:"roundGroup",onRoundGroupEnd:"roundGroupEnd"},css:[`.control.border-radius {
    background: #d66;
    cursor: pointer;
    z-index: 3;
}`,`.control.border-radius.vertical {
    background: #d6d;
    z-index: 2;
}`,`.control.border-radius.virtual {
    opacity: 0.5;
    z-index: 1;
}`,`:host.round-line-clickable .line.direction {
    cursor: pointer;
}`],className:function(e){var t=e.props.roundClickable;return t===!0||t==="line"?pe("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},render:function(e,t){var r=e.getState(),n=r.target,a=r.width,i=r.height,s=r.allMatrix,o=r.is3d,l=r.left,u=r.top,c=r.borderRadiusState,f=e.props,d=f.minRoundControls,p=d===void 0?[0,0]:d,v=f.maxRoundControls,h=v===void 0?[4,4]:v,m=f.zoom,b=f.roundPadding,y=b===void 0?0:b,S=f.isDisplayShadowRoundControls,C=f.groupable;if(!n)return null;var R=c||o0(e),D=o?4:3,I=i0(R,a,i,p,!0);if(!I)return null;var W=0,G=0,F=C?[0,0]:[l,u];return I.map(function(X,M){var st=X.horizontal,J=X.vertical,pt=X.direction||"",zt=ge([],X.pos,!0);G+=Math.abs(st),W+=Math.abs(J),st&&pt.indexOf("n")>-1&&(zt[1]-=y),J&&pt.indexOf("w")>-1&&(zt[0]-=y),st&&pt.indexOf("s")>-1&&(zt[1]+=y),J&&pt.indexOf("e")>-1&&(zt[0]+=y);var Xt=fe(sr(s,zt,D),F),Ht=X.vertical?W<=h[1]&&(S||!X.virtual):G<=h[0]&&(S||!X.virtual);return t.createElement("div",{key:"borderRadiusControl".concat(M),className:pe("control","border-radius",X.vertical?"vertical":"",X.virtual?"virtual":""),"data-radius-index":M,style:{display:Ht?"block":"none",transform:"translate(".concat(Xt[0],"px, ").concat(Xt[1],"px) scale(").concat(m,")")}})})},dragControlCondition:function(e,t){if(!t.inputEvent||t.isRequest)return!1;var r=t.inputEvent.target.getAttribute("class")||"";return r.indexOf("border-radius")>-1||r.indexOf("moveable-line")>-1&&r.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(e,t){return this.dragControlCondition(e,t)},dragControlStart:function(e,t){var r=t.inputEvent,n=t.datas,a=r.target,i=a.getAttribute("class")||"",s=i.indexOf("border-radius")>-1,o=i.indexOf("moveable-line")>-1&&i.indexOf("moveable-direction")>-1,l=s?parseInt(a.getAttribute("data-radius-index"),10):-1,u=-1;if(o){var c=a.getAttribute("data-line-key")||"";c&&(u=parseInt(c.replace(/render-line-/g,""),10),isNaN(u)&&(u=-1))}if(!s&&!o)return!1;var f=Ce(e,t,{}),d=le(e,"onRoundStart",f);if(d===!1)return!1;n.lineIndex=u,n.controlIndex=l,n.isControl=s,n.isLine=o,zn(e,t);var p=e.props,v=p.roundRelative,h=p.minRoundControls,m=h===void 0?[0,0]:h,b=e.state,y=b.width,S=b.height;n.isRound=!0,n.prevDist=[0,0];var C=o0(e),R=i0(C||"",y,S,m,!0)||[];return n.controlPoses=R,b.borderRadiusState=Go(R,v,y,S).styles.join(" "),f},dragControl:function(e,t){var r=t.datas,n=r.controlPoses;if(!r.isRound||!r.isControl||!n.length)return!1;var a=r.controlIndex,i=Kr(t),s=i[0],o=i[1],l=[s,o],u=fe(l,r.prevDist),c=e.props.maxRoundControls,f=c===void 0?[4,4]:c,d=e.state,p=d.width,v=d.height,h=n[a],m=h.vertical,b=h.horizontal,y=n.map(function(C){var R=C.horizontal,D=C.vertical,I=[R*b*l[0],D*m*l[1]];if(R){if(f[0]===1)return I;if(f[0]<4&&R!==b)return I}else{if(f[1]===0)return I[1]=D*b*l[0]/p*v,I;if(m){if(f[1]===1)return I;if(f[1]<4&&D!==m)return I}}return[0,0]});y[a]=l;var S=n.map(function(C,R){return it(it({},C),{pos:De(C.pos,y[R])})});return a<4?S.slice(0,a+1).forEach(function(C){C.virtual=!1}):S.slice(4,a+1).forEach(function(C){C.virtual=!1}),r.prevDist=[s,o],s0(e,t,l,u,S)},dragControlEnd:function(e,t){var r=e.state;r.borderRadiusState="";var n=t.datas,a=t.isDouble;if(!n.isRound)return!1;var i=n.isControl,s=n.controlIndex,o=n.isLine,l=n.lineIndex,u=n.controlPoses,c=u.filter(function(b){var y=b.virtual;return y}).length,f=e.props.roundClickable,d=f===void 0?!0:f;if(a&&d){if(i&&(d===!0||d==="control"))r2(u,s);else if(o&&(d===!0||d==="line")){var p=_u(e,t),v=p[0],h=p[1];t2(u,l,v,h)}c!==u.filter(function(b){var y=b.virtual;return y}).length&&s0(e,t,[0,0],[0,0],u)}var m=Rr(e,t,{});return le(e,"onRoundEnd",m),r.borderRadiusState="",m},dragGroupControlStart:function(e,t){var r=this.dragControlStart(e,t);if(!r)return!1;var n=e.moveables,a=e.props.targets,i=Vr(e,"roundable",t),s=it({targets:e.props.targets,events:i.map(function(o,l){return it(it({},o),{target:a[l],moveable:n[l],currentTarget:n[l]})})},r);return le(e,"onRoundGroupStart",s),r},dragGroupControl:function(e,t){var r=this.dragControl(e,t);if(!r)return!1;var n=e.moveables,a=e.props.targets,i=Vr(e,"roundable",t),s=it({targets:e.props.targets,events:i.map(function(o,l){return it(it(it({},o),{target:a[l],moveable:n[l],currentTarget:n[l]}),br({borderRadius:r.borderRadius},o))})},r);return le(e,"onRoundGroup",s),s},dragGroupControlEnd:function(e,t){var r=e.moveables,n=e.props.targets,a=Vr(e,"roundable",t);Xi(e,"onRound",function(o){var l=it({targets:e.props.targets,events:a.map(function(u,c){return it(it(it({},u),{target:n[c],moveable:r[c],currentTarget:r[c]}),br({borderRadius:o.borderRadius},u))})},o);le(e,"onRoundGroup",l)});var i=this.dragControlEnd(e,t);if(!i)return!1;var s=it({targets:e.props.targets,events:a.map(function(o,l){var u;return it(it({},o),{target:n[l],moveable:r[l],currentTarget:r[l],lastEvent:(u=o.datas)===null||u===void 0?void 0:u.lastEvent})})},i);return le(e,"onRoundGroupEnd",s),s},unset:function(e){e.state.borderRadiusState=""}};function a2(e,t){var r=t?4:3,n=je(r),a="matrix".concat(t?"3d":"","(").concat(n.join(","),")");return e===a||e==="matrix(1,0,0,1,0,0)"}var cc={isPinch:!0,name:"beforeRenderable",props:{},events:{onBeforeRenderStart:"beforeRenderStart",onBeforeRender:"beforeRender",onBeforeRenderEnd:"beforeRenderEnd",onBeforeRenderGroupStart:"beforeRenderGroupStart",onBeforeRenderGroup:"beforeRenderGroup",onBeforeRenderGroupEnd:"beforeRenderGroupEnd"},dragRelation:"weak",setTransform:function(e,t){var r=e.state,n=r.is3d,a=r.target,i=r.targetMatrix,s=a==null?void 0:a.style.transform,o=n?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(su(i,!0),")"),l=!s||s==="none"?o:s;t.datas.startTransforms=a2(l,n)?[]:hn(l)},resetStyle:function(e){var t=e.datas;t.nextStyle={},t.nextTransforms=e.datas.startTransforms,t.nextTransformAppendedIndexes=[]},fillDragStartParams:function(e,t){return Ce(e,t,{setTransform:function(r){t.datas.startTransforms=ar(r)?r:hn(r)},isPinch:!!t.isPinch})},fillDragParams:function(e,t){return Ce(e,t,{isPinch:!!t.isPinch})},dragStart:function(e,t){this.setTransform(e,t),this.resetStyle(t),le(e,"onBeforeRenderStart",this.fillDragStartParams(e,t))},drag:function(e,t){this.resetStyle(t),le(e,"onBeforeRender",Ce(e,t,{isPinch:!!t.isPinch}))},dragEnd:function(e,t){le(e,"onBeforeRenderEnd",Ce(e,t,{isPinch:!!t.isPinch,isDrag:t.isDrag}))},dragGroupStart:function(e,t){var r=this;this.dragStart(e,t);var n=Vr(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(s,o){var l=a[o];return r.setTransform(l,s),r.resetStyle(s),r.fillDragStartParams(l,s)});le(e,"onBeforeRenderGroupStart",Ce(e,t,{isPinch:!!t.isPinch,targets:e.props.targets,setTransform:function(){},events:i}))},dragGroup:function(e,t){var r=this;this.drag(e,t);var n=Vr(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(s,o){var l=a[o];return r.resetStyle(s),r.fillDragParams(l,s)});le(e,"onBeforeRenderGroup",Ce(e,t,{isPinch:!!t.isPinch,targets:e.props.targets,events:i}))},dragGroupEnd:function(e,t){this.dragEnd(e,t),le(e,"onBeforeRenderGroupEnd",Ce(e,t,{isPinch:!!t.isPinch,isDrag:t.isDrag,targets:e.props.targets}))},dragControlStart:function(e,t){return this.dragStart(e,t)},dragControl:function(e,t){return this.drag(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupControlStart:function(e,t){return this.dragGroupStart(e,t)},dragGroupControl:function(e,t){return this.dragGroup(e,t)},dragGroupControlEnd:function(e,t){return this.dragGroupEnd(e,t)}},fc={name:"renderable",props:{},events:{onRenderStart:"renderStart",onRender:"render",onRenderEnd:"renderEnd",onRenderGroupStart:"renderGroupStart",onRenderGroup:"renderGroup",onRenderGroupEnd:"renderGroupEnd"},dragRelation:"weak",dragStart:function(e,t){le(e,"onRenderStart",Ce(e,t,{isPinch:!!t.isPinch}))},drag:function(e,t){le(e,"onRender",this.fillDragParams(e,t))},dragAfter:function(e,t){if(t.resultCount)return this.drag(e,t)},dragEnd:function(e,t){le(e,"onRenderEnd",this.fillDragEndParams(e,t))},dragGroupStart:function(e,t){le(e,"onRenderGroupStart",Ce(e,t,{isPinch:!!t.isPinch,targets:e.props.targets}))},dragGroup:function(e,t){var r=this,n=Vr(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(s,o){var l=a[o];return r.fillDragParams(l,s)});le(e,"onRenderGroup",Ce(e,t,it(it({isPinch:!!t.isPinch,targets:e.props.targets,transform:ni(t)},br(ai(t))),{events:i})))},dragGroupEnd:function(e,t){var r=this,n=Vr(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(s,o){var l=a[o];return r.fillDragEndParams(l,s)});le(e,"onRenderGroupEnd",Ce(e,t,it({isPinch:!!t.isPinch,isDrag:t.isDrag,targets:e.props.targets,events:i,transform:ni(t)},br(ai(t)))))},dragControlStart:function(e,t){return this.dragStart(e,t)},dragControl:function(e,t){return this.drag(e,t)},dragControlAfter:function(e,t){return this.dragAfter(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupControlStart:function(e,t){return this.dragGroupStart(e,t)},dragGroupControl:function(e,t){return this.dragGroup(e,t)},dragGroupControlEnd:function(e,t){return this.dragGroupEnd(e,t)},fillDragParams:function(e,t){return Ce(e,t,it({isPinch:!!t.isPinch,transform:ni(t)},br(ai(t))))},fillDragEndParams:function(e,t){return Ce(e,t,it({isPinch:!!t.isPinch,isDrag:t.isDrag,transform:ni(t)},br(ai(t))))}};function ya(e,t,r,n,a,i,s){var o=a==="Start",l=e.state.target,u=i.isRequest;if(!l||o&&n.indexOf("Control")>-1&&!u&&e.areaElement===i.inputEvent.target)return!1;var c="".concat(r).concat(n).concat(a),f="".concat(r).concat(n,"Condition"),d=a==="End",p=a==="After",v=o&&(!e.targetGesto||!e.controlGesto||!e.targetGesto.isFlag()||!e.controlGesto.isFlag());v&&e.updateRect(a,!0,!1),i.clientDistX=i.distX,i.clientDistY=i.distY,a===""&&!u&&Ip(e.state,i);var h=ge([],e[t],!0);if(u){var m=i.requestAble;h.some(function(M){return M.name===m})||h.push.apply(h,e.props.ables.filter(function(M){return M.name===m}))}if(!h.length||h.every(function(M){return M.dragRelation}))return!1;var b=ge(ge([cc],h,!0),[fc],!1).filter(function(M){return M[c]}),y=i.datas;v&&b.forEach(function(M){M.unset&&M.unset(e)});var S=i.inputEvent,C;d&&S&&(C=document.elementFromPoint(i.clientX,i.clientY)||S.target);var R=0,D=!1,I=function(){var M;D=!0,(M=i.stop)===null||M===void 0||M.call(i)},W=b.filter(function(M){var st=M.name,J=y[st]||(y[st]={});if(o&&(J.isEventStart=!M[f]||M[f](e,i)),J.isEventStart){var pt=M[c](e,it(it({},i),{stop:I,resultCount:R,datas:J,originalDatas:y,inputTarget:C}));return e._emitter.off(),o&&pt===!1&&(J.isEventStart=!1),R+=pt||J.isEventStart?1:0,pt}return!1}),G=W.length,F=!1;if(D&&(F=!0),!F&&o&&b.length&&!G&&(F=b.filter(function(M){var st=M.name,J=y[st];return J.isEventStart?M.dragRelation!=="strong":!1}).length),(d||F)&&(e.state.gestos={},e.moveables&&e.moveables.forEach(function(M){M.state.gestos={}}),b.forEach(function(M){M.unset&&M.unset(e)})),o&&!F&&!u&&G&&(i==null||i.preventDefault()),e.isUnmounted||F)return!1;if(!o&&G&&!s||d){var X=e.props.flushSync||Tu;X(function(){e.updateRect(d?a:"",!0,!1),e.forceUpdate()})}return!o&&!d&&!p&&G&&!s&&ya(e,t,r,n,a+"After",i),!0}function eo(e){return function(t){var r=e.props.dragTarget,n=t.inputEvent.target,a=e.areaElement;return r&&(n===r||r.contains(n))||n===a||!e.isMoveableElement(n)&&!e.controlBox.getElement().contains(n)||or(n,"moveable-area")||or(n,"moveable-padding")||or(n,"moveable-edgeDraggable")}}function dc(e,t,r){var n=e.controlBox.getElement(),a=[],i=e.props.dragTarget;return a.push(n),(!e.props.dragArea||i)&&a.push(t),Xo(e,a,"targetAbles",r,{dragStart:eo(e),pinchStart:eo(e)})}function Xo(e,t,r,n,a){a===void 0&&(a={});var i=r==="targetAbles",s=e.props,o=s.pinchOutside,l=s.pinchThreshold,u=s.preventClickEventOnDrag,c=s.preventClickDefault,f=s.checkInput,d={preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,container:window,pinchThreshold:l,pinchOutside:o,preventClickEventOnDrag:i?u:!1,preventClickEventOnDragStart:i?c:!1,preventClickEventByCondition:i?null:function(h){return e.controlBox.getElement().contains(h.target)},checkInput:i?f:!1},p=new Hh(t,d),v=n==="Control";return["drag","pinch"].forEach(function(h){["Start","","End"].forEach(function(m){p.on("".concat(h).concat(m),function(b){var y,S=b.eventType;if(a[S]&&!a[S](b)){b.stop();return}var C=ya(e,r,h,n,m,b);C?(e.props.stopPropagation||m==="Start"&&v)&&((y=b==null?void 0:b.inputEvent)===null||y===void 0||y.stopPropagation()):b.stop()})})}),p}var i2=function(){function e(r,n,a){var i=this;this.target=r,this.moveable=n,this.eventName=a,this.ables=[],this._onEvent=function(s){var o=i.eventName,l=i.moveable;l.state.disableNativeEvent||i.ables.forEach(function(u){u[o](l,{inputEvent:s})})},r.addEventListener(a.toLowerCase(),this._onEvent)}var t=e.prototype;return t.setAbles=function(r){this.ables=r},t.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},e}();function s2(e){if(e&&e.getRootNode){var t=e.getRootNode();if(t.nodeType===11)return t}}function l0(e,t,r){for(var n=e,a=[],i=document.documentElement||document.body,s=!r&&e===t||e===i,o=s,l=!1,u=3,c,f,d,p=!1,v=Ta(t,t,!0).offsetParent,h=1;n&&!o;){o=s;var m=getComputedStyle(n),b=m.position,y=Du(n,m),S=bh(yp(y)),C=b==="fixed",R={hasTransform:!1,fixedContainer:null};C&&(p=!0,R=Ep(n),v=R.fixedContainer);var D=S.length;!l&&D===16&&(l=!0,u=4,Us(a),d&&(d=Xr(d,3,4))),l&&D===9&&(S=Xr(S,3,4));var I=Cp(n,e,m),W=I.tagName,G=I.hasOffset,F=I.isSVG,X=I.origin,M=I.targetOrigin,st=I.offset,J=st[0],pt=st[1];W==="svg"&&d&&(a.push({type:"target",target:n,matrix:Mp(n,u)}),a.push({type:"offset",target:n,matrix:je(u)}));var zt=void 0,Xt=!1,Ht=!1,Nt=parseFloat(m.zoom)||1;if(C)zt=R.fixedContainer,Xt=!0;else{var yt=Ta(n,t,!1,!0,m),It=yt.offsetZoom;if(zt=yt.offsetParent,Xt=yt.isEnd,Ht=yt.isStatic,h*=It,It!==1&&Ht)J-=zt.offsetLeft,pt-=zt.offsetTop;else if(rp){var Rt=yt.parentSlotElement;if(Rt){for(var Mt=zt,lt=0,Bt=0;Mt&&s2(Mt);)lt+=Mt.offsetLeft,Bt+=Mt.offsetTop,Mt=Mt.offsetParent;J-=lt,pt-=Bt}}}hu&&!np&&G&&!F&&Ht&&(b==="relative"||b==="static")&&(J-=zt.offsetLeft,pt-=zt.offsetTop,s=s||Xt);var O=0,V=0,_=0,Y=0;if(C)G&&R.hasTransform&&(_=zt.clientLeft,Y=zt.clientTop);else if(G&&v!==zt&&(O=zt.clientLeft,V=zt.clientTop),G&&zt===i){var ot=Ru(n,!1,m);J+=ot[0],pt+=ot[1]}if(a.push({type:"target",target:n,matrix:yi(S,u,X)}),G){var _t=n===e,Ct=_t?0:n.scrollLeft,Vt=_t?0:n.scrollTop;a.push({type:"offset",target:n,matrix:ka([J-Ct+O-_,pt-Vt+V-Y],u)})}else a.push({type:"offset",target:n,origin:X});if(Nt!==1&&a.push({type:"zoom",target:n,matrix:yi(wo([Nt,Nt],u),u,[0,0])}),d||(d=S),c||(c=X),f||(f=M),o||C)break;n=zt,s=Xt,(!r||n===i)&&(o=s)}return d||(d=je(u)),c||(c=[0,0]),f||(f=[0,0]),{zoom:h,offsetContainer:v,matrixes:a,targetMatrix:d,transformOrigin:c,targetOrigin:f,is3d:l,hasFixed:p}}function o2(e,t,r,n){var a;r===void 0&&(r=t);var i=l0(e,t),s=i.matrixes,o=i.is3d,l=i.targetMatrix,u=i.transformOrigin,c=i.targetOrigin,f=i.offsetContainer,d=i.hasFixed,p=i.zoom,v=l0(f,r,!0),h=v.matrixes,m=v.is3d,b=v.offsetContainer,y=v.zoom,S=n,C=4,R=e.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in e,D=l,I=je(C),W=je(C),G=je(C),F=je(C),X=s.length;h.reverse(),s.reverse(),!o&&S&&(D=Xr(D,3,4),Us(s)),!m&&S&&Us(h),h.forEach(function(Ht){W=ze(W,Ht.matrix,C)});var M=r||document.body,st=((a=h[0])===null||a===void 0?void 0:a.target)||Ta(M,M,!0).offsetParent,J=h.slice(1).reduce(function(Ht,Nt){return ze(Ht,Nt.matrix,C)},je(C));s.forEach(function(Ht,Nt){if(X-2===Nt&&(G=I.slice()),X-1===Nt&&(F=I.slice()),!Ht.matrix){var yt=s[Nt+1],It=Tp(Ht,yt,st,C,ze(J,I,C));Ht.matrix=ka(It,C)}I=ze(I,Ht.matrix,C)});var pt=!R&&o;D||(D=je(pt?4:3));var zt=Wi(R&&D.length===16?Xr(D,4,3):D,pt),Xt=W;return W=au(W,C,C),{hasZoom:p!==1||y!==1,hasFixed:d,rootMatrix:W,originalRootMatrix:Xt,beforeMatrix:G,offsetMatrix:F,allMatrix:I,targetMatrix:D,targetTransform:zt,transformOrigin:u,targetOrigin:c,is3d:S,offsetContainer:f,offsetRootContainer:b}}function l2(e,t,r,n){r===void 0&&(r=t);var a=0,i=0,s=0,o={},l=Bu(e);if(e&&(a=l.offsetWidth,i=l.offsetHeight),e){var u=o2(e,t,r,n),c=Un(u.allMatrix,u.transformOrigin,a,i);o=it(it({},u),c);var f=Un(u.allMatrix,[50,50],100,100);s=Iu([f.pos1,f.pos2],f.direction)}var d=4;return it(it(it({hasZoom:!1,width:a,height:i,rotation:s},l),{originalRootMatrix:je(d),rootMatrix:je(d),beforeMatrix:je(d),offsetMatrix:je(d),allMatrix:je(d),targetMatrix:je(d),targetTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!n,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null}),o)}function ro(e,t,r,n,a,i){i===void 0&&(i=[]);var s=1,o=[0,0],l=ii(),u=ii(),c=ii(),f=ii(),d=[0,0],p={},v=l2(t,r,a,!0);if(t){var h=getComputedStyle(t);i.forEach(function(M){p[M]=h[M]});var m=v.is3d?4:3,b=Un(v.offsetMatrix,De(v.transformOrigin,iu(v.targetMatrix,m)),v.width,v.height);s=b.direction,o=De(b.origin,[b.left-v.left,b.top-v.top]),f=pa(v.offsetRootContainer);var y=Ta(n,n,!0).offsetParent||v.offsetRootContainer;if(v.hasZoom){var S=Un(ze(v.originalRootMatrix,v.allMatrix),v.transformOrigin,v.width,v.height),C=Un(v.originalRootMatrix,Si(getComputedStyle(y)).map(function(M){return parseFloat(M)}),y.offsetWidth,y.offsetHeight);if(l=ps(S,f),c=ps(C,f,y,!0),e){var R=S.left,D=S.top;u=ps({left:R,top:D,bottom:D,right:D},f)}}else{l=pa(t),c=pa(y,!0),e&&(u=pa(e));var I=c.left,W=c.top,G=c.clientLeft,F=c.clientTop,X=[l.left-I,l.top-W];d=fe(Bn(v.rootMatrix,X,4),[G+v.left,F+v.top])}}return it({targetClientRect:l,containerClientRect:c,moveableClientRect:u,rootContainerClientRect:f,beforeDirection:s,beforeOrigin:o,originalBeforeOrigin:o,target:t,style:p,offsetDelta:d},v)}function u0(e){var t=e.pos1,r=e.pos2,n=e.pos3,a=e.pos4;if(!t||!r||!n||!a)return null;var i=pn([t,r,n,a]),s=[i.minX,i.minY],o=fe(e.origin,s);return t=fe(t,s),r=fe(r,s),n=fe(n,s),a=fe(a,s),it(it({},e),{left:e.left,top:e.top,posDelta:s,pos1:t,pos2:r,pos3:n,pos4:a,origin:o,beforeOrigin:o,isPersisted:!0})}var Qn=function(e){Ga(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.state=it({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},ro(null)),n.renderState={},n.enabledAbles=[],n.targetAbles=[],n.controlAbles=[],n.rotation=0,n.scale=[1,1],n.isMoveableMounted=!1,n.isUnmounted=!1,n.events={mouseEnter:null,mouseLeave:null},n._emitter=new Ni,n._prevTarget=null,n._prevDragArea=!1,n._isPropTargetChanged=!1,n._hasFirstTarget=!1,n._observer=null,n._observerId=0,n._rootContainer=null,n._viewContainer=null,n._viewClassNames=[],n.checkUpdateRect=function(){if(!n.isDragging()){var a=n.props.parentMoveable;if(a){a.checkUpdateRect();return}Gv(n._observerId),n._observerId=G0(function(){n.isDragging()||n.updateRect()})}},n._onPreventClick=function(a){a.stopPropagation(),a.preventDefault()},n}var r=t.prototype;return r.render=function(){var n=this.props,a=this.getState(),i=n.parentPosition,s=n.className,o=n.target,l=n.zoom,u=n.cspNonce,c=n.translateZ,f=n.cssStyled,d=n.portalContainer,p=n.groupable,v=n.linePadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var h=i||[0,0],m=h[0],b=h[1],y=a.left,S=a.top,C=a.target,R=a.direction,D=a.hasFixed,I=a.offsetDelta,W=n.targets,G=this.isDragging(),F={};this.getEnabledAbles().forEach(function(zt){F["data-able-".concat(zt.name.toLowerCase())]=!0});var X=this._getAbleClassName(),M=W&&W.length&&(C||p)||o||!this._hasFirstTarget&&this.state.isPersisted,st=this.controlBox||this.props.firstRenderState||this.props.persistData,J=[y-m,S-b];!p&&n.useAccuratePosition&&(J[0]+=I[0],J[1]+=I[1]);var pt={position:D?"fixed":"absolute",display:M?"block":"none",visibility:st?"visible":"hidden",transform:"translate3d(".concat(J[0],"px, ").concat(J[1],"px, ").concat(c,")"),"--zoom":l,"--zoompx":"".concat(l,"px")};return v&&(pt["--moveable-line-padding"]=v),Ir(f,it({cspNonce:u,ref:Hr(this,"controlBox"),className:"".concat(pe("control-box",R===-1?"reverse":"",G?"dragging":"")," ").concat(X," ").concat(s)},F,{onClick:this._onPreventClick,portalContainer:d,style:pt}),this.renderAbles(),this._renderLines())},r.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1,this.controlBox.getElement();var n=this.props,a=n.parentMoveable,i=n.container,s=n.wrapperMoveable;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!a&&!s&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},r.componentDidUpdate=function(n){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateEvents(),this._updateTargets(),this.updateCheckInput(),this._updateObserver(n)},r.componentWillUnmount=function(){this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off();var n=this._viewContainer;n&&this._changeAbleViewClassNames([]),Xn(this,"targetGesto"),Xn(this,"controlGesto");var a=this.events;for(var i in a){var s=a[i];s&&s.destroy()}},r.getTargets=function(){var n=this.props.target;return n?[n]:[]},r.getAble=function(n){var a=this.props.ables||[];return en(a,function(i){return i.name===n})},r.getContainer=function(){var n=this.props,a=n.parentMoveable,i=n.wrapperMoveable,s=n.container;return s||i&&i.getContainer()||a&&a.getContainer()||this.controlBox.getElement().parentElement},r.isMoveableElement=function(n){var a;return n&&(((a=n.getAttribute)===null||a===void 0?void 0:a.call(n,"class"))||"").indexOf(ko)>-1},r.dragStart=function(n){var a=this.targetGesto,i=this.controlGesto;return a&&eo(this)({inputEvent:n})?a.isFlag()||a.triggerDragStart(n):i&&this.isMoveableElement(n.target)&&(i.isFlag()||i.triggerDragStart(n)),this},r.hitTest=function(n){var a=this.state,i=a.target,s=a.pos1,o=a.pos2,l=a.pos3,u=a.pos4,c=a.targetClientRect;if(!i)return 0;var f;if(n instanceof Element){var d=n.getBoundingClientRect();f={left:d.left,top:d.top,width:d.width,height:d.height}}else f=it({width:0,height:0},n);var p=f.left,v=f.top,h=f.width,m=f.height,b=Ol([s,o,u,l],c),y=Bh(b,[[p,v],[p+h,v],[p+h,v+m],[p,v+m]]),S=uu(b);return!y||!S?0:Math.min(100,y/S*100)},r.isInside=function(n,a){var i=this.state,s=i.target,o=i.pos1,l=i.pos2,u=i.pos3,c=i.pos4,f=i.targetClientRect;return s?Ls([n,a],Ol([o,l,c,u],f)):!1},r.updateRect=function(n,a,i){i===void 0&&(i=!0);var s=this.props,o=s.parentMoveable,l=this.state,u=l.target||this.props.target,c=this.getContainer(),f=o?o._rootContainer:this._rootContainer,d=ro(this.controlBox&&this.controlBox.getElement(),u,c,c,f||c,this._getRequestStyles());if(!u&&this._hasFirstTarget&&s.persistData){var p=u0(s.persistData);for(var v in p)d[v]=p[v]}this.updateState(d,o?!1:i)},r.isDragging=function(n){var a,i,s=this.targetGesto,o=this.controlGesto;if(s!=null&&s.isFlag()){if(!n)return!0;var l=s.getEventData();return!!(!((a=l[n])===null||a===void 0)&&a.isEventStart)}if(o!=null&&o.isFlag()){if(!n)return!0;var l=o.getEventData();return!!(!((i=l[n])===null||i===void 0)&&i.isEventStart)}return!1},r.updateTarget=function(n){this.updateRect(n,!0)},r.getRect=function(){var n=this.state,a=Cr(this.state),i=a[0],s=a[1],o=a[2],l=a[3],u=Or(a),c=n.width,f=n.height,d=u.width,p=u.height,v=u.left,h=u.top,m=[n.left,n.top],b=De(m,n.origin),y=De(m,n.beforeOrigin),S=n.transformOrigin;return{width:d,height:p,left:v,top:h,pos1:i,pos2:s,pos3:o,pos4:l,offsetWidth:c,offsetHeight:f,beforeOrigin:y,origin:b,transformOrigin:S,rotation:this.getRotation()}},r.getManager=function(){return this},r.stopDrag=function(n){var a,i;(!n||n==="target")&&((a=this.targetGesto)===null||a===void 0||a.stop()),(!n||n==="control")&&((i=this.controlGesto)===null||i===void 0||i.stop())},r.getRotation=function(){var n=this.state,a=n.pos1,i=n.pos2,s=n.direction;return Fp(a,i,s)},r.request=function(n,a,i){a===void 0&&(a={});var s=this.props,o=s.ables,l=s.groupable,u=o.filter(function(m){return m.name===n})[0];if(this.isDragging()||!u||!u.request)return{request:function(){return this},requestEnd:function(){return this}};var c=this,f=u.request(this),d=i||a.isInstant,p=f.isControl?"controlAbles":"targetAbles",v="".concat(l?"Group":"").concat(f.isControl?"Control":""),h={request:function(m){return ya(c,p,"drag",v,"",it(it({},f.request(m)),{requestAble:n,isRequest:!0}),d),this},requestEnd:function(){return ya(c,p,"drag",v,"End",it(it({},f.requestEnd()),{requestAble:n,isRequest:!0}),d),this}};return ya(c,p,"drag",v,"Start",it(it({},f.requestStart(a)),{requestAble:n,isRequest:!0}),d),d?h.request(a).requestEnd():h},r.destroy=function(){this.componentWillUnmount()},r.updateRenderPoses=function(){var n=this.getState(),a=this.props,i=n.originalBeforeOrigin,s=n.transformOrigin,o=n.allMatrix,l=n.is3d,u=n.pos1,c=n.pos2,f=n.pos3,d=n.pos4,p=n.left,v=n.top,h=n.isPersisted,m=a.padding||{},b=m.left,y=b===void 0?0:b,S=m.top,C=S===void 0?0:S,R=m.bottom,D=R===void 0?0:R,I=m.right,W=I===void 0?0:I,G=l?4:3,F=[];h?F=s:this.controlBox&&a.groupable?F=i:F=De(i,[p,v]),n.renderPoses=[De(u,oi(o,[-y,-C],s,F,G)),De(c,oi(o,[W,-C],s,F,G)),De(f,oi(o,[-y,D],s,F,G)),De(d,oi(o,[W,D],s,F,G))]},r.checkUpdate=function(){this._isPropTargetChanged=!1;var n=this.props,a=n.target,i=n.container,s=n.parentMoveable,o=this.state,l=o.target,u=o.container;if(!(!l&&!a)){this.updateAbles();var c=!js(l,a),f=c||!js(u,i);if(f){var d=i||this.controlBox;d&&this.unsetAbles(),this.updateState({target:a,container:i}),!s&&d&&this.updateRect("End",!1,!1),this._isPropTargetChanged=c}}},r.waitToChangeTarget=function(){return new Promise(function(){})},r.triggerEvent=function(n,a){this._emitter.trigger(n,a);var i=this.props[n];return i&&i(a)},r.useCSS=function(n,a){var i=this.props.customStyledMap,s=n+a;return i[s]||(i[s]=vu(n,a)),i[s]},r.getState=function(){var n,a=this.props;(a.target||!((n=a.targets)===null||n===void 0)&&n.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,s=a.persistData,o=a.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&s){var l=u0(s);if(l)return this.updateState(l,!1),this.state}return this.state.isPersisted=!1,this.state},r.updateSelectors=function(){},r.unsetAbles=function(){var n=this;this.targetAbles.forEach(function(a){a.unset&&a.unset(n)})},r.updateAbles=function(n,a){n===void 0&&(n=this.props.ables),a===void 0&&(a="");var i=this.props,s=i.triggerAblesSimultaneously,o=this.getEnabledAbles(n),l="drag".concat(a,"Start"),u="pinch".concat(a,"Start"),c="drag".concat(a,"ControlStart"),f=si(o,[l,u],s),d=si(o,[c],s);this.enabledAbles=o,this.targetAbles=f,this.controlAbles=d},r.updateState=function(n,a){if(a){if(this.isUnmounted)return;this.setState(n)}else{var i=this.state;for(var s in n)i[s]=n[s]}},r.getEnabledAbles=function(n){n===void 0&&(n=this.props.ables);var a=this.props;return n.filter(function(i){return i&&(i.always&&a[i.name]!==!1||a[i.name])})},r.renderAbles=function(){var n=this,a=this.props,i=a.triggerAblesSimultaneously,s={createElement:Ir};return this.renderState={},Bp(Nu(si(this.getEnabledAbles(),["render"],i).map(function(o){var l=o.render;return l(n,s)||[]})).filter(function(o){return o}),function(o){var l=o.key;return l}).map(function(o){return o[0]})},r.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},r._getRequestStyles=function(){var n=this.getEnabledAbles().reduce(function(a,i){var s,o,l=(o=(s=i.requestStyle)===null||s===void 0?void 0:s.call(i))!==null&&o!==void 0?o:[];return ge(ge([],a,!0),l,!0)},[]);return n},r._updateObserver=function(n){var a,i=this.props,s=i.target;if(!window.ResizeObserver||!s||!i.useResizeObserver){(a=this._observer)===null||a===void 0||a.disconnect();return}if(!(n.target===s&&this._observer)){var o=new ResizeObserver(this.checkUpdateRect);o.observe(s,{box:"border-box"}),this._observer=o}},r._updateEvents=function(){var n=this.controlBox.getElement(),a=this.targetAbles.length,i=this.controlAbles.length,s=this.props,o=s.dragTarget||s.target,l=!a&&this.targetGesto||this._isTargetChanged(!0);l&&(Xn(this,"targetGesto"),this.updateState({gesto:null})),i||Xn(this,"controlGesto"),o&&a&&!this.targetGesto&&(this.targetGesto=dc(this,o,"")),!this.controlGesto&&i&&(this.controlGesto=Xo(this,n,"controlAbles","Control"))},r._updateTargets=function(){var n=this.props;this._prevTarget=n.dragTarget||n.target,this._prevDragArea=n.dragArea},r._renderLines=function(){var n=this.props,a=n,i=a.zoom,s=a.hideDefaultLines,o=a.hideChildMoveableDefaultLines,l=a.parentMoveable;if(s||l&&o)return[];var u=this.getState().renderPoses,c={createElement:Ir};return[[0,1],[1,3],[3,2],[2,0]].map(function(f,d){var p=f[0],v=f[1];return Da(c,"",u[p],u[v],i,"render-line-".concat(d))})},r._isTargetChanged=function(n){var a=this.props,i=a.dragTarget||a.target,s=this._prevTarget,o=this._prevDragArea,l=a.dragArea,u=!l&&s!==i,c=(n||l)&&o!==l;return u||c},r._updateNativeEvents=function(){var n=this,a=this.props,i=a.dragArea?this.areaElement:this.state.target,s=this.events,o=aa(s);if(this._isTargetChanged())for(var l in s){var u=s[l];u&&u.destroy(),s[l]=null}if(i){var c=this.enabledAbles;o.forEach(function(f){var d=si(c,[f]),p=d.length>0,v=s[f];if(!p){v&&(v.destroy(),s[f]=null);return}v||(v=new i2(i,n,f),s[f]=v),v.setAbles(d)})}},r._checkUpdateRootContainer=function(){var n=this.props.rootContainer;!this._rootContainer&&n&&(this._rootContainer=Pn(n,!0))},r._checkUpdateViewContainer=function(){var n=this.props.viewContainer;!this._viewContainer&&n&&(this._viewContainer=Pn(n,!0));var a=this._viewContainer;a&&this._changeAbleViewClassNames(ge(ge([],this._getAbleViewClassNames(),!0),[this.isDragging()?Fg:""],!1))},r._changeAbleViewClassNames=function(n){var a=this._viewContainer,i=zu(n.filter(Boolean),function(c){return c}).map(function(c){var f=c[0];return f}),s=this._viewClassNames,o=Fa(s,i),l=o.removed,u=o.added;l.forEach(function(c){X0(a,s[c])}),u.forEach(function(c){W0(a,i[c])}),this._viewClassNames=i},r._getAbleViewClassNames=function(){var n=this;return(this.getEnabledAbles().map(function(a){var i;return((i=a.viewClassName)===null||i===void 0?void 0:i.call(a,n))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},r._getAbleClassName=function(n){var a=this;n===void 0&&(n="");var i=this.getEnabledAbles(),s=this.targetGesto,o=this.controlGesto,l=s!=null&&s.isFlag()?s.getEventData():{},u=o!=null&&o.isFlag()?o.getEventData():{};return i.map(function(c){var f,d,p,v=c.name,h=((f=c.className)===null||f===void 0?void 0:f.call(c,a))||"";return(!((d=l[v])===null||d===void 0)&&d.isEventStart||!((p=u[v])===null||p===void 0)&&p.isEventStart)&&(h+=" ".concat(pe("".concat(v).concat(n,"-dragging")))),h.trim()}).filter(Boolean).join(" ")},t.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,portalContainer:null,useResizeObserver:!1,linePadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Tu,firstRenderState:null,persistData:null,viewContainer:null,useAccuratePosition:!1},t}(xo),Yo={name:"groupable",props:{defaultGroupRotate:Number,defaultGroupOrigin:String,groupable:Boolean,groupableProps:Object,targetGroups:Object,hideChildMoveableDefaultLines:Boolean},events:{},render:function(e,t){var r,n=e.props,a=n.targets||[];e.moveables=[];var i=e.getState(),s=i.left,o=i.top,l=i.isPersisted,u=[s,o],c=n.zoom||1,f=e.renderGroupRects,d=((r=n.persistData)===null||r===void 0?void 0:r.children)||[];return l?a=d.map(function(){return null}):d=[],ge(ge([],a.map(function(p,v){return t.createElement(Qn,{key:"moveable"+v,ref:N0(e,"moveables",v),target:p,origin:!1,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:e,parentPosition:u,persistData:d[v],zoom:c})}),!0),Nu(f.map(function(p,v){var h=p.pos1,m=p.pos2,b=p.pos3,y=p.pos4,S=[h,m,b,y];return[[0,1],[1,3],[3,2],[2,0]].map(function(C,R){var D=C[0],I=C[1];return Da(t,"",fe(S[D],u),fe(S[I],u),c,"group-rect-".concat(v,"-").concat(R))})})),!0)}},u2=Wa("clickable",{props:{clickable:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(e,t){t.datas.inputTarget=t.inputEvent&&t.inputEvent.target},dragEnd:function(e,t){var r=e.props.target,n=t.inputEvent,a=t.inputTarget,i=e.isMoveableElement(a),s=!i&&e.controlBox.getElement().contains(a);if(!(!n||!a||t.isDrag||e.isMoveableElement(a)||s)){var o=r.contains(a);le(e,"onClick",Ce(e,t,{isDouble:t.isDouble,inputTarget:a,isTarget:r===a,moveableTarget:e.props.target,containsTarget:o}))}},dragGroupEnd:function(e,t){var r=t.inputEvent,n=t.inputTarget;if(!(!r||!n||t.isDrag||e.isMoveableElement(n)||t.datas.inputTarget===n)){var a=e.props.targets,i=a.indexOf(n),s=i>-1,o=!1;i===-1&&(i=tn(a,function(l){return l.contains(n)}),o=i>-1),le(e,"onClickGroup",Ce(e,t,{isDouble:t.isDouble,targets:a,inputTarget:n,targetIndex:i,isTarget:s,containsTarget:o,moveableTarget:a[i]}))}},dragControlEnd:function(e,t){this.dragEnd(e,t)},dragGroupControlEnd:function(e,t){this.dragEnd(e,t)}});function Vn(e){var t=e.originalDatas.draggable;return t||(e.originalDatas.draggable={},t=e.originalDatas.draggable),it(it({},e),{datas:t})}var c2=Wa("edgeDraggable",{css:[`.edge.edgeDraggable.line {
    cursor: move;
}`],render:function(e,t){var r=e.props,n=r.edgeDraggable;return n?tc(t,"edgeDraggable",n,e.getState().renderPoses,r.zoom):[]},dragCondition:function(e,t){var r,n=e.props,a=(r=t.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!a?!1:!n.draggable&&or(a,pe("direction"))&&or(a,pe("edge"))&&or(a,pe("edgeDraggable"))},dragStart:function(e,t){return _r.dragStart(e,Vn(t))},drag:function(e,t){return _r.drag(e,Vn(t))},dragEnd:function(e,t){return _r.dragEnd(e,Vn(t))},dragGroupCondition:function(e,t){var r,n=e.props,a=(r=t.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!a?!1:!n.draggable&&or(a,pe("direction"))&&or(a,pe("line"))},dragGroupStart:function(e,t){return _r.dragGroupStart(e,Vn(t))},dragGroup:function(e,t){return _r.dragGroup(e,Vn(t))},dragGroupEnd:function(e,t){return _r.dragGroupEnd(e,Vn(t))},unset:function(e){return _r.unset(e)}}),vc={name:"individualGroupable",props:{individualGroupable:Boolean},events:{}},Uo=[cc,sc,kg,Vp,_r,c2,Js,Ig,Pg,Bg,Vg,$g,zg,Jg,Qg,n2,Yo,vc,u2,ic,fc],f2=Uo.reduce(function(e,t){return it(it({},e),"events"in t?t.events:{})},{}),d2=Uo.reduce(function(e,t){return it(it({},e),t.props)},{}),v2=Op(f2),h2=Object.keys(v2),p2=Object.keys(d2);function c0(e,t){var r=e[0],n=e[1],a=e[2];return(r*t[0]+n*t[1]+a)/Math.sqrt(r*r+n*n)}function fi(e,t){var r=e[0],n=e[1];return-r*t[0]-n*t[1]}function f0(e,t){return Math.max.apply(Math,e.map(function(r){var n=r[0],a=r[1],i=r[2],s=r[3];return Math.max(n[t],a[t],i[t],s[t])}))}function d0(e,t){return Math.min.apply(Math,e.map(function(r){var n=r[0],a=r[1],i=r[2],s=r[3];return Math.min(n[t],a[t],i[t],s[t])}))}function g2(e,t){var r,n=[0,0],a=[0,0],i=[0,0],s=[0,0],o=0,l=0;if(!e.length)return{pos1:n,pos2:a,pos3:i,pos4:s,minX:0,minY:0,maxX:0,maxY:0,width:o,height:l,rotation:t};var u=we(t,xr);if(u%90){var c=u/180*Math.PI,f=Math.tan(c),d=-1/f,p=[Xs,zl],v=[[0,0],[0,0]],h=[Xs,zl],m=[[0,0],[0,0]];e.forEach(function(Nt){Nt.forEach(function(yt){var It=c0([-f,1,0],yt),Rt=c0([-d,1,0],yt);p[0]>It&&(v[0]=yt,p[0]=It),p[1]<It&&(v[1]=yt,p[1]=It),h[0]>Rt&&(m[0]=yt,h[0]=Rt),h[1]<Rt&&(m[1]=yt,h[1]=Rt)})});var b=v[0],y=v[1],S=m[0],C=m[1],R=[-f,1,fi([-f,1],b)],D=[-f,1,fi([-f,1],y)],I=[-d,1,fi([-d,1],S)],W=[-d,1,fi([-d,1],C)];r=[[R,I],[R,W],[D,I],[D,W]].map(function(Nt){var yt=Nt[0],It=Nt[1];return Mo(yt,It)[0]}),n=r[0],a=r[1],i=r[2],s=r[3],o=h[1]-h[0],l=p[1]-p[0]}else{var G=d0(e,0),F=d0(e,1),X=f0(e,0),M=f0(e,1);if(n=[G,F],a=[X,F],i=[G,M],s=[X,M],o=X-G,l=M-F,u%180){var st=[i,n,s,a];n=st[0],a=st[1],i=st[2],s=st[3],o=M-F,l=X-G}}if(u%360>180){var st=[s,i,a,n];n=st[0],a=st[1],i=st[2],s=st[3]}var J=pn([n,a,i,s]),pt=J.minX,zt=J.minY,Xt=J.maxX,Ht=J.maxY;return{pos1:n,pos2:a,pos3:i,pos4:s,width:o,height:l,minX:pt,minY:zt,maxX:Xt,maxY:Ht,rotation:t}}function hc(e,t){var r=t.map(function(n){if(ar(n)){var a=hc(e,n),i=a.length;return i>1?a:i===1?a[0]:null}else{var s=en(e,function(o){var l=o.manager;return l.props.target===n});return s?(s.finded=!0,s.manager):null}}).filter(Boolean);return r.length===1&&ar(r[0])?r[0]:r}var m2=function(e){Ga(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.differ=new lu,n.moveables=[],n.transformOrigin="50% 50%",n.renderGroupRects=[],n._targetGroups=[],n._hasFirstTargets=!1,n}var r=t.prototype;return r.componentDidMount=function(){e.prototype.componentDidMount.call(this)},r.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},r.getTargets=function(){return this.props.targets},r.updateRect=function(n,a,i){var s;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;this.moveables.forEach(function(_){_.updateRect(n,!1,!1)});var l=this.props,u=this.moveables,c=o.target||l.target,f=u.map(function(_){return{finded:!1,manager:_}}),d=this.props.targetGroups||[],p=hc(f,d);p.push.apply(p,f.filter(function(_){var Y=_.finded;return!Y}).map(function(_){var Y=_.manager;return Y}));var v=[],h=!a||n!==""&&l.updateGroup,m=l.defaultGroupRotate||0;if(!this._hasFirstTargets){var b=(s=this.props.persistData)===null||s===void 0?void 0:s.rotation;b!=null&&(m=b)}function y(_,Y,ot){var _t=_.map(function(Qt){if(ar(Qt)){var te=y(Qt,Y),Ut=[te.pos1,te.pos2,te.pos3,te.pos4];return v.push(te),{poses:Ut,rotation:te.rotation}}else return{poses:Cr(Qt.state),rotation:Qt.getRotation()}}),Ct=_t.map(function(Qt){var te=Qt.rotation;return te}),Vt=0,jt=Ct[0],Gt=Ct.every(function(Qt){return Math.abs(jt-Qt)<.1});h?Vt=Gt?jt:m:Vt=!ot&&Gt?jt:Y;var Pt=_t.map(function(Qt){var te=Qt.poses;return te}),de=g2(Pt,Vt);return de}var S=y(p,this.rotation,!0);h&&(this.rotation=S.rotation,this.transformOrigin=l.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=d,this.renderGroupRects=v;var C=this.transformOrigin,R=this.rotation,D=this.scale,I=S.width,W=S.height,G=S.minX,F=S.minY,X=Np([[0,0],[I,0],[0,W],[I,W]],zp(C,I,W),this.rotation/180*Math.PI),M=pn(X.result),st=M.minX,J=M.minY,pt=" rotate(".concat(R,"deg)")+" scale(".concat(D[0]>=0?1:-1,", ").concat(D[1]>=0?1:-1,")"),zt="translate(".concat(-st,"px, ").concat(-J,"px)").concat(pt);this.controlBox.getElement().style.transform="translate3d(".concat(G,"px, ").concat(F,"px, ").concat(this.props.translateZ||0,")"),c.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(C,";")+"width:".concat(I,"px;height:").concat(W,"px;")+"transform: ".concat(zt),o.width=I,o.height=W;var Xt=this.getContainer(),Ht=ro(this.controlBox.getElement(),c,this.controlBox.getElement(),this.getContainer(),this._rootContainer||Xt,[]),Nt=[Ht.left,Ht.top],yt=Cr(Ht),It=yt[0],Rt=yt[1],Mt=yt[2],lt=yt[3],Bt=pn([It,Rt,Mt,lt]),O=[Bt.minX,Bt.minY],V=D[0]*D[1]>0?1:-1;Ht.pos1=fe(It,O),Ht.pos2=fe(Rt,O),Ht.pos3=fe(Mt,O),Ht.pos4=fe(lt,O),Ht.left=G-Ht.left+O[0],Ht.top=F-Ht.top+O[1],Ht.origin=fe(De(Nt,Ht.origin),O),Ht.beforeOrigin=fe(De(Nt,Ht.beforeOrigin),O),Ht.originalBeforeOrigin=De(Nt,Ht.originalBeforeOrigin),Ht.transformOrigin=fe(De(Nt,Ht.transformOrigin),O),c.style.transform="translate(".concat(-st-O[0],"px, ").concat(-J-O[1],"px)")+pt,this.updateState(it(it({},Ht),{posDelta:O,direction:V,beforeDirection:V}),i)},r.getRect=function(){return it(it({},e.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},r.triggerEvent=function(n,a,i){if(i||n.indexOf("Group")>-1)return e.prototype.triggerEvent.call(this,n,a);this._emitter.trigger(n,a)},r.updateAbles=function(){e.prototype.updateAbles.call(this,ge(ge([],this.props.ables,!0),[Yo],!1),"Group")},r._updateTargets=function(){e.prototype._updateTargets.call(this),this._prevTarget=this.props.dragTarget||this.areaElement},r._updateEvents=function(){var n=this.state,a=this.props,i=this._prevTarget,s=a.dragTarget||this.areaElement;i!==s&&(Xn(this,"targetGesto"),Xn(this,"controlGesto"),n.target=null),n.target||(n.target=this.areaElement,this.controlBox.getElement().style.display="block"),n.target&&(this.targetGesto||(this.targetGesto=dc(this,s,"Group")),this.controlGesto||(this.controlGesto=Xo(this,this.controlBox.getElement(),"controlAbles","GroupControl")));var o=!js(n.container,a.container);o&&(n.container=a.container);var l=a.targets,u=this.differ.update(l),c=u.added,f=u.changed,d=u.removed,p=c.length||d.length;(o||p||this.transformOrigin!==(a.defaultGroupOrigin||"50% 50%")||f.length||l.length&&!Hu(this._targetGroups,a.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},r._updateObserver=function(){},t.defaultProps=it(it({},Qn.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),t}(Qn),_2=function(e){Ga(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.moveables=[],n}var r=t.prototype;return r.render=function(){var n=this,a,i=this.props,s=i.cspNonce,o=i.cssStyled,l=i.persistData,u=i.targets||[],c=u.length,f=this.isUnmounted||!c,d=(a=l==null?void 0:l.children)!==null&&a!==void 0?a:[];return f&&!c&&d.length?u=d.map(function(){return null}):f||(d=[]),Ir(o,{cspNonce:s,ref:Hr(this,"controlBox"),className:pe("control-box")},u.map(function(p,v){return Ir(Qn,it({key:"moveable"+v,ref:N0(n,"moveables",v)},n.props,{target:p,wrapperMoveable:n,isWrapperMounted:n.isMoveableMounted,persistData:d[v]}))}))},r.componentDidUpdate=function(){},r.getTargets=function(){return this.props.targets},r.updateRect=function(n,a,i){i===void 0&&(i=!0),this.moveables.forEach(function(s){s.updateRect(n,a,i)})},r.getRect=function(){return it(it({},e.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},r.request=function(){return{request:function(){return this},requestEnd:function(){return this}}},r.dragStart=function(){return this},r.hitTest=function(){return 0},r.isInside=function(){return!1},r.isDragging=function(){return!1},r.updateRenderPoses=function(){},r.checkUpdate=function(){},r.triggerEvent=function(){},r.updateAbles=function(){},r._updateEvents=function(){},r._updateObserver=function(){},t}(Qn);function pc(e,t){var r=[];return e.forEach(function(n){if(n){if(Dr(n)){t[n]&&r.push.apply(r,t[n]);return}ar(n)?r.push.apply(r,pc(n,t)):r.push(n)}}),r}function gc(e,t){var r=[];return e.forEach(function(n){if(n){if(Dr(n)){t[n]&&r.push.apply(r,t[n]);return}ar(n)?r.push(gc(n,t)):r.push(n)}}),r}function mc(e,t){return e.length!==t.length||e.some(function(r,n){var a=t[n];return!r&&!a?!1:r!=a?ar(r)&&ar(a)?mc(r,a):!0:!1})}var b2=function(e){Ga(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.refTargets=[],n.selectorMap={},n._differ=new lu,n._elementTargets=[],n._onChangeTargets=null,n}var r=t.prototype;return t.makeStyled=function(){var n={},a=this.getTotalAbles();a.forEach(function(s){var o=s.css;o&&o.forEach(function(l){n[l]=!0})});var i=aa(n).join(`
`);this.defaultStyled=vu("div",Cv(ko,ap+i))},t.getTotalAbles=function(){return ge([sc,Yo,vc,ic],this.defaultAbles,!0)},r.render=function(){var n,a=this.constructor;a.defaultStyled||a.makeStyled();var i=this.props,s=i.ables,o=i.props,l=Qh(i,["ables","props"]),u=this._updateRefs(!0),c=pc(u,this.selectorMap),f=c.length>1,d=a.getTotalAbles(),p=ge(ge([],d,!0),s||[],!0),v=it(it(it({},l),o||{}),{ables:p,cssStyled:a.defaultStyled,customStyledMap:a.customStyledMap});this._elementTargets=c;var h=null,m=this.moveable,b=l.persistData;if(b!=null&&b.children&&(f=!0),f){if(l.individualGroupable)return Ir(_2,it({key:"individual-group",ref:Hr(this,"moveable")},v,{target:null,targets:c}));var y=gc(u,this.selectorMap);if(m&&!m.props.groupable&&!m.props.individualGroupable){var S=m.props.target;S&&c.indexOf(S)>-1&&(h=it({},m.state))}return Ir(m2,it({key:"group",ref:Hr(this,"moveable")},v,(n=l.groupableProps)!==null&&n!==void 0?n:{},{target:null,targets:c,targetGroups:y,firstRenderState:h}))}else{var C=c[0];if(m&&(m.props.groupable||m.props.individualGroupable)){var R=m.moveables||[],D=en(R,function(I){return I.props.target===C});D&&(h=it({},D.state))}return Ir(Qn,it({key:"single",ref:Hr(this,"moveable")},v,{target:C,firstRenderState:h}))}},r.componentDidMount=function(){this._checkChangeTargets(),this._updateRefs()},r.componentDidUpdate=function(){this._checkChangeTargets()},r.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},r.getTargets=function(){var n,a;return(a=(n=this.moveable)===null||n===void 0?void 0:n.getTargets())!==null&&a!==void 0?a:[]},r.updateSelectors=function(){this.selectorMap={},this._updateRefs()},r.waitToChangeTarget=function(){var n=this,a;return this._onChangeTargets=function(){n._onChangeTargets=null,a()},new Promise(function(i){a=i})},r.waitToChangeTargets=function(){return this.waitToChangeTarget()},r.getManager=function(){return this.moveable},r._updateRefs=function(n){var a=this.refTargets,i=Lo(this.props.target||this.props.targets),s=typeof document<"u",o=mc(a,i),l=this.selectorMap,u={};return this.refTargets.forEach(function c(f){if(Dr(f)){var d=l[f];d?u[f]=l[f]:s&&(o=!0,u[f]=[].slice.call(document.querySelectorAll(f)))}else ar(f)&&f.forEach(c)}),this.refTargets=i,this.selectorMap=u,!n&&o&&this.forceUpdate(),i},r._checkChangeTargets=function(){var n,a,i,s=this._differ.update(this._elementTargets),o=s.added,l=s.removed,u=o.length||l.length;u&&((a=(n=this.props).onChangeTargets)===null||a===void 0||a.call(n,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this)),this._updateRefs()},t.defaultAbles=[],t.customStyledMap={},t.defaultStyled=null,Jh([Ev(mu)],t.prototype,"moveable",void 0),t}(xo),x2=function(e){Ga(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.defaultAbles=Uo,t}(b2),y2=x2;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var no=function(e,t){return no=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},no(e,t)};function jo(e,t){no(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ra=function(){return Ra=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ra.apply(this,arguments)};function S2(e,t,r,n){var a=arguments.length,i=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(i=(a<3?s(i):a>3?s(t,r,i):s(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}var w2=function(e){jo(t,e);function t(n){var a=e.call(this,n)||this;return a.state={},a.state=a.props,a}var r=t.prototype;return r.render=function(){return oh(Ir(y2,Ra({ref:Hr(this,"moveable")},this.state)),this.state.parentElement)},t}(bo),ki=p2,_c=mu,bc=h2,C2=function(e){jo(t,e);function t(n,a){a===void 0&&(a={});var i=e.call(this)||this;i.tempElement=document.createElement("div");var s=Ra({},a),o={};bc.forEach(function(u){o[Hv("on ".concat(u))]=function(c){return i.trigger(u,c)}}),Bl(Ir(w2,Ra({ref:Hr(i,"innerMoveable"),parentElement:n},s,o)),i.tempElement);var l=s.target;return ar(l)&&l.length>1&&i.updateRect(),i}var r=t.prototype;return r.setState=function(n,a){this.innerMoveable.setState(n,a)},r.forceUpdate=function(n){this.innerMoveable.forceUpdate(n)},r.dragStart=function(n){var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(n)},r.destroy=function(){Bl(null,this.tempElement),this.off(),this.tempElement=null,this.innerMoveable=null},r.getMoveable=function(){return this.innerMoveable.moveable},t=S2([El(_c,function(n,a){n[a]||(n[a]=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var o=this.getMoveable();if(!(!o||!o[a]))return o[a].apply(o,i)})}),El(ki,function(n,a){Object.defineProperty(n,a,{get:function(){return this.getMoveable().props[a]},set:function(i){var s;this.setState((s={},s[a]=i,s))},enumerable:!0,configurable:!0})})],t),t}(Ni),E2=function(e){jo(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(C2),Sa=function(){return Sa=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Sa.apply(this,arguments)},xc={};_c.forEach(function(e){xc[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=this.$_moveable)[e].apply(t,r)}});var yc={};ki.forEach(function(e){yc[e]=function(t){this.$_moveable[e]=t}});var qo=me({name:"moveable",methods:xc,props:ki,watch:yc,mounted:function(){var e=this,t={},r=this.$props;ki.forEach(function(s){var o=r[s];za(o)||(t[s]=r[s])});var n=this.$refs,a=n.moveableElement,i=new E2(a,Sa(Sa({},t),{portalContainer:a}));bc.forEach(function(s){i.on(s,function(o){e.$emit(s,Sa({},o))})}),this.$_moveable=i},beforeUnmount:function(){this.$_moveable.destroy()}});const M2={ref:"moveableElement"};function k2(e,t,r,n,a,i){return bt(),Dt("div",M2,null,512)}qo.render=k2;qo.__file="src/Moveable.vue";const T2=["data-eleId","data-lineIndex","data-itemIndex","onClick","onMousedown"],D2=me({__name:"PlayerMoveable",props:{canvasSize:{type:Object,default(){return{width:0,height:0}}}},setup(e){const t=Br(),r=ur(),n=ie(),a=ie(),i=ie(),s=se(()=>{if(t.playerHeight===0&&t.playerWidth===0)return[];const d=[];return r.trackList.forEach(({list:p,type:v},h)=>{if(v==="audio")return;const m=p.findIndex((y,S)=>!!(t.playStartFrame>=y.start&&t.playStartFrame<=y.end&&y.draw)),b=p[m];b&&d.unshift({lineIndex:h,itemIndex:m,id:b.id,scale:b.scale/100,x:b.centerX,y:b.centerY,w:b.width,h:b.height,left:t.playerWidth/2-b.width/2,top:t.playerHeight/2-b.height/2})}),a.value&&a.value.updateRect(),d}),o=Pr({target:i,className:"cc-move",container:n.value,...Af});function l(d){console.log("🚀 ~ selectItem ~ Element Id:",d),t.isPause=!0,r.selectTrackById(d)}function u(d){let{target:p,transform:v,translate:h}=d;const{lineindex:m,itemindex:b}=p.dataset,[y,S]=h;r.trackList[m].list[b].centerX=y,r.trackList[m].list[b].centerY=S,p.style.transform=v}function c(d){let{target:p,scale:v,transform:h}=d;const{lineindex:m,itemindex:b}=p.dataset,y=Math.max(Math.round(v[0]*100),1);r.trackList[m].list[b].scale=y,p.style.transform=h}function f(d,p){d.stopPropagation(),t.isPause=!0,r.selectTrackById(p),i.value=d.currentTarget,Gn(()=>{a.value.dragStart(d)})}return We([r.selectTrackItem,s],()=>{if(n.value&&r.selectTrackItem.line!==-1&&r.selectTrackItem.index!==-1){const d=r.trackList[r.selectTrackItem.line].list[r.selectTrackItem.index];d&&s.value.find(p=>p.id===d.id)?i.value=n.value.querySelector(`.move-target[data-eleid='${d.id}']`):i.value=null}else i.value=null},{immediate:!0,flush:"post"}),(d,p)=>(bt(),Dt("div",{ref_key:"moveContainer",ref:n,class:"absolute left-0 right-0 top-0 bottom-0 m-auto"},[(bt(!0),Dt(Ke,null,nr(s.value,(v,h)=>(bt(),Dt("div",{key:v.id,"data-eleId":v.id,"data-lineIndex":v.lineIndex,"data-itemIndex":v.itemIndex,style:Te({zIndex:h,top:`${v.top}px`,left:`${v.left}px`,width:`${v.w}px`,height:`${v.h}px`,transform:`translate(${v.x}px, ${v.y}px) scale(${v.scale})`}),class:"move-target absolute",onClick:dn(m=>l(v.id),["stop"]),onMousedown:m=>f(m,v.id)},null,44,T2))),128)),et(P(qo),jn({ref_key:"moveable",ref:a},o,{onDrag:u,onScale:c}),null,16)],512))}}),R2={class:"flex items-center justify-center h-8 my-2"},A2={class:"m-auto flex items-center gap-4"},B2={class:"text-xs text-purple inline-block"},I2={class:"text-xs"},O2=me({__name:"PlayerControl",setup(e){const t=Br(),r=ur(),n=se(()=>pl(t.playStartFrame)),a=se(()=>pl(r.frameCount)),i=se(()=>[{title:"回退1s [<-]",disable:r.frameCount===0,icon:"BackwardIcon",handler:()=>{r.frameCount!==0&&t.backward()}},{title:"播放/暂停 [Space]",disable:r.frameCount===0,icon:t.isPause?"PauseIcon":"PlayIcon",handler:()=>{r.frameCount!==0&&(t.isPause=!t.isPause)}},{title:"快进1s [->]",disable:r.frameCount===0,icon:"ForwardIcon",handler:()=>{r.frameCount!==0&&t.forward()}}]);return(s,o)=>{const l=Ue,u=Di;return bt(),Dt("div",R2,[mt("div",A2,[mt("span",B2,ye(P(n)),1),(bt(!0),Dt(Ke,null,nr(P(i),(c,f)=>(bt(),Ee(u,{key:f,effect:"light",content:c.title},{default:Tt(()=>[et(l,{size:18,class:ne(["cursor-pointer box-content",[c.disable?"cursor-not-allowed":"cursor-pointer"]]),onClick:c.handler},{default:Tt(()=>[(bt(),Ee(Ln(c.icon)))]),_:2},1032,["class","onClick"])]),_:2},1032,["content"]))),128)),mt("span",I2,ye(P(a)),1)])])}}});var Ar,Sc,wc,Cc,Ec,ao;class P2{constructor(t){ul(this,Ar);this.playerStore=Br(),this.trackState=ur(),this.canvasSize=Pr({width:0,height:0}),this.playerTimer=0,this.playerContext=null,this.audioPlayAt=0,this.audioContext=new AudioContext,this.captureAudioDest=this.audioContext.createMediaStreamDestination(),this.playingAudioCache=new Set,this.player=t.player,this.playerContext=this.player.value.getContext("bitmaprenderer"),We([()=>this.trackState.trackList,()=>this.canvasSize,()=>this.playerStore.playStartFrame],()=>wn(this,Ar,Sc).call(this),{deep:!0}),We(()=>this.playerStore.isPause,()=>{this.playerStore.isPause?wn(this,Ar,ao).call(this):wn(this,Ar,Ec).call(this)})}}Ar=new WeakSet,Sc=async function(){if(this.playerStore.ingLoadingCount!==0)return;const t=[],r=[];this.playerStore.playingTracks.forEach(async n=>{n instanceof lf?r.push(n):t.unshift(n)}),t.push(...r),wn(this,Ar,wc).call(this,t),this.playerStore.isPause||wn(this,Ar,Cc).call(this,r)},wc=async function(t){const r=new OffscreenCanvas(this.playerStore.playerWidth,this.playerStore.playerHeight),n=r.getContext("2d");for(const a of t)await a.draw(n,this.playerStore.playerWidth,this.playerStore.playerHeight,this.playerStore.playStartFrame);this.playerContext&&this.playerContext.transferFromImageBitmap(r.transferToImageBitmap())},Cc=async function(t){var i;const r=[];for(const s of t){const o=await s.render(this.audioContext,this.playerStore.playStartFrame);o&&r.push(o)}const n=Math.max(this.audioContext.currentTime,this.audioPlayAt);let a=0;for(const s of r)s.start(n),s.connect(this.audioContext.destination),s.connect(this.captureAudioDest),this.playingAudioCache.add(s),s.onended=()=>{s.disconnect(),this.playingAudioCache.delete(s)},a=Math.max(a,((i=s.buffer)==null?void 0:i.duration)??0);this.audioPlayAt=n+a},Ec=function(){this.playerStore.playStartFrame>=this.trackState.frameCount&&(this.playerStore.playStartFrame=0),this.audioContext.resume(),this.audioPlayAt=0,this.playerTimer=of(()=>{this.playerStore.playStartFrame++,this.playerStore.playStartFrame>=this.trackState.frameCount&&wn(this,Ar,ao).call(this)},1e3/gr)},ao=function(){var t;(t=this.playerTimer)==null||t.cancel(),this.audioContext.suspend();for(const r of this.playingAudioCache)r.stop(),r.disconnect();this.playingAudioCache.clear()};const L2={class:"h-full flex flex-col dark:bg-night bg-gray-100"},F2={class:"flex-1 relative overflow-hidden"},z2={key:0,class:"absolute left-0 right-0 top-0 bottom-0 z-20 flex justify-center items-center"},N2=me({__name:"Player",props:{containerSize:{type:Object,default(){return{width:0,height:0}}}},setup(e){const t=e,r=Br(),{playerWidth:n,playerHeight:a}=uf(r),i=ur(),s=ie(),o=ie(),l=se(()=>{let{width:u,height:c}=t.containerSize;return c-=70,u-=10,Math.min(u/n.value,c/a.value)});return nn(()=>{o.value=new P2({player:s})}),(u,c)=>{const f=Ue;return bt(),Dt("div",L2,[mt("div",F2,[rr(mt("canvas",{ref_key:"playerCanvas",ref:s,class:"absolute left-0 right-0 top-0 bottom-0 m-auto bg-gray-900",id:"player",style:Te({zoom:P(l),width:`${P(n)}px`,height:`${P(a)}px`})},null,4),[[vn,P(i).frameCount>0]]),P(i).frameCount===0?(bt(),Dt("div",z2,[et(f,{size:144,class:"box-content opacity-50",style:{color:"#FDE68A"}},{default:Tt(()=>[et(P(cf))]),_:1})])):xe("",!0),et(D2,{style:Te({zoom:P(l),width:`${P(n)}px`,height:`${P(a)}px`})},null,8,["style"])]),et(O2)])}}}),V2=me({__name:"CanvasPlayer",setup(e){const t=Jn(),r=Br(),n=ur(),a=ie(),i=Pr({width:0,height:0});function s(l){l.stopPropagation(),n.selectTrackItem.line=-1,n.selectTrackItem.index=-1}function o(){const{width:l,height:u}=a.value.getBoundingClientRect();i.width=l,i.height=u}return nn(()=>{o()}),window.addEventListener("resize",o,!1),We(()=>[t.trackHeight,t.attrWidth],()=>{o()}),We([()=>r.playerHeight,()=>r.playerWidth],()=>{o()}),(l,u)=>(bt(),Dt("div",{ref_key:"playerContent",ref:a,class:"flex-1 overflow-hidden relative",onClick:s},[et(N2,{"container-size":i},null,8,["container-size"])],512))}}),$2={class:"px-4 w-full h-10 border-b dark:border-night-light"},H2={class:"float-left h-9 w-32 flex flex-row gap-3 flex-nowrap items-center justify-around"},G2=["onClick"],W2={class:"float-right flex w-52 h-9 justify-center items-center gap-4"},X2=me({__name:"TrackControl",props:{modelValue:{type:Number,default:30}},emits:{"update:modelValue":e=>e!==null},setup(e,{emit:t}){const r=e,n=t,a=se({get(){return r.modelValue},set(c){n("update:modelValue",c)}}),i=ur();Br();const s=ie({fontSize:"1.75rem",padding:"0.25rem",boxSizing:"content-box"}),o=Pr({showTooltip:!1,size:"small",step:10,max:100,min:0});function l(c){let f=a.value+c;f>o.max&&(f=o.max),f<o.min&&(f=o.min),a.value=f}const u=se(()=>[{title:"撤销[Ctrl+Z]",icon:"UndoIcon",handler:i._undo},{title:"恢复[Ctrl+Shift+Z]",icon:"RedoIcon",handler:i._redo},{title:"左链接[L]",disable:i.selectTrackItem.index===-1,icon:"LeftLinkIcon",handler:i.leftLink},{title:"分割[S]",disable:i.selectTrackItem.index===-1,icon:"SplitIcon",handler:i.splitTrack},{title:"删除[Backspace]",disable:i.selectTrackItem.index===-1,icon:"DeleteIcon",handler:i.removeTrack},{title:"文字[T]",disable:!1,icon:"AddTextIcon",handler:i.addText}]);return(c,f)=>{const d=Ue,p=Di,v=ff,h=Oa,m=df;return bt(),Dt("div",$2,[mt("div",H2,[(bt(!0),Dt(Ke,null,nr(u.value,b=>(bt(),Dt("div",{key:b.title,onClick:b.handler},[et(p,{effect:"light",content:b.title},{default:Tt(()=>[et(d,{size:"15",class:ne(["focus:outline-0",b.disable?"cursor-not-allowed text-gray-400":"cursor-pointer"])},{default:Tt(()=>[(bt(),Ee(Ln(b.icon)))]),_:2},1032,["class"])]),_:2},1032,["content"])],8,G2))),128))]),mt("div",W2,[et(v,{style:Te(s.value),class:"cursor-pointer",onClick:f[0]||(f[0]=b=>l(-10))},null,8,["style"]),et(h,jn({modelValue:a.value,"onUpdate:modelValue":f[1]||(f[1]=b=>a.value=b)},o),null,16,["modelValue"]),et(m,{style:Te(s.value),class:"cursor-pointer",onClick:f[2]||(f[2]=b=>l(10))},null,8,["style"])])])}}}),Ko=e=>new Map([[100,100],[90,50],[80,20],[70,10],[60,80],[50,40],[40,20],[30,10],[20,40],[10,25],[0,10]]).get(e)||100,mr=(e,t)=>{let n=Ko(e)*t;return e<70&&(n=n/gr),e<30&&(n=n/6),n},Y2=(e,t)=>e>60?t:10,U2=(e,t)=>{let r=e;return t<30?r*=60:t<70&&(r*=10),vf(r*1e3).str},j2=(e,t,r)=>{const n=e%t;let a="";return r<70?"":(a=r>80?n===0?"":`${n<10?"0":""}${n}f`:"",a)},di=.5,Dn=(e,t,r)=>{const n=Ko(t);return t<70&&(e*=r),t<30&&(e*=6),Math.round(e/n)},q2=(e,t,r)=>{const{start:n,scale:a,step:i,focusPosition:s}=t,{ratio:o,bgColor:l,width:u,height:c,textColor:f,subTextColor:d,textSize:p,textScale:v,focusColor:h,longColor:m,shortColor:b}=r,y=Y2(a,i);e.scale(o,o),e.clearRect(0,0,u,c),e.fillStyle=l,e.fillRect(0,0,u,c);const S=Ko(a),C=S*y,R=Math.floor(n/S)*S,D=Math.floor(n/C)*C,I=R-n,W=D-n,G=n+Math.ceil(u);if(s){let F=s.start,X=s.end-s.start;a<70&&(F=F/i,X=X/i),a<30&&(F=F/6,X=X/6);const M=F*S+di-n,st=X*S-di;st>S&&(e.fillStyle=h,e.fillRect(M,0,st,c*3/8))}e.beginPath(),e.fillStyle=f,e.strokeStyle=m;for(let F=D,X=0;F<G;F+=C,X++){const M=W+X*C+di;e.moveTo(M,0),e.save(),e.translate(M,c*.4),e.scale(v/o,v/o);const st=U2(F/C,a),J=st.length*5*v*o,pt=p/o*v/o/2;e.fillText(st,J,pt),e.restore(),e.lineTo(M,c*10/16/o)}e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=d,e.strokeStyle=b;for(let F=R,X=0;F<G;F+=S,X++){const M=I+X*S+di;e.moveTo(M,0);const st=j2(F/S,y,a);if(st){e.save(),e.translate(M,c*.4),e.scale(v/o,v/o);const J=st.length*5*v*o,pt=p/o*v/o/2;e.fillText(st,J,pt),e.restore()}F%C!==0&&e.lineTo(M,c/3/o)}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},K2=me({__name:"TimeLine",props:{start:{type:Number,default:0},step:{type:Number,default:gr},scale:{type:Number,default:0},focusPosition:{type:Object,default(){return{start:0,end:0}}}},emits:{selectFrame(e){return e!==null}},setup(e,{emit:t}){const r=e,n=t,a=ie(),i=ie();let s={};const{isDark:o}=hf(Jn()),l=se(()=>({bgColor:o.value?"#374151":"#E5E7EB",ratio:window.devicePixelRatio||1,textSize:12,textScale:.83,lineWidth:1,textBaseline:"middle",textAlign:"center",longColor:o.value?"#E5E7EB":"#374151",shortColor:o.value?"#9CA3AF":"#6B7280",textColor:o.value?"#E5E7EB":"#374151",subTextColor:o.value?"#9CA3AF":"#6B7280",focusColor:o.value?"#6D28D9":"#C4B5FD"})),u=Pr({width:0,height:0}),c=se(()=>({width:`${u.width/l.value.ratio}px`,height:`${u.height/l.value.ratio}px`}));function f(){q2(s,{...r},{...u,...l.value})}function d(){s=i.value.getContext("2d"),s.font=`${l.value.textSize*l.value.ratio}px -apple-system, ".SFNSText-Regular", "SF UI Text", "PingFang SC", "Hiragino Sans GB", "Helvetica Neue", "WenQuanYi Zen Hei", "Microsoft YaHei", Arial, sans-serif`,s.lineWidth=l.value.lineWidth,s.textBaseline=l.value.textBaseline,s.textAlign=l.value.textAlign}function p(){const{width:h,height:m}=a.value.getBoundingClientRect();u.width=h*l.value.ratio,u.height=m*l.value.ratio,Gn(()=>{d(),f()})}function v(h){const m=h.offsetX,b=Dn(r.start+m,r.scale,r.step);n("selectFrame",b)}return nn(()=>{p()}),We(l,f),We(r,f),window.addEventListener("resize",p,!1),(h,m)=>(bt(),Dt("div",{ref_key:"canvasContainer",ref:a,class:"sticky top-0 left-0 right-0 h-5 text-center leading-5 text-sm z-20"},[mt("canvas",jn({style:c.value},u,{ref_key:"timeLine",ref:i,onClick:v}),null,16)],512))}}),Z2=me({__name:"TrackHandler",props:{isActive:{type:Boolean,default:!1},lineIndex:{type:Number,default:0},itemIndex:{type:Number,default:0}},setup(e){const t=e,r=ur(),n=Br(),a=se(()=>r.trackList[t.lineIndex].list[t.itemIndex]),i=ie();let s=0,o={isVA:!1,start:0,end:0,offsetR:0,offsetL:0,minStart:0,maxStart:0,minEnd:0,maxEnd:0},l=!1,u=[];function c(m,b=10){const y=[];u.forEach(C=>{Math.abs(C.left-m)<=b&&y.push({position:C.left,frame:C.start}),Math.abs(C.right-m)<=b&&y.push({position:C.right,frame:C.end})});const S=mr(r.trackScale,n.playStartFrame);return Math.abs(S-m)<=b&&y.push({position:S,frame:n.playStartFrame}),y}function f(m,b){return b.length===0?void 0:b.reduce((S,C)=>Math.abs(C.position-m)<Math.abs(S.position-m)?C:S,{position:Number.MAX_SAFE_INTEGER,frame:0})}const d=se(()=>mr(r.trackScale,1));function p(m,b){const y=t.itemIndex>0?m[t.itemIndex-1]:null,S=t.itemIndex<m.length?m[t.itemIndex+1]:null,C=["video","audio"].includes(b.type),R={isVA:C,start:b.start,end:b.end,offsetR:b.offsetR,offsetL:b.offsetL,minStart:y?y.end:0,maxStart:b.end-1,minEnd:b.start+1,maxEnd:S?S.start:gr*60*60};if(C){const D=b.frameCount-R.offsetL,I=b.frameCount-R.offsetR;R.maxEnd=S?Math.min(S.start,R.start+D):Math.min(D+R.start,gr*60*60),R.minStart=y?Math.max(y.end,R.end-I):Math.max(R.end-I,0)}Object.assign(o,{...R})}function v(m,b){const{isVA:y,start:S,end:C,offsetR:R,offsetL:D,minStart:I,maxStart:W,minEnd:G,maxEnd:F}=o,X=C-S,M=D+X,st=R+X;if(b==="left"){let J=S+m;J>W&&(J=W),J<I&&(J=I);let pt=J-S;y?(C-J>M&&(J=C-M,pt=J-S),r.trackList[t.lineIndex].list[t.itemIndex].offsetL=Math.max(D+pt,0)):r.trackList[t.lineIndex].list[t.itemIndex].frameCount=C-J,r.trackList[t.lineIndex].list[t.itemIndex].start=J}else{let J=C+m;if(J>F&&(J=F),J<G&&(J=G),y){J-S>st&&(J=S+st);const pt=J-C;r.trackList[t.lineIndex].list[t.itemIndex].offsetR=Math.max(R-pt,0)}else r.trackList[t.lineIndex].list[t.itemIndex].frameCount=J-S;r.trackList[t.lineIndex].list[t.itemIndex].end=J}}function h(m,b){var I;m.preventDefault(),m.stopPropagation(),u=[];for(let W=0;W<r.trackList.length;W++)for(let G=0;G<r.trackList[W].list.length;G++)if(W!==t.lineIndex||G!==t.itemIndex){const F=r.trackList[W].list[G];u.push({start:F.start,end:F.end,left:mr(r.trackScale,F.start),right:mr(r.trackScale,F.end)})}n.isPause=!0;const{pageX:y}=m;s=y,l=!0,p(((I=r.trackList[t.lineIndex])==null?void 0:I.list)||[],a.value);const S=a.value.start,C=a.value.end,R=i.value.closest(".trackItem"),D=b==="left"?R.offsetLeft:R.offsetLeft+R.offsetWidth;document.onmousemove=W=>{if(!l)return;const{pageX:G}=W,F=s-G,X=c(D-F);r.dragData.fixLines=[X];const M=f(D-F,X),st=M!=null&&M.frame?b==="left"?M.frame-S:M.frame-C:-Math.round(F/d.value);v(st,b)},document.onmouseup=()=>{l=!1,document.onmouseup=null,document.onmousemove=null}}return(m,b)=>rr((bt(),Dt("div",{class:ne(["absolute left-0 right-0 top-0 bottom-0 border z-20",{"dark:border-gray-100 border-gray-600":e.isActive}]),ref_key:"el",ref:i},[mt("div",{class:"cursor-c-resize flex flex-col justify-center absolute -top-px -bottom-px -left-2 text-center rounded-tl rounded-bl w-2 dark:bg-gray-100 bg-gray-500 dark:text-gray-800 text-gray-100",ref:"handlerLeft",onMousedown:b[0]||(b[0]=y=>h(y,"left"))},b[2]||(b[2]=[mt("span",null,"|",-1)]),544),mt("div",{class:"cursor-c-resize flex flex-col justify-center absolute -top-px -bottom-px -right-2 text-center rounded-tr rounded-br w-2 dark:bg-gray-100 bg-gray-500 dark:text-gray-800 text-gray-100",ref:"handlerRight",onMousedown:b[1]||(b[1]=y=>h(y,"right"))},b[3]||(b[3]=[mt("span",null,"|",-1)]),544)],2)),[[vn,e.isActive]])}}),Q2={},J2={class:"loading absolute top-0 left-0 right-0 bottom-0 bg-gray-600 flex flex-row justify-start items-center"};function tm(e,t){return bt(),Dt("div",J2,t[0]||(t[0]=[mt("span",null,null,-1),mt("span",null,null,-1),mt("span",null,null,-1),mt("span",null,null,-1),mt("span",null,null,-1)]))}const Zo=qr(Q2,[["render",tm],["__scopeId","data-v-5979cec8"]]),em={class:"flex flex-col rounded overflow-hidden h-full"},rm={class:"flex items-center text-xs pl-2 overflow-hidden h-5 leading-5 bg-[#4b4f54] text-white"},nm={key:0,class:"mr-4 shrink-0"},am={class:"shrink-0"},im=["src"],sm={key:0,class:"pl-2 overflow-hidden h-4 flex items-center bg-gray-700 relative text-xs overflow-ellipsis whitespace-nowrap text-white"},om=me({__name:"VideoItem",props:{trackItem:{type:Object}},setup(e){const t=e,r=Br(),n=ur(),a=ie(),i=ie(!0),s=ie([]),o=se(()=>t.trackItem.resource);async function l(){if(!o.value){console.error("Video resource not found");return}try{r.ingLoadingCount++,i.value=!0;const u=mr(n.trackScale,t.trackItem.frameCount),c=Math.ceil(u/50),f=Math.ceil(o.value.duration*1e6/c),d=await pf.thumbnails(t.trackItem,n.trackScale,f);s.value=d.map(({img:p})=>URL.createObjectURL(p))}finally{i.value=!1,r.ingLoadingCount--}}return We(()=>[t.trackItem,o.value],l,{immediate:!0,flush:"post"}),k0(()=>{s.value.forEach(u=>{URL.revokeObjectURL(u)})}),(u,c)=>{var p;const f=uo,d=Ue;return bt(),Dt("div",em,[mt("div",rm,[et(d,{size:"18"},{default:Tt(()=>[et(f,{class:"inline-block mr-2 shrink-0"})]),_:1}),P(o)?(bt(),Dt("span",nm," ["+ye(P(o).duration.toFixed(1))+"s] ",1)):xe("",!0),mt("span",am,ye(`${e.trackItem.name}.${e.trackItem.format}`),1)]),mt("div",{ref_key:"container",ref:a,class:"bg-gray-400 bg-opacity-70 flex-1 relative whitespace-nowrap overflow-hidden",style:Te({left:`-${P(mr)(P(n).trackScale,e.trackItem.offsetL)}px`})},[(bt(!0),Dt(Ke,null,nr(P(s),(v,h)=>(bt(),Dt("img",{key:h,src:v,alt:"",class:"image-item",draggable:"false"},null,8,im))),128))],4),(p=P(o).meta)!=null&&p.prompt?(bt(),Dt("div",sm,[mt("span",null,ye(P(o).meta.prompt),1)])):xe("",!0),rr(et(Zo,{class:"pl-12 bg-opacity-70"},null,512),[[vn,P(i)||e.trackItem.loading]])])}}});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function lr(e,t,r,n){return new(r||(r=Promise))(function(a,i){function s(u){try{l(n.next(u))}catch(c){i(c)}}function o(u){try{l(n.throw(u))}catch(c){i(c)}}function l(u){var c;u.done?a(u.value):(c=u.value,c instanceof r?c:new r(function(f){f(c)})).then(s,o)}l((n=n.apply(e,[])).next())})}class Ua{constructor(){this.listeners={}}on(t,r,n){if(this.listeners[t]||(this.listeners[t]=new Set),this.listeners[t].add(r),n==null?void 0:n.once){const a=()=>{this.un(t,a),this.un(t,r)};return this.on(t,a),a}return()=>this.un(t,r)}un(t,r){var n;(n=this.listeners[t])===null||n===void 0||n.delete(r)}once(t,r){return this.on(t,r,{once:!0})}unAll(){this.listeners={}}emit(t,...r){this.listeners[t]&&this.listeners[t].forEach(n=>n(...r))}}const v0={decode:function(e,t){return lr(this,void 0,void 0,function*(){const r=new AudioContext({sampleRate:t});return r.decodeAudioData(e).finally(()=>r.close())})},createBuffer:function(e,t){return typeof e[0]=="number"&&(e=[e]),function(r){const n=r[0];if(n.some(a=>a>1||a<-1)){const a=n.length;let i=0;for(let s=0;s<a;s++){const o=Math.abs(n[s]);o>i&&(i=o)}for(const s of r)for(let o=0;o<a;o++)s[o]/=i}}(e),{duration:t,length:e[0].length,sampleRate:e[0].length/t,numberOfChannels:e.length,getChannelData:r=>e==null?void 0:e[r],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function Mc(e,t){const r=t.xmlns?document.createElementNS(t.xmlns,e):document.createElement(e);for(const[n,a]of Object.entries(t))if(n==="children")for(const[i,s]of Object.entries(t))typeof s=="string"?r.appendChild(document.createTextNode(s)):r.appendChild(Mc(i,s));else n==="style"?Object.assign(r.style,a):n==="textContent"?r.textContent=a:r.setAttribute(n,a.toString());return r}function h0(e,t,r){const n=Mc(e,t||{});return r==null||r.appendChild(n),n}var lm=Object.freeze({__proto__:null,createElement:h0,default:h0});const um={fetchBlob:function(e,t,r){return lr(this,void 0,void 0,function*(){const n=yield fetch(e,r);if(n.status>=400)throw new Error(`Failed to fetch ${e}: ${n.status} (${n.statusText})`);return function(a,i){lr(this,void 0,void 0,function*(){if(!a.body||!a.headers)return;const s=a.body.getReader(),o=Number(a.headers.get("Content-Length"))||0;let l=0;const u=f=>lr(this,void 0,void 0,function*(){l+=(f==null?void 0:f.length)||0;const d=Math.round(l/o*100);i(d)}),c=()=>lr(this,void 0,void 0,function*(){let f;try{f=yield s.read()}catch{return}f.done||(u(f.value),yield c())});c()})}(n.clone(),t),n.blob()})}};class cm extends Ua{constructor(t){super(),this.isExternalMedia=!1,t.media?(this.media=t.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),t.mediaControls&&(this.media.controls=!0),t.autoplay&&(this.media.autoplay=!0),t.playbackRate!=null&&this.onMediaEvent("canplay",()=>{t.playbackRate!=null&&(this.media.playbackRate=t.playbackRate)},{once:!0})}onMediaEvent(t,r,n){return this.media.addEventListener(t,r,n),()=>this.media.removeEventListener(t,r,n)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const t=this.getSrc();t.startsWith("blob:")&&URL.revokeObjectURL(t)}canPlayType(t){return this.media.canPlayType(t)!==""}setSrc(t,r){if(this.getSrc()===t)return;this.revokeSrc();const n=r instanceof Blob&&this.canPlayType(r.type)?URL.createObjectURL(r):t;this.media.src=n}destroy(){this.media.pause(),this.isExternalMedia||(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(t){this.media=t}play(){return lr(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(t){this.media.currentTime=t}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(t){this.media.volume=t}getMuted(){return this.media.muted}setMuted(t){this.media.muted=t}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(t,r){r!=null&&(this.media.preservesPitch=r),this.media.playbackRate=t}getMediaElement(){return this.media}setSinkId(t){return this.media.setSinkId(t)}}class qi extends Ua{constructor(t,r){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.subscriptions=[],this.options=t;const n=this.parentFromOptionsContainer(t.container);this.parent=n;const[a,i]=this.initHtml();n.appendChild(a),this.container=a,this.scrollContainer=i.querySelector(".scroll"),this.wrapper=i.querySelector(".wrapper"),this.canvasWrapper=i.querySelector(".canvases"),this.progressWrapper=i.querySelector(".progress"),this.cursor=i.querySelector(".cursor"),r&&i.appendChild(r),this.initEvents()}parentFromOptionsContainer(t){let r;if(typeof t=="string"?r=document.querySelector(t):t instanceof HTMLElement&&(r=t),!r)throw new Error("Container not found");return r}initEvents(){const t=n=>{const a=this.wrapper.getBoundingClientRect(),i=n.clientX-a.left,s=n.clientX-a.left;return[i/a.width,s/a.height]};this.wrapper.addEventListener("click",n=>{const[a,i]=t(n);this.emit("click",a,i)}),this.wrapper.addEventListener("dblclick",n=>{const[a,i]=t(n);this.emit("dblclick",a,i)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:n,scrollWidth:a,clientWidth:i}=this.scrollContainer,s=n/a,o=(n+i)/a;this.emit("scroll",s,o)});const r=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{r().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}onContainerResize(){const t=this.parent.clientWidth;t===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=t,this.reRender())}initDrag(){this.subscriptions.push(function(t,r,n,a,i=3,s=0,o=100){if(!t)return()=>{};const l=matchMedia("(pointer: coarse)").matches;let u=()=>{};const c=f=>{if(f.button!==s)return;f.preventDefault(),f.stopPropagation();let d=f.clientX,p=f.clientY,v=!1;const h=Date.now(),m=R=>{if(R.preventDefault(),R.stopPropagation(),l&&Date.now()-h<o)return;const D=R.clientX,I=R.clientY,W=D-d,G=I-p;if(v||Math.abs(W)>i||Math.abs(G)>i){const F=t.getBoundingClientRect(),{left:X,top:M}=F;v||(n==null||n(d-X,p-M),v=!0),r(W,G,D-X,I-M),d=D,p=I}},b=R=>{if(v){const D=R.clientX,I=R.clientY,W=t.getBoundingClientRect(),{left:G,top:F}=W;a==null||a(D-G,I-F)}u()},y=R=>{R.relatedTarget&&R.relatedTarget!==document.documentElement||b(R)},S=R=>{v&&(R.stopPropagation(),R.preventDefault())},C=R=>{v&&R.preventDefault()};document.addEventListener("pointermove",m),document.addEventListener("pointerup",b),document.addEventListener("pointerout",y),document.addEventListener("pointercancel",y),document.addEventListener("touchmove",C,{passive:!1}),document.addEventListener("click",S,{capture:!0}),u=()=>{document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",b),document.removeEventListener("pointerout",y),document.removeEventListener("pointercancel",y),document.removeEventListener("touchmove",C),setTimeout(()=>{document.removeEventListener("click",S,{capture:!0})},10)}};return t.addEventListener("pointerdown",c),()=>{u(),t.removeEventListener("pointerdown",c)}}(this.wrapper,(t,r,n)=>{this.emit("drag",Math.max(0,Math.min(1,n/this.wrapper.getBoundingClientRect().width)))},t=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,t/this.wrapper.getBoundingClientRect().width)))},t=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,t/this.wrapper.getBoundingClientRect().width)))}))}getHeight(t){return t==null?128:isNaN(Number(t))?t==="auto"&&this.parent.clientHeight||128:Number(t)}initHtml(){const t=document.createElement("div"),r=t.attachShadow({mode:"open"});return r.innerHTML=`
      <style>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[t,r]}setOptions(t){if(this.options.container!==t.container){const r=this.parentFromOptionsContainer(t.container);r.appendChild(this.container),this.parent=r}t.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=t,this.reRender()}getWrapper(){return this.wrapper}getScroll(){return this.scrollContainer.scrollLeft}setScroll(t){this.scrollContainer.scrollLeft=t}setScrollPercentage(t){const{scrollWidth:r}=this.scrollContainer,n=r*t;this.setScroll(n)}destroy(){var t;this.subscriptions.forEach(r=>r()),this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect()}createDelay(t=10){let r,n;const a=()=>{r&&clearTimeout(r),n&&n()};return this.timeouts.push(a),()=>new Promise((i,s)=>{a(),n=s,r=setTimeout(()=>{r=void 0,n=void 0,i()},t)})}convertColorValues(t){if(!Array.isArray(t))return t||"";if(t.length<2)return t[0]||"";const r=document.createElement("canvas"),n=r.getContext("2d"),a=r.height*(window.devicePixelRatio||1),i=n.createLinearGradient(0,0,0,a),s=1/(t.length-1);return t.forEach((o,l)=>{const u=l*s;i.addColorStop(u,o)}),i}renderBarWaveform(t,r,n,a){const i=t[0],s=t[1]||t[0],o=i.length,{width:l,height:u}=n.canvas,c=u/2,f=window.devicePixelRatio||1,d=r.barWidth?r.barWidth*f:1,p=r.barGap?r.barGap*f:r.barWidth?d/2:0,v=r.barRadius||0,h=l/(d+p)/o,m=v&&"roundRect"in n?"roundRect":"rect";n.beginPath();let b=0,y=0,S=0;for(let C=0;C<=o;C++){const R=Math.round(C*h);if(R>b){const W=Math.round(y*c*a),G=W+Math.round(S*c*a)||1;let F=c-W;r.barAlign==="top"?F=0:r.barAlign==="bottom"&&(F=u-G),n[m](b*(d+p),F,d,G,v),b=R,y=0,S=0}const D=Math.abs(i[C]||0),I=Math.abs(s[C]||0);D>y&&(y=D),I>S&&(S=I)}n.fill(),n.closePath()}renderLineWaveform(t,r,n,a){const i=s=>{const o=t[s]||t[0],l=o.length,{height:u}=n.canvas,c=u/2,f=n.canvas.width/l;n.moveTo(0,c);let d=0,p=0;for(let v=0;v<=l;v++){const h=Math.round(v*f);if(h>d){const b=c+(Math.round(p*c*a)||1)*(s===0?-1:1);n.lineTo(d,b),d=h,p=0}const m=Math.abs(o[v]||0);m>p&&(p=m)}n.lineTo(d,c)};n.beginPath(),i(0),i(1),n.fill(),n.closePath()}renderWaveform(t,r,n){if(n.fillStyle=this.convertColorValues(r.waveColor),r.renderFunction)return void r.renderFunction(t,n);let a=r.barHeight||1;if(r.normalize){const i=Array.from(t[0]).reduce((s,o)=>Math.max(s,Math.abs(o)),0);a=i?1/i:1}r.barWidth||r.barGap||r.barAlign?this.renderBarWaveform(t,r,n,a):this.renderLineWaveform(t,r,n,a)}renderSingleCanvas(t,r,n,a,i,s,o,l){const u=window.devicePixelRatio||1,c=document.createElement("canvas"),f=t[0].length;c.width=Math.round(n*(s-i)/f),c.height=a*u,c.style.width=`${Math.floor(c.width/u)}px`,c.style.height=`${a}px`,c.style.left=`${Math.floor(i*n/u/f)}px`,o.appendChild(c);const d=c.getContext("2d");if(this.renderWaveform(t.map(p=>p.slice(i,s)),r,d),c.width>0&&c.height>0){const p=c.cloneNode(),v=p.getContext("2d");v.drawImage(c,0,0),v.globalCompositeOperation="source-in",v.fillStyle=this.convertColorValues(r.progressColor),v.fillRect(0,0,c.width,c.height),l.appendChild(p)}}renderChannel(t,r,n,a){var{overlay:i}=r,s=function(o,l){var u={};for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&l.indexOf(c)<0&&(u[c]=o[c]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function"){var f=0;for(c=Object.getOwnPropertySymbols(o);f<c.length;f++)l.indexOf(c[f])<0&&Object.prototype.propertyIsEnumerable.call(o,c[f])&&(u[c[f]]=o[c[f]])}return u}(r,["overlay"]);return lr(this,void 0,void 0,function*(){const o=document.createElement("div"),l=this.getHeight(s.height);o.style.height=`${l}px`,i&&a>0&&(o.style.marginTop=`-${l}px`),this.canvasWrapper.style.minHeight=`${l}px`,this.canvasWrapper.appendChild(o);const u=o.cloneNode();this.progressWrapper.appendChild(u);const c=t[0].length,f=(C,R)=>{this.renderSingleCanvas(t,s,n,l,Math.max(0,C),Math.min(R,c),o,u)};if(!this.isScrollable)return void f(0,c);const{scrollLeft:d,scrollWidth:p,clientWidth:v}=this.scrollContainer,h=c/p;let m=Math.min(qi.MAX_CANVAS_WIDTH,v);if(s.barWidth||s.barGap){const C=s.barWidth||.5,R=C+(s.barGap||C/2);m%R!=0&&(m=Math.floor(m/R)*R)}const b=Math.floor(Math.abs(d)*h),y=Math.floor(b+m*h),S=y-b;S<=0||(f(b,y),yield Promise.all([lr(this,void 0,void 0,function*(){if(b===0)return;const C=this.createDelay();for(let R=b;R>=0;R-=S)yield C(),f(Math.max(0,R-S),R)}),lr(this,void 0,void 0,function*(){if(y===c)return;const C=this.createDelay();for(let R=y;R<c;R+=S)yield C(),f(R,Math.min(c,R+S))})]))})}render(t){return lr(this,void 0,void 0,function*(){this.timeouts.forEach(o=>o()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const r=window.devicePixelRatio||1,n=this.scrollContainer.clientWidth,a=Math.ceil(t.duration*(this.options.minPxPerSec||0));this.isScrollable=a>n;const i=this.options.fillParent&&!this.isScrollable,s=(i?n:a)*r;this.wrapper.style.width=i?"100%":`${a}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=t,this.emit("render");try{if(this.options.splitChannels)yield Promise.all(Array.from({length:t.numberOfChannels}).map((o,l)=>{var u;const c=Object.assign(Object.assign({},this.options),(u=this.options.splitChannels)===null||u===void 0?void 0:u[l]);return this.renderChannel([t.getChannelData(l)],c,s,l)}));else{const o=[t.getChannelData(0)];t.numberOfChannels>1&&o.push(t.getChannelData(1)),yield this.renderChannel(o,this.options,s,0)}}catch{return}this.emit("rendered")})}reRender(){if(!this.audioData)return;const{scrollWidth:t}=this.scrollContainer,{right:r}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&t!==this.scrollContainer.scrollWidth){const{right:n}=this.progressWrapper.getBoundingClientRect();let a=n-r;a*=2,a=a<0?Math.floor(a):Math.ceil(a),a/=2,this.scrollContainer.scrollLeft+=a}}zoom(t){this.options.minPxPerSec=t,this.reRender()}scrollIntoView(t,r=!1){const{scrollLeft:n,scrollWidth:a,clientWidth:i}=this.scrollContainer,s=t*a,o=n,l=n+i,u=i/2;if(this.isDragging)s+30>l?this.scrollContainer.scrollLeft+=30:s-30<o&&(this.scrollContainer.scrollLeft-=30);else{(s<o||s>l)&&(this.scrollContainer.scrollLeft=s-(this.options.autoCenter?u:0));const c=s-n-u;r&&this.options.autoCenter&&c>0&&(this.scrollContainer.scrollLeft+=Math.min(c,10))}{const c=this.scrollContainer.scrollLeft,f=c/a,d=(c+i)/a;this.emit("scroll",f,d)}}renderProgress(t,r){if(isNaN(t))return;const n=100*t;this.canvasWrapper.style.clipPath=`polygon(${n}% 0, 100% 0, 100% 100%, ${n}% 100%)`,this.progressWrapper.style.width=`${n}%`,this.cursor.style.left=`${n}%`,this.cursor.style.transform=`translateX(-${Math.round(n)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(t,r)}exportImage(t,r,n){return lr(this,void 0,void 0,function*(){const a=this.canvasWrapper.querySelectorAll("canvas");if(!a.length)throw new Error("No waveform data");if(n==="dataURL"){const i=Array.from(a).map(s=>s.toDataURL(t,r));return Promise.resolve(i)}return Promise.all(Array.from(a).map(i=>new Promise((s,o)=>{i.toBlob(l=>{l?s(l):o(new Error("Could not export image"))},t,r)})))})}}qi.MAX_CANVAS_WIDTH=4e3;class fm extends Ua{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}class p0 extends Ua{constructor(t=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=t,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return lr(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(t){if(this.currentSrc=t,this._duration=void 0,!t)return this.buffer=null,void this.emit("emptied");fetch(t).then(r=>{if(r.status>=400)throw new Error(`Failed to fetch ${t}: ${r.status} (${r.statusText})`);return r.arrayBuffer()}).then(r=>this.currentSrc!==t?null:this.audioContext.decodeAudioData(r)).then(r=>{this.currentSrc===t&&(this.buffer=r,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var t;if(!this.paused)return;this.paused=!1,(t=this.bufferNode)===null||t===void 0||t.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let r=this.playedDuration*this._playbackRate;r>=this.duration&&(r=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,r),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var t;this.paused=!0,(t=this.bufferNode)===null||t===void 0||t.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return lr(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(t){var r,n;const a=t-this.currentTime;(r=this.bufferNode)===null||r===void 0||r.stop(this.audioContext.currentTime+a),(n=this.bufferNode)===null||n===void 0||n.addEventListener("ended",()=>{this.bufferNode=null,this.pause()},{once:!0})}setSinkId(t){return lr(this,void 0,void 0,function*(){return this.audioContext.setSinkId(t)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this.bufferNode&&(this.bufferNode.playbackRate.value=t)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(t){const r=!this.paused;r&&this._pause(),this.playedDuration=t/this._playbackRate,r&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var t,r;return(t=this._duration)!==null&&t!==void 0?t:((r=this.buffer)===null||r===void 0?void 0:r.duration)||0}set duration(t){this._duration=t}get volume(){return this.gainNode.gain.value}set volume(t){this.gainNode.gain.value=t,this.emit("volumechange")}get muted(){return this._muted}set muted(t){this._muted!==t&&(this._muted=t,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(t){return/^(audio|video)\//.test(t)}getGainNode(){return this.gainNode}getChannelData(){const t=[];if(!this.buffer)return t;const r=this.buffer.numberOfChannels;for(let n=0;n<r;n++)t.push(this.buffer.getChannelData(n));return t}}const dm={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class Aa extends cm{static create(t){return new Aa(t)}constructor(t){const r=t.media||(t.backend==="WebAudio"?new p0:void 0);super({media:r,mediaControls:t.mediaControls,autoplay:t.autoplay,playbackRate:t.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},dm,t),this.timer=new fm;const n=r?void 0:this.getMediaElement();this.renderer=new qi(this.options,n),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins(),Promise.resolve().then(()=>{this.emit("init");const a=this.options.url||this.getSrc()||"";(a||this.options.peaks&&this.options.duration)&&this.load(a,this.options.peaks,this.options.duration).catch(()=>null)})}updateProgress(t=this.getCurrentTime()){return this.renderer.renderProgress(t/this.getDuration(),this.isPlaying()),t}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const t=this.updateProgress();this.emit("timeupdate",t),this.emit("audioprocess",t)}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const t=this.updateProgress();this.emit("timeupdate",t)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",t=>{this.emit("error",t.error)}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(t,r)=>{this.options.interact&&(this.seekTo(t),this.emit("interaction",t*this.getDuration()),this.emit("click",t,r))}),this.renderer.on("dblclick",(t,r)=>{this.emit("dblclick",t,r)}),this.renderer.on("scroll",(t,r)=>{const n=this.getDuration();this.emit("scroll",t*n,r*n)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",t=>{this.emit("dragstart",t)}),this.renderer.on("dragend",t=>{this.emit("dragend",t)}));{let t;this.subscriptions.push(this.renderer.on("drag",r=>{if(!this.options.interact)return;let n;this.renderer.renderProgress(r),clearTimeout(t),this.isPlaying()?n=0:this.options.dragToSeek===!0?n=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(n=this.options.dragToSeek.debounceTime),t=setTimeout(()=>{this.seekTo(r)},n),this.emit("interaction",r*this.getDuration()),this.emit("drag",r)}))}}initPlugins(){var t;!((t=this.options.plugins)===null||t===void 0)&&t.length&&this.options.plugins.forEach(r=>{this.registerPlugin(r)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(t=>t()),this.mediaSubscriptions=[]}setOptions(t){this.options=Object.assign({},this.options,t),this.renderer.setOptions(this.options),t.audioRate&&this.setPlaybackRate(t.audioRate),t.mediaControls!=null&&(this.getMediaElement().controls=t.mediaControls)}registerPlugin(t){return t._init(this),this.plugins.push(t),this.subscriptions.push(t.once("destroy",()=>{this.plugins=this.plugins.filter(r=>r!==t)})),t}getWrapper(){return this.renderer.getWrapper()}getScroll(){return this.renderer.getScroll()}setScrollTime(t){const r=t/this.getDuration();this.renderer.setScrollPercentage(r)}getActivePlugins(){return this.plugins}loadAudio(t,r,n,a){var i;return lr(this,void 0,void 0,function*(){if(this.emit("load",t),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!r&&!n){const o=this.options.fetchParams||{};window.AbortController&&!o.signal&&(this.abortController=new AbortController,o.signal=(i=this.abortController)===null||i===void 0?void 0:i.signal);const l=u=>this.emit("loading",u);r=yield um.fetchBlob(t,l,o)}this.setSrc(t,r);const s=a||this.getDuration()||(yield new Promise(o=>{this.onMediaEvent("loadedmetadata",()=>o(this.getDuration()),{once:!0})}));if(!t&&!r){const o=this.getMediaElement();o instanceof p0&&(o.duration=s)}if(n)this.decodedData=v0.createBuffer(n,s||0);else if(r){const o=yield r.arrayBuffer();this.decodedData=yield v0.decode(o,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(t,r,n){return lr(this,void 0,void 0,function*(){try{return yield this.loadAudio(t,void 0,r,n)}catch(a){throw this.emit("error",a),a}})}loadBlob(t,r,n){return lr(this,void 0,void 0,function*(){try{return yield this.loadAudio("blob",t,r,n)}catch(a){throw this.emit("error",a),a}})}zoom(t){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(t),this.emit("zoom",t)}getDecodedData(){return this.decodedData}exportPeaks({channels:t=2,maxLength:r=8e3,precision:n=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const a=Math.min(t,this.decodedData.numberOfChannels),i=[];for(let s=0;s<a;s++){const o=this.decodedData.getChannelData(s),l=[],u=Math.round(o.length/r);for(let c=0;c<r;c++){const f=o.slice(c*u,(c+1)*u);let d=0;for(let p=0;p<f.length;p++){const v=f[p];Math.abs(v)>Math.abs(d)&&(d=v)}l.push(Math.round(d*n)/n)}i.push(l)}return i}getDuration(){let t=super.getDuration()||0;return t!==0&&t!==1/0||!this.decodedData||(t=this.decodedData.duration),t}toggleInteraction(t){this.options.interact=t}setTime(t){super.setTime(t),this.updateProgress(t),this.emit("timeupdate",t)}seekTo(t){const r=this.getDuration()*t;this.setTime(r)}playPause(){return lr(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(t){this.setTime(this.getCurrentTime()+t)}empty(){this.load("",[[0]],.001)}setMediaElement(t){this.unsubscribePlayerEvents(),super.setMediaElement(t),this.initPlayerEvents()}exportImage(t="image/png",r=1,n="dataURL"){return lr(this,void 0,void 0,function*(){return this.renderer.exportImage(t,r,n)})}destroy(){var t;this.emit("destroy"),(t=this.abortController)===null||t===void 0||t.abort(),this.plugins.forEach(r=>r.destroy()),this.subscriptions.forEach(r=>r()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}Aa.BasePlugin=class extends Ua{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}},Aa.dom=lm;const vm={class:"flex flex-col rounded overflow-hidden h-full"},hm={class:"flex items-center text-xs pl-2 overflow-hidden h-5 leading-5 bg-[#395c96] text-gray-100"},pm={class:"mr-4 shrink-0"},gm={class:"overflow-hidden bg-blue-900 bg-opacity-60 flex-1 relative"},mm={key:0,class:"pl-2 overflow-hidden h-4 bg-gray-600 relative text-xs text-white"},_m=me({__name:"AudioItem",props:{trackItem:{type:Object,default(){return{showWidth:"0px",showLeft:"0px"}}}},setup(e){const t=e,r=Br(),n=se(()=>t.trackItem.resource),a=se(()=>{const{start:l,end:u,offsetL:c,offsetR:f,frameCount:d}=t.trackItem,p=u-l;return{transformOrigin:"left top",left:`-${c/p*100}%`,right:`-${f/p*100}%`}}),i=ie(!0),s=ie();async function o(){var l;if(!((l=n.value)!=null&&l.url)){console.error("Audio resource URL not found");return}r.ingLoadingCount++;try{Aa.create({container:s.value,url:n.value.url,...gf})}finally{i.value=!1,r.ingLoadingCount--}}return We(()=>n.value&&s.value,()=>{s.value&&o()},{immediate:!0}),(l,u)=>{var d,p;const c=T0,f=Ue;return bt(),Dt("div",vm,[mt("div",hm,[et(f,{size:"18"},{default:Tt(()=>[et(c,{class:"inline-block mr-2 shrink-0"})]),_:1}),mt("span",pm,ye(`${e.trackItem.name}.${e.trackItem.format}`),1)]),mt("div",gm,[mt("div",{style:Te(P(a)),class:"absolute",ref_key:"waveRef",ref:s},null,4)]),(p=(d=P(n))==null?void 0:d.meta)!=null&&p.prompt?(bt(),Dt("div",mm,[mt("span",null,ye(P(n).meta.prompt),1)])):xe("",!0),rr(et(Zo,{class:"pl-12 bg-opacity-70"},null,512),[[vn,P(i)||e.trackItem.loading]])])}}}),bm={class:"flex flex-col rounded overflow-hidden h-full"},xm={class:"flex items-center text-xs pl-2 overflow-hidden h-6 leading-6 bg-red-900 bg-opacity-70 text-gray-300"},ym={class:"mr-4 shrink-0"},Sm=me({__name:"TextItem",props:{trackItem:{type:Object,default(){return{width:"0px",left:"0px"}}}},setup(e){const t=e;return(r,n)=>{const a=D0,i=Ue;return bt(),Dt("div",bm,[mt("div",xm,[et(i,{size:"18"},{default:Tt(()=>[et(a,{class:"inline-block mr-2 shrink-0"})]),_:1}),mt("span",ym,ye(t.trackItem.text),1)])])}}}),wm={class:"flex flex-col rounded overflow-hidden h-full"},Cm={class:"flex items-center text-xs pl-2 overflow-hidden h-full leading-6 bg-yellow-700 bg-opacity-70 text-white"},Em=["src"],Mm={class:"mr-4 shrink-0 flex flex-col gap-1"},km={class:"text-xs h-4"},Tm=me({__name:"ImageItem",props:{trackItem:{type:Object,default(){return{width:"0px",left:"0px"}}}},setup(e){const t=e,r=se(()=>t.trackItem.resource);return(n,a)=>{var i;return bt(),Dt("div",wm,[mt("div",Cm,[mt("img",{src:(i=P(r))==null?void 0:i.url,class:"h-full inline-block mr-2 shrink-0",alt:"",draggable:"false"},null,8,Em),mt("div",Mm,[mt("div",km,ye(e.trackItem.name),1)])]),rr(et(Zo,{class:"pl-12 bg-opacity-70"},null,512),[[vn,e.trackItem.loading]])])}}}),Dm=["data-type","data-line","data-index"],Rm=me({__name:"TrackItem",props:{trackType:{type:String,default:""},lineIndex:{type:Number,default:0},itemIndex:{type:Number,default:0},trackItem:{type:Object,default(){return{width:"0px",left:"0px"}}}},setup(e){const t=e,r=ur(),n=se(()=>r.selectTrackItem.line===t.lineIndex&&r.selectTrackItem.index===t.itemIndex),a=new Map([["video",om],["audio",_m],["text",Sm],["image",Tm]]),i=se(()=>r.moveTrackData.lineIndex===t.lineIndex&&r.moveTrackData.itemIndex===t.itemIndex);function s(l){l.preventDefault(),l.stopPropagation(),r.selectTrackItem.line=t.lineIndex,r.selectTrackItem.index=t.itemIndex}const o=se(()=>i.value?{width:t.trackItem.showWidth,left:`${parseInt(t.trackItem.showLeft)+r.dragData.moveX}px`,top:`${r.dragData.moveY}px`}:{width:t.trackItem.showWidth,left:t.trackItem.showLeft});return(l,u)=>(bt(),Dt("div",{class:ne(["text-left text-sm top-0 absolute trackItem",[P(co).get(t.trackItem.type),i.value?"z-50 isDrag":"z-10"]]),style:Te([o.value]),"data-type":t.trackItem.type,"data-line":e.lineIndex,"data-index":e.itemIndex,onClick:s},[et(Z2,{isActive:n.value,lineIndex:e.lineIndex,itemIndex:e.itemIndex},null,8,["isActive","lineIndex","itemIndex"]),(bt(),Ee(Ln(P(a).get(e.trackItem.type)),{trackItem:e.trackItem},null,8,["trackItem"]))],14,Dm))}}),Am=["data-index","data-type"],Bm=me({__name:"TrackLine",props:{isMain:{type:Boolean,default:!1},lineType:{type:String,default:""},lineIndex:{type:Number,default:0},lineData:{type:Array,default(){return[]}}},setup(e){const t=e,r=ur(),n=se(()=>r.selectTrackItem.line===t.lineIndex);return(a,i)=>(bt(),Dt("div",{class:ne(["mb-1 mt-1 relative ml-2 trackLine",[P(co).get(e.lineType),P(n)?"dark:bg-gray-700 bg-gray-400 bg-opacity-20":"bg-gray-200 bg-opacity-10",e.isMain?"bg-blue-500 bg-opacity-20":""]]),"data-index":e.lineIndex,"data-type":e.lineType},[(bt(!0),Dt(Ke,null,nr(e.lineData,(s,o)=>(bt(),Ee(Rm,{key:s.id,lineIndex:e.lineIndex,itemIndex:o,trackItem:s},null,8,["lineIndex","itemIndex","trackItem"]))),128))],10,Am))}}),Im=qr(Bm,[["__scopeId","data-v-f61e98b9"]]),Om={class:"absolute pt-10 pb-5 min-w-full flex flex-col justify-center min-h-full overflow-x-hidden left-0 right-0"},Pm=["title"],Lm=me({__name:"TrackListIcon",props:{listData:{type:Array,default(){return[]}},offsetTop:{type:Number,default:0}},setup(e){const t=e,r=new Map([["video",uo],["audio",T0],["text",D0],["image",mf]]),n=ie();return We(()=>t.offsetTop,()=>{n.value.scrollTop=t.offsetTop}),(a,i)=>{const s=Ue;return bt(),Dt("div",{ref_key:"iconList",ref:n,class:"relative w-12 flex h-full flex-col items-center justify-start overflow-y-hidden overflow-x-scroll border-r-2 dark:border-gray-700 border-gray-300 border-t"},[i[0]||(i[0]=mt("span",{class:"w-full h-5 sticky top-0 left-0 right-0 z-20"},null,-1)),mt("div",Om,[(bt(!0),Dt(Ke,null,nr(e.listData,(o,l)=>(bt(),Dt("div",{key:l,class:ne(["z-10 flex justify-center items-center w-12 text-center mb-1 mt-1",[P(co).get(o.type),o.main?"bg-blue-500 bg-opacity-20":""]]),title:o.main?"主轨道":""},[et(s,{size:"20"},{default:Tt(()=>[(bt(),Ee(Ln(P(r).get(o.type))))]),_:2},1024)],10,Pm))),128))])],512)}}}),Fm=me({__name:"TrackPlayPoint",setup(e){const t={left:10},r=ur(),n=Br(),a=se(()=>({left:`${t.left}px`,transform:`translate(${mr(r.trackScale,n.playStartFrame)}px, 0px)`})),i=ie(!1);function s(u){u.stopPropagation(),u.preventDefault(),n.isPause=!0,i.value=!0}function o(u){if(i.value){const c=document.getElementById("track-container").getBoundingClientRect(),d=Dn(u.pageX-t.left-c.left,r.trackScale,30)-1,p=d<0?0:d>r.frameCount?r.frameCount:d;n.playStartFrame=p}}document.addEventListener("mousemove",o);function l(u){i.value=!1}return document.addEventListener("mouseup",l),(u,c)=>(bt(),Dt("div",{class:"z-30 w-px absolute -top-5 bottom-0 bg-gray-700 dark:bg-gray-100 transition-transform duration-75",id:"trackPlayPoint",style:Te(a.value),onMousedown:s},c[0]||(c[0]=[mt("span",{class:"playPoint block border-1 border-gray-600 bg-gray-600 h-3 w-2.5 dark:border-gray-100 dark:bg-gray-100 sticky top-0 right-0 left-0 cursor-move"},null,-1)]),36))}}),zm=qr(Fm,[["__scopeId","data-v-86d34692"]]),Nm={class:"trackList flex flex-1 flex-row w-full overflow-x-hidden overflow-y-auto relative"},Vm={key:0,class:"flex justify-center items-center h-24 m-auto w-2/3 dark:bg-gray-500 bg-gray-200 rounded-md text-sm border-dashed border-2 dark:border-gray-500 border-gray-200 hover:dark:border-blue-300 hover:border-blue-400"},$m=me({__name:"TrackList",setup(e){const t=ur(),r=Br(),n=ie(),a=ie(),i={left:10,right:200},s=ie(0-i.left),o=ie(0),l=se(()=>t.trackScale),u=se(()=>({width:mr(l.value,t.frameCount)+i.right})),c=ie(-1),f=ie(0),d=ie(!0),p=se(()=>t.dragData.dragPoint);let v=ie(0);const h=se(()=>t.trackList.map((Rt,Mt)=>{Rt.main&&(v.value=Mt);const lt=Rt.list.map(Bt=>({...Bt,showWidth:`${mr(l.value,Bt.end-Bt.start)}px`,showLeft:`${mr(l.value,Bt.start)}px`}));return{...Rt,list:lt}}));function m(Rt,Mt,lt){Rt.preventDefault(),Rt.stopPropagation(),t.selectTrackItem.line=Mt,t.selectTrackItem.index=lt}function b(Rt){const Mt=Rt-1,lt=Mt<0?0:Mt;r.isPause=!0,r.playStartFrame=lt}let y=0;const S=_i(()=>{t.trackScale-=y>0?10:-10,y=0},100),C=Rt=>{(Rt.ctrlKey||Rt.metaKey)&&(Rt.preventDefault(),y||(y=Rt.deltaY),S())};function R(){const{scrollLeft:Rt,scrollTop:Mt}=n.value;s.value=Rt-i.left,o.value=Mt}let D={left:0,right:0,start:0,end:0},I=[],W;function G(Rt){const Mt=window.getComputedStyle(Rt);return{left:parseInt(Mt.left),right:parseInt(Mt.left)+parseInt(Mt.width)}}function F(Rt){if(W=Rt.target.closest(".trackItem"),!W)return;r.isPause=!0;const Mt=Number(W.dataset.line),lt=Number(W.dataset.index);t.dragData.dragPoint.x=Rt.pageX,t.dragData.dragPoint.y=Rt.pageY,t.dragData.dataInfo=t.trackList[Mt].list[lt],t.dragData.dragType=W.dataset.type,t.moveTrackData.lineIndex=Mt,t.moveTrackData.itemIndex=lt,t.selectTrackItem.line=-1,t.selectTrackItem.index=0;const Bt=t.trackList[Mt].list[lt];D={start:Bt.start,end:Bt.end,left:mr(t.trackScale,Bt.start),right:mr(t.trackScale,Bt.end)},I=[];for(let O=0;O<t.trackList.length;O++)for(let V=0;V<t.trackList[O].list.length;V++)if(O!==Mt||V!==lt){const _=t.trackList[O].list[V];I.push({start:_.start,end:_.end,left:mr(t.trackScale,_.start),right:mr(t.trackScale,_.end)})}}function X(Rt,Mt,{start:lt,end:Bt}){if(Rt.type!==Mt.type)return{overlap:!0,index:0};const O=Mt.list.filter(V=>V.id!==Rt.id);if(O.length===0)return{overlap:!1,index:0};if(O[0].start>=Bt)return{overlap:!1,index:0};if(O[O.length-1].end<=lt)return{overlap:!1,index:O.length};for(let V=0;V<O.length-1;V++){const _=O[V],Y=O[V+1];if(lt>=_.end&&Bt<=Y.start)return{overlap:!1,index:V+1}}return{overlap:!0,index:0}}function M(){const Rt=W.offsetTop+W.offsetHeight/2+W.offsetParent.offsetTop,Mt=Array.from(document.querySelectorAll(".trackLine"));if(Mt[0].offsetTop>Rt)return{isNewLine:!0,insertIndex:0};for(let lt=0;lt<Mt.length;lt++){const Bt=Mt[lt];if(Bt.offsetTop<=Rt&&Bt.offsetTop+Bt.offsetHeight>=Rt)return{isNewLine:!1,insertIndex:lt,elem:Bt};if(lt+1!==Mt.length){const O=Mt[lt+1];if(Bt.offsetTop+Bt.offsetHeight<=Rt&&O.offsetTop>=Rt)return{isNewLine:!0,insertIndex:lt+1}}}return{isNewLine:!0,insertIndex:Mt.length}}let st={left:0,right:0,start:0,end:0};function J(){let{isNewLine:Rt,insertIndex:Mt,elem:lt}=M();const Bt=G(W),O=st.left||Bt.left,V=st.right||Bt.right,_=st.start||Dn(O,t.trackScale,gr),Y=st.end||Dn(V,t.trackScale,gr);if(!lt)return{insertIndex:Mt,itemIndex:0,left:O,right:V,isNewLine:Rt,start:_,end:Y};const ot=t.dragData.dataInfo,_t=t.trackList[Mt],{overlap:Ct,index:Vt}=X(ot,_t,{start:_,end:Y});return Ct&&(Rt=!0,lt.offsetLeft+lt.offsetWidth/2<W.offsetTop+W.offsetParent.offsetTop+W.offsetHeight/2&&(Mt-=1)),{insertIndex:Mt,itemIndex:Vt,left:O,right:V,isNewLine:Rt,start:_,end:Y}}function pt(Rt,Mt=10){const lt=[];I.forEach(O=>{Math.abs(O.left-Rt)<=Mt&&lt.push({position:O.left,frame:O.start}),Math.abs(O.right-Rt)<=Mt&&lt.push({position:O.right,frame:O.end})});const Bt=mr(t.trackScale,r.playStartFrame);return Math.abs(Bt-Rt)<=Mt&&lt.push({position:Bt,frame:r.playStartFrame}),lt}function zt({left:Rt,right:Mt},lt){if(st={left:0,right:0,start:0,end:0},lt[0].length===0&&lt[1].length===0)return;const Bt=lt[0].reduce((V,_)=>Math.abs(_.position-Rt)<Math.abs(V.position-Rt)?_:V,{position:Number.MAX_SAFE_INTEGER,frame:0}),O=lt[1].reduce((V,_)=>Math.abs(_.position-Mt)<Math.abs(V.position-Mt)?_:V,{position:Number.MAX_SAFE_INTEGER,frame:0});Math.abs(Bt.position-Rt)<Math.abs(O.position-Mt)?(st.left=Bt.position,st.start=Bt.frame,t.dragData.moveX=Bt.position-D.left):(st.right=O.position,st.end=O.frame,t.dragData.moveX=O.position-D.right)}function Xt(Rt){if(W){t.dragData.moveX=Rt.pageX-t.dragData.dragPoint.x,t.dragData.moveY=Rt.pageY-t.dragData.dragPoint.y;const Mt=t.dragData.moveX+D.left,lt=t.dragData.moveX+D.right;t.dragData.fixLines=[pt(Mt),pt(lt)],zt({left:Mt,right:lt},t.dragData.fixLines)}}function Ht(Rt){let Mt=t.dragData.dataInfo;const lt=Math.max(st.right!==0?Dn(Rt.right,t.trackScale,gr)-(Mt.end-Mt.start):Dn(Rt.left,t.trackScale,gr),0);Mt.end=lt+(Mt.end-Mt.start),Mt.start=lt;const Bt=Mt;let O=0,V=0;t.trackList.forEach((Y,ot)=>{Y.list.forEach((_t,Ct)=>{_t.id===Mt.id&&(O=ot,V=Ct)})}),t.trackList[O].list.splice(V,1),Rt.isNewLine?t.trackList.splice(Rt.insertIndex,0,{type:Bt.type,list:[Bt]}):t.trackList[Rt.insertIndex].list.splice(Rt.itemIndex,0,Bt);const _=t.trackList.findIndex(Y=>Y.list.length===0);_!==-1&&t.trackList.splice(_,1)}function Nt(Rt){if(W){t.dragData.moveX=Rt.pageX-t.dragData.dragPoint.x,t.dragData.moveY=Rt.pageY-t.dragData.dragPoint.y;const Mt=t.dragData.moveX+D.left,lt=t.dragData.moveX+D.right;t.dragData.fixLines=[pt(Mt),pt(lt)],zt({left:Mt,right:lt},t.dragData.fixLines);const Bt=J();Ht(Bt),W=null}t.dragData.fixLines=[],t.moveTrackData.lineIndex=-1,t.moveTrackData.itemIndex=-1,t.dragData.moveX=0,t.dragData.moveY=0}function yt(Rt){const Mt=a.value,{left:lt}=Mt.getBoundingClientRect(),{clientX:Bt}=Rt,{x:O}=p.value,V=Bt-lt-O;f.value=V<0?0:V}async function It(){const Rt=Dn(f.value,t.trackScale,gr),Mt=await t.createTrack(t.dragData.dataInfo,Rt);t.addTrack(Mt),f.value=0,t.dragData.dataInfo={},t.moveTrackData.lineIndex=-1,t.moveTrackData.itemIndex=-1,t.dragData.moveX=0,t.dragData.moveY=0}return(Rt,Mt)=>(bt(),Dt("div",Nm,[et(Lm,{listData:h.value,offsetTop:o.value},null,8,["listData","offsetTop"]),mt("div",{class:"flex-1 overflow-x-scroll overflow-y-auto flex-col shrink-0 grow relative",ref_key:"trackList",ref:n,onScroll:R,onWheel:C,onClick:Mt[0]||(Mt[0]=lt=>m(lt,-1,-1))},[et(K2,{start:s.value,scale:l.value,step:P(gr),focusPosition:P(t).selectTrack,onSelectFrame:b},null,8,["start","scale","step","focusPosition"]),mt("div",{class:"absolute top-5 flex shrink-0 grow min-w-full",style:{"min-height":"calc(100% - 20px)"},ref_key:"trackListContainer",ref:a,onMousedown:F,onMousemove:Xt,onMouseup:Nt,onMouseleave:Nt,onDragover:dn(yt,["stop","prevent"]),onDrop:It},[h.value.length===0?(bt(),Dt("div",Vm,[et(uo,{class:"text-xl mr-4"}),Mt[1]||(Mt[1]=Ye(" 将素材拖拽到这里，开始编辑你的大作吧~ "))])):(bt(),Dt("div",{key:1,class:"z-10 pt-5 pb-5 min-w-full flex shrink-0 grow flex-col justify-center min-h-full",style:Te({width:`${u.value.width}px`}),id:"track-container"},[(bt(!0),Dt(Ke,null,nr(h.value,(lt,Bt)=>(bt(),Ee(Im,{key:lt.list.reduce((O,V)=>O+V.id,"line"),style:Te({"margin-left":`${i.left}px`}),class:ne([c.value===Bt?d.value?"showLine-t":"showLine-b":""]),lineType:lt.type,isActive:P(t).selectTrackItem.line===Bt,lineIndex:Bt,isMain:lt.main,lineData:lt.list},null,8,["style","class","lineType","isActive","lineIndex","isMain","lineData"]))),128))],4)),rr(et(zm,null,null,512),[[vn,h.value.length!==0]]),h.value.length!==0?(bt(!0),Dt(Ke,{key:2},nr(P(t).dragData.fixLines.reduce((lt,Bt)=>lt.concat(Bt),[]),(lt,Bt)=>(bt(),Dt("div",{key:Bt,class:"z-30 w-px absolute -top-5 bottom-0 bg-yellow-300 dark:bg-yellow-300 pointer-events-none",style:Te({left:`${lt.position+10}px`})},null,4))),128)):xe("",!0),h.value.length!==0&&f.value!==0?(bt(),Dt("div",{key:3,class:"z-30 w-px absolute -top-5 bottom-0 bg-yellow-300 dark:bg-yellow-300",style:Te({left:`${f.value}px`})},null,4)):xe("",!0)],544)],544)]))}}),Hm=me({__name:"TrackContainer",setup(e){const t=Jn(),r=ur(),n=se(()=>({height:`${t.trackHeight}px`}));return(a,i)=>(bt(),Dt("div",{class:"overflow-hidden select-none relative pt-2 flex flex-col dark:bg-night-light bg-white rounded",style:Te(P(n))},[et(X2,{modelValue:P(r).trackScale,"onUpdate:modelValue":i[0]||(i[0]=s=>P(r).trackScale=s)},null,8,["modelValue"]),et($m)],4))}}),g0=me({__name:"SplitLine",props:{disabled:{type:Boolean,default:!1},newWidth:{type:Number,default:0},newHeight:{type:Number,default:0},direction:{type:String,default:"horizontal"},limitSize:{type:Object,default(){return{minHeight:0,maxHeight:999999,minWidth:0,maxWidth:999999}}}},emits:{"update:newWidth":e=>e!==null,"update:newHeight":e=>e!==null},setup(e,{emit:t}){const r=e,n=t,a=se({get(){return r.newWidth},set(p){n("update:newWidth",p)}}),i=se({get(){return r.newHeight},set(p){n("update:newHeight",p)}}),s=ie(),o=Jn(),l=se(()=>r.direction==="vertical"),u=se(()=>o.isDark?"#E5E7EB":"#1F2937"),c={left:0,top:0};let f=!1;function d(){if(r.disabled)return;const{left:p,top:v}=s.value.getBoundingClientRect();c.left=parseInt(p),c.top=parseInt(v),f=!0,document.onmousemove=h=>{if(!f)return;const{pageX:m,pageY:b}=h,{top:y,left:S}=c,{minHeight:C,maxHeight:R,minWidth:D,maxWidth:I}=r.limitSize,W=m-S,G=b-y;if(c.left=m,c.top=b,l.value){const F=a.value-W;a.value=F>I?I:F<D?D:F}else{const F=i.value-G;i.value=F>R?R:F<C?C:F}},document.onmouseup=()=>{f=!1,document.onmouseup=null,document.onmousemove=null}}return(p,v)=>{const h=Ue;return bt(),Dt("div",{ref_key:"lineElement",ref:s,class:ne(["flex justify-center items-center",[e.disabled?"cursor-no-drop":l.value?"cursor-c-resize":"cursor-r-resize",l.value?"w-2 h-full flex-col":"h-2 w-full flex-row"]]),onMousedown:d},[mt("span",{class:ne(["absolute flex z-10 dark:bg-gray-800 bg-gray-200",l.value?"h-8 w-4 flex-col":"w-8 h-4 flex-row"])},[et(h,{class:ne(["flex-auto",l.value?"rotate-90":""]),color:u.value},{default:Tt(()=>[et(P(_f))]),_:1},8,["class","color"])],2)],34)}}}),Gm={class:"flex items-center gap-2 w-full"},Wm=["onClick"],kc=me({__name:"MenuList",props:{activeIndex:{},menu:{}},emits:["update:activeIndex"],setup(e,{emit:t}){const r=t;function n(a){r("update:activeIndex",a)}return(a,i)=>{const s=Ue;return bt(),Dt("ul",Gm,[(bt(!0),Dt(Ke,null,nr(a.menu,(o,l)=>(bt(),Dt("li",{key:o.key,class:"flex items-center p-2 cursor-pointer hover:dark:bg-gray-700 hover:bg-gray-200",onClick:u=>n(l)},[et(s,{color:l===a.activeIndex?"#1473e6":"",size:o.iconSize??14,class:"flex-auto mr-1"},{default:Tt(()=>[(bt(),Ee(Ln(o.icon)))]),_:2},1032,["color","size"]),mt("span",{class:ne(["ml-0.5 select-none text-xs font-bold",l===a.activeIndex?"text-[#1473e6]":"dark:text-gray-300 text-gray-500"])},ye(o.title),3)],8,Wm))),128))])}}}),Xm="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='44'%20height='44'%20viewBox='0%200%2044%2044'%20fill='none'%3e%3cpath%20d='M22%204C19.6362%204%2017.2956%204.46558%2015.1117%205.37017C12.9278%206.27475%2010.9435%207.60062%209.27208%209.27208C7.60062%2010.9435%206.27475%2012.9278%205.37017%2015.1117C4.46558%2017.2956%204%2019.6362%204%2022C4%2024.3638%204.46558%2026.7044%205.37017%2028.8883C6.27475%2031.0722%207.60062%2033.0565%209.27208%2034.7279C10.9435%2036.3994%2012.9278%2037.7253%2015.1117%2038.6298C17.2956%2039.5344%2019.6362%2040%2022%2040C26.7739%2040%2031.3523%2038.1036%2034.7279%2034.7279C38.1036%2031.3523%2040%2026.7739%2040%2022C40%2017.2261%2038.1036%2012.6477%2034.7279%209.27208C31.3523%205.89642%2026.7739%204%2022%204ZM0%2022C0%209.85%209.85%200%2022%200C34.15%200%2044%209.85%2044%2022C44%2034.15%2034.15%2044%2022%2044C9.85%2044%200%2034.15%200%2022ZM16%2014V22H12V14H16ZM32%2014V22H28V14H32ZM31.436%2025.56L30.936%2027.5C30.398%2029.59%2029.35%2031.29%2027.71%2032.434C26.098%2033.56%2024.126%2034%2022%2034H20V30H22C23.6%2030%2024.686%2029.666%2025.42%2029.154C26.126%2028.662%2026.714%2027.862%2027.064%2026.502L27.562%2024.564L31.436%2025.56Z'%20fill='%234D5FFF'/%3e%3c/svg%3e",Ym=""+new URL("thinking-CeJ7EOuC.gif",import.meta.url).href,Um={class:"w-full h-full overflow-hidden flex flex-col items-center gap-4"},jm={ref:"contentChatText",class:"flex-1 w-full flex flex-col mt-4 overflow-auto gap-4"},qm={class:"avatar"},Km={key:0,src:Xm},Zm={key:1,src:Ym},Qm={class:"chat-textbox"},Jm=["onClick"],t_={key:2,class:"flex items-center mt-2 gap-3"},e_=["onClick"],r_=["onClick"],n_={class:"w-full"},a_={class:"flex items-center w-full gap-2"},i_={class:"w-22"},s_={class:"flex-1"},o_=me({__name:"TextGenerate",setup(e){const{toClipboard:t}=Nf();ta();const r=ie(!1),n=ie(""),a=ie(null),i=ie(),s=ie(""),o=Pr({style:"Promotional video",messages:[]}),l=()=>{var v;(v=a.value)==null||v.click()},u=v=>{var b;const m=(b=v.target.files)==null?void 0:b[0];m&&(i.value=m,s.value=m.name)},c=()=>{if(!i.value&&!n.value){qe.warning("请输入文字或上传文件");return}n.value?o.messages.push({role:"user",content:n.value}):o.messages.push({role:"user",content:"请解析该文件并扩写"}),o.messages.push({role:"system",content:"这是一个扩写后的文本内容示例。在前端模式下，暂不支持AI生成功能。",loading:0}),n.value="",i.value=null,s.value=""},f=v=>{o.messages.push({role:"user",content:"请输出分镜头脚本"}),o.messages.push({role:"system",content:"这是一个分镜头脚本示例。在前端模式下，暂不支持AI分镜头脚本生成功能。",loading:0})},d=async v=>{try{await t(v),qe.success("复制成功")}catch(h){console.error(h)}},p=()=>{o.messages.pop(),c()};return(v,h)=>{const m=Sf,b=Ue,y=Ur,S=ea,C=Bi,R=Ii,D=R0,I=Ia,W=Gr,G=jr;return bt(),Dt("div",Um,[mt("div",jm,[(bt(!0),Dt(Ke,null,nr(o.messages,(F,X)=>(bt(),Dt("div",{key:X,class:ne(["chat-item text-sm","chat-item-"+F.role])},[mt("div",qm,[F.role==="system"&&!F.loading?(bt(),Dt("img",Km)):xe("",!0),F.role==="system"&&F.loading?(bt(),Dt("img",Zm)):xe("",!0),F.role==="user"?(bt(),Ee(b,{key:2,size:"20",class:"mt-[-2px]"},{default:Tt(()=>[et(m)]),_:1})):xe("",!0)]),mt("div",Qm,[F.edit?(bt(),Ee(y,{key:1,type:"textarea",modelValue:F.content,"onUpdate:modelValue":M=>F.content=M,autosize:"",onMouseleave:M=>F.edit=!1,class:"text-xs text-white w-[250px]"},null,8,["modelValue","onUpdate:modelValue","onMouseleave"])):(bt(),Dt("div",{key:0,class:"text-xs select-text text-white",onClick:M=>F.edit=!0},ye(F.content),9,Jm)),F.role==="system"?(bt(),Dt("div",t_,[mt("button",{onClick:()=>d(F.content)},[et(b,{color:"white"},{default:Tt(()=>[et(P(bf))]),_:1})],8,e_),X===o.messages.length-1?(bt(),Dt("button",{key:0,onClick:h[0]||(h[0]=()=>p())},[et(b,{color:"white"},{default:Tt(()=>[et(P(xf))]),_:1})])):xe("",!0),mt("button",{onClick:()=>f(F.content)},[et(b,{color:"white"},{default:Tt(()=>[et(P(yf))]),_:1})],8,r_)])):xe("",!0)])],2))),128))],512),mt("div",n_,[i.value?(bt(),Ee(S,{key:0,type:"primary",class:"my-2 text-xs dark:text-white",closable:"",onClose:h[1]||(h[1]=F=>i.value=null)},{default:Tt(()=>[mt("span",null,"上传文件："+ye(s.value),1)]),_:1})):xe("",!0),rr((bt(),Dt("div",a_,[mt("div",i_,[et(R,{modelValue:o.style,"onUpdate:modelValue":h[2]||(h[2]=F=>o.style=F),placeholder:"风格"},{default:Tt(()=>[et(C,{value:"Promotional video",label:"宣传片"}),et(C,{value:"Movie",label:"电影"}),et(C,{value:"Ad",label:"广告"}),et(C,{value:"E-commerce",label:"电商"}),et(C,{value:"Custom",label:"自定义"})]),_:1},8,["modelValue"])]),mt("div",s_,[et(y,{modelValue:n.value,"onUpdate:modelValue":h[3]||(h[3]=F=>n.value=F),class:"mr-4",placeholder:i.value?`上传文件：${s.value}`:"输入提示词",disabled:i.value,onKeyup:Jr(c,["enter"])},{suffix:Tt(()=>[et(b,{class:"cursor-pointer",size:"18",onClick:l},{default:Tt(()=>[et(D)]),_:1}),mt("input",{ref_key:"fileInputRef",ref:a,class:"file-input",type:"file",name:"file",accept:".txt, .pdf, .doc, .docx",hidden:"",onChange:u},null,544)]),_:1},8,["modelValue","placeholder","disabled"])]),et(W,{class:"dark:bg-purple-heavy",circle:"",onClick:c},{default:Tt(()=>[et(I)]),_:1})])),[[G,r.value]])])])}}}),l_=qr(o_,[["__scopeId","data-v-4a71f24c"]]),u_={class:"w-full h-full overflow-hidden flex flex-col items-center gap-4"},c_={class:"flex-1 w-full overflow-auto"},f_={class:"flex items-center w-full gap-2"},d_={class:"w-32"},v_={class:"grid-container2"},h_=["onClick"],p_={class:"grid-container"},g_=["onClick"],m_=["src"],__=me({__name:"ImageGenerate",setup(e){const t=ta(),{getResourcesByType:r}=t,n=ie(!1),a=Pr({prompt:"",keywords:[],model:"doubao",size:""}),i=()=>{if(!a.prompt){qe.error("请输入文字描述");return}qe.info("前端模式下暂不支持AI图片生成功能")},s=o=>{a.keywords.includes(o)?a.keywords=a.keywords.filter(l=>l!=o):a.keywords.push(o)};return(o,l)=>{const u=Bi,c=Ii,f=A0,d=Ue,p=Ai,v=B0,h=Ur,m=Ia,b=Gr,y=jr;return bt(),Dt("div",u_,[mt("div",c_,[et(Pa,{"list-data":P(r)("image").value,type:"image"},null,8,["list-data"])]),rr((bt(),Dt("div",f_,[mt("div",d_,[et(c,{modelValue:a.model,"onUpdate:modelValue":l[0]||(l[0]=S=>a.model=S),placeholder:""},{default:Tt(()=>[et(u,{value:"即梦",label:"doubao"})]),_:1},8,["modelValue"])]),et(h,{modelValue:a.prompt,"onUpdate:modelValue":l[1]||(l[1]=S=>a.prompt=S),placeholder:"请输入提示词",onKeyup:Jr(i,["enter"])},{suffix:Tt(()=>[et(p,{trigger:"click",width:"280"},{reference:Tt(()=>[et(d,{size:18,class:"cursor-pointer mr-2"},{default:Tt(()=>[et(f)]),_:1})]),default:Tt(()=>[mt("div",v_,[(bt(!0),Dt(Ke,null,nr(P(Bf),(S,C)=>(bt(),Dt("div",{key:C,class:"item",onClick:R=>s(S)},[mt("span",{class:ne(["text",{active:a.keywords.includes(S)}])},ye(S),3)],8,h_))),128))])]),_:1}),et(p,{trigger:"click"},{reference:Tt(()=>[et(d,{size:18,class:"cursor-pointer"},{default:Tt(()=>[et(v)]),_:1})]),default:Tt(()=>[mt("div",p_,[(bt(!0),Dt(Ke,null,nr(P(Cs),(S,C)=>(bt(),Dt("div",{key:C,class:"item",onClick:R=>a.size=S.text},[mt("img",{class:"icon",src:S.img},null,8,m_),mt("span",{class:ne(["text",{active:S.text==a.size}])},ye(S.text),3)],8,g_))),128))])]),_:1})]),_:1},8,["modelValue"]),et(b,{class:"dark:bg-purple-heavy",circle:"",onClick:i},{default:Tt(()=>[et(m)]),_:1})])),[[y,n.value]])])}}}),Tc=qr(__,[["__scopeId","data-v-69d5a2ee"]]),b_={class:"w-full flex-1 overflow-hidden flex flex-col items-center gap-4"},x_={class:"flex-1 w-full overflow-auto"},y_={class:"flex items-center w-full gap-2"},S_={class:"w-20"},w_={class:"flex-1"},C_=["onClick"],E_=me({__name:"MusicGenerate",setup(e){const t=ta(),{getResourcesByType:r}=t,n=ie(!1),a=Pr({prompt:"",style:"Electronic music",len:4}),i=()=>{if(!a.prompt){qe.error("请输入文字描述");return}qe.info("前端模式下暂不支持AI音乐生成功能")};return(s,o)=>{const l=Pa,u=Bi,c=Ii,f=wf,d=Ue,p=Ai,v=Ur,h=Ia,m=Gr,b=jr;return bt(),Dt("div",b_,[mt("div",x_,[et(l,{"list-data":P(r)("audio").value,type:"audio"},null,8,["list-data"])]),rr((bt(),Dt("div",y_,[mt("div",S_,[et(c,{modelValue:a.style,"onUpdate:modelValue":o[0]||(o[0]=y=>a.style=y),placeholder:"风格"},{default:Tt(()=>[(bt(!0),Dt(Ke,null,nr(P(If),(y,S)=>(bt(),Ee(u,{key:S,value:y.value,label:y.text},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),mt("div",w_,[et(v,{modelValue:a.prompt,"onUpdate:modelValue":o[1]||(o[1]=y=>a.prompt=y),placeholder:"请输入提示词",onKeyup:Jr(i,["enter"])},{suffix:Tt(()=>[et(p,{trigger:"click",width:80},{reference:Tt(()=>[et(d,{size:18,class:"cursor-pointer"},{default:Tt(()=>[et(f)]),_:1})]),default:Tt(()=>[mt("div",null,[(bt(!0),Dt(Ke,null,nr(P(Of),(y,S)=>(bt(),Dt("div",{class:ne(["time-text m-2 cursor-pointer",{active:y==a.len}]),key:S,onClick:C=>a.len=y},ye(y)+"s ",11,C_))),128))])]),_:1})]),_:1},8,["modelValue"])]),et(m,{class:"dark:bg-purple-heavy",circle:"",onClick:i},{default:Tt(()=>[et(h)]),_:1})])),[[b,n.value]])])}}}),Dc=qr(E_,[["__scopeId","data-v-38d15245"]]),M_={class:"w-full h-full overflow-hidden flex flex-col items-center gap-4"},k_={class:"flex-1 w-full overflow-auto"},T_={class:"w-full"},D_=["title"],R_={class:"flex items-center w-full gap-2"},A_={class:"grid-container2"},B_=["onClick"],I_=["src"],O_={class:"grid-container"},P_=["onClick"],L_=["src"],F_=me({__name:"VideoGenerate",setup(e){const t=ta(),r=ie(!1),n=ie(null),a=ie(""),i=Pr({prompt:"",imageUrl:"",sizeStr:Cs[0].value,style:"Anime Style"}),s=()=>{var u;(u=n.value)==null||u.click()},o=u=>{var d;const f=(d=u.target.files)==null?void 0:d[0];f&&(a.value=f.name,i.imageUrl=URL.createObjectURL(f))},l=()=>{if(!i.prompt){qe.error("请输入文字描述");return}i.imageUrl?qe.info("前端模式下暂不支持图片生成视频功能"):qe.info("前端模式下暂不支持文字生成视频功能")};return(u,c)=>{const f=Pa,d=ea,p=R0,v=Ue,h=A0,m=Ai,b=B0,y=Ur,S=Ia,C=Gr,R=jr;return bt(),Dt("div",M_,[mt("div",k_,[et(f,{"list-data":P(t).videoList,type:"video"},null,8,["list-data"])]),mt("div",T_,[P(i).imageUrl?(bt(),Ee(d,{key:0,type:"primary",class:"my-2 text-xs dark:text-white",closable:"",onClose:c[0]||(c[0]=D=>P(i).imageUrl="")},{default:Tt(()=>[mt("span",{title:P(a),class:"inline-block max-w-[300px] overflow-ellipsis overflow-hidden whitespace-nowrap"},"上传文件："+ye(P(a)),9,D_)]),_:1})):xe("",!0),rr((bt(),Dt("div",R_,[et(y,{modelValue:P(i).prompt,"onUpdate:modelValue":c[1]||(c[1]=D=>P(i).prompt=D),placeholder:"请输入提示词",onKeyup:Jr(l,["enter"])},{suffix:Tt(()=>[et(v,{class:"cursor-pointer mr-2",size:"18",onClick:s},{default:Tt(()=>[et(p)]),_:1}),mt("input",{ref_key:"fileInputRef",ref:n,class:"file-input",type:"file",name:"file",accept:"image/*",hidden:"",onChange:o},null,544),et(m,{trigger:"click",width:"325"},{reference:Tt(()=>[et(v,{size:18,class:"cursor-pointer mr-2"},{default:Tt(()=>[et(h)]),_:1})]),default:Tt(()=>[mt("div",A_,[(bt(!0),Dt(Ke,null,nr(P(Pf),(D,I)=>(bt(),Dt("div",{key:I,class:"item",onClick:W=>P(i).style=D.value},[mt("img",{class:"img",src:D.img},null,8,I_),mt("span",{class:ne(["text",{active:D.value==P(i).style}])},ye(D.text),3)],8,B_))),128))])]),_:1}),et(m,{trigger:"click"},{reference:Tt(()=>[et(v,{size:18,class:"cursor-pointer"},{default:Tt(()=>[et(b)]),_:1})]),default:Tt(()=>[mt("div",O_,[(bt(!0),Dt(Ke,null,nr(P(Cs),(D,I)=>(bt(),Dt("div",{key:I,class:"item",onClick:W=>P(i).sizeStr=D.value},[mt("img",{class:"icon",src:D.img},null,8,L_),mt("span",{class:ne(["text",{active:D.value==P(i).sizeStr}])},ye(D.text),3)],8,P_))),128))])]),_:1})]),_:1},8,["modelValue"]),et(C,{class:"dark:bg-purple-heavy",circle:"",onClick:l},{default:Tt(()=>[et(S)]),_:1})])),[[R,P(r)]])])])}}}),Rc=qr(F_,[["__scopeId","data-v-e6b42667"]]);var Ac={exports:{}};(function(e){(function(t){var r=typeof window=="object"&&!!window.document,n=r?window:Object;t(n,r),e.exports&&(e.exports=n.Recorder)})(function(t,r){var n=function(){},a=function(O){return typeof O=="number"},i=function(O){return JSON.stringify(O)},s=function(O){return new Xt(O)},o=s.LM="2024-10-20 22:15",l="https://github.com/xiangyuecn/Recorder",u="Recorder",c="getUserMedia",f="srcSampleRate",d="sampleRate",p="bitRate",v="catch",h=t[u];if(h&&h.LM==o){h.CLog(h.i18n.$T("K8zP::重复导入{1}",0,u),3);return}s.IsOpen=function(){var O=s.Stream;if(O){var V=st(O),_=V[0];if(_){var Y=_.readyState;return Y=="live"||Y==_.LIVE}}return!1},s.BufferSize=4096,s.Destroy=function(){J(u+" Destroy"),X();for(var O in m)m[O]()};var m={};s.BindDestroy=function(O,V){m[O]=V},s.Support=function(){if(!r)return!1;var O=navigator.mediaDevices||{};return O[c]||(O=navigator,O[c]||(O[c]=O.webkitGetUserMedia||O.mozGetUserMedia||O.msGetUserMedia)),!(!O[c]||(s.Scope=O,!s.GetContext()))},s.GetContext=function(O){if(!r)return null;var V=window.AudioContext;if(V||(V=window.webkitAudioContext),!V)return null;var _=s.Ctx,Y=0;return _||(_=s.Ctx=new V,Y=1,s.NewCtxs=s.NewCtxs||[],s.BindDestroy("Ctx",function(){var ot=s.Ctx;ot&&ot.close&&(b(ot),s.Ctx=0);var _t=s.NewCtxs;s.NewCtxs=[];for(var Ct=0;Ct<_t.length;Ct++)b(_t[Ct])})),O&&_.close&&(Y||(_._useC||b(_),_=new V),_._useC=1,s.NewCtxs.push(_)),_},s.CloseNewCtx=function(O){if(O&&O.close){b(O);for(var V=s.NewCtxs||[],_=V.length,Y=0;Y<V.length;Y++)if(V[Y]==O){V.splice(Y,1);break}J(lt("mSxV::剩{1}个GetContext未close",0,_+"-1="+V.length),V.length?3:0)}};var b=function(O){if(O&&O.close&&!O._isC&&(O._isC=1,O.state!="closed"))try{O.close()}catch(V){J("ctx close err",1,V)}},y=s.ResumeCtx=function(O,V,_,Y){var ot=0,_t=0,Ct=0,Vt=0,jt="EventListener",Gt="ResumeCtx ",Pt=function(te,Ut){_t&&de(),ot||(ot=1,te&&Y(te,Vt),Ut&&_(Vt)),Ut&&(!O._LsSC&&O["add"+jt]&&O["add"+jt]("statechange",Qt),O._LsSC=1,Ct=1)},de=function(te){if(!(te&&_t)){_t=te?1:0;for(var Ut=["focus","mousedown","mouseup","touchstart","touchend"],_e=0;_e<Ut.length;_e++)window[(te?"add":"remove")+jt](Ut[_e],Qt,!0)}},Qt=function(){var te=O.state,Ut=S(te);if(!ot&&!V(Ut?++Vt:Vt))return Pt();Ut?(Ct&&J(Gt+"sc "+te,3),de(1),O.resume().then(function(){Ct&&J(Gt+"sc "+O.state),Pt(0,1)})[v](function(_e){J(Gt+"error",1,_e),S(O.state)||Pt(_e.message||"error")})):te=="closed"?(Ct&&!O._isC&&J(Gt+"sc "+te,1),Pt("ctx closed")):Pt(0,1)};Qt()},S=s.CtxSpEnd=function(O){return O=="suspended"||O=="interrupted"},C=function(O){var V=O.state,_="ctx.state="+V;return S(V)&&(_+=lt("nMIy::（注意：ctx不是running状态，rec.open和start至少要有一个在用户操作(触摸、点击等)时进行调用，否则将在rec.start时尝试进行ctx.resume，可能会产生兼容性问题(仅iOS)，请参阅文档中runningContext配置）")),_},R="ConnectEnableWebM";s[R]=!0;var D="ConnectEnableWorklet";s[D]=!1;var I=function(O){var V=O.BufferSize||s.BufferSize,_=O.Stream,Y=_._c,ot=Y[d],_t={},Ct=st(_),Vt=Ct[0],jt=null,Gt="";if(Vt&&Vt.getSettings){jt=Vt.getSettings();var Pt=jt[d];Pt&&Pt!=ot&&(Gt=lt("eS8i::Stream的采样率{1}不等于{2}，将进行采样率转换（注意：音质不会变好甚至可能变差），主要在移动端未禁用回声消除时会产生此现象，浏览器有回声消除时可能只会返回16k采样率的音频数据，",0,Pt,ot))}_._ts=jt,J(Gt+"Stream TrackSet: "+i(jt),Gt?3:0);var de=function(rt){var g=_._m=Y.createMediaStreamSource(_),T=Y.destination,U="createMediaStreamDestination";Y[U]&&(T=_._d=Y[U]()),g.connect(rt),rt.connect(T)},Qt,te,Ut,_e="",$=_._call,ct=function(rt,g){for(var T in $){if(g!=ot){_t.index=0,_t=s.SampleData([rt],g,ot,_t,{_sum:1});var U=_t.data,tt=_t._sum}else{_t={};for(var N=rt.length,U=new Int16Array(N),tt=0,A=0;A<N;A++){var z=Math.max(-1,Math.min(1,rt[A]));z=z<0?z*32768:z*32767,U[A]=z,tt+=Math.abs(z)}}for(var k in $)$[k](U,tt);return}},ht="ScriptProcessor",Z="audioWorklet",Lt=u+" "+Z,j="RecProc",nt="MediaRecorder",At=nt+".WebM.PCM",ft=Y.createScriptProcessor||Y.createJavaScriptNode,kt=lt("ZGlf::。由于{1}内部1秒375次回调，在移动端可能会有性能问题导致回调丢失录音变短，PC端无影响，暂不建议开启{1}。",0,Z),Q=function(){te=_.isWorklet=!1,G(_),J(lt("7TU0::Connect采用老的{1}，",0,ht)+Mt.get(s[D]?lt("JwCL::但已设置{1}尝试启用{2}",2):lt("VGjB::可设置{1}尝试启用{2}",2),[u+"."+D+"=true",Z])+_e+kt,3);var rt=_._p=ft.call(Y,V,1,1);de(rt),rt.onaudioprocess=function(g){var T=g.inputBuffer.getChannelData(0);ct(T,ot)}},Ot=function(){Qt=_.isWebM=!1,F(_),te=_.isWorklet=!ft||s[D];var rt=window.AudioWorkletNode;if(!(te&&Y[Z]&&rt)){Q();return}var g=function(){var A=function(k){return k.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,Lt)},z="class "+j+" extends AudioWorkletProcessor{";return z+="constructor "+A(function(k){DEL_super(k);var K=this,w=k.processorOptions.bufferSize;K.bufferSize=w,K.buffer=new Float32Array(w*2),K.pos=0,K.port.onmessage=function(gt){gt.data.kill&&(K.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",k)}),z+="process "+A(function(k,K,w){var gt=this,B=gt.bufferSize,L=gt.buffer,H=gt.pos;if(k=(k[0]||[])[0]||[],k.length){L.set(k,H),H+=k.length;var q=~~(H/B)*B;if(q){this.port.postMessage({val:L.slice(0,q)});var ut=L.subarray(q,H);L=new Float32Array(B*2),L.set(ut),H=ut.length,gt.buffer=L}gt.pos=H}return!gt.kill}),z+='}try{registerProcessor("'+j+'", '+j+')}catch(e){$C.error("'+Lt+' Reg Error",e)}',z=z.replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(z)))},T=function(){return te&&_._na},U=_._na=function(){Ut!==""&&(clearTimeout(Ut),Ut=setTimeout(function(){Ut=0,T()&&(J(lt("MxX1::{1}未返回任何音频，恢复使用{2}",0,Z,ht),3),ft&&Q())},500))},tt=function(){if(T()){var A=_._n=new rt(Y,j,{processorOptions:{bufferSize:V}});de(A),A.port.onmessage=function(z){Ut&&(clearTimeout(Ut),Ut=""),T()?ct(z.data.val,ot):te||J(lt("XUap::{1}多余回调",0,Z),3)},J(lt("yOta::Connect采用{1}，设置{2}可恢复老式{3}",0,Z,u+"."+D+"=false",ht)+_e+kt,3)}},N=function(){if(T()){if(Y[j]){tt();return}var A=g();Y[Z].addModule(A).then(function(z){T()&&(Y[j]=1,tt(),Ut&&U())})[v](function(z){J(Z+".addModule Error",1,z),T()&&Q()})}};y(Y,function(){return T()},N,N)},at=function(){var rt=window[nt],g="ondataavailable",T="audio/webm; codecs=pcm";Qt=_.isWebM=s[R];var U=rt&&g in rt.prototype&&rt.isTypeSupported(T);if(_e=U?"":lt("VwPd::（此浏览器不支持{1}）",0,At),!Qt||!U){Ot();return}var tt=function(){return Qt&&_._ra};_._ra=function(){Ut!==""&&(clearTimeout(Ut),Ut=setTimeout(function(){tt()&&(J(lt("vHnb::{1}未返回任何音频，降级使用{2}",0,nt,Z),3),Ot())},500))};var N=Object.assign({mimeType:T},s.ConnectWebMOptions),A=_._r=new rt(_,N),z=_._rd={};A[g]=function(k){var K=new FileReader;K.onloadend=function(){if(tt()){var w=Ht(new Uint8Array(K.result),z);if(!w)return;if(w==-1){Ot();return}Ut&&(clearTimeout(Ut),Ut=""),ct(w,z.webmSR)}else Qt||J(lt("O9P7::{1}多余回调",0,nt),3)},K.readAsArrayBuffer(k.data)},A.start(~~(V/48)),J(lt("LMEm::Connect采用{1}，设置{2}可恢复使用{3}或老式{4}",0,At,u+"."+R+"=false",Z,ht))};at()},W=function(O){O._na&&O._na(),O._ra&&O._ra()},G=function(O){O._na=null,O._n&&(O._n.port.postMessage({kill:!0}),O._n.disconnect(),O._n=null)},F=function(O){if(O._ra=null,O._r){try{O._r.stop()}catch(V){J("mr stop err",1,V)}O._r=null}},X=function(O){O=O||s;var V=O==s,_=O.Stream;_&&(_._m&&(_._m.disconnect(),_._m=null),!_._RC&&_._c&&s.CloseNewCtx(_._c),_._RC=null,_._c=null,_._d&&(M(_._d.stream),_._d=null),_._p&&(_._p.disconnect(),_._p.onaudioprocess=_._p=null),G(_),F(_),V&&M(_)),O.Stream=0},M=s.StopS_=function(O){for(var V=st(O),_=0;_<V.length;_++){var Y=V[_];Y.stop&&Y.stop()}O.stop&&O.stop()},st=function(O){var V=0,_=0,Y=[];O.getAudioTracks&&(V=O.getAudioTracks(),_=O.getVideoTracks()),V||(V=O.audioTracks,_=O.videoTracks);for(var ot=0,_t=V?V.length:0;ot<_t;ot++)Y.push(V[ot]);for(var ot=0,_t=_?_.length:0;ot<_t;ot++)Y.push(_[ot]);return Y};s.SampleData=function(O,V,_,Y,ot){var _t="SampleData";Y||(Y={});var Ct=Y.index||0,Vt=Y.offset||0,jt=Y.raisePrev||0,Gt=Y.filter;if(Gt&&Gt.fn&&(Gt.sr&&Gt.sr!=V||Gt.srn&&Gt.srn!=_)&&(Gt=null,J(lt("d48C::{1}的filter采样率变了，重设滤波",0,_t),3)),!Gt)if(_<=V){var Pt=_>V*3/4?0:_/2*3/4;Gt={fn:Pt?s.IIRFilter(!0,V,Pt):0}}else{var Pt=V>_*3/4?0:V/2*3/4;Gt={fn:Pt?s.IIRFilter(!0,_,Pt):0}}Gt.sr=V,Gt.srn=_;var de=Gt.fn,Qt=Y.frameNext||[];ot||(ot={});var te=ot.frameSize||1;ot.frameType&&(te=ot.frameType=="mp3"?1152:1);var Ut=ot._sum,_e=0,$=O.length;Ct>$+1&&J(lt("tlbC::{1}似乎传入了未重置chunk {2}",0,_t,Ct+">"+$),3);for(var ct=0,ht=Ct;ht<$;ht++)ct+=O[ht].length;var Z=V/_;if(Z>1)ct=Math.max(0,ct-Math.floor(Vt)),ct=Math.floor(ct/Z);else if(Z<1){var Lt=1/Z;ct=Math.floor(ct*Lt)}ct+=Qt.length;for(var j=new Int16Array(ct),nt=0,ht=0;ht<Qt.length;ht++)j[nt]=Qt[ht],nt++;for(;Ct<$;Ct++){var At=O[Ct],ft=At instanceof Float32Array,ht=Vt,kt=At.length,Q=de&&de.Embed,Ot=0,at=0,rt=0,g=0;if(Z<1){for(var T=nt+ht,U=jt,tt=0;tt<kt;tt++){var N=At[tt];ft&&(N=Math.max(-1,Math.min(1,N)),N=N<0?N*32768:N*32767);var A=Math.floor(T);T+=Lt;for(var z=Math.floor(T),k=(N-U)/(z-A),K=1;A<z;A++,K++){var w=Math.floor(U+K*k);Q?(rt=w,g=Q.b0*rt+Q.b1*Q.x1+Q.b0*Q.x2-Q.a1*Q.y1-Q.a2*Q.y2,Q.x2=Q.x1,Q.x1=rt,Q.y2=Q.y1,Q.y1=g,w=g):w=de?de(w):w,w>32767?w=32767:w<-32768&&(w=-32768),Ut&&(_e+=Math.abs(w)),j[A]=w,nt++}U=jt=N,ht+=Lt}Vt=ht%1;continue}for(var tt=0,gt=0;tt<kt;tt++,gt++){if(gt<kt){var N=At[gt];ft&&(N=Math.max(-1,Math.min(1,N)),N=N<0?N*32768:N*32767),Q?(rt=N,g=Q.b0*rt+Q.b1*Q.x1+Q.b0*Q.x2-Q.a1*Q.y1-Q.a2*Q.y2,Q.x2=Q.x1,Q.x1=rt,Q.y2=Q.y1,Q.y1=g):g=de?de(N):N}if(Ot=at,at=g,gt==0){tt--;continue}var B=Math.floor(ht);if(tt==B){var L=Math.ceil(ht),H=ht-B,q=Ot,ut=L<kt?at:q,x=q+(ut-q)*H;x>32767?x=32767:x<-32768&&(x=-32768),Ut&&(_e+=Math.abs(x)),j[nt]=x,nt++,ht+=Z}}Vt=Math.max(0,ht-kt)}Z<1&&nt+1==ct&&(ct--,j=new Int16Array(j.buffer.slice(0,ct*2))),nt-1!=ct&&nt!=ct&&J(_t+" idx:"+nt+" != size:"+ct,3),Qt=null;var E=ct%te;if(E>0){var St=(ct-E)*2;Qt=new Int16Array(j.buffer.slice(St)),j=new Int16Array(j.buffer.slice(0,St))}var dt={index:Ct,offset:Vt,raisePrev:jt,filter:Gt,frameNext:Qt,sampleRate:_,data:j};return Ut&&(dt._sum=_e),dt},s.IIRFilter=function(O,V,_){var Y=2*Math.PI*_/V,ot=Math.sin(Y),_t=Math.cos(Y),Ct=ot/2,Vt=1+Ct,jt=-2*_t/Vt,Gt=(1-Ct)/Vt;if(O)var Pt=(1-_t)/2/Vt,de=(1-_t)/Vt;else var Pt=(1+_t)/2/Vt,de=-(1+_t)/Vt;var Qt=0,te=0,Ut=0,_e=0,$=0,ct=function(ht){return Ut=Pt*ht+de*Qt+Pt*te-jt*_e-Gt*$,te=Qt,Qt=ht,$=_e,_e=Ut,Ut};return ct.Embed={x1:0,x2:0,y1:0,y2:0,b0:Pt,b1:de,a1:jt,a2:Gt},ct},s.PowerLevel=function(O,V){var _=O/V||0,Y;return _<1251?Y=Math.round(_/1250*10):Y=Math.round(Math.min(100,Math.max(0,(1+Math.log(_/1e4)/Math.log(10))*100))),Y},s.PowerDBFS=function(O){var V=Math.max(.1,O||0),_=32767;return V=Math.min(V,_),V=20*Math.log(V/_)/Math.log(10),Math.max(-100,Math.round(V))},s.CLog=function(O,V){if(typeof console=="object"){var _=new Date,Y=("0"+_.getMinutes()).substr(-2)+":"+("0"+_.getSeconds()).substr(-2)+"."+("00"+_.getMilliseconds()).substr(-3),ot=this&&this.envIn&&this.envCheck&&this.id,_t=["["+Y+" "+u+(ot?":"+ot:"")+"]"+O],Ct=arguments,Vt=s.CLog,jt=2,Gt=Vt.log||console.log;for(a(V)?Gt=V==1?Vt.error||console.error:V==3?Vt.warn||console.warn:Gt:jt=1;jt<Ct.length;jt++)_t.push(Ct[jt]);pt?Gt&&Gt("[IsLoser]"+_t[0],_t.length>1?_t:""):Gt.apply(console,_t)}};var J=function(){s.CLog.apply(this,arguments)},pt=!0;try{pt=!console.log.apply}catch{}var zt=0;function Xt(O){var V=this;V.id=++zt,Bt();var _={type:"mp3",onProcess:n};for(var Y in O)_[Y]=O[Y];V.set=_;var ot=_[p],_t=_[d];(ot&&!a(ot)||_t&&!a(_t))&&V.CLog(lt.G("IllegalArgs-1",[lt("VtS4::{1}和{2}必须是数值",0,d,p)]),1,O),_[p]=+ot||16,_[d]=+_t||16e3,V.state=0,V._S=9,V.Sync={O:9,C:9}}s.Sync={O:9,C:9},s.prototype=Xt.prototype={CLog:J,_streamStore:function(){return this.set.sourceStream?this:s},_streamGet:function(){return this._streamStore().Stream},_streamCtx:function(){var O=this._streamGet();return O&&O._c},open:function(O,V){var _=this,Y=_.set,ot=_._streamStore(),_t=0;O=O||n;var Ct=function(nt,At){At=!!At,_.CLog(lt("5tWi::录音open失败：")+nt+",isUserNotAllow:"+At,1),_t&&s.CloseNewCtx(_t),V&&V(nt,At)};_._streamTag=c;var Vt=function(){_.CLog("open ok, id:"+_.id+" stream:"+_._streamTag),O(),_._SO=0},jt=ot.Sync,Gt=++jt.O,Pt=jt.C;_._O=_._O_=Gt,_._SO=_._S;var de=function(){if(Pt!=jt.C||!_._O){var nt=lt("dFm8::open被取消");return Gt==jt.O?_.close():nt=lt("VtJO::open被中断"),Ct(nt),!0}};if(!r){Ct(lt.G("NonBrowser-1",["open"])+lt("EMJq::，可尝试使用RecordApp解决方案")+"("+l+"/tree/master/app-support-sample)");return}var Qt=_.envCheck({envName:"H5",canProcess:!0});if(Qt){Ct(lt("A5bm::不能录音：")+Qt);return}var te,Ut=function(){te=Y.runningContext,te||(te=_t=s.GetContext(!0))};if(Y.sourceStream){if(_._streamTag="set.sourceStream",!s.GetContext()){Ct(lt("1iU7::不支持此浏览器从流中获取录音"));return}Ut(),X(ot);var _e=_.Stream=Y.sourceStream;_e._c=te,_e._RC=Y.runningContext,_e._call={};try{I(ot)}catch(nt){X(ot),Ct(lt("BTW2::从流中打开录音失败：")+nt.message);return}Vt();return}var $=function(nt,At){try{window.top.a}catch{Ct(lt("Nclz::无权录音(跨域，请尝试给iframe添加麦克风访问策略，如{1})",0,'allow="camera;microphone"'));return}ct(1,nt)&&(/Found/i.test(nt)?Ct(At+lt("jBa9::，无可用麦克风")):Ct(At))},ct=function(nt,At){if(/Permission|Allow/i.test(At))nt&&Ct(lt("gyO5::用户拒绝了录音权限"),!0);else if(window.isSecureContext===!1)nt&&Ct(lt("oWNo::浏览器禁止不安全页面录音，可开启https解决"));else return 1};if(s.IsOpen()){Vt();return}if(!s.Support()){$("",lt("COxc::此浏览器不支持录音"));return}Ut();var ht=function(nt){setTimeout(function(){nt._call={};var At=s.Stream;At&&(X(),nt._call=At._call),s.Stream=nt,nt._c=te,nt._RC=Y.runningContext,!de()&&(s.IsOpen()?(At&&_.CLog(lt("upb8::发现同时多次调用open"),1),I(ot),Vt()):Ct(lt("Q1GA::录音功能无效：无音频流")))},100)},Z=function(nt){var At=nt.name||nt.message||nt.code+":"+nt,ft="";Lt==1&&ct(0,At)&&(ft=lt("KxE2::，将尝试禁用回声消除后重试")),_.CLog(lt("xEQR::请求录音权限错误")+ft+"|"+nt,ft?3:1,nt),ft?j(1):$(At,lt("bDOG::无法录音：")+nt)},Lt=0,j=function(nt){Lt++;var At="audioTrackSet",ft="autoGainControl",kt="echoCancellation",Q="noiseSuppression",Ot=At+":{"+kt+","+Q+","+ft+"}",at=JSON.parse(i(Y[At]||!0));_.CLog("open... "+Lt+" "+At+":"+i(at)),nt&&(typeof at!="object"&&(at={}),at[ft]=!1,at[kt]=!1,at[Q]=!1),at[d]&&_.CLog(lt("IjL3::注意：已配置{1}参数，可能会出现浏览器不能正确选用麦克风、移动端无法启用回声消除等现象",0,At+"."+d),3);var rt={audio:at,video:Y.videoTrackSet||!1};try{var g=s.Scope[c](rt,ht,Z)}catch(T){_.CLog(c,3,T),rt={audio:!0,video:!1},g=s.Scope[c](rt,ht,Z)}_.CLog(c+"("+i(rt)+") "+C(te)+lt("RiWe::，未配置 {1} 时浏览器可能会自动启用回声消除，移动端未禁用回声消除时可能会降低系统播放音量（关闭录音后可恢复）和仅提供16k采样率的音频流（不需要回声消除时可明确配置成禁用来获得48k高音质的流），请参阅文档中{2}配置",0,Ot,At)+"("+l+") LM:"+o+" UA:"+navigator.userAgent),g&&g.then&&g.then(ht)[v](Z)};j()},close:function(O){O=O||n;var V=this,_=V._streamStore();V._stop();var Y=" stream:"+V._streamTag,ot=_.Sync;if(V._O=0,V._O_!=ot.O){V.CLog(lt("hWVz::close被忽略（因为同时open了多个rec，只有最后一个会真正close）")+Y,3),O();return}ot.C++,X(_),V.CLog("close,"+Y),O()},mock:function(O,V){var _=this;return _._stop(),_.isMock=1,_.mockEnvInfo=null,_.buffers=[O],_.recSize=O.length,_._setSrcSR(V),_._streamTag="mock",_},_setSrcSR:function(O){var V=this,_=V.set,Y=_[d];Y>O?_[d]=O:Y=0,V[f]=O,V.CLog(f+": "+O+" set."+d+": "+_[d]+(Y?" "+lt("UHvm::忽略")+": "+Y:""),Y?3:0)},envCheck:function(O){var V,_=this,Y=_.set,ot="CPU_BE";if(!V&&!s[ot]&&typeof Int8Array=="function"&&!new Int8Array(new Int32Array([1]).buffer)[0]&&(Bt(ot),V=lt("Essp::不支持{1}架构",0,ot)),!V){var _t=Y.type,Ct=_[_t+"_envCheck"];Y.takeoffEncodeChunk&&(Ct?O.canProcess||(V=lt("7uMV::{1}环境不支持实时处理",0,O.envName)):V=lt("2XBl::{1}类型不支持设置takeoffEncodeChunk",0,_t)+(_[_t]?"":lt("LG7e::(未加载编码器)"))),!V&&Ct&&(V=_[_t+"_envCheck"](O,Y))}return V||""},envStart:function(O,V){var _=this,Y=_.set;if(_.isMock=O?1:0,_.mockEnvInfo=O,_.buffers=[],_.recSize=0,O&&(_._streamTag="env$"+O.envName),_.state=1,_.envInLast=0,_.envInFirst=0,_.envInFix=0,_.envInFixTs=[],_._setSrcSR(V),_.engineCtx=0,_[Y.type+"_start"]){var ot=_.engineCtx=_[Y.type+"_start"](Y);ot&&(ot.pcmDatas=[],ot.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(O,V){var _=this,Y=_.set,ot=_.engineCtx;if(_.state!=1){_.state||_.CLog("envIn at state=0",3);return}var _t=_[f],Ct=O.length,Vt=s.PowerLevel(V,Ct),jt=_.buffers,Gt=jt.length;jt.push(O);var Pt=jt,de=Gt,Qt=Date.now(),te=Math.round(Ct/_t*1e3);_.envInLast=Qt,_.buffers.length==1&&(_.envInFirst=Qt-te);var Ut=_.envInFixTs;Ut.splice(0,0,{t:Qt,d:te});for(var _e=Qt,$=0,ct=0;ct<Ut.length;ct++){var ht=Ut[ct];if(Qt-ht.t>3e3){Ut.length=ct;break}_e=ht.t,$+=ht.d}var Z=Ut[1],Lt=Qt-_e,j=Lt-$;if(j>Lt/3&&(Z&&Lt>1e3||Ut.length>=6)){var nt=Qt-Z.t-te;if(nt>te/5){var At=!Y.disableEnvInFix;if(_.CLog("["+Qt+"]"+Mt.get(lt(At?"4Kfd::补偿{1}ms":"bM5i::未补偿{1}ms",1),[nt]),3),_.envInFix+=nt,At){var ft=new Int16Array(nt*_t/1e3);Ct+=ft.length,jt.push(ft)}}}var kt=_.recSize,Q=Ct,Ot=kt+Q;if(_.recSize=Ot,ot){var at=s.SampleData(jt,_t,Y[d],ot.chunkInfo);ot.chunkInfo=at,kt=ot.pcmSize,Q=at.data.length,Ot=kt+Q,ot.pcmSize=Ot,jt=ot.pcmDatas,Gt=jt.length,jt.push(at.data),_t=at[d]}var rt=Math.round(Ot/_t*1e3),g=jt.length,T=Pt.length,U=function(){for(var k=tt?0:-Q,K=jt[0]==null,w=Gt;w<g;w++){var gt=jt[w];gt==null?K=1:(k+=gt.length,ot&&gt.length&&_[Y.type+"_encode"](ot,gt))}if(K&&ot){var w=de;for(Pt[0]&&(w=0);w<T;w++)Pt[w]=null}K&&(k=tt?Q:0,jt[0]=null),ot?ot.pcmSize+=k:_.recSize+=k},tt=0,N="rec.set.onProcess";try{tt=Y.onProcess(jt,Vt,rt,_t,Gt,U)}catch(k){console.error(N+lt("gFUF::回调出错是不允许的，需保证不会抛异常"),k)}var A=Date.now()-Qt;if(A>10&&_.envInFirst-Qt>1e3&&_.CLog(N+lt("2ghS::低性能，耗时{1}ms",0,A),3),tt===!0){for(var z=0,ct=Gt;ct<g;ct++)jt[ct]==null?z=1:jt[ct]=new Int16Array(0);z?_.CLog(lt("ufqH::未进入异步前不能清除buffers"),3):ot?ot.pcmSize-=Q:_.recSize-=Q}else U()},start:function(){var O=this,V=1;if(O.set.sourceStream?O.Stream||(V=0):s.IsOpen()||(V=0),!V){O.CLog(lt("6WmN::start失败：未open"),1);return}var _=O._streamCtx();if(O.CLog(lt("kLDN::start 开始录音，")+C(_)+" stream:"+O._streamTag),O._stop(),O.envStart(null,_[d]),O.state=3,O._SO&&O._SO+1!=O._S){O.CLog(lt("Bp2y::start被中断"),3);return}O._SO=0;var Y=function(){O.state==3&&(O.state=1,O.resume())},ot="AudioContext resume: ",_t=O._streamGet();_t._call[O.id]=function(){O.CLog(ot+_.state+"|stream ok"),Y()},y(_,function(Ct){return Ct&&O.CLog(ot+"wait..."),O.state==3},function(Ct){Ct&&O.CLog(ot+_.state),Y()},function(Ct){O.CLog(ot+_.state+lt("upkE::，可能无法录音：")+Ct,1),Y()})},pause:function(){var O=this,V=O._streamGet();O.state&&(O.state=2,O.CLog("pause"),V&&delete V._call[O.id])},resume:function(){var O=this,V=O._streamGet(),_="resume",Y=_+"(wait ctx)";if(O.state==3)O.CLog(Y);else if(O.state){O.state=1,O.CLog(_),O.envResume(),V&&(V._call[O.id]=function(_t,Ct){O.state==1&&O.envIn(_t,Ct)},W(V));var ot=O._streamCtx();ot&&y(ot,function(_t){return _t&&O.CLog(Y+"..."),O.state==1},function(_t){_t&&O.CLog(Y+ot.state),W(V)},function(_t){O.CLog(Y+ot.state+"[err]"+_t,1)})}},_stop:function(O){var V=this,_=V.set;V.isMock||V._S++,V.state&&(V.pause(),V.state=0),!O&&V[_.type+"_stop"]&&(V[_.type+"_stop"](V.engineCtx),V.engineCtx=0)},stop:function(O,V,_){var Y=this,ot=Y.set,_t,Ct=Y.envInLast-Y.envInFirst,Vt=Ct&&Y.buffers.length;Y.CLog(lt("Xq4s::stop 和start时差:")+(Ct?Ct+"ms "+lt("3CQP::补偿:")+Y.envInFix+"ms envIn:"+Vt+" fps:"+(Vt/Ct*1e3).toFixed(1):"-")+" stream:"+Y._streamTag+" ("+l+") LM:"+o);var jt=function(){Y._stop(),_&&Y.close()},Gt=function(ht){Y.CLog(lt("u8JG::结束录音失败：")+ht,1),V&&V(ht),jt()},Pt=function(ht,Z,Lt){var j="blob",nt="arraybuffer",At="dataType",ft="DefaultDataType",kt=Y[At]||s[ft]||j,Q=At+"="+kt,Ot=ht instanceof ArrayBuffer,at=0,rt=Ot?ht.byteLength:ht.size;if(kt==nt?Ot||(at=1):kt==j?typeof Blob!="function"?at=lt.G("NonBrowser-1",[Q])+lt("1skY::，请设置{1}",0,u+"."+ft+'="'+nt+'"'):(Ot&&(ht=new Blob([ht],{type:Z})),ht instanceof Blob||(at=1),Z=ht.type||Z):at=lt.G("NotSupport-1",[Q]),Y.CLog(lt("Wv7l::结束录音 编码花{1}ms 音频时长{2}ms 文件大小{3}b",0,Date.now()-_t,Lt,rt)+" "+Q+","+Z),at){Gt(at!=1?at:lt("Vkbd::{1}编码器返回的不是{2}",0,ot.type,kt)+", "+Q);return}if(ot.takeoffEncodeChunk)Y.CLog(lt("QWnr::启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据"),3);else if(rt<Math.max(50,Lt/5)){Gt(lt("Sz2H::生成的{1}无效",0,ot.type));return}O&&O(ht,Lt,Z),jt()};if(!Y.isMock){var de=Y.state==3;if(!Y.state||de){Gt(lt("wf9t::未开始录音")+(de?lt("Dl2c::，开始录音前无用户交互导致AudioContext未运行"):""));return}}Y._stop(!0);var Qt=Y.recSize;if(!Qt){Gt(lt("Ltz3::未采集到录音"));return}if(!Y[ot.type]){Gt(lt("xGuI::未加载{1}编码器，请尝试到{2}的src/engine内找到{1}的编码器并加载",0,ot.type,u));return}if(Y.isMock){var te=Y.envCheck(Y.mockEnvInfo||{envName:"mock",canProcess:!1});if(te){Gt(lt("AxOH::录音错误：")+te);return}}var Ut=Y.engineCtx;if(Y[ot.type+"_complete"]&&Ut){var ct=Math.round(Ut.pcmSize/ot[d]*1e3);_t=Date.now(),Y[ot.type+"_complete"](Ut,function(Z,Lt){Pt(Z,Lt,ct)},Gt);return}if(_t=Date.now(),!Y.buffers[0]){Gt(lt("xkKd::音频buffers被释放"));return}var _e=s.SampleData(Y.buffers,Y[f],ot[d]);ot[d]=_e[d];var $=_e.data,ct=Math.round($.length/ot[d]*1e3);Y.CLog(lt("CxeT::采样:{1} 花:{2}ms",0,Qt+"->"+$.length,Date.now()-_t)),setTimeout(function(){_t=Date.now(),Y[ot.type]($,function(ht,Z){Pt(ht,Z,ct)},function(ht){Gt(ht)})})}};var Ht=function(O,V){V.pos||(V.pos=[0],V.tracks={},V.bytes=[]);var _=V.tracks,Y=[V.pos[0]],ot=function(){V.pos[0]=Y[0]},_t=V.bytes.length,Ct=new Uint8Array(_t+O.length);if(Ct.set(V.bytes),Ct.set(O,_t),V.bytes=Ct,!V._ht){if(It(Ct,Y),Rt(Ct,Y),!Nt(It(Ct,Y),[24,83,128,103]))return;for(It(Ct,Y);Y[0]<Ct.length;){var Vt=It(Ct,Y),jt=Rt(Ct,Y),Gt=[0],Pt=0;if(!jt)return;if(Nt(Vt,[22,84,174,107])){for(;Gt[0]<jt.length;){var de=It(jt,Gt),Qt=Rt(jt,Gt),te=[0],Ut={channels:0,sampleRate:0};if(Nt(de,[174]))for(;te[0]<Qt.length;){var _e=It(Qt,te),$=Rt(Qt,te),ct=[0];if(Nt(_e,[215])){var ht=yt($);Ut.number=ht,_[ht]=Ut}else if(Nt(_e,[131])){var ht=yt($);ht==1?Ut.type="video":ht==2?(Ut.type="audio",Pt||(V.track0=Ut),Ut.idx=Pt++):Ut.type="Type-"+ht}else if(Nt(_e,[134])){for(var Z="",Lt=0;Lt<$.length;Lt++)Z+=String.fromCharCode($[Lt]);Ut.codec=Z}else if(Nt(_e,[225]))for(;ct[0]<$.length;){var j=It($,ct),nt=Rt($,ct);if(Nt(j,[181])){var ht=0,At=new Uint8Array(nt.reverse()).buffer;nt.length==4?ht=new Float32Array(At)[0]:nt.length==8?ht=new Float64Array(At)[0]:J("WebM Track !Float",1,nt),Ut[d]=Math.round(ht)}else Nt(j,[98,100])?Ut.bitDepth=yt(nt):Nt(j,[159])&&(Ut.channels=yt(nt))}}}V._ht=1,J("WebM Tracks",_),ot();break}}}var ft=V.track0;if(ft){var kt=ft[d];if(V.webmSR=kt,ft.bitDepth==16&&/FLOAT/i.test(ft.codec)&&(ft.bitDepth=32,J("WebM 16->32 bit",3)),kt<8e3||ft.bitDepth!=32||ft.channels<1||!/(\b|_)PCM\b/i.test(ft.codec))return V.bytes=[],V.bad||J("WebM Track Unexpected",3,V),V.bad=1,-1;for(var Q=[],Ot=0;Y[0]<Ct.length;){var de=It(Ct,Y),Qt=Rt(Ct,Y);if(!Qt)break;if(Nt(de,[163])){var at=Qt[0]&15,Ut=_[at];if(!Ut)J("WebM !Track"+at,1,_);else if(Ut.idx===0){for(var rt=new Uint8Array(Qt.length-4),Lt=4;Lt<Qt.length;Lt++)rt[Lt-4]=Qt[Lt];Q.push(rt),Ot+=rt.length}}ot()}if(Ot){var g=new Uint8Array(Ct.length-V.pos[0]);g.set(Ct.subarray(V.pos[0])),V.bytes=g,V.pos[0]=0;for(var rt=new Uint8Array(Ot),Lt=0,T=0;Lt<Q.length;Lt++)rt.set(Q[Lt],T),T+=Q[Lt].length;var At=new Float32Array(rt.buffer);if(ft.channels>1){for(var U=[],Lt=0;Lt<At.length;)U.push(At[Lt]),Lt+=ft.channels;At=new Float32Array(U)}return At}}},Nt=function(O,V){if(!O||O.length!=V.length)return!1;if(O.length==1)return O[0]==V[0];for(var _=0;_<O.length;_++)if(O[_]!=V[_])return!1;return!0},yt=function(O){for(var V="",_=0;_<O.length;_++){var Y=O[_];V+=(Y<16?"0":"")+Y.toString(16)}return parseInt(V,16)||0},It=function(O,V,_){var Y=V[0];if(!(Y>=O.length)){var ot=O[Y],_t=("0000000"+ot.toString(2)).substr(-8),Ct=/^(0*1)(\d*)$/.exec(_t);if(Ct){var Vt=Ct[1].length,jt=[];if(!(Y+Vt>O.length)){for(var Gt=0;Gt<Vt;Gt++)jt[Gt]=O[Y],Y++;return _&&(jt[0]=parseInt(Ct[2]||"0",2)),V[0]=Y,jt}}}},Rt=function(O,V){var _=It(O,V,1);if(_){var Y=yt(_),ot=V[0],_t=[];if(Y<2147483647){if(ot+Y>O.length)return;for(var Ct=0;Ct<Y;Ct++)_t[Ct]=O[ot],ot++}return V[0]=ot,_t}},Mt=s.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(O,V){var _=u+".i18n.put: ",Y=O.overwrite;Y=Y==null||Y;var ot=O.lang;if(ot=Mt.alias[ot]||ot,!ot)throw new Error(_+"set.lang?");var _t=Mt.locales[ot];_t||(_t={},Mt.locales[ot]=_t);for(var Ct=/^([\w\-]+):/,Vt,jt=0;jt<V.length;jt++){var Pt=V[jt];if(Vt=Ct.exec(Pt),!Vt){J(_+"'key:'? "+Pt,3,O);continue}var Gt=Vt[1],Pt=Pt.substr(Gt.length+1);!Y&&_t[Gt]||(_t[Gt]=Pt)}},get:function(){return Mt.v_G.apply(null,arguments)},v_G:function(O,V,_){V=V||[],_=_||Mt.lang,_=Mt.alias[_]||_;var Y=Mt.locales[_],ot=Y&&Y[O]||"";return!ot&&_!="zh"?_=="en"?Mt.v_G(O,V,"zh"):Mt.v_G(O,V,"en"):(Mt.lastLang=_,ot=="=Empty"?"":ot.replace(/\{(\d+)(\!?)\}/g,function(_t,Ct,Vt){return Ct=+Ct||0,_t=V[Ct-1],(Ct<1||Ct>V.length)&&(_t="{?}",J("i18n["+O+"] no {"+Ct+"}: "+ot,3)),Vt?"":_t}))},$T:function(){return Mt.v_T.apply(null,arguments)},v_T:function(){for(var O=arguments,V="",_=[],Y=0,ot=u+".i18n.$T:",_t=/^([\w\-]*):/,Ct,Vt=0;Vt<O.length;Vt++){var jt=O[Vt];if(Vt==0){if(Ct=_t.exec(jt),V=Ct&&Ct[1],!V)throw new Error(ot+"0 'key:'?");jt=jt.substr(V.length+1)}if(Y===-1)_.push(jt);else{if(Y)throw new Error(ot+" bad args");if(jt===0)Y=-1;else if(a(jt)){if(jt<1)throw new Error(ot+" bad args");Y=jt}else{var Gt=Vt==1?"en":Vt?"":"zh";if(Ct=_t.exec(jt),Ct&&(Gt=Ct[1]||Gt,jt=jt.substr(Ct[1].length+1)),!Ct||!Gt)throw new Error(ot+Vt+" 'lang:'?");Mt.put({lang:Gt,overwrite:!1},[V+":"+jt])}}}return V?Y>0?V:Mt.v_G(V,_):""}},lt=Mt.$T;lt.G=Mt.get,lt("NonBrowser-1::非浏览器环境，不支持{1}",1),lt("IllegalArgs-1::参数错误：{1}",1),lt("NeedImport-2::调用{1}需要先导入{2}",2),lt("NotSupport-1::不支持：{1}",1),s.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var Bt=s.Traffic=function(O){if(r){O=O?"/"+u+"/Report/"+O:"";var V=s.TrafficImgUrl;if(V){var _=s.Traffic,Y=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],ot=Y[1]||"http://file/",_t=(Y[0]||ot)+O;if(V.indexOf("//")==0&&(/^https:/i.test(_t)?V="https:"+V:V="http:"+V),O&&(V=V+"&cu="+encodeURIComponent(ot+O)),!_[_t]){_[_t]=1;var Ct=new Image;Ct.src=V,J("Traffic Analysis Image: "+(O||u+".TrafficImgUrl="+s.TrafficImgUrl))}}}};h&&(J(lt("8HO5::覆盖导入{1}",0,u),1),h.Destroy()),t[u]=s})})(Ac);var z_=Ac.exports;const N_=Cf(z_);(function(e){var t=typeof window=="object"&&!!window.document,r=t?window:Object,n=r.Recorder,a=n.i18n;e(n,a,a.$T,t)})(function(e,t,r,n){var a="48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000",i="8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 192, 224, 256, 320";e.prototype.enc_mp3={stable:!0,takeEC:"full",getTestMsg:function(){return r("Zm7L::采样率范围：{1}；比特率范围：{2}（不同比特率支持的采样率范围不同，小于32kbps时采样率需小于32000）",0,a,i)}};var s=function(v){var h=v.bitRate,m=v.sampleRate,b=m;if((" "+i+",").indexOf(" "+h+",")==-1&&e.CLog(r("eGB9::{1}不在mp3支持的取值范围：{2}",0,"bitRate="+h,i),3),(" "+a+",").indexOf(" "+m+",")==-1){for(var y=a.split(", "),S=[],C=0;C<y.length;C++)S.push({v:+y[C],s:Math.abs(y[C]-m)});S.sort(function(R,D){return R.s-D.s}),b=S[0].v,v.sampleRate=b,e.CLog(r("zLTa::sampleRate已更新为{1}，因为{2}不在mp3支持的取值范围：{3}",0,b,m,a),3)}},o=function(){return r.G("NeedImport-2",["mp3.js","src/engine/mp3-engine.js"])},l=n&&typeof Worker=="function";e.prototype.mp3=function(v,h,m){var b=this,y=b.set,S=v.length;if(!e.lamejs){m(o());return}if(l){var C=b.mp3_start(y);if(C){if(C.isW){b.mp3_encode(C,v),b.mp3_complete(C,h,m,1);return}b.mp3_stop(C)}}s(y);var R=new e.lamejs.Mp3Encoder(1,y.sampleRate,y.bitRate),D=57600,I=new Int8Array(5e5),W=0,G=0,F=0,X=function(){try{if(G<S)var M=R.encodeBuffer(v.subarray(G,G+D));else{F=1;var M=R.flush()}}catch(Xt){if(console.error(Xt),!F)try{R.flush()}catch(Ht){console.error(Ht)}m("MP3 Encoder: "+Xt.message);return}var st=M.length;if(st>0){if(W+st>I.length){var J=new Int8Array(I.length+Math.max(5e5,st));J.set(I.subarray(0,W)),I=J}I.set(M,W),W+=st}if(G<S)G+=D,setTimeout(X);else{var pt=[I.buffer.slice(0,W)],zt=d.fn(pt,W,S,y.sampleRate);p(zt,y),h(pt[0]||new ArrayBuffer(0),"audio/mp3")}};X()};var u;e.BindDestroy("mp3Worker",function(){u&&(e.CLog("mp3Worker Destroy"),u.terminate(),u=null)}),e.prototype.mp3_envCheck=function(v,h){var m="";return h.takeoffEncodeChunk&&(f()||(m=r("yhUs::当前浏览器版本太低，无法实时处理"))),!m&&!e.lamejs&&(m=o()),m},e.prototype.mp3_start=function(v){return f(v)};var c={id:0},f=function(v,h){var m=function(F){var X=F.data,M=S.wkScope.wk_ctxs,st=S.wkScope.wk_lame,J=S.wkScope.wk_mp3TrimFix,pt=M[X.id];if(X.action=="init")M[X.id]={sampleRate:X.sampleRate,bitRate:X.bitRate,takeoff:X.takeoff,pcmSize:0,memory:new Int8Array(5e5),mOffset:0,encObj:new st.Mp3Encoder(1,X.sampleRate,X.bitRate)};else if(!pt)return;var zt=function(yt){var It=yt.length;if(pt.mOffset+It>pt.memory.length){var Rt=new Int8Array(pt.memory.length+Math.max(5e5,It));Rt.set(pt.memory.subarray(0,pt.mOffset)),pt.memory=Rt}pt.memory.set(yt,pt.mOffset),pt.mOffset+=It};switch(X.action){case"stop":if(!pt.isCp)try{pt.encObj.flush()}catch(yt){console.error(yt)}pt.encObj=null,delete M[X.id];break;case"encode":if(pt.isCp)break;pt.pcmSize+=X.pcm.length;try{var Xt=pt.encObj.encodeBuffer(X.pcm)}catch(yt){pt.err=yt,console.error(yt)}Xt&&Xt.length>0&&(pt.takeoff?C.onmessage({action:"takeoff",id:X.id,chunk:Xt}):zt(Xt));break;case"complete":pt.isCp=1;try{var Xt=pt.encObj.flush()}catch(yt){pt.err=yt,console.error(yt)}if(Xt&&Xt.length>0&&(pt.takeoff?C.onmessage({action:"takeoff",id:X.id,chunk:Xt}):zt(Xt)),pt.err){C.onmessage({action:X.action,id:X.id,err:"MP3 Encoder: "+pt.err.message});break}var Ht=[pt.memory.buffer.slice(0,pt.mOffset)],Nt=J.fn(Ht,pt.mOffset,pt.pcmSize,pt.sampleRate);C.onmessage({action:X.action,id:X.id,blob:Ht[0]||new ArrayBuffer(0),meta:Nt});break}},b=function(F){C.onmessage=function(X){var M=X;F&&(M=X.data);var st=c[M.id];st&&(M.action=="takeoff"?st.set.takeoffEncodeChunk(new Uint8Array(M.chunk.buffer)):(st.call&&st.call(M),st.call=null))}},y=function(){var F={worker:C,set:v};return v?(F.id=++c.id,c[F.id]=F,s(v),C.postMessage({action:"init",id:F.id,sampleRate:v.sampleRate,bitRate:v.bitRate,takeoff:!!v.takeoffEncodeChunk,x:new Int16Array(5)})):C.postMessage({x:new Int16Array(5)}),F},S,C=u;if(h||!l)return e.CLog(r("k9PT::当前环境不支持Web Worker，mp3实时编码器运行在主线程中"),3),C={postMessage:function(F){m({data:F})}},S={wkScope:{wk_ctxs:{},wk_lame:e.lamejs,wk_mp3TrimFix:d}},b(),y();try{if(!C){var R=(m+"").replace(/[\w\$]+\.onmessage/g,"self.postMessage");R=R.replace(/[\w\$]+\.wkScope/g,"wkScope");var D=");wk_lame();self.onmessage="+R;D+=";var wkScope={ wk_ctxs:{},wk_lame:wk_lame",D+=",wk_mp3TrimFix:{rm:"+d.rm+",fn:"+d.fn+"} }";var I=e.lamejs.toString(),W=(window.URL||webkitURL).createObjectURL(new Blob(["var wk_lame=(",I,D],{type:"text/javascript"}));C=new Worker(W),setTimeout(function(){(window.URL||webkitURL).revokeObjectURL(W)},1e4),b(1)}var G=y();return G.isW=1,u=C,G}catch(F){return C&&C.terminate(),console.error(F),f(v,1)}};e.prototype.mp3_stop=function(v){if(v&&v.worker){v.worker.postMessage({action:"stop",id:v.id}),v.worker=null,delete c[v.id];var h=-1;for(var m in c)h++;h&&e.CLog(r("fT6M::mp3 worker剩{1}个未stop",0,h),3)}},e.prototype.mp3_encode=function(v,h){v&&v.worker&&v.worker.postMessage({action:"encode",id:v.id,pcm:h})},e.prototype.mp3_complete=function(v,h,m,b){var y=this;v&&v.worker?(v.call=function(S){b&&y.mp3_stop(v),S.err?m(S.err):(p(S.meta,v.set),h(S.blob,"audio/mp3"))},v.worker.postMessage({action:"complete",id:v.id})):m(r("mPxH::mp3编码器未start"))},e.mp3ReadMeta=function(v,h){var m=typeof window<"u"&&window.parseInt||typeof self<"u"&&self.parseInt||parseInt,b=new Uint8Array(v[0]||[]);if(b.length<4)return null;var y=function(yt,It){return("0000000"+((It||b)[yt]||0).toString(2)).substr(-8)},S=y(0)+y(1),C=y(2)+y(3);if(!/^1{11}/.test(S))return null;var R={"00":2.5,10:2,11:1}[S.substr(11,2)],D={"01":3}[S.substr(13,2)],I={1:[44100,48e3,32e3],2:[22050,24e3,16e3],"2.5":[11025,12e3,8e3]}[R];I&&(I=I[m(C.substr(4,2),2)]);var W=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320]][R==1?1:0][m(C.substr(0,4),2)];if(!R||!D||!W||!I)return null;for(var G=Math.round(h*8/W),F=D==1?384:D==2||R==1?1152:576,X=F/I*1e3,M=Math.floor(F*W/8/I*1e3),st=0,J=0,pt=0;pt<v.length;pt++){var zt=v[pt];if(J+=zt.byteLength,J>=M+3){var Xt=new Uint8Array(zt),Ht=zt.byteLength-(J-(M+3)+1),Nt=y(Ht,Xt);st=Nt.charAt(6)=="1";break}}return st&&M++,{version:R,layer:D,sampleRate:I,bitRate:W,duration:G,size:h,hasPadding:st,frameSize:M,frameDurationFloat:X}};var d={rm:e.mp3ReadMeta,fn:function(v,h,m,b){var y=this.rm(v,h);if(!y)return{size:h,err:"mp3 unknown format"};var S=Math.round(m/b*1e3),C=Math.floor((y.duration-S)/y.frameDurationFloat);if(C>0){var R=C*y.frameSize-(y.hasPadding?1:0);h-=R;for(var D=0,I=[],W=0;W<v.length;W++){var G=v[W];if(R<=0)break;R>=G.byteLength?(R-=G.byteLength,I.push(G),v.splice(W,1),W--):(v[W]=G.slice(R),D=G,R=0)}var F=this.rm(v,h);if(!F){D&&(v[0]=D);for(var W=0;W<I.length;W++)v.splice(W,0,I[W]);y.err="mp3 fix error: 已还原，错误原因不明"}var X=y.trimFix={};X.remove=C,X.removeDuration=Math.round(C*y.frameDurationFloat),X.duration=Math.round(h*8/y.bitRate)}return y}},p=function(v,h){var m="MP3 Info: ";(v.sampleRate&&v.sampleRate!=h.sampleRate||v.bitRate&&v.bitRate!=h.bitRate)&&(e.CLog(m+r("uY9i::和设置的不匹配{1}，已更新成{2}",0,"set:"+h.bitRate+"kbps "+h.sampleRate+"hz","set:"+v.bitRate+"kbps "+v.sampleRate+"hz"),3,h),h.sampleRate=v.sampleRate,h.bitRate=v.bitRate);var b=v.trimFix;b?(m+=r("iMSm::Fix移除{1}帧",0,b.remove)+" "+b.removeDuration+"ms -> "+b.duration+"ms",b.remove>2&&(v.err=(v.err?v.err+", ":"")+r("b9zm::移除帧数过多"))):m+=(v.duration||"-")+"ms",v.err?e.CLog(m,v.size?1:0,v.err,v):e.CLog(m,v)}});(function(e){var t=typeof window=="object"&&!!window.document,r=t?window:Object,n=r.Recorder;e(n)})(function(e){function t(){var r=function($){return Math.log($)/Math.log(10)},n=function($){throw new Error("abort("+$+")")};function a($){return new Int8Array($)}function i($){return new Int16Array($)}function s($){return new Int32Array($)}function o($){return new Float32Array($)}function l($){return new Float64Array($)}function u($){if($.length==1)return o($[0]);var ct=$[0];$=$.slice(1);for(var ht=[],Z=0;Z<ct;Z++)ht.push(u($));return ht}function c($){if($.length==1)return s($[0]);var ct=$[0];$=$.slice(1);for(var ht=[],Z=0;Z<ct;Z++)ht.push(c($));return ht}function f($){if($.length==1)return i($[0]);var ct=$[0];$=$.slice(1);for(var ht=[],Z=0;Z<ct;Z++)ht.push(f($));return ht}function d($){if($.length==1)return new Array($[0]);var ct=$[0];$=$.slice(1);for(var ht=[],Z=0;Z<ct;Z++)ht.push(d($));return ht}var p={};p.fill=function($,ct,ht,Z){if(arguments.length==2)for(var Lt=0;Lt<$.length;Lt++)$[Lt]=arguments[1];else for(var Lt=ct;Lt<ht;Lt++)$[Lt]=Z};var v={};v.arraycopy=function($,ct,ht,Z,Lt){for(var j=ct+Lt;ct<j;)ht[Z++]=$[ct++]};var h={};h.SQRT2=1.4142135623730951,h.FAST_LOG10=function($){return r($)},h.FAST_LOG10_X=function($,ct){return r($)*ct};function m($){this.ordinal=$}m.short_block_allowed=new m(0),m.short_block_coupled=new m(1),m.short_block_dispensed=new m(2),m.short_block_forced=new m(3);var b={};b.MAX_VALUE=34028235e31;function y($){this.ordinal=$}y.vbr_off=new y(0),y.vbr_mt=new y(1),y.vbr_rh=new y(2),y.vbr_abr=new y(3),y.vbr_mtrh=new y(4),y.vbr_default=y.vbr_mtrh;function S($){var ct=$;this.ordinal=function(){return ct}}S.STEREO=new S(0),S.JOINT_STEREO=new S(1),S.DUAL_CHANNEL=new S(2),S.MONO=new S(3),S.NOT_SET=new S(4);function C(){var $=3,ct=98,ht=4;this.getLameShortVersion=function(){return $+"."+ct+"."+ht}}function R(){var $=null;this.qupvt=null,this.setModules=function(B){this.qupvt=B,$=B};function ct(B){this.bits=0|B}var ht=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function Z(B,L,H,q,ut,x){var E=.5946/L;for(B=B>>1;B--!=0;)ut[x++]=E>H[q++]?0:1,ut[x++]=E>H[q++]?0:1}function Lt(B,L,H,q,ut,x){B=B>>1;var E=B%2;for(B=B>>1;B--!=0;){var St,dt,xt,Ft,Wt,Yt,oe,ve;St=H[q++]*L,dt=H[q++]*L,Wt=0|St,xt=H[q++]*L,Yt=0|dt,Ft=H[q++]*L,oe=0|xt,St+=$.adj43[Wt],ve=0|Ft,dt+=$.adj43[Yt],ut[x++]=0|St,xt+=$.adj43[oe],ut[x++]=0|dt,Ft+=$.adj43[ve],ut[x++]=0|xt,ut[x++]=0|Ft}if(E!=0){var St,dt,Wt,Yt;St=H[q++]*L,dt=H[q++]*L,Wt=0|St,Yt=0|dt,St+=$.adj43[Wt],dt+=$.adj43[Yt],ut[x++]=0|St,ut[x++]=0|dt}}function j(B,L,H,q,ut){var x,E,St=0,dt,xt=0,Ft=0,Wt=0,Yt=L,oe=0,ve=Yt,ue=0,He=B,Ge=0;for(dt=ut!=null&&q.global_gain==ut.global_gain,q.block_type==_.SHORT_TYPE?E=38:E=21,x=0;x<=E;x++){var Oe=-1;if((dt||q.block_type==_.NORM_TYPE)&&(Oe=q.global_gain-(q.scalefac[x]+(q.preflag!=0?$.pretab[x]:0)<<q.scalefac_scale+1)-q.subblock_gain[q.window[x]]*8),dt&&ut.step[x]==Oe)xt!=0&&(Lt(xt,H,He,Ge,ve,ue),xt=0),Ft!=0&&n();else{var Ne=q.width[x];if(St+q.width[x]>q.max_nonzero_coeff){var Je;Je=q.max_nonzero_coeff-St+1,p.fill(L,q.max_nonzero_coeff,576,0),Ne=Je,Ne<0&&(Ne=0),x=E+1}if(xt==0&&Ft==0&&(ve=Yt,ue=oe,He=B,Ge=Wt),ut!=null&&ut.sfb_count1>0&&x>=ut.sfb_count1&&ut.step[x]>0&&Oe>=ut.step[x]?(xt!=0&&(Lt(xt,H,He,Ge,ve,ue),xt=0,ve=Yt,ue=oe,He=B,Ge=Wt),Ft+=Ne):(Ft!=0&&(Z(Ft,H,He,Ge,ve,ue),Ft=0,ve=Yt,ue=oe,He=B,Ge=Wt),xt+=Ne),Ne<=0){Ft!=0&&n(),xt!=0&&n();break}}x<=E&&(oe+=q.width[x],Wt+=q.width[x],St+=q.width[x])}xt!=0&&(Lt(xt,H,He,Ge,ve,ue),xt=0),Ft!=0&&n()}function nt(B,L,H){var q=0,ut=0;do{var x=B[L++],E=B[L++];q<x&&(q=x),ut<E&&(ut=E)}while(L<H);return q<ut&&(q=ut),q}function At(B,L,H,q,ut,x){var E=M.ht[q].xlen*65536+M.ht[ut].xlen,St=0,dt;do{var xt=B[L++],Ft=B[L++];xt!=0&&(xt>14&&(xt=15,St+=E),xt*=16),Ft!=0&&(Ft>14&&(Ft=15,St+=E),xt+=Ft),St+=M.largetbl[xt]}while(L<H);return dt=St&65535,St>>=16,St>dt&&(St=dt,q=ut),x.bits+=St,q}function ft(B,L,H,q){var ut=0,x=M.ht[1].hlen;do{var E=B[L+0]*2+B[L+1];L+=2,ut+=x[E]}while(L<H);return q.bits+=ut,1}function kt(B,L,H,q,ut){var x=0,E,St=M.ht[q].xlen,dt;q==2?dt=M.table23:dt=M.table56;do{var xt=B[L+0]*St+B[L+1];L+=2,x+=dt[xt]}while(L<H);return E=x&65535,x>>=16,x>E&&(x=E,q++),ut.bits+=x,q}function Q(B,L,H,q,ut){var x=0,E=0,St=0,dt=M.ht[q].xlen,xt=M.ht[q].hlen,Ft=M.ht[q+1].hlen,Wt=M.ht[q+2].hlen;do{var Yt=B[L+0]*dt+B[L+1];L+=2,x+=xt[Yt],E+=Ft[Yt],St+=Wt[Yt]}while(L<H);var oe=q;return x>E&&(x=E,oe++),x>St&&(x=St,oe=q+2),ut.bits+=x,oe}var Ot=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function at(B,L,H,q){var ut=nt(B,L,H);switch(ut){case 0:return ut;case 1:return ft(B,L,H,q);case 2:case 3:return kt(B,L,H,Ot[ut-1],q);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return Q(B,L,H,Ot[ut-1],q);default:ut>It.IXMAX_VAL&&n(),ut-=15;var x;for(x=24;x<32&&!(M.ht[x].linmax>=ut);x++);var E;for(E=x-8;E<24&&!(M.ht[E].linmax>=ut);E++);return At(B,L,H,E,x,q)}}this.noquant_count_bits=function(B,L,H){var q=L.l3_enc,ut=Math.min(576,L.max_nonzero_coeff+2>>1<<1);for(H!=null&&(H.sfb_count1=0);ut>1&&!(q[ut-1]|q[ut-2]);ut-=2);L.count1=ut;for(var x=0,E=0;ut>3;ut-=4){var St;if(((q[ut-1]|q[ut-2]|q[ut-3]|q[ut-4])&2147483647)>1)break;St=((q[ut-4]*2+q[ut-3])*2+q[ut-2])*2+q[ut-1],x+=M.t32l[St],E+=M.t33l[St]}var dt=x;if(L.count1table_select=0,x>E&&(dt=E,L.count1table_select=1),L.count1bits=dt,L.big_values=ut,ut==0)return dt;if(L.block_type==_.SHORT_TYPE)x=3*B.scalefac_band.s[3],x>L.big_values&&(x=L.big_values),E=L.big_values;else if(L.block_type==_.NORM_TYPE){if(x=L.region0_count=B.bv_scf[ut-2],E=L.region1_count=B.bv_scf[ut-1],E=B.scalefac_band.l[x+E+2],x=B.scalefac_band.l[x+1],E<ut){var xt=new ct(dt);L.table_select[2]=at(q,E,ut,xt),dt=xt.bits}}else L.region0_count=7,L.region1_count=_.SBMAX_l-1-7-1,x=B.scalefac_band.l[8],E=ut,x>E&&(x=E);if(x=Math.min(x,ut),E=Math.min(E,ut),0<x){var xt=new ct(dt);L.table_select[0]=at(q,0,x,xt),dt=xt.bits}if(x<E){var xt=new ct(dt);L.table_select[1]=at(q,x,E,xt),dt=xt.bits}if(B.use_best_huffman==2&&n(),H!=null&&L.block_type==_.NORM_TYPE){for(var Ft=0;B.scalefac_band.l[Ft]<L.big_values;)Ft++;H.sfb_count1=Ft}return dt},this.count_bits=function(B,L,H,q){var ut=H.l3_enc,x=It.IXMAX_VAL/$.IPOW20(H.global_gain);return H.xrpow_max>x?It.LARGE_BITS:(j(L,ut,$.IPOW20(H.global_gain),H,q),B.substep_shaping&2&&n(),this.noquant_count_bits(B,H,q))};function rt(B,L,H,q,ut,x,E){for(var St=L.big_values,dt=0;dt<=22;dt++)q[dt]=It.LARGE_BITS;for(var dt=0;dt<16;dt++){var xt=B.scalefac_band.l[dt+1];if(xt>=St)break;var Ft=0,Wt=new ct(Ft),Yt=at(H,0,xt,Wt);Ft=Wt.bits;for(var oe=0;oe<8;oe++){var ve=B.scalefac_band.l[dt+oe+2];if(ve>=St)break;var ue=Ft;Wt=new ct(ue);var He=at(H,xt,ve,Wt);ue=Wt.bits,q[dt+oe]>ue&&(q[dt+oe]=ue,ut[dt+oe]=dt,x[dt+oe]=Yt,E[dt+oe]=He)}}}function g(B,L,H,q,ut,x,E,St){for(var dt=L.big_values,xt=2;xt<_.SBMAX_l+1;xt++){var Ft=B.scalefac_band.l[xt];if(Ft>=dt)break;var Wt=ut[xt-2]+L.count1bits;if(H.part2_3_length<=Wt)break;var Yt=new ct(Wt),oe=at(q,Ft,dt,Yt);Wt=Yt.bits,!(H.part2_3_length<=Wt)&&(H.assign(L),H.part2_3_length=Wt,H.region0_count=x[xt-2],H.region1_count=xt-2-x[xt-2],H.table_select[0]=E[xt-2],H.table_select[1]=St[xt-2],H.table_select[2]=oe)}}this.best_huffman_divide=function(B,L){var H=new Mt,q=L.l3_enc,ut=s(23),x=s(23),E=s(23),St=s(23);if(!(L.block_type==_.SHORT_TYPE&&B.mode_gr==1)){H.assign(L),L.block_type==_.NORM_TYPE&&(rt(B,L,q,ut,x,E,St),g(B,H,L,q,ut,x,E,St));var dt=H.big_values;if(!(dt==0||(q[dt-2]|q[dt-1])>1)&&(dt=L.count1+2,!(dt>576))){H.assign(L),H.count1=dt;for(var xt=0,Ft=0;dt>H.big_values;dt-=4){var Wt=((q[dt-4]*2+q[dt-3])*2+q[dt-2])*2+q[dt-1];xt+=M.t32l[Wt],Ft+=M.t33l[Wt]}if(H.big_values=dt,H.count1table_select=0,xt>Ft&&(xt=Ft,H.count1table_select=1),H.count1bits=xt,H.block_type==_.NORM_TYPE)g(B,H,L,q,ut,x,E,St);else{if(H.part2_3_length=xt,xt=B.scalefac_band.l[8],xt>dt&&(xt=dt),xt>0){var Yt=new ct(H.part2_3_length);H.table_select[0]=at(q,0,xt,Yt),H.part2_3_length=Yt.bits}if(dt>xt){var Yt=new ct(H.part2_3_length);H.table_select[1]=at(q,xt,dt,Yt),H.part2_3_length=Yt.bits}L.part2_3_length>H.part2_3_length&&L.assign(H)}}}};var T=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],U=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],tt=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],N=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];R.slen1_tab=tt,R.slen2_tab=N;function A(B,L){for(var H,q=L.tt[1][B],ut=L.tt[0][B],x=0;x<M.scfsi_band.length-1;x++){for(H=M.scfsi_band[x];H<M.scfsi_band[x+1]&&!(ut.scalefac[H]!=q.scalefac[H]&&q.scalefac[H]>=0);H++);if(H==M.scfsi_band[x+1]){for(H=M.scfsi_band[x];H<M.scfsi_band[x+1];H++)q.scalefac[H]=-1;L.scfsi[B][x]=1}}var E=0,St=0;for(H=0;H<11;H++)q.scalefac[H]!=-1&&(St++,E<q.scalefac[H]&&(E=q.scalefac[H]));for(var dt=0,xt=0;H<_.SBPSY_l;H++)q.scalefac[H]!=-1&&(xt++,dt<q.scalefac[H]&&(dt=q.scalefac[H]));for(var x=0;x<16;x++)if(E<T[x]&&dt<U[x]){var Ft=tt[x]*St+N[x]*xt;q.part2_length>Ft&&(q.part2_length=Ft,q.scalefac_compress=x)}}this.best_scalefac_store=function(B,L,H,q){var ut=q.tt[L][H],x,E,St,dt,xt=0;for(St=0,x=0;x<ut.sfbmax;x++){var Ft=ut.width[x];for(St+=Ft,dt=-Ft;dt<0&&ut.l3_enc[dt+St]==0;dt++);dt==0&&(ut.scalefac[x]=xt=-2)}if(ut.scalefac_scale==0&&ut.preflag==0){var Wt=0;for(x=0;x<ut.sfbmax;x++)ut.scalefac[x]>0&&(Wt|=ut.scalefac[x]);if(!(Wt&1)&&Wt!=0){for(x=0;x<ut.sfbmax;x++)ut.scalefac[x]>0&&(ut.scalefac[x]>>=1);ut.scalefac_scale=xt=1}}if(ut.preflag==0&&ut.block_type!=_.SHORT_TYPE&&B.mode_gr==2){for(x=11;x<_.SBPSY_l&&!(ut.scalefac[x]<$.pretab[x]&&ut.scalefac[x]!=-2);x++);if(x==_.SBPSY_l){for(x=11;x<_.SBPSY_l;x++)ut.scalefac[x]>0&&(ut.scalefac[x]-=$.pretab[x]);ut.preflag=xt=1}}for(E=0;E<4;E++)q.scfsi[H][E]=0;for(B.mode_gr==2&&L==1&&q.tt[0][H].block_type!=_.SHORT_TYPE&&q.tt[1][H].block_type!=_.SHORT_TYPE&&(A(H,q),xt=0),x=0;x<ut.sfbmax;x++)ut.scalefac[x]==-2&&(ut.scalefac[x]=0);xt!=0&&(B.mode_gr==2?this.scale_bitcount(ut):this.scale_bitcount_lsf(B,ut))};var z=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],k=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],K=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(B){var L,H,q=0,ut=0,x,E=B.scalefac;if(B.block_type==_.SHORT_TYPE)x=z,B.mixed_block_flag!=0&&(x=k);else if(x=K,B.preflag==0){for(H=11;H<_.SBPSY_l&&!(E[H]<$.pretab[H]);H++);if(H==_.SBPSY_l)for(B.preflag=1,H=11;H<_.SBPSY_l;H++)E[H]-=$.pretab[H]}for(H=0;H<B.sfbdivide;H++)q<E[H]&&(q=E[H]);for(;H<B.sfbmax;H++)ut<E[H]&&(ut=E[H]);for(B.part2_length=It.LARGE_BITS,L=0;L<16;L++)q<T[L]&&ut<U[L]&&B.part2_length>x[L]&&(B.part2_length=x[L],B.scalefac_compress=L);return B.part2_length==It.LARGE_BITS};var w=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(B,L){var H,q,ut,x,E,St,dt,xt,Ft=s(4),Wt=L.scalefac;for(L.preflag!=0?H=2:H=0,dt=0;dt<4;dt++)Ft[dt]=0;if(L.block_type==_.SHORT_TYPE){q=1;var Yt=$.nr_of_sfb_block[H][q];for(xt=0,ut=0;ut<4;ut++)for(x=Yt[ut]/3,dt=0;dt<x;dt++,xt++)for(E=0;E<3;E++)Wt[xt*3+E]>Ft[ut]&&(Ft[ut]=Wt[xt*3+E])}else{q=0;var Yt=$.nr_of_sfb_block[H][q];for(xt=0,ut=0;ut<4;ut++)for(x=Yt[ut],dt=0;dt<x;dt++,xt++)Wt[xt]>Ft[ut]&&(Ft[ut]=Wt[xt])}for(St=!1,ut=0;ut<4;ut++)Ft[ut]>w[H][ut]&&(St=!0);if(!St){var oe,ve,ue,He;for(L.sfb_partition_table=$.nr_of_sfb_block[H][q],ut=0;ut<4;ut++)L.slen[ut]=gt[Ft[ut]];switch(oe=L.slen[0],ve=L.slen[1],ue=L.slen[2],He=L.slen[3],H){case 0:L.scalefac_compress=(oe*5+ve<<4)+(ue<<2)+He;break;case 1:L.scalefac_compress=400+(oe*5+ve<<2)+ue;break;case 2:L.scalefac_compress=500+oe*3+ve;break}}if(!St)for(L.part2_length=0,ut=0;ut<4;ut++)L.part2_length+=L.slen[ut]*L.sfb_partition_table[ut];return St};var gt=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(B){for(var L=2;L<=576;L+=2){for(var H=0,q;B.scalefac_band.l[++H]<L;);for(q=ht[H][0];B.scalefac_band.l[q+1]>L;)q--;for(q<0&&(q=ht[H][0]),B.bv_scf[L-2]=q,q=ht[H][1];B.scalefac_band.l[q+B.bv_scf[L-2]+2]>L;)q--;q<0&&(q=ht[H][1]),B.bv_scf[L-1]=q}}}D.STEPS_per_dB=100,D.MAX_dB=120,D.GAIN_NOT_ENOUGH_SAMPLES=-24601,D.GAIN_ANALYSIS_ERROR=0,D.GAIN_ANALYSIS_OK=1,D.INIT_GAIN_ANALYSIS_ERROR=0,D.INIT_GAIN_ANALYSIS_OK=1,D.YULE_ORDER=10,D.MAX_ORDER=D.YULE_ORDER,D.MAX_SAMP_FREQ=48e3,D.RMS_WINDOW_TIME_NUMERATOR=1,D.RMS_WINDOW_TIME_DENOMINATOR=20,D.MAX_SAMPLES_PER_WINDOW=D.MAX_SAMP_FREQ*D.RMS_WINDOW_TIME_NUMERATOR/D.RMS_WINDOW_TIME_DENOMINATOR+1;function D(){}function I(){function $(j,nt,At,ft,kt,Q,Ot,at,rt,g,T,U,tt,N){this.quant_comp=nt,this.quant_comp_s=At,this.safejoint=ft,this.nsmsfix=kt,this.st_lrm=Q,this.st_s=Ot,this.nsbass=at,this.scale=rt,this.masking_adj=g,this.ath_lower=T,this.ath_curve=U,this.interch=tt,this.sfscale=N}var ct;this.setModules=function(j){ct=j};function ht(j,nt,At){n()}var Z=[new $(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new $(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new $(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new $(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new $(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new $(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new $(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new $(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new $(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new $(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new $(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new $(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new $(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new $(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new $(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new $(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new $(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function Lt(j,nt,At){var ft=nt,kt=ct.nearestBitrateFullIndex(nt);if(j.VBR=y.vbr_abr,j.VBR_mean_bitrate_kbps=ft,j.VBR_mean_bitrate_kbps=Math.min(j.VBR_mean_bitrate_kbps,320),j.VBR_mean_bitrate_kbps=Math.max(j.VBR_mean_bitrate_kbps,8),j.brate=j.VBR_mean_bitrate_kbps,j.VBR_mean_bitrate_kbps>320&&(j.disable_reservoir=!0),Z[kt].safejoint>0&&(j.exp_nspsytune=j.exp_nspsytune|2),Z[kt].sfscale>0&&(j.internal_flags.noise_shaping=2),Math.abs(Z[kt].nsbass)>0){var Q=int(Z[kt].nsbass*4);Q<0&&(Q+=64),j.exp_nspsytune=j.exp_nspsytune|Q<<2}return At!=0?j.quant_comp=Z[kt].quant_comp:Math.abs(j.quant_comp- -1)>0||(j.quant_comp=Z[kt].quant_comp),At!=0?j.quant_comp_short=Z[kt].quant_comp_s:Math.abs(j.quant_comp_short- -1)>0||(j.quant_comp_short=Z[kt].quant_comp_s),At!=0?j.msfix=Z[kt].nsmsfix:Math.abs(j.msfix- -1)>0||(j.msfix=Z[kt].nsmsfix),At!=0?j.internal_flags.nsPsy.attackthre=Z[kt].st_lrm:Math.abs(j.internal_flags.nsPsy.attackthre- -1)>0||(j.internal_flags.nsPsy.attackthre=Z[kt].st_lrm),At!=0?j.internal_flags.nsPsy.attackthre_s=Z[kt].st_s:Math.abs(j.internal_flags.nsPsy.attackthre_s- -1)>0||(j.internal_flags.nsPsy.attackthre_s=Z[kt].st_s),At!=0?j.scale=Z[kt].scale:Math.abs(j.scale- -1)>0||(j.scale=Z[kt].scale),At!=0?j.maskingadjust=Z[kt].masking_adj:Math.abs(j.maskingadjust-0)>0||(j.maskingadjust=Z[kt].masking_adj),Z[kt].masking_adj>0?At!=0?j.maskingadjust_short=Z[kt].masking_adj*.9:Math.abs(j.maskingadjust_short-0)>0||(j.maskingadjust_short=Z[kt].masking_adj*.9):At!=0?j.maskingadjust_short=Z[kt].masking_adj*1.1:Math.abs(j.maskingadjust_short-0)>0||(j.maskingadjust_short=Z[kt].masking_adj*1.1),At!=0?j.ATHlower=-Z[kt].ath_lower/10:Math.abs(-j.ATHlower*10-0)>0||(j.ATHlower=-Z[kt].ath_lower/10),At!=0?j.ATHcurve=Z[kt].ath_curve:Math.abs(j.ATHcurve- -1)>0||(j.ATHcurve=Z[kt].ath_curve),At!=0?j.interChRatio=Z[kt].interch:Math.abs(j.interChRatio- -1)>0||(j.interChRatio=Z[kt].interch),nt}this.apply_preset=function(j,nt,At){switch(nt){case Pt.R3MIX:{nt=Pt.V3,j.VBR=y.vbr_mtrh;break}case Pt.MEDIUM:{nt=Pt.V4,j.VBR=y.vbr_rh;break}case Pt.MEDIUM_FAST:{nt=Pt.V4,j.VBR=y.vbr_mtrh;break}case Pt.STANDARD:{nt=Pt.V2,j.VBR=y.vbr_rh;break}case Pt.STANDARD_FAST:{nt=Pt.V2,j.VBR=y.vbr_mtrh;break}case Pt.EXTREME:{nt=Pt.V0,j.VBR=y.vbr_rh;break}case Pt.EXTREME_FAST:{nt=Pt.V0,j.VBR=y.vbr_mtrh;break}case Pt.INSANE:return nt=320,j.preset=nt,Lt(j,nt,At),j.VBR=y.vbr_off,nt}switch(j.preset=nt,nt){case Pt.V9:return ht(),nt;case Pt.V8:return ht(),nt;case Pt.V7:return ht(),nt;case Pt.V6:return ht(),nt;case Pt.V5:return ht(),nt;case Pt.V4:return ht(),nt;case Pt.V3:return ht(),nt;case Pt.V2:return ht(),nt;case Pt.V1:return ht(),nt;case Pt.V0:return ht(),nt}return 8<=nt&&nt<=320?Lt(j,nt,At):(j.preset=0,nt)}}function W(){var $;this.setModules=function(ct){$=ct},this.ResvFrameBegin=function(ct,ht){var Z=ct.internal_flags,Lt,j=Z.l3_side,nt=$.getframebits(ct);ht.bits=(nt-Z.sideinfo_len*8)/Z.mode_gr;var At=8*256*Z.mode_gr-8;ct.brate>320?n():(Lt=8*1440,ct.strict_ISO&&n()),Z.ResvMax=Lt-nt,Z.ResvMax>At&&(Z.ResvMax=At),(Z.ResvMax<0||ct.disable_reservoir)&&(Z.ResvMax=0);var ft=ht.bits*Z.mode_gr+Math.min(Z.ResvSize,Z.ResvMax);return ft>Lt&&(ft=Lt),j.resvDrain_pre=0,Z.pinfo!=null&&n(),ft},this.ResvMaxBits=function(ct,ht,Z,Lt){var j=ct.internal_flags,nt,At=j.ResvSize,ft=j.ResvMax;Lt!=0&&(At+=ht),j.substep_shaping&1&&(ft*=.9),Z.bits=ht,At*10>ft*9?(nt=At-ft*9/10,Z.bits+=nt,j.substep_shaping|=128):(nt=0,j.substep_shaping&=127,!ct.disable_reservoir&&!(j.substep_shaping&1)&&(Z.bits-=.1*ht));var kt=At<j.ResvMax*6/10?At:j.ResvMax*6/10;return kt-=nt,kt<0&&(kt=0),kt},this.ResvAdjust=function(ct,ht){ct.ResvSize-=ht.part2_3_length+ht.part2_length},this.ResvFrameEnd=function(ct,ht){var Z,Lt=ct.l3_side;ct.ResvSize+=ht*ct.mode_gr;var j=0;Lt.resvDrain_post=0,Lt.resvDrain_pre=0,(Z=ct.ResvSize%8)!=0&&(j+=Z),Z=ct.ResvSize-j-ct.ResvMax,Z>0&&(j+=Z);{var nt=Math.min(Lt.main_data_begin*8,j)/8;Lt.resvDrain_pre+=8*nt,j-=8*nt,ct.ResvSize-=8*nt,Lt.main_data_begin-=nt}Lt.resvDrain_post+=j,ct.ResvSize-=j}}G.NUMTOCENTRIES=100,G.MAXFRAMESIZE=2880;function G(){this.setModules=function(ht,Z,Lt){};var $=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function ct(ht,Z){var Lt=Z^ht;return Z=Z>>8^$[Lt&255],Z}this.updateMusicCRC=function(ht,Z,Lt,j){for(var nt=0;nt<j;++nt)ht[0]=ct(Z[Lt+nt],ht[0])}}F.EQ=function($,ct){return Math.abs($)>Math.abs(ct)?Math.abs($-ct)<=Math.abs($)*1e-6:Math.abs($-ct)<=Math.abs(ct)*1e-6},F.NEQ=function($,ct){return!F.EQ($,ct)};function F(){var $=this,ct=null,ht=null;this.setModules=function(A,z,k,K){ct=k,ht=K};var Z=null,Lt=0,j=0,nt=0;this.getframebits=function(A){var z=A.internal_flags,k;z.bitrate_index!=0?k=M.bitrate_table[A.version][z.bitrate_index]:k=A.brate;var K=0|(A.version+1)*72e3*k/A.out_samplerate+z.padding;return 8*K};function At(A){v.arraycopy(A.header[A.w_ptr].buf,0,Z,j,A.sideinfo_len),j+=A.sideinfo_len,Lt+=A.sideinfo_len*8,A.w_ptr=A.w_ptr+1&Vt.MAX_HEADER_BUF-1}function ft(A,z,k){for(;k>0;){var K;nt==0&&(nt=8,j++,A.header[A.w_ptr].write_timing==Lt&&At(A),Z[j]=0),K=Math.min(k,nt),k-=K,nt-=K,Z[j]|=z>>k<<nt,Lt+=K}}function kt(A,z){var k=A.internal_flags,K;if(z>=8&&(ft(k,76,8),z-=8),z>=8&&(ft(k,65,8),z-=8),z>=8&&(ft(k,77,8),z-=8),z>=8&&(ft(k,69,8),z-=8),z>=32){var w=ct.getLameShortVersion();if(z>=32)for(K=0;K<w.length&&z>=8;++K)z-=8,ft(k,w.charCodeAt(K),8)}for(;z>=1;z-=1)ft(k,k.ancillary_flag,1),k.ancillary_flag^=A.disable_reservoir?0:1}function Q(A,z,k){for(var K=A.header[A.h_ptr].ptr;k>0;){var w=Math.min(k,8-(K&7));k-=w,A.header[A.h_ptr].buf[K>>3]|=z>>k<<8-(K&7)-w,K+=w}A.header[A.h_ptr].ptr=K}function Ot(A,z){var k=A.internal_flags,K,w,gt;if(K=k.l3_side,k.header[k.h_ptr].ptr=0,p.fill(k.header[k.h_ptr].buf,0,k.sideinfo_len,0),A.out_samplerate<16e3?Q(k,4094,12):Q(k,4095,12),Q(k,A.version,1),Q(k,1,2),Q(k,A.error_protection?0:1,1),Q(k,k.bitrate_index,4),Q(k,k.samplerate_index,2),Q(k,k.padding,1),Q(k,A.extension,1),Q(k,A.mode.ordinal(),2),Q(k,k.mode_ext,2),Q(k,A.copyright,1),Q(k,A.original,1),Q(k,A.emphasis,2),A.error_protection&&Q(k,0,16),A.version==1){for(Q(k,K.main_data_begin,9),k.channels_out==2?Q(k,K.private_bits,3):Q(k,K.private_bits,5),gt=0;gt<k.channels_out;gt++){var B;for(B=0;B<4;B++)Q(k,K.scfsi[gt][B],1)}for(w=0;w<2;w++)for(gt=0;gt<k.channels_out;gt++){var L=K.tt[w][gt];Q(k,L.part2_3_length+L.part2_length,12),Q(k,L.big_values/2,9),Q(k,L.global_gain,8),Q(k,L.scalefac_compress,4),L.block_type!=_.NORM_TYPE?(Q(k,1,1),Q(k,L.block_type,2),Q(k,L.mixed_block_flag,1),L.table_select[0]==14&&(L.table_select[0]=16),Q(k,L.table_select[0],5),L.table_select[1]==14&&(L.table_select[1]=16),Q(k,L.table_select[1],5),Q(k,L.subblock_gain[0],3),Q(k,L.subblock_gain[1],3),Q(k,L.subblock_gain[2],3)):(Q(k,0,1),L.table_select[0]==14&&(L.table_select[0]=16),Q(k,L.table_select[0],5),L.table_select[1]==14&&(L.table_select[1]=16),Q(k,L.table_select[1],5),L.table_select[2]==14&&(L.table_select[2]=16),Q(k,L.table_select[2],5),Q(k,L.region0_count,4),Q(k,L.region1_count,3)),Q(k,L.preflag,1),Q(k,L.scalefac_scale,1),Q(k,L.count1table_select,1)}}else for(Q(k,K.main_data_begin,8),Q(k,K.private_bits,k.channels_out),w=0,gt=0;gt<k.channels_out;gt++){var L=K.tt[w][gt];Q(k,L.part2_3_length+L.part2_length,12),Q(k,L.big_values/2,9),Q(k,L.global_gain,8),Q(k,L.scalefac_compress,9),L.block_type!=_.NORM_TYPE?(Q(k,1,1),Q(k,L.block_type,2),Q(k,L.mixed_block_flag,1),L.table_select[0]==14&&(L.table_select[0]=16),Q(k,L.table_select[0],5),L.table_select[1]==14&&(L.table_select[1]=16),Q(k,L.table_select[1],5),Q(k,L.subblock_gain[0],3),Q(k,L.subblock_gain[1],3),Q(k,L.subblock_gain[2],3)):(Q(k,0,1),L.table_select[0]==14&&(L.table_select[0]=16),Q(k,L.table_select[0],5),L.table_select[1]==14&&(L.table_select[1]=16),Q(k,L.table_select[1],5),L.table_select[2]==14&&(L.table_select[2]=16),Q(k,L.table_select[2],5),Q(k,L.region0_count,4),Q(k,L.region1_count,3)),Q(k,L.scalefac_scale,1),Q(k,L.count1table_select,1)}A.error_protection&&n();{var H=k.h_ptr;k.h_ptr=H+1&Vt.MAX_HEADER_BUF-1,k.header[k.h_ptr].write_timing=k.header[H].write_timing+z,k.h_ptr==k.w_ptr}}function at(A,z){var k=M.ht[z.count1table_select+32],K,w=0,gt=z.big_values,B=z.big_values;for(K=(z.count1-z.big_values)/4;K>0;--K){var L=0,H=0,q;q=z.l3_enc[gt+0],q!=0&&(H+=8,z.xr[B+0]<0&&L++),q=z.l3_enc[gt+1],q!=0&&(H+=4,L*=2,z.xr[B+1]<0&&L++),q=z.l3_enc[gt+2],q!=0&&(H+=2,L*=2,z.xr[B+2]<0&&L++),q=z.l3_enc[gt+3],q!=0&&(H++,L*=2,z.xr[B+3]<0&&L++),gt+=4,B+=4,ft(A,L+k.table[H],k.hlen[H]),w+=k.hlen[H]}return w}function rt(A,z,k,K,w){var gt=M.ht[z],B=0;if(z==0)return B;for(var L=k;L<K;L+=2){var H=0,q=0,ut=gt.xlen,x=gt.xlen,E=0,St=w.l3_enc[L],dt=w.l3_enc[L+1];if(St!=0&&(w.xr[L]<0&&E++,H--),z>15){if(St>14){var xt=St-15;E|=xt<<1,q=ut,St=15}if(dt>14){var Ft=dt-15;E<<=ut,E|=Ft,q+=ut,dt=15}x=16}dt!=0&&(E<<=1,w.xr[L+1]<0&&E++,H--),St=St*x+dt,q-=H,H+=gt.hlen[St],ft(A,gt.table[St],H),ft(A,E,q),B+=H+q}return B}function g(A,z){var k=3*A.scalefac_band.s[3];k>z.big_values&&(k=z.big_values);var K=rt(A,z.table_select[0],0,k,z);return K+=rt(A,z.table_select[1],k,z.big_values,z),K}function T(A,z){var k,K,w,gt;k=z.big_values;var B=z.region0_count+1;return w=A.scalefac_band.l[B],B+=z.region1_count+1,gt=A.scalefac_band.l[B],w>k&&(w=k),gt>k&&(gt=k),K=rt(A,z.table_select[0],0,w,z),K+=rt(A,z.table_select[1],w,gt,z),K+=rt(A,z.table_select[2],gt,k,z),K}function U(A){var z,k,K,w,gt=0,B=A.internal_flags,L=B.l3_side;if(A.version==1)for(z=0;z<2;z++)for(k=0;k<B.channels_out;k++){var H=L.tt[z][k],q=R.slen1_tab[H.scalefac_compress],ut=R.slen2_tab[H.scalefac_compress];for(w=0,K=0;K<H.sfbdivide;K++)H.scalefac[K]!=-1&&(ft(B,H.scalefac[K],q),w+=q);for(;K<H.sfbmax;K++)H.scalefac[K]!=-1&&(ft(B,H.scalefac[K],ut),w+=ut);H.block_type==_.SHORT_TYPE?w+=g(B,H):w+=T(B,H),w+=at(B,H),gt+=w}else for(z=0,k=0;k<B.channels_out;k++){var H=L.tt[z][k],x,E,St=0;if(w=0,K=0,E=0,H.block_type==_.SHORT_TYPE){for(;E<4;E++){var dt=H.sfb_partition_table[E]/3,xt=H.slen[E];for(x=0;x<dt;x++,K++)ft(B,Math.max(H.scalefac[K*3+0],0),xt),ft(B,Math.max(H.scalefac[K*3+1],0),xt),ft(B,Math.max(H.scalefac[K*3+2],0),xt),St+=3*xt}w+=g(B,H)}else{for(;E<4;E++){var dt=H.sfb_partition_table[E],xt=H.slen[E];for(x=0;x<dt;x++,K++)ft(B,Math.max(H.scalefac[K],0),xt),St+=xt}w+=T(B,H)}w+=at(B,H),gt+=St+w}return gt}function tt(){this.total=0}function N(A,z){var k=A.internal_flags,K,w,gt;return k.w_ptr,gt=k.h_ptr-1,gt==-1&&(gt=Vt.MAX_HEADER_BUF-1),K=k.header[gt].write_timing-Lt,z.total=K,K>=0&&n(),w=$.getframebits(A),K+=w,z.total+=w,z.total%8!=0?z.total=1+z.total/8:z.total=z.total/8,z.total+=j+1,K}this.flush_bitstream=function(A){var z=A.internal_flags,k,K;z.h_ptr-1,k=z.l3_side,!((K=N(A,new tt))<0)&&(kt(A,K),z.ResvSize=0,k.main_data_begin=0,z.findReplayGain&&n(),z.findPeakSample&&n())},this.format_bitstream=function(A){var z=A.internal_flags,k;k=z.l3_side;var K=this.getframebits(A);kt(A,k.resvDrain_pre),Ot(A,K);var w=8*z.sideinfo_len;if(w+=U(A),kt(A,k.resvDrain_post),w+=k.resvDrain_post,k.main_data_begin+=(K-w)/8,N(A,new tt)!=z.ResvSize,k.main_data_begin*8!=z.ResvSize&&(z.ResvSize=k.main_data_begin*8),Lt>1e9){var gt;for(gt=0;gt<Vt.MAX_HEADER_BUF;++gt)z.header[gt].write_timing-=Lt;Lt=0}return 0},this.copy_buffer=function(A,z,k,K,w){var gt=j+1;if(gt<=0)return 0;if(K!=0&&gt>K)return-1;if(v.arraycopy(Z,0,z,k,gt),j=-1,nt=0,w!=0){var B=s(1);B[0]=A.nMusicCRC,ht.updateMusicCRC(B,z,k,gt),A.nMusicCRC=B[0],gt>0&&(A.VBR_seek_table.nBytesWritten+=gt),A.decode_on_the_fly&&n()}return gt},this.init_bit_stream_w=function(A){Z=a(Pt.LAME_MAXMP3BUFFER),A.h_ptr=A.w_ptr=0,A.header[A.h_ptr].write_timing=0,j=-1,nt=0,Lt=0}}function X($,ct,ht,Z){this.xlen=$,this.linmax=ct,this.table=ht,this.hlen=Z}var M={};M.t1HB=[1,1,1,0],M.t2HB=[1,2,1,3,1,1,3,2,0],M.t3HB=[3,2,1,1,1,1,3,2,0],M.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],M.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],M.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],M.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],M.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],M.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],M.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],M.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],M.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],M.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],M.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],M.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],M.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],M.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],M.t1l=[1,4,3,5],M.t2l=[1,4,7,4,5,7,6,7,8],M.t3l=[2,3,7,4,4,7,6,7,8],M.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],M.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],M.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],M.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],M.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],M.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],M.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],M.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],M.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],M.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],M.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],M.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],M.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],M.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],M.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],M.ht=[new X(0,0,null,null),new X(2,0,M.t1HB,M.t1l),new X(3,0,M.t2HB,M.t2l),new X(3,0,M.t3HB,M.t3l),new X(0,0,null,null),new X(4,0,M.t5HB,M.t5l),new X(4,0,M.t6HB,M.t6l),new X(6,0,M.t7HB,M.t7l),new X(6,0,M.t8HB,M.t8l),new X(6,0,M.t9HB,M.t9l),new X(8,0,M.t10HB,M.t10l),new X(8,0,M.t11HB,M.t11l),new X(8,0,M.t12HB,M.t12l),new X(16,0,M.t13HB,M.t13l),new X(0,0,null,M.t16_5l),new X(16,0,M.t15HB,M.t15l),new X(1,1,M.t16HB,M.t16l),new X(2,3,M.t16HB,M.t16l),new X(3,7,M.t16HB,M.t16l),new X(4,15,M.t16HB,M.t16l),new X(6,63,M.t16HB,M.t16l),new X(8,255,M.t16HB,M.t16l),new X(10,1023,M.t16HB,M.t16l),new X(13,8191,M.t16HB,M.t16l),new X(4,15,M.t24HB,M.t24l),new X(5,31,M.t24HB,M.t24l),new X(6,63,M.t24HB,M.t24l),new X(7,127,M.t24HB,M.t24l),new X(8,255,M.t24HB,M.t24l),new X(9,511,M.t24HB,M.t24l),new X(11,2047,M.t24HB,M.t24l),new X(13,8191,M.t24HB,M.t24l),new X(0,0,M.t32HB,M.t32l),new X(0,0,M.t33HB,M.t33l)],M.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],M.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],M.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],M.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],M.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],M.scfsi_band=[0,6,11,16,21];function st($){this.bits=$}function J(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function pt(){this.setModules=function($,ct){}}function zt(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=o(_.SBMAX_l),this.s=o(_.SBMAX_s),this.psfb21=o(_.PSFB21),this.psfb12=o(_.PSFB12),this.cb_l=o(_.CBANDS),this.cb_s=o(_.CBANDS),this.eql_w=o(_.BLKSIZE/2)}function Xt(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=S.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function Ht($){var ct=$;this.quantize=ct,this.iteration_loop=function(ht,Z,Lt,j){var nt=ht.internal_flags,At=o(lt.SFBMAX),ft=o(576),kt=s(2),Q=0,Ot=nt.l3_side,at=new st(Q);this.quantize.rv.ResvFrameBegin(ht,at),Q=at.bits;for(var rt=0;rt<nt.mode_gr;rt++){this.quantize.qupvt.on_pe(ht,Z,kt,Q,rt,rt),nt.mode_ext==_.MPG_MD_MS_LR&&n();for(var g=0;g<nt.channels_out;g++){var T,U,tt=Ot.tt[rt][g];tt.block_type!=_.SHORT_TYPE?(T=0,U=nt.PSY.mask_adjust-T):(T=0,U=nt.PSY.mask_adjust_short-T),nt.masking_lower=Math.pow(10,U*.1),this.quantize.init_outer_loop(nt,tt),this.quantize.init_xrpow(nt,tt,ft)&&(this.quantize.qupvt.calc_xmin(ht,j[rt][g],tt,At),this.quantize.outer_loop(ht,tt,At,ft,g,kt[g])),this.quantize.iteration_finish_one(nt,rt,g)}}this.quantize.rv.ResvFrameEnd(nt,Q)}}function Nt(){}function yt($,ct,ht,Z){this.l=s(1+_.SBMAX_l),this.s=s(1+_.SBMAX_s),this.psfb21=s(1+_.PSFB21),this.psfb12=s(1+_.PSFB12);var Lt=this.l,j=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],v.arraycopy(this.arrL,0,Lt,0,Math.min(this.arrL.length,this.l.length)),v.arraycopy(this.arrS,0,j,0,Math.min(this.arrS.length,this.s.length)),v.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),v.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}It.Q_MAX=257,It.Q_MAX2=116,It.LARGE_BITS=1e5,It.IXMAX_VAL=8206;function It(){var $=null,ct=null,ht=null;this.setModules=function(N,A,z){$=N,ct=A,ht=z};function Z(N){return Ot[N+It.Q_MAX2]}this.IPOW20=function(N){return at[N]};var Lt=2220446049250313e-31,j=It.IXMAX_VAL,nt=j+2,At=It.Q_MAX,ft=It.Q_MAX2,kt=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var Q=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=Q,this.sfBandIndex=[new yt([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new yt([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new yt([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new yt([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new yt([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new yt([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new yt([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new yt([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new yt([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var Ot=o(At+ft+1),at=o(At),rt=o(nt),g=o(nt);this.adj43=g;function T(N,A){var z=ht.ATHformula(A,N);return z-=kt,z=Math.pow(10,z/10+N.ATHlower),z}function U(N){for(var A=N.internal_flags.ATH.l,z=N.internal_flags.ATH.psfb21,k=N.internal_flags.ATH.s,K=N.internal_flags.ATH.psfb12,w=N.internal_flags,gt=N.out_samplerate,B=0;B<_.SBMAX_l;B++){var L=w.scalefac_band.l[B],H=w.scalefac_band.l[B+1];A[B]=b.MAX_VALUE;for(var q=L;q<H;q++){var ut=q*gt/1152,x=T(N,ut);A[B]=Math.min(A[B],x)}}for(var B=0;B<_.PSFB21;B++){var L=w.scalefac_band.psfb21[B],H=w.scalefac_band.psfb21[B+1];z[B]=b.MAX_VALUE;for(var q=L;q<H;q++){var ut=q*gt/1152,x=T(N,ut);z[B]=Math.min(z[B],x)}}for(var B=0;B<_.SBMAX_s;B++){var L=w.scalefac_band.s[B],H=w.scalefac_band.s[B+1];k[B]=b.MAX_VALUE;for(var q=L;q<H;q++){var ut=q*gt/384,x=T(N,ut);k[B]=Math.min(k[B],x)}k[B]*=w.scalefac_band.s[B+1]-w.scalefac_band.s[B]}for(var B=0;B<_.PSFB12;B++){var L=w.scalefac_band.psfb12[B],H=w.scalefac_band.psfb12[B+1];K[B]=b.MAX_VALUE;for(var q=L;q<H;q++){var ut=q*gt/384,x=T(N,ut);K[B]=Math.min(K[B],x)}K[B]*=w.scalefac_band.s[13]-w.scalefac_band.s[12]}N.noATH&&n(),w.ATH.floor=10*r(T(N,-1))}this.iteration_init=function(N){var A=N.internal_flags,z=A.l3_side,k;if(A.iteration_init_init==0){for(A.iteration_init_init=1,z.main_data_begin=0,U(N),rt[0]=0,k=1;k<nt;k++)rt[k]=Math.pow(k,4/3);for(k=0;k<nt-1;k++)g[k]=k+1-Math.pow(.5*(rt[k]+rt[k+1]),.75);for(g[k]=.5,k=0;k<At;k++)at[k]=Math.pow(2,(k-210)*-.1875);for(k=0;k<=At+ft;k++)Ot[k]=Math.pow(2,(k-210-ft)*.25);$.huffman_init(A);{var K,w,gt,B;for(k=N.exp_nspsytune>>2&63,k>=32&&(k-=64),K=Math.pow(10,k/4/10),k=N.exp_nspsytune>>8&63,k>=32&&(k-=64),w=Math.pow(10,k/4/10),k=N.exp_nspsytune>>14&63,k>=32&&(k-=64),gt=Math.pow(10,k/4/10),k=N.exp_nspsytune>>20&63,k>=32&&(k-=64),B=gt*Math.pow(10,k/4/10),k=0;k<_.SBMAX_l;k++){var L;k<=6?L=K:k<=13?L=w:k<=20?L=gt:L=B,A.nsPsy.longfact[k]=L}for(k=0;k<_.SBMAX_s;k++){var L;k<=5?L=K:k<=10?L=w:k<=11?L=gt:L=B,A.nsPsy.shortfact[k]=L}}}},this.on_pe=function(N,A,z,k,K,w){var gt=N.internal_flags,B=0,L,H=s(2),q,ut=new st(B),x=ct.ResvMaxBits(N,k,ut,w);B=ut.bits;var E=B+x;for(E>Vt.MAX_BITS_PER_GRANULE&&(E=Vt.MAX_BITS_PER_GRANULE),L=0,q=0;q<gt.channels_out;++q)z[q]=Math.min(Vt.MAX_BITS_PER_CHANNEL,B/gt.channels_out),H[q]=0|z[q]*A[K][q]/700-z[q],H[q]>k*3/4&&(H[q]=k*3/4),H[q]<0&&(H[q]=0),H[q]+z[q]>Vt.MAX_BITS_PER_CHANNEL&&(H[q]=Math.max(0,Vt.MAX_BITS_PER_CHANNEL-z[q])),L+=H[q];if(L>x)for(q=0;q<gt.channels_out;++q)H[q]=x*H[q]/L;for(q=0;q<gt.channels_out;++q)z[q]+=H[q],x-=H[q];for(L=0,q=0;q<gt.channels_out;++q)L+=z[q];return L>Vt.MAX_BITS_PER_GRANULE&&n(),E},this.athAdjust=function(N,A,z){var k=90.30873362,K=94.82444863,w=h.FAST_LOG10_X(A,10),gt=N*N,B=0;return w-=z,gt>1e-20&&(B=1+h.FAST_LOG10_X(gt,10/k)),B<0&&(B=0),w*=B,w+=z+k-K,Math.pow(10,.1*w)},this.calc_xmin=function(N,A,z,k){var K=0,w=N.internal_flags,gt,B=0,L=0,H=w.ATH,q=z.xr,ut=N.VBR==y.vbr_mtrh?1:0,x=w.masking_lower;for((N.VBR==y.vbr_mtrh||N.VBR==y.vbr_mt)&&(x=1),gt=0;gt<z.psy_lmax;gt++){var E,St,dt,xt,Ft,Wt;N.VBR==y.vbr_rh||N.VBR==y.vbr_mtrh?St=athAdjust(H.adjust,H.l[gt],H.floor):St=H.adjust*H.l[gt],Ft=z.width[gt],dt=St/Ft,xt=Lt,Wt=Ft>>1,E=0;do{var Yt,oe;Yt=q[B]*q[B],E+=Yt,xt+=Yt<dt?Yt:dt,B++,oe=q[B]*q[B],E+=oe,xt+=oe<dt?oe:dt,B++}while(--Wt>0);if(E>St&&L++,gt==_.SBPSY_l&&n(),ut!=0&&(St=xt),!N.ATHonly){var ve=A.en.l[gt];if(ve>0){var ue;ue=E*A.thm.l[gt]*x/ve,ut!=0&&(ue*=w.nsPsy.longfact[gt]),St<ue&&(St=ue)}}ut!=0?k[K++]=St:k[K++]=St*w.nsPsy.longfact[gt]}var He=575;if(z.block_type!=_.SHORT_TYPE)for(var Ge=576;Ge--!=0&&F.EQ(q[Ge],0);)He=Ge;z.max_nonzero_coeff=He;for(var Oe=z.sfb_smin;gt<z.psymax;Oe++,gt+=3){var Ft,Ne,Je;for(N.VBR==y.vbr_rh||N.VBR==y.vbr_mtrh?Je=athAdjust(H.adjust,H.s[Oe],H.floor):Je=H.adjust*H.s[Oe],Ft=z.width[gt],Ne=0;Ne<3;Ne++){var E=0,St,dt,xt,Wt=Ft>>1;dt=Je/Ft,xt=Lt;do{var Yt,oe;Yt=q[B]*q[B],E+=Yt,xt+=Yt<dt?Yt:dt,B++,oe=q[B]*q[B],E+=oe,xt+=oe<dt?oe:dt,B++}while(--Wt>0);if(E>Je&&L++,Oe==_.SBPSY_s&&n(),ut!=0?St=xt:St=Je,!N.ATHonly&&!N.ATHshort){var ve=A.en.s[Oe][Ne];if(ve>0){var ue;ue=E*A.thm.s[Oe][Ne]*x/ve,ut!=0&&(ue*=w.nsPsy.shortfact[Oe]),St<ue&&(St=ue)}}ut!=0?k[K++]=St:k[K++]=St*w.nsPsy.shortfact[Oe]}N.useTemporal&&(k[K-3]>k[K-3+1]&&(k[K-3+1]+=(k[K-3]-k[K-3+1])*w.decay),k[K-3+1]>k[K-3+2]&&(k[K-3+2]+=(k[K-3+1]-k[K-3+2])*w.decay))}return L};function tt(N){this.s=N}this.calc_noise_core=function(N,A,z,k){var K=0,w=A.s,gt=N.l3_enc;if(w>N.count1)for(;z--!=0;){var B;B=N.xr[w],w++,K+=B*B,B=N.xr[w],w++,K+=B*B}else if(w>N.big_values){var L=o(2);for(L[0]=0,L[1]=k;z--!=0;){var B;B=Math.abs(N.xr[w])-L[gt[w]],w++,K+=B*B,B=Math.abs(N.xr[w])-L[gt[w]],w++,K+=B*B}}else for(;z--!=0;){var B;B=Math.abs(N.xr[w])-rt[gt[w]]*k,w++,K+=B*B,B=Math.abs(N.xr[w])-rt[gt[w]]*k,w++,K+=B*B}return A.s=w,K},this.calc_noise=function(N,A,z,k,K){var w=0,gt=0,B,L,H=0,q=0,ut=0,x=-20,E=0,St=N.scalefac,dt=0;for(k.over_SSD=0,B=0;B<N.psymax;B++){var xt=N.global_gain-(St[dt++]+(N.preflag!=0?Q[B]:0)<<N.scalefac_scale+1)-N.subblock_gain[N.window[B]]*8,Ft=0;if(K!=null&&K.step[B]==xt)Ft=K.noise[B],E+=N.width[B],z[w++]=Ft/A[gt++],Ft=K.noise_log[B];else{var Wt=Z(xt);if(L=N.width[B]>>1,E+N.width[B]>N.max_nonzero_coeff){var Yt;Yt=N.max_nonzero_coeff-E+1,Yt>0?L=Yt>>1:L=0}var oe=new tt(E);Ft=this.calc_noise_core(N,oe,L,Wt),E=oe.s,K!=null&&(K.step[B]=xt,K.noise[B]=Ft),Ft=z[w++]=Ft/A[gt++],Ft=h.FAST_LOG10(Math.max(Ft,1e-20)),K!=null&&(K.noise_log[B]=Ft)}if(K!=null&&(K.global_gain=N.global_gain),ut+=Ft,Ft>0){var ve;ve=Math.max(0|Ft*10+.5,1),k.over_SSD+=ve*ve,H++,q+=Ft}x=Math.max(x,Ft)}return k.over_count=H,k.tot_noise=ut,k.over_noise=q,k.max_noise=x,H}}function Rt(){this.global_gain=0,this.sfb_count1=0,this.step=s(39),this.noise=o(39),this.noise_log=o(39)}function Mt(){this.xr=o(576),this.l3_enc=s(576),this.scalefac=s(lt.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=s(3),this.subblock_gain=s(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=s(lt.SFBMAX),this.window=s(lt.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=s(4),this.max_nonzero_coeff=0;var $=this;function ct(Z){return new Int32Array(Z)}function ht(Z){return new Float32Array(Z)}this.assign=function(Z){$.xr=ht(Z.xr),$.l3_enc=ct(Z.l3_enc),$.scalefac=ct(Z.scalefac),$.xrpow_max=Z.xrpow_max,$.part2_3_length=Z.part2_3_length,$.big_values=Z.big_values,$.count1=Z.count1,$.global_gain=Z.global_gain,$.scalefac_compress=Z.scalefac_compress,$.block_type=Z.block_type,$.mixed_block_flag=Z.mixed_block_flag,$.table_select=ct(Z.table_select),$.subblock_gain=ct(Z.subblock_gain),$.region0_count=Z.region0_count,$.region1_count=Z.region1_count,$.preflag=Z.preflag,$.scalefac_scale=Z.scalefac_scale,$.count1table_select=Z.count1table_select,$.part2_length=Z.part2_length,$.sfb_lmax=Z.sfb_lmax,$.sfb_smin=Z.sfb_smin,$.psy_lmax=Z.psy_lmax,$.sfbmax=Z.sfbmax,$.psymax=Z.psymax,$.sfbdivide=Z.sfbdivide,$.width=ct(Z.width),$.window=ct(Z.window),$.count1bits=Z.count1bits,$.sfb_partition_table=Z.sfb_partition_table.slice(0),$.slen=ct(Z.slen),$.max_nonzero_coeff=Z.max_nonzero_coeff}}var lt={};lt.SFBMAX=_.SBMAX_s*3;function Bt(){this.rv=null;var $;this.qupvt=null;var ct,ht=new pt,Z;this.setModules=function(g,T,U,tt){$=T,this.rv=T,ct=U,this.qupvt=U,Z=tt,ht.setModules(ct,Z)};function Lt(g,T,U,tt){tt=0;for(var N=0;N<=U;++N){var A=Math.abs(g.xr[N]);tt+=A,T[N]=Math.sqrt(A*Math.sqrt(A)),T[N]>g.xrpow_max&&(g.xrpow_max=T[N])}return tt}this.init_xrpow=function(g,T,U){var tt=0,N=0|T.max_nonzero_coeff;if(T.xrpow_max=0,p.fill(U,N,576,0),tt=Lt(T,U,N,tt),tt>1e-20){var A=0;g.substep_shaping&2&&(A=1);for(var z=0;z<T.psymax;z++)g.pseudohalf[z]=A;return!0}return p.fill(T.l3_enc,0,576,0),!1};function j(g,T){var U=g.ATH,tt=T.xr;if(T.block_type!=_.SHORT_TYPE)for(var N=!1,A=_.PSFB21-1;A>=0&&!N;A--){var z=g.scalefac_band.psfb21[A],k=g.scalefac_band.psfb21[A+1],K=ct.athAdjust(U.adjust,U.psfb21[A],U.floor);g.nsPsy.longfact[21]>1e-12&&(K*=g.nsPsy.longfact[21]);for(var w=k-1;w>=z;w--)if(Math.abs(tt[w])<K)tt[w]=0;else{N=!0;break}}else for(var gt=0;gt<3;gt++)for(var N=!1,A=_.PSFB12-1;A>=0&&!N;A--){var z=g.scalefac_band.s[12]*3+(g.scalefac_band.s[13]-g.scalefac_band.s[12])*gt+(g.scalefac_band.psfb12[A]-g.scalefac_band.psfb12[0]),k=z+(g.scalefac_band.psfb12[A+1]-g.scalefac_band.psfb12[A]),B=ct.athAdjust(U.adjust,U.psfb12[A],U.floor);g.nsPsy.shortfact[12]>1e-12&&(B*=g.nsPsy.shortfact[12]);for(var w=k-1;w>=z;w--)if(Math.abs(tt[w])<B)tt[w]=0;else{N=!0;break}}}this.init_outer_loop=function(g,T){T.part2_3_length=0,T.big_values=0,T.count1=0,T.global_gain=210,T.scalefac_compress=0,T.table_select[0]=0,T.table_select[1]=0,T.table_select[2]=0,T.subblock_gain[0]=0,T.subblock_gain[1]=0,T.subblock_gain[2]=0,T.subblock_gain[3]=0,T.region0_count=0,T.region1_count=0,T.preflag=0,T.scalefac_scale=0,T.count1table_select=0,T.part2_length=0,T.sfb_lmax=_.SBPSY_l,T.sfb_smin=_.SBPSY_s,T.psy_lmax=g.sfb21_extra?_.SBMAX_l:_.SBPSY_l,T.psymax=T.psy_lmax,T.sfbmax=T.sfb_lmax,T.sfbdivide=11;for(var U=0;U<_.SBMAX_l;U++)T.width[U]=g.scalefac_band.l[U+1]-g.scalefac_band.l[U],T.window[U]=3;if(T.block_type==_.SHORT_TYPE){var tt=o(576);T.sfb_smin=0,T.sfb_lmax=0,T.mixed_block_flag!=0&&n(),T.psymax=T.sfb_lmax+3*((g.sfb21_extra?_.SBMAX_s:_.SBPSY_s)-T.sfb_smin),T.sfbmax=T.sfb_lmax+3*(_.SBPSY_s-T.sfb_smin),T.sfbdivide=T.sfbmax-18,T.psy_lmax=T.sfb_lmax;var N=g.scalefac_band.l[T.sfb_lmax];v.arraycopy(T.xr,0,tt,0,576);for(var U=T.sfb_smin;U<_.SBMAX_s;U++)for(var A=g.scalefac_band.s[U],z=g.scalefac_band.s[U+1],k=0;k<3;k++)for(var K=A;K<z;K++)T.xr[N++]=tt[3*K+k];for(var w=T.sfb_lmax,U=T.sfb_smin;U<_.SBMAX_s;U++)T.width[w]=T.width[w+1]=T.width[w+2]=g.scalefac_band.s[U+1]-g.scalefac_band.s[U],T.window[w]=0,T.window[w+1]=1,T.window[w+2]=2,w+=3}T.count1bits=0,T.sfb_partition_table=ct.nr_of_sfb_block[0][0],T.slen[0]=0,T.slen[1]=0,T.slen[2]=0,T.slen[3]=0,T.max_nonzero_coeff=575,p.fill(T.scalefac,0),j(g,T)};function nt(g){this.ordinal=g}nt.BINSEARCH_NONE=new nt(0),nt.BINSEARCH_UP=new nt(1),nt.BINSEARCH_DOWN=new nt(2);function At(g,T,U,tt,N){var A,z=g.CurrentStep[tt],k=!1,K=g.OldValue[tt],w=nt.BINSEARCH_NONE;for(T.global_gain=K,U-=T.part2_length;;){var gt;if(A=Z.count_bits(g,N,T,null),z==1||A==U)break;A>U?(w==nt.BINSEARCH_DOWN&&(k=!0),k&&(z/=2),w=nt.BINSEARCH_UP,gt=z):(w==nt.BINSEARCH_UP&&(k=!0),k&&(z/=2),w=nt.BINSEARCH_DOWN,gt=-z),T.global_gain+=gt,T.global_gain<0&&n(),T.global_gain>255&&n()}for(;A>U&&T.global_gain<255;)T.global_gain++,A=Z.count_bits(g,N,T,null);return g.CurrentStep[tt]=K-T.global_gain>=4?4:2,g.OldValue[tt]=T.global_gain,T.part2_3_length=A,A}function ft(g){for(var T=0;T<g.sfbmax;T++)if(g.scalefac[T]+g.subblock_gain[g.window[T]]==0)return!1;return!0}function kt(g,T,U,tt,N){var A;switch(g){default:case 9:{T.over_count>0?(A=U.over_SSD<=T.over_SSD,U.over_SSD==T.over_SSD&&(A=U.bits<T.bits)):A=U.max_noise<0&&U.max_noise*10+U.bits<=T.max_noise*10+T.bits;break}case 0:A=U.over_count<T.over_count||U.over_count==T.over_count&&U.over_noise<T.over_noise||U.over_count==T.over_count&&F.EQ(U.over_noise,T.over_noise)&&U.tot_noise<T.tot_noise;break;case 8:n();case 1:A=U.max_noise<T.max_noise;break;case 2:A=U.tot_noise<T.tot_noise;break;case 3:A=U.tot_noise<T.tot_noise&&U.max_noise<T.max_noise;break;case 4:A=U.max_noise<=0&&T.max_noise>.2||U.max_noise<=0&&T.max_noise<0&&T.max_noise>U.max_noise-.2&&U.tot_noise<T.tot_noise||U.max_noise<=0&&T.max_noise>0&&T.max_noise>U.max_noise-.2&&U.tot_noise<T.tot_noise+T.over_noise||U.max_noise>0&&T.max_noise>-.05&&T.max_noise>U.max_noise-.1&&U.tot_noise+U.over_noise<T.tot_noise+T.over_noise||U.max_noise>0&&T.max_noise>-.1&&T.max_noise>U.max_noise-.15&&U.tot_noise+U.over_noise+U.over_noise<T.tot_noise+T.over_noise+T.over_noise;break;case 5:A=U.over_noise<T.over_noise||F.EQ(U.over_noise,T.over_noise)&&U.tot_noise<T.tot_noise;break;case 6:A=U.over_noise<T.over_noise||F.EQ(U.over_noise,T.over_noise)&&(U.max_noise<T.max_noise||F.EQ(U.max_noise,T.max_noise)&&U.tot_noise<=T.tot_noise);break;case 7:A=U.over_count<T.over_count||U.over_noise<T.over_noise;break}return T.over_count==0&&(A=A&&U.bits<T.bits),A}function Q(g,T,U,tt,N){var A=g.internal_flags,z;T.scalefac_scale==0?z=1.2968395546510096:z=1.6817928305074292;for(var k=0,K=0;K<T.sfbmax;K++)k<U[K]&&(k=U[K]);var w=A.noise_shaping_amp;switch(w==3&&n(),w){case 2:break;case 1:k>1?k=Math.pow(k,.5):k*=.95;break;case 0:default:k>1?k=1:k*=.95;break}for(var gt=0,K=0;K<T.sfbmax;K++){var B=T.width[K],L;if(gt+=B,!(U[K]<k)){for(A.substep_shaping&2&&n(),T.scalefac[K]++,L=-B;L<0;L++)tt[gt+L]*=z,tt[gt+L]>T.xrpow_max&&(T.xrpow_max=tt[gt+L]);if(A.noise_shaping_amp==2)return}}}function Ot(g,T){for(var U=1.2968395546510096,tt=0,N=0;N<g.sfbmax;N++){var A=g.width[N],z=g.scalefac[N];if(g.preflag!=0&&(z+=ct.pretab[N]),tt+=A,z&1){z++;for(var k=-A;k<0;k++)T[tt+k]*=U,T[tt+k]>g.xrpow_max&&(g.xrpow_max=T[tt+k])}g.scalefac[N]=z>>1}g.preflag=0,g.scalefac_scale=1}function at(g,T,U){var tt,N=T.scalefac;for(tt=0;tt<T.sfb_lmax;tt++)if(N[tt]>=16)return!0;for(var A=0;A<3;A++){var z=0,k=0;for(tt=T.sfb_lmax+A;tt<T.sfbdivide;tt+=3)z<N[tt]&&(z=N[tt]);for(;tt<T.sfbmax;tt+=3)k<N[tt]&&(k=N[tt]);if(!(z<16&&k<8)){if(T.subblock_gain[A]>=7)return!0;T.subblock_gain[A]++;var K=g.scalefac_band.l[T.sfb_lmax];for(tt=T.sfb_lmax+A;tt<T.sfbmax;tt+=3){var w,gt=T.width[tt],B=N[tt];if(B=B-(4>>T.scalefac_scale),B>=0){N[tt]=B,K+=gt*3;continue}N[tt]=0;{var L=210+(B<<T.scalefac_scale+1);w=ct.IPOW20(L)}K+=gt*(A+1);for(var H=-gt;H<0;H++)U[K+H]*=w,U[K+H]>T.xrpow_max&&(T.xrpow_max=U[K+H]);K+=gt*(3-A-1)}{var w=ct.IPOW20(202);K+=T.width[tt]*(A+1);for(var H=-T.width[tt];H<0;H++)U[K+H]*=w,U[K+H]>T.xrpow_max&&(T.xrpow_max=U[K+H])}}}return!1}function rt(g,T,U,tt,N){var A=g.internal_flags;Q(g,T,U,tt);var z=ft(T);return z?!1:(A.mode_gr==2?z=Z.scale_bitcount(T):z=Z.scale_bitcount_lsf(A,T),z?(A.noise_shaping>1&&(p.fill(A.pseudohalf,0),T.scalefac_scale==0?(Ot(T,tt),z=!1):T.block_type==_.SHORT_TYPE&&A.subblock_gain>0&&(z=at(A,T,tt)||ft(T))),z||(A.mode_gr==2?z=Z.scale_bitcount(T):z=Z.scale_bitcount_lsf(A,T)),!z):!0)}this.outer_loop=function(g,T,U,tt,N,A){var z=g.internal_flags,k=new Mt,K=o(576),w=o(lt.SFBMAX),gt=new J,B,L=new Rt,H=9999999,q=!1,ut=!1,x=0;if(At(z,T,A,N,tt),z.noise_shaping==0)return 100;ct.calc_noise(T,U,w,gt,L),gt.bits=T.part2_3_length,k.assign(T);var E=0;for(v.arraycopy(tt,0,K,0,576);!q;){do{var St=new J,dt,xt=255;if(z.substep_shaping&2?dt=20:dt=3,z.sfb21_extra&&n(),!rt(g,k,w,tt))break;k.scalefac_scale!=0&&(xt=254);var Ft=A-k.part2_length;if(Ft<=0)break;for(;(k.part2_3_length=Z.count_bits(z,tt,k,L))>Ft&&k.global_gain<=xt;)k.global_gain++;if(k.global_gain>xt)break;if(gt.over_count==0){for(;(k.part2_3_length=Z.count_bits(z,tt,k,L))>H&&k.global_gain<=xt;)k.global_gain++;if(k.global_gain>xt)break}if(ct.calc_noise(k,U,w,St,L),St.bits=k.part2_3_length,T.block_type!=_.SHORT_TYPE?B=g.quant_comp:B=g.quant_comp_short,B=kt(B,gt,St)?1:0,B!=0)H=T.part2_3_length,gt=St,T.assign(k),E=0,v.arraycopy(tt,0,K,0,576);else if(z.full_outer_loop==0&&(++E>dt&&gt.over_count==0||z.noise_shaping_amp==3&&ut&&E>30||z.noise_shaping_amp==3&&ut&&k.global_gain-x>15))break}while(k.global_gain+k.scalefac_scale<255);z.noise_shaping_amp==3?n():q=!0}return g.VBR==y.vbr_rh||g.VBR==y.vbr_mtrh?v.arraycopy(K,0,tt,0,576):z.substep_shaping&1&&n(),gt.over_count},this.iteration_finish_one=function(g,T,U){var tt=g.l3_side,N=tt.tt[T][U];Z.best_scalefac_store(g,T,U,tt),g.use_best_huffman==1&&Z.best_huffman_divide(g,N),$.ResvAdjust(g,N)}}function O(){var $=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*h.SQRT2*.5/2384e-9,.017876148*h.SQRT2*.5/2384e-9,.003134727*h.SQRT2*.5/2384e-9,.002457142*h.SQRT2*.5/2384e-9,971317e-9*h.SQRT2*.5/2384e-9,218868e-9*h.SQRT2*.5/2384e-9,101566e-9*h.SQRT2*.5/2384e-9,13828e-9*h.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],ct=12,ht=36,Z=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],Lt=Z[_.SHORT_TYPE],j=Z[_.SHORT_TYPE],nt=Z[_.SHORT_TYPE],At=Z[_.SHORT_TYPE],ft=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function kt(at,rt,g){for(var T=10,U=rt+238-14-286,tt=-15;tt<0;tt++){var N,A,z;N=$[T+-10],A=at[U+-224]*N,z=at[rt+224]*N,N=$[T+-9],A+=at[U+-160]*N,z+=at[rt+160]*N,N=$[T+-8],A+=at[U+-96]*N,z+=at[rt+96]*N,N=$[T+-7],A+=at[U+-32]*N,z+=at[rt+32]*N,N=$[T+-6],A+=at[U+32]*N,z+=at[rt+-32]*N,N=$[T+-5],A+=at[U+96]*N,z+=at[rt+-96]*N,N=$[T+-4],A+=at[U+160]*N,z+=at[rt+-160]*N,N=$[T+-3],A+=at[U+224]*N,z+=at[rt+-224]*N,N=$[T+-2],A+=at[rt+-256]*N,z-=at[U+256]*N,N=$[T+-1],A+=at[rt+-192]*N,z-=at[U+192]*N,N=$[T+0],A+=at[rt+-128]*N,z-=at[U+128]*N,N=$[T+1],A+=at[rt+-64]*N,z-=at[U+64]*N,N=$[T+2],A+=at[rt+0]*N,z-=at[U+0]*N,N=$[T+3],A+=at[rt+64]*N,z-=at[U+-64]*N,N=$[T+4],A+=at[rt+128]*N,z-=at[U+-128]*N,N=$[T+5],A+=at[rt+192]*N,z-=at[U+-192]*N,A*=$[T+6],N=z-A,g[30+tt*2]=z+A,g[31+tt*2]=$[T+7]*N,T+=18,rt--,U++}{var A,z,k,K;z=at[rt+-16]*$[T+-10],A=at[rt+-32]*$[T+-2],z+=(at[rt+-48]-at[rt+16])*$[T+-9],A+=at[rt+-96]*$[T+-1],z+=(at[rt+-80]+at[rt+48])*$[T+-8],A+=at[rt+-160]*$[T+0],z+=(at[rt+-112]-at[rt+80])*$[T+-7],A+=at[rt+-224]*$[T+1],z+=(at[rt+-144]+at[rt+112])*$[T+-6],A-=at[rt+32]*$[T+2],z+=(at[rt+-176]-at[rt+144])*$[T+-5],A-=at[rt+96]*$[T+3],z+=(at[rt+-208]+at[rt+176])*$[T+-4],A-=at[rt+160]*$[T+4],z+=(at[rt+-240]-at[rt+208])*$[T+-3],A-=at[rt+224],k=A-z,K=A+z,z=g[14],A=g[15]-z,g[31]=K+z,g[30]=k+A,g[15]=k-A,g[14]=K-z}{var w;w=g[28]-g[0],g[0]+=g[28],g[28]=w*$[T+-2*18+7],w=g[29]-g[1],g[1]+=g[29],g[29]=w*$[T+-2*18+7],w=g[26]-g[2],g[2]+=g[26],g[26]=w*$[T+-4*18+7],w=g[27]-g[3],g[3]+=g[27],g[27]=w*$[T+-4*18+7],w=g[24]-g[4],g[4]+=g[24],g[24]=w*$[T+-6*18+7],w=g[25]-g[5],g[5]+=g[25],g[25]=w*$[T+-6*18+7],w=g[22]-g[6],g[6]+=g[22],g[22]=w*h.SQRT2,w=g[23]-g[7],g[7]+=g[23],g[23]=w*h.SQRT2-g[7],g[7]-=g[6],g[22]-=g[7],g[23]-=g[22],w=g[6],g[6]=g[31]-w,g[31]=g[31]+w,w=g[7],g[7]=g[30]-w,g[30]=g[30]+w,w=g[22],g[22]=g[15]-w,g[15]=g[15]+w,w=g[23],g[23]=g[14]-w,g[14]=g[14]+w,w=g[20]-g[8],g[8]+=g[20],g[20]=w*$[T+-10*18+7],w=g[21]-g[9],g[9]+=g[21],g[21]=w*$[T+-10*18+7],w=g[18]-g[10],g[10]+=g[18],g[18]=w*$[T+-12*18+7],w=g[19]-g[11],g[11]+=g[19],g[19]=w*$[T+-12*18+7],w=g[16]-g[12],g[12]+=g[16],g[16]=w*$[T+-14*18+7],w=g[17]-g[13],g[13]+=g[17],g[17]=w*$[T+-14*18+7],w=-g[20]+g[24],g[20]+=g[24],g[24]=w*$[T+-12*18+7],w=-g[21]+g[25],g[21]+=g[25],g[25]=w*$[T+-12*18+7],w=g[4]-g[8],g[4]+=g[8],g[8]=w*$[T+-12*18+7],w=g[5]-g[9],g[5]+=g[9],g[9]=w*$[T+-12*18+7],w=g[0]-g[12],g[0]+=g[12],g[12]=w*$[T+-4*18+7],w=g[1]-g[13],g[1]+=g[13],g[13]=w*$[T+-4*18+7],w=g[16]-g[28],g[16]+=g[28],g[28]=w*$[T+-4*18+7],w=-g[17]+g[29],g[17]+=g[29],g[29]=w*$[T+-4*18+7],w=h.SQRT2*(g[2]-g[10]),g[2]+=g[10],g[10]=w,w=h.SQRT2*(g[3]-g[11]),g[3]+=g[11],g[11]=w,w=h.SQRT2*(-g[18]+g[26]),g[18]+=g[26],g[26]=w-g[18],w=h.SQRT2*(-g[19]+g[27]),g[19]+=g[27],g[27]=w-g[19],w=g[2],g[19]-=g[3],g[3]-=w,g[2]=g[31]-w,g[31]+=w,w=g[3],g[11]-=g[19],g[18]-=w,g[3]=g[30]-w,g[30]+=w,w=g[18],g[27]-=g[11],g[19]-=w,g[18]=g[15]-w,g[15]+=w,w=g[19],g[10]-=w,g[19]=g[14]-w,g[14]+=w,w=g[10],g[11]-=w,g[10]=g[23]-w,g[23]+=w,w=g[11],g[26]-=w,g[11]=g[22]-w,g[22]+=w,w=g[26],g[27]-=w,g[26]=g[7]-w,g[7]+=w,w=g[27],g[27]=g[6]-w,g[6]+=w,w=h.SQRT2*(g[0]-g[4]),g[0]+=g[4],g[4]=w,w=h.SQRT2*(g[1]-g[5]),g[1]+=g[5],g[5]=w,w=h.SQRT2*(g[16]-g[20]),g[16]+=g[20],g[20]=w,w=h.SQRT2*(g[17]-g[21]),g[17]+=g[21],g[21]=w,w=-h.SQRT2*(g[8]-g[12]),g[8]+=g[12],g[12]=w-g[8],w=-h.SQRT2*(g[9]-g[13]),g[9]+=g[13],g[13]=w-g[9],w=-h.SQRT2*(g[25]-g[29]),g[25]+=g[29],g[29]=w-g[25],w=-h.SQRT2*(g[24]+g[28]),g[24]-=g[28],g[28]=w-g[24],w=g[24]-g[16],g[24]=w,w=g[20]-w,g[20]=w,w=g[28]-w,g[28]=w,w=g[25]-g[17],g[25]=w,w=g[21]-w,g[21]=w,w=g[29]-w,g[29]=w,w=g[17]-g[1],g[17]=w,w=g[9]-w,g[9]=w,w=g[25]-w,g[25]=w,w=g[5]-w,g[5]=w,w=g[21]-w,g[21]=w,w=g[13]-w,g[13]=w,w=g[29]-w,g[29]=w,w=g[1]-g[0],g[1]=w,w=g[16]-w,g[16]=w,w=g[17]-w,g[17]=w,w=g[8]-w,g[8]=w,w=g[9]-w,g[9]=w,w=g[24]-w,g[24]=w,w=g[25]-w,g[25]=w,w=g[4]-w,g[4]=w,w=g[5]-w,g[5]=w,w=g[20]-w,g[20]=w,w=g[21]-w,g[21]=w,w=g[12]-w,g[12]=w,w=g[13]-w,g[13]=w,w=g[28]-w,g[28]=w,w=g[29]-w,g[29]=w,w=g[0],g[0]+=g[31],g[31]-=w,w=g[1],g[1]+=g[30],g[30]-=w,w=g[16],g[16]+=g[15],g[15]-=w,w=g[17],g[17]+=g[14],g[14]-=w,w=g[8],g[8]+=g[23],g[23]-=w,w=g[9],g[9]+=g[22],g[22]-=w,w=g[24],g[24]+=g[7],g[7]-=w,w=g[25],g[25]+=g[6],g[6]-=w,w=g[4],g[4]+=g[27],g[27]-=w,w=g[5],g[5]+=g[26],g[26]-=w,w=g[20],g[20]+=g[11],g[11]-=w,w=g[21],g[21]+=g[10],g[10]-=w,w=g[12],g[12]+=g[19],g[19]-=w,w=g[13],g[13]+=g[18],g[18]-=w,w=g[28],g[28]+=g[3],g[3]-=w,w=g[29],g[29]+=g[2],g[2]-=w}}function Q(at,rt){for(var g=0;g<3;g++){var T,U,tt,N,A,z;N=at[rt+2*3]*Z[_.SHORT_TYPE][0]-at[rt+5*3],T=at[rt+0*3]*Z[_.SHORT_TYPE][2]-at[rt+3*3],U=N+T,tt=N-T,N=at[rt+5*3]*Z[_.SHORT_TYPE][0]+at[rt+2*3],T=at[rt+3*3]*Z[_.SHORT_TYPE][2]+at[rt+0*3],A=N+T,z=-N+T,T=(at[rt+1*3]*Z[_.SHORT_TYPE][1]-at[rt+4*3])*2069978111953089e-26,N=(at[rt+4*3]*Z[_.SHORT_TYPE][1]+at[rt+1*3])*2069978111953089e-26,at[rt+3*0]=U*190752519173728e-25+T,at[rt+3*5]=-A*190752519173728e-25+N,tt=tt*.8660254037844387*1907525191737281e-26,A=A*.5*1907525191737281e-26+N,at[rt+3*1]=tt-A,at[rt+3*2]=tt+A,U=U*.5*1907525191737281e-26-T,z=z*.8660254037844387*1907525191737281e-26,at[rt+3*3]=U+z,at[rt+3*4]=U-z,rt++}}function Ot(at,rt,g){var T,U;{var tt,N,A,z,k,K,w,gt;tt=g[17]-g[9],A=g[15]-g[11],z=g[14]-g[12],k=g[0]+g[8],K=g[1]+g[7],w=g[2]+g[6],gt=g[3]+g[5],at[rt+17]=k+w-gt-(K-g[4]),U=(k+w-gt)*j[19]+(K-g[4]),T=(tt-A-z)*j[18],at[rt+5]=T+U,at[rt+6]=T-U,N=(g[16]-g[10])*j[18],K=K*j[19]+g[4],T=tt*j[12]+N+A*j[13]+z*j[14],U=-k*j[16]+K-w*j[17]+gt*j[15],at[rt+1]=T+U,at[rt+2]=T-U,T=tt*j[13]-N-A*j[14]+z*j[12],U=-k*j[17]+K-w*j[15]+gt*j[16],at[rt+9]=T+U,at[rt+10]=T-U,T=tt*j[14]-N+A*j[12]-z*j[13],U=k*j[15]-K+w*j[16]-gt*j[17],at[rt+13]=T+U,at[rt+14]=T-U}{var B,L,H,q,ut,x,E,St;B=g[8]-g[0],H=g[6]-g[2],q=g[5]-g[3],ut=g[17]+g[9],x=g[16]+g[10],E=g[15]+g[11],St=g[14]+g[12],at[rt+0]=ut+E+St+(x+g[13]),T=(ut+E+St)*j[19]-(x+g[13]),U=(B-H+q)*j[18],at[rt+11]=T+U,at[rt+12]=T-U,L=(g[7]-g[1])*j[18],x=g[13]-x*j[19],T=ut*j[15]-x+E*j[16]+St*j[17],U=B*j[14]+L+H*j[12]+q*j[13],at[rt+3]=T+U,at[rt+4]=T-U,T=-ut*j[17]+x-E*j[15]-St*j[16],U=B*j[13]+L-H*j[14]-q*j[12],at[rt+7]=T+U,at[rt+8]=T-U,T=-ut*j[16]+x-E*j[17]-St*j[15],U=B*j[12]-L+H*j[13]-q*j[14],at[rt+15]=T+U,at[rt+16]=T-U}}this.mdct_sub48=function(at,rt,g){for(var T=rt,U=286,tt=0;tt<at.channels_out;tt++){for(var N=0;N<at.mode_gr;N++){for(var A,z=at.l3_side.tt[N][tt],k=z.xr,K=0,w=at.sb_sample[tt][1-N],gt=0,B=0;B<18/2;B++)for(kt(T,U,w[gt]),kt(T,U+32,w[gt+1]),gt+=2,U+=64,A=1;A<32;A+=2)w[gt-1][A]*=-1;for(A=0;A<32;A++,K+=18){var L=z.block_type,H=at.sb_sample[tt][N],q=at.sb_sample[tt][1-N];if(z.mixed_block_flag!=0&&A<2&&(L=0),at.amp_filter[A]<1e-12)p.fill(k,K+0,K+18,0);else if(at.amp_filter[A]<1&&n(),L==_.SHORT_TYPE){for(var B=-ct/4;B<0;B++){var ut=Z[_.SHORT_TYPE][B+3];k[K+B*3+9]=H[9+B][ft[A]]*ut-H[8-B][ft[A]],k[K+B*3+18]=H[14-B][ft[A]]*ut+H[15+B][ft[A]],k[K+B*3+10]=H[15+B][ft[A]]*ut-H[14-B][ft[A]],k[K+B*3+19]=q[2-B][ft[A]]*ut+q[3+B][ft[A]],k[K+B*3+11]=q[3+B][ft[A]]*ut-q[2-B][ft[A]],k[K+B*3+20]=q[8-B][ft[A]]*ut+q[9+B][ft[A]]}Q(k,K)}else{for(var x=o(18),B=-ht/4;B<0;B++){var E,St;E=Z[L][B+27]*q[B+9][ft[A]]+Z[L][B+36]*q[8-B][ft[A]],St=Z[L][B+9]*H[B+9][ft[A]]-Z[L][B+18]*H[8-B][ft[A]],x[B+9]=E-St*Lt[3+B+9],x[B+18]=E*Lt[3+B+9]+St}Ot(k,K,x)}if(L!=_.SHORT_TYPE&&A!=0)for(var B=7;B>=0;--B){var dt,xt;dt=k[K+B]*nt[20+B]+k[K+-1-B]*At[28+B],xt=k[K+B]*At[28+B]-k[K+-1-B]*nt[20+B],k[K+-1-B]=dt,k[K+B]=xt}}}if(T=g,U=286,at.mode_gr==1)for(var Ft=0;Ft<18;Ft++)v.arraycopy(at.sb_sample[tt][1][Ft],0,at.sb_sample[tt][0][Ft],0,32)}}}function V(){this.thm=new _t,this.en=new _t}_.ENCDELAY=576,_.POSTDELAY=1152,_.MDCTDELAY=48,_.FFTOFFSET=224+_.MDCTDELAY,_.DECDELAY=528,_.SBLIMIT=32,_.CBANDS=64,_.SBPSY_l=21,_.SBPSY_s=12,_.SBMAX_l=22,_.SBMAX_s=13,_.PSFB21=6,_.PSFB12=6,_.BLKSIZE=1024,_.HBLKSIZE=_.BLKSIZE/2+1,_.BLKSIZE_s=256,_.HBLKSIZE_s=_.BLKSIZE_s/2+1,_.NORM_TYPE=0,_.START_TYPE=1,_.SHORT_TYPE=2,_.STOP_TYPE=3,_.MPG_MD_LR_LR=0,_.MPG_MD_LR_I=1,_.MPG_MD_MS_LR=2,_.MPG_MD_MS_I=3,_.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function _(){var $=_.MPG_MD_MS_LR,ct=null;this.psy=null;var ht=null,Z=null;this.setModules=function(ft,kt,Q,Ot){ct=ft,this.psy=kt,ht=kt,Z=Ot};var Lt=new O;function j(ft){var kt,Q;if(ft.ATH.useAdjust==0){ft.ATH.adjust=1;return}if(Q=ft.loudness_sq[0][0],kt=ft.loudness_sq[1][0],ft.channels_out==2?n():(Q+=Q,kt+=kt),ft.mode_gr==2&&(Q=Math.max(Q,kt)),Q*=.5,Q*=ft.ATH.aaSensitivityP,Q>.03125)ft.ATH.adjust>=1?ft.ATH.adjust=1:ft.ATH.adjust<ft.ATH.adjustLimit&&(ft.ATH.adjust=ft.ATH.adjustLimit),ft.ATH.adjustLimit=1;else{var Ot=31.98*Q+625e-6;ft.ATH.adjust>=Ot?(ft.ATH.adjust*=Ot*.075+.925,ft.ATH.adjust<Ot&&(ft.ATH.adjust=Ot)):ft.ATH.adjustLimit>=Ot?ft.ATH.adjust=Ot:ft.ATH.adjust<ft.ATH.adjustLimit&&(ft.ATH.adjust=ft.ATH.adjustLimit),ft.ATH.adjustLimit=Ot}}function nt(ft){var kt,Q;for(ft.bitrate_stereoMode_Hist[ft.bitrate_index][4]++,ft.bitrate_stereoMode_Hist[15][4]++,ft.channels_out==2&&n(),kt=0;kt<ft.mode_gr;++kt)for(Q=0;Q<ft.channels_out;++Q){var Ot=ft.l3_side.tt[kt][Q].block_type|0;ft.l3_side.tt[kt][Q].mixed_block_flag!=0&&(Ot=4),ft.bitrate_blockType_Hist[ft.bitrate_index][Ot]++,ft.bitrate_blockType_Hist[ft.bitrate_index][5]++,ft.bitrate_blockType_Hist[15][Ot]++,ft.bitrate_blockType_Hist[15][5]++}}function At(ft,kt){var Q=ft.internal_flags,Ot,at;if(Q.lame_encode_frame_init==0){var rt,g,T=o(2014),U=o(2014);for(Q.lame_encode_frame_init=1,rt=0,g=0;rt<286+576*(1+Q.mode_gr);++rt)rt<576*Q.mode_gr?(T[rt]=0,Q.channels_out==2&&(U[rt]=0)):(T[rt]=kt[0][g],Q.channels_out==2&&(U[rt]=kt[1][g]),++g);for(at=0;at<Q.mode_gr;at++)for(Ot=0;Ot<Q.channels_out;Ot++)Q.l3_side.tt[at][Ot].block_type=_.SHORT_TYPE;Lt.mdct_sub48(Q,T,U)}}this.lame_encode_mp3_frame=function(ft,kt,Q,Ot,at,rt){var g,T=d([2,2]);T[0][0]=new V,T[0][1]=new V,T[1][0]=new V,T[1][1]=new V;var U=d([2,2]);U[0][0]=new V,U[0][1]=new V,U[1][0]=new V,U[1][1]=new V;var tt,N=[null,null],A=ft.internal_flags,z=u([2,4]),k=[.5,.5],K=[[0,0],[0,0]],w=[[0,0],[0,0]],gt,B,L;if(N[0]=kt,N[1]=Q,A.lame_encode_frame_init==0&&At(ft,N),A.padding=0,(A.slot_lag-=A.frac_SpF)<0&&(A.slot_lag+=ft.out_samplerate,A.padding=1),A.psymodel!=0){var H,q=[null,null],ut=0,x=s(2);for(L=0;L<A.mode_gr;L++){for(B=0;B<A.channels_out;B++)q[B]=N[B],ut=576+L*576-_.FFTOFFSET;if(ft.VBR==y.vbr_mtrh||ft.VBR==y.vbr_mt?n():H=ht.L3psycho_anal_ns(ft,q,ut,L,T,U,K[L],w[L],z[L],x),H!=0)return-4;for(ft.mode==S.JOINT_STEREO&&n(),B=0;B<A.channels_out;B++){var E=A.l3_side.tt[L][B];E.block_type=x[B],E.mixed_block_flag=0}}}else n();if(j(A),Lt.mdct_sub48(A,N[0],N[1]),A.mode_ext=_.MPG_MD_LR_LR,ft.force_ms?A.mode_ext=_.MPG_MD_MS_LR:ft.mode==S.JOINT_STEREO&&n(),A.mode_ext==$?(tt=U,gt=w):(tt=T,gt=K),ft.analysis&&A.pinfo!=null&&n(),ft.VBR==y.vbr_off||ft.VBR==y.vbr_abr){var St,dt;for(St=0;St<18;St++)A.nsPsy.pefirbuf[St]=A.nsPsy.pefirbuf[St+1];for(dt=0,L=0;L<A.mode_gr;L++)for(B=0;B<A.channels_out;B++)dt+=gt[L][B];for(A.nsPsy.pefirbuf[18]=dt,dt=A.nsPsy.pefirbuf[9],St=0;St<9;St++)dt+=(A.nsPsy.pefirbuf[St]+A.nsPsy.pefirbuf[18-St])*_.fircoef[St];for(dt=670*5*A.mode_gr*A.channels_out/dt,L=0;L<A.mode_gr;L++)for(B=0;B<A.channels_out;B++)gt[L][B]*=dt}return A.iteration_loop.iteration_loop(ft,gt,k,tt),ct.format_bitstream(ft),g=ct.copy_buffer(A,Ot,at,rt,1),ft.bWriteVbrTag&&Z.addVbrFrame(ft),ft.analysis&&A.pinfo!=null&&n(),nt(A),g}}function Y(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function ot(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[s(4),s(4)];for(var $=0;$<2;$++)for(var ct=0;ct<2;ct++)this.tt[$][ct]=new Mt}function _t(){this.l=o(_.SBMAX_l),this.s=u([_.SBMAX_s,3]);var $=this;this.assign=function(ct){v.arraycopy(ct.l,0,$.l,0,_.SBMAX_l);for(var ht=0;ht<_.SBMAX_s;ht++)for(var Z=0;Z<3;Z++)$.s[ht][Z]=ct.s[ht][Z]}}function Ct(){this.last_en_subshort=u([4,9]),this.lastAttacks=s(4),this.pefirbuf=o(19),this.longfact=o(_.SBMAX_l),this.shortfact=o(_.SBMAX_s),this.attackthre=0,this.attackthre_s=0}Vt.MFSIZE=3*1152+_.ENCDELAY-_.MDCTDELAY,Vt.MAX_HEADER_BUF=256,Vt.MAX_BITS_PER_CHANNEL=4095,Vt.MAX_BITS_PER_GRANULE=7680,Vt.BPC=320;function Vt(){var $=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=u([2,Vt.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new ot,this.ms_ratio=o(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=s(2),this.CurrentStep=s(2),this.masking_lower=0,this.bv_scf=s(576),this.pseudohalf=s(lt.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*Vt.BPC+1),this.itime=l(2),this.sideinfo_len=0,this.sb_sample=u([2,2,18,_.SBLIMIT]),this.amp_filter=o(32);function ct(){this.write_timing=0,this.ptr=0,this.buf=a($)}this.header=new Array(Vt.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new yt,this.minval_l=o(_.CBANDS),this.minval_s=o(_.CBANDS),this.nb_1=u([4,_.CBANDS]),this.nb_2=u([4,_.CBANDS]),this.nb_s1=u([4,_.CBANDS]),this.nb_s2=u([4,_.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=o(4),this.loudness_sq=u([2,2]),this.loudness_sq_save=o(2),this.mld_l=o(_.SBMAX_l),this.mld_s=o(_.SBMAX_s),this.bm_l=s(_.SBMAX_l),this.bo_l=s(_.SBMAX_l),this.bm_s=s(_.SBMAX_s),this.bo_s=s(_.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=c([_.CBANDS,2]),this.s3ind_s=c([_.CBANDS,2]),this.numlines_s=s(_.CBANDS),this.numlines_l=s(_.CBANDS),this.rnumlines_l=o(_.CBANDS),this.mld_cb_l=o(_.CBANDS),this.mld_cb_s=o(_.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=o(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=s(2),this.nsPsy=new Ct,this.VBR_seek_table=new Y,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=c([16,5]),this.bitrate_blockType_Hist=c([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var ht=0;ht<this.en.length;ht++)this.en[ht]=new _t;for(var ht=0;ht<this.thm.length;ht++)this.thm[ht]=new _t;for(var ht=0;ht<this.header.length;ht++)this.header[ht]=new ct}function jt(){var $=o(_.BLKSIZE),ct=o(_.BLKSIZE_s/2),ht=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function Z(j,nt,At){var ft=0,kt,Q,Ot;At<<=1;var at=nt+At;kt=4;do{var rt,g,T,U,tt,N,A;A=kt>>1,U=kt,tt=kt<<1,N=tt+U,kt=tt<<1,Q=nt,Ot=Q+A;do{var z,k,K,w;k=j[Q+0]-j[Q+U],z=j[Q+0]+j[Q+U],w=j[Q+tt]-j[Q+N],K=j[Q+tt]+j[Q+N],j[Q+tt]=z-K,j[Q+0]=z+K,j[Q+N]=k-w,j[Q+U]=k+w,k=j[Ot+0]-j[Ot+U],z=j[Ot+0]+j[Ot+U],w=h.SQRT2*j[Ot+N],K=h.SQRT2*j[Ot+tt],j[Ot+tt]=z-K,j[Ot+0]=z+K,j[Ot+N]=k-w,j[Ot+U]=k+w,Ot+=kt,Q+=kt}while(Q<at);for(g=ht[ft+0],rt=ht[ft+1],T=1;T<A;T++){var gt,B;gt=1-2*rt*rt,B=2*rt*g,Q=nt+T,Ot=nt+U-T;do{var L,H,q,z,k,ut,K,x,w,E;H=B*j[Q+U]-gt*j[Ot+U],L=gt*j[Q+U]+B*j[Ot+U],k=j[Q+0]-L,z=j[Q+0]+L,ut=j[Ot+0]-H,q=j[Ot+0]+H,H=B*j[Q+N]-gt*j[Ot+N],L=gt*j[Q+N]+B*j[Ot+N],w=j[Q+tt]-L,K=j[Q+tt]+L,E=j[Ot+tt]-H,x=j[Ot+tt]+H,H=rt*K-g*E,L=g*K+rt*E,j[Q+tt]=z-L,j[Q+0]=z+L,j[Ot+N]=ut-H,j[Ot+U]=ut+H,H=g*x-rt*w,L=rt*x+g*w,j[Ot+tt]=q-L,j[Ot+0]=q+L,j[Q+N]=k-H,j[Q+U]=k+H,Ot+=kt,Q+=kt}while(Q<at);gt=g,g=gt*ht[ft+0]-rt*ht[ft+1],rt=gt*ht[ft+1]+rt*ht[ft+0]}ft+=2}while(kt<At)}var Lt=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(j,nt,At,ft,kt){for(var Q=0;Q<3;Q++){var Ot=_.BLKSIZE_s/2,at=65535&576/3*(Q+1),rt=_.BLKSIZE_s/8-1;do{var g,T,U,tt,N,A=Lt[rt<<2]&255;g=ct[A]*ft[At][kt+A+at],N=ct[127-A]*ft[At][kt+A+at+128],T=g-N,g=g+N,U=ct[A+64]*ft[At][kt+A+at+64],N=ct[63-A]*ft[At][kt+A+at+192],tt=U-N,U=U+N,Ot-=4,nt[Q][Ot+0]=g+U,nt[Q][Ot+2]=g-U,nt[Q][Ot+1]=T+tt,nt[Q][Ot+3]=T-tt,g=ct[A+1]*ft[At][kt+A+at+1],N=ct[126-A]*ft[At][kt+A+at+129],T=g-N,g=g+N,U=ct[A+65]*ft[At][kt+A+at+65],N=ct[62-A]*ft[At][kt+A+at+193],tt=U-N,U=U+N,nt[Q][Ot+_.BLKSIZE_s/2+0]=g+U,nt[Q][Ot+_.BLKSIZE_s/2+2]=g-U,nt[Q][Ot+_.BLKSIZE_s/2+1]=T+tt,nt[Q][Ot+_.BLKSIZE_s/2+3]=T-tt}while(--rt>=0);Z(nt[Q],Ot,_.BLKSIZE_s/2)}},this.fft_long=function(j,nt,At,ft,kt){var Q=_.BLKSIZE/8-1,Ot=_.BLKSIZE/2;do{var at,rt,g,T,U,tt=Lt[Q]&255;at=$[tt]*ft[At][kt+tt],U=$[tt+512]*ft[At][kt+tt+512],rt=at-U,at=at+U,g=$[tt+256]*ft[At][kt+tt+256],U=$[tt+768]*ft[At][kt+tt+768],T=g-U,g=g+U,Ot-=4,nt[Ot+0]=at+g,nt[Ot+2]=at-g,nt[Ot+1]=rt+T,nt[Ot+3]=rt-T,at=$[tt+1]*ft[At][kt+tt+1],U=$[tt+513]*ft[At][kt+tt+513],rt=at-U,at=at+U,g=$[tt+257]*ft[At][kt+tt+257],U=$[tt+769]*ft[At][kt+tt+769],T=g-U,g=g+U,nt[Ot+_.BLKSIZE/2+0]=at+g,nt[Ot+_.BLKSIZE/2+2]=at-g,nt[Ot+_.BLKSIZE/2+1]=rt+T,nt[Ot+_.BLKSIZE/2+3]=rt-T}while(--Q>=0);Z(nt,Ot,_.BLKSIZE/2)},this.init_fft=function(j){for(var nt=0;nt<_.BLKSIZE;nt++)$[nt]=.42-.5*Math.cos(2*Math.PI*(nt+.5)/_.BLKSIZE)+.08*Math.cos(4*Math.PI*(nt+.5)/_.BLKSIZE);for(var nt=0;nt<_.BLKSIZE_s/2;nt++)ct[nt]=.5*(1-Math.cos(2*Math.PI*(nt+.5)/_.BLKSIZE_s))}}function Gt(){var $=new jt,ct=2.302585092994046,ht=2,Z=16,Lt=2,j=16,nt=.34,At=1/(14752*14752)/(_.BLKSIZE/2),ft=.01,kt=.8,Q=.6,Ot=.3,at=3.5,rt=21,g=.2302585093;function T(Et,vt){for(var wt=0,Jt=0;Jt<_.BLKSIZE/2;++Jt)wt+=Et[Jt]*vt.ATH.eql_w[Jt];return wt*=At,wt}function U(Et,vt,wt,Jt,Zt,$t,qt,Kt,ee,be,re){var Pe=Et.internal_flags;ee<2?($.fft_long(Pe,Jt[Zt],ee,be,re),$.fft_short(Pe,$t[qt],ee,be,re)):ee==2&&n(),vt[0]=Jt[Zt+0][0],vt[0]*=vt[0];for(var ke=_.BLKSIZE/2-1;ke>=0;--ke){var Ie=Jt[Zt+0][_.BLKSIZE/2-ke],Ve=Jt[Zt+0][_.BLKSIZE/2+ke];vt[_.BLKSIZE/2-ke]=(Ie*Ie+Ve*Ve)*.5}for(var Re=2;Re>=0;--Re){wt[Re][0]=$t[qt+0][Re][0],wt[Re][0]*=wt[Re][0];for(var ke=_.BLKSIZE_s/2-1;ke>=0;--ke){var Ie=$t[qt+0][Re][_.BLKSIZE_s/2-ke],Ve=$t[qt+0][Re][_.BLKSIZE_s/2+ke];wt[Re][_.BLKSIZE_s/2-ke]=(Ie*Ie+Ve*Ve)*.5}}{for(var he=0,ke=11;ke<_.HBLKSIZE;ke++)he+=vt[ke];Pe.tot_ener[ee]=he}Et.analysis&&n(),Et.athaa_loudapprox==2&&ee<2&&(Pe.loudness_sq[Kt][ee]=Pe.loudness_sq_save[ee],Pe.loudness_sq_save[ee]=T(vt,Pe))}var tt=8,N=23,A=15,z,k,K,w=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function gt(){z=Math.pow(10,(tt+1)/16),k=Math.pow(10,(N+1)/16),K=Math.pow(10,A/10)}var B=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],L=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],H=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function q(Et,vt,wt,Jt,Zt,$t){var qt;if(vt>Et)if(vt<Et*k)qt=vt/Et;else return Et+vt;else{if(Et>=vt*k)return Et+vt;qt=Et/vt}if(Et+=vt,Jt+3<=6){if(qt>=z)return Et;var Kt=0|h.FAST_LOG10_X(qt,16);return Et*L[Kt]}var Kt=0|h.FAST_LOG10_X(qt,16);if(vt=Zt.ATH.cb_l[wt]*Zt.ATH.adjust,Et<K*vt){if(Et>vt){var ee,be;return ee=1,Kt<=13&&(ee=H[Kt]),be=h.FAST_LOG10_X(Et/vt,10/15),Et*((B[Kt]-ee)*be+ee)}return Kt>13?Et:Et*H[Kt]}return Et*B[Kt]}function ut(Et,vt,wt,Jt,Zt){var $t,qt,Kt=0,ee=0;for($t=qt=0;$t<_.SBMAX_s;++qt,++$t){for(var be=Et.bo_s[$t],re=Et.npart_s,Pe=be<re?be:re;qt<Pe;)Kt+=vt[qt],ee+=wt[qt],qt++;if(Et.en[Jt].s[$t][Zt]=Kt,Et.thm[Jt].s[$t][Zt]=ee,qt>=re){++$t;break}{var ke=Et.PSY.bo_s_weight[$t],Ie=1-ke;Kt=ke*vt[qt],ee=ke*wt[qt],Et.en[Jt].s[$t][Zt]+=Kt,Et.thm[Jt].s[$t][Zt]+=ee,Kt=Ie*vt[qt],ee=Ie*wt[qt]}}for(;$t<_.SBMAX_s;++$t)Et.en[Jt].s[$t][Zt]=0,Et.thm[Jt].s[$t][Zt]=0}function x(Et,vt,wt,Jt){var Zt,$t,qt=0,Kt=0;for(Zt=$t=0;Zt<_.SBMAX_l;++$t,++Zt){for(var ee=Et.bo_l[Zt],be=Et.npart_l,re=ee<be?ee:be;$t<re;)qt+=vt[$t],Kt+=wt[$t],$t++;if(Et.en[Jt].l[Zt]=qt,Et.thm[Jt].l[Zt]=Kt,$t>=be){++Zt;break}{var Pe=Et.PSY.bo_l_weight[Zt],ke=1-Pe;qt=Pe*vt[$t],Kt=Pe*wt[$t],Et.en[Jt].l[Zt]+=qt,Et.thm[Jt].l[Zt]+=Kt,qt=ke*vt[$t],Kt=ke*wt[$t]}}for(;Zt<_.SBMAX_l;++Zt)Et.en[Jt].l[Zt]=0,Et.thm[Jt].l[Zt]=0}function E(Et,vt,wt,Jt,Zt,$t){var qt=Et.internal_flags,Kt,ee;for(ee=Kt=0;ee<qt.npart_s;++ee){for(var be=0,re=qt.numlines_s[ee],Pe=0;Pe<re;++Pe,++Kt){var ke=vt[$t][Kt];be+=ke}wt[ee]=be}for(Kt=ee=0;ee<qt.npart_s;ee++){var Ie=qt.s3ind_s[ee][0],Ve=qt.s3_ss[Kt++]*wt[Ie];for(++Ie;Ie<=qt.s3ind_s[ee][1];)Ve+=qt.s3_ss[Kt]*wt[Ie],++Kt,++Ie;{var Re=Lt*qt.nb_s1[Zt][ee];Jt[ee]=Math.min(Ve,Re)}if(qt.blocktype_old[Zt&1]==_.SHORT_TYPE){var Re=j*qt.nb_s2[Zt][ee],he=Jt[ee];Jt[ee]=Math.min(Re,he)}qt.nb_s2[Zt][ee]=qt.nb_s1[Zt][ee],qt.nb_s1[Zt][ee]=Ve}for(;ee<=_.CBANDS;++ee)wt[ee]=0,Jt[ee]=0}function St(Et,vt,wt,Jt){var Zt=Et.internal_flags;Et.short_blocks==m.short_block_coupled&&!(vt[0]!=0&&vt[1]!=0)&&(vt[0]=vt[1]=0);for(var $t=0;$t<Zt.channels_out;$t++)Jt[$t]=_.NORM_TYPE,Et.short_blocks==m.short_block_dispensed&&(vt[$t]=1),Et.short_blocks==m.short_block_forced&&(vt[$t]=0),vt[$t]!=0?Zt.blocktype_old[$t]==_.SHORT_TYPE&&(Jt[$t]=_.STOP_TYPE):(Jt[$t]=_.SHORT_TYPE,Zt.blocktype_old[$t]==_.NORM_TYPE&&(Zt.blocktype_old[$t]=_.START_TYPE),Zt.blocktype_old[$t]==_.STOP_TYPE&&(Zt.blocktype_old[$t]=_.SHORT_TYPE)),wt[$t]=Zt.blocktype_old[$t],Zt.blocktype_old[$t]=Jt[$t]}function dt(Et,vt,wt){return wt>=1?Et:wt<=0?vt:vt>0?Math.pow(Et/vt,wt)*vt:0}var xt=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function Ft(Et,vt){for(var wt=309.07,Jt=0;Jt<_.SBMAX_s-1;Jt++)for(var Zt=0;Zt<3;Zt++){var $t=Et.thm.s[Jt][Zt];if($t>0){var qt=$t*vt,Kt=Et.en.s[Jt][Zt];Kt>qt&&(Kt>qt*1e10?wt+=xt[Jt]*(10*ct):wt+=xt[Jt]*h.FAST_LOG10(Kt/qt))}}return wt}var Wt=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function Yt(Et,vt){for(var wt=281.0575,Jt=0;Jt<_.SBMAX_l-1;Jt++){var Zt=Et.thm.l[Jt];if(Zt>0){var $t=Zt*vt,qt=Et.en.l[Jt];qt>$t&&(qt>$t*1e10?wt+=Wt[Jt]*(10*ct):wt+=Wt[Jt]*h.FAST_LOG10(qt/$t))}}return wt}function oe(Et,vt,wt,Jt,Zt){var $t,qt;for($t=qt=0;$t<Et.npart_l;++$t){var Kt=0,ee=0,be;for(be=0;be<Et.numlines_l[$t];++be,++qt){var re=vt[qt];Kt+=re,ee<re&&(ee=re)}wt[$t]=Kt,Jt[$t]=ee,Zt[$t]=Kt*Et.rnumlines_l[$t]}}function ve(Et,vt,wt,Jt){var Zt=w.length-1,$t=0,qt=wt[$t]+wt[$t+1];if(qt>0){var Kt=vt[$t];Kt<vt[$t+1]&&(Kt=vt[$t+1]),qt=20*(Kt*2-qt)/(qt*(Et.numlines_l[$t]+Et.numlines_l[$t+1]-1));var ee=0|qt;ee>Zt&&(ee=Zt),Jt[$t]=ee}else Jt[$t]=0;for($t=1;$t<Et.npart_l-1;$t++)if(qt=wt[$t-1]+wt[$t]+wt[$t+1],qt>0){var Kt=vt[$t-1];Kt<vt[$t]&&(Kt=vt[$t]),Kt<vt[$t+1]&&(Kt=vt[$t+1]),qt=20*(Kt*3-qt)/(qt*(Et.numlines_l[$t-1]+Et.numlines_l[$t]+Et.numlines_l[$t+1]-1));var ee=0|qt;ee>Zt&&(ee=Zt),Jt[$t]=ee}else Jt[$t]=0;if(qt=wt[$t-1]+wt[$t],qt>0){var Kt=vt[$t-1];Kt<vt[$t]&&(Kt=vt[$t]),qt=20*(Kt*2-qt)/(qt*(Et.numlines_l[$t-1]+Et.numlines_l[$t]-1));var ee=0|qt;ee>Zt&&(ee=Zt),Jt[$t]=ee}else Jt[$t]=0}var ue=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(Et,vt,wt,Jt,Zt,$t,qt,Kt,ee,be){var re=Et.internal_flags,Pe=u([2,_.BLKSIZE]),ke=u([2,3,_.BLKSIZE_s]),Ie=o(_.CBANDS+1),Ve=o(_.CBANDS+1),Re=o(_.CBANDS+2),he=s(2),Be=s(2),ir,ae,Se,ce,Fe,an,yr,Ae,ja=u([2,576]),Er,xn=s(_.CBANDS+2),Nn=s(_.CBANDS+2);for(p.fill(Nn,0),ir=re.channels_out,Et.mode==S.JOINT_STEREO&&(ir=4),Et.VBR==y.vbr_off?Er=re.ResvMax==0?0:re.ResvSize/re.ResvMax*.5:Et.VBR==y.vbr_rh||Et.VBR==y.vbr_mtrh||Et.VBR==y.vbr_mt?Er=.6:Er=1,ae=0;ae<re.channels_out;ae++){var oa=vt[ae],la=wt+576-350-rt+192;for(ce=0;ce<576;ce++){var Ki,Zi;for(Ki=oa[la+ce+10],Zi=0,Fe=0;Fe<(rt-1)/2-1;Fe+=2)Ki+=ue[Fe]*(oa[la+ce+Fe]+oa[la+ce+rt-Fe]),Zi+=ue[Fe+1]*(oa[la+ce+Fe+1]+oa[la+ce+rt-Fe-1]);ja[ae][ce]=Ki+Zi}Zt[Jt][ae].en.assign(re.en[ae]),Zt[Jt][ae].thm.assign(re.thm[ae]),ir>2&&n()}for(ae=0;ae<ir;ae++){var Qo,Jo,Mr=o(12),sn=[0,0,0,0],Qi=o(12),tl=1,el,rl=o(_.CBANDS),nl=o(_.CBANDS),Xe=[0,0,0,0],al=o(_.HBLKSIZE),il=u([3,_.HBLKSIZE_s]);for(ce=0;ce<3;ce++)Mr[ce]=re.nsPsy.last_en_subshort[ae][ce+6],Qi[ce]=Mr[ce]/re.nsPsy.last_en_subshort[ae][ce+4],sn[0]+=Mr[ce];ae==2&&n();{var sl=ja[ae&1],ua=0;for(ce=0;ce<9;ce++){for(var Bc=ua+64,cr=1;ua<Bc;ua++)cr<Math.abs(sl[ua])&&(cr=Math.abs(sl[ua]));re.nsPsy.last_en_subshort[ae][ce]=Mr[ce+3]=cr,sn[1+ce/3]+=cr,cr>Mr[ce+3-2]?cr=cr/Mr[ce+3-2]:Mr[ce+3-2]>cr*10?cr=Mr[ce+3-2]/(cr*10):cr=0,Qi[ce+3]=cr}}for(Et.analysis&&n(),el=ae==3?re.nsPsy.attackthre_s:re.nsPsy.attackthre,ce=0;ce<12;ce++)Xe[ce/3]==0&&Qi[ce]>el&&(Xe[ce/3]=ce%3+1);for(ce=1;ce<4;ce++){var Ji;sn[ce-1]>sn[ce]?Ji=sn[ce-1]/sn[ce]:Ji=sn[ce]/sn[ce-1],Ji<1.7&&(Xe[ce]=0,ce==1&&(Xe[0]=0))}for(Xe[0]!=0&&re.nsPsy.lastAttacks[ae]!=0&&(Xe[0]=0),(re.nsPsy.lastAttacks[ae]==3||Xe[0]+Xe[1]+Xe[2]+Xe[3]!=0)&&(tl=0,Xe[1]!=0&&Xe[0]!=0&&(Xe[1]=0),Xe[2]!=0&&Xe[1]!=0&&(Xe[2]=0),Xe[3]!=0&&Xe[2]!=0&&(Xe[3]=0)),ae<2?Be[ae]=tl:n(),ee[ae]=re.tot_ener[ae],Jo=ke,Qo=Pe,U(Et,al,il,Qo,ae&1,Jo,ae&1,Jt,ae,vt,wt),oe(re,al,Ie,rl,nl),ve(re,rl,nl,xn),Ae=0;Ae<3;Ae++){var ts,Sr;for(E(Et,il,Ve,Re,ae,Ae),ut(re,Ve,Re,ae,Ae),yr=0;yr<_.SBMAX_s;yr++){if(Sr=re.thm[ae].s[yr][Ae],Sr*=kt,Xe[Ae]>=2||Xe[Ae+1]==1){var ca=Ae!=0?Ae-1:2,cr=dt(re.thm[ae].s[yr][ca],Sr,Q*Er);Sr=Math.min(Sr,cr)}if(Xe[Ae]==1){var ca=Ae!=0?Ae-1:2,cr=dt(re.thm[ae].s[yr][ca],Sr,Ot*Er);Sr=Math.min(Sr,cr)}else if(Ae!=0&&Xe[Ae-1]==3||Ae==0&&re.nsPsy.lastAttacks[ae]==3){var ca=Ae!=2?Ae+1:0,cr=dt(re.thm[ae].s[yr][ca],Sr,Ot*Er);Sr=Math.min(Sr,cr)}ts=Mr[Ae*3+3]+Mr[Ae*3+4]+Mr[Ae*3+5],Mr[Ae*3+5]*6<ts&&(Sr*=.5,Mr[Ae*3+4]*6<ts&&(Sr*=.5)),re.thm[ae].s[yr][Ae]=Sr}}for(re.nsPsy.lastAttacks[ae]=Xe[2],an=0,Se=0;Se<re.npart_l;Se++){for(var yn=re.s3ind[Se][0],es=Ie[yn]*w[xn[yn]],Sn=re.s3_ll[an++]*es;++yn<=re.s3ind[Se][1];)es=Ie[yn]*w[xn[yn]],Sn=q(Sn,re.s3_ll[an++]*es,yn,yn-Se,re);Sn*=.158489319246111,re.blocktype_old[ae&1]==_.SHORT_TYPE?Re[Se]=Sn:Re[Se]=dt(Math.min(Sn,Math.min(ht*re.nb_1[ae][Se],Z*re.nb_2[ae][Se])),Sn,Er),re.nb_2[ae][Se]=re.nb_1[ae][Se],re.nb_1[ae][Se]=Sn}for(;Se<=_.CBANDS;++Se)Ie[Se]=0,Re[Se]=0;x(re,Ie,Re,ae)}for((Et.mode==S.STEREO||Et.mode==S.JOINT_STEREO)&&n(),Et.mode==S.JOINT_STEREO&&n(),St(Et,Be,be,he),ae=0;ae<ir;ae++){var qa,Ka=0,ol,rs;ae>1?n():(qa=qt,Ka=0,ol=be[ae],rs=Zt[Jt][ae]),ol==_.SHORT_TYPE?qa[Ka+ae]=Ft(rs,re.masking_lower):qa[Ka+ae]=Yt(rs,re.masking_lower),Et.analysis&&(re.pinfo.pe[Jt][ae]=qa[Ka+ae])}return 0};function He(Et){var vt,wt,Jt,Zt;return vt=Et,vt>=0?vt*=3:vt*=1.5,vt>=.5&&vt<=2.5?(Zt=vt-.5,wt=8*(Zt*Zt-2*Zt)):wt=0,vt+=.474,Jt=15.811389+7.5*vt-17.5*Math.sqrt(1+vt*vt),Jt<=-60?0:(vt=Math.exp((wt+Jt)*g),vt/=.6609193,vt)}function Ge(Et){return Et<0&&(Et=0),Et=Et*.001,13*Math.atan(.76*Et)+3.5*Math.atan(Et*Et/(7.5*7.5))}function Oe(Et,vt,wt,Jt,Zt,$t,qt,Kt,ee,be,re,Pe){var ke=o(_.CBANDS+1),Ie=Kt/(Pe>15?2*576:2*192),Ve=s(_.HBLKSIZE),Re;Kt/=ee;var he=0,Be=0;for(Re=0;Re<_.CBANDS;Re++){var ir,ae;for(ir=Ge(Kt*he),ke[Re]=Kt*he,ae=he;Ge(Kt*ae)-ir<nt&&ae<=ee/2;ae++);for(Et[Re]=ae-he,Be=Re+1;he<ae;)Ve[he++]=Re;if(he>ee/2){he=ee/2,++Re;break}}ke[Re]=Kt*he;for(var Se=0;Se<Pe;Se++){var ce,Fe,an,yr,Ae;an=be[Se],yr=be[Se+1],ce=0|Math.floor(.5+re*(an-.5)),ce<0&&(ce=0),Fe=0|Math.floor(.5+re*(yr-.5)),Fe>ee/2&&(Fe=ee/2),wt[Se]=(Ve[ce]+Ve[Fe])/2,vt[Se]=Ve[Fe];var ja=Ie*yr;qt[Se]=(ja-ke[vt[Se]])/(ke[vt[Se]+1]-ke[vt[Se]]),qt[Se]<0?qt[Se]=0:qt[Se]>1&&(qt[Se]=1),Ae=Ge(Kt*be[Se]*re),Ae=Math.min(Ae,15.5)/15.5,$t[Se]=Math.pow(10,1.25*(1-Math.cos(Math.PI*Ae))-2.5)}he=0;for(var Er=0;Er<Be;Er++){var xn=Et[Er],ir,Nn;ir=Ge(Kt*he),Nn=Ge(Kt*(he+xn-1)),Jt[Er]=.5*(ir+Nn),ir=Ge(Kt*(he-.5)),Nn=Ge(Kt*(he+xn-.5)),Zt[Er]=Nn-ir,he+=xn}return Be}function Ne(Et,vt,wt,Jt,Zt,$t){var qt=u([_.CBANDS,_.CBANDS]),Kt,ee=0;if($t)for(var be=0;be<vt;be++)for(Kt=0;Kt<vt;Kt++){var re=He(wt[be]-wt[Kt])*Jt[Kt];qt[be][Kt]=re*Zt[be]}else n();for(var be=0;be<vt;be++){for(Kt=0;Kt<vt&&!(qt[be][Kt]>0);Kt++);for(Et[be][0]=Kt,Kt=vt-1;Kt>0&&!(qt[be][Kt]>0);Kt--);Et[be][1]=Kt,ee+=Et[be][1]-Et[be][0]+1}for(var Pe=o(ee),ke=0,be=0;be<vt;be++)for(Kt=Et[be][0];Kt<=Et[be][1];Kt++)Pe[ke++]=qt[be][Kt];return Pe}function Je(Et){var vt=Ge(Et);return vt=Math.min(vt,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*vt))-2.5)}this.psymodel_init=function(Et){var vt=Et.internal_flags,wt,Jt=!0,Zt=13,$t=24,qt=0,Kt=0,ee=-8.25,be=-4.5,re=o(_.CBANDS),Pe=o(_.CBANDS),ke=o(_.CBANDS),Ie=Et.out_samplerate;switch(Et.experimentalZ){default:case 0:Jt=!0;break;case 1:Jt=!(Et.VBR==y.vbr_mtrh||Et.VBR==y.vbr_mt);break;case 2:Jt=!1;break;case 3:Zt=8,qt=-1.75,Kt=-.0125,ee=-8.25,be=-2.25;break}for(vt.ms_ener_ratio_old=.25,vt.blocktype_old[0]=vt.blocktype_old[1]=_.NORM_TYPE,wt=0;wt<4;++wt){for(var he=0;he<_.CBANDS;++he)vt.nb_1[wt][he]=1e20,vt.nb_2[wt][he]=1e20,vt.nb_s1[wt][he]=vt.nb_s2[wt][he]=1;for(var Ve=0;Ve<_.SBMAX_l;Ve++)vt.en[wt].l[Ve]=1e20,vt.thm[wt].l[Ve]=1e20;for(var he=0;he<3;++he){for(var Ve=0;Ve<_.SBMAX_s;Ve++)vt.en[wt].s[Ve][he]=1e20,vt.thm[wt].s[Ve][he]=1e20;vt.nsPsy.lastAttacks[wt]=0}for(var he=0;he<9;he++)vt.nsPsy.last_en_subshort[wt][he]=10}for(vt.loudness_sq_save[0]=vt.loudness_sq_save[1]=0,vt.npart_l=Oe(vt.numlines_l,vt.bo_l,vt.bm_l,re,Pe,vt.mld_l,vt.PSY.bo_l_weight,Ie,_.BLKSIZE,vt.scalefac_band.l,_.BLKSIZE/(2*576),_.SBMAX_l),wt=0;wt<vt.npart_l;wt++){var Re=qt;re[wt]>=Zt&&(Re=Kt*(re[wt]-Zt)/($t-Zt)+qt*($t-re[wt])/($t-Zt)),ke[wt]=Math.pow(10,Re/10),vt.numlines_l[wt]>0?vt.rnumlines_l[wt]=1/vt.numlines_l[wt]:vt.rnumlines_l[wt]=0}vt.s3_ll=Ne(vt.s3ind,vt.npart_l,re,Pe,ke,Jt);var he=0;for(wt=0;wt<vt.npart_l;wt++){var Be;Be=b.MAX_VALUE;for(var ir=0;ir<vt.numlines_l[wt];ir++,he++){var ae=Ie*he/(1e3*_.BLKSIZE),Se;Se=this.ATHformula(ae*1e3,Et)-20,Se=Math.pow(10,.1*Se),Se*=vt.numlines_l[wt],Be>Se&&(Be=Se)}vt.ATH.cb_l[wt]=Be,Be=-20+re[wt]*20/10,Be>6&&(Be=100),Be<-15&&(Be=-15),Be-=8,vt.minval_l[wt]=Math.pow(10,Be/10)*vt.numlines_l[wt]}for(vt.npart_s=Oe(vt.numlines_s,vt.bo_s,vt.bm_s,re,Pe,vt.mld_s,vt.PSY.bo_s_weight,Ie,_.BLKSIZE_s,vt.scalefac_band.s,_.BLKSIZE_s/(2*192),_.SBMAX_s),he=0,wt=0;wt<vt.npart_s;wt++){var Be,Re=ee;re[wt]>=Zt&&(Re=be*(re[wt]-Zt)/($t-Zt)+ee*($t-re[wt])/($t-Zt)),ke[wt]=Math.pow(10,Re/10),Be=b.MAX_VALUE;for(var ir=0;ir<vt.numlines_s[wt];ir++,he++){var ae=Ie*he/(1e3*_.BLKSIZE_s),Se;Se=this.ATHformula(ae*1e3,Et)-20,Se=Math.pow(10,.1*Se),Se*=vt.numlines_s[wt],Be>Se&&(Be=Se)}vt.ATH.cb_s[wt]=Be,Be=-7+re[wt]*7/12,re[wt]>12&&(Be*=1+Math.log(1+Be)*3.1),re[wt]<12&&(Be*=1+Math.log(1-Be)*2.3),Be<-15&&(Be=-15),Be-=8,vt.minval_s[wt]=Math.pow(10,Be/10)*vt.numlines_s[wt]}vt.s3_ss=Ne(vt.s3ind_s,vt.npart_s,re,Pe,ke,Jt),gt(),$.init_fft(vt),vt.decay=Math.exp(-1*ct/(ft*Ie/192));{var ce;ce=at,Et.exp_nspsytune&2&&(ce=1),Math.abs(Et.msfix)>0&&(ce=Et.msfix),Et.msfix=ce;for(var Fe=0;Fe<vt.npart_l;Fe++)vt.s3ind[Fe][1]>vt.npart_l-1&&(vt.s3ind[Fe][1]=vt.npart_l-1)}var an=576*vt.mode_gr/Ie;if(vt.ATH.decay=Math.pow(10,-12/10*an),vt.ATH.adjust=.01,vt.ATH.adjustLimit=1,Et.ATHtype!=-1){var ae,yr=Et.out_samplerate/_.BLKSIZE,Ae=0;for(ae=0,wt=0;wt<_.BLKSIZE/2;++wt)ae+=yr,vt.ATH.eql_w[wt]=1/Math.pow(10,this.ATHformula(ae,Et)/10),Ae+=vt.ATH.eql_w[wt];for(Ae=1/Ae,wt=_.BLKSIZE/2;--wt>=0;)vt.ATH.eql_w[wt]*=Ae}{for(var Fe=he=0;Fe<vt.npart_s;++Fe)for(wt=0;wt<vt.numlines_s[Fe];++wt)++he;for(var Fe=he=0;Fe<vt.npart_l;++Fe)for(wt=0;wt<vt.numlines_l[Fe];++wt)++he}for(he=0,wt=0;wt<vt.npart_l;wt++){var ae=Ie*(he+vt.numlines_l[wt]/2)/(1*_.BLKSIZE);vt.mld_cb_l[wt]=Je(ae),he+=vt.numlines_l[wt]}for(;wt<_.CBANDS;++wt)vt.mld_cb_l[wt]=1;for(he=0,wt=0;wt<vt.npart_s;wt++){var ae=Ie*(he+vt.numlines_s[wt]/2)/(1*_.BLKSIZE_s);vt.mld_cb_s[wt]=Je(ae),he+=vt.numlines_s[wt]}for(;wt<_.CBANDS;++wt)vt.mld_cb_s[wt]=1;return 0};function Zr(Et,vt){Et<-.3&&(Et=3410),Et/=1e3,Et=Math.max(.1,Et);var wt=3.64*Math.pow(Et,-.8)-6.8*Math.exp(-.6*Math.pow(Et-3.4,2))+6*Math.exp(-.15*Math.pow(Et-8.7,2))+(.6+.04*vt)*.001*Math.pow(Et,4);return wt}this.ATHformula=function(Et,vt){var wt;switch(vt.ATHtype){case 0:wt=Zr(Et,9);break;case 1:wt=Zr(Et,-1);break;case 2:wt=Zr(Et,0);break;case 3:wt=Zr(Et,1)+6;break;case 4:wt=Zr(Et,vt.ATHcurve);break;default:wt=Zr(Et,0);break}return wt}}function Pt(){var $=this,ct=128*1024;Pt.V9=410,Pt.V8=420,Pt.V7=430,Pt.V6=440,Pt.V5=450,Pt.V4=460,Pt.V3=470,Pt.V2=480,Pt.V1=490,Pt.V0=500,Pt.R3MIX=1e3,Pt.STANDARD=1001,Pt.EXTREME=1002,Pt.INSANE=1003,Pt.STANDARD_FAST=1004,Pt.EXTREME_FAST=1005,Pt.MEDIUM=1006,Pt.MEDIUM_FAST=1007;var ht=16384+ct;Pt.LAME_MAXMP3BUFFER=ht;var Z,Lt,j,nt,At,ft=new Gt,kt,Q;this.enc=new _,this.setModules=function(x,E,St,dt,xt,Ft,Wt,Yt,oe){Z=x,Lt=E,j=St,nt=dt,At=xt,kt=Ft,Q=Yt,this.enc.setModules(Lt,ft,nt,kt)};function Ot(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=o(_.SBMAX_l),this.bo_s_weight=o(_.SBMAX_s)}function at(){this.lowerlimit=0}function rt(x,E){this.lowpass=E}var g=4294479419;function T(x){var E;return x.class_id=g,E=x.internal_flags=new Vt,x.mode=S.NOT_SET,x.original=1,x.in_samplerate=44100,x.num_channels=2,x.num_samples=-1,x.bWriteVbrTag=!0,x.quality=-1,x.short_blocks=null,E.subblock_gain=-1,x.lowpassfreq=0,x.highpassfreq=0,x.lowpasswidth=-1,x.highpasswidth=-1,x.VBR=y.vbr_off,x.VBR_q=4,x.ATHcurve=-1,x.VBR_mean_bitrate_kbps=128,x.VBR_min_bitrate_kbps=0,x.VBR_max_bitrate_kbps=0,x.VBR_hard_min=0,E.VBR_min_bitrate=1,E.VBR_max_bitrate=13,x.quant_comp=-1,x.quant_comp_short=-1,x.msfix=-1,E.resample_ratio=1,E.OldValue[0]=180,E.OldValue[1]=180,E.CurrentStep[0]=4,E.CurrentStep[1]=4,E.masking_lower=1,E.nsPsy.attackthre=-1,E.nsPsy.attackthre_s=-1,x.scale=-1,x.athaa_type=-1,x.ATHtype=-1,x.athaa_loudapprox=-1,x.athaa_sensitivity=0,x.useTemporal=null,x.interChRatio=-1,E.mf_samples_to_encode=_.ENCDELAY+_.POSTDELAY,x.encoder_padding=0,E.mf_size=_.ENCDELAY-_.MDCTDELAY,x.findReplayGain=!1,x.decode_on_the_fly=!1,E.decode_on_the_fly=!1,E.findReplayGain=!1,E.findPeakSample=!1,E.RadioGain=0,E.AudiophileGain=0,E.noclipGainChange=0,E.noclipScale=-1,x.preset=0,x.write_id3tag_automatic=!0,0}this.lame_init=function(){var x=new Xt;return T(x),x.lame_allocated_gfp=1,x};function U(x){return x>1?0:x<=0?1:Math.cos(Math.PI/2*x)}this.nearestBitrateFullIndex=function(x){var E=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],St=0,dt=0,xt=0,Ft=0;Ft=E[16],xt=16,dt=E[16],St=16;for(var Wt=0;Wt<16;Wt++)if(Math.max(x,E[Wt+1])!=x){Ft=E[Wt+1],xt=Wt+1,dt=E[Wt],St=Wt;break}return Ft-x>x-dt?St:xt};function tt(x,E){switch(x){case 44100:return E.version=1,0;case 48e3:return E.version=1,1;case 32e3:return E.version=1,2;case 22050:return E.version=0,0;case 24e3:return E.version=0,1;case 16e3:return E.version=0,2;case 11025:return E.version=0,0;case 12e3:return E.version=0,1;case 8e3:return E.version=0,2;default:return E.version=0,-1}}function N(x,E,St){St<16e3&&(E=2);for(var dt=M.bitrate_table[E][1],xt=2;xt<=14;xt++)M.bitrate_table[E][xt]>0&&Math.abs(M.bitrate_table[E][xt]-x)<Math.abs(dt-x)&&(dt=M.bitrate_table[E][xt]);return dt}function A(x,E,St){St<16e3&&(E=2);for(var dt=0;dt<=14;dt++)if(M.bitrate_table[E][dt]>0&&M.bitrate_table[E][dt]==x)return dt;return-1}function z(x,E){var St=[new rt(8,2e3),new rt(16,3700),new rt(24,3900),new rt(32,5500),new rt(40,7e3),new rt(48,7500),new rt(56,1e4),new rt(64,11e3),new rt(80,13500),new rt(96,15100),new rt(112,15600),new rt(128,17e3),new rt(160,17500),new rt(192,18600),new rt(224,19400),new rt(256,19700),new rt(320,20500)],dt=$.nearestBitrateFullIndex(E);x.lowerlimit=St[dt].lowpass}function k(x){var E=x.internal_flags,St=32;if(E.lowpass1>0){for(var dt=999,xt=0;xt<=31;xt++){var Ft=xt/31;Ft>=E.lowpass2&&(St=Math.min(St,xt)),E.lowpass1<Ft&&Ft<E.lowpass2&&(dt=Math.min(dt,xt))}dt==999?E.lowpass1=(St-.75)/31:E.lowpass1=(dt-.75)/31,E.lowpass2=St/31}E.highpass2>0&&n(),E.highpass2>0&&n();for(var xt=0;xt<32;xt++){var Wt,Yt,Ft=xt/31;E.highpass2>E.highpass1?n():Wt=1,E.lowpass2>E.lowpass1?Yt=U((Ft-E.lowpass1)/(E.lowpass2-E.lowpass1+1e-20)):Yt=1,E.amp_filter[xt]=Wt*Yt}}function K(x){var E=x.internal_flags;switch(x.quality){default:case 9:E.psymodel=0,E.noise_shaping=0,E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.use_best_huffman=0,E.full_outer_loop=0;break;case 8:x.quality=7;case 7:E.psymodel=1,E.noise_shaping=0,E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.use_best_huffman=0,E.full_outer_loop=0;break;case 6:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=0,E.full_outer_loop=0;break;case 5:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=0,E.full_outer_loop=0;break;case 4:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 3:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=1,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 2:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.substep_shaping==0&&(E.substep_shaping=2),E.noise_shaping_amp=1,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 1:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.substep_shaping==0&&(E.substep_shaping=2),E.noise_shaping_amp=2,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 0:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.substep_shaping==0&&(E.substep_shaping=2),E.noise_shaping_amp=2,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break}}function w(x){var E=x.internal_flags;x.frameNum=0,x.write_id3tag_automatic&&Q.id3tag_write_v2(x),E.bitrate_stereoMode_Hist=c([16,5]),E.bitrate_blockType_Hist=c([16,6]),E.PeakSample=0,x.bWriteVbrTag&&kt.InitVbrTag(x)}this.lame_init_params=function(x){var E=x.internal_flags;if(E.Class_ID=0,E.ATH==null&&(E.ATH=new zt),E.PSY==null&&(E.PSY=new Ot),E.rgdata==null&&(E.rgdata=new Nt),E.channels_in=x.num_channels,E.channels_in==1&&(x.mode=S.MONO),E.channels_out=x.mode==S.MONO?1:2,E.mode_ext=_.MPG_MD_MS_LR,x.mode==S.MONO&&(x.force_ms=!1),x.VBR==y.vbr_off&&x.VBR_mean_bitrate_kbps!=128&&x.brate==0&&(x.brate=x.VBR_mean_bitrate_kbps),x.VBR==y.vbr_off||x.VBR==y.vbr_mtrh||x.VBR==y.vbr_mt||(x.free_format=!1),x.VBR==y.vbr_off&&x.brate==0&&n(),x.VBR==y.vbr_off&&x.compression_ratio>0&&n(),x.out_samplerate!=0&&(x.out_samplerate<16e3?(x.VBR_mean_bitrate_kbps=Math.max(x.VBR_mean_bitrate_kbps,8),x.VBR_mean_bitrate_kbps=Math.min(x.VBR_mean_bitrate_kbps,64)):x.out_samplerate<32e3?(x.VBR_mean_bitrate_kbps=Math.max(x.VBR_mean_bitrate_kbps,8),x.VBR_mean_bitrate_kbps=Math.min(x.VBR_mean_bitrate_kbps,160)):(x.VBR_mean_bitrate_kbps=Math.max(x.VBR_mean_bitrate_kbps,32),x.VBR_mean_bitrate_kbps=Math.min(x.VBR_mean_bitrate_kbps,320))),x.lowpassfreq==0){var St=16e3;switch(x.VBR){case y.vbr_off:{var dt=new at;z(dt,x.brate),St=dt.lowerlimit;break}case y.vbr_abr:{var dt=new at;z(dt,x.VBR_mean_bitrate_kbps),St=dt.lowerlimit;break}case y.vbr_rh:n();default:n()}x.mode==S.MONO&&(x.VBR==y.vbr_off||x.VBR==y.vbr_abr)&&(St*=1.5),x.lowpassfreq=St|0}switch(x.out_samplerate==0&&n(),x.lowpassfreq=Math.min(20500,x.lowpassfreq),x.lowpassfreq=Math.min(x.out_samplerate/2,x.lowpassfreq),x.VBR==y.vbr_off&&(x.compression_ratio=x.out_samplerate*16*E.channels_out/(1e3*x.brate)),x.VBR==y.vbr_abr&&n(),x.bWriteVbrTag||(x.findReplayGain=!1,x.decode_on_the_fly=!1,E.findPeakSample=!1),E.findReplayGain=x.findReplayGain,E.decode_on_the_fly=x.decode_on_the_fly,E.decode_on_the_fly&&(E.findPeakSample=!0),E.findReplayGain&&n(),E.decode_on_the_fly&&!x.decode_only&&n(),E.mode_gr=x.out_samplerate<=24e3?1:2,x.framesize=576*E.mode_gr,x.encoder_delay=_.ENCDELAY,E.resample_ratio=x.in_samplerate/x.out_samplerate,x.VBR){case y.vbr_mt:case y.vbr_rh:case y.vbr_mtrh:{var xt=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];x.compression_ratio=xt[x.VBR_q]}break;case y.vbr_abr:x.compression_ratio=x.out_samplerate*16*E.channels_out/(1e3*x.VBR_mean_bitrate_kbps);break;default:x.compression_ratio=x.out_samplerate*16*E.channels_out/(1e3*x.brate);break}x.mode==S.NOT_SET&&(x.mode=S.JOINT_STEREO),x.highpassfreq>0?n():(E.highpass1=0,E.highpass2=0),x.lowpassfreq>0?(E.lowpass2=2*x.lowpassfreq,x.lowpasswidth>=0?n():E.lowpass1=1*2*x.lowpassfreq,E.lowpass1/=x.out_samplerate,E.lowpass2/=x.out_samplerate):n(),k(x),E.samplerate_index=tt(x.out_samplerate,x),E.samplerate_index<0&&n(),x.VBR==y.vbr_off?x.free_format?E.bitrate_index=0:(x.brate=N(x.brate,x.version,x.out_samplerate),E.bitrate_index=A(x.brate,x.version,x.out_samplerate),E.bitrate_index<=0&&n()):E.bitrate_index=1,x.analysis&&(x.bWriteVbrTag=!1),E.pinfo!=null&&(x.bWriteVbrTag=!1),Lt.init_bit_stream_w(E);for(var Ft=E.samplerate_index+3*x.version+6*(x.out_samplerate<16e3?1:0),Wt=0;Wt<_.SBMAX_l+1;Wt++)E.scalefac_band.l[Wt]=nt.sfBandIndex[Ft].l[Wt];for(var Wt=0;Wt<_.PSFB21+1;Wt++){var Yt=(E.scalefac_band.l[22]-E.scalefac_band.l[21])/_.PSFB21,oe=E.scalefac_band.l[21]+Wt*Yt;E.scalefac_band.psfb21[Wt]=oe}E.scalefac_band.psfb21[_.PSFB21]=576;for(var Wt=0;Wt<_.SBMAX_s+1;Wt++)E.scalefac_band.s[Wt]=nt.sfBandIndex[Ft].s[Wt];for(var Wt=0;Wt<_.PSFB12+1;Wt++){var Yt=(E.scalefac_band.s[13]-E.scalefac_band.s[12])/_.PSFB12,oe=E.scalefac_band.s[12]+Wt*Yt;E.scalefac_band.psfb12[Wt]=oe}E.scalefac_band.psfb12[_.PSFB12]=192,x.version==1?E.sideinfo_len=E.channels_out==1?21:36:E.sideinfo_len=E.channels_out==1?13:21,x.error_protection&&(E.sideinfo_len+=2),w(x),E.Class_ID=g;{var ve;for(ve=0;ve<19;ve++)E.nsPsy.pefirbuf[ve]=700*E.mode_gr*E.channels_out;x.ATHtype==-1&&(x.ATHtype=4)}switch(x.VBR){case y.vbr_mt:x.VBR=y.vbr_mtrh;case y.vbr_mtrh:{x.useTemporal==null&&(x.useTemporal=!1),j.apply_preset(x,500-x.VBR_q*10,0),x.quality<0&&(x.quality=LAME_DEFAULT_QUALITY),x.quality<5&&(x.quality=0),x.quality>5&&(x.quality=5),E.PSY.mask_adjust=x.maskingadjust,E.PSY.mask_adjust_short=x.maskingadjust_short,x.experimentalY?E.sfb21_extra=!1:E.sfb21_extra=x.out_samplerate>44e3,E.iteration_loop=new VBRNewIterationLoop(At);break}case y.vbr_rh:{j.apply_preset(x,500-x.VBR_q*10,0),E.PSY.mask_adjust=x.maskingadjust,E.PSY.mask_adjust_short=x.maskingadjust_short,x.experimentalY?E.sfb21_extra=!1:E.sfb21_extra=x.out_samplerate>44e3,x.quality>6&&(x.quality=6),x.quality<0&&(x.quality=LAME_DEFAULT_QUALITY),E.iteration_loop=new VBROldIterationLoop(At);break}default:{var ue;E.sfb21_extra=!1,x.quality<0&&(x.quality=LAME_DEFAULT_QUALITY),ue=x.VBR,ue==y.vbr_off&&(x.VBR_mean_bitrate_kbps=x.brate),j.apply_preset(x,x.VBR_mean_bitrate_kbps,0),x.VBR=ue,E.PSY.mask_adjust=x.maskingadjust,E.PSY.mask_adjust_short=x.maskingadjust_short,ue==y.vbr_off?E.iteration_loop=new Ht(At):n();break}}return x.VBR!=y.vbr_off&&n(),x.tune&&n(),K(x),x.athaa_type<0?E.ATH.useAdjust=3:E.ATH.useAdjust=x.athaa_type,E.ATH.aaSensitivityP=Math.pow(10,x.athaa_sensitivity/-10),x.short_blocks==null&&(x.short_blocks=m.short_block_allowed),x.short_blocks==m.short_block_allowed&&(x.mode==S.JOINT_STEREO||x.mode==S.STEREO)&&(x.short_blocks=m.short_block_coupled),x.quant_comp<0&&(x.quant_comp=1),x.quant_comp_short<0&&(x.quant_comp_short=0),x.msfix<0&&(x.msfix=0),x.exp_nspsytune=x.exp_nspsytune|1,x.internal_flags.nsPsy.attackthre<0&&(x.internal_flags.nsPsy.attackthre=Gt.NSATTACKTHRE),x.internal_flags.nsPsy.attackthre_s<0&&(x.internal_flags.nsPsy.attackthre_s=Gt.NSATTACKTHRE_S),x.scale<0&&(x.scale=1),x.ATHtype<0&&(x.ATHtype=4),x.ATHcurve<0&&(x.ATHcurve=4),x.athaa_loudapprox<0&&(x.athaa_loudapprox=2),x.interChRatio<0&&(x.interChRatio=0),x.useTemporal==null&&(x.useTemporal=!0),E.slot_lag=E.frac_SpF=0,x.VBR==y.vbr_off&&(E.slot_lag=E.frac_SpF=(x.version+1)*72e3*x.brate%x.out_samplerate|0),nt.iteration_init(x),ft.psymodel_init(x),0};function gt(x,E){(x.in_buffer_0==null||x.in_buffer_nsamples<E)&&(x.in_buffer_0=o(E),x.in_buffer_1=o(E),x.in_buffer_nsamples=E)}this.lame_encode_flush=function(x,E,St,dt){var xt=x.internal_flags,Ft=f([2,1152]),Wt=0,Yt,oe,ve,ue,He=xt.mf_samples_to_encode-_.POSTDELAY,Ge=B(x);if(xt.mf_samples_to_encode<1)return 0;for(Yt=0,x.in_samplerate!=x.out_samplerate&&n(),ve=x.framesize-He%x.framesize,ve<576&&(ve+=x.framesize),x.encoder_padding=ve,ue=(He+ve)/x.framesize;ue>0&&Wt>=0;){var Oe=Ge-xt.mf_size,Ne=x.frameNum;Oe*=x.in_samplerate,Oe/=x.out_samplerate,Oe>1152&&(Oe=1152),Oe<1&&(Oe=1),oe=dt-Yt,dt==0&&(oe=0),Wt=this.lame_encode_buffer(x,Ft[0],Ft[1],Oe,E,St,oe),St+=Wt,Yt+=Wt,ue-=Ne!=x.frameNum?1:0}return xt.mf_samples_to_encode=0,Wt<0||(oe=dt-Yt,dt==0&&(oe=0),Lt.flush_bitstream(x),Wt=Lt.copy_buffer(xt,E,St,oe,1),Wt<0)?Wt:(St+=Wt,Yt+=Wt,oe=dt-Yt,dt==0&&(oe=0),x.write_id3tag_automatic&&n(),Yt)},this.lame_encode_buffer=function(x,E,St,dt,xt,Ft,Wt){var Yt=x.internal_flags,oe=[null,null];if(Yt.Class_ID!=g)return-3;if(dt==0)return 0;gt(Yt,dt),oe[0]=Yt.in_buffer_0,oe[1]=Yt.in_buffer_1;for(var ve=0;ve<dt;ve++)oe[0][ve]=E[ve],Yt.channels_in>1&&(oe[1][ve]=St[ve]);return L(x,oe[0],oe[1],dt,xt,Ft,Wt)};function B(x){var E=_.BLKSIZE+x.framesize-_.FFTOFFSET;return E=Math.max(E,512+x.framesize-32),E}function L(x,E,St,dt,xt,Ft,Wt){var Yt=x.internal_flags,oe=0,ve,ue,He,Ge,Oe,Ne=[null,null],Je=[null,null];if(Yt.Class_ID!=g)return-3;if(dt==0)return 0;if(Oe=Lt.copy_buffer(Yt,xt,Ft,Wt,0),Oe<0)return Oe;if(Ft+=Oe,oe+=Oe,Je[0]=E,Je[1]=St,F.NEQ(x.scale,0)&&F.NEQ(x.scale,1))for(ue=0;ue<dt;++ue)Je[0][ue]*=x.scale,Yt.channels_out==2&&(Je[1][ue]*=x.scale);if(F.NEQ(x.scale_left,0)&&F.NEQ(x.scale_left,1))for(ue=0;ue<dt;++ue)Je[0][ue]*=x.scale_left;if(F.NEQ(x.scale_right,0)&&F.NEQ(x.scale_right,1))for(ue=0;ue<dt;++ue)Je[1][ue]*=x.scale_right;x.num_channels==2&&Yt.channels_out==1&&n(),Ge=B(x),Ne[0]=Yt.mfbuf[0],Ne[1]=Yt.mfbuf[1];for(var Zr=0;dt>0;){var Et=[null,null],vt=0,wt=0;Et[0]=Je[0],Et[1]=Je[1];var Jt=new q;if(ut(x,Ne,Et,Zr,dt,Jt),vt=Jt.n_in,wt=Jt.n_out,Yt.findReplayGain&&!Yt.decode_on_the_fly&&Z.AnalyzeSamples(Yt.rgdata,Ne[0],Yt.mf_size,Ne[1],Yt.mf_size,wt,Yt.channels_out)==D.GAIN_ANALYSIS_ERROR)return-6;if(dt-=vt,Zr+=vt,Yt.channels_out==2,Yt.mf_size+=wt,Yt.mf_samples_to_encode<1&&n(),Yt.mf_samples_to_encode+=wt,Yt.mf_size>=Ge){var Zt=Wt-oe;if(Wt==0&&(Zt=0),ve=H(x,Ne[0],Ne[1],xt,Ft,Zt),ve<0)return ve;for(Ft+=ve,oe+=ve,Yt.mf_size-=x.framesize,Yt.mf_samples_to_encode-=x.framesize,He=0;He<Yt.channels_out;He++)for(ue=0;ue<Yt.mf_size;ue++)Ne[He][ue]=Ne[He][ue+x.framesize]}}return oe}function H(x,E,St,dt,xt,Ft){var Wt=$.enc.lame_encode_mp3_frame(x,E,St,dt,xt,Ft);return x.frameNum++,Wt}function q(){this.n_in=0,this.n_out=0}function ut(x,E,St,dt,xt,Ft){var Wt=x.internal_flags;if(Wt.resample_ratio<.9999||Wt.resample_ratio>1.0001)n();else{Ft.n_out=Math.min(x.framesize,xt),Ft.n_in=Ft.n_out;for(var Yt=0;Yt<Ft.n_out;++Yt)E[0][Wt.mf_size+Yt]=St[0][dt+Yt],Wt.channels_out==2&&(E[1][Wt.mf_size+Yt]=St[1][dt+Yt])}}}function de(){this.setModules=function($,ct){}}function Qt(){this.setModules=function($,ct,ht){}}function te(){}function Ut(){this.setModules=function($,ct){}}function _e($,ct,ht){$!=1&&n("fix cc: only supports mono");var Z=new Pt,Lt=new de,j=new D,nt=new F,At=new I,ft=new It,kt=new Bt,Q=new G,Ot=new C,at=new Ut,rt=new W,g=new R,T=new Qt,U=new te;Z.setModules(j,nt,At,ft,kt,Q,Ot,at,U),nt.setModules(j,U,Ot,Q),at.setModules(nt,Ot),At.setModules(Z),kt.setModules(nt,rt,ft,g),ft.setModules(g,rt,Z.enc.psy),rt.setModules(nt),g.setModules(ft),Q.setModules(Z,nt,Ot),Lt.setModules(T,U),T.setModules(Ot,at,At);var tt=Z.lame_init();tt.num_channels=$,tt.in_samplerate=ct,tt.out_samplerate=ct,tt.brate=ht,tt.mode=S.STEREO,tt.quality=3,tt.bWriteVbrTag=!1,tt.disable_reservoir=!0,tt.write_id3tag_automatic=!1,Z.lame_init_params(tt);var N=1152,A=0|1.25*N+7200,z=a(A);this.encodeBuffer=function(k,K){$==1&&(K=k),k.length>N&&(N=k.length,A=0|1.25*N+7200,z=a(A));var w=Z.lame_encode_buffer(tt,k,K,k.length,z,0,A);return new Int8Array(z.subarray(0,w))},this.flush=function(){var k=Z.lame_encode_flush(tt,z,0,A);return new Int8Array(z.subarray(0,k))}}lt.SFBMAX=_.SBMAX_s*3,t.Mp3Encoder=_e}t(),e.lamejs=t});(function(e){var t=typeof window=="object"&&!!window.document,r=t?window:Object,n=r.Recorder,a=n.i18n;e(n,a,a.$T,t)})(function(e,t,r,n){var a=function(o){return new s(o)},i="WaveView",s=function(o){var l=this,u={scale:2,speed:9,phase:21.8,fps:20,keep:!0,lineWidth:3,linear1:[0,"rgba(150,96,238,1)",.2,"rgba(170,79,249,1)",1,"rgba(53,199,253,1)"],linear2:[0,"rgba(209,130,255,0.6)",1,"rgba(53,199,255,0.6)"],linearBg:[0,"rgba(255,255,255,0.2)",1,"rgba(54,197,252,0.2)"]};for(var c in o)u[c]=o[c];l.set=o=u;var f="compatibleCanvas";if(o[f])var d=l.canvas=o[f];else{if(!n)throw new Error(r.G("NonBrowser-1",[i]));var p=o.elem;p&&(typeof p=="string"?p=document.querySelector(p):p.length&&(p=p[0])),p&&(o.width=p.offsetWidth,o.height=p.offsetHeight);var v=l.elem=document.createElement("div");v.style.fontSize=0,v.innerHTML='<canvas style="width:100%;height:100%;"/>';var d=l.canvas=v.querySelector("canvas");p&&(p.innerHTML="",p.appendChild(v))}var h=o.scale,m=o.width*h,b=o.height*h;if(!m||!b)throw new Error(r.G("IllegalArgs-1",[i+" width=0 height=0"]));d.width=m,d.height=b;var y=l.ctx=d.getContext("2d");l.linear1=l.genLinear(y,m,o.linear1),l.linear2=l.genLinear(y,m,o.linear2),l.linearBg=l.genLinear(y,b,o.linearBg,!0),l._phase=0};s.prototype=a.prototype={genLinear:function(o,l,u,c){for(var f=o.createLinearGradient(0,0,c?0:l,c?l:0),d=0;d<u.length;)f.addColorStop(u[d++],u[d++]);return f},genPath:function(o,l,u){for(var c=[],f=this,d=f.set,p=d.scale,v=d.width*p,h=d.height*p/2,m=0;m<=v;m+=p){var b=(1+Math.cos(Math.PI+m/v*2*Math.PI))/2,y=b*h*l*Math.sin(2*Math.PI*(m/v)*o+u)+h;c.push(y)}return c},input:function(o,l,u){var c=this;c.sampleRate=u,c.pcmData=o,c.pcmPos=0,c.inputTime=Date.now(),c.schedule()},schedule:function(){var o=this,l=o.set,u=Math.floor(1e3/l.fps);o.timer||(o.timer=setInterval(function(){o.schedule()},u));var c=Date.now(),f=o.drawTime||0;if(!(c-f<u)){o.drawTime=c;for(var d=o.sampleRate/l.fps,p=o.pcmData,v=o.pcmPos,h=Math.max(0,Math.min(d,p.length-v)),m=0,b=0;b<h;b++,v++)m+=Math.abs(p[v]);o.pcmPos=v,(h||!l.keep)&&o.draw(e.PowerLevel(m,h)),!h&&c-o.inputTime>1300&&(clearInterval(o.timer),o.timer=0)}},draw:function(o){var l=this,u=l.set,c=l.ctx,f=u.scale,d=u.width*f,p=u.height*f,v=u.speed/u.fps,h=l._phase-=v,m=h+v*u.phase,b=o/100,y=l.genPath(2,b,h),S=l.genPath(1.8,b,m);c.clearRect(0,0,d,p),c.beginPath();for(var C=0,R=0;R<=d;C++,R+=f)R==0?c.moveTo(R,y[C]):c.lineTo(R,y[C]);C--;for(var R=d-1;R>=0;C--,R-=f)c.lineTo(R,S[C]);c.closePath(),c.fillStyle=l.linearBg,c.fill(),l.drawPath(S,l.linear2),l.drawPath(y,l.linear1)},drawPath:function(o,l){var u=this,c=u.set,f=u.ctx,d=c.scale,p=c.width*d;f.beginPath();for(var v=0,h=0;h<=p;v++,h+=d)h==0?f.moveTo(h,o[v]):f.lineTo(h,o[v]);f.lineWidth=c.lineWidth*d,f.strokeStyle=l,f.stroke()}},e[i]=a});const V_={class:"w-full h-full overflow-hidden flex flex-col gap-4"},$_={class:"flex-1 w-full overflow-auto"},H_={key:0,class:"text-xs text-left"},G_={class:"flex items-center w-full gap-2"},W_={class:"w-20 shrink-0"},X_={class:"flex-1"},Y_={class:"flex items-center cursor-pointer gap-2"},U_=me({__name:"SpeechGenerate",setup(e){const t=ta(),r=ie(!1),n=ie([]),a=Pr({prompt:"",voiceUrl:""}),i=ie(""),s=ie(null),o=ie(),l=ie(!1),u=()=>{s.value=N_({type:"mp3",sampleRate:16e3,bitRate:16}),s.value.open(()=>{console.log("录音已打开"),s.value.start(),l.value=!0,console.log("已开始录音")},(h,m)=>{console.log((m?"UserNotAllow，":"")+"无法录音:"+h)})},c=()=>{if(!s.value){console.error("未打开录音");return}s.value.stop((h,m)=>{l.value=!1,o.value=h;var b=(window.URL||webkitURL).createObjectURL(h);console.log("录音成功",h,b,"时长:"+m+"ms"),s.value.close(),s.value=null},h=>{console.error("结束录音出错："+h),s.value.close(),s.value=null})},f=()=>{var h=URL.createObjectURL(o.value),m=document.createElement("audio");m.controls=!0,document.body.appendChild(m),m.src=h,m.play(),setTimeout(function(){URL.revokeObjectURL(m.src)},5e3)},d=()=>{if(!i.value){qe.error("请先填写音色名称");return}qe.info("前端模式下暂不支持音色克隆功能")},p=()=>{if(!a.prompt){qe.error("请输入文字描述");return}qe.info("前端模式下暂不支持AI语音生成功能")},v=()=>{n.value=[{voiceName:"默认音色1",voiceUrl:"default1"},{voiceName:"默认音色2",voiceUrl:"default2"}],n.value.push({voiceName:"自定义",voiceUrl:"custom"}),a.voiceUrl=n.value[0].voiceUrl};return nn(()=>{v()}),(h,m)=>{const b=Pa,y=Bi,S=Ii,C=Ur,R=Ia,D=Gr,I=Ef,W=Ue,G=Di,F=Mf,X=kf,M=Tf,st=jr;return bt(),Dt("div",V_,[mt("div",$_,[et(b,{"list-data":P(t).speechList,type:"speech"},null,8,["list-data"])]),a.voiceUrl==="custom"?(bt(),Dt("div",H_," 朗读内容：清晨的阳光透过窗帘洒在桌上，温暖而明亮 ")):xe("",!0),rr((bt(),Dt("div",G_,[mt("div",W_,[et(S,{modelValue:a.voiceUrl,"onUpdate:modelValue":m[0]||(m[0]=J=>a.voiceUrl=J),placeholder:"音色"},{default:Tt(()=>[(bt(!0),Dt(Ke,null,nr(n.value,(J,pt)=>(bt(),Ee(y,{key:pt,value:J.voiceUrl,label:J.voiceName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),a.voiceUrl!=="custom"?(bt(),Dt(Ke,{key:0},[mt("div",X_,[et(C,{modelValue:a.prompt,"onUpdate:modelValue":m[1]||(m[1]=J=>a.prompt=J),placeholder:"请输入提示词",onKeyup:Jr(p,["enter"])},null,8,["modelValue"])]),mt("div",null,[et(D,{class:"dark:bg-purple-heavy",circle:"",onClick:p},{default:Tt(()=>[et(R)]),_:1})])],64)):(bt(),Dt(Ke,{key:1},[et(C,{modelValue:i.value,"onUpdate:modelValue":m[2]||(m[2]=J=>i.value=J),placeholder:"请输入音色名称"},null,8,["modelValue"]),mt("div",Y_,[l.value?(bt(),Ee(G,{key:1,content:"停止录音"},{default:Tt(()=>[et(W,{size:"18",onClick:c},{default:Tt(()=>[et(F)]),_:1})]),_:1})):(bt(),Ee(G,{key:0,content:"开始/重新录音"},{default:Tt(()=>[et(W,{size:"18",onClick:u},{default:Tt(()=>[et(I)]),_:1})]),_:1})),o.value?(bt(),Ee(G,{key:2,content:"试听录音"},{default:Tt(()=>[et(W,{size:"18",onClick:f},{default:Tt(()=>[et(X)]),_:1})]),_:1})):xe("",!0),o.value?(bt(),Ee(G,{key:3,content:"克隆录音"},{default:Tt(()=>[et(D,{type:"primary",circle:"",onClick:d},{default:Tt(()=>[et(M),m[3]||(m[3]=Ye(" >"))]),_:1})]),_:1})):xe("",!0)])],64))])),[[st,r.value]])])}}}),j_=qr(U_,[["__scopeId","data-v-6a0d04d6"]]),m0=[{title:"文本",key:"text",icon:"TextIcon",component:l_},{title:"图片",key:"image",fileType:"image/*",icon:"ImageIcon",component:Tc},{title:"音频",key:"audio",fileType:"audio/*",icon:"AudioIcon",component:Dc},{title:"旁白",key:"speech",fileType:"audio/*",icon:"VoiceIcon",component:j_},{title:"视频",key:"video",fileType:"video/*",icon:"VideoIcon",component:Rc}],_0=[{title:"图片",key:"image",fileType:"image/*",icon:"ImageIcon",component:Tc},{title:"音频",key:"audio",fileType:"audio/*",icon:"AudioIcon",component:Dc},{title:"视频",key:"video",fileType:"video/*",icon:"VideoIcon",component:Rc}],q_={class:"flex h-full overflow-hidden relative container-box !p-0 bg-transparent"},K_={class:"flex flex-col gap-2 w-full"},Z_=me({__name:"GenerateContainer",setup(e){const t=ie(0),r=se(()=>m0[t.value]);return(n,a)=>(bt(),Dt("div",q_,[mt("div",K_,[et(kc,{"active-index":P(t),"onUpdate:activeIndex":a[0]||(a[0]=i=>ws(t)?t.value=i:null),menu:P(m0)},null,8,["active-index","menu"]),(bt(),Ee(Df,null,[(bt(),Ee(Ln(P(r).component),{key:P(r).key}))],1024))])]))}}),Q_=I0(),kr=ur(),da=Br(),J_=()=>{Tr("backspace,delete",(e,t)=>{kr.removeTrack(),e.preventDefault()}),Tr("space",(e,t)=>{da.isPause=!da.isPause,e.preventDefault()}),Tr("right",(e,t)=>{da.forward(),e.preventDefault()}),Tr("left",(e,t)=>{da.backward(),e.preventDefault()}),Tr("t|T",(e,t)=>{kr.addText(),e.preventDefault()}),Tr("l",(e,t)=>{kr.leftLink(),e.preventDefault()}),Tr("s",(e,t)=>{kr.splitTrack(),e.preventDefault()}),Tr("ctrl+c",(e,t)=>{kr.selectTrack&&(kr.copyData=kr.selectTrack,e.preventDefault())}),Tr("ctrl+v",(e,t)=>{(async()=>{if(kr.copyData){const r=await kr.copyTrack(kr.copyData),n=r.end-r.start;r.start=da.playStartFrame,r.end=r.start+n,kr.addTrack(r),e.preventDefault()}})()}),Tr("ctrl+s",(e,t)=>{Q_.saveProject().then(()=>{qe.success("保存成功")}),e.preventDefault()}),Tr("ctrl+z",(e,t)=>{kr._undo(),e.preventDefault()}),Tr("ctrl+shift+z",(e,t)=>{kr._redo(),e.preventDefault()})},t3=()=>{Tr.deleteScope("all")},e3={class:"w-full h-full overflow-hidden flex flex-col items-center"},r3={class:"flex-1 w-full overflow-auto"},n3={class:"w-full upload-container"},a3=me({__name:"UploadContainer",setup(e){const t=ta(),r=ie([]),n=ie(!1),a=ie(0),i=se(()=>t.getResourcesByType(s.value.key).value||[]),s=se(()=>_0.filter(l=>l.fileType)[a.value]),o=async()=>{if(r.value.length===0){qe.error("请选择文件再上传");return}n.value=!0;try{const l=r.value[0].raw;if(!l){qe.error("文件无效");return}await t.createResource(l),qe.success("文件上传成功"),r.value=[]}catch(l){console.error("Upload error:",l),qe.error("文件上传失败")}finally{n.value=!1}};return We(()=>r.value,()=>{r.value.length>0&&o()}),(l,u)=>{const c=Pa,f=Ue,d=zd,p=jr;return bt(),Dt("div",e3,[et(kc,{"active-index":P(a),"onUpdate:activeIndex":u[0]||(u[0]=v=>ws(a)?a.value=v:null),menu:P(_0)},null,8,["active-index","menu"]),mt("div",r3,[et(c,{"list-data":P(i),type:P(s).key},null,8,["list-data","type"])]),rr((bt(),Dt("div",n3,[et(d,{"file-list":P(r),"onUpdate:fileList":u[1]||(u[1]=v=>ws(r)?r.value=v:null),class:"w-full",drag:"",action:"","show-file-list":!1,"auto-upload":!1,accept:P(s).fileType,limit:1},{default:Tt(()=>[et(f,{class:"el-icon--upload mt-2",size:"40"},{default:Tt(()=>[et(P(Rf))]),_:1}),u[2]||(u[2]=mt("div",{class:"el-upload__text !mt-[-10px] mb-4"},[Ye(" 拖拽文件到此 或 "),mt("em",null,"点击上传")],-1))]),_:1},8,["file-list","accept"])])),[[p,P(n)]])])}}}),i3=qr(a3,[["__scopeId","data-v-8aca2d5a"]]),s3={class:"flex flex-1 overflow-hidden gap-4 p-4 h-full"},o3={class:"w-[370px] flex flex-col rounded overflow-hidden"},l3={class:"flex flex-1 flex-col overflow-hidden gap-2"},u3={class:"flex flex-1 flex-row flex-nowrap container-box gap-2"},p3=me({__name:"index",setup(e){const t=Jn(),r=I0(),n=ie(),a=Pr({minHeight:200,maxHeight:document.body.getBoundingClientRect().height-200,minWidth:300,maxWidth:600});return nn(()=>{J_(),n.value=setInterval(async()=>{await r.saveProject()},30*1e3)}),k0(()=>{t3(),clearInterval(n.value)}),(i,s)=>{const o=E0,l=M0;return bt(),Dt("div",s3,[mt("div",o3,[et(l,{type:"border-card",class:"flex-1 overflow-hidden"},{default:Tt(()=>[et(o,{class:"h-full",label:"生成区"},{default:Tt(()=>[et(Z_)]),_:1}),et(o,{class:"h-full",label:"上传区"},{default:Tt(()=>[et(i3)]),_:1})]),_:1})]),mt("div",l3,[mt("div",u3,[et(V2),et(g0,{"new-width":P(t).attrWidth,"onUpdate:newWidth":s[0]||(s[0]=u=>P(t).attrWidth=u),direction:"vertical","limit-size":P(a)},null,8,["new-width","limit-size"]),et(Sv)]),et(g0,{"new-height":P(t).trackHeight,"onUpdate:newHeight":s[1]||(s[1]=u=>P(t).trackHeight=u),direction:"horizontal","limit-size":P(a)},null,8,["new-height","limit-size"]),et(Hm)])])}}});export{p3 as default};
