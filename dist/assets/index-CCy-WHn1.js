var Fi=e=>{throw TypeError(e)};var Wl=(e,t,r)=>t.has(e)||Fi("Cannot "+r);var Ni=(e,t,r)=>t.has(e)?Fi("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r);var Le=(e,t,r)=>(Wl(e,t,"access private method"),r);import{b as xt,o as H,e as K,f as F,v as pt,bE as Xl,a3 as re,a5 as Et,ci as Je,g as O,cB as Hl,z as ue,ck as Yl,ai as Wt,F as ve,i as ye,H as Pt,w as q,h as P,a as mt,cC as Gt,y as dt,j as kt,cD as jt,ak as wn,x as En,G as Pr,cE as jl,s as Xa,aX as Ul,cF as ql,cG as oe,X as Jt,Z as ca,cH as Kl,cI as Zl,cJ as Jl,cK as Ql,cL as tu,cM as sr,bj as Go,bk as Fo,I as lr,bX as Ha,aj as No,a0 as $o,cN as $i,am as ur,L as Ee,a4 as Vo,cO as eu,cP as ru,cQ as nu,ad as Dn,bi as cr,cR as au,cS as iu,cT as ou,cU as su,a2 as lu,aP as Mn,aZ as Wo,cV as uu,cW as Ya,cX as cu,cY as fu,cZ as Xo,c_ as Ho,c$ as ja,d0 as du,as as pu,A as vn,aU as Yo,aA as jo,l as Uo,d1 as vu,d2 as hu,d3 as gu}from"./index-BJm2gtVL.js";import{d as kn,c as mu}from"./el-progress-PEfdW5nq.js";import{E as Or,_ as Ua,h as ee}from"./hotkeys.esm-BU80B-vM.js";import{c as bu,E as xu,d as _u,f as Vi,h as Wi,_ as yu,i as Xi}from"./menu-DFni8JVn.js";const Su={class:"flex flex-1 gap-3 items-center"},Cu={class:"font-semibold flex-shrink-0"},st=xt({__name:"AttrCol",props:{name:{},nowrap:{type:Boolean}},setup(e){return(t,r)=>(H(),K("div",Su,[F("div",Cu,pt(t.name),1),F("div",{class:re(["flex-1 overflow-hidden font-thin",{"overflow-ellipsis whitespace-nowrap":t.nowrap}])},[Xl(t.$slots,"default")],2)]))}}),wu=["rgba(0,0,0,0)","#000","#fff","#fafafa","#f5f5f5","#EBEBEB","#D9D9D9","#BFBFBF","#8C8C8C","#595959","#262626","#1E2026","#292C34","#31353E","#3A3F49","#4C525D","#7A808B","#AAAFBB","#C7CBD5","#EDEEF2","#3f3ddf","#3875FF","#21B0FF","#1CD2C8","#F6BD15","#FF9846","#E96452","#896AFF","#5E7092","#213474"],Eu="";function fr(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}const dr=function(e,t){const{componentPrefix:r=Eu}=t||{};e.component(`${r}${this.name}`,this)},qn={};var Br={name:"Checkboard",props:{size:{type:[Number,String],default:8},white:{type:String,default:"#fff"},grey:{type:String,default:"#e6e6e6"}},computed:{bgStyle(){return{"background-image":`url(${Mu(this.white,this.grey,this.size)})`}}}};function Du(e,t,r){if(typeof document>"u")return null;const n=document.createElement("canvas");n.width=n.height=r*2;const a=n.getContext("2d");return a?(a.fillStyle=e,a.fillRect(0,0,n.width,n.height),a.fillStyle=t,a.fillRect(0,0,r,r),a.translate(r,r),a.fillRect(0,0,r,r),n.toDataURL()):null}function Mu(e,t,r){const n=`${e},${t},${r}`;if(qn[n])return qn[n];const a=Du(e,t,r);return qn[n]=a,a}function ku(e,t,r,n,a,i){return H(),K("div",{class:"vc-checkerboard",style:Et(i.bgStyle)},null,4)}var Tu=".vc-checkerboard{background-size:contain;bottom:0;left:0;position:absolute;right:0;top:0}";fr(Tu);Br.render=ku;Br.__file="src/components/checkboard/checkboard.vue";Br.install=dr;var Tn={name:"Alpha",components:{Checkboard:Br},props:{value:Object,onChange:Function},computed:{colors(){return this.value},gradientColor(){const{rgba:e}=this.colors,t=[e.r,e.g,e.b].join(",");return`linear-gradient(to right, rgba(${t}, 0) 0%, rgba(${t}, 1) 100%)`}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:r}=this.$refs;if(!r)return;const n=r.clientWidth,a=r.getBoundingClientRect().left+window.pageXOffset,o=(e.pageX||(e.touches?e.touches[0].pageX:0))-a;let s;o<0?s=0:o>n?s=1:s=Math.round(o*100/n)/100,this.colors.a!==s&&this.$emit("change",{h:this.colors.hsl.h,s:this.colors.hsl.s,l:this.colors.hsl.l,a:s,source:"rgba"})},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const Ru={class:"vc-alpha"},Iu={class:"vc-alpha-checkboard-wrap"},Pu=F("div",{class:"vc-alpha-picker"},null,-1),Ou=[Pu];function Bu(e,t,r,n,a,i){const o=Je("Checkboard");return H(),K("div",Ru,[F("div",Iu,[O(o)]),F("div",{class:"vc-alpha-gradient",style:Et({background:i.gradientColor})},null,4),F("div",{ref:"container",class:"vc-alpha-container",onMousedown:t[0]||(t[0]=(...s)=>i.handleMouseDown&&i.handleMouseDown(...s)),onTouchmove:t[1]||(t[1]=(...s)=>i.handleChange&&i.handleChange(...s)),onTouchstart:t[2]||(t[2]=(...s)=>i.handleChange&&i.handleChange(...s))},[F("div",{class:"vc-alpha-pointer",style:Et({left:`${i.colors.a*100}%`})},Ou,4)],544)])}var zu=".vc-alpha,.vc-alpha-checkboard-wrap{bottom:0;left:0;position:absolute;right:0;top:0}.vc-alpha-checkboard-wrap{overflow:hidden}.vc-alpha-gradient{bottom:0;left:0;position:absolute;right:0;top:0}.vc-alpha-container{cursor:pointer;height:100%;margin:0 3px;position:relative;z-index:2}.vc-alpha-pointer{position:absolute;z-index:2}.vc-alpha-picker{background:#fff;border-radius:1px;box-shadow:0 0 2px rgba(0,0,0,.6);cursor:pointer;height:8px;margin-top:1px;transform:translateX(-2px);width:4px}";fr(zu);Tn.render=Bu;Tn.__file="src/components/alpha/alpha.vue";Tn.install=dr;function Te(...e){return new Hl(...e)}function Kn(e,t){const r=e&&e.a;let n;e&&e.hsl?n=Te(e.hsl):e&&e.hex&&e.hex.length>0?n=Te(e.hex):e&&e.hsv?n=Te(e.hsv):e&&e.rgba?n=Te(e.rgba):e&&e.rgb?n=Te(e.rgb):n=Te(e),n&&(n._a===void 0||n._a===null)&&n.setAlpha(r||n.getAlpha());const a=n.toHsl(),i=n.toHsv();return a.s===0&&(i.h=a.h=e.h||e.hsl&&e.hsl.h||t||0),i.v<.0164&&(i.h=e.h||e.hsv&&e.hsv.h||0,i.s=e.s||e.hsv&&e.hsv.s||0),a.l<.01&&(a.h=e.h||e.hsl&&e.hsl.h||0,a.s=e.s||e.hsl&&e.hsl.s||0),{hsl:a,hex:n.toHexString().toUpperCase(),hex8:n.toHex8String().toUpperCase(),rgba:n.toRgb(),hsv:i,oldHue:e.h||t||a.h,source:e.source,a:n.getAlpha()}}var Au={model:{prop:"modelValue",event:"update:modelValue"},props:["modelValue"],data(){return{val:Kn(this.modelValue)}},computed:{colors:{get(){return this.val},set(e){this.val=e,this.$emit("update:modelValue",e)}}},watch:{modelValue(e){this.val=Kn(e)}},methods:{colorChange(e,t){this.oldHue=this.colors.hsl.h,this.colors=Kn(e,t||this.oldHue)},isValidHex(e){return Te(e).isValid},simpleCheckForValidColor(e){const t=["r","g","b","a","h","s","l","v"];let r=0,n=0;for(let a=0;a<t.length;a++){const i=t[a];e[i]&&(r++,isNaN(e[i])||n++)}if(r===n)return e},paletteUpperCase(e){return e.map(t=>t.toUpperCase())},isTransparent(e){return Te(e).getAlpha()===0}}},Rn={name:"EditableInput",props:{label:String,labelText:String,desc:String,value:[String,Number],max:Number,min:Number,arrowOffset:{type:Number,default:1}},computed:{val:{get(){return this.value},set(e){if(this.max!==void 0&&+e>this.max)this.$refs.input.value=this.max;else return e}},labelId(){return`input__label__${this.label}__${Math.random().toString().slice(2,5)}`},labelSpanText(){return this.labelText||this.label}},methods:{update(e){this.handleChange(e.target.value)},handleChange(e){const t={};t[this.label]=e,t.hex===void 0&&t["#"]===void 0?this.$emit("change",t):e.length>5&&this.$emit("change",t)},handleKeyDown(e){let{val:t}=this;const r=Number(t);if(r){const n=this.arrowOffset||1;e.keyCode===38&&(t=r+n,this.handleChange(t),e.preventDefault()),e.keyCode===40&&(t=r-n,this.handleChange(t),e.preventDefault())}}}};const Lu={class:"vc-editable-input"},Gu=["aria-labelledby"],Fu=["id","for"],Nu={class:"vc-input__desc"};function $u(e,t,r,n,a,i){return H(),K("div",Lu,[ue(F("input",{ref:"input","onUpdate:modelValue":t[0]||(t[0]=o=>i.val=o),"aria-labelledby":i.labelId,class:"vc-input__input",onKeydown:t[1]||(t[1]=(...o)=>i.handleKeyDown&&i.handleKeyDown(...o)),onInput:t[2]||(t[2]=(...o)=>i.update&&i.update(...o))},null,40,Gu),[[Yl,i.val]]),F("span",{id:i.labelId,for:r.label,class:"vc-input__label"},pt(i.labelSpanText),9,Fu),F("span",Nu,pt(r.desc),1)])}var Vu=".vc-editable-input{position:relative}.vc-input__input{border:0;outline:none;padding:0}.vc-input__label{text-transform:capitalize}";fr(Vu);Rn.render=$u;Rn.__file="src/components/editable-input/editable-input.vue";Rn.install=dr;function Zn(e,t,r){return t<r?e<t?t:e>r?r:e:e<r?r:e>t?t:e}var In={name:"Saturation",props:{value:Object},computed:{colors(){return this.value},bgColor(){return`hsl(${this.colors.hsv.h}, 100%, 50%)`},pointerTop(){return`${-(this.colors.hsv.v*100)+1+100}%`},pointerLeft(){return`${this.colors.hsv.s*100}%`}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:r}=this.$refs;if(!r)return;const n=r.clientWidth,a=r.clientHeight,i=r.getBoundingClientRect().left+window.pageXOffset,o=r.getBoundingClientRect().top+window.pageYOffset,s=e.pageX||(e.touches?e.touches[0].pageX:0),l=e.pageY||(e.touches?e.touches[0].pageY:0),u=Zn(s-i,0,n),c=Zn(l-o,0,a),d=u/n,f=Zn(-(c/a)+1,0,1);this.onChange({h:this.colors.hsv.h,s:d,v:f,a:this.colors.hsv.a,source:"hsva"})},onChange(e){this.$emit("change",e)},handleMouseDown(e){window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const Wu=F("div",{class:"vc-saturation--white"},null,-1),Xu=F("div",{class:"vc-saturation--black"},null,-1),Hu=F("div",{class:"vc-saturation-circle"},null,-1),Yu=[Hu];function ju(e,t,r,n,a,i){return H(),K("div",{ref:"container",class:"vc-saturation",style:Et({background:i.bgColor}),onMousedown:t[0]||(t[0]=(...o)=>i.handleMouseDown&&i.handleMouseDown(...o)),onTouchmove:t[1]||(t[1]=(...o)=>i.handleChange&&i.handleChange(...o)),onTouchstart:t[2]||(t[2]=(...o)=>i.handleChange&&i.handleChange(...o))},[Wu,Xu,F("div",{class:"vc-saturation-pointer",style:Et({top:i.pointerTop,left:i.pointerLeft})},Yu,4)],36)}var Uu=".vc-saturation,.vc-saturation--black,.vc-saturation--white{bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.vc-saturation--white{background:linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.vc-saturation--black{background:linear-gradient(0deg,#000,transparent)}.vc-saturation-pointer{cursor:pointer;position:absolute}.vc-saturation-circle{border-radius:50%;box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgba(0,0,0,.3),0 0 1px 2px rgba(0,0,0,.4);cursor:head;height:4px;transform:translate(-2px,-2px);width:4px}";fr(Uu);In.render=ju;In.__file="src/components/saturation/saturation.vue";In.install=dr;var Pn={name:"Hue",props:{value:Object,direction:{type:String,default:"horizontal"}},data(){return{oldHue:0,pullDirection:""}},computed:{colors(){return this.value},directionClass(){return{"vc-hue--horizontal":this.direction==="horizontal","vc-hue--vertical":this.direction==="vertical"}},pointerTop(){return this.direction==="vertical"?this.colors.hsl.h===0&&this.pullDirection==="right"?0:`${-(this.colors.hsl.h*100/360)+100}%`:0},pointerLeft(){return this.direction==="vertical"?0:this.colors.hsl.h===0&&this.pullDirection==="right"?"100%":`${this.colors.hsl.h*100/360}%`}},watch:{value:{handler(e,t){const{h:r}=e.hsl;r!==0&&r-this.oldHue>0&&(this.pullDirection="right"),r!==0&&r-this.oldHue<0&&(this.pullDirection="left"),this.oldHue=r},deep:!0,immediate:!0}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:r}=this.$refs;if(!r)return;const n=r.clientWidth,a=r.clientHeight,i=r.getBoundingClientRect().left+window.pageXOffset,o=r.getBoundingClientRect().top+window.pageYOffset,s=e.pageX||(e.touches?e.touches[0].pageX:0),l=e.pageY||(e.touches?e.touches[0].pageY:0),u=s-i,c=l-o;let d,f;this.direction==="vertical"?(c<0?d=360:c>a?d=0:(f=-(c*100/a)+100,d=360*f/100),this.colors.hsl.h!==d&&this.$emit("change",{h:d,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"})):(u<0?d=0:u>n?d=360:(f=u*100/n,d=360*f/100),this.colors.hsl.h!==d&&this.$emit("change",{h:d,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"}))},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const qu=["aria-valuenow"],Ku=F("div",{class:"vc-hue-picker"},null,-1),Zu=[Ku];function Ju(e,t,r,n,a,i){return H(),K("div",{class:re(["vc-hue",[i.directionClass]])},[F("div",{ref:"container",class:"vc-hue-container",role:"slider","aria-valuenow":i.colors.hsl.h,"aria-valuemin":"0","aria-valuemax":"360",onMousedown:t[0]||(t[0]=(...o)=>i.handleMouseDown&&i.handleMouseDown(...o)),onTouchmove:t[1]||(t[1]=(...o)=>i.handleChange&&i.handleChange(...o)),onTouchstart:t[2]||(t[2]=(...o)=>i.handleChange&&i.handleChange(...o))},[F("div",{class:"vc-hue-pointer",style:Et({top:i.pointerTop,left:i.pointerLeft}),role:"presentation"},Zu,4)],40,qu)],2)}var Qu=".vc-hue{border-radius:2px;bottom:0;left:0;position:absolute;right:0;top:0}.vc-hue--horizontal{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.vc-hue--vertical{background:linear-gradient(0deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.vc-hue-container{cursor:pointer;height:100%;margin:0 2px;position:relative}.vc-hue-pointer{position:absolute;z-index:2}.vc-hue-picker{background:#fff;border-radius:1px;box-shadow:0 0 2px rgba(0,0,0,.6);cursor:pointer;height:8px;margin-top:1px;transform:translateX(-2px);width:4px}";fr(Qu);Pn.render=Ju;Pn.__file="src/components/hue/hue.vue";Pn.install=dr;const tc=["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF","rgba(0,0,0,0)"];var On={name:"Sketch",components:{Saturation:In,Hue:Pn,Alpha:Tn,EdIn:Rn,Checkboard:Br},mixins:[Au],props:{presetColors:{type:Array,default(){return tc}},disableAlpha:{type:Boolean,default:!1},disableFields:{type:Boolean,default:!1}},computed:{hex(){let e;return this.colors.a<1?e=this.colors.hex8:e=this.colors.hex,e.replace("#","")},activeColor(){const{rgba:e}=this.colors;return`rgba(${[e.r,e.g,e.b,e.a].join(",")})`}},methods:{handlePreset(e){this.colorChange(e)},childChange(e){this.colorChange(e)},inputChange(e){e&&(e.hex?this.isValidHex(e.hex)&&this.colorChange({hex:e.hex,source:"hex"}):(e.r||e.g||e.b||e.a)&&this.colorChange({r:e.r||this.colors.rgba.r,g:e.g||this.colors.rgba.g,b:e.b||this.colors.rgba.b,a:e.a||this.colors.rgba.a,source:"rgba"}))}}};const ec={class:"vc-sketch-saturation-wrap"},rc={class:"vc-sketch-controls"},nc={class:"vc-sketch-sliders"},ac={class:"vc-sketch-hue-wrap"},ic={key:0,class:"vc-sketch-alpha-wrap"},oc={class:"vc-sketch-color-wrap"},sc=["aria-label"],lc={key:0,class:"vc-sketch-field"},uc={class:"vc-sketch-field--double"},cc={class:"vc-sketch-field--single"},fc={class:"vc-sketch-field--single"},dc={class:"vc-sketch-field--single"},pc={key:0,class:"vc-sketch-field--single"},vc={class:"vc-sketch-presets",role:"group","aria-label":"A color preset, pick one to set as current color"},hc=["aria-label","onClick"],gc=["aria-label","onClick"];function mc(e,t,r,n,a,i){const o=Je("Saturation"),s=Je("Hue"),l=Je("Alpha"),u=Je("Checkboard"),c=Je("EdIn");return H(),K("div",{role:"application","aria-label":"Sketch color picker",class:re(["vc-sketch",[r.disableAlpha?"vc-sketch__disable-alpha":""]])},[F("div",ec,[O(o,{value:e.colors,onChange:i.childChange},null,8,["value","onChange"])]),F("div",rc,[F("div",nc,[F("div",ac,[O(s,{value:e.colors,onChange:i.childChange},null,8,["value","onChange"])]),r.disableAlpha?Wt("v-if",!0):(H(),K("div",ic,[O(l,{value:e.colors,onChange:i.childChange},null,8,["value","onChange"])]))]),F("div",oc,[F("div",{"aria-label":`Current color is ${i.activeColor}`,class:"vc-sketch-active-color",style:Et({background:i.activeColor})},null,12,sc),O(u)])]),r.disableFields?Wt("v-if",!0):(H(),K("div",lc,[Wt(" rgba "),F("div",uc,[O(c,{label:"hex",value:i.hex,onChange:i.inputChange},null,8,["value","onChange"])]),F("div",cc,[O(c,{label:"r",value:e.colors.rgba.r,onChange:i.inputChange},null,8,["value","onChange"])]),F("div",fc,[O(c,{label:"g",value:e.colors.rgba.g,onChange:i.inputChange},null,8,["value","onChange"])]),F("div",dc,[O(c,{label:"b",value:e.colors.rgba.b,onChange:i.inputChange},null,8,["value","onChange"])]),r.disableAlpha?Wt("v-if",!0):(H(),K("div",pc,[O(c,{label:"a",value:e.colors.a,"arrow-offset":.01,max:1,onChange:i.inputChange},null,8,["value","arrow-offset","onChange"])]))])),F("div",vc,[(H(!0),K(ve,null,ye(r.presetColors,d=>(H(),K(ve,null,[e.isTransparent(d)?(H(),K("div",{key:d,"aria-label":`Color:${d}`,class:"vc-sketch-presets-color",onClick:f=>i.handlePreset(d)},[O(u)],8,gc)):(H(),K("div",{key:`!${d}`,class:"vc-sketch-presets-color","aria-label":`Color:${d}`,style:Et({background:d}),onClick:f=>i.handlePreset(d)},null,12,hc))],64))),256))])],2)}var bc=".vc-sketch{background:#fff;border-radius:4px;box-shadow:0 0 0 1px rgba(0,0,0,.15),0 8px 16px rgba(0,0,0,.15);box-sizing:initial;padding:10px 10px 0;position:relative;width:200px}.vc-sketch-saturation-wrap{overflow:hidden;padding-bottom:75%;position:relative;width:100%}.vc-sketch-controls{display:flex}.vc-sketch-sliders{flex:1;padding:4px 0}.vc-sketch-sliders .vc-alpha-gradient,.vc-sketch-sliders .vc-hue{border-radius:2px}.vc-sketch-alpha-wrap,.vc-sketch-hue-wrap{height:10px;position:relative}.vc-sketch-alpha-wrap{margin-top:4px;overflow:hidden}.vc-sketch-color-wrap{border-radius:3px;height:24px;margin-left:4px;margin-top:4px;position:relative;width:24px}.vc-sketch-active-color{border-radius:2px;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.15),inset 0 0 4px rgba(0,0,0,.25);left:0;position:absolute;right:0;top:0;z-index:2}.vc-sketch-color-wrap .vc-checkerboard{background-size:auto}.vc-sketch-field{display:flex;padding-top:4px}.vc-sketch-field .vc-input__input{border:none;box-shadow:inset 0 0 0 1px #ccc;font-size:10px;padding:4px 0 3px 10%;width:90%}.vc-sketch-field .vc-input__label{color:#222;display:block;font-size:11px;padding-bottom:4px;padding-top:3px;text-align:center;text-transform:capitalize}.vc-sketch-field--single{flex:1;padding-left:6px}.vc-sketch-field--double{flex:2}.vc-sketch-presets{border-top:1px solid #eee;margin-left:-10px;margin-right:-10px;padding-left:10px;padding-top:10px}.vc-sketch-presets-color{cursor:pointer;display:inline-block;height:16px;margin:0 10px 10px 0;overflow:hidden;position:relative;vertical-align:top;width:16px}.vc-sketch-presets-color,.vc-sketch-presets-color .vc-checkerboard{border-radius:3px;box-shadow:inset 0 0 0 1px rgba(0,0,0,.15)}.vc-sketch__disable-alpha .vc-sketch-color-wrap{height:10px}";fr(bc);On.render=mc;On.__file="src/components/sketch/sketch.vue";On.install=dr;const xc={class:"flex flex-row items-center cursor-pointer"},_c={class:"not-italic"},cn=xt({__name:"ColorPicker",props:{modelValue:{type:String,default(){return""}}},emits:{"update:modelValue":e=>e!==null},setup(e,{emit:t}){const r=t;function n(a){a.rgba.a===0?r("update:modelValue",""):r("update:modelValue",a.hex)}return(a,i)=>{const o=bu;return H(),Pt(o,{placement:"bottom",width:220,trigger:"click"},{reference:q(()=>[F("div",xc,[F("span",{class:"w-6 h-4 block mr-1 border border-gray-500",style:Et({backgroundColor:e.modelValue})},null,4),F("span",_c,pt(e.modelValue),1)])]),default:q(()=>[O(P(On),{"model-value":e.modelValue,"onUpdate:modelValue":n,"preset-colors":P(wu)},null,8,["model-value","preset-colors"])]),_:1})}}}),yc={class:"text-[12px] leading-5 flex flex-col gap-5"},Sc={class:"flex"},Cc={class:"w-full grid grid-cols-2 gap-4"},wc={class:"flex flex-1 gap-2 items-center"},Ec={class:"flex flex-1 gap-2 items-center"},Dc={class:"flex items-center gap-2"},Mc={class:"flex-shrink-0"},kc={class:"flex gap-4"},Tc={class:"flex gap-4"},Rc=xt({__name:"TextAttr",setup(e){const t=mt(!1),r=Gt(),n=dt(()=>r.selectResource);return(a,i)=>{const o=kn,s=wn,l=Or,u=En,c=Pr;return ue((H(),K("div",yc,[F("div",Sc,[O(st,{name:"时长"},{default:q(()=>[kt(pt(((P(n).end-P(n).start)/P(jt)).toFixed(2))+" s ",1)]),_:1}),O(st,{name:"类型"},{default:q(()=>[O(o,{size:"small"},{default:q(()=>[kt(pt(P(n).type),1)]),_:1})]),_:1})]),O(st,{name:"位置"},{default:q(()=>[F("div",Cc,[F("div",wc,[i[8]||(i[8]=F("span",null,"X",-1)),O(s,{class:"flex-1",controlsPosition:"right",modelValue:P(n).centerX,"onUpdate:modelValue":i[0]||(i[0]=d=>P(n).centerX=d)},null,8,["modelValue"])]),F("div",Ec,[i[9]||(i[9]=F("span",null,"Y",-1)),O(s,{controlsPosition:"right",modelValue:P(n).centerY,"onUpdate:modelValue":i[1]||(i[1]=d=>P(n).centerY=d)},null,8,["modelValue"])])])]),_:1}),O(st,{name:"缩放"},{default:q(()=>[F("div",Dc,[O(l,{min:1,max:200,step:1,modelValue:P(n).scale,"onUpdate:modelValue":i[2]||(i[2]=d=>P(n).scale=d)},null,8,["modelValue"]),F("div",Mc,pt(P(n).scale)+" %",1)])]),_:1}),O(st,{name:"内容"},{default:q(()=>[O(u,{modelValue:P(n).text,"onUpdate:modelValue":i[3]||(i[3]=d=>P(n).text=d),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1}),F("div",kc,[O(st,{name:"字号"},{default:q(()=>[O(s,{class:"w-[90%]",controlsPosition:"right",modelValue:P(n).fontSize,"onUpdate:modelValue":i[4]||(i[4]=d=>P(n).fontSize=d)},null,8,["modelValue"])]),_:1}),O(st,{name:"背景"},{default:q(()=>[O(cn,{modelValue:P(n).textBackgroundColor,"onUpdate:modelValue":i[5]||(i[5]=d=>P(n).textBackgroundColor=d)},null,8,["modelValue"])]),_:1})]),F("div",Tc,[O(st,{name:"字体颜色"},{default:q(()=>[O(cn,{modelValue:P(n).fill,"onUpdate:modelValue":i[6]||(i[6]=d=>P(n).fill=d)},null,8,["modelValue"])]),_:1}),O(st,{name:"描边颜色"},{default:q(()=>[O(cn,{modelValue:P(n).stroke,"onUpdate:modelValue":i[7]||(i[7]=d=>P(n).stroke=d)},null,8,["modelValue"])]),_:1})])])),[[c,P(t)]])}}}),Ic={class:"text-[12px] leading-5 flex flex-col gap-5"},Pc={class:"flex"},Oc={class:"flex"},Bc={class:"w-full grid grid-cols-2 gap-4"},zc={class:"flex flex-1 gap-2 items-center"},Ac={class:"flex flex-1 gap-2 items-center"},Lc={class:"flex items-center gap-2"},Gc={class:"flex-shrink-0"},Fc=xt({__name:"VideoAttr",setup(e){const t=Gt(),r=dt(()=>t.selectResource),n=async()=>{r.value.loading=!0;const a=r.value,i=await jl({prompt:r.value.source.meta.prompt,sizeStr:"",style:""}),o=await t.createTrack(i,a.start);o.end>a.end&&(o.offsetR=o.end-a.end,o.end=a.end),t.selectTrackById(a.id);const{line:s,index:l}=t.selectTrackItem;t.trackList[s].list.splice(l,1,o)};return(a,i)=>{const o=kn,s=wn,l=Or,u=En,c=Xa,d=Pr;return ue((H(),K("div",Ic,[O(st,{name:"名称",nowrap:""},{default:q(()=>[kt(pt(P(r).name),1)]),_:1}),F("div",Pc,[O(st,{name:"初始时间"},{default:q(()=>[kt(pt(P(r).source.duration.toFixed(2))+" s ",1)]),_:1}),O(st,{name:"当前时间"},{default:q(()=>[kt(pt(((P(r).end-P(r).start)/P(jt)).toFixed(2))+" s ",1)]),_:1})]),F("div",Oc,[O(st,{name:"类型"},{default:q(()=>[O(o,{size:"small"},{default:q(()=>[kt(pt(P(r).type),1)]),_:1})]),_:1}),O(st,{name:"分辨率"},{default:q(()=>[kt(pt(P(r).source.width)+" × "+pt(P(r).source.height),1)]),_:1})]),O(st,{name:"位置"},{default:q(()=>[F("div",Bc,[F("div",zc,[i[4]||(i[4]=F("span",null,"X",-1)),O(s,{class:"flex-1",controlsPosition:"right",modelValue:P(r).centerX,"onUpdate:modelValue":i[0]||(i[0]=f=>P(r).centerX=f)},null,8,["modelValue"])]),F("div",Ac,[i[5]||(i[5]=F("span",null,"Y",-1)),O(s,{controlsPosition:"right",modelValue:P(r).centerY,"onUpdate:modelValue":i[1]||(i[1]=f=>P(r).centerY=f)},null,8,["modelValue"])])])]),_:1}),O(st,{name:"缩放"},{default:q(()=>[F("div",Lc,[O(l,{min:1,max:200,step:1,modelValue:P(r).scale,"onUpdate:modelValue":i[2]||(i[2]=f=>P(r).scale=f)},null,8,["modelValue"]),F("div",Gc,pt(P(r).scale)+" %",1)])]),_:1}),O(st,{name:"描述"},{default:q(()=>[O(u,{modelValue:P(r).source.meta.prompt,"onUpdate:modelValue":i[3]||(i[3]=f=>P(r).source.meta.prompt=f),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1}),P(r).source.meta.model!=="upload"?(H(),Pt(st,{key:0,name:"操作"},{default:q(()=>[O(c,{type:"primary",onClick:n},{default:q(()=>i[6]||(i[6]=[kt("重新生成")])),_:1})]),_:1})):Wt("",!0)])),[[d,P(r).loading]])}}}),Nc={class:"text-[12px] leading-5 flex flex-col gap-5"},$c={class:"flex"},Vc={class:"w-full grid grid-cols-2 gap-4"},Wc={class:"flex flex-1 gap-2 items-center"},Xc={class:"flex flex-1 gap-2 items-center"},Hc={class:"flex items-center gap-2"},Yc={class:"flex-shrink-0"},jc=xt({__name:"ImageAttr",setup(e){const t=Gt(),r=dt(()=>t.selectResource),n=async()=>{const i=r.value;r.value.loading=!0;const o=i.source.meta,s=await Ul({...o,samples:1}),l=await t.createTrack(s[0],i.start);l.end>i.end&&(l.offsetR=l.end-i.end,l.end=i.end),t.selectTrackById(i.id);const{line:u,index:c}=t.selectTrackItem;t.trackList[u].list.splice(c,1,l)},a=async()=>{const i=r.value;r.value.loading=!0;const o=i.source.meta,s=await ql({prompt:o.prompt,imageUrl:i.source.url}),l=await t.createTrack(s,i.start);l.end>i.end&&(l.offsetR=l.end-i.end,l.end=i.end),t.selectTrackById(i.id);const{line:u,index:c}=t.selectTrackItem;t.trackList[u].list.splice(c,1,l)};return(i,o)=>{const s=kn,l=wn,u=Or,c=En,d=Xa,f=Pr;return ue((H(),K("div",Nc,[O(st,{name:"名称",nowrap:""},{default:q(()=>[kt(pt(P(r).name),1)]),_:1}),O(st,{name:"时长"},{default:q(()=>[kt(pt(((P(r).end-P(r).start)/P(jt)).toFixed(2))+" s ",1)]),_:1}),F("div",$c,[O(st,{name:"类型"},{default:q(()=>[O(s,{size:"small"},{default:q(()=>[kt(pt(P(r).type),1)]),_:1})]),_:1}),O(st,{name:"分辨率"},{default:q(()=>[kt(pt(P(r).source.width)+" × "+pt(P(r).source.height),1)]),_:1})]),O(st,{name:"位置"},{default:q(()=>[F("div",Vc,[F("div",Wc,[o[4]||(o[4]=F("span",null,"X",-1)),O(l,{class:"flex-1",controlsPosition:"right",modelValue:P(r).centerX,"onUpdate:modelValue":o[0]||(o[0]=p=>P(r).centerX=p)},null,8,["modelValue"])]),F("div",Xc,[o[5]||(o[5]=F("span",null,"Y",-1)),O(l,{controlsPosition:"right",modelValue:P(r).centerY,"onUpdate:modelValue":o[1]||(o[1]=p=>P(r).centerY=p)},null,8,["modelValue"])])])]),_:1}),O(st,{name:"缩放"},{default:q(()=>[F("div",Hc,[O(u,{min:1,max:200,step:1,modelValue:P(r).scale,"onUpdate:modelValue":o[2]||(o[2]=p=>P(r).scale=p)},null,8,["modelValue"]),F("div",Yc,pt(P(r).scale)+" %",1)])]),_:1}),O(st,{name:"描述"},{default:q(()=>[O(c,{modelValue:P(r).source.meta.prompt,"onUpdate:modelValue":o[3]||(o[3]=p=>P(r).source.meta.prompt=p),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1}),P(r).source.meta.model!=="upload"?(H(),Pt(st,{key:0,name:"操作"},{default:q(()=>[O(d,{type:"primary",onClick:n},{default:q(()=>o[6]||(o[6]=[kt("重新生成")])),_:1}),O(d,{type:"primary",onClick:a},{default:q(()=>o[7]||(o[7]=[kt("图生视频")])),_:1})]),_:1})):Wt("",!0)])),[[f,P(r).loading]])}}}),Uc={class:"text-[12px] leading-5 flex flex-col gap-5"},qc={class:"flex"},Kc={class:"flex items-center gap-4"},Zc={class:"flex-shrink-0"},Jc={class:"flex"},Qc={class:"flex"},tf={class:"flex"},ef=xt({__name:"AudioAttr",setup(e){const t=oe(),r=Gt(),n=dt(()=>r.selectResource),a=async()=>{const i=n.value;n.value.loading=!0;let o;n.value.source.type==="music"?o=await Jl(i.source.meta):o=await Ql(i.source.meta);const s=await r.createTrack(o,i.start);s.end>i.end&&(s.offsetR=s.end-i.end,s.end=i.end),r.selectTrackById(i.id);const{line:l,index:u}=r.selectTrackItem;r.trackList[l].list.splice(u,1,s)};return Jt(()=>n.value.volume,ca(()=>{t.isPause=!0,Kl.updateVolume(n.value,n.value.volume)},100)),Jt(()=>n.value.subtitle,ca(()=>{Zl.refresh(n.value)},100),{deep:!0}),(i,o)=>{const s=kn,l=Or,u=tu,c=wn,d=cn,f=En,p=Xa,v=Pr;return ue((H(),K("div",Uc,[O(st,{name:"名称",nowrap:""},{default:q(()=>[kt(pt(P(n).name),1)]),_:1}),F("div",qc,[O(st,{name:"初始时间"},{default:q(()=>[kt(pt(P(n).source.duration.toFixed(2))+" s ",1)]),_:1}),O(st,{name:"当前时间"},{default:q(()=>[kt(pt(((P(n).end-P(n).start)/P(jt)).toFixed(2))+" s ",1)]),_:1})]),O(st,{name:"类型"},{default:q(()=>[O(s,{size:"small"},{default:q(()=>[kt(pt(P(n).source.type),1)]),_:1})]),_:1}),O(st,{name:"音量"},{default:q(()=>[F("div",Kc,[O(l,{min:0,max:1,step:.1,modelValue:P(n).volume,"onUpdate:modelValue":o[0]||(o[0]=h=>P(n).volume=h)},null,8,["modelValue"]),F("div",Zc,pt(P(n).volume),1)])]),_:1}),F("div",Jc,[O(st,{name:"静音"},{default:q(()=>[O(u,{modelValue:P(n).mute,"onUpdate:modelValue":o[1]||(o[1]=h=>P(n).mute=h)},null,8,["modelValue"])]),_:1}),P(n).source.type==="speech"?(H(),Pt(st,{key:0,name:"字幕"},{default:q(()=>[O(u,{modelValue:P(n).drawSub,"onUpdate:modelValue":o[2]||(o[2]=h=>P(n).drawSub=h)},null,8,["modelValue"])]),_:1})):Wt("",!0)]),P(n).source.type==="speech"&&P(n).drawSub?(H(),K(ve,{key:0},[F("div",Qc,[O(st,{name:"字号"},{default:q(()=>[O(c,{class:"w-[90%]",modelValue:P(n).subtitle.fontSize,"onUpdate:modelValue":o[3]||(o[3]=h=>P(n).subtitle.fontSize=h)},null,8,["modelValue"])]),_:1}),O(st,{name:"描边"},{default:q(()=>[O(c,{class:"w-[90%]",modelValue:P(n).subtitle.strokeSize,"onUpdate:modelValue":o[4]||(o[4]=h=>P(n).subtitle.strokeSize=h)},null,8,["modelValue"])]),_:1})]),F("div",tf,[O(st,{name:"字体颜色"},{default:q(()=>[O(d,{modelValue:P(n).subtitle.fontColor,"onUpdate:modelValue":o[5]||(o[5]=h=>P(n).subtitle.fontColor=h)},null,8,["modelValue"])]),_:1}),O(st,{name:"描边颜色"},{default:q(()=>[O(d,{modelValue:P(n).subtitle.strokeColor,"onUpdate:modelValue":o[6]||(o[6]=h=>P(n).subtitle.strokeColor=h)},null,8,["modelValue"])]),_:1})]),O(st,{name:"字体位置"},{default:q(()=>[O(c,{modelValue:P(n).subtitle.bottomOffset,"onUpdate:modelValue":o[7]||(o[7]=h=>P(n).subtitle.bottomOffset=h)},null,8,["modelValue"])]),_:1})],64)):Wt("",!0),O(st,{name:"描述"},{default:q(()=>[O(f,{modelValue:P(n).source.meta.prompt,"onUpdate:modelValue":o[8]||(o[8]=h=>P(n).source.meta.prompt=h),type:"textarea",autosize:{minRows:1,maxRows:6},resize:"none"},null,8,["modelValue"])]),_:1}),P(n).source.meta.model!=="upload"?(H(),Pt(st,{key:1,name:"操作"},{default:q(()=>[O(p,{type:"primary",onClick:a},{default:q(()=>o[9]||(o[9]=[kt("重新生成")])),_:1})]),_:1})):Wt("",!0)])),[[v,P(n).loading]])}}}),rf={key:0,class:"w-full h-full flex flex-col justify-center items-center"},nf={key:1,class:"absolute top-0 left-3 right-2 bottom-0 pr-2 overflow-auto"},af=xt({__name:"AttributeContainer",setup(e){const t=sr(),r=Gt(),n=dt(()=>({width:`${t.attrWidth}px`})),a={},i=Object.assign({});for(const s in i){const l=s.match(new RegExp("(?<=\\/)(\\w+)(?=\\.ts)"))||[];a[l[0]]=i[s].Options}dt(()=>{const s=r.selectResource&&a[r.selectResource.type];return s?s.attributes:[]});const o=dt(()=>r.selectResource);return(s,l)=>{const u=xu,c=Rc,d=Go,f=Fo;return H(),K("div",{class:"select-none relative pl-2 dark:bg-night bg-gray-100",style:Et(P(n))},[P(o)?(H(),K("div",nf,[O(f,null,{default:q(()=>[O(d,{label:"基本信息"},{default:q(()=>[P(o).type==="video"?(H(),Pt(Fc,{key:0})):P(o).type==="image"?(H(),Pt(jc,{key:1})):P(o).type==="audio"?(H(),Pt(ef,{key:2})):P(o).type==="text"?(H(),Pt(c,{key:3})):Wt("",!0)]),_:1})]),_:1})])):(H(),K("div",rf,[O(u,{description:"点击轨道进行编辑"})]))],4)}}});function of(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map(function(n){return n.split(" ").map(function(a){return a?""+e+a:""}).join(" ")}).join(" ")}function sf(e,t){return t.replace(/([^}{]*){/gm,function(r,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+e+"$1")+"{"})}function ge(e,t){return function(r){r&&(e[t]=r)}}function qo(e,t,r){return function(n){n&&(e[t][r]=n)}}function Hi(e,t){return function(r){var n=r.prototype;e.forEach(function(a){t(n,a)})}}function lf(e,t){return t===void 0&&(t={}),function(r,n){e.forEach(function(a){var i=t[a]||a;i in r||(r[i]=function(){for(var o,s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];var u=(o=this[n])[a].apply(o,s);return u===this[n]?this:u})})}}var uf=function(){function e(){this.keys=[],this.values=[]}var t=e.prototype;return t.get=function(r){return this.values[this.keys.indexOf(r)]},t.set=function(r,n){var a=this.keys,i=this.values,o=a.indexOf(r),s=o===-1?a.length:o;a[s]=r,i[s]=n},e}(),cf=function(){function e(){this.object={}}var t=e.prototype;return t.get=function(r){return this.object[r]},t.set=function(r,n){this.object[r]=n},e}(),ff=typeof Map=="function",df=function(){function e(){}var t=e.prototype;return t.connect=function(r,n){this.prev=r,this.next=n,r&&(r.next=this),n&&(n.prev=this)},t.disconnect=function(){var r=this.prev,n=this.next;r&&(r.next=n),n&&(n.prev=r)},t.getIndex=function(){for(var r=this,n=-1;r;)r=r.prev,++n;return n},e}();function pf(e,t){var r=[],n=[];return e.forEach(function(a){var i=a[0],o=a[1],s=new df;r[i]=s,n[o]=s}),r.forEach(function(a,i){a.connect(r[i-1])}),e.filter(function(a,i){return!t[i]}).map(function(a,i){var o=a[0],s=a[1];if(o===s)return[0,0];var l=r[o],u=n[s-1],c=l.getIndex();l.disconnect(),u?l.connect(u,u.next):l.connect(void 0,r[0]);var d=l.getIndex();return[c,d]})}var vf=function(){function e(r,n,a,i,o,s,l,u){this.prevList=r,this.list=n,this.added=a,this.removed=i,this.changed=o,this.maintained=s,this.changedBeforeAdded=l,this.fixed=u}var t=e.prototype;return Object.defineProperty(t,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),t.caculateOrdered=function(){var r=pf(this.changedBeforeAdded,this.fixed),n=this.changed,a=[];this.cacheOrdered=r.filter(function(i,o){var s=i[0],l=i[1],u=n[o],c=u[0],d=u[1];if(s!==l)return a.push([c,d]),!0}),this.cachePureChanged=a},e}();function zr(e,t,r){var n=ff?Map:r?cf:uf,a=r||function(b){return b},i=[],o=[],s=[],l=e.map(a),u=t.map(a),c=new n,d=new n,f=[],p=[],v={},h=[],g=0,m=0;return l.forEach(function(b,x){c.set(b,x)}),u.forEach(function(b,x){d.set(b,x)}),l.forEach(function(b,x){var _=d.get(b);typeof _>"u"?(++m,o.push(x)):v[_]=m}),u.forEach(function(b,x){var _=c.get(b);typeof _>"u"?(i.push(x),++g):(s.push([_,x]),m=v[x]||0,f.push([_-m,x-g]),p.push(x===_),_!==x&&h.push([_,x]))}),o.reverse(),new vf(e,t,i,o,h,s,f,p)}var hf=function(){function e(r,n){r===void 0&&(r=[]),this.findKeyCallback=n,this.list=[].slice.call(r)}var t=e.prototype;return t.update=function(r){var n=[].slice.call(r),a=zr(this.list,n,this.findKeyCallback);return this.list=n,a},e}(),gf="function",mf="object",bf="string",xf="number",qa="undefined",Ko=typeof window!==qa,_f=typeof document!==qa&&document,yf=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],It=1e-7,jr={cm:function(e){return e*96/2.54},mm:function(e){return e*96/254},in:function(e){return e*96},pt:function(e){return e*96/72},pc:function(e){return e*96/6},"%":function(e,t){return e*t/100},vw:function(e,t){return t===void 0&&(t=window.innerWidth),e/100*t},vh:function(e,t){return t===void 0&&(t=window.innerHeight),e/100*t},vmax:function(e,t){return t===void 0&&(t=Math.max(window.innerWidth,window.innerHeight)),e/100*t},vmin:function(e,t){return t===void 0&&(t=Math.min(window.innerWidth,window.innerHeight)),e/100*t}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Sf(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}function Ge(e,t,r,n){return(e*n+t*r)/(r+n)}function Ar(e){return typeof e===qa}function he(e){return e&&typeof e===mf}function Ot(e){return Array.isArray(e)}function ne(e){return typeof e===bf}function fa(e){return typeof e===xf}function Ka(e){return typeof e===gf}function Cf(e,t){var r=e===""||e==" ",n=t===""||t==" ";return n&&r||e===t}function Zo(e,t,r,n,a){var i=Za(e,t,r);return i?r:wf(e,t,r+1,n,a)}function Za(e,t,r){if(!e.ignore)return null;var n=t.slice(Math.max(r-3,0),r+3).join("");return new RegExp(e.ignore).exec(n)}function wf(e,t,r,n,a){for(var i=function(u){var c=t[u].trim();if(c===e.close&&!Za(e,t,u))return{value:u};var d=u,f=Ce(a,function(p){var v=p.open;return v===c});if(f&&(d=Zo(f,t,u,n,a)),d===-1)return o=u,"break";u=d,o=u},o,s=r;s<n;++s){var l=i(s);if(s=o,typeof l=="object")return l.value;if(l==="break")break}return-1}function Ja(e,t){var r=ne(t)?{separator:t}:t,n=r.separator,a=n===void 0?",":n,i=r.isSeparateFirst,o=r.isSeparateOnlyOpenClose,s=r.isSeparateOpenClose,l=s===void 0?o:s,u=r.openCloseCharacters,c=u===void 0?yf:u,d=c.map(function(C){var M=C.open,E=C.close;return M===E?M:M+"|"+E}).join("|"),f="(\\s*"+a+"\\s*|"+d+"|\\s+)",p=new RegExp(f,"g"),v=e.split(p).filter(function(C){return C&&C!=="undefined"}),h=v.length,g=[],m=[];function b(){return m.length?(g.push(m.join("")),m=[],!0):!1}for(var x=function(C){var M=v[C].trim(),E=C,w=Ce(c,function(R){var I=R.open;return I===M}),T=Ce(c,function(R){var I=R.close;return I===M});if(w){if(E=Zo(w,v,C,h,c),E!==-1&&l)return b()&&i||(g.push(v.slice(C,E+1).join("")),C=E,i)?(_=C,"break"):(_=C,"continue")}else if(T&&!Za(T,v,C)){var D=Sf(c);return D.splice(c.indexOf(T),1),{value:Ja(e,{separator:a,isSeparateFirst:i,isSeparateOnlyOpenClose:o,isSeparateOpenClose:l,openCloseCharacters:D})}}else if(Cf(M,a)&&!o)return b(),i?(_=C,"break"):(_=C,"continue");E===-1&&(E=h-1),m.push(v.slice(C,E+1).join("")),C=E,_=C},_,S=0;S<h;++S){var y=x(S);if(S=_,typeof y=="object")return y.value;if(y==="break")break}return m.length&&g.push(m.join("")),g}function Pe(e){return Ja(e,"")}function We(e){return Ja(e,",")}function Jo(e){var t=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(e);return!t||t.length<4?{}:{prefix:t[1],value:t[2],suffix:t[3]}}function Lr(e){var t=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(e);if(!t)return{prefix:"",unit:"",value:NaN};var r=t[1],n=t[2],a=t[3];return{prefix:r,unit:a,value:parseFloat(n)}}function Ef(e){return e.replace(/[\s-_]+([^\s-_])/g,function(t,r){return r.toUpperCase()})}function fn(e,t){return e.replace(/([a-z])([A-Z])/g,function(r,n,a){return""+n+t+a.toLowerCase()})}function Er(){return Date.now?Date.now():new Date().getTime()}function Se(e,t,r){r===void 0&&(r=-1);for(var n=e.length,a=0;a<n;++a)if(t(e[a],a,e))return a;return r}function Ce(e,t,r){var n=Se(e,t);return n>-1?e[n]:r}var Qo=function(){var e=Er(),t=Ko&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return t?t.bind(window):function(r){var n=Er(),a=setTimeout(function(){r(n-e)},1e3/60);return a}}(),Df=function(){var e=Ko&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return e?e.bind(window):function(t){clearTimeout(t)}}();function pr(e){return Object.keys(e)}function yt(e,t){var r=Lr(e),n=r.value,a=r.unit;if(he(t)){var i=t[a];if(i){if(Ka(i))return i(n);if(jr[a])return jr[a](n,i)}}else if(a==="%")return n*t/100;return jr[a]?jr[a](n):n}function da(e,t,r){return Math.max(t,Math.min(e,r))}function Yi(e,t,r,n){return n===void 0&&(n=e[0]/e[1]),[[it(t[0],It),it(t[0]/n,It)],[it(t[1]*n,It),it(t[1],It)]].filter(function(a){return a.every(function(i,o){var s=t[o],l=it(s,It);return r?i<=s||i<=l:i>=s||i>=l})})[0]||e}function Mf(e,t,r,n){if(!n)return e.map(function(p,v){return da(p,t[v],r[v])});var a=e[0],i=e[1],o=n===!0?a/i:n,s=Yi(e,t,!1,o),l=s[0],u=s[1],c=Yi(e,r,!0,o),d=c[0],f=c[1];return a<l||i<u?(a=l,i=u):(a>d||i>f)&&(a=d,i=f),[a,i]}function kf(e){for(var t=e.length,r=0,n=t-1;n>=0;--n)r+=e[n];return r}function pa(e){for(var t=e.length,r=0,n=t-1;n>=0;--n)r+=e[n];return t?r/t:0}function Mt(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=Math.atan2(n,r);return a>=0?a:a+Math.PI*2}function Tf(e){return[0,1].map(function(t){return pa(e.map(function(r){return r[t]}))})}function va(e){var t=Tf(e),r=Mt(t,e[0]),n=Mt(t,e[1]);return r<n&&n-r<Math.PI||r>n&&n-r<-Math.PI?1:-1}function fe(e,t){return Math.sqrt(Math.pow((t?t[0]:0)-e[0],2)+Math.pow((t?t[1]:0)-e[1],2))}function it(e,t){if(!t)return e;var r=1/t;return Math.round(e/t)/r}function ji(e,t){return e.forEach(function(r,n){e[n]=it(e[n],t)}),e}function At(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function ts(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function es(e,t){if(e.classList)e.classList.remove(t);else{var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ")}}function Vt(e,t,r,n){e.addEventListener(t,r,n)}function Nt(e,t,r,n){e.removeEventListener(t,r,n)}function Rf(e){return(e==null?void 0:e.ownerDocument)||_f}function Jn(e){var t;return((t=e==null?void 0:e.ownerDocument)===null||t===void 0?void 0:t.defaultView)||window}function If(e){return e&&"postMessage"in e&&"blur"in e&&"self"in e}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var ha=function(e,t){return ha=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},ha(e,t)};function Ue(e,t){ha(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Re=function(){return Re=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Re.apply(this,arguments)};function rs(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Pf(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}function ga(e,t){if(e===t)return!1;for(var r in e)if(!(r in t))return!0;for(var r in t)if(e[r]!==t[r])return!0;return!1}function Qa(e,t){var r=Object.keys(e),n=Object.keys(t),a=zr(r,n,function(l){return l}),i={},o={},s={};return a.added.forEach(function(l){var u=n[l];i[u]=t[u]}),a.removed.forEach(function(l){var u=r[l];o[u]=e[u]}),a.maintained.forEach(function(l){var u=l[0],c=r[u],d=[e[c],t[c]];e[c]!==t[c]&&(s[c]=d)}),{added:i,removed:o,changed:s}}function ns(e){e.forEach(function(t){t()})}function Ui(e){var t=0;return e.map(function(r){return r==null?"$compat"+ ++t:""+r})}function qi(e,t,r,n){if(ne(e)||fa(e))return new Af("text_"+e,t,r,n,null,{});var a=typeof e.type=="string"?Lf:e.type.prototype.render?Ff:Gf;return new a(e.type,t,r,n,e.ref,e.props)}function as(e){var t=[];return e.forEach(function(r){t=t.concat(Ot(r)?as(r):r)}),t}function Ki(e){var t=e.className,r=rs(e,["className"]);return t!=null&&(r.class=t),delete r.style,delete r.children,r}function Qn(e,t){if(!t)return e;for(var r in t)Ar(e[r])&&(e[r]=t[r]);return e}function se(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=t||{},i=a.key,o=a.ref,s=rs(a,["key","ref"]);return{type:e,key:i,ref:o,props:Re(Re({},s),{children:as(r).filter(function(l){return l!=null&&l!==!1})})}}var Gr=function(){function e(r,n,a,i,o,s){s===void 0&&(s={}),this.type=r,this.key=n,this.index=a,this.container=i,this.ref=o,this.props=s,this._providers=[]}var t=e.prototype;return t._should=function(r,n){return!0},t._update=function(r,n,a,i){if(this.base&&!ne(n)&&!i&&!this._should(n.props,a))return!1;this.original=n,this._setState(a);var o=this.props;return ne(n)||(this.props=n.props,this.ref=n.ref),this._render(r,this.base?o:{},a),!0},t._mounted=function(){var r=this.ref;r&&r(this.base)},t._setState=function(r){},t._updated=function(){var r=this.ref;r&&r(this.base)},t._destroy=function(){var r=this.ref;r&&r(null)},e}();function Of(e,t,r){var n=Qa(e,t),a=n.added,i=n.removed,o=n.changed;for(var s in a)r.setAttribute(s,a[s]);for(var s in o)r.setAttribute(s,o[s][1]);for(var s in i)r.removeAttribute(s)}function Bf(e,t,r){var n=Qa(e,t),a=n.added,i=n.removed,o=n.changed;for(var s in i)r.removeEventListener(s);for(var s in a)r.addEventListener(s,a[s]);for(var s in o)r.removeEventListener(s),r.addEventListener(s,o[s][1]);for(var s in i)r.removeEventListener(s)}function zf(e,t,r){var n=r.style,a=Qa(e,t),i=a.added,o=a.removed,s=a.changed;for(var l in i){var u=fn(l,"-");n.setProperty?n.setProperty(u,i[l]):n[u]=i[l]}for(var l in s){var u=fn(l,"-");n.setProperty?n.setProperty(u,s[l][1]):n[u]=s[l][1]}for(var l in o){var u=fn(l,"-");n.removeProperty?n.removeProperty(u):n[u]=""}}function Zi(e){var t={},r={};for(var n in e)n.indexOf("on")===0?r[n.replace("on","").toLowerCase()]=e[n]:t[n]=e[n];return{attributes:t,events:r}}var Af=function(e){Ue(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r._render=function(n){var a=this,i=!this.base;return i&&(this.base=document.createTextNode(this.type.replace("text_",""))),n.push(function(){i?a._mounted():a._updated()}),!0},r._unmount=function(){this.base.parentNode.removeChild(this.base)},t}(Gr),Lf=function(e){Ue(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.events={},n._isSVG=!1,n}var r=t.prototype;return r.addEventListener=function(n,a){var i=this.events;i[n]=function(o){o.nativeEvent=o,a(o)},this.base.addEventListener(n,i[n])},r.removeEventListener=function(n){var a=this.events;this.base.removeEventListener(n,a[n]),delete a[n]},r._should=function(n){return ga(this.props,n)},r._render=function(n,a){var i=this,o=!this.base;if(o){var s=this._hasSVG();this._isSVG=s;var l=this.props.portalContainer;if(!l){var u=this.type;s?l=document.createElementNS("http://www.w3.org/2000/svg",u):l=document.createElement(u)}this.base=l}Fr(this,this._providers,this.props.children,n,null);var c=this.base,d=Zi(a),f=d.attributes,p=d.events,v=Zi(this.props),h=v.attributes,g=v.events;return Of(Ki(f),Ki(h),c),Bf(p,g,this),zf(a.style||{},this.props.style||{},c),n.push(function(){o?i._mounted():i._updated()}),!0},r._unmount=function(){var n=this.events,a=this.base;for(var i in n)a.removeEventListener(i,n[i]);this._providers.forEach(function(o){o._unmount()}),this.events={},this.props.portalContainer||a.parentNode.removeChild(a)},r._hasSVG=function(){if(this._isSVG||this.type==="svg")return!0;var n=ti(this.container);return n&&"ownerSVGElement"in n},t}(Gr);function ti(e){if(!e)return null;var t=e.base;return t instanceof Node?t:ti(e.container)}function Dr(e){if(!e)return null;if(e instanceof Node)return e;var t=e.$_provider._providers;return t.length?Dr(t[0].base):null}var Gf=function(e){Ue(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r._render=function(n){var a=this.type(this.props);return Fr(this,this._providers,a?[a]:[],n),!0},r._unmount=function(){this._providers.forEach(function(n){n._unmount()})},t}(Gr),is=function(e){Ue(t,e);function t(n){var a=e.call(this,"container","container",0,null)||this;return a.base=n,a}var r=t.prototype;return r._render=function(){return!0},r._unmount=function(){},t}(Gr),Ff=function(e){Ue(t,e);function t(n,a,i,o,s,l){return l===void 0&&(l={}),e.call(this,n,a,i,o,s,Qn(l,n.defaultProps))||this}var r=t.prototype;return r._should=function(n,a){return this.base.shouldComponentUpdate(Qn(n,this.type.defaultProps),a||this.base.state)},r._render=function(n,a){var i=this;this.props=Qn(this.props,this.type.defaultProps);var o=!this.base;o?(this.base=new this.type(this.props),this.base.$_provider=this):this.base.props=this.props;var s=this.base,l=s.state,u=s.render();u&&u.props&&!u.props.children.length&&(u.props.children=this.props.children),Fr(this,this._providers,u?[u]:[],n),n.push(function(){o?(i._mounted(),s.componentDidMount()):(i._updated(),s.componentDidUpdate(a,l))})},r._setState=function(n){var a=this.base;!a||!n||(a.state=n)},r._unmount=function(){this._providers.forEach(function(n){n._unmount()}),clearTimeout(this.base.$_timer),this.base.componentWillUnmount()},t}(Gr),ei=function(){function e(r){r===void 0&&(r={}),this.props=r,this.state={},this.$_timer=0,this.$_state={}}var t=e.prototype;return t.shouldComponentUpdate=function(r,n){return!0},t.render=function(){return null},t.setState=function(r,n,a){var i=this;this.$_timer||(this.$_state={}),clearTimeout(this.$_timer),this.$_timer=0,this.$_state=Re(Re({},this.$_state),r),a?this.$_setState(n,a):this.$_timer=setTimeout(function(){i.$_timer=0,i.$_setState(n,a)})},t.forceUpdate=function(r){this.setState({},r,!0)},t.componentDidMount=function(){},t.componentDidUpdate=function(r,n){},t.componentWillUnmount=function(){},t.$_setState=function(r,n){var a=[],i=this.$_provider,o=Fr(i.container,[i],[i.original],a,Re(Re({},this.state),this.$_state),n);o&&(r&&a.push(r),ns(a))},e}(),ri=function(e){Ue(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r.shouldComponentUpdate=function(n,a){return ga(this.props,n)||ga(this.state,a)},t}(ei),Nf=function(e){Ue(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var r=t.prototype;return r.componentDidMount=function(){var n=this.props,a=n.element,i=n.container;this._portalProvider=new is(i),dn(a,i,this._portalProvider)},r.componentDidUpdate=function(){var n=this.props,a=n.element,i=n.container;dn(a,i,this._portalProvider)},r.componentWillUnmount=function(){var n=this.props.container;dn(null,n,this._portalProvider),this._portalProvider=null},t}(ri);function $f(e,t,r){var n=[];Fr(e,e._providers,t,n,r),ns(n)}function Vf(e,t){for(var r=e._providers,n=r.length,a=t.index+1;a<n;++a){var i=Dr(r[a].base);if(i)return i}return null}function Wf(e,t,r){var n=r.map(function(l){return ne(l)?null:l.key}),a=Ui(t.map(function(l){return l.key})),i=Ui(n),o=zr(a,i,function(l){return l});o.removed.forEach(function(l){t.splice(l,1)[0]._unmount()}),o.ordered.forEach(function(l){var u=l[0],c=l[1],d=t.splice(u,1)[0];t.splice(c,0,d);var f=Dr(d.base),p=Dr(t[c+1]&&t[c+1].base);f&&f.parentNode.insertBefore(f,p)}),o.added.forEach(function(l){t.splice(l,0,qi(r[l],n[l],l,e))});var s=o.maintained.filter(function(l){l[0];var u=l[1],c=r[u],d=t[u],f=ne(c)?"text_"+c:c.type;return f!==d.type?(d._unmount(),t.splice(u,1,qi(c,n[u],u,e)),!0):(d.index=u,!1)});return Pf(o.added,s.map(function(l){l[0];var u=l[1];return u}))}function Fr(e,t,r,n,a,i){var o=Wf(e,t,r),s=t.filter(function(u,c){return u._update(n,r[c],a,i)}),l=ti(e);return l&&o.reverse().forEach(function(u){var c=t[u],d=Dr(c.base);if(d&&l!==d&&!d.parentNode){var f=Vf(e,c);l.insertBefore(d,f)}}),s.length>0}function dn(e,t,r){r===void 0&&(r=t.__REACT_COMPAT__);var n=!!r;return r||(r=new is(t)),$f(r,e?[e]:[]),n||(t.__REACT_COMPAT__=r),r}function Ji(e,t,r){var n=t.__REACT_COMPAT__;e&&!n&&(t.innerHTML=""),dn(e,t,n)}function Xf(e,t){return se(Nf,{element:e,container:t})}var Hf="simple-1.1.0";function ni(e,t){for(var r=e.length,n=0;n<r;++n)if(t(e[n],n))return!0;return!1}function os(e,t){for(var r=e.length,n=0;n<r;++n)if(t(e[n],n))return e[n];return null}function ss(e){var t=e;if(typeof t>"u"){if(typeof navigator>"u"||!navigator)return"";t=navigator.userAgent||""}return t.toLowerCase()}function ai(e,t){try{return new RegExp(e,"g").exec(t)}catch{return null}}function Yf(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var e=navigator.userAgentData,t=e.brands||e.uaList;return!!(t&&t.length)}function jf(e,t){var r=ai("("+e+")((?:\\/|\\s|:)([0-9|\\.|_]+))",t);return r?r[3]:""}function ma(e){return e.replace(/_/g,".")}function mr(e,t){var r=null,n="-1";return ni(e,function(a){var i=ai("("+a.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",t);return!i||a.brand?!1:(r=a,n=i[3]||"-1",a.versionAlias?n=a.versionAlias:a.versionTest&&(n=jf(a.versionTest.toLowerCase(),t)||n),n=ma(n),!0)}),{preset:r,version:n}}function Ur(e,t){var r={brand:"",version:"-1"};return ni(e,function(n){var a=ls(t,n);return a?(r.brand=n.id,r.version=n.versionAlias||a.version,r.version!=="-1"):!1}),r}function ls(e,t){return os(e,function(r){var n=r.brand;return ai(""+t.test,n.toLowerCase())})}var us=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],cs=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],ba=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],fs=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],ds=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function ps(e){return!!mr(fs,e).preset}function Uf(e){var t=ss(e),r=!!/mobi/g.exec(t),n={name:"unknown",version:"-1",majorVersion:-1,webview:ps(t),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},a={name:"unknown",version:"-1",majorVersion:-1},i=mr(us,t),o=i.preset,s=i.version,l=mr(ds,t),u=l.preset,c=l.version,d=mr(cs,t);if(n.chromium=!!d.preset,n.chromiumVersion=d.version,!n.chromium){var f=mr(ba,t);n.webkit=!!f.preset,n.webkitVersion=f.version}return u&&(a.name=u.id,a.version=c,a.majorVersion=parseInt(c,10)),o&&(n.name=o.id,n.version=s,n.webview&&a.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:a,isMobile:r,isHints:!1}}function qf(e){var t=navigator.userAgentData,r=(t.uaList||t.brands).slice(),n=t.mobile||!1,a=r[0],i=(t.platform||navigator.platform).toLowerCase(),o={name:a.brand,version:a.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Ur(fs,r).brand||ps(ss())},s={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&ni(ba,function(f){return ls(r,f)});var l=Ur(cs,r);if(o.chromium=!!l.brand,o.chromiumVersion=l.version||"-1",!o.chromium){var u=Ur(ba,r);o.webkit=!!u.brand,o.webkitVersion=u.version||"-1"}var c=os(ds,function(f){return new RegExp(""+f.test,"g").exec(i)});s.name=c?c.id:"";{var d=Ur(us,r);o.name=d.brand||o.name,o.version=d.brand&&e?e.uaFullVersion:d.version}return o.webkit&&(s.name=n?"ios":"mac"),s.name==="ios"&&o.webview&&(o.version="-1"),s.version=ma(s.version),o.version=ma(o.version),s.majorVersion=parseInt(s.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:s,isMobile:n,isHints:!0}}function Kf(e){return Yf()?qf():Uf(e)}function Zf(e,t,r,n,a,i){for(var o=0;o<a;++o){var s=r+o*a,l=n+o*a;e[s]+=e[l]*i,t[s]+=t[l]*i}}function Jf(e,t,r,n,a){for(var i=0;i<a;++i){var o=r+i*a,s=n+i*a,l=e[o],u=t[o];e[o]=e[s],e[s]=l,t[o]=t[s],t[s]=u}}function Qf(e,t,r,n,a){for(var i=0;i<n;++i){var o=r+i*n;e[o]/=a,t[o]/=a}}function vs(e,t,r){for(var n=e.slice(),a=0;a<r;++a)n[a*r+t-1]=0,n[(t-1)*r+a]=0;return n[(t-1)*(r+1)]=1,n}function me(e,t){t===void 0&&(t=Math.sqrt(e.length));for(var r=e.slice(),n=wt(t),a=0;a<t;++a){var i=t*a+a;if(!it(r[i],It)){for(var o=a+1;o<t;++o)if(r[t*a+o]){Jf(r,n,a,o,t);break}}if(!it(r[i],It))return[];Qf(r,n,a,t,r[i]);for(var o=0;o<t;++o){var s=o,l=o+a*t,u=r[l];!it(u,It)||a===o||Zf(r,n,s,a,t,-u)}}return n}function td(e,t){t===void 0&&(t=Math.sqrt(e.length));for(var r=[],n=0;n<t;++n)for(var a=0;a<t;++a)r[a*t+n]=e[t*n+a];return r}function hs(e,t){t===void 0&&(t=Math.sqrt(e.length));for(var r=[],n=e[t*t-1],a=0;a<t-1;++a)r[a]=e[t*(t-1)+a]/n;return r[t-1]=0,r}function ed(e,t){for(var r=wt(t),n=0;n<t-1;++n)r[t*(t-1)+n]=e[n]||0;return r}function He(e,t){for(var r=e.slice(),n=e.length;n<t-1;++n)r[n]=0;return r[t-1]=1,r}function be(e,t,r){if(t===void 0&&(t=Math.sqrt(e.length)),t===r)return e;for(var n=wt(r),a=Math.min(t,r),i=0;i<a-1;++i){for(var o=0;o<a-1;++o)n[i*r+o]=e[i*t+o];n[(i+1)*r-1]=e[(i+1)*t-1],n[(r-1)*r+i]=e[(t-1)*t+i]}return n[r*r-1]=e[t*t-1],n}function xa(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=wt(e);return t.forEach(function(a){n=_t(n,a,e)}),n}function _t(e,t,r){r===void 0&&(r=Math.sqrt(e.length));var n=[],a=e.length/r,i=t.length/a;if(a){if(!i)return e}else return t;for(var o=0;o<r;++o)for(var s=0;s<i;++s){n[s*r+o]=0;for(var l=0;l<a;++l)n[s*r+o]+=e[l*r+o]*t[s*a+l]}return n}function ft(e,t){for(var r=Math.min(e.length,t.length),n=e.slice(),a=0;a<r;++a)n[a]=n[a]+t[a];return n}function et(e,t){for(var r=Math.min(e.length,t.length),n=e.slice(),a=0;a<r;++a)n[a]=n[a]-t[a];return n}function rd(e,t){return t===void 0&&(t=e.length===6),t?[e[0],e[1],0,e[2],e[3],0,e[4],e[5],1]:e}function gs(e,t){return t===void 0&&(t=e.length===9),t?[e[0],e[1],e[3],e[4],e[6],e[7]]:e}function $t(e,t,r){r===void 0&&(r=t.length);var n=_t(e,t,r),a=n[r-1];return n.map(function(i){return i/a})}function nd(e,t){return _t(e,[1,0,0,0,0,Math.cos(t),Math.sin(t),0,0,-Math.sin(t),Math.cos(t),0,0,0,0,1],4)}function ad(e,t){return _t(e,[Math.cos(t),0,-Math.sin(t),0,0,1,0,0,Math.sin(t),0,Math.cos(t),0,0,0,0,1],4)}function id(e,t){return _t(e,nr(t,4))}function qr(e,t){var r=t[0],n=r===void 0?1:r,a=t[1],i=a===void 0?1:a,o=t[2],s=o===void 0?1:o;return _t(e,[n,0,0,0,0,i,0,0,0,0,s,0,0,0,0,1],4)}function Nr(e,t){return $t(nr(t,3),He(e,3))}function ta(e,t){var r=t[0],n=r===void 0?0:r,a=t[1],i=a===void 0?0:a,o=t[2],s=o===void 0?0:o;return _t(e,[1,0,0,0,0,1,0,0,0,0,1,0,n,i,s,1],4)}function Qi(e,t){return _t(e,t,4)}function nr(e,t){var r=Math.cos(e),n=Math.sin(e),a=wt(t);return a[0]=r,a[1]=n,a[t]=-n,a[t+1]=r,a}function wt(e){for(var t=e*e,r=[],n=0;n<t;++n)r[n]=n%(e+1)?0:1;return r}function ii(e,t){for(var r=wt(t),n=Math.min(e.length,t-1),a=0;a<n;++a)r[(t+1)*a]=e[a];return r}function Mr(e,t){for(var r=wt(t),n=Math.min(e.length,t-1),a=0;a<n;++a)r[t*(t-1)+a]=e[a];return r}function oi(e,t,r,n,a,i,o,s){var l=e[0],u=e[1],c=t[0],d=t[1],f=r[0],p=r[1],v=n[0],h=n[1],g=a[0],m=a[1],b=i[0],x=i[1],_=o[0],S=o[1],y=s[0],C=s[1],M=[l,0,c,0,f,0,v,0,u,0,d,0,p,0,h,0,1,0,1,0,1,0,1,0,0,l,0,c,0,f,0,v,0,u,0,d,0,p,0,h,0,1,0,1,0,1,0,1,-g*l,-m*l,-b*c,-x*c,-_*f,-S*f,-y*v,-C*v,-g*u,-m*u,-b*d,-x*d,-_*p,-S*p,-y*h,-C*h],E=me(M,8);if(!E.length)return[];var w=_t(E,[g,m,b,x,_,S,y,C],8);return w[8]=1,be(td(w),3,4)}var yr=function(){return yr=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},yr.apply(this,arguments)};function od(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function si(e,t){return t===void 0&&(t=0),Qe(Fe(e,t))}function sd(e,t){var r=$t(e,[t[0],t[1]||0,t[2]||0,1],4),n=r[3]||1;return[r[0]/n,r[1]/n,r[2]/n]}function Qe(e){var t=od();return e.forEach(function(r){var n=r.matrixFunction,a=r.functionValue;n&&(t=n(t,a))}),t}function Fe(e,t){t===void 0&&(t=0);var r=Ot(e)?e:Pe(e);return r.map(function(n){var a=Jo(n),i=a.prefix,o=a.value,s=null,l=i,u="";if(i==="translate"||i==="translateX"||i==="translate3d"){var c=he(t)?yr(yr({},t),{"o%":t["%"]}):{"%":t,"o%":t},d=We(o).map(function(R,I){return I===0&&"x%"in c?c["%"]=t["x%"]:I===1&&"y%"in c?c["%"]=t["y%"]:c["%"]=t["o%"],yt(R,c)}),f=d[0],p=d[1],v=p===void 0?0:p,h=d[2],g=h===void 0?0:h;s=ta,u=[f,v,g]}else if(i==="translateY"){var m=he(t)?yr({"%":t["y%"]},t):{"%":t},v=yt(o,m);s=ta,u=[0,v,0]}else if(i==="translateZ"){var g=parseFloat(o);s=ta,u=[0,0,g]}else if(i==="scale"||i==="scale3d"){var b=We(o).map(function(R){return parseFloat(R)}),x=b[0],_=b[1],S=_===void 0?x:_,y=b[2],C=y===void 0?1:y;s=qr,u=[x,S,C]}else if(i==="scaleX"){var x=parseFloat(o);s=qr,u=[x,1,1]}else if(i==="scaleY"){var S=parseFloat(o);s=qr,u=[1,S,1]}else if(i==="scaleZ"){var C=parseFloat(o);s=qr,u=[1,1,C]}else if(i==="rotate"||i==="rotateZ"||i==="rotateX"||i==="rotateY"){var M=Lr(o),E=M.unit,w=M.value,T=E==="rad"?w:w*Math.PI/180;i==="rotate"||i==="rotateZ"?(l="rotateZ",s=id):i==="rotateX"?s=nd:i==="rotateY"&&(s=ad),u=T}else if(i==="matrix3d")s=Qi,u=We(o).map(function(R){return parseFloat(R)});else if(i==="matrix"){var D=We(o).map(function(R){return parseFloat(R)});s=Qi,u=[D[0],D[1],0,0,D[2],D[3],0,0,0,0,1,0,D[4],D[5],0,1]}else l="";return{name:i,functionName:l,value:o,matrixFunction:s,functionValue:u}})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var _a=function(e,t){return _a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},_a(e,t)};function ld(e,t){_a(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ms=typeof Map=="function"?void 0:function(){var e=0;return function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++e)}}(),bs=function(e){ld(t,e);function t(r){return r===void 0&&(r=[]),e.call(this,r,ms)||this}return t}(hf);function ud(e,t){return zr(e,t,ms)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function cd(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}function Zt(e){return it(e,It)}function fd(e,t){return e.every(function(r,n){return Zt(r-t[n])===0})}function dd(e,t){return!Zt(e[0]-t[0])&&!Zt(e[1]-t[1])}function xs(e){return e.length<3?0:Math.abs(kf(e.map(function(t,r){var n=e[r+1]||e[0];return t[0]*n[1]-n[0]*t[1]})))/2}function to(e,t){var r=t.width,n=t.height,a=t.left,i=t.top,o=Oe(e),s=o.minX,l=o.minY,u=o.maxX,c=o.maxY,d=r/(u-s),f=n/(c-l);return e.map(function(p){return[a+(p[0]-s)*d,i+(p[1]-l)*f]})}function Oe(e){var t=e.map(function(n){return n[0]}),r=e.map(function(n){return n[1]});return{minX:Math.min.apply(Math,t),minY:Math.min.apply(Math,r),maxX:Math.max.apply(Math,t),maxY:Math.max.apply(Math,r)}}function ya(e,t,r){var n=e[0],a=e[1],i=Oe(t),o=i.minX,s=i.maxX,l=[[o,a],[s,a]],u=hn(l[0],l[1]),c=Sa(t),d=[];if(c.forEach(function(v){var h=hn(v[0],v[1]),g=v[0];if(fd(u,h))d.push({pos:e,line:v,type:"line"});else{var m=_s(li(u,h),[l,v]);m.forEach(function(b){v.some(function(x){return dd(x,b)})?d.push({pos:b,line:v,type:"point"}):Zt(g[1]-a)!==0&&d.push({pos:b,line:v,type:"intersection"})})}}),Ce(d,function(v){return v[0]===n}))return!0;var f=0,p={};return d.forEach(function(v){var h=v.pos,g=v.type,m=v.line;if(!(h[0]>n))if(g==="intersection")++f;else{if(g==="line")return;if(g==="point"){var b=Ce(m,function(S){return S[1]!==a}),x=p[h[0]],_=b[1]>a?1:-1;x?x!==_&&++f:p[h[0]]=_}}}),f%2===1}function hn(e,t){var r=e[0],n=e[1],a=t[0],i=t[1],o=a-r,s=i-n;Math.abs(o)<It&&(o=0),Math.abs(s)<It&&(s=0);var l=0,u=0,c=0;return o?s?(l=-s/o,u=1,c=-l*r-n):(u=1,c=-n):s&&(l=-1,c=r),[l,u,c]}function li(e,t){var r=e[0],n=e[1],a=e[2],i=t[0],o=t[1],s=t[2],l=r===0&&i===0,u=n===0&&o===0,c=[];if(l&&u)return[];if(l){var d=-a/n,f=-s/o;return d!==f?[]:[[-1/0,d],[1/0,d]]}else if(u){var p=-a/r,v=-s/i;return p!==v?[]:[[p,-1/0],[p,1/0]]}else if(r===0){var h=-a/n,g=-(o*h+s)/i;c=[[g,h]]}else if(i===0){var h=-s/o,g=-(n*h+a)/r;c=[[g,h]]}else if(n===0){var g=-a/r,h=-(i*g+s)/o;c=[[g,h]]}else if(o===0){var g=-s/i,h=-(r*g+a)/n;c=[[g,h]]}else{var g=(n*s-o*a)/(o*r-n*i),h=-(r*g+a)/n;c=[[g,h]]}return c.map(function(m){return[m[0],m[1]]})}function _s(e,t){var r=t.map(function(d){return[0,1].map(function(f){return[Math.min(d[0][f],d[1][f]),Math.max(d[0][f],d[1][f])]})}),n=[];if(e.length===2){var a=e[0],i=a[0],o=a[1];if(Zt(i-e[1][0])){if(!Zt(o-e[1][1])){var u=Math.max.apply(Math,r.map(function(d){return d[0][0]})),c=Math.min.apply(Math,r.map(function(d){return d[0][1]}));if(Zt(u-c)>0)return[];n=[[u,o],[c,o]]}}else{var s=Math.max.apply(Math,r.map(function(d){return d[1][0]})),l=Math.min.apply(Math,r.map(function(d){return d[1][1]}));if(Zt(s-l)>0)return[];n=[[i,s],[i,l]]}}return n.length||(n=e.filter(function(d){var f=d[0],p=d[1];return r.every(function(v){return 0<=Zt(f-v[0][0])&&0<=Zt(v[0][1]-f)&&0<=Zt(p-v[1][0])&&0<=Zt(v[1][1]-p)})})),n.map(function(d){return[Zt(d[0]),Zt(d[1])]})}function Sa(e){return cd(e.slice(1),[e[0]]).map(function(t,r){return[e[r],t]})}function pd(e,t){var r=e.slice(),n=t.slice();va(r)===-1&&r.reverse(),va(n)===-1&&n.reverse();var a=Sa(r),i=Sa(n),o=a.map(function(c){return hn(c[0],c[1])}),s=i.map(function(c){return hn(c[0],c[1])}),l=[];o.forEach(function(c,d){var f=a[d],p=[];s.forEach(function(v,h){var g=li(c,v),m=_s(g,[f,i[h]]);p.push.apply(p,m.map(function(b){return{index1:d,index2:h,pos:b,type:"intersection"}}))}),p.sort(function(v,h){return fe(f[0],v.pos)-fe(f[0],h.pos)}),l.push.apply(l,p),ya(f[1],n)&&l.push({index1:d,index2:-1,pos:f[1],type:"inside"})}),i.forEach(function(c,d){if(ya(c[1],r)){var f=!1,p=Se(l,function(v){var h=v.index2;return h===d?(f=!0,!1):!!f});p===-1&&(f=!1,p=Se(l,function(v){var h=v.index1,g=v.index2;return h===-1&&g+1===d?(f=!0,!1):!!f})),p===-1?l.push({index1:-1,index2:d,pos:c[1],type:"inside"}):l.splice(p,0,{index1:-1,index2:d,pos:c[1],type:"inside"})}});var u={};return l.filter(function(c){var d=c.pos,f=d[0]+"x"+d[1];return u[f]?!1:(u[f]=!0,!0)})}function vd(e,t){var r=pd(e,t);return r.map(function(n){var a=n.pos;return a})}function hd(e,t){var r=vd(e,t);return xs(r)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ca=function(){return Ca=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ca.apply(this,arguments)};function gd(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}var Bn=function(){function e(){this._events={}}var t=e.prototype;return t.on=function(r,n){if(he(r))for(var a in r)this.on(a,r[a]);else this._addEvent(r,n,{});return this},t.off=function(r,n){if(!r)this._events={};else if(he(r))for(var a in r)this.off(a);else if(!n)this._events[r]=[];else{var i=this._events[r];if(i){var o=Se(i,function(s){return s.listener===n});o>-1&&i.splice(o,1)}}return this},t.once=function(r,n){var a=this;return n&&this._addEvent(r,n,{once:!0}),new Promise(function(i){a._addEvent(r,i,{once:!0})})},t.emit=function(r,n){var a=this;n===void 0&&(n={});var i=this._events[r];if(!r||!i)return!0;var o=!1;return n.eventType=r,n.stop=function(){o=!0},n.currentTarget=this,gd(i).forEach(function(s){s.listener(n),s.once&&a.off(r,s.listener)}),!o},t.trigger=function(r,n){return n===void 0&&(n={}),this.emit(r,n)},t._addEvent=function(r,n,a){var i=this._events;i[r]=i[r]||[];var o=i[r];o.push(Ca({listener:n},a))},e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var wa=function(e,t){return wa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},wa(e,t)};function md(e,t){wa(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var tr=function(){return tr=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},tr.apply(this,arguments)};function bd(e){var t=e.container;return t===document.body?[t.scrollLeft||document.documentElement.scrollLeft,t.scrollTop||document.documentElement.scrollTop]:[t.scrollLeft,t.scrollTop]}function eo(e,t){return e.addEventListener("scroll",t),function(){e.removeEventListener("scroll",t)}}function Kr(e){if(e){if(ne(e))return document.querySelector(e)}else return null;if(Ka(e))return e();if(e instanceof Element)return e;if("current"in e)return e.current;if("value"in e)return e.value}var xd=function(e){md(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._startRect=null,n._startPos=[],n._prevTime=0,n._timer=0,n._prevScrollPos=[0,0],n._isWait=!1,n._flag=!1,n._currentOptions=null,n._lock=!1,n._unregister=null,n._onScroll=function(){var a=n._currentOptions;n._lock||!a||n.emit("scrollDrag",{next:function(i){n.checkScroll({container:a.container,inputEvent:i})}})},n}var r=t.prototype;return r.dragStart=function(n,a){var i=Kr(a.container);if(!i){this._flag=!1;return}var o=0,s=0,l=0,u=0;if(i===document.body)l=window.innerWidth,u=window.innerHeight;else{var c=i.getBoundingClientRect();o=c.top,s=c.left,l=c.width,u=c.height}this._flag=!0,this._startPos=[n.clientX,n.clientY],this._startRect={top:o,left:s,width:l,height:u},this._prevScrollPos=this._getScrollPosition([0,0],a),this._currentOptions=a,this._registerScrollEvent(a)},r.drag=function(n,a){if(clearTimeout(this._timer),!!this._flag){var i=n.clientX,o=n.clientY,s=a.threshold,l=s===void 0?0:s,u=this,c=u._startRect,d=u._startPos;this._currentOptions=a;var f=[0,0];return c.top>o-l?(d[1]>c.top||o<d[1])&&(f[1]=-1):c.top+c.height<o+l&&(d[1]<c.top+c.height||o>d[1])&&(f[1]=1),c.left>i-l?(d[0]>c.left||i<d[0])&&(f[0]=-1):c.left+c.width<i+l&&(d[0]<c.left+c.width||i>d[0])&&(f[0]=1),!f[0]&&!f[1]?!1:this._continueDrag(tr(tr({},a),{direction:f,inputEvent:n,isDrag:!0}))}},r.checkScroll=function(n){var a=this;if(this._isWait)return!1;var i=n.prevScrollPos,o=i===void 0?this._prevScrollPos:i,s=n.direction,l=n.throttleTime,u=l===void 0?0:l,c=n.inputEvent,d=n.isDrag,f=this._getScrollPosition(s||[0,0],n),p=f[0]-o[0],v=f[1]-o[1],h=s||[p?Math.abs(p)/p:0,v?Math.abs(v)/v:0];return this._prevScrollPos=f,this._lock=!1,!p&&!v?!1:(this.emit("move",{offsetX:h[0]?p:0,offsetY:h[1]?v:0,inputEvent:c}),u&&d&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){a._continueDrag(n)},u)),!0)},r.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},r._getScrollPosition=function(n,a){var i=a.container,o=a.getScrollPosition,s=o===void 0?bd:o;return s({container:Kr(i),direction:n})},r._continueDrag=function(n){var a=this,i,o=n.container,s=n.direction,l=n.throttleTime,u=n.useScroll,c=n.isDrag,d=n.inputEvent;if(!(!this._flag||c&&this._isWait)){var f=Er(),p=Math.max(l+this._prevTime-f,0);if(p>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){a._continueDrag(n)},p),!1;this._prevTime=f;var v=this._getScrollPosition(s,n);this._prevScrollPos=v,c&&(this._isWait=!0),u||(this._lock=!0);var h={container:Kr(o),direction:s,inputEvent:d};return(i=n.requestScroll)===null||i===void 0||i.call(n,h),this.emit("scroll",h),this._isWait=!1,u||this.checkScroll(tr(tr({},n),{prevScrollPos:v,direction:s,inputEvent:d}))}},r._registerScrollEvent=function(n){this._unregisterScrollEvent();var a=n.checkScrollEvent;if(a){var i=a===!0?eo:a,o=Kr(n.container);a===!0&&(o===document.body||o===document.documentElement)?this._unregister=eo(window,this._onScroll):this._unregister=i(o,this._onScroll)}},r._unregisterScrollEvent=function(){var n;(n=this._unregister)===null||n===void 0||n.call(this),this._unregister=null},t}(Bn);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ea=function(e,t){return Ea=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},Ea(e,t)};function _d(e,t){Ea(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Rt=function(){return Rt=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Rt.apply(this,arguments)};function yd(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=Math.atan2(n,r);return a>=0?a:a+Math.PI*2}function ea(e){return yd([e[0].clientX,e[0].clientY],[e[1].clientX,e[1].clientY])/Math.PI*180}function Sd(e){return e.touches&&e.touches.length>=2}function Zr(e){return e?e.touches?wd(e.touches):[ys(e)]:[]}function Cd(e){return e&&(e.type.indexOf("mouse")>-1||"button"in e)}function ro(e,t,r){var n=r.length,a=Sr(e,n),i=a.clientX,o=a.clientY,s=a.originalClientX,l=a.originalClientY,u=Sr(t,n),c=u.clientX,d=u.clientY,f=Sr(r,n),p=f.clientX,v=f.clientY,h=i-c,g=o-d,m=i-p,b=o-v;return{clientX:s,clientY:l,deltaX:h,deltaY:g,distX:m,distY:b}}function ra(e){return Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2))}function wd(e){for(var t=Math.min(e.length,2),r=[],n=0;n<t;++n)r.push(ys(e[n]));return r}function ys(e){return{clientX:e.clientX,clientY:e.clientY}}function Sr(e,t){t===void 0&&(t=e.length);for(var r={clientX:0,clientY:0,originalClientX:0,originalClientY:0},n=Math.min(e.length,t),a=0;a<n;++a){var i=e[a];r.originalClientX+="originalClientX"in i?i.originalClientX:i.clientX,r.originalClientY+="originalClientY"in i?i.originalClientY:i.clientY,r.clientX+=i.clientX,r.clientY+=i.clientY}return t?{clientX:r.clientX/t,clientY:r.clientY/t,originalClientX:r.originalClientX/t,originalClientY:r.originalClientY/t}:r}var na=function(){function e(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}return e.prototype.getAngle=function(t){return t===void 0&&(t=this.prevClients),ea(t)},e.prototype.getRotation=function(t){return t===void 0&&(t=this.prevClients),ea(t)-ea(this.startClients)},e.prototype.getPosition=function(t,r){t===void 0&&(t=this.prevClients);var n=ro(t||this.prevClients,this.prevClients,this.startClients),a=n.deltaX,i=n.deltaY;return this.movement+=Math.sqrt(a*a+i*i),this.prevClients=t,n},e.prototype.getPositions=function(t){t===void 0&&(t=this.prevClients);for(var r=this.prevClients,n=this.startClients,a=Math.min(this.length,r.length),i=[],o=0;o<a;++o)i[o]=ro([t[o]],[r[o]],[n[o]]);return i},e.prototype.getMovement=function(t){var r=this.movement;if(!t)return r;var n=Sr(t,this.length),a=Sr(this.prevClients,this.length),i=n.clientX-a.clientX,o=n.clientY-a.clientY;return Math.sqrt(i*i+o*o)+r},e.prototype.getDistance=function(t){return t===void 0&&(t=this.prevClients),ra(t)},e.prototype.getScale=function(t){return t===void 0&&(t=this.prevClients),ra(t)/ra(this.startClients)},e.prototype.move=function(t,r){this.startClients.forEach(function(n){n.clientX-=t,n.clientY-=r}),this.prevClients.forEach(function(n){n.clientX-=t,n.clientY-=r})},e}(),no=["textarea","input"],Ed=function(e){_d(t,e);function t(r,n){n===void 0&&(n={});var a=e.call(this)||this;a.options={},a.flag=!1,a.pinchFlag=!1,a.data={},a.isDrag=!1,a.isPinch=!1,a.clientStores=[],a.targets=[],a.prevTime=0,a.doubleFlag=!1,a._useMouse=!1,a._useTouch=!1,a._useDrag=!1,a._dragFlag=!1,a._isTrusted=!1,a._isMouseEvent=!1,a._isSecondaryButton=!1,a._preventMouseEvent=!1,a._prevInputEvent=null,a._isDragAPI=!1,a._isIdle=!0,a._preventMouseEventId=0,a._window=window,a.onDragStart=function(f,p){if(p===void 0&&(p=!0),!(!a.flag&&f.cancelable===!1)){var v=f.type.indexOf("drag")>=-1;if(!(a.flag&&v)){a._isDragAPI=!0;var h=a.options,g=h.container,m=h.pinchOutside,b=h.preventWheelClick,x=h.preventRightClick,_=h.preventDefault,S=h.checkInput,y=h.dragFocusedInput,C=h.preventClickEventOnDragStart,M=h.preventClickEventOnDrag,E=h.preventClickEventByCondition,w=a._useTouch,T=!a.flag;if(a._isSecondaryButton=f.which===3||f.button===2,b&&(f.which===2||f.button===1)||x&&(f.which===3||f.button===2))return a.stop(),!1;if(T){var D=a._window.document.activeElement,R=f.target;if(R){var I=R.tagName.toLowerCase(),B=no.indexOf(I)>-1,V=R.isContentEditable;if(B||V){if(S||!y&&D===R)return!1;if(D&&(D===R||V&&D.isContentEditable&&D.contains(R)))if(y)R.blur();else return!1}else if((_||f.type==="touchstart")&&D){var j=D.tagName.toLowerCase();(D.isContentEditable||no.indexOf(j)>-1)&&D.blur()}(C||M||E)&&Vt(a._window,"click",a._onClick,!0)}a.clientStores=[new na(Zr(f))],a._isIdle=!1,a.flag=!0,a.isDrag=!1,a._isTrusted=p,a._dragFlag=!0,a._prevInputEvent=f,a.data={},a.doubleFlag=Er()-a.prevTime<200,a._isMouseEvent=Cd(f),!a._isMouseEvent&&a._preventMouseEvent&&a._allowMouseEvent();var W=a._preventMouseEvent||a.emit("dragStart",Rt(Rt({data:a.data,datas:a.data,inputEvent:f,isMouseEvent:a._isMouseEvent,isSecondaryButton:a._isSecondaryButton,isTrusted:p,isDouble:a.doubleFlag},a.getCurrentStore().getPosition()),{preventDefault:function(){f.preventDefault()},preventDrag:function(){a._dragFlag=!1}}));W===!1&&a.stop(),a._isMouseEvent&&a.flag&&_&&f.preventDefault()}if(!a.flag)return!1;var X=0;if(T?(a._attchDragEvent(),w&&m&&(X=setTimeout(function(){Vt(g,"touchstart",a.onDragStart,{passive:!1})}))):w&&m&&Nt(g,"touchstart",a.onDragStart),a.flag&&Sd(f)){if(clearTimeout(X),T&&f.touches.length!==f.changedTouches.length)return;a.pinchFlag||a.onPinchStart(f)}}}},a.onDrag=function(f,p){if(a.flag){var v=a.options.preventDefault;!a._isMouseEvent&&v&&f.preventDefault(),a._prevInputEvent=f;var h=Zr(f),g=a.moveClients(h,f,!1);if(a._dragFlag){if(a.pinchFlag||g.deltaX||g.deltaY){var m=a._preventMouseEvent||a.emit("drag",Rt(Rt({},g),{isScroll:!!p,inputEvent:f}));if(m===!1){a.stop();return}}a.pinchFlag&&a.onPinch(f,h)}a.getCurrentStore().getPosition(h,!0)}},a.onDragEnd=function(f){if(a.flag){var p=a.options,v=p.pinchOutside,h=p.container,g=p.preventClickEventOnDrag,m=p.preventClickEventOnDragStart,b=p.preventClickEventByCondition,x=a.isDrag;(g||m||b)&&requestAnimationFrame(function(){a._allowClickEvent()}),!b&&!m&&g&&!x&&a._allowClickEvent(),a._useTouch&&v&&Nt(h,"touchstart",a.onDragStart),a.pinchFlag&&a.onPinchEnd(f);var _=f!=null&&f.touches?Zr(f):[],S=_.length;S===0||!a.options.keepDragging?a.flag=!1:a._addStore(new na(_));var y=a._getPosition(),C=Er(),M=!x&&a.doubleFlag;a._prevInputEvent=null,a.prevTime=x||M?0:C,a.flag||(a._dettachDragEvent(),a._preventMouseEvent||a.emit("dragEnd",Rt({data:a.data,datas:a.data,isDouble:M,isDrag:x,isClick:!x,isMouseEvent:a._isMouseEvent,isSecondaryButton:a._isSecondaryButton,inputEvent:f,isTrusted:a._isTrusted},y)),a.clientStores=[],a._isMouseEvent||(a._preventMouseEvent=!0,clearTimeout(a._preventMouseEventId),a._preventMouseEventId=setTimeout(function(){a._preventMouseEvent=!1},200)),a._isIdle=!0)}},a.onBlur=function(){a.onDragEnd()},a._allowClickEvent=function(){Nt(a._window,"click",a._onClick,!0)},a._onClick=function(f){a._allowClickEvent(),a._allowMouseEvent();var p=a.options.preventClickEventByCondition;p!=null&&p(f)||(f.stopPropagation(),f.preventDefault())},a._onContextMenu=function(f){var p=a.options;p.preventRightClick?a.onDragEnd(f):f.preventDefault()},a._passCallback=function(){};var i=[].concat(r),o=i[0];a._window=If(o)?o:Jn(o),a.options=Rt({checkInput:!1,container:o&&!("document"in o)?Jn(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var s=a.options,l=s.container,u=s.events,c=s.checkWindowBlur;if(a._useDrag=u.indexOf("drag")>-1,a._useTouch=u.indexOf("touch")>-1,a._useMouse=u.indexOf("mouse")>-1,a.targets=i,a._useDrag&&i.forEach(function(f){Vt(f,"dragstart",a.onDragStart)}),a._useMouse&&(i.forEach(function(f){Vt(f,"mousedown",a.onDragStart),Vt(f,"mousemove",a._passCallback)}),Vt(l,"contextmenu",a._onContextMenu)),c&&Vt(Jn(),"blur",a.onBlur),a._useTouch){var d={passive:!1};i.forEach(function(f){Vt(f,"touchstart",a.onDragStart,d),Vt(f,"touchmove",a._passCallback,d)})}return a}return t.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},t.prototype.getMovement=function(r){return this.getCurrentStore().getMovement(r)+this.clientStores.slice(1).reduce(function(n,a){return n+a.movement},0)},t.prototype.isDragging=function(){return this.isDrag},t.prototype.isIdle=function(){return this._isIdle},t.prototype.isFlag=function(){return this.flag},t.prototype.isPinchFlag=function(){return this.pinchFlag},t.prototype.isDoubleFlag=function(){return this.doubleFlag},t.prototype.isPinching=function(){return this.isPinch},t.prototype.scrollBy=function(r,n,a,i){i===void 0&&(i=!0),this.flag&&(this.clientStores[0].move(r,n),i&&this.onDrag(a,!0))},t.prototype.move=function(r,n){var a=r[0],i=r[1],o=this.getCurrentStore(),s=o.prevClients;return this.moveClients(s.map(function(l){var u=l.clientX,c=l.clientY;return{clientX:u+a,clientY:c+i,originalClientX:u,originalClientY:c}}),n,!0)},t.prototype.triggerDragStart=function(r){this.onDragStart(r,!1)},t.prototype.setEventData=function(r){var n=this.data;for(var a in r)n[a]=r[a];return this},t.prototype.setEventDatas=function(r){return this.setEventData(r)},t.prototype.getCurrentEvent=function(r){return r===void 0&&(r=this._prevInputEvent),Rt(Rt({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:r})},t.prototype.getEventData=function(){return this.data},t.prototype.getEventDatas=function(){return this.data},t.prototype.unset=function(){var r=this,n=this.targets,a=this.options.container;this.off(),Nt(this._window,"blur",this.onBlur),this._useDrag&&n.forEach(function(i){Nt(i,"dragstart",r.onDragStart)}),this._useMouse&&(n.forEach(function(i){Nt(i,"mousedown",r.onDragStart)}),Nt(a,"contextmenu",this._onContextMenu)),this._useTouch&&(n.forEach(function(i){Nt(i,"touchstart",r.onDragStart)}),Nt(a,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},t.prototype.onPinchStart=function(r){var n=this,a=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>a)){var i=new na(Zr(r));this.pinchFlag=!0,this._addStore(i);var o=this.emit("pinchStart",Rt(Rt({data:this.data,datas:this.data,angle:i.getAngle(),touches:this.getCurrentStore().getPositions()},i.getPosition()),{inputEvent:r,isTrusted:this._isTrusted,preventDefault:function(){r.preventDefault()},preventDrag:function(){n._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},t.prototype.onPinch=function(r,n){if(!(!this.flag||!this.pinchFlag||n.length<2)){var a=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Rt(Rt({data:this.data,datas:this.data,movement:this.getMovement(n),angle:a.getAngle(n),rotation:a.getRotation(n),touches:a.getPositions(n),scale:a.getScale(n),distance:a.getDistance(n)},a.getPosition(n)),{inputEvent:r,isTrusted:this._isTrusted}))}},t.prototype.onPinchEnd=function(r){if(this.pinchFlag){var n=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var a=this.getCurrentStore();this.emit("pinchEnd",Rt(Rt({data:this.data,datas:this.data,isPinch:n,touches:a.getPositions()},a.getPosition()),{inputEvent:r}))}},t.prototype.getCurrentStore=function(){return this.clientStores[0]},t.prototype.moveClients=function(r,n,a){var i=this._getPosition(r,a),o=this.isDrag;(i.deltaX||i.deltaY)&&(this.isDrag=!0);var s=!1;return!o&&this.isDrag&&(s=!0),Rt(Rt({data:this.data,datas:this.data},i),{movement:this.getMovement(r),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:n,isTrusted:this._isTrusted,isFirstDrag:s})},t.prototype._addStore=function(r){this.clientStores.splice(0,0,r)},t.prototype._getPosition=function(r,n){var a=this.getCurrentStore(),i=a.getPosition(r,n),o=this.clientStores.slice(1).reduce(function(u,c){var d=c.getPosition();return u.distX+=d.distX,u.distY+=d.distY,u},i),s=o.distX,l=o.distY;return Rt(Rt({},i),{distX:s,distY:l})},t.prototype._attchDragEvent=function(){var r=this._window,n=this.options.container,a={passive:!1};this._isDragAPI&&(Vt(n,"dragover",this.onDrag,a),Vt(r,"dragend",this.onDragEnd)),this._useMouse&&(Vt(n,"mousemove",this.onDrag),Vt(r,"mouseup",this.onDragEnd)),this._useTouch&&(Vt(n,"touchmove",this.onDrag,a),Vt(r,"touchend",this.onDragEnd,a),Vt(r,"touchcancel",this.onDragEnd,a))},t.prototype._dettachDragEvent=function(){var r=this._window,n=this.options.container;this._isDragAPI&&(Nt(n,"dragover",this.onDrag),Nt(r,"dragend",this.onDragEnd)),this._useMouse&&(Nt(n,"mousemove",this.onDrag),Nt(r,"mouseup",this.onDragEnd)),this._useTouch&&(Nt(n,"touchstart",this.onDragStart),Nt(n,"touchmove",this.onDrag),Nt(r,"touchend",this.onDragEnd),Nt(r,"touchcancel",this.onDragEnd))},t.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},t}(Bn);function Dd(e){for(var t=5381,r=e.length;r;)t=t*33^e.charCodeAt(--r);return t>>>0}var Md=Dd;function kd(e){return Md(e).toString(36)}function Td(e){if(e&&e.getRootNode){var t=e.getRootNode();if(t.nodeType===11)return t}}function Rd(e,t,r){return r.original?t:t.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(n,a){var i=a.trim();return(i?We(i):[""]).map(function(o){var s=o.trim();return s.indexOf("@")===0?s:s.indexOf(":global")>-1?s.replace(/\:global/g,""):s.indexOf(":host")>-1?"".concat(s.replace(/\:host/g,".".concat(e))):s?".".concat(e," ").concat(s):".".concat(e)}).join(", ")+" {"})}function Id(e,t,r,n,a){var i=Rf(n),o=i.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",e),o.setAttribute("data-styled-count","1"),r.nonce&&o.setAttribute("nonce",r.nonce),o.innerHTML=Rd(e,t,r),(a||i.head||i.body).appendChild(o),o}function Pd(e){var t="rCS"+kd(e);return{className:t,inject:function(r,n){n===void 0&&(n={});var a=Td(r),i=(a||r.ownerDocument||document).querySelector('style[data-styled-id="'.concat(t,'"]'));if(!i)i=Id(t,e,n,r,a);else{var o=parseFloat(i.getAttribute("data-styled-count"))||0;i.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var s,l=parseFloat(i.getAttribute("data-styled-count"))||0;l<=1?(i.remove?i.remove():(s=i.parentNode)===null||s===void 0||s.removeChild(i),i=null):i.setAttribute("data-styled-count","".concat(l-1))}}}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Da=function(e,t){return Da=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},Da(e,t)};function Ss(e,t){Da(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ma=function(){return Ma=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ma.apply(this,arguments)};function Od(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}var Bd=function(e){Ss(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.injectResult=null,n.tag="div",n}var r=t.prototype;return r.render=function(){var n=this.props,a=n.className,i=a===void 0?"":a;n.cspNonce;var o=n.portalContainer,s=Od(n,["className","cspNonce","portalContainer"]),l=this.injector.className,u=this.tag,c={};return Hf.indexOf("simple")>-1&&o&&(c={portalContainer:o}),se(u,Ma({ref:ge(this,"element"),"data-styled-id":l,className:i+" "+l},c,s))},r.componentDidMount=function(){this.injectResult=this.injector.inject(this.element,{nonce:this.props.cspNonce})},r.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},r.getElement=function(){return this.element},t}(ei);function Cs(e,t){var r=Pd(t);return function(n){Ss(a,n);function a(){var i=n!==null&&n.apply(this,arguments)||this;return i.injector=r,i.tag=e,i}return a}(Bd)}var ka=function(e,t){return ka=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},ka(e,t)};function $r(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ka(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var k=function(){return k=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},k.apply(this,arguments)};function zd(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Ad(e,t,r,n){var a=arguments.length,i=a<3?t:n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function nt(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function Vr(e,t){var r;return k({events:{},props:(r={},r[e]=Boolean,r),name:e},t)}function Ld(e,t){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*e,'px" height="').concat(32*e,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(t,'deg);transform-origin: 16px 16px"></path></svg>')}function Gd(e){var t=Ld(1,e),r=Math.round(e/45)*45%180,n="ns-resize";return r===135?n="nwse-resize":r===45?n="nesw-resize":r===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(t,"') 16 16, ").concat(n,";")}var gn=Kf(),ws=gn.browser.webkit,Es=ws&&function(){var e=typeof window>"u"?{userAgent:""}:window.navigator,t=/applewebkit\/([^\s]+)/g.exec(e.userAgent.toLowerCase());return t?parseFloat(t[1])<605:!1}(),Fd=gn.browser.name==="firefox",Nd=parseInt(gn.browser.webkitVersion,10)>=612||parseInt(gn.browser.version,10)>=15,ui="moveable-",$d=`
{
	position: absolute;
	width: 1px;
	height: 1px;
	left: 0;
	top: 0;
    z-index: 3000;
    --moveable-color: #4af;
    --zoom: 1;
    --zoompx: 1px;
    will-change: transform;
    outline: 1px solid transparent;
}
.control-box {
    z-index: 0;
}
.line, .control {
    position: absolute;
	left: 0;
    top: 0;
    will-change: transform;
}
.control {
	width: 14px;
	height: 14px;
	border-radius: 50%;
	border: 2px solid #fff;
	box-sizing: border-box;
    background: #4af;
    background: var(--moveable-color);
	margin-top: -7px;
    margin-left: -7px;
    border: 2px solid #fff;
    z-index: 10;
}
.padding {
    position: absolute;
    top: 0px;
    left: 0px;
    width: 100px;
    height: 100px;
    transform-origin: 0 0;
}
.line {
	width: 1px;
    height: 1px;
    background: #4af;
    background: var(--moveable-color);
	transform-origin: 0px 50%;
}
.line.edge {
    z-index: 1;
    background: transparent;
}
.line.dashed {
    box-sizing: border-box;
    background: transparent;
}
.line.dashed.horizontal {
    border-top: 1px dashed #4af;
    border-top-color: #4af;
    border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
    border-left: 1px dashed #4af;
    border-left-color: #4af;
    border-left-color: var(--moveable-color);
}
.line.vertical {
    transform: translateX(-50%);
}
.line.horizontal {
    transform: translateY(-50%);
}
.line.vertical.bold {
    width: 2px;
}
.line.horizontal.bold {
    height: 2px;
}

.control.origin {
	border-color: #f55;
	background: #fff;
	width: 12px;
	height: 12px;
	margin-top: -6px;
    margin-left: -6px;
	pointer-events: none;
}
`.concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(e){return`
.direction[data-rotation="`.concat(e,'"], :global .view-control-rotation').concat(e,` {
	`).concat(Gd(e),`
}
`)}).join(`
`),`

.line.direction:before {
    content: "";
    position: absolute;
    width: 100%;
    height: calc(var(--moveable-line-padding, 0) * 1px);
    bottom: 0;
    left: 0;
}
.group {
    z-index: -1;
}
.area {
    position: absolute;
}
.area-pieces {
    position: absolute;
    top: 0;
    left: 0;
    display: none;
}
.area.avoid, .area.pass {
    pointer-events: none;
}
.area.avoid+.area-pieces {
    display: block;
}
.area-piece {
    position: absolute;
}

`).concat(Es?`:global svg *:before {
	content:"";
	transform-origin: inherit;
}`:"",`
`),Vd=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],Ta=1e-4,qt=1e-7,Jr=1e-9,Ra=Math.pow(10,10),ao=-Ra,Wd=["n","w","s","e"],ci=["n","w","s","e","nw","ne","sw","se"],Xd={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},fi={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},Ds={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},Ms=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag"];function Wr(e,t,r,n,a,i){var o,s;i===void 0&&(i="draggable");var l=(s=(o=t.gestos[i])===null||o===void 0?void 0:o.move(r,e.inputEvent))!==null&&s!==void 0?s:{},u=l.originalDatas||l.datas,c=u[i]||(u[i]={});return k(k({},l),{isPinch:!!n,parentEvent:!0,datas:c,originalDatas:e.originalDatas})}var ar=function(){function e(r){var n;r===void 0&&(r="draggable"),this.ableName=r,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(n={},n[r]={},n)}var t=e.prototype;return t.dragStart=function(r,n){this.isDrag=!1,this.isFlag=!1;var a=n.originalDatas;return this.datas=a,a[this.ableName]||(a[this.ableName]={}),k(k({},this.move(r,n.inputEvent)),{type:"dragstart"})},t.drag=function(r,n){return this.move([r[0]-this.prevX,r[1]-this.prevY],n)},t.move=function(r,n){var a,i,o=!1;if(!this.isFlag)this.prevX=r[0],this.prevY=r[1],this.startX=r[0],this.startY=r[1],a=r[0],i=r[1],this.isFlag=!0;else{var s=this.isDrag;a=this.prevX+r[0],i=this.prevY+r[1],(r[0]||r[1])&&(this.isDrag=!0),!s&&this.isDrag&&(o=!0)}return this.prevX=a,this.prevY=i,{type:"drag",clientX:a,clientY:i,inputEvent:n,isFirstDrag:o,isDrag:this.isDrag,distX:a-this.startX,distY:i-this.startY,deltaX:r[0],deltaY:r[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},e}();function ks(e,t){var r=t.clientX,n=t.clientY,a=t.datas,i=e.state,o=i.moveableClientRect,s=i.rootMatrix,l=i.is3d,u=i.pos1,c=o.left,d=o.top,f=l?4:3,p=et(Xe(s,[r-c,n-d],f),u),v=p[0],h=p[1],g=xe({datas:a,distX:v,distY:h}),m=g[0],b=g[1];return[m,b]}function qe(e,t){var r=t.datas,n=e.state,a=n.allMatrix,i=n.beforeMatrix,o=n.is3d,s=n.left,l=n.top,u=n.origin,c=n.offsetMatrix,d=n.targetMatrix,f=n.transformOrigin,p=o?4:3;r.is3d=o,r.matrix=a,r.targetMatrix=d,r.beforeMatrix=i,r.offsetMatrix=c,r.transformOrigin=f,r.inverseMatrix=me(a,p),r.inverseBeforeMatrix=me(i,p),r.absoluteOrigin=He(ft([s,l],u),p),r.startDragBeforeDist=$t(r.inverseBeforeMatrix,r.absoluteOrigin,p),r.startDragDist=$t(r.inverseMatrix,r.absoluteOrigin,p)}function Hd(e){return rr(e.datas.beforeTransform,[50,50],100,100).direction}function zn(e,t){var r=e.datas,n=e.originalDatas.beforeRenderable,a=r.transformIndex,i=n.nextTransforms,o=i.length,s=n.nextTransformAppendedIndexes,l=0;a===-1?(t==="translate"?l=0:t==="rotate"&&(l=Se(i,function(f){return f.match(/scale\(/g)})),l===-1&&(l=i.length),r.transformIndex=l):Ce(s,function(f){return f.index===a&&f.functionName===t})?l=a:l=a+s.filter(function(f){return f.index<a}).length;var u=bp(i,l),c=u.targetFunction,d=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=u.beforeFunctionTexts,r.afterFunctionTexts=u.afterFunctionTexts,r.beforeTransform=u.beforeFunctionMatrix,r.beforeTransform2=u.beforeFunctionMatrix2,r.targetTansform=u.targetFunctionMatrix,r.afterTransform=u.afterFunctionMatrix,r.afterTransform2=u.afterFunctionMatrix2,r.targetAllTransform=u.allFunctionMatrix,c.functionName===d?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):o>l&&(r.isAppendTransform=!0,n.nextTransformAppendedIndexes=nt(nt([],s,!0),[{functionName:t,index:l,isAppend:!0}],!1))}function An(e,t,r){return"".concat(e.beforeFunctionTexts.join(" ")," ").concat(e.isAppendTransform?r:t," ").concat(e.afterFunctionTexts.join(" "))}function Yd(e){var t=e.datas,r=e.distX,n=e.distY,a=Rs({datas:t,distX:r,distY:n}),i=a[0],o=a[1],s=Ts(t,ed([i,o],4));return $t(s,He([0,0,0],4),4)}function Ts(e,t,r){var n=e.beforeTransform,a=e.afterTransform,i=e.beforeTransform2,o=e.afterTransform2,s=e.targetAllTransform,l=r?_t(s,t,4):_t(t,s,4),u=_t(me(r?i:n,4),l,4),c=_t(u,me(r?o:a,4),4);return c}function Rs(e){var t=e.datas,r=e.distX,n=e.distY,a=t.inverseBeforeMatrix,i=t.is3d,o=t.startDragBeforeDist,s=t.absoluteOrigin,l=i?4:3;return et($t(a,ft(s,[r,n]),l),o)}function xe(e,t){var r=e.datas,n=e.distX,a=e.distY,i=r.inverseBeforeMatrix,o=r.inverseMatrix,s=r.is3d,l=r.startDragBeforeDist,u=r.startDragDist,c=r.absoluteOrigin,d=s?4:3;return et($t(t?i:o,ft(c,[n,a]),d),t?l:u)}function jd(e,t){var r=e.datas,n=e.distX,a=e.distY;r.beforeMatrix;var i=r.matrix,o=r.is3d;r.startDragBeforeDist;var s=r.startDragDist,l=r.absoluteOrigin,u=o?4:3;return et($t(i,ft(s,[n,a]),u),l)}function Ud(e,t,r,n,a,i){return n===void 0&&(n=t),a===void 0&&(a=r),i===void 0&&(i=[0,0]),e?e.map(function(o,s){var l=Lr(o),u=l.value,c=l.unit,d=s?a:n,f=s?r:t;if(o==="%"||isNaN(u)){var p=d?i[s]/d:0;return f*p}else if(c!=="%")return u;return f*u/100}):i}function Is(e){var t=[];return e[1]>=0&&(e[0]>=0&&t.push(3),e[0]<=0&&t.push(2)),e[1]<=0&&(e[0]>=0&&t.push(1),e[0]<=0&&t.push(0)),t}function qd(e,t){return Is(t).map(function(r){return e[r]})}function Dt(e,t){var r=(t[0]+1)/2,n=(t[1]+1)/2,a=[Ge(e[0][0],e[1][0],r,1-r),Ge(e[0][1],e[1][1],r,1-r)],i=[Ge(e[2][0],e[3][0],r,1-r),Ge(e[2][1],e[3][1],r,1-r)];return[Ge(a[0],i[0],n,1-n),Ge(a[1],i[1],n,1-n)]}function Kd(e,t,r,n,a,i){var o=Be(t,r,n,a),s=Dt(o,i),l=e[0]-s[0],u=e[1]-s[1];return[l,u]}function Xr(e,t,r,n){return _t(e,mn(t,n,r),n)}function Zd(e,t,r){var n=e.transformOrigin,a=e.offsetMatrix,i=e.is3d,o=t.beforeTransform,s=t.afterTransform,l=i?4:3,u=si([r]);return Xr(a,be(_t(_t(o,u,4),s,4),4,l),n,l)}function Jd(e,t){var r=e.transformOrigin,n=e.offsetMatrix,a=e.is3d,i=e.targetMatrix,o=a?4:3;return Xr(n,_t(i,ii(t,o),o),r,o)}function Ln(e){var t=vr(e);return{setTransform:function(r,n){n===void 0&&(n=-1),t.startTransforms=Ot(r)?r:Pe(r),Ia(e,n)},setTransformIndex:function(r){Ia(e,r)}}}function Gn(e,t){var r=vr(e),n=r.startTransforms;Ia(e,Se(n,function(a){return a.indexOf("".concat(t,"("))===0}))}function Ia(e,t){var r=vr(e),n=e.datas;if(n.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var i=Fe([a]);n.startValue=i[0].functionValue}}}function di(e,t){var r=vr(e);r.nextTransforms=Pe(t)}function vr(e){return e.originalDatas.beforeRenderable}function Ps(e){var t=e.originalDatas.beforeRenderable;return t.nextTransforms}function Qr(e){return Ps(e).join(" ")}function tn(e){return vr(e).nextStyle}function Os(e,t,r,n,a){di(a,t);var i=Yt.drag(e,Wr(a,e.state,r,n)),o=i?i.transform:t;return k(k({transform:t,drag:i},Ut({transform:o},a)),{afterTransform:o})}function Bs(e,t,r,n,a){var i=e.state,o=i.left,s=i.top,l=e.props.groupable,u=Zd(e.state,a,t),c=l?o:0,d=l?s:0,f=As(e,r,u),p=et(n,f);return et(p,[c,d])}function Qd(e,t,r,n,a){var i=Bs(e,"scale(".concat(t.join(", "),")"),r,n,a);return i}function zs(e,t,r){return[-1+e[0]/(t/2),-1+e[1]/(r/2)]}function As(e,t,r){r===void 0&&(r=e.state.allMatrix);var n=e.state,a=n.width,i=n.height,o=n.is3d,s=o?4:3,l=[a/2*(1+t[0]),i/2*(1+t[1])];return zt(r,l,s)}function tp(e,t,r){var n=r.fixedDirection,a=r.fixedPosition;return Bs(e,"rotate(".concat(t,"deg)"),n,a,r)}function ep(e,t,r,n,a,i){var o=e.props.groupable,s=e.state,l=s.transformOrigin,u=s.offsetMatrix,c=s.is3d,d=s.width,f=s.height,p=s.left,v=s.top,h=i.fixedDirection,g=i.nextTargetMatrix||s.targetMatrix,m=c?4:3,b=Ud(a,t,r,d,f,l),x=o?p:0,_=o?v:0,S=Xr(u,g,b,m),y=Kd(n,S,t,r,m,h);return et(y,[x,_])}function Ls(e,t){return Dt(Qt(e.state),t)}function rp(e,t){var r=e.targetGesto,n=e.controlGesto,a;return r!=null&&r.isFlag()&&(a=r.getEventData()[t]),!a&&(n!=null&&n.isFlag())&&(a=n.getEventData()[t]),a||{}}function np(e,t){return[e[0]*t[0],e[1]*t[1]]}function rt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return of.apply(void 0,nt([ui],e,!1))}function Gs(e){e()}function ap(e){return!e||e==="none"?[1,0,0,1,0,0]:he(e)?e:si(e)}function mn(e,t,r){return xa(t,Mr(r,t),e,Mr(r.map(function(n){return-n}),t))}function ip(e,t,r){if(t==="%"){var n=pi(e.ownerSVGElement);return n[r?"width":"height"]/100}return 1}function op(e){var t=bn(we(e,":before"));return t.map(function(r,n){var a=Lr(r),i=a.value,o=a.unit;return i*ip(e,o,n===0)})}function bn(e){var t=e.transformOrigin;return t?t.split(" "):["0","0"]}function Fs(e,t){t===void 0&&(t=we(e));var r=t.transform;if(r&&r!=="none")return t.transform;if("transform"in e){var n=e.transform,a=n.baseVal;if(!a)return"";var i=a.length;if(!i)return"";for(var o=[],s=function(u){var c=a[u].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(d){return c[d]}).join(", "),")"))},l=0;l<i;++l)s(l);return o.join(" ")}return""}function kr(e,t,r,n,a){var i,o,s,l=e&&e.ownerDocument?e.ownerDocument:document,u=l.documentElement||l.body,c=!1,d,f;if(!e||r)d=e;else{var p=(i=e==null?void 0:e.assignedSlot)===null||i===void 0?void 0:i.parentElement,v=e.parentElement;p?(c=!0,f=v,d=p):d=v}for(var h=!1,g=e===t||d===t,m="relative",b=1,x=parseFloat((o=a)===null||o===void 0?void 0:o.zoom)||1,_=a==null?void 0:a.position;d&&d!==u;){t===d&&(g=!0);var S=we(d),y=d.tagName.toLowerCase(),C=Fs(d,S),M=S.willChange,E=parseFloat(S.zoom)||1;if(m=S.position,n&&E!==1){b=E;break}if(!r&&n&&x!==1&&_&&_!=="absolute"||y==="svg"||m!=="static"||C&&C!=="none"||M==="transform")break;var w=(s=e==null?void 0:e.assignedSlot)===null||s===void 0?void 0:s.parentNode,T=d.parentNode;w&&(c=!0,f=T);var D=w||T;if(D&&D.nodeType===11){d=D.host,h=!0;break}d=D,m="relative"}return{offsetZoom:b,hasSlot:c,parentSlotElement:f,isCustomElement:h,isStatic:m==="static",isEnd:g||!d||d===u,offsetParent:d||u}}function sp(e,t,r){var n,a=e.tagName.toLowerCase(),i=e.offsetLeft,o=e.offsetTop,s=Ar(i),l=!s,u,c;return!l&&a!=="svg"?(u=Es?op(e):bn(r).map(function(d){return parseFloat(d)}),c=u.slice(),l=!0,n=cp(e,u,e===t&&t.tagName.toLowerCase()==="g"),i=n[0],o=n[1],u[0]=n[2],u[1]=n[3]):(u=bn(r).map(function(d){return parseFloat(d)}),c=u.slice()),{tagName:a,isSVG:s,hasOffset:l,offset:[i||0,o||0],origin:u,targetOrigin:c}}function Ns(e,t,r){r===void 0&&(r=we(e));var n=we(document.body),a=n.position;if(!t&&(!a||a==="static"))return[0,0];var i=parseInt(n.marginLeft,10),o=parseInt(n.marginTop,10);return r.position==="absolute"&&((r.top!=="auto"||r.bottom!=="auto")&&(o=0),(r.left!=="auto"||r.right!=="auto")&&(i=0)),[i,o]}function Pa(e){e.forEach(function(t){var r=t.matrix;r&&(t.matrix=be(r,3,4))})}function lp(e){for(var t=e.parentElement,r=!1;t;){var n=we(t).transform;if(n&&n!=="none"){r=!0;break}if(t===document.body)break;t=t.parentElement}return{fixedContainer:t||document.body,hasTransform:r}}function Fn(e,t){return t===void 0&&(t=e.length>9),"".concat(t?"matrix3d":"matrix","(").concat(gs(e,!t).join(","),")")}function pi(e){var t=e.clientWidth,r=e.clientHeight;if(!e)return{x:0,y:0,width:0,height:0,clientWidth:t,clientHeight:r};var n=e.viewBox,a=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:a.x,y:a.y,width:a.width||t,height:a.height||r,clientWidth:t,clientHeight:r}}function up(e,t){var r=pi(e),n=r.width,a=r.height,i=r.clientWidth,o=r.clientHeight,s=i/n,l=o/a,u=e.preserveAspectRatio.baseVal,c=u.align,d=u.meetOrSlice,f=[0,0],p=[s,l],v=[0,0];if(c!==1){var h=(c-2)%3,g=Math.floor((c-2)/3);f[0]=n*h/2,f[1]=a*g/2;var m=d===2?Math.max(l,s):Math.min(s,l);p[0]=m,p[1]=m,v[0]=(i-n)/2*h,v[1]=(o-a)/2*g}var b=ii(p,t);return b[t*(t-1)]=v[0],b[t*(t-1)+1]=v[1],mn(b,t,f)}function cp(e,t,r){if(!e.getBBox||!r&&e.tagName.toLowerCase()==="g")return[0,0,0,0];var n=e.getBBox(),a=pi(e.ownerSVGElement),i=n.x-a.x,o=n.y-a.y;return[i,o,t[0]-i,t[1]-o]}function zt(e,t,r){return $t(e,He(t,r),r)}function Be(e,t,r,n){return[[0,0],[t,0],[0,r],[t,r]].map(function(a){return zt(e,a,n)})}function le(e){var t=e.map(function(u){return u[0]}),r=e.map(function(u){return u[1]}),n=Math.min.apply(Math,t),a=Math.min.apply(Math,r),i=Math.max.apply(Math,t),o=Math.max.apply(Math,r),s=i-n,l=o-a;return{left:n,top:a,right:i,bottom:o,width:s,height:l}}function io(e,t,r,n){var a=Be(e,t,r,n);return le(a)}function fp(e,t,r,n,a){var i,o=e.target,s=e.origin,l=t.matrix,u=Vs(o),c=u.offsetWidth,d=u.offsetHeight,f=r.getBoundingClientRect(),p=[0,0];r===document.body&&(p=Ns(o,!0));for(var v=o.getBoundingClientRect(),h=v.left-f.left+r.scrollLeft-(r.clientLeft||0)+p[0],g=v.top-f.top+r.scrollTop-(r.clientTop||0)+p[1],m=v.width,b=v.height,x=xa(n,a,l),_=io(x,c,d,n),S=_.left,y=_.top,C=_.width,M=_.height,E=zt(x,s,n),w=et(E,[S,y]),T=[h+w[0]*m/C,g+w[1]*b/M],D=[0,0],R=0;++R<10;){var I=me(a,n);i=et(zt(I,T,n),zt(I,E,n)),D[0]=i[0],D[1]=i[1];var B=xa(n,a,Mr(D,n),l),V=io(B,c,d,n),j=V.left,W=V.top,X=j-h,z=W-g;if(Math.abs(X)<2&&Math.abs(z)<2)break;T[0]-=X,T[1]-=z}return D.map(function(Y){return Math.round(Y)})}function dp(e,t,r){var n=e.length===16,a=n?4:3,i=t.map(function(l){return zt(e,l,a)}),o=r.left,s=r.top;return i.map(function(l){return[l[0]+o,l[1]+s]})}function rr(e,t,r,n){var a=e.length===16,i=a?4:3,o=Be(e,r,n,i),s=o[0],l=s[0],u=s[1],c=o[1],d=c[0],f=c[1],p=o[2],v=p[0],h=p[1],g=o[3],m=g[0],b=g[1],x=zt(e,t,i),_=x[0],S=x[1],y=Math.min(l,d,v,m),C=Math.min(u,f,h,b),M=Math.max(l,d,v,m),E=Math.max(u,f,h,b);l=l-y||0,d=d-y||0,v=v-y||0,m=m-y||0,u=u-C||0,f=f-C||0,h=h-C||0,b=b-C||0,_=_-y||0,S=S-C||0;var w=va(Be(e,100,100,i));return{left:y,top:C,right:M,bottom:E,origin:[_,S],pos1:[l,u],pos2:[d,f],pos3:[v,h],pos4:[m,b],direction:w}}function de(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function $s(e,t){return de([t[0]-e[0],t[1]-e[1]])}function br(e,t,r,n){r===void 0&&(r=1),n===void 0&&(n=Mt(e,t));var a=$s(e,t);return{transform:"translateY(-50%) translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(n,"rad) scaleY(").concat(r,")"),width:"".concat(a,"px")}}function vi(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=r.length,i=r.reduce(function(s,l){return s+l[0]},0)/a,o=r.reduce(function(s,l){return s+l[1]},0)/a;return{transform:"translateZ(0px) translate(".concat(i,"px, ").concat(o,"px) rotate(").concat(e,"rad) scale(").concat(t,")")}}function Ye(e,t){var r=e[t];return he(r)?k(k({},e),r):e}function Vs(e,t){t===void 0&&(t=e?we(e):null);var r=e&&!Ar(e.offsetWidth),n=0,a=0,i=0,o=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0,v=0,h=1/0,g=1/0,m=1/0,b=1/0,x=0,_=0,S=!1;if(e)if(!r&&e.tagName.toLowerCase()!=="svg"){var y=e.getBBox();S=!0,n=y.width,a=y.height,s=n,l=a,u=n,c=a,i=n,o=a}else{var C=e.style,M=t.boxSizing==="border-box",E=parseFloat(t.borderLeftWidth)||0,w=parseFloat(t.borderRightWidth)||0,T=parseFloat(t.borderTopWidth)||0,D=parseFloat(t.borderBottomWidth)||0,R=parseFloat(t.paddingLeft)||0,I=parseFloat(t.paddingRight)||0,B=parseFloat(t.paddingTop)||0,V=parseFloat(t.paddingBottom)||0,j=R+I,W=B+V,X=E+w,z=T+D,Y=j+X,G=W+z,A=t.position,N=0,L=0;if("clientLeft"in e){var $=null;if(A==="absolute"){var U=kr(e,document.body);$=U.offsetParent}else $=e.parentElement;if($){var Q=we($);N=parseFloat(Q.width),L=parseFloat(Q.height)}}d=Math.max(j,yt(t.minWidth,N)||0),f=Math.max(W,yt(t.minHeight,L)||0),h=yt(t.maxWidth,N),g=yt(t.maxHeight,L),isNaN(h)&&(h=1/0),isNaN(g)&&(g=1/0),x=yt(C.width,0)||0,_=yt(C.height,0)||0,s=parseFloat(t.width)||0,l=parseFloat(t.height)||0,u=Math.abs(s-x)<1?da(d,x||s,h):s,c=Math.abs(l-_)<1?da(f,_||l,g):l,n=u,a=c,i=u,o=c,M?(m=h,b=g,p=d,v=f,u=n-Y,c=a-G):(m=h+Y,b=g+G,p=d+Y,v=f+G,n=u+Y,a=c+G),i=u+j,o=c+W}return{svg:S,offsetWidth:n,offsetHeight:a,clientWidth:i,clientHeight:o,contentWidth:u,contentHeight:c,inlineCSSWidth:x,inlineCSSHeight:_,cssWidth:s,cssHeight:l,minWidth:d,minHeight:f,maxWidth:h,maxHeight:g,minOffsetWidth:p,minOffsetHeight:v,maxOffsetWidth:m,maxOffsetHeight:b}}function Ws(e,t){return Mt(t>0?e[0]:e[1],t>0?e[1]:e[0])}function en(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function Xs(e,t){var r=e===document.body||e===document.documentElement,n={clientLeft:e.clientLeft,clientTop:e.clientTop,clientWidth:e.clientWidth,clientHeight:e.clientHeight,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,overflow:!1};return r&&(n.clientHeight=Math.max(t.height,n.clientHeight),n.scrollHeight=Math.max(t.height,n.scrollHeight)),n.overflow=we(e).overflow!=="visible",k(k({},t),n)}function aa(e,t,r,n){var a=e.left,i=e.right,o=e.top,s=e.bottom,l=t.top,u=t.left,c={left:u+a,top:l+o,right:u+i,bottom:l+s,width:i-a,height:s-o};return r&&n?Xs(r,c):c}function xr(e,t){var r=0,n=0,a=0,i=0;if(e){var o=e.getBoundingClientRect();r=o.left,n=o.top,a=o.width,i=o.height}var s={left:r,top:n,width:a,height:i,right:r+a,bottom:n+i};return e&&t?Xs(e,s):s}function Hs(e,t,r,n){var a;if(e)a=e;else if(t)a=[0,0];else{var i=r.target;a=Ys(i,n)}return a}function Ys(e,t){if(e){var r=e.getAttribute("data-rotation")||"",n=e.getAttribute("data-direction");if(t.deg=r,!!n){var a=[0,0];return n.indexOf("w")>-1&&(a[0]=-1),n.indexOf("e")>-1&&(a[0]=1),n.indexOf("n")>-1&&(a[1]=-1),n.indexOf("s")>-1&&(a[1]=1),a}}}function hi(e,t){return[ft(t,e[0]),ft(t,e[1]),ft(t,e[2]),ft(t,e[3])]}function Qt(e){var t=e.left,r=e.top,n=e.pos1,a=e.pos2,i=e.pos3,o=e.pos4;return hi([n,a,i,o],[t,r])}function pp(e){return Math.round(e%1===-.5?e-1:e)}function er(e,t){var r;(r=e[t])===null||r===void 0||r.unset(),e[t]=null}function Ut(e,t){if(t){var r=vr(t);r.nextStyle=k(k({},r.nextStyle),e)}return{style:e,cssText:pr(e).map(function(n){return"".concat(fn(n,"-"),": ").concat(e[n],";")}).join("")}}function js(e,t,r){var n=t.afterTransform||t.transform;return k(k({},Ut(k(k(k({},e.style),t.style),{transform:n}),r)),{afterTransform:n,transform:e.transform})}function ot(e,t,r,n){var a=t.datas;a.datas||(a.datas={});var i=k(k({},r),{target:e.state.target,clientX:t.clientX,clientY:t.clientY,inputEvent:t.inputEvent,currentTarget:e,moveable:e,datas:a.datas,isFirstDrag:!!t.isFirstDrag,isTrusted:t.isTrusted!==!1,stopAble:function(){a.isEventStart=!1},stopDrag:function(){var o;(o=t.stop)===null||o===void 0||o.call(t)}});return a.isStartEvent?n||(a.lastEvent=i):a.isStartEvent=!0,i}function ae(e,t,r){var n=t.datas,a="isDrag"in r?r.isDrag:t.isDrag;return n.datas||(n.datas={}),k(k({isDrag:a},r),{moveable:e,target:e.state.target,clientX:t.clientX,clientY:t.clientY,inputEvent:t.inputEvent,currentTarget:e,lastEvent:n.lastEvent,isDouble:t.isDouble,datas:n.datas,isFirstDrag:!!t.isFirstDrag})}function Nn(e,t,r){e._emitter.on(t,r)}function Z(e,t,r,n){return e.triggerEvent(t,r,n)}function we(e,t){return window.getComputedStyle(e,t)}function rn(e,t,r){var n={},a={};return e.filter(function(i){var o=i.name;if(n[o]||!t.some(function(s){return i[s]}))return!1;if(!r&&i.ableGroup){if(a[i.ableGroup])return!1;a[i.ableGroup]=!0}return n[o]=!0,!0})}function Oa(e,t){return e===t||e==null&&t==null}function vp(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.length-1,n=0;n<r;++n){var a=e[n];if(!Ar(a))return a}return e[r]}function Us(e,t){var r=[],n=[];return e.forEach(function(a,i){var o=t(a,i,e),s=n.indexOf(o),l=r[s]||[];s===-1&&(n.push(o),r.push(l)),l.push(a)}),r}function hp(e,t){var r=[],n={};return e.forEach(function(a,i){var o=t(a,i,e),s=n[o];s||(s=[],n[o]=s,r.push(s)),s.push(a)}),r}function qs(e){return e.reduce(function(t,r){return t.concat(r)},[])}function ir(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.sort(function(r,n){return Math.abs(n)-Math.abs(r)}),e[0]}function Xe(e,t,r){return $t(me(e,r),He(t,r),r)}function gp(e,t){var r,n=e.is3d,a=e.rootMatrix,i=n?4:3;return r=Xe(a,[t.distX,t.distY],i),t.distX=r[0],t.distY=r[1],t}function nn(e,t,r,n,a){return et(zt(e,ft(r,t),a),n)}function ce(e,t,r){return r?"".concat(e/t*100,"%"):"".concat(e,"px")}function xn(e){return Math.abs(e)<=qt?0:e}function gi(e){return function(t){if(!t.isDragging(e))return"";var r=rp(t,e),n=r.deg;return n?rt("view-control-rotation".concat(n)):""}}function mi(e,t){return t===void 0&&(t=[e]),function(r,n){if(n.isRequest)return t.some(function(i){return n.requestAble===i})?n.parentDirection:!1;var a=n.inputEvent.target;return At(a,rt("direction"))&&(!e||At(a,rt(e)))}}function mp(e){var t={};for(var r in e)t[e[r]]=r;return t}function bp(e,t){var r=e.slice(0,t<0?void 0:t),n=e.slice(0,t<0?void 0:t+1),a=e[t]||"",i=t<0?[]:e.slice(t),o=t<0?[]:e.slice(t+1),s=Fe(r),l=Fe(n),u=Fe([a]),c=Fe(i),d=Fe(o),f=Qe(s),p=Qe(l),v=Qe(c),h=Qe(d),g=_t(f,v,4);return{transforms:e,beforeFunctionMatrix:f,beforeFunctionMatrix2:p,targetFunctionMatrix:Qe(u),afterFunctionMatrix:v,afterFunctionMatrix2:h,allFunctionMatrix:g,beforeFunctions:s,beforeFunctions2:l,targetFunction:u[0],afterFunctions:c,afterFunctions2:d,beforeFunctionTexts:r,beforeFunctionTexts2:n,targetFunctionText:a,afterFunctionTexts:i,afterFunctionTexts2:o}}function xp(e){return!e||!he(e)||e instanceof Element?!1:Ot(e)||"length"in e}function je(e,t){return e?e instanceof Element?e:ne(e)?t?document.querySelector(e):e:Ka(e)?e():"current"in e?e.current:e:null}function bi(e,t){if(!e)return[];var r=xp(e)?[].slice.call(e):[e];return r.reduce(function(n,a){return ne(a)&&t?nt(nt([],n,!0),[].slice.call(document.querySelectorAll(a)),!0):(Ot(a)?n.push(bi(a,t)):n.push(je(a,t)),n)},[])}function _p(e,t,r){var n=Mt(e,t)/Math.PI*180;return n=r>=0?n:180-n,n=n>=0?n:360+n,n}function oo(e,t){var r=e.rootMatrix,n=e.is3d,a=n?4:3,i=me(r,a);return n||(i=be(i,3,4)),i[12]=0,i[13]=0,i[14]=0,sd(i,t)}function Ks(e,t,r,n,a){var i=e[0],o=e[1],s=0,l=0;if(a&&i&&o){var u=Mt([0,0],t),c=Mt([0,0],n),d=de(t),f=Math.cos(u-c)*d;if(!n[0])l=f,s=l*r;else if(!n[1])s=f,l=s/r;else{var p=n[0]*2*i,v=n[1]*2*o,h=de([p+t[0],v+t[1]])-de([p,v]),g=Mt([0,0],[r,1]);s=Math.cos(g)*h,l=Math.sin(g)*h}}else s=n[0]*t[0],l=n[1]*t[1];return[s,l]}function Zs(e,t,r,n){var a,i=r.ratio,o=r.startOffsetWidth,s=r.startOffsetHeight,l=0,u=0,c=n.distX,d=n.distY,f=n.parentDistance,p=n.parentDist,v=n.parentScale,h=r.fixedDirection,g=[0,1].map(function(y){return Math.abs(e[y]-h[y])}),m=[0,1].map(function(y){var C=g[y];return C!==0&&(C=2/C),C});if(p)l=p[0],u=p[1],t&&(l?u||(u=l/i):l=u*i);else if(v)l=(v[0]-1)*o,u=(v[1]-1)*s;else if(f){var b=o*g[0],x=s*g[1],_=de([b,x]);l=f/_*b*m[0],u=f/_*x*m[1]}else{var S=xe({datas:r,distX:c,distY:d});S=m.map(function(y,C){return S[C]*y}),a=Ks([o,s],S,i,e,t),l=a[0],u=a[1]}return{distWidth:l,distHeight:u}}function Ba(e,t){if(t){if(e==="left")return{x:"0%",y:"50%"};if(e==="top")return{x:"50%",y:"50%"};if(e==="center")return{x:"50%",y:"50%"};if(e==="right")return{x:"100%",y:"50%"};if(e==="bottom")return{x:"50%",y:"100%"};var r=e.split(" "),n=r[0],a=r[1],i=Ba(n||""),o=Ba(a||""),s=k(k({},i),o),l={x:"50%",y:"50%"};return s.x&&(l.x=s.x),s.y&&(l.y=s.y),s.value&&(s.x&&!s.y&&(l.y=s.value),!s.x&&s.y&&(l.x=s.value)),l}return e==="left"?{x:"0%"}:e==="right"?{x:"100%"}:e==="top"?{y:"0%"}:e==="bottom"?{y:"100%"}:e?e==="center"?{value:"50%"}:{value:e}:{}}function yp(e,t,r){var n=Ba(e,!0),a=n.x,i=n.y;return[yt(a,t)||0,yt(i,r)||0]}function Sp(e,t,r){var n=e.map(function(i){return et(i,t)}),a=n.map(function(i){return Nr(i,r)});return{prev:n,next:a,result:a.map(function(i){return ft(i,t)})}}function Js(e,t){return e.length===t.length&&e.every(function(r,n){var a=t[n],i=Ot(r),o=Ot(a);return i&&o?Js(r,a):!i&&!o?r===a:!1})}var Cp=Vr("pinchable",{events:{onPinchStart:"pinchStart",onPinch:"pinch",onPinchEnd:"pinchEnd",onPinchGroupStart:"pinchGroupStart",onPinchGroup:"pinchGroup",onPinchGroupEnd:"pinchGroupEnd"},dragStart:function(){return!0},pinchStart:function(e,t){var r=t.datas,n=t.targets,a=t.angle,i=t.originalDatas,o=e.props,s=o.pinchable,l=o.ables;if(!s)return!1;var u="onPinch".concat(n?"Group":"","Start"),c="drag".concat(n?"Group":"","ControlStart"),d=(s===!0?e.controlAbles:l.filter(function(h){return s.indexOf(h.name)>-1})).filter(function(h){return h.canPinch&&h[c]}),f=ot(e,t,{});n&&(f.targets=n);var p=Z(e,u,f);r.isPinch=p!==!1,r.ables=d;var v=r.isPinch;return v?(d.forEach(function(h){if(i[h.name]=i[h.name]||{},!!h[c]){var g=k(k({},t),{datas:i[h.name],parentRotate:a,isPinch:!0});h[c](e,g)}}),e.state.snapRenderInfo={request:t.isRequest,direction:[0,0]},v):!1},pinch:function(e,t){var r=t.datas,n=t.scale,a=t.distance,i=t.originalDatas,o=t.inputEvent,s=t.targets,l=t.angle;if(r.isPinch){var u=a*(1-1/n),c=ot(e,t,{});s&&(c.targets=s);var d="onPinch".concat(s?"Group":"");Z(e,d,c);var f=r.ables,p="drag".concat(s?"Group":"","Control");return f.forEach(function(v){v[p]&&v[p](e,k(k({},t),{datas:i[v.name],inputEvent:o,parentDistance:u,parentRotate:l,isPinch:!0}))}),c}},pinchEnd:function(e,t){var r=t.datas,n=t.isPinch,a=t.inputEvent,i=t.targets,o=t.originalDatas;if(r.isPinch){var s="onPinch".concat(i?"Group":"","End"),l=ae(e,t,{isDrag:n});i&&(l.targets=i),Z(e,s,l);var u=r.ables,c="drag".concat(i?"Group":"","ControlEnd");return u.forEach(function(d){d[c]&&d[c](e,k(k({},t),{isDrag:n,datas:o[d.name],inputEvent:a,isPinch:!0}))}),n}},pinchGroupStart:function(e,t){return this.pinchStart(e,k(k({},t),{targets:e.props.targets}))},pinchGroup:function(e,t){return this.pinch(e,k(k({},t),{targets:e.props.targets}))},pinchGroupEnd:function(e,t){return this.pinchEnd(e,k(k({},t),{targets:e.props.targets}))}});function pe(e,t,r){var n=r.originalDatas;n.groupable=n.groupable||{};var a=n.groupable;a.childDatas=a.childDatas||[];var i=a.childDatas;return e.moveables.map(function(o,s){return i[s]=i[s]||{},i[s][t]=i[s][t]||{},k(k({},r),{datas:i[s][t],originalDatas:i[s]})})}function ia(e,t,r,n,a,i,o){var s=!!r.match(/Start$/g),l=!!r.match(/End$/g),u=a.isPinch,c=a.datas,d=pe(e,t.name,a),f=e.moveables,p=d.map(function(v,h){var g=f[h],m=g.state,b=m.gestos,x=v;if(s)x=new ar(o).dragStart(n,v);else{if(b[o]||(b[o]=c.childGestos[h]),!b[o])return;x=Wr(v,m,n,u,i,o)}var _=t[r](g,k(k({},x),{parentFlag:!0}));return l&&(b[o]=null),_});return s&&(c.childGestos=f.map(function(v){return v.state.gestos[o]})),p}function _e(e,t,r,n,a,i){a===void 0&&(a=function(c,d){return d});var o=!!r.match(/End$/g),s=pe(e,t.name,n),l=e.moveables,u=s.map(function(c,d){var f=l[d],p=c;p=a(f,c);var v=t[r](f,k(k({},p),{parentFlag:!0}));return v&&i&&i(f,c,v,d),o&&(f.state.gestos={}),v});return u}var wp=["left","right","center"],Ep=["top","bottom","middle"],ze={start:"left",end:"right",center:"center"},Ae={start:"top",end:"bottom",center:"middle"};function hr(e,t){var r=e.props,n=r.snappable,a=r.bounds,i=r.innerBounds,o=r.verticalGuidelines,s=r.horizontalGuidelines,l=r.snapGridWidth,u=r.snapGridHeight,c=e.state,d=c.guidelines,f=c.enableSnap;return!n||!f||t&&n!==!0&&n.indexOf(t)<0?!1:!!(l||u||a||i||d&&d.length||o&&o.length||s&&s.length)}function xi(e){return e===!1?{}:e===!0||!e?{left:!0,right:!0,top:!0,bottom:!0}:e}function Dp(e,t){var r=xi(e),n={};for(var a in r)a in t&&r[a]&&(n[a]=t[a]);return n}function _i(e,t){var r=Dp(e,t),n=Ep.filter(function(i){return i in r}),a=wp.filter(function(i){return i in r});return{horizontal:n.map(function(i){return r[i]}),vertical:a.map(function(i){return r[i]})}}function Mp(e,t,r){var n=zt(e,[t.clientLeft,t.clientTop],r);return[t.left+n[0],t.top+n[1]]}function kp(e){var t=e[0],r=e[1],n=r[0]-t[0],a=r[1]-t[1];Math.abs(n)<It&&(n=0),Math.abs(a)<It&&(a=0);var i=0,o=0,s=0;return n?a?(i=-a/n,o=1,s=i*t[0]-t[1]):(o=1,s=-t[1]):(i=-1,s=t[0]),[i,o,s].map(function(l){return it(l,It)})}function $n(e,t,r,n){var a=e.props,i=vp(n,a.snapThreshold,5);return Qs(e.state.guidelines,t,r,i)}function Qs(e,t,r,n){return{vertical:lo(e,"vertical",t,n),horizontal:lo(e,"horizontal",r,n)}}function Tp(e,t,r){var n=r[0],a=r[1],i=t[0],o=t[1],s=et(r,t),l=s[0],u=s[1],c=u>0,d=l>0;l=xn(l),u=xn(u);var f={isSnap:!1,offset:0,pos:0},p={isSnap:!1,offset:0,pos:0};if(l===0&&u===0)return{vertical:f,horizontal:p};var v=$n(e,l?[n]:[],u?[a]:[]),h=v.vertical,g=v.horizontal;h.posInfos.filter(function(I){var B=I.pos;return d?B>=i:B<=i}),g.posInfos.filter(function(I){var B=I.pos;return c?B>=o:B<=o}),h.isSnap=h.posInfos.length>0,g.isSnap=g.posInfos.length>0;var m=za(h),b=m.isSnap,x=m.guideline,_=za(g),S=_.isSnap,y=_.guideline,C=S?y.pos[1]:0,M=b?x.pos[0]:0;if(l===0)S&&(p.isSnap=!0,p.pos=y.pos[1],p.offset=a-p.pos);else if(u===0)b&&(f.isSnap=!0,f.pos=M,f.offset=n-M);else{var E=u/l,w=r[1]-E*n,T=0,D=0,R=!1;b?(D=M,T=E*D+w,R=!0):S&&(T=C,D=(T-w)/E,R=!0),R&&(f.isSnap=!0,f.pos=D,f.offset=n-D,p.isSnap=!0,p.pos=T,p.offset=a-T)}return{vertical:f,horizontal:p}}function so(e,t,r){var n=_i(e.props.snapDirections,t);return $n(e,n.vertical,n.horizontal,r)}function za(e){var t=e.isSnap;if(!t)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var r=e.posInfos[0],n=r.guidelineInfos[0],a=n.offset,i=n.dist,o=n.guideline;return{isSnap:t,offset:a,dist:i,pos:r.pos,guideline:o}}function lo(e,t,r,n){if(!e||!e.length)return{isSnap:!1,index:-1,posInfos:[]};var a=t==="vertical",i=a?0:1,o=r.map(function(l,u){var c=e.map(function(d){var f=d.pos,p=l-f[i];return{offset:p,dist:Math.abs(p),guideline:d}}).filter(function(d){var f=d.guideline,p=d.dist,v=f.type;return!(v!==t||p>n)}).sort(function(d,f){return d.dist-f.dist});return{pos:l,index:u,guidelineInfos:c}}).filter(function(l){return l.guidelineInfos.length>0}).sort(function(l,u){return l.guidelineInfos[0].dist-u.guidelineInfos[0].dist}),s=o.length>0;return{isSnap:s,index:s?o[0].index:-1,posInfos:o}}function Rp(e,t,r,n){n===void 0&&(n=1);var a=[];if(r[0]&&r[1])a=[r,[-r[0],r[1]],[r[0],-r[1]]].map(function(s){return Dt(t,s)});else if(!r[0]&&!r[1])for(var i=[t[0],t[1],t[3],t[2],t[0]],o=0;o<4;++o)a.push(i[o]),a.push([(i[o][0]+i[o+1][0])/2,(i[o][1]+i[o+1][1])/2]);else e.props.keepRatio?a=[[-1,-1],[-1,1],[1,-1],[1,1],r].map(function(s){return Dt(t,s)}):(a=qd(t,r),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));return $n(e,a.map(function(s){return s[0]}),a.map(function(s){return s[1]}),n)}function tl(e,t){var r=Math.abs(e.offset),n=Math.abs(t.offset);return e.isBound&&t.isBound?n-r:e.isBound?-1:t.isBound?1:e.isSnap&&t.isSnap?n-r:e.isSnap?-1:t.isSnap||r<qt?1:n<qt?-1:r-n}function _n(e,t){return e.slice().sort(function(r,n){var a=r.sign[t],i=n.sign[t],o=r.offset[t],s=n.offset[t];if(a){if(!i)return-1}else return 1;return tl({isBound:r.isBound,isSnap:r.isSnap,offset:o},{isBound:n.isBound,isSnap:n.isSnap,offset:s})})[0]}function Ip(e,t,r){var n=[];if(r)Math.abs(t[0])!==1||Math.abs(t[1])!==1?n.push([t,[-1,-1]],[t,[-1,1]],[t,[1,-1]],[t,[1,1]]):n.push([t,[e[0],-e[1]]],[t,[-e[0],e[1]]]),n.push([t,e]);else if(e[0]&&e[1]||!e[0]&&!e[1]){var a=e[0]?e:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(s){var l=[o*a[0],s*a[1]];t[0]===l[0]&&t[1]===l[1]||n.push([t,l])})})}else if(e[0]){var i=Math.abs(t[0])===1?[1]:[1,-1];i.forEach(function(o){n.push([[t[0],-1],[o*e[0],-1]],[[t[0],0],[o*e[0],0]],[[t[0],1],[o*e[0],1]])})}else if(e[1]){var i=Math.abs(t[1])===1?[1]:[1,-1];i.forEach(function(s){n.push([[-1,t[1]],[-1,s*e[1]]],[[0,t[1]],[0,s*e[1]]],[[1,t[1]],[1,s*e[1]]])})}return n}function el(e,t){var r=pa([t[0][0],t[1][0]]),n=pa([t[0][1],t[1][1]]);return{vertical:r<=e[0],horizontal:n<=e[1]}}function yi(e,t){var r=t[0],n=t[1],a=n[0]-r[0],i=n[1]-r[1];Math.abs(a)<qt&&(a=0),Math.abs(i)<qt&&(i=0);var o,s;if(!a)o=r[0],s=e[0];else if(!i)o=r[1],s=e[1];else{var l=i/a;o=l*(e[0]-r[0])+r[1],s=e[1]}return o-s}function rl(e,t,r,n){return n===void 0&&(n=qt),e.every(function(a){var i=yi(a,t),o=i<=0;return o===r||Math.abs(i)<=n})}function uo(e,t,r,n,a){return a===void 0&&(a=0),n&&t-a<=e||!n&&e<=r+a?{isBound:!0,offset:n?t-e:r-e}:{isBound:!1,offset:0}}function Pp(e,t){var r=t.line,n=t.centerSign,a=t.verticalSign,i=t.horizontalSign,o=t.lineConstants,s=e.props.innerBounds;if(!s)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var l=s.left,u=s.top,c=s.width,d=s.height,f=[[l,u],[l,u+d]],p=[[l,u],[l+c,u]],v=[[l+c,u],[l+c,u+d]],h=[[l,u+d],[l+c,u+d]];if(rl([[l,u],[l+c,u],[l,u+d],[l+c,u+d]],r,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var g=Ie(r,o,p,a),m=Ie(r,o,h,a),b=Ie(r,o,f,i),x=Ie(r,o,v,i),_=g.isBound&&m.isBound,S=g.isBound||m.isBound,y=b.isBound&&x.isBound,C=b.isBound||x.isBound,M=ir(g.offset,m.offset),E=ir(b.offset,x.offset),w=[0,0],T=!1,D=!1;return Math.abs(E)<Math.abs(M)?(w=[M,0],T=S,D=_):(w=[0,E],T=C,D=y),{isAllBound:D,isVerticalBound:S,isHorizontalBound:C,isBound:T,offset:w}}function Ie(e,t,r,n,a,i){var o=t[0],s=t[1],l=e[0],u=r[0],c=r[1],d=xn(c[1]-u[1]),f=xn(c[0]-u[0]),p=s,v=o,h=-o/s;if(f){if(!d){if(i&&!p)return{isBound:!1,offset:0};if(v){var x=(u[1]-l[1])/h+l[0];return uo(x,u[0],c[0],n,a)}else{var m=u[1]-l[1],b=Math.abs(m)<=(a||0);return{isBound:b,offset:b?m:0}}}}else{if(i&&!v)return{isBound:!1,offset:0};if(p){var g=h*(u[0]-l[0])+l[1];return uo(g,u[1],c[1],n,a)}else{var m=u[0]-l[0],b=Math.abs(m)<=(a||0);return{isBound:b,offset:b?m:0}}}return{isBound:!1,offset:0}}function nl(e,t,r){return t.map(function(n){var a=Pp(e,n),i=a.isBound,o=a.offset,s=a.isVerticalBound,l=a.isHorizontalBound,u=n.multiple,c=xe({datas:r,distX:o[0],distY:o[1]}).map(function(d,f){return d*(u[f]?2/u[f]:0)});return{sign:u,isBound:i,isVerticalBound:s,isHorizontalBound:l,isSnap:!1,offset:c}})}function Op(e,t,r){var n,a=Si(e,t,[0,0],!1).map(function(f){return k(k({},f),{multiple:f.multiple.map(function(p){return Math.abs(p)*2})})}),i=nl(e,a,r),o=_n(i,0),s=_n(i,1),l=0,u=0,c=o.isVerticalBound||s.isVerticalBound,d=o.isHorizontalBound||s.isHorizontalBound;return(c||d)&&(n=jd({datas:r,distX:-o.offset[0],distY:-s.offset[1]}),l=n[0],u=n[1]),{vertical:{isBound:c,offset:l},horizontal:{isBound:d,offset:u}}}function Bp(e,t){var r=[],n=e[0],a=e[1];return n&&a?r.push([[0,a*2],e,[-n,a]],[[n*2,0],e,[n,-a]]):n?(r.push([[n*2,0],[n,1],[n,-1]]),t&&r.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):a?(r.push([[0,a*2],[1,a],[-1,a]]),t&&r.push([[-1,0],[-1,a],[-1,-a]],[[1,0],[1,a],[1,-a]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r}function Si(e,t,r,n){var a=e.state,i=a.allMatrix,o=a.is3d,s=Be(i,100,100,o?4:3),l=Dt(s,[0,0]);return Bp(r,n).map(function(u){var c=u[0],d=u[1],f=u[2],p=[Dt(s,d),Dt(s,f)],v=kp(p),h=el(l,p),g=h.vertical,m=h.horizontal,b=yi(l,p)<=0;return{multiple:c,centerSign:b,verticalSign:g,horizontalSign:m,lineConstants:v,line:[Dt(t,d),Dt(t,f)]}})}function co(e,t,r,n){var a=n?e.map(function(i){return Nr(i,n)}):e;return[[a[0],a[1]],[a[1],a[3]],[a[3],a[2]],[a[2],a[0]]].some(function(i){var o=yi(r,i)<=0;return!rl(t,i,o)})}function zp(e){var t=e[0],r=e[1],n=r[0]-t[0],a=r[1]-t[1];if(!n)return Math.abs(t[0]);if(!a)return Math.abs(t[1]);var i=a/n;return Math.abs((-i*t[0]+t[1])/Math.sqrt(Math.pow(i,2)+1))}function Ap(e){var t=e[0],r=e[1],n=r[0]-t[0],a=r[1]-t[1];if(!n)return[t[0],0];if(!a)return[0,t[1]];var i=a/n,o=-i*t[0]+t[1];return[-o/(i+1/i),o/(i*i+1)]}function Lp(e,t,r,n,a){var i=e.props.innerBounds,o=a*Math.PI/180;if(!i)return[];var s=i.left,l=i.top,u=i.width,c=i.height,d=s-n[0],f=s+u-n[0],p=l-n[1],v=l+c-n[1],h=[[d,p],[f,p],[d,v],[f,v]],g=Dt(r,[0,0]);if(!co(r,h,g,0))return[];var m=[],b=h.map(function(x){return[de(x),Mt([0,0],x)]});return[[r[0],r[1]],[r[1],r[3]],[r[3],r[2]],[r[2],r[0]]].forEach(function(x){var _=Mt([0,0],Ap(x)),S=zp(x);m.push.apply(m,b.filter(function(y){var C=y[0];return C&&S<=C}).map(function(y){var C=y[0],M=y[1],E=Math.acos(C?S/C:0),w=M+E,T=M-E;return[o+w-_,o+T-_]}).reduce(function(y,C){return y.push.apply(y,C),y},[]).filter(function(y){return!co(t,h,g,y)}).map(function(y){return it(y*180/Math.PI,qt)}))}),m}function Gp(e){var t=e.props.innerBounds;if(!t)return{vertical:[],horizontal:[]};var r=e.getRect(),n=r.pos1,a=r.pos2,i=r.pos3,o=r.pos4,s=[n,a,i,o],l=Dt(s,[0,0]),u=t.left,c=t.top,d=t.width,f=t.height,p=[[u,c],[u,c+f]],v=[[u,c],[u+d,c]],h=[[u+d,c],[u+d,c+f]],g=[[u,c+f],[u+d,c+f]],m=Si(e,s,[0,0],!1),b=[],x=[],_={top:!1,bottom:!1,left:!1,right:!1};return m.forEach(function(S){var y=S.line,C=S.lineConstants,M=el(l,y),E=M.horizontal,w=M.vertical,T=Ie(y,C,v,w,1,!0),D=Ie(y,C,g,w,1,!0),R=Ie(y,C,p,E,1,!0),I=Ie(y,C,h,E,1,!0);T.isBound&&!_.top&&(b.push(c),_.top=!0),D.isBound&&!_.bottom&&(b.push(c+f),_.bottom=!0),R.isBound&&!_.left&&(x.push(u),_.left=!0),I.isBound&&!_.right&&(x.push(u+d),_.right=!0)}),{horizontal:b,vertical:x}}function Ci(e,t,r){var n=e||{},a=n.position,i=a===void 0?"client":a,o=n.left,s=o===void 0?-1/0:o,l=n.top,u=l===void 0?-1/0:l,c=n.right,d=c===void 0?1/0:c,f=n.bottom,p=f===void 0?1/0:f,v={position:i,left:s,top:u,right:d,bottom:p};return{vertical:fo(v,t,!0),horizontal:fo(v,r,!1)}}function Vn(e,t){var r=e.state,n=r.containerClientRect,a=n.clientHeight,i=n.clientWidth,o=n.clientLeft,s=n.clientTop,l=r.snapOffset,u=l.left,c=l.top,d=l.right,f=l.bottom,p=t||e.props.bounds||{},v=p.position||"client",h=v==="css",g=p.left,m=g===void 0?-1/0:g,b=p.top,x=b===void 0?-1/0:b,_=p.right,S=_===void 0?h?-1/0:1/0:_,y=p.bottom,C=y===void 0?h?-1/0:1/0:y;return h&&(S=i+d-u-S,C=a+f-c-C),{left:m+u-o,right:S+u-o,top:x+c-s,bottom:C+c-s}}function Fp(e,t,r){var n=Vn(e),a=n.left,i=n.top,o=n.right,s=n.bottom,l=r[0],u=r[1],c=et(r,t),d=c[0],f=c[1];Math.abs(d)<qt&&(d=0),Math.abs(f)<qt&&(f=0);var p=f>0,v=d>0,h={isBound:!1,offset:0,pos:0},g={isBound:!1,offset:0,pos:0};if(d===0&&f===0)return{vertical:h,horizontal:g};if(d===0)p?s<u&&(g.pos=s,g.offset=u-s):i>u&&(g.pos=i,g.offset=u-i);else if(f===0)v?o<l&&(h.pos=o,h.offset=l-o):a>l&&(h.pos=a,h.offset=l-a);else{var m=f/d,b=r[1]-m*l,x=0,_=0,S=!1;v&&o<=l?(x=m*o+b,_=o,S=!0):!v&&l<=a&&(x=m*a+b,_=a,S=!0),S&&(x<i||x>s)&&(S=!1),S||(p&&s<=u?(x=s,_=(x-b)/m,S=!0):!p&&u<=i&&(x=i,_=(x-b)/m,S=!0)),S&&(h.isBound=!0,h.pos=_,h.offset=l-_,g.isBound=!0,g.pos=x,g.offset=u-x)}return{vertical:h,horizontal:g}}function fo(e,t,r){var n=e[r?"left":"top"],a=e[r?"right":"bottom"],i=Math.min.apply(Math,t),o=Math.max.apply(Math,t),s=[];return n+1>i&&s.push({isBound:!0,offset:i-n,pos:n}),a-1<o&&s.push({isBound:!0,offset:o-a,pos:a}),s.length||s.push({isBound:!1,offset:0,pos:0}),s.sort(function(l,u){return Math.abs(u.offset)-Math.abs(l.offset)})}function po(e,t,r){var n=r?e.map(function(a){return Nr(a,r)}):e;return n.some(function(a){return a[0]<t.left&&Math.abs(a[0]-t.left)>.1||a[0]>t.right&&Math.abs(a[0]-t.right)>.1||a[1]<t.top&&Math.abs(a[1]-t.top)>.1||a[1]>t.bottom&&Math.abs(a[1]-t.bottom)>.1})}function Np(e,t,r){var n=de(e),a=Math.sqrt(n*n-t*t)||0;return[a,-a].sort(function(i,o){return Math.abs(i-e[r?0:1])-Math.abs(o-e[r?0:1])}).map(function(i){return Mt([0,0],r?[i,t]:[t,i])})}function $p(e,t,r,n,a){if(!e.props.bounds)return[];var i=a*Math.PI/180,o=Vn(e),s=o.left,l=o.top,u=o.right,c=o.bottom,d=s-n[0],f=u-n[0],p=l-n[1],v=c-n[1],h={left:d,top:p,right:f,bottom:v};if(!po(r,h,0))return[];var g=[];return[[d,0],[f,0],[p,1],[v,1]].forEach(function(m){var b=m[0],x=m[1];r.forEach(function(_){var S=Mt([0,0],_);g.push.apply(g,Np(_,b,x).map(function(y){return i+y-S}).filter(function(y){return!po(t,h,y)}).map(function(y){return it(y*180/Math.PI,qt)}))})}),g}function Vp(e,t){var r,n=e.direction,a=e.classNames,i=e.size,o=e.pos,s=e.zoom,l=e.key,u=n==="horizontal",c=u?"Y":"X";return t.createElement("div",{key:l,className:a.join(" "),style:(r={},r[u?"width":"height"]="".concat(i),r.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(c,"(-50%) scale").concat(c,"(").concat(s,")"),r)})}function wi(e,t){return Vp(k(k({},e),{classNames:nt([rt("line","guideline",e.direction)],e.classNames,!0).filter(function(r){return r}),size:e.size||"".concat(e.sizeValue,"px"),pos:e.pos||e.posValue.map(function(r){return"".concat(it(r,.1),"px")})}),t)}function vo(e,t,r,n,a,i,o,s){var l=e.props.zoom;return r.map(function(u,c){var d=u.type,f=u.pos,p=[0,0];return p[o]=n,p[o?0:1]=-a+f,wi({key:"".concat(t,"TargetGuideline").concat(c),classNames:[rt("target","bold",d)],posValue:p,sizeValue:i,zoom:l,direction:t},s)})}function ho(e,t,r,n,a,i){var o=e.props,s=o.zoom,l=o.isDisplayInnerSnapDigit,u=t==="horizontal"?ze:Ae,c=a[u.start],d=a[u.end];return r.filter(function(f){var p=f.hide,v=f.elementRect;if(p)return!1;if(l&&v){var h=v.rect;if(h[u.start]<=c&&d<=h[u.end])return!1}return!0}).map(function(f,p){var v=f.pos,h=f.size,g=f.element,m=f.className,b=[-n[0]+v[0],-n[1]+v[1]];return wi({key:"".concat(t,"-default-guideline-").concat(p),classNames:g?[rt("bold"),m]:[rt("normal"),m],direction:t,posValue:b,sizeValue:h,zoom:s},i)})}function _r(e,t,r,n,a,i,o,s){var l,u=e.props,c=u.snapDigit,d=c===void 0?0:c,f=u.isDisplaySnapDigit,p=f===void 0?!0:f,v=u.snapDistFormat,h=v===void 0?function(S,y){return S}:v,g=u.zoom,m=t==="horizontal"?"X":"Y",b=t==="vertical"?"height":"width",x=Math.abs(a),_=p?parseFloat(x.toFixed(d)):0;return s.createElement("div",{key:"".concat(t,"-").concat(r,"-guideline-").concat(n),className:rt("guideline-group",t),style:(l={left:"".concat(i[0],"px"),top:"".concat(i[1],"px")},l[b]="".concat(x,"px"),l)},wi({direction:t,classNames:[rt(r),o],size:"100%",posValue:[0,0],sizeValue:x,zoom:g},s),s.createElement("div",{className:rt("size-value","gap"),style:{transform:"translate".concat(m,"(-50%) scale(").concat(g,")")}},_>0?h(_,t):""))}function Wp(e,t,r,n){var a=e==="vertical"?0:1,i=e==="vertical"?1:0,o=a?ze:Ae,s=r[o.start],l=r[o.end];return Us(t,function(u){return u.pos[a]}).map(function(u){var c=[],d=[],f=[];return u.forEach(function(p){var v,h,g=p.element,m=p.elementRect.rect;if(m[o.end]<s)c.push(p);else if(l<m[o.start])d.push(p);else if(m[o.start]<=s&&l<=m[o.end]&&n){var b=p.pos,x={element:g,rect:k(k({},m),(v={},v[o.end]=m[o.start],v))},_={element:g,rect:k(k({},m),(h={},h[o.start]=m[o.end],h))},S=[0,0],y=[0,0];S[a]=b[a],S[i]=b[i],y[a]=b[a],y[i]=b[i]+p.size,c.push({type:e,pos:S,size:0,elementRect:x}),d.push({type:e,pos:y,size:0,elementRect:_})}}),c.sort(function(p,v){return v.pos[i]-p.pos[i]}),d.sort(function(p,v){return p.pos[i]-v.pos[i]}),{total:u,start:c,end:d,inner:f}})}function Xp(e,t,r,n,a){var i=e.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(s){var l=t.filter(function(g){return g.type===s}),u=s==="vertical"?1:0,c=u?0:1,d=Wp(s,l,n,i),f=u?Ae:ze,p=u?ze:Ae,v=n[f.start],h=n[f.end];d.forEach(function(g){var m=g.total,b=g.start,x=g.end,_=g.inner,S=r[c]+m[0].pos[c]-n[p.start],y=n;b.forEach(function(C){var M=C.elementRect.rect,E=y[f.start]-M[f.end];if(E>0){var w=[0,0];w[u]=r[u]+y[f.start]-v-E,w[c]=S,o.push(_r(e,s,"dashed",o.length,E,w,C.className,a))}y=M}),y=n,x.forEach(function(C){var M=C.elementRect.rect,E=M[f.start]-y[f.end];if(E>0){var w=[0,0];w[u]=r[u]+y[f.end]-v,w[c]=S,o.push(_r(e,s,"dashed",o.length,E,w,C.className,a))}y=M}),_.forEach(function(C){var M=C.elementRect.rect,E=v-M[f.start],w=M[f.end]-h,T=[0,0],D=[0,0];T[u]=r[u]-E,T[c]=S,D[u]=r[u]+h-v,D[c]=S,o.push(_r(e,s,"dashed",o.length,E,T,C.className,a)),o.push(_r(e,s,"dashed",o.length,w,D,C.className,a))})})}),o}function Hp(e,t,r,n,a){var i=[];return["horizontal","vertical"].forEach(function(o){var s=t.filter(function(g){return g.type===o}).slice(0,1),l=o==="vertical"?0:1,u=l?0:1,c=l?Ae:ze,d=l?ze:Ae,f=n[c.start],p=n[c.end],v=n[d.start],h=n[d.end];s.forEach(function(g){var m=g.gap,b=g.gapRects,x=Math.max.apply(Math,nt([v],b.map(function(y){var C=y.rect;return C[d.start]}),!1)),_=Math.min.apply(Math,nt([h],b.map(function(y){var C=y.rect;return C[d.end]}),!1)),S=(x+_)/2;x===_||S===(v+h)/2||b.forEach(function(y){var C=y.rect,M=y.className,E=[r[0],r[1]];if(C[c.end]<f)E[l]+=C[c.end]-f;else if(p<C[c.start])E[l]+=C[c.start]-f-m;else return;E[u]+=S-v,i.push(_r(e,l?"vertical":"horizontal","gap",i.length,m,E,M,a))})})}),i}function Yp(e,t,r,n){var a=t[0]-e[0],i=t[1]-e[1];if(Math.abs(a)<It&&(a=0),Math.abs(i)<It&&(i=0),!a)return n?[0,0]:[0,r];if(!i)return n?[r,0]:[0,0];var o=i/a,s=e[1]-o*e[0];if(n){var l=o*(t[0]+r)+s;return[r,l-t[1]]}else{var u=(t[1]+r-s)/o;return[u-t[0],r]}}function Aa(e,t,r,n,a){var i=Yp(e,t,r,n);if(!i)return{isOutside:!1,offset:[0,0]};var o=fe(e,t),s=fe(i,e),l=fe(i,t),u=s>o||l>o,c=xe({datas:a,distX:i[0],distY:i[1]}),d=c[0],f=c[1];return{offset:[d,f],isOutside:u}}function yn(e,t){return e.isBound?e.offset:t.isSnap?za(t).offset:0}function jp(e,t,r,n,a){var i=t[0],o=t[1],s=r[0],l=r[1],u=n[0],c=n[1],d=a[0],f=a[1],p=-d,v=-f;if(e&&i&&o){p=0,v=0;var h=[];if(s&&l?h.push([0,f],[d,0]):s?h.push([d,0]):l?h.push([0,f]):u&&c?h.push([0,f],[d,0]):u?h.push([d,0]):c&&h.push([0,f]),h.length){h.sort(function(x,_){return de(et([i,o],x))-de(et([i,o],_))});var g=h[0];if(g[0]&&Math.abs(i)>It)p=-g[0],v=o*Math.abs(i+p)/Math.abs(i)-o;else if(g[1]&&Math.abs(o)>It){var m=o;v=-g[1],p=i*Math.abs(o+v)/Math.abs(m)-i}if(e&&l&&s)if(Math.abs(p)>It&&Math.abs(p)<Math.abs(d)){var b=Math.abs(d)/Math.abs(p);p*=b,v*=b}else if(Math.abs(v)>It&&Math.abs(v)<Math.abs(f)){var b=Math.abs(f)/Math.abs(v);p*=b,v*=b}else p=ir(-d,p),v=ir(-f,v)}}else p=i||s?-d:0,v=o||l?-f:0;return[p,v]}function Up(e,t,r,n,a,i){if(!hr(e,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=hi(i.absolutePoses,[t,r]),s=le(o),l=s.left,u=s.right,c=s.top,d=s.bottom,f={horizontal:o.map(function(I){return I[1]}),vertical:o.map(function(I){return I[0]})},p=xi(e.props.snapDirections),v=_i(p,{left:l,right:u,top:c,bottom:d,center:(l+u)/2,middle:(c+d)/2}),h=Wn(e,a,v,f),g=h.vertical,m=h.horizontal,b=Op(e,o,i),x=b.vertical,_=b.horizontal,S=g.isSnap,y=m.isSnap,C=g.isBound||x.isBound,M=m.isBound||_.isBound,E=ir(g.offset,x.offset),w=ir(m.offset,_.offset),T=jp(n,[t,r],[C,M],[S,y],[E,w]),D=T[0],R=T[1];return[{isBound:C,isSnap:S,offset:D},{isBound:M,isSnap:y,offset:R}]}function Wn(e,t,r,n){n===void 0&&(n=r);var a=Ci(Vn(e),n.vertical,n.horizontal),i=a.horizontal,o=a.vertical,s=t?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:$n(e,r.vertical,r.horizontal),l=s.horizontal,u=s.vertical,c=yn(i[0],l),d=yn(o[0],u),f=Math.abs(c),p=Math.abs(d);return{horizontal:{isBound:i[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:c,dist:f,bounds:i,snap:l},vertical:{isBound:o[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:d,dist:p,bounds:o,snap:u}}}function go(e,t,r,n,a){var i=Ci(t,r,n),o=i.horizontal,s=i.vertical,l=Qs(e,r,n,a),u=l.horizontal,c=l.vertical,d=yn(o[0],u),f=yn(s[0],c),p=Math.abs(d),v=Math.abs(f);return{horizontal:{isBound:o[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:d,dist:p,bounds:o,snap:u},vertical:{isBound:s[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:f,dist:v,bounds:s,snap:c}}}function qp(e,t,r,n){var a=Mt(e,t)/Math.PI*180,i=r.vertical,o=i.isBound,s=i.isSnap,l=i.dist,u=r.horizontal,c=u.isBound,d=u.isSnap,f=u.dist,p=a%180,v=p<3||p>177,h=p>87&&p<93;return f<l&&(o||s&&!h&&(!n||!v))?"vertical":c||d&&!v&&(!n||!h)?"horizontal":""}function Kp(e,t,r,n,a,i){return r.map(function(o){var s=o[0],l=o[1],u=Dt(t,s),c=Dt(t,l),d=n?Zp(e,u,c,a):Wn(e,a,{vertical:[c[0]],horizontal:[c[1]]}),f=d.horizontal,p=f.offset,v=f.isBound,h=f.isSnap,g=d.vertical,m=g.offset,b=g.isBound,x=g.isSnap,_=et(l,s);if(!m&&!p)return{isBound:b||v,isSnap:x||h,sign:_,offset:[0,0]};var S=qp(u,c,d,n);if(!S)return{sign:_,isBound:!1,isSnap:!1,offset:[0,0]};var y=S==="vertical",C=[0,0];return!n&&Math.abs(l[0])===1&&Math.abs(l[1])===1&&s[0]!==l[0]&&s[1]!==l[1]?C=xe({datas:i,distX:-m,distY:-p}):C=Aa(u,c,-(y?m:p),y,i).offset,C=C.map(function(M,E){return M*(_[E]?2/_[E]:0)}),{sign:_,isBound:y?b:v,isSnap:y?x:h,offset:C}})}function mo(e,t){return e.isBound?e.offset:t.isSnap?t.offset:0}function Zp(e,t,r,n){var a=Fp(e,t,r),i=a.horizontal,o=a.vertical,s=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:Tp(e,t,r),l=s.horizontal,u=s.vertical,c=mo(i,l),d=mo(o,u),f=Math.abs(c),p=Math.abs(d);return{horizontal:{isBound:i.isBound,isSnap:l.isSnap,offset:c,dist:f},vertical:{isBound:o.isBound,isSnap:u.isSnap,offset:d,dist:p}}}function Jp(e,t,r,n,a){var i=[-r[0],-r[1]],o=e.state,s=o.width,l=o.height,u=e.props.bounds,c=1/0,d=1/0;if(u){var f=[[r[0],-r[1]],[-r[0],r[1]]],p=u.left,v=p===void 0?-1/0:p,h=u.top,g=h===void 0?-1/0:h,m=u.right,b=m===void 0?1/0:m,x=u.bottom,_=x===void 0?1/0:x;f.forEach(function(S){var y=S[0]!==i[0],C=S[1]!==i[1],M=Dt(t,S),E=Mt(n,M)*360/Math.PI;if(C){var w=M.slice();(Math.abs(E-360)<2||Math.abs(E-180)<2)&&(w[1]=n[1]);var T=Aa(n,w,(n[1]<M[1]?_:g)-M[1],!1,a),D=T.offset,R=D[1],I=T.isOutside;isNaN(R)||(d=l+(I?1:-1)*Math.abs(R))}if(y){var w=M.slice();(Math.abs(E-90)<2||Math.abs(E-270)<2)&&(w[0]=n[0]);var B=Aa(n,w,(n[0]<M[0]?b:v)-M[0],!0,a),V=B.offset[0],j=B.isOutside;isNaN(V)||(c=s+(j?1:-1)*Math.abs(V))}})}return{maxWidth:c,maxHeight:d}}function La(e){var t=e.state,r=t.containerClientRect,n=t.hasFixed,a=r.overflow,i=r.scrollHeight,o=r.scrollWidth,s=r.clientHeight,l=r.clientWidth,u=r.clientLeft,c=r.clientTop,d=e.props,f=d.snapGap,p=f===void 0?!0:f,v=d.verticalGuidelines,h=d.horizontalGuidelines,g=d.snapThreshold,m=g===void 0?5:g,b=d.snapGridWidth,x=b===void 0?0:b,_=d.snapGridHeight,S=_===void 0?0:_,y=d.maxSnapElementGuidelineDistance,C=y===void 0?1/0:y,M=le(Qt(e.state)),E=M.top,w=M.left,T=M.bottom,D=M.right,R={top:E,left:w,bottom:T,right:D,center:(w+D)/2,middle:(E+T)/2},I=ev(e),B=nt([],I,!0);p&&B.push.apply(B,Qp(e,R,m)),B.push.apply(B,tv(x,S,a?o:l,a?i:s,u,c));var V=k({},t.snapOffset||{left:0,top:0,bottom:0,right:0});if(n){var j=r.left,W=r.top;V.left+=j,V.top+=W,V.right+=j,V.bottom+=W}return B.push.apply(B,il(h||!1,v||!1,a?o:l,a?i:s,u,c,V)),B=B.filter(function(X){var z=X.element,Y=X.elementRect,G=X.type;if(!z||!Y)return!0;var A=Y.rect;return al(R,A,G,C)}),B}function Qp(e,t,r){var n=e.props,a=n.maxSnapElementGuidelineDistance,i=a===void 0?1/0:a,o=n.maxSnapElementGapDistance,s=o===void 0?1/0:o,l=e.state.elementRects,u=[];return[["vertical",ze,Ae],["horizontal",Ae,ze]].forEach(function(c){var d=c[0],f=c[1],p=c[2],v=t[f.start],h=t[f.end],g=t[f.center],m=t[p.start],b=t[p.end];function x(y){var C=y.rect;return C[f.end]<v+r?v-C[f.end]:h-r<C[f.start]?C[f.start]-h:-1}var _=l.filter(function(y){var C=y.rect;return C[p.start]>b||C[p.end]<m?!1:x(y)>0}).sort(function(y,C){return x(y)-x(C)}),S=[];_.forEach(function(y){_.forEach(function(C){if(y!==C){var M=y.rect,E=C.rect,w=M[p.start],T=M[p.end],D=E[p.start],R=E[p.end];w>R||D>T||S.push([y,C])}})}),S.forEach(function(y){var C=y[0],M=y[1],E=C.rect,w=M.rect,T=E[f.start],D=E[f.end],R=w[f.start],I=w[f.end],B=0,V=0,j=!1,W=!1,X=!1;if(D<=v&&h<=R){if(W=!0,B=(R-D-(h-v))/2,V=D+B+(h-v)/2,Math.abs(V-g)>r)return}else if(D<R&&I<v+r){if(j=!0,B=R-D,V=I+B,Math.abs(V-v)>r)return}else if(D<R&&h-r<T){if(X=!0,B=R-D,V=T-B,Math.abs(V-h)>r)return}else return;B&&al(t,w,d,i)&&(B>s||u.push({type:d,pos:d==="vertical"?[V,0]:[0,V],element:M.element,size:0,className:M.className,isStart:j,isCenter:W,isEnd:X,gap:B,hide:!0,gapRects:[C,M]}))})}),u}function tv(e,t,r,n,a,i){a===void 0&&(a=0),i===void 0&&(i=0);var o=[];if(t)for(var s=0;s<=n;s+=t)o.push({type:"horizontal",pos:[0,it(s-i,.1)],size:r,hide:!0});if(e)for(var s=0;s<=r;s+=e)o.push({type:"vertical",pos:[it(s-a,.1),0],size:n,hide:!0});return o}function al(e,t,r,n){return r==="horizontal"?Math.abs(e.right-t.left)<=n||Math.abs(e.left-t.right)<=n||e.left<=t.right&&t.left<=e.right:r==="vertical"?Math.abs(e.bottom-t.top)<=n||Math.abs(e.top-t.bottom)<=n||e.top<=t.bottom&&t.top<=e.bottom:!0}function ev(e){var t=e.state,r=e.props.elementGuidelines,n=r===void 0?[]:r;if(!n.length)return t.elementRects=[],[];var a=(t.elementRects||[]).filter(function(f){return!f.refresh}),i=n.map(function(f){return he(f)&&"element"in f?k(k({},f),{element:je(f.element,!0)}):{element:je(f,!0)}}).filter(function(f){return f.element}),o=ud(a.map(function(f){return f.element}),i.map(function(f){return f.element})),s=o.maintained,l=o.added,u=[];s.forEach(function(f){var p=f[0],v=f[1];u[v]=a[p]}),rv(e,l.map(function(f){return i[f]})).map(function(f,p){u[l[p]]=f}),t.elementRects=u;var c=xi(e.props.elementSnapDirections),d=[];return u.forEach(function(f){var p=f.element,v=f.top,h=v===void 0?c.top:v,g=f.left,m=g===void 0?c.left:g,b=f.right,x=b===void 0?c.right:b,_=f.bottom,S=_===void 0?c.bottom:_,y=f.center,C=y===void 0?c.center:y,M=f.middle,E=M===void 0?c.middle:M,w=f.className,T=f.rect,D=_i({top:h,right:x,left:m,bottom:S,center:C,middle:E},T),R=D.horizontal,I=D.vertical,B=T.top,V=T.left,j=T.right-V,W=T.bottom-B,X=[j,W];I.forEach(function(z){d.push({type:"vertical",element:p,pos:[it(z,.1),B],size:W,sizes:X,className:w,elementRect:f})}),R.forEach(function(z){d.push({type:"horizontal",element:p,pos:[V,it(z,.1)],size:j,sizes:X,className:w,elementRect:f})})}),d}function il(e,t,r,n,a,i,o){a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var s=[],l=o.left,u=o.top,c=o.bottom,d=o.right,f=r+d-l,p=n+c-u;return e&&e.forEach(function(v){var h=he(v)?v:{pos:v};s.push({type:"horizontal",pos:[l,it(h.pos-i+u,.1)],size:f,className:h.className})}),t&&t.forEach(function(v){var h=he(v)?v:{pos:v};s.push({type:"vertical",pos:[it(h.pos-a+l,.1),u],size:p,className:h.className})}),s}function rv(e,t){if(!t.length)return[];var r=e.state,n=r.containerClientRect,a=r.targetClientRect,i=a.top,o=a.left,s=r.rootMatrix,l=r.is3d,u=l?4:3,c=Mp(s,n,u),d=c[0],f=c[1],p=Qt(r),v=Oe(p),h=v.minX,g=v.minY,m=et([h,g],Xe(s,[o-d,i-f],u)).map(function(_){return pp(_)}),b=m[0],x=m[1];return t.map(function(_){var S=_.element.getBoundingClientRect(),y=S.left-d,C=S.top-f,M=C+S.height,E=y+S.width,w=Xe(s,[y,C],u),T=w[0],D=w[1],R=Xe(s,[E,M],u),I=R[0],B=R[1];return k(k({},_),{rect:{left:T+b,right:I+b,top:D+x,bottom:B+x,center:(T+I)/2+b,middle:(D+B)/2+x}})})}function an(e){var t=e.state,r=t.container,n=e.props.snapContainer||r;if(t.snapContainer===n&&t.guidelines&&t.guidelines.length)return!1;var a=t.containerClientRect,i={left:0,top:0,bottom:0,right:0};if(r!==n){var o=je(n,!0);if(o){var s=xr(o),l=oo(t,[s.left-a.left,s.top-a.top]),u=oo(t,[s.right-a.right,s.bottom-a.bottom]);i.left=it(l[0],1e-5),i.top=it(l[1],1e-5),i.right=it(u[0],1e-5),i.bottom=it(u[1],1e-5)}}return t.snapContainer=n,t.snapOffset=i,t.guidelines=La(e),t.enableSnap=!0,!0}function ol(e,t,r,n,a,i){var o=Be(e,t,r,i?4:3),s=Dt(o,n);return hi(o,et(a,s))}function nv(e,t,r,n,a,i){var o=i.fixedDirection,s=Ip(r,o,n),l=Si(e,t,r,n),u=nt(nt([],Kp(e,t,s,n,a,i),!0),nl(e,l,i),!0),c=_n(u,0),d=_n(u,1);return{width:{isBound:c.isBound,offset:c.offset[0]},height:{isBound:d.isBound,offset:d.offset[1]}}}function av(e,t,r,n,a,i,o,s,l){var u=Dt(t,o),c=Wn(e,s,{vertical:[u[0]],horizontal:[u[1]]}),d=c.horizontal.offset,f=c.vertical.offset;if(it(f,Ta)||it(d,Ta)){var p=xe({datas:l,distX:-f,distY:-d}),v=p[0],h=p[1],g=Math.min(a||1/0,r+o[0]*v),m=Math.min(i||1/0,n+o[1]*h);return[g-r,m-n]}return[0,0]}function sl(e,t,r,n,a,i,o,s){for(var l=Qt(e.state),u=e.props.keepRatio,c=0,d=0,f=0;f<2;++f){var p=t(c,d),v=nv(e,p,a,u,o,s),h=v.width,g=v.height,m=h.isBound,b=g.isBound,x=h.offset,_=g.offset;if(f===1&&(m||(x=0),b||(_=0)),f===0&&o&&!m&&!b)return[0,0];if(u){var S=Math.abs(x)*(r?1/r:1),y=Math.abs(_)*(n?1/n:1),C=m&&b?S<y:b||!m&&S<y;C?x=r*_/n:_=n*x/r}c+=x,d+=_}if(a[0]&&a[1]){var M=Jp(e,l,a,i,s),E=M.maxWidth,w=M.maxHeight,T=av(e,t(c,d).map(function(I){return I.map(function(B){return it(B,Ta)})}),r+c,n+d,E,w,a,o,s),x=T[0],_=T[1];c+=x,d+=_}return[c,d]}function iv(e,t,r){if(!hr(e,"rotatable"))return{isSnap:!1,rotation:r};var n=t.pos1,a=t.pos2,i=t.pos3,o=t.pos4,s=t.origin,l=r*Math.PI/180,u=[n,a,i,o].map(function(p){return et(p,s)}),c=u.map(function(p){return Nr(p,l)}),d=nt(nt([],$p(e,u,c,s,r),!0),Lp(e,u,c,s,r),!0);d.sort(function(p,v){return Math.abs(p-r)-Math.abs(v-r)});var f=d.length>0;return{isSnap:f,rotation:f?d[0]:r}}function ov(e,t,r,n,a,i,o){if(!hr(e,"resizable"))return[0,0];var s=o.fixedDirection,l=o.nextAllMatrix,u=e.state,c=u.allMatrix,d=u.is3d;return sl(e,function(f,p){return ol(l||c,t+f,r+p,s,a,d)},t,r,n,a,i,o)}function sv(e,t,r,n,a){if(!hr(e,"scalable"))return[0,0];var i=a.startOffsetWidth,o=a.startOffsetHeight,s=a.fixedPosition,l=a.fixedDirection,u=a.is3d,c=sl(e,function(d,f){return ol(Jd(a,ft(t,[d/i,f/o])),i,o,l,s,u)},i,o,r,s,n,a);return[c[0]/i,c[1]/o]}function lv(e,t){t.absolutePoses=Qt(e.state)}function bo(e){var t=[];return e.forEach(function(r){r.guidelineInfos.forEach(function(n){var a=n.guideline;t.indexOf(a)>-1||t.push(a)})}),t}function xo(e,t,r,n,a,i){var o=Ci(Vn(e,i),t,r),s=o.vertical,l=o.horizontal;s.forEach(function(f){f.isBound&&n.push({type:"bounds",pos:f.pos})}),l.forEach(function(f){f.isBound&&a.push({type:"bounds",pos:f.pos})});var u=Gp(e),c=u.vertical,d=u.horizontal;c.forEach(function(f){Se(n,function(p){var v=p.type,h=p.pos;return v==="bounds"&&h===f})>=0||n.push({type:"bounds",pos:f})}),d.forEach(function(f){Se(a,function(p){var v=p.type,h=p.pos;return v==="bounds"&&h===f})>=0||a.push({type:"bounds",pos:f})})}var uv=mi("",["resizable","scalable"]),cv={name:"snappable",dragRelation:"strong",props:{snappable:[Boolean,Array],snapContainer:Object,snapDirections:[Boolean,Object],elementSnapDirections:[Boolean,Object],snapGap:Boolean,snapGridWidth:Number,snapGridHeight:Number,isDisplaySnapDigit:Boolean,isDisplayInnerSnapDigit:Boolean,snapDigit:Number,snapThreshold:Number,snapRenderThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object,snapDistFormat:Function,maxSnapElementGuidelineDistance:Number,maxSnapElementGapDistance:Number},events:{onSnap:"snap"},css:[`:host {
    --bounds-color: #d66;
}
.guideline {
    pointer-events: none;
    z-index: 2;
}
.guideline.bounds {
    background: #d66;
    background: var(--bounds-color);
}
.guideline-group {
    position: absolute;
    top: 0;
    left: 0;
}
.guideline-group .size-value {
    position: absolute;
    color: #f55;
    font-size: 12px;
    font-weight: bold;
}
.guideline-group.horizontal .size-value {
    transform-origin: 50% 100%;
    transform: translateX(-50%);
    left: 50%;
    bottom: 5px;
}
.guideline-group.vertical .size-value {
    transform-origin: 0% 50%;
    top: 50%;
    transform: translateY(-50%);
    left: 5px;
}
.guideline.gap {
    background: #f55;
}
.size-value.gap {
    color: #f55;
}
`],render:function(e,t){var r=e.state,n=r.top,a=r.left,i=r.pos1,o=r.pos2,s=r.pos3,l=r.pos4,u=r.snapRenderInfo,c=e.props.snapRenderThreshold,d=c===void 0?1:c;if(!u||!u.render||!hr(e,""))return[];r.guidelines=La(e);var f=Math.min(i[0],o[0],s[0],l[0]),p=Math.min(i[1],o[1],s[1],l[1]),v=u.externalPoses||[],h=Qt(e.state),g=[],m=[],b=[],x=[],_=[],S=le(h),y=S.width,C=S.height,M=S.top,E=S.left,w=S.bottom,T=S.right,D={left:E,right:T,top:M,bottom:w,center:(E+T)/2,middle:(M+w)/2},R=v.length>0,I=R?le(v):{};if(!u.request){if(u.direction&&_.push(Rp(e,h,u.direction,d)),u.snap){var B=le(h);u.center&&(B.middle=(B.top+B.bottom)/2,B.center=(B.left+B.right)/2),_.push(so(e,B,d))}R&&(u.center&&(I.middle=(I.top+I.bottom)/2,I.center=(I.left+I.right)/2),_.push(so(e,I,d))),_.forEach(function(X){var z=X.vertical.posInfos,Y=X.horizontal.posInfos;g.push.apply(g,z.filter(function(G){var A=G.guidelineInfos;return A.some(function(N){var L=N.guideline;return!L.hide})}).map(function(G){return{type:"snap",pos:G.pos}})),m.push.apply(m,Y.filter(function(G){var A=G.guidelineInfos;return A.some(function(N){var L=N.guideline;return!L.hide})}).map(function(G){return{type:"snap",pos:G.pos}})),b.push.apply(b,bo(z)),x.push.apply(x,bo(Y))})}xo(e,[E,T],[M,w],g,m),R&&xo(e,[I.left,I.right],[I.top,I.bottom],g,m,u.externalBounds);var V=nt(nt([],b,!0),x,!0),j=V.filter(function(X){return X.element&&!X.gapRects}),W=V.filter(function(X){return X.gapRects}).sort(function(X,z){return X.gap-z.gap});return Z(e,"onSnap",{guidelines:V.filter(function(X){var z=X.element;return!z}),elements:j,gaps:W},!0),nt(nt(nt(nt(nt(nt([],Xp(e,j,[f,p],D,t),!0),Hp(e,W,[f,p],D,t),!0),ho(e,"horizontal",x,[a,n],D,t),!0),ho(e,"vertical",b,[a,n],D,t),!0),vo(e,"horizontal",m,f,n,y,0,t),!0),vo(e,"vertical",g,p,a,C,1,t),!0)},dragStart:function(e,t){e.state.snapRenderInfo={request:t.isRequest,snap:!0,center:!0},an(e)},drag:function(e){var t=e.state;an(e)||(t.guidelines=La(e)),t.snapRenderInfo&&(t.snapRenderInfo.render=!0)},pinchStart:function(e){this.unset(e)},dragEnd:function(e){this.unset(e)},dragControlCondition:function(e,t){if(uv(e,t)||Fa(e,t))return!0;if(!t.isRequest&&t.inputEvent)return At(t.inputEvent.target,rt("snap-control"))},dragControlStart:function(e){e.state.snapRenderInfo=null,an(e)},dragControl:function(e){this.drag(e)},dragControlEnd:function(e){this.unset(e)},dragGroupStart:function(e,t){this.dragStart(e,t)},dragGroup:function(e){this.drag(e)},dragGroupEnd:function(e){this.unset(e)},dragGroupControlStart:function(e){e.state.snapRenderInfo=null,an(e)},dragGroupControl:function(e){this.drag(e)},dragGroupControlEnd:function(e){this.unset(e)},unset:function(e){var t=e.state;t.enableSnap=!1,t.guidelines=[],t.snapRenderInfo=null,t.elementRects=[]}};function ll(e,t,r,n){var a=e.getState(),i=a.renderPoses,o=a.rotation,s=a.direction,l=Ye(e.props,t).zoom,u=s>0?1:-1,c=o/Math.PI*180,d={},f=e.renderState;f.renderDirectionMap||(f.renderDirectionMap={});var p=f.renderDirectionMap;return r.forEach(function(v){var h=v.dir;d[h]=!0}),r.map(function(v){var h=v.data,g=v.classNames,m=v.dir,b=fi[m];if(!b||!d[m])return null;p[m]=!0;var x=(it(c,15)+u*Ds[m]+720)%180,_={};return pr(h).forEach(function(S){_["data-".concat(S)]=h[S]}),n.createElement("div",k({className:rt.apply(void 0,nt(["control","direction",m,t],g,!1)),"data-rotation":x,"data-direction":m},_,{key:"direction-".concat(m),style:vi.apply(void 0,nt([o,l],b.map(function(S){return i[S]}),!1))}))})}function ul(e,t,r,n){var a=Ye(e.props,r).renderDirections,i=a===void 0?t:a;if(!i)return[];var o=i===!0?ci:i;return ll(e,r,o.map(function(s){return{data:{},classNames:[],dir:s}}),n)}function fv(e,t){var r=e.renderState;r.renderDirectionMap||(r.renderDirectionMap={});var n=e.getState(),a=n.renderPoses,i=n.rotation,o=n.direction,s=r.renderDirectionMap,l=e.props.zoom,u=o>0?1:-1,c=i/Math.PI*180;return pr(s).map(function(d){var f=fi[d];if(!f)return null;var p=(it(c,15)+u*Ds[d]+720)%180;return t.createElement("div",{className:rt("around-control"),"data-rotation":p,"data-direction":d,key:"direction-around-".concat(d),style:vi.apply(void 0,nt([i,l],f.map(function(v){return a[v]}),!1))})})}function Tr(e,t,r,n,a,i){for(var o=[],s=6;s<arguments.length;s++)o[s-6]=arguments[s];var l=Mt(r,n),u=t?it(l/Math.PI*180,15)%180:-1;return e.createElement("div",{key:"line-".concat(i),className:rt.apply(void 0,nt(["line","direction",t?"edge":"",t],o,!1)),"data-rotation":u,"data-line-key":i,"data-direction":t,style:br(r,n,a,l)})}function cl(e,t,r,n,a){var i=r===!0?Wd:r;return i.map(function(o,s){var l=fi[o],u=l[0],c=l[1];if(c!=null)return Tr(e,o,n[u],n[c],a,"".concat(t,"Edge").concat(s),t)}).filter(Boolean)}function fl(e){return function(t,r){var n=Ye(t.props,e).edge;return n&&(n===!0||n.length)?nt(nt([],cl(r,e,n,t.getState().renderPoses,t.props.zoom),!0),dv(t,e,r),!0):dl(t,e,r)}}function dl(e,t,r){return ul(e,ci,t,r)}function dv(e,t,r){return ul(e,["nw","ne","sw","se"],t,r)}var Yt={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number,startDragRotate:Number,edgeDraggable:Boolean},events:{onDragStart:"dragStart",onDrag:"drag",onDragEnd:"dragEnd",onDragGroupStart:"dragGroupStart",onDragGroup:"dragGroup",onDragGroupEnd:"dragGroupEnd"},requestStyle:function(){return["left","top","right","bottom"]},render:function(e,t){var r=e.props,n=r.throttleDragRotate,a=r.zoom,i=e.getState(),o=i.dragInfo,s=i.beforeOrigin;if(!n||!o)return[];var l=o.dist;if(!l[0]&&!l[1])return[];var u=de(l),c=Mt(l,[0,0]);return[t.createElement("div",{className:rt("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(u,"px"),transform:"translate(".concat(s[0],"px, ").concat(s[1],"px) rotate(").concat(c,"rad) scaleY(").concat(a,")")}})]},dragStart:function(e,t){var r=t.datas,n=t.parentEvent,a=t.parentGesto,i=e.state,o=i.gestos,s=i.style;if(o.draggable)return!1;o.draggable=a||e.targetGesto,r.datas={},r.left=parseFloat(s.left||"")||0,r.top=parseFloat(s.top||"")||0,r.bottom=parseFloat(s.bottom||"")||0,r.right=parseFloat(s.right||"")||0,r.startValue=[0,0],qe(e,t),Gn(t,"translate"),lv(e,r),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0];var l=ot(e,t,k({set:function(c){r.startValue=c}},Ln(t))),u=n||Z(e,"onDragStart",l);return u!==!1?(r.isDrag=!0,e.state.dragInfo={startRect:e.getRect(),dist:[0,0]}):(o.draggable=null,r.isPinch=!1),r.isDrag?l:!1},drag:function(e,t){if(t){zn(t,"translate");var r=t.datas,n=t.parentEvent,a=t.parentFlag,i=t.isPinch,o=t.isRequest,s=t.deltaOffset,l=t.distX,u=t.distY,c=r.isDrag,d=r.prevDist,f=r.prevBeforeDist,p=r.startValue;if(c){s&&(l+=s[0],u+=s[1]);var v=e.props,h=v.parentMoveable,g=n?0:v.throttleDrag||0,m=n?0:v.throttleDragRotate||0,b=0,x=!1,_=!1,S=!1,y=!1;if(!n&&m>0&&(l||u)){var C=v.startDragRotate||0,M=it(C+Mt([0,0],[l,u])*180/Math.PI,m)-C,E=u*Math.abs(Math.cos((M-90)/180*Math.PI)),w=l*Math.abs(Math.cos(M/180*Math.PI)),T=de([w,E]);b=M*Math.PI/180,l=T*Math.cos(b),u=T*Math.sin(b)}if(!i&&!n&&!a){var D=Up(e,l,u,m,o||s,r),R=D[0],I=D[1];x=R.isSnap,_=R.isBound,S=I.isSnap,y=I.isBound;var B=R.offset,V=I.offset;l+=B,u+=V}var j=ft(Rs({datas:r,distX:l,distY:u}),p),W=ft(Yd({datas:r,distX:l,distY:u}),p);ji(W,qt),ji(j,qt),m||(!x&&!_&&(W[0]=it(W[0],g),j[0]=it(j[0],g)),!S&&!y&&(W[1]=it(W[1],g),j[1]=it(j[1],g)));var X=et(j,p),z=et(W,p),Y=et(z,d),G=et(X,f);r.prevDist=z,r.prevBeforeDist=X,r.passDelta=Y,r.passDist=z;var A=r.left+X[0],N=r.top+X[1],L=r.right-X[0],$=r.bottom-X[1],U=An(r,"translate(".concat(W[0],"px, ").concat(W[1],"px)"),"translate(".concat(z[0],"px, ").concat(z[1],"px)"));if(di(t,U),e.state.dragInfo.dist=n?[0,0]:z,!(!n&&!h&&Y.every(function(lt){return!lt})&&G.some(function(lt){return!lt}))){var Q=e.state,at=Q.width,J=Q.height,tt=ot(e,t,k({transform:U,dist:z,delta:Y,translate:W,beforeDist:X,beforeDelta:G,beforeTranslate:j,left:A,top:N,right:L,bottom:$,width:at,height:J,isPinch:i},Ut({transform:U},t)));return!n&&Z(e,"onDrag",tt),tt}}}},dragAfter:function(e,t){var r=t.datas,n=r.deltaOffset;return n[0]||n[1]?(r.deltaOffset=[0,0],this.drag(e,k(k({},t),{deltaOffset:n}))):!1},dragEnd:function(e,t){var r=t.parentEvent,n=t.datas;if(e.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var a=ae(e,t,{});return!r&&Z(e,"onDragEnd",a),a}},dragGroupStart:function(e,t){var r=t.datas,n=t.clientX,a=t.clientY,i=this.dragStart(e,t);if(!i)return!1;var o=ia(e,this,"dragStart",[n||0,a||0],t,!1,"draggable"),s=k(k({},i),{targets:e.props.targets,events:o}),l=Z(e,"onDragGroupStart",s);return r.isDrag=l!==!1,r.isDrag?i:!1},dragGroup:function(e,t){var r=t.datas;if(r.isDrag){var n=this.drag(e,t),a=t.datas.passDelta,i=ia(e,this,"drag",a,t,!1,"draggable");if(n){var o=k({targets:e.props.targets,events:i},n);return Z(e,"onDragGroup",o),o}}},dragGroupEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isDrag){this.dragEnd(e,t);var a=ia(e,this,"dragEnd",[0,0],t,!1,"draggable");return Z(e,"onDragGroupEnd",ae(e,t,{targets:e.props.targets,events:a})),r}},request:function(e){var t={},r=e.getRect(),n=0,a=0;return{isControl:!1,requestStart:function(){return{datas:t}},request:function(i){return"x"in i?n=i.x-r.left:"deltaX"in i&&(n+=i.deltaX),"y"in i?a=i.y-r.top:"deltaY"in i&&(a+=i.deltaY),{datas:t,distX:n,distY:a}},requestEnd:function(){return{datas:t,isDrag:!0}}}},unset:function(e){e.state.gestos.draggable=null,e.state.dragInfo=null}},_o=mi("resizable"),Ga={name:"resizable",ableGroup:"size",canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,keepRatio:Boolean,resizeFormat:Function,keepRatioFinally:Boolean,edge:Boolean,checkResizableError:Boolean},events:{onResizeStart:"resizeStart",onBeforeResize:"beforeResize",onResize:"resize",onResizeEnd:"resizeEnd",onResizeGroupStart:"resizeGroupStart",onBeforeResizeGroup:"beforeResizeGroup",onResizeGroup:"resizeGroup",onResizeGroupEnd:"resizeGroupEnd"},render:fl("resizable"),dragControlCondition:_o,viewClassName:gi("resizable"),dragControlStart:function(e,t){var r,n=t.inputEvent,a=t.isPinch,i=t.isGroup,o=t.parentDirection,s=t.parentGesto,l=t.datas,u=t.parentFixedDirection,c=t.parentEvent,d=Hs(o,a,n,l),f=e.state,p=f.target,v=f.width,h=f.height,g=f.gestos;if(!d||!p||g.resizable)return!1;g.resizable=s||e.controlGesto,!a&&qe(e,t),l.datas={},l.direction=d,l.startOffsetWidth=v,l.startOffsetHeight=h,l.prevWidth=0,l.prevHeight=0,l.minSize=[0,0],l.startWidth=f.inlineCSSWidth||f.cssWidth,l.startHeight=f.inlineCSSHeight||f.cssHeight,l.maxSize=[1/0,1/0],i||(l.minSize=[f.minOffsetWidth,f.minOffsetHeight],l.maxSize=[f.maxOffsetWidth,f.maxOffsetHeight]);var m=e.props.transformOrigin||"% %";l.transformOrigin=m&&ne(m)?m.split(" "):m,l.startOffsetMatrix=f.offsetMatrix,l.startTransformOrigin=f.transformOrigin,l.isWidth=(r=t==null?void 0:t.parentIsWidth)!==null&&r!==void 0?r:!d[0]&&!d[1]||d[0]||!d[1];function b(E){l.ratio=E&&isFinite(E)?E:0}l.startPositions=Qt(e.state);function x(E){l.fixedDirection=E,l.fixedPosition=Dt(l.startPositions,E)}function _(E){var w=e.state,T=w.width,D=w.height;l.fixedPosition=E,l.fixedDirection=zs(E,T,D)}function S(E){l.minSize=[yt("".concat(E[0]),0)||0,yt("".concat(E[1]),0)||0]}function y(E){var w=[E[0]||1/0,E[1]||1/0];(!fa(w[0])||isFinite(w[0]))&&(w[0]=yt("".concat(w[0]),0)||1/0),(!fa(w[1])||isFinite(w[1]))&&(w[1]=yt("".concat(w[1]),0)||1/0),l.maxSize=w}b(v/h),x(u||[-d[0],-d[1]]),l.setFixedDirection=x,l.setFixedPosition=_,l.setMin=S,l.setMax=y;var C=ot(e,t,{direction:d,startRatio:l.ratio,set:function(E){var w=E[0],T=E[1];l.startWidth=w,l.startHeight=T},setMin:S,setMax:y,setRatio:b,setFixedDirection:x,setFixedPosition:_,setOrigin:function(E){l.transformOrigin=E},dragStart:Yt.dragStart(e,new ar().dragStart([0,0],t))}),M=c||Z(e,"onResizeStart",C);return l.startFixedDirection=l.fixedDirection,l.startFixedPosition=l.fixedPosition,M!==!1&&(l.isResize=!0,e.state.snapRenderInfo={request:t.isRequest,direction:d}),l.isResize?C:!1},dragControl:function(e,t){var r,n=t.datas,a=t.parentFlag,i=t.isPinch,o=t.parentKeepRatio,s=t.dragClient,l=t.parentDist,u=t.isRequest,c=t.isGroup,d=t.parentEvent,f=t.resolveMatrix,p=n.isResize,v=n.transformOrigin,h=n.startWidth,g=n.startHeight,m=n.prevWidth,b=n.prevHeight,x=n.minSize,_=n.maxSize,S=n.ratio,y=n.startOffsetWidth,C=n.startOffsetHeight,M=n.isWidth;if(!p)return;if(f){var E=e.state.is3d,w=n.startOffsetMatrix,T=n.startTransformOrigin,D=E?4:3,R=si(Ps(t)),I=Math.sqrt(R.length);D!==I&&(R=be(R,I,D));var B=Xr(w,R,T,D),V=Be(B,y,C,D);n.startPositions=V,n.nextTargetMatrix=R,n.nextAllMatrix=B}var j=Ye(e.props,"resizable"),W=j.resizeFormat,X=j.throttleResize,z=X===void 0?a?0:1:X,Y=j.parentMoveable,G=j.keepRatioFinally,A=n.direction,N=A,L=0,$=0;!A[0]&&!A[1]&&(N=[1,1]);var U=S&&(o??j.keepRatio)||!1;function Q(){var Bt=n.fixedDirection,Ft=Zs(N,U,n,t);L=Ft.distWidth,$=Ft.distHeight;var Me=N[0]-Bt[0]||U?Math.max(y+L,qt):y,Ke=N[1]-Bt[1]||U?Math.max(C+$,qt):C;return U&&y&&C&&(M?Ke=Me/S:Me=Ke*S),[Me,Ke]}var at=Q(),J=at[0],tt=at[1];d||(n.setFixedDirection(n.fixedDirection),Z(e,"onBeforeResize",ot(e,t,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(Bt){var Ft;return n.setFixedDirection(Bt),Ft=Q(),J=Ft[0],tt=Ft[1],[J,tt]},setFixedPosition:function(Bt){var Ft;return n.setFixedPosition(Bt),Ft=Q(),J=Ft[0],tt=Ft[1],[J,tt]},boundingWidth:J,boundingHeight:tt,setSize:function(Bt){J=Bt[0],tt=Bt[1]}},!0)));var lt=s;s||(!a&&i?lt=Ls(e,[0,0]):lt=n.fixedPosition);var ut=[0,0];i||(ut=ov(e,J,tt,A,lt,u,n)),l&&(!l[0]&&(ut[0]=0),!l[1]&&(ut[1]=0));function Tt(){var Bt;W&&(Bt=W([J,tt]),J=Bt[0],tt=Bt[1]),J=it(J,z),tt=it(tt,z)}if(U){N[0]&&N[1]&&ut[0]&&ut[1]&&(Math.abs(ut[0])>Math.abs(ut[1])?ut[1]=0:ut[0]=0);var bt=!ut[0]&&!ut[1];bt&&Tt(),N[0]&&!N[1]||ut[0]&&!ut[1]||bt&&M?(J+=ut[0],tt=J/S):(!N[0]&&N[1]||!ut[0]&&ut[1]||bt&&!M)&&(tt+=ut[1],J=tt*S)}else J+=ut[0],tt+=ut[1],J=Math.max(0,J),tt=Math.max(0,tt);r=Mf([J,tt],x,_,U?S:!1),J=r[0],tt=r[1],Tt(),U&&(c||G)&&(M?tt=J/S:J=tt*S),L=J-y,$=tt-C;var vt=[L-m,$-b];n.prevWidth=L,n.prevHeight=$;var Ct=ep(e,J,tt,lt,v,n);if(!(!Y&&vt.every(function(Bt){return!Bt})&&Ct.every(function(Bt){return!Bt}))){var ct=Yt.drag(e,Wr(t,e.state,Ct,!!i,!1,"draggable")),ht=ct.transform,gt=h+L,Kt=g+$,De=ot(e,t,k({width:gt,height:Kt,offsetWidth:Math.round(J),offsetHeight:Math.round(tt),startRatio:S,boundingWidth:J,boundingHeight:tt,direction:A,dist:[L,$],delta:vt,isPinch:!!i,drag:ct},js({style:{width:"".concat(gt,"px"),height:"".concat(Kt,"px")},transform:ht},ct,t)));return!d&&Z(e,"onResize",De),De}},dragControlAfter:function(e,t){var r=t.datas,n=r.isResize,a=r.startOffsetWidth,i=r.startOffsetHeight,o=r.prevWidth,s=r.prevHeight;if(!(!n||e.props.checkResizableError===!1)){var l=e.state,u=l.width,c=l.height,d=u-(a+o),f=c-(i+s),p=Math.abs(d)>3,v=Math.abs(f)>3;if(p&&(r.startWidth+=d,r.startOffsetWidth+=d,r.prevWidth+=d),v&&(r.startHeight+=f,r.startOffsetHeight+=f,r.prevHeight+=f),p||v)return this.dragControl(e,t)}},dragControlEnd:function(e,t){var r=t.datas,n=t.parentEvent;if(r.isResize){r.isResize=!1;var a=ae(e,t,{});return!n&&Z(e,"onResizeEnd",a),a}},dragGroupControlCondition:_o,dragGroupControlStart:function(e,t){var r=t.datas,n=this.dragControlStart(e,k(k({},t),{isGroup:!0}));if(!n)return!1;var a=pe(e,"resizable",t);function i(v,h){var g=r.fixedDirection,m=r.fixedPosition,b=h.datas.startPositions||Qt(v.state),x=Dt(b,g),_=$t(nr(-e.rotation/180*Math.PI,3),[x[0]-m[0],x[1]-m[1],1],3),S=_[0],y=_[1];return h.datas.originalX=S,h.datas.originalY=y,h}var o=r.startOffsetWidth,s=r.startOffsetHeight;function l(){var v=r.minSize;a.forEach(function(h){var g=h.datas,m=g.minSize,b=g.startOffsetWidth,x=g.startOffsetHeight,_=o*(b?m[0]/b:0),S=s*(x?m[1]/x:0);v[0]=Math.max(v[0],_),v[1]=Math.max(v[1],S)})}function u(){var v=r.maxSize;a.forEach(function(h){var g=h.datas,m=g.maxSize,b=g.startOffsetWidth,x=g.startOffsetHeight,_=o*(b?m[0]/b:0),S=s*(x?m[1]/x:0);v[0]=Math.min(v[0],_),v[1]=Math.min(v[1],S)})}var c=_e(e,this,"dragControlStart",t,function(v,h){return i(v,h)});l(),u();var d=function(v){n.setFixedDirection(v),c.forEach(function(h,g){h.setFixedDirection(v),i(h.moveable,a[g])})};r.setFixedDirection=d;var f=k(k({},n),{targets:e.props.targets,events:c.map(function(v){return k(k({},v),{setMin:function(h){v.setMin(h),l()},setMax:function(h){v.setMax(h),u()}})}),setFixedDirection:d,setMin:function(v){n.setMin(v),l()},setMax:function(v){n.setMax(v),u()}}),p=Z(e,"onResizeGroupStart",f);return r.isResize=p!==!1,r.isResize?n:!1},dragGroupControl:function(e,t){var r=t.datas;if(r.isResize){var n=Ye(e.props,"resizable");Nn(e,"onBeforeResize",function(p){Z(e,"onBeforeResizeGroup",ot(e,t,k(k({},p),{targets:n.targets}),!0))});var a=this.dragControl(e,k(k({},t),{isGroup:!0}));if(a){var i=a.boundingWidth,o=a.boundingHeight,s=a.dist,l=n.keepRatio,u=[i/(i-s[0]),o/(o-s[1])],c=r.fixedPosition,d=_e(e,this,"dragControl",t,function(p,v){var h=$t(nr(e.rotation/180*Math.PI,3),[v.datas.originalX*u[0],v.datas.originalY*u[1],1],3),g=h[0],m=h[1];return k(k({},v),{parentDist:null,parentScale:u,dragClient:ft(c,[g,m]),parentKeepRatio:l})}),f=k({targets:n.targets,events:d},a);return Z(e,"onResizeGroup",f),f}}},dragGroupControlEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isResize){this.dragControlEnd(e,t);var a=_e(e,this,"dragControlEnd",t),i=ae(e,t,{targets:e.props.targets,events:a});return Z(e,"onResizeGroupEnd",i),r}},request:function(e){var t={},r=0,n=0,a=e.getRect();return{isControl:!0,requestStart:function(i){var o;return{datas:t,parentDirection:i.direction||[1,1],parentIsWidth:(o=i==null?void 0:i.horizontal)!==null&&o!==void 0?o:!0}},request:function(i){return"offsetWidth"in i?r=i.offsetWidth-a.offsetWidth:"deltaWidth"in i&&(r+=i.deltaWidth),"offsetHeight"in i?n=i.offsetHeight-a.offsetHeight:"deltaHeight"in i&&(n+=i.deltaHeight),{datas:t,parentDist:[r,n],parentKeepRatio:i.keepRatio}},requestEnd:function(){return{datas:t,isDrag:!0}}}},unset:function(e){e.state.gestos.resizable=null}};function oa(e,t,r,n,a){var i=e.props.groupable,o=e.state,s=o.is3d?4:3,l=t.origin,u=zt(e.state.rootMatrix,et([l[0],l[1]],i?[0,0]:[o.left,o.top]),s),c=ft([a.left,a.top],u);t.startAbsoluteOrigin=c,t.prevDeg=Mt(c,[r,n])/Math.PI*180,t.defaultDeg=t.prevDeg,t.prevSnapDeg=0,t.loop=0,t.startDist=fe(c,[r,n])}function pn(e,t,r){var n=r.defaultDeg,a=r.prevDeg,i=a%360,o=Math.floor(a/360);i<0&&(i+=360),i>e&&i>270&&e<90?++o:i<e&&i<90&&e>270&&--o;var s=t*(o*360+e-n);return r.prevDeg=n+s,s}function sa(e,t,r,n){return pn(Mt(n.startAbsoluteOrigin,[e,t])/Math.PI*180,r,n)}function la(e,t,r,n,a,i){var o=e.props.throttleRotate,s=o===void 0?0:o,l=r.prevSnapDeg,u=0,c=!1;if(i){var d=iv(e,t,n);c=d.isSnap,u=a+d.rotation}c||(u=it(a+n,s));var f=u-a;return r.prevSnapDeg=f,[f-l,f,u]}function pl(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3];if(e==="none")return[];if(Ot(e))return e.map(function(h){return pl(h,[n,a,i,o],r)[0]});var s=(e||"top").split("-"),l=s[0],u=s[1],c=[n,a];l==="left"?c=[i,n]:l==="right"?c=[a,o]:l==="bottom"&&(c=[o,i]);var d=[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2],f=Ws(c,r);if(u){var p=u==="top"||u==="left",v=l==="bottom"||l==="left";d=c[p&&!v||!p&&v?0:1]}return[[d,f]]}function Fa(e,t){if(t.isRequest)return t.requestAble==="rotatable";var r=t.inputEvent.target;if(At(r,rt("rotation-control"))||At(r,rt("around-control"))||At(r,rt("control"))&&At(r,rt("rotatable")))return!0;var n=e.props.rotationTarget;return n?bi(n,!0).some(function(a){return a?r===a||r.contains(a):!1}):!1}var pv=ci.map(function(e){var t="",r="",n="center",a="center";return e.indexOf("n")>-1&&(t="top: -20px;",a="bottom"),e.indexOf("s")>-1&&(t="top: 0px;",a="top"),e.indexOf("w")>-1&&(r="left: -20px;",n="right"),e.indexOf("e")>-1&&(r="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(e,`"] {
        `).concat(r).concat(t,`
        transform-origin: `).concat(n," ").concat(a,`;
    }`)}).join(`
`),vv=`.rotation {
    position: absolute;
    height: 40px;
    width: 1px;
    transform-origin: 50% 100%;
    height: calc(40px * var(--zoom));
    top: auto;
    left: 0;
    bottom: 100%;
    will-change: transform;
}
.rotation .rotation-line {
    display: block;
    width: 100%;
    height: 100%;
    transform-origin: 50% 50%;
}
.rotation .rotation-control {
    border-color: #4af;
    border-color: var(--moveable-color);
    background:#fff;
    cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
    cursor: alias;
}
.around-control {
    position: absolute;
    will-change: transform;
    width: 20px;
    height: 20px;
    left: -10px;
    top: -10px;
    box-sizing: border-box;
    background: transparent;
    z-index: 8;
    cursor: alias;
    transform-origin: center center;
}
.rotatable.direction.control.move {
    cursor: move;
}
`.concat(pv,`
`),hv={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number,renderDirections:Object,rotationTarget:Object,rotateAroundControls:Boolean,edge:Boolean,resolveAblesWithRotatable:Object},events:{onRotateStart:"rotateStart",onBeforeRotate:"beforeRotate",onRotate:"rotate",onRotateEnd:"rotateEnd",onRotateGroupStart:"rotateGroupStart",onBeforeRotateGroup:"beforeRotateGroup",onRotateGroup:"rotateGroup",onRotateGroupEnd:"rotateGroupEnd"},css:[vv],viewClassName:function(e){return e.isDragging("rotatable")?rt("view-rotation-dragging"):""},render:function(e,t){var r=Ye(e.props,"rotatable"),n=r.rotatable,a=r.rotationPosition,i=r.zoom,o=r.renderDirections,s=r.rotateAroundControls,l=r.resolveAblesWithRotatable,u=e.getState(),c=u.renderPoses,d=u.direction;if(!n)return null;var f=pl(a,c,d),p=[];if(f.forEach(function(m,b){var x=m[0],_=m[1];p.push(t.createElement("div",{key:"rotation".concat(b),className:rt("rotation"),style:{transform:"translate(-50%) translate(".concat(x[0],"px, ").concat(x[1],"px) rotate(").concat(_,"rad)")}},t.createElement("div",{className:rt("line rotation-line"),style:{transform:"scaleX(".concat(i,")")}}),t.createElement("div",{className:rt("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(i,")")}})))}),o){var v=pr(l||{}),h={};v.forEach(function(m){l[m].forEach(function(b){h[b]=m})});var g=[];Ot(o)&&(g=o.map(function(m){var b=h[m];return{data:b?{resolve:b}:{},classNames:b?["move"]:[],dir:m}})),p.push.apply(p,ll(e,"rotatable",g,t))}return s&&p.push.apply(p,fv(e,t)),p},dragControlCondition:Fa,dragControlStart:function(e,t){var r,n,a=t.datas,i=t.clientX,o=t.clientY,s=t.parentRotate,l=t.parentFlag,u=t.isPinch,c=t.isRequest,d=e.state,f=d.target,p=d.left,v=d.top,h=d.direction,g=d.beforeDirection,m=d.targetTransform,b=d.moveableClientRect,x=d.offsetMatrix,_=d.targetMatrix,S=d.allMatrix,y=d.width,C=d.height;if(!c&&!f)return!1;var M=e.getRect();a.rect=M,a.transform=m,a.left=p,a.top=v;var E=function(L){var $=e.state,U=$.allMatrix,Q=$.is3d,at=$.width,J=$.height,tt=zs(L,at,J);a.fixedDirection=tt,a.fixedPosition=zt(U,L,Q?4:3),Y&&Y.setFixedPosition(L)},w=function(L){a.fixedDirection=L,a.fixedPosition=As(e,L),Y&&Y.setFixedDirection(L)},T=i,D=o;if(c||u||l){var R=s||0;a.beforeInfo={origin:M.beforeOrigin,prevDeg:R,defaultDeg:R,prevSnapDeg:0,startDist:0},a.afterInfo=k(k({},a.beforeInfo),{origin:M.origin}),a.absoluteInfo=k(k({},a.beforeInfo),{origin:M.origin,startValue:R})}else{var I=(n=t.inputEvent)===null||n===void 0?void 0:n.target;if(I){var B=I.getAttribute("data-direction")||"",V=Xd[B];if(V){a.isControl=!0,a.isAroundControl=At(I,rt("around-control")),a.controlDirection=V;var j=I.getAttribute("data-resolve");j&&(a.resolveAble=j);var W=dp(d.rootMatrix,d.renderPoses,b);r=Dt(W,V),T=r[0],D=r[1]}}a.beforeInfo={origin:M.beforeOrigin},a.afterInfo={origin:M.origin},a.absoluteInfo={origin:M.origin,startValue:M.rotation};var X=E;E=function(L){var $=d.is3d?4:3,U=ft(hs(_,$),L),Q=U[0],at=U[1],J=$t(x,He([Q,at],$)),tt=$t(S,He([L[0],L[1]],$));X(L);var lt=d.posDelta;a.beforeInfo.origin=et(J,lt),a.afterInfo.origin=et(tt,lt),a.absoluteInfo.origin=et(tt,lt),oa(e,a.beforeInfo,T,D,b),oa(e,a.afterInfo,T,D,b),oa(e,a.absoluteInfo,T,D,b)},w=function(L){var $=Dt([[0,0],[y,0],[0,C],[y,C]],L);E($)}}a.startClientX=T,a.startClientY=D,a.direction=h,a.beforeDirection=g,a.startValue=0,a.datas={},Gn(t,"rotate");var z=!1,Y=!1;if(a.isControl&&a.resolveAble){var G=a.resolveAble;G==="resizable"&&(Y=Ga.dragControlStart(e,k(k({},new ar("resizable").dragStart([0,0],t)),{parentPosition:a.controlPosition,parentFixedPosition:a.fixedPosition})))}Y||(z=Yt.dragStart(e,new ar().dragStart([0,0],t))),E(d.transformOrigin);var A=ot(e,t,k(k({set:function(L){a.startValue=L*Math.PI/180},setFixedDirection:w,setFixedPosition:E},Ln(t)),{dragStart:z,resizeStart:Y})),N=Z(e,"onRotateStart",A);return a.isRotate=N!==!1,d.snapRenderInfo={request:t.isRequest},a.isRotate?A:!1},dragControl:function(e,t){var r,n,a,i=t.datas,o=t.clientDistX,s=t.clientDistY,l=t.parentRotate,u=t.parentFlag,c=t.isPinch,d=t.groupDelta,f=i.beforeDirection,p=i.beforeInfo,v=i.afterInfo,h=i.absoluteInfo,g=i.isRotate,m=i.startValue,b=i.rect,x=i.startClientX,_=i.startClientY;if(g){zn(t,"rotate");var S=Hd(t),y=f*S,C=e.props.parentMoveable,M=0,E,w,T=0,D,R,I=0,B,V,j=180/Math.PI*m,W=h.startValue,X=!1,z=x+o,Y=_+s;if(!u&&"parentDist"in t){var G=t.parentDist;E=G,D=G,B=G}else c||u?(E=pn(l,f,p),D=pn(l,y,v),B=pn(l,y,h)):(E=sa(z,Y,f,p),D=sa(z,Y,y,v),B=sa(z,Y,y,h),X=!0);if(w=j+E,R=j+D,V=W+B,Z(e,"onBeforeRotate",ot(e,t,{beforeRotation:w,rotation:R,absoluteRotation:V,setRotation:function(lt){D=lt-j,E=D,B=D}},!0)),r=la(e,b,p,E,j,X),M=r[0],E=r[1],w=r[2],n=la(e,b,v,D,j,X),T=n[0],D=n[1],R=n[2],a=la(e,b,h,B,W,X),I=a[0],B=a[1],V=a[2],!(!I&&!T&&!M&&!C)){var A=An(i,"rotate(".concat(R,"deg)"),"rotate(".concat(D,"deg)")),N=tp(e,D,i),L=et(ft(d||[0,0],N),i.prevInverseDist||[0,0]);i.prevInverseDist=N,i.requestValue=null;var $=Os(e,A,L,c,t),U=$,Q=fe([z,Y],h.startAbsoluteOrigin)-h.startDist,at=void 0;if(i.resolveAble==="resizable"){var J=Ga.dragControl(e,k(k({},Wr(t,e.state,[t.deltaX,t.deltaY],!!c,!1,"resizable")),{resolveMatrix:!0,parentDistance:Q}));J&&(at=J,U=js(U,J,t))}var tt=ot(e,t,k(k({delta:T,dist:D,rotate:R,rotation:R,beforeDist:E,beforeDelta:M,beforeRotate:w,beforeRotation:w,absoluteDist:B,absoluteDelta:I,absoluteRotate:V,absoluteRotation:V,isPinch:!!c,resize:at},$),U));return Z(e,"onRotate",tt),tt}}},dragControlEnd:function(e,t){var r=t.datas;if(r.isRotate){r.isRotate=!1;var n=ae(e,t,{});return Z(e,"onRotateEnd",n),n}},dragGroupControlCondition:Fa,dragGroupControlStart:function(e,t){var r=t.datas,n=e.state,a=n.left,i=n.top,o=n.beforeOrigin,s=this.dragControlStart(e,t);if(!s)return!1;s.set(r.beforeDirection*e.rotation);var l=_e(e,this,"dragControlStart",t,function(d,f){var p=d.state,v=p.left,h=p.top,g=p.beforeOrigin,m=ft(et([v,h],[a,i]),et(g,o));return f.datas.startGroupClient=m,f.datas.groupClient=m,k(k({},f),{parentRotate:0})}),u=k(k({},s),{targets:e.props.targets,events:l}),c=Z(e,"onRotateGroupStart",u);return r.isRotate=c!==!1,r.isRotate?s:!1},dragGroupControl:function(e,t){var r=t.datas;if(r.isRotate){Nn(e,"onBeforeRotate",function(u){Z(e,"onBeforeRotateGroup",ot(e,t,k(k({},u),{targets:e.props.targets}),!0))});var n=this.dragControl(e,t);if(n){var a=r.beforeDirection,i=n.beforeDist,o=i/180*Math.PI,s=_e(e,this,"dragControl",t,function(u,c){var d=c.datas.startGroupClient,f=c.datas.groupClient,p=f[0],v=f[1],h=Nr(d,o*a),g=h[0],m=h[1],b=[g-p,m-v];return c.datas.groupClient=[g,m],k(k({},c),{parentRotate:i,groupDelta:b})});e.rotation=a*n.beforeRotation;var l=k({targets:e.props.targets,events:s,set:function(u){e.rotation=u},setGroupRotation:function(u){e.rotation=u}},n);return Z(e,"onRotateGroup",l),l}}},dragGroupControlEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isRotate){this.dragControlEnd(e,t);var a=_e(e,this,"dragControlEnd",t),i=ae(e,t,{targets:e.props.targets,events:a});return Z(e,"onRotateGroupEnd",i),r}},request:function(e){var t={},r=0,n=e.getRotation();return{isControl:!0,requestStart:function(){return{datas:t}},request:function(a){return"deltaRotate"in a?r+=a.deltaRotate:"rotate"in a&&(r=a.rotate-n),{datas:t,parentDist:r}},requestEnd:function(){return{datas:t,isDrag:!0}}}}},yo=mi("scalable"),gv={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean,edge:Boolean},events:{onScaleStart:"scaleStart",onBeforeScale:"beforeScale",onScale:"scale",onScaleEnd:"scaleEnd",onScaleGroupStart:"scaleGroupStart",onBeforeScaleGroup:"beforeScaleGroup",onScaleGroup:"scaleGroup",onScaleGroupEnd:"scaleGroupEnd"},render:fl("scalable"),dragControlCondition:yo,viewClassName:gi("scalable"),dragControlStart:function(e,t){var r=t.datas,n=t.isPinch,a=t.inputEvent,i=t.parentDirection,o=Hs(i,n,a,r),s=e.state,l=s.width,u=s.height,c=s.targetTransform,d=s.target,f=s.pos1,p=s.pos2,v=s.pos4;if(!o||!d)return!1;n||qe(e,t),r.datas={},r.transform=c,r.prevDist=[1,1],r.direction=o,r.startOffsetWidth=l,r.startOffsetHeight=u,r.startValue=[1,1];var h=fe(f,p),g=fe(p,v),m=!o[0]&&!o[1]||o[0]||!o[1];r.scaleWidth=h,r.scaleHeight=g,r.scaleXRatio=h/l,r.scaleYRatio=g/u,Gn(t,"scale"),r.isWidth=m;function b(y){r.ratio=y&&isFinite(y)?y:0}r.startPositions=Qt(e.state);function x(y){r.fixedDirection=y,r.fixedPosition=Dt(r.startPositions,y)}r.setFixedDirection=x,b(fe(f,p)/fe(p,v)),x([-o[0],-o[1]]);var _=ot(e,t,k(k({direction:o,set:function(y){r.startValue=y},setRatio:b,setFixedDirection:x},Ln(t)),{dragStart:Yt.dragStart(e,new ar().dragStart([0,0],t))})),S=Z(e,"onScaleStart",_);return r.startFixedDirection=r.fixedDirection,S!==!1&&(r.isScale=!0,e.state.snapRenderInfo={request:t.isRequest,direction:o}),r.isScale?_:!1},dragControl:function(e,t){zn(t,"scale");var r=t.datas,n=t.parentKeepRatio,a=t.parentFlag,i=t.isPinch,o=t.dragClient,s=t.isRequest,l=r.prevDist,u=r.direction,c=r.startOffsetWidth,d=r.startOffsetHeight,f=r.isScale,p=r.startValue,v=r.isWidth,h=r.ratio;if(!f)return!1;var g=e.props,m=g.throttleScale,b=g.parentMoveable,x=u;!u[0]&&!u[1]&&(x=[1,1]);var _=h&&(n??g.keepRatio)||!1,S=e.state;function y(){var Y=Zs(x,_,r,t),G=Y.distWidth,A=Y.distHeight,N=c?(c+G)/c:1,L=d?(d+A)/d:1;return N=x[0]||_?N*p[0]:p[0],L=x[1]||_?L*p[1]:p[1],N===0&&(N=(l[0]>0?1:-1)*Jr),L===0&&(L=(l[1]>0?1:-1)*Jr),[N,L]}var C=y();if(!i&&e.props.groupable){var M=S.snapRenderInfo||{},E=M.direction;Ot(E)&&(E[0]||E[1])&&(S.snapRenderInfo={direction:u,request:t.isRequest})}Z(e,"onBeforeScale",ot(e,t,{scale:C,setFixedDirection:function(Y){return r.setFixedDirection(Y),C=y(),C},startFixedDirection:r.startFixedDirection,setScale:function(Y){C=Y}},!0));var w=[C[0]/p[0],C[1]/p[1]],T=o,D=[0,0];if(o||(!a&&i?T=Ls(e,[0,0]):T=r.fixedPosition),i||(D=sv(e,w,u,s,r)),_){x[0]&&x[1]&&D[0]&&D[1]&&(Math.abs(D[0]*c)>Math.abs(D[1]*d)?D[1]=0:D[0]=0);var R=!D[0]&&!D[1];if(R&&(v?w[0]=it(w[0]*p[0],m)/p[0]:w[1]=it(w[1]*p[1],m)/p[1]),x[0]&&!x[1]||D[0]&&!D[1]||R&&v){w[0]+=D[0];var I=c*w[0]*p[0]/h;w[1]=I/d/p[1]}else if(!x[0]&&x[1]||!D[0]&&D[1]||R&&!v){w[1]+=D[1];var B=d*w[1]*p[1]*h;w[0]=B/c/p[0]}}else w[0]+=D[0],w[1]+=D[1],D[0]||(w[0]=it(w[0]*p[0],m)/p[0]),D[1]||(w[1]=it(w[1]*p[1],m)/p[1]);w[0]===0&&(w[0]=(l[0]>0?1:-1)*Jr),w[1]===0&&(w[1]=(l[1]>0?1:-1)*Jr);var V=[w[0]/l[0],w[1]/l[1]];C=np(w,p);var j=Qd(e,w,r.fixedDirection,T,r),W=et(j,r.prevInverseDist||[0,0]);if(r.prevDist=w,r.prevInverseDist=j,C[0]===l[0]&&C[1]===l[1]&&W.every(function(Y){return!Y})&&!b)return!1;var X=An(r,"scale(".concat(C.join(", "),")"),"scale(".concat(w.join(", "),")")),z=ot(e,t,k({offsetWidth:c,offsetHeight:d,direction:u,scale:C,dist:w,delta:V,isPinch:!!i},Os(e,X,W,i,t)));return Z(e,"onScale",z),z},dragControlEnd:function(e,t){var r=t.datas;if(!r.isScale)return!1;r.isScale=!1;var n=ae(e,t,{});return Z(e,"onScaleEnd",n),n},dragGroupControlCondition:yo,dragGroupControlStart:function(e,t){var r=t.datas,n=this.dragControlStart(e,t);if(!n)return!1;var a=pe(e,"resizable",t);function i(c,d){var f=r.fixedDirection,p=r.fixedPosition,v=d.datas.startPositions||Qt(c.state),h=Dt(v,f),g=$t(nr(-e.rotation/180*Math.PI,3),[h[0]-p[0],h[1]-p[1],1],3),m=g[0],b=g[1];return d.datas.originalX=m,d.datas.originalY=b,d}r.moveableScale=e.scale;var o=_e(e,this,"dragControlStart",t,function(c,d){return i(c,d)}),s=function(c){n.setFixedDirection(c),o.forEach(function(d,f){d.setFixedDirection(c),i(d.moveable,a[f])})};r.setFixedDirection=s;var l=k(k({},n),{targets:e.props.targets,events:o,setFixedDirection:s}),u=Z(e,"onScaleGroupStart",l);return r.isScale=u!==!1,r.isScale?l:!1},dragGroupControl:function(e,t){var r=t.datas;if(r.isScale){Nn(e,"onBeforeScale",function(d){Z(e,"onBeforeScaleGroup",ot(e,t,k(k({},d),{targets:e.props.targets}),!0))});var n=this.dragControl(e,t);if(n){var a=r.moveableScale;e.scale=[n.scale[0]*a[0],n.scale[1]*a[1]];var i=e.props.keepRatio,o=n.dist,s=n.scale,l=r.fixedPosition,u=_e(e,this,"dragControl",t,function(d,f){var p=$t(nr(e.rotation/180*Math.PI,3),[f.datas.originalX*o[0],f.datas.originalY*o[1],1],3),v=p[0],h=p[1];return k(k({},f),{parentDist:null,parentScale:s,parentKeepRatio:i,dragClient:ft(l,[v,h])})}),c=k({targets:e.props.targets,events:u},n);return Z(e,"onScaleGroup",c),c}}},dragGroupControlEnd:function(e,t){var r=t.isDrag,n=t.datas;if(n.isScale){this.dragControlEnd(e,t);var a=_e(e,this,"dragControlEnd",t),i=ae(e,t,{targets:e.props.targets,events:a});return Z(e,"onScaleGroupEnd",i),r}},request:function(){var e={},t=0,r=0;return{isControl:!0,requestStart:function(n){return{datas:e,parentDirection:n.direction||[1,1]}},request:function(n){return t+=n.deltaWidth,r+=n.deltaHeight,{datas:e,parentDist:[t,r],parentKeepRatio:n.keepRatio}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function ke(e,t){return e.map(function(r,n){return Ge(r,t[n],1,2)})}function So(e,t,r){var n=Mt(e,t),a=Mt(e,r),i=a-n;return i>=0?i:i+2*Math.PI}function mv(e,t){var r=So(e[0],e[1],e[2]),n=So(t[0],t[1],t[2]),a=Math.PI;return!(r>=a&&n<=a||r<=a&&n>=a)}var bv={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array,edge:Boolean},events:{onWarpStart:"warpStart",onWarp:"warp",onWarpEnd:"warpEnd"},viewClassName:gi("warpable"),render:function(e,t){var r=e.props,n=r.resizable,a=r.scalable,i=r.warpable,o=r.zoom;if(n||a||!i)return[];var s=e.state,l=s.pos1,u=s.pos2,c=s.pos3,d=s.pos4,f=ke(l,u),p=ke(u,l),v=ke(l,c),h=ke(c,l),g=ke(c,d),m=ke(d,c),b=ke(u,d),x=ke(d,u);return nt([t.createElement("div",{className:rt("line"),key:"middeLine1",style:br(f,g,o)}),t.createElement("div",{className:rt("line"),key:"middeLine2",style:br(p,m,o)}),t.createElement("div",{className:rt("line"),key:"middeLine3",style:br(v,b,o)}),t.createElement("div",{className:rt("line"),key:"middeLine4",style:br(h,x,o)})],dl(e,"warpable",t),!0)},dragControlCondition:function(e,t){if(t.isRequest)return!1;var r=t.inputEvent.target;return At(r,rt("direction"))&&At(r,rt("warpable"))},dragControlStart:function(e,t){var r=t.datas,n=t.inputEvent,a=e.props.target,i=n.target,o=Ys(i,r);if(!o||!a)return!1;var s=e.state,l=s.transformOrigin,u=s.is3d,c=s.targetTransform,d=s.targetMatrix,f=s.width,p=s.height,v=s.left,h=s.top;r.datas={},r.targetTransform=c,r.warpTargetMatrix=u?d:be(d,3,4),r.targetInverseMatrix=vs(me(r.warpTargetMatrix,4),3,4),r.direction=o,r.left=v,r.top=h,r.poses=[[0,0],[f,0],[0,p],[f,p]].map(function(b){return et(b,l)}),r.nextPoses=r.poses.map(function(b){var x=b[0],_=b[1];return $t(r.warpTargetMatrix,[x,_,0,1],4)}),r.startValue=wt(4),r.prevMatrix=wt(4),r.absolutePoses=Qt(s),r.posIndexes=Is(o),qe(e,t),Gn(t,"matrix3d"),s.snapRenderInfo={request:t.isRequest,direction:o};var g=ot(e,t,k({set:function(b){r.startValue=b}},Ln(t))),m=Z(e,"onWarpStart",g);return m!==!1&&(r.isWarp=!0),r.isWarp},dragControl:function(e,t){var r=t.datas,n=t.isRequest,a=t.distX,i=t.distY,o=r.targetInverseMatrix,s=r.prevMatrix,l=r.isWarp,u=r.startValue,c=r.poses,d=r.posIndexes,f=r.absolutePoses;if(!l)return!1;if(zn(t,"matrix3d"),hr(e,"warpable")){var p=d.map(function(E){return f[E]});p.length>1&&p.push([(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2]);var v=Wn(e,n,{horizontal:p.map(function(E){return E[1]+i}),vertical:p.map(function(E){return E[0]+a})}),h=v.horizontal,g=v.vertical;i-=h.offset,a-=g.offset}var m=xe({datas:r,distX:a,distY:i},!0),b=r.nextPoses.slice();if(d.forEach(function(E){b[E]=ft(b[E],m)}),!Vd.every(function(E){return mv(E.map(function(w){return c[w]}),E.map(function(w){return b[w]}))}))return!1;var x=oi(c[0],c[2],c[1],c[3],b[0],b[2],b[1],b[3]);if(!x.length)return!1;var _=_t(o,x,4),S=Ts(r,_,!0),y=_t(me(s,4),S,4);r.prevMatrix=S;var C=_t(u,S,4),M=An(r,"matrix3d(".concat(C.join(", "),")"),"matrix3d(".concat(S.join(", "),")"));return di(t,M),Z(e,"onWarp",ot(e,t,k({delta:y,matrix:C,dist:S,multiply:_t,transform:M},Ut({transform:M},t)))),!0},dragControlEnd:function(e,t){var r=t.datas,n=t.isDrag;return r.isWarp?(r.isWarp=!1,Z(e,"onWarpEnd",ae(e,t,{})),n):!1}},xv=rt("area-pieces"),on=rt("area-piece"),vl=rt("avoid"),_v=rt("view-dragging");function ua(e){var t=e.areaElement;if(t){var r=e.state,n=r.width,a=r.height;es(t,vl),t.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(a,"px")}}function Co(e){return e.createElement("div",{key:"area_pieces",className:xv},e.createElement("div",{className:on}),e.createElement("div",{className:on}),e.createElement("div",{className:on}),e.createElement("div",{className:on}))}var hl={name:"dragArea",props:{dragArea:Boolean,passDragArea:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},render:function(e,t){var r=e.props,n=r.target,a=r.dragArea,i=r.groupable,o=r.passDragArea,s=e.getState(),l=s.width,u=s.height,c=s.renderPoses,d=o?rt("area","pass"):rt("area");if(i)return[t.createElement("div",{key:"area",ref:ge(e,"areaElement"),className:d}),Co(t)];if(!n||!a)return[];var f=oi([0,0],[l,0],[0,u],[l,u],c[0],c[1],c[2],c[3]),p=f.length?Fn(f,!0):"none";return[t.createElement("div",{key:"area",ref:ge(e,"areaElement"),className:d,style:{top:"0px",left:"0px",width:"".concat(l,"px"),height:"".concat(u,"px"),transformOrigin:"0 0",transform:p}}),Co(t)]},dragStart:function(e,t){var r=t.datas,n=t.clientX,a=t.clientY,i=t.inputEvent;if(!i)return!1;r.isDragArea=!1;var o=e.areaElement,s=e.state,l=s.moveableClientRect,u=s.renderPoses,c=s.rootMatrix,d=s.is3d,f=l.left,p=l.top,v=le(u),h=v.left,g=v.top,m=v.width,b=v.height,x=d?4:3,_=Xe(c,[n-f,a-p],x),S=_[0],y=_[1];S-=h,y-=g;var C=[{left:h,top:g,width:m,height:y-10},{left:h,top:g,width:S-10,height:b},{left:h,top:g+y+10,width:m,height:b-y-10},{left:h+S+10,top:g,width:m-S-10,height:b}],M=[].slice.call(o.nextElementSibling.children);C.forEach(function(E,w){M[w].style.cssText="left: ".concat(E.left,"px;top: ").concat(E.top,"px; width: ").concat(E.width,"px; height: ").concat(E.height,"px;")}),ts(o,vl),s.disableNativeEvent=!0},drag:function(e,t){var r=t.datas,n=t.inputEvent;if(this.enableNativeEvent(e),!n)return!1;r.isDragArea||(r.isDragArea=!0,ua(e))},dragEnd:function(e,t){this.enableNativeEvent(e);var r=t.inputEvent,n=t.datas;if(!r)return!1;n.isDragArea||ua(e)},dragGroupStart:function(e,t){return this.dragStart(e,t)},dragGroup:function(e,t){return this.drag(e,t)},dragGroupEnd:function(e,t){return this.dragEnd(e,t)},unset:function(e){ua(e),e.state.disableNativeEvent=!1},enableNativeEvent:function(e){var t=e.state;t.disableNativeEvent&&Qo(function(){t.disableNativeEvent=!1})}},yv=Vr("origin",{render:function(e,t){var r=e.props.zoom,n=e.getState(),a=n.beforeOrigin,i=n.rotation;return[t.createElement("div",{className:rt("control","origin"),style:vi(i,r,a),key:"beforeOrigin"})]}});function Sv(e){var t=e.scrollContainer;return[t.scrollLeft,t.scrollTop]}var Cv={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number,scrollThrottleTime:Number,getScrollPosition:Function,scrollOptions:Object},events:{onScroll:"scroll",onScrollGroup:"scrollGroup"},dragRelation:"strong",dragStart:function(e,t){var r=e.props,n=r.scrollContainer,a=n===void 0?e.getContainer():n,i=r.scrollOptions,o=new xd,s=je(a,!0);t.datas.dragScroll=o,e.state.dragScroll=o;var l=t.isControl?"controlGesto":"targetGesto",u=t.targets;o.on("scroll",function(c){var d=c.container,f=c.direction,p=ot(e,t,{scrollContainer:d,direction:f}),v=u?"onScrollGroup":"onScroll";u&&(p.targets=u),Z(e,v,p)}).on("move",function(c){var d=c.offsetX,f=c.offsetY,p=c.inputEvent;e[l].scrollBy(d,f,p.inputEvent,!0)}).on("scrollDrag",function(c){var d=c.next;d(e[l].getCurrentEvent())}),o.dragStart(t,k({container:s},i))},checkScroll:function(e,t){var r=t.datas.dragScroll;if(r){var n=e.props,a=n.scrollContainer,i=a===void 0?e.getContainer():a,o=n.scrollThreshold,s=o===void 0?0:o,l=n.scrollThrottleTime,u=l===void 0?0:l,c=n.getScrollPosition,d=c===void 0?Sv:c,f=n.scrollOptions;return r.drag(t,k({container:i,threshold:s,throttleTime:u,getScrollPosition:function(p){return d({scrollContainer:p.container,direction:p.direction})}},f)),!0}},drag:function(e,t){return this.checkScroll(e,t)},dragEnd:function(e,t){t.datas.dragScroll.dragEnd(),t.datas.dragScroll=null},dragControlStart:function(e,t){return this.dragStart(e,k(k({},t),{isControl:!0}))},dragControl:function(e,t){return this.drag(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupStart:function(e,t){return this.dragStart(e,k(k({},t),{targets:e.props.targets}))},dragGroup:function(e,t){return this.drag(e,k(k({},t),{targets:e.props.targets}))},dragGroupEnd:function(e,t){return this.dragEnd(e,k(k({},t),{targets:e.props.targets}))},dragGroupControlStart:function(e,t){return this.dragStart(e,k(k({},t),{targets:e.props.targets,isControl:!0}))},dragGroupControl:function(e,t){return this.drag(e,k(k({},t),{targets:e.props.targets}))},dragGroupControEnd:function(e,t){return this.dragEnd(e,k(k({},t),{targets:e.props.targets}))},unset:function(e){var t,r=e.state;(t=r.dragScroll)===null||t===void 0||t.dragEnd(),r.dragScroll=null}},gl={name:"",props:{target:Object,dragTarget:Object,container:Object,portalContainer:Object,rootContainer:Object,useResizeObserver:Boolean,zoom:Number,transformOrigin:Array,edge:Object,ables:Array,className:String,pinchThreshold:Number,pinchOutside:Boolean,triggerAblesSimultaneously:Boolean,checkInput:Boolean,cspNonce:String,translateZ:Number,hideDefaultLines:Boolean,props:Object,flushSync:Function,stopPropagation:Boolean,preventClickEventOnDrag:Boolean,preventClickDefault:Boolean,viewContainer:Object,persistData:Object,useAccuratePosition:Boolean,firstRenderState:Object,linePadding:Boolean},events:{onChangeTargets:"changeTargets"}},wv=Vr("padding",{render:function(e,t){var r=e.props;if(r.dragArea)return[];var n=r.padding||{},a=n.left,i=a===void 0?0:a,o=n.top,s=o===void 0?0:o,l=n.right,u=l===void 0?0:l,c=n.bottom,d=c===void 0?0:c,f=e.getState(),p=f.renderPoses,v=f.pos1,h=f.pos2,g=f.pos3,m=f.pos4,b=[v,h,g,m],x=[];return i>0&&x.push([0,2]),s>0&&x.push([0,1]),u>0&&x.push([1,3]),d>0&&x.push([2,3]),x.map(function(_,S){var y=_[0],C=_[1],M=b[y],E=b[C],w=p[y],T=p[C],D=oi([0,0],[100,0],[0,100],[100,100],M,E,w,T);if(D.length)return t.createElement("div",{key:"padding".concat(S),className:rt("padding"),style:{transform:Fn(D,!0)}})})}}),wo=["nw","ne","se","sw"];function sn(e,t){var r=e[0]+e[1],n=r>t?t/r:1;return e[0]*=n,e[1]=t-e[1]*n,e}var Ev=[1,2,5,6],Dv=[0,3,4,7],Ne=[1,-1,-1,1],$e=[1,1,-1,-1];function Ei(e,t,r,n,a,i,o,s){a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o=r),s===void 0&&(s=n);var l=[],u=!1,c=e.filter(function(f){return!f.virtual}),d=c.map(function(f){var p=f.horizontal,v=f.vertical,h=f.pos;if(v&&!u&&(u=!0,l.push("/")),u){var g=Math.max(0,v===1?h[1]-i:s-h[1]);return l.push(ce(g,n,t)),g}else{var g=Math.max(0,p===1?h[0]-a:o-h[0]);return l.push(ce(g,r,t)),g}});return{radiusPoses:c,styles:l,raws:d}}function ml(e){for(var t=[0,0],r=[0,0],n=e.length,a=0;a<n;++a){var i=e[a];i.sub&&(i.horizontal&&(t[1]===0&&(t[0]=a),t[1]=a-t[0]+1,r[0]=a+1),i.vertical&&(r[1]===0&&(r[0]=a),r[1]=a-r[0]+1))}return{horizontalRange:t,verticalRange:r}}function bl(e,t,r,n,a,i,o){var s,l,u,c;i===void 0&&(i=[0,0]),o===void 0&&(o=!1);var d=e.indexOf("/"),f=(d>-1?e.slice(0,d):e).length,p=e.slice(0,f),v=e.slice(f+1),h=p.length,g=v.length,m=g>0,b=p[0],x=b===void 0?"0px":b,_=p[1],S=_===void 0?x:_,y=p[2],C=y===void 0?x:y,M=p[3],E=M===void 0?S:M,w=v[0],T=w===void 0?x:w,D=v[1],R=D===void 0?m?T:S:D,I=v[2],B=I===void 0?m?T:C:I,V=v[3],j=V===void 0?m?R:E:V,W=[x,S,C,E].map(function(N){return yt(N,t)}),X=[T,R,B,j].map(function(N){return yt(N,r)}),z=W.slice(),Y=X.slice();s=sn([z[0],z[1]],t),z[0]=s[0],z[1]=s[1],l=sn([z[3],z[2]],t),z[3]=l[0],z[2]=l[1],u=sn([Y[0],Y[3]],r),Y[0]=u[0],Y[3]=u[1],c=sn([Y[1],Y[2]],r),Y[1]=c[0],Y[2]=c[1];var G=o?z:z.slice(0,Math.max(i[0],h)),A=o?Y:Y.slice(0,Math.max(i[1],g));return nt(nt([],G.map(function(N,L){var $=wo[L];return{virtual:L>=h,horizontal:Ne[L],vertical:0,pos:[n+N,a+($e[L]===-1?r:0)],sub:!0,raw:W[L],direction:$}}),!0),A.map(function(N,L){var $=wo[L];return{virtual:L>=g,horizontal:0,vertical:$e[L],pos:[n+(Ne[L]===-1?t:0),a+N],sub:!0,raw:X[L],direction:$}}),!0)}function Mv(e,t,r,n,a){a===void 0&&(a=t.length);var i=ml(e.slice(n)),o=i.horizontalRange,s=i.verticalRange,l=r-n,u=0;if(l===0)u=a;else if(l>0&&l<o[1])u=o[1]-l;else if(l>=s[0])u=s[0]+s[1]-l;else return;e.splice(r,u),t.splice(r,u)}function kv(e,t,r,n,a,i,o,s,l,u,c){u===void 0&&(u=0),c===void 0&&(c=0);var d=ml(e.slice(r)),f=d.horizontalRange,p=d.verticalRange;if(n>-1)for(var v=Ne[n]===1?i-u:s-i,h=f[1];h<=n;++h){var g=$e[h]===1?c:l,m=0;if(n===h?m=i:h===0?m=u+v:Ne[h]===-1&&(m=s-(t[r][0]-u)),e.splice(r+h,0,{horizontal:Ne[h],vertical:0,pos:[m,g]}),t.splice(r+h,0,[m,g]),h===0)break}else if(a>-1){var b=$e[a]===1?o-c:l-o;if(f[1]===0&&p[1]===0){var x=[u+b,c];e.push({horizontal:Ne[0],vertical:0,pos:x}),t.push(x)}for(var _=p[0],h=p[1];h<=a;++h){var m=Ne[h]===1?u:s,g=0;if(a===h?g=o:h===0?g=c+b:$e[h]===1?g=t[r+_][1]:$e[h]===-1&&(g=l-(t[r+_][1]-c)),e.push({horizontal:0,vertical:$e[h],pos:[m,g]}),t.push([m,g]),h===0)break}}}function Tv(e,t){t===void 0&&(t=e.map(function(a){return a.raw}));var r=e.map(function(a,i){return a.horizontal?t[i]:null}).filter(function(a){return a!=null}),n=e.map(function(a,i){return a.vertical?t[i]:null}).filter(function(a){return a!=null});return{horizontals:r,verticals:n}}var Rv=[[0,-1,"n"],[1,0,"e"]],Iv=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function Di(e,t,r){var n=e.props.clipRelative,a=e.state,i=a.width,o=a.height,s=t,l=s.type,u=s.poses,c=l==="rect",d=l==="circle";if(l==="polygon")return r.map(function(y){return"".concat(ce(y[0],i,n)," ").concat(ce(y[1],o,n))});if(c||l==="inset"){var f=r[1][1],p=r[3][0],v=r[7][0],h=r[5][1];if(c)return[f,p,h,v].map(function(y){return"".concat(y,"px")});var g=[f,i-p,o-h,v].map(function(y,C){return ce(y,C%2?i:o,n)});if(r.length>8){var m=et(r[4],r[0]),b=m[0],x=m[1];g.push.apply(g,nt(["round"],Ei(u.slice(8).map(function(y,C){return k(k({},y),{pos:r[C]})}),n,b,x,v,f,p,h).styles,!1))}return g}else if(d||l==="ellipse"){var _=r[0],S=ce(Math.abs(r[1][1]-_[1]),d?Math.sqrt((i*i+o*o)/2):o,n),g=d?[S]:[ce(Math.abs(r[2][0]-_[0]),i,n),S];return g.push("at",ce(_[0],i,n),ce(_[1],o,n)),g}}function Sn(e,t,r,n){var a=[n,(n+t)/2,t],i=[e,(e+r)/2,r];return Iv.map(function(o){var s=o[0],l=o[1],u=o[2],c=a[s+1],d=i[l+1];return{vertical:Math.abs(l),horizontal:Math.abs(s),direction:u,pos:[c,d]}})}function xl(e){var t=[1/0,-1/0],r=[1/0,-1/0];return e.forEach(function(n){var a=n.pos;t[0]=Math.min(t[0],a[0]),t[1]=Math.max(t[1],a[0]),r[0]=Math.min(r[0],a[1]),r[1]=Math.max(r[1],a[1])}),[Math.abs(t[1]-t[0]),Math.abs(r[1]-r[0])]}function Eo(e,t,r,n,a){var i,o,s,l,u,c,d;if(e){var f=a;if(!f){var p=getComputedStyle(e),v=p.clipPath;f=v!=="none"?v:p.clip}if(!((!f||f==="none"||f==="auto")&&(f=n,!f))){var h=Jo(f),g=h.prefix,m=g===void 0?f:g,b=h.value,x=b===void 0?"":b,_=m==="circle",S=" ";if(m==="polygon"){var y=We(x||"0% 0%, 100% 0%, 100% 100%, 0% 100%");S=",";var C=y.map(function(ct){var ht=ct.split(" "),gt=ht[0],Kt=ht[1];return{vertical:1,horizontal:1,pos:[yt(gt,t),yt(Kt,r)]}}),M=Oe(C.map(function(ct){return ct.pos}));return{type:m,clipText:f,poses:C,splitter:S,left:M.minX,right:M.maxX,top:M.minY,bottom:M.maxY}}else if(_||m==="ellipse"){var E="",w="",T=0,D=0,y=Pe(x);if(_){var R="";i=y[0],R=i===void 0?"50%":i,o=y[2],E=o===void 0?"50%":o,s=y[3],w=s===void 0?"50%":s,T=yt(R,Math.sqrt((t*t+r*r)/2)),D=T}else{var I="",B="";l=y[0],I=l===void 0?"50%":l,u=y[1],B=u===void 0?"50%":u,c=y[3],E=c===void 0?"50%":c,d=y[4],w=d===void 0?"50%":d,T=yt(I,t),D=yt(B,r)}var V=[yt(E,t),yt(w,r)],C=nt([{vertical:1,horizontal:1,pos:V,direction:"nesw"}],Rv.slice(0,_?1:2).map(function(gt){return{vertical:Math.abs(gt[1]),horizontal:gt[0],direction:gt[2],sub:!0,pos:[V[0]+gt[0]*T,V[1]+gt[1]*D]}}),!0);return{type:m,clipText:f,radiusX:T,radiusY:D,left:V[0]-T,top:V[1]-D,right:V[0]+T,bottom:V[1]+D,poses:C,splitter:S}}else if(m==="inset"){var y=Pe(x||"0 0 0 0"),j=y.indexOf("round"),W=(j>-1?y.slice(0,j):y).length,X=y.slice(W+1),z=y.slice(0,W),Y=z[0],G=z[1],A=G===void 0?Y:G,N=z[2],L=N===void 0?Y:N,$=z[3],U=$===void 0?A:$,Q=[Y,L].map(function(gt){return yt(gt,r)}),at=Q[0],J=Q[1],tt=[U,A].map(function(gt){return yt(gt,t)}),lt=tt[0],ut=tt[1],Tt=t-ut,bt=r-J,vt=bl(X,Tt-lt,bt-at,lt,at),C=nt(nt([],Sn(at,Tt,bt,lt),!0),vt,!0);return{type:"inset",clipText:f,poses:C,top:at,left:lt,right:Tt,bottom:bt,radius:X,splitter:S}}else if(m==="rect"){var y=We(x||"0px, ".concat(t,"px, ").concat(r,"px, 0px"));S=",";var Ct=y.map(function(Ft){var Me=Lr(Ft).value;return Me}),at=Ct[0],ut=Ct[1],J=Ct[2],lt=Ct[3],C=Sn(at,ut,J,lt);return{type:"rect",clipText:f,poses:C,top:at,right:ut,bottom:J,left:lt,values:y,splitter:S}}}}}function Pv(e,t,r,n,a){var i=e[t],o=i.direction,s=i.sub,l=e.map(function(){return[0,0]}),u=o?o.split(""):[];if(n&&t<8){var c=u.filter(function(R){return R==="w"||R==="e"}),d=u.filter(function(R){return R==="n"||R==="s"}),f=c[0],p=d[0];l[t]=r;var v=xl(e),h=v[0],g=v[1],m=h&&g?h/g:0;if(m&&a){var b=(t+4)%8,x=e[b].pos,_=[0,0];o.indexOf("w")>-1?_[0]=-1:o.indexOf("e")>-1&&(_[0]=1),o.indexOf("n")>-1?_[1]=-1:o.indexOf("s")>-1&&(_[1]=1);var S=Ks([h,g],r,m,_,!0),y=h+S[0],C=g+S[1],M=x[1],E=x[1],w=x[0],T=x[0];_[0]===-1?w=T-y:_[0]===1?T=w+y:(w=w-y/2,T=T+y/2),_[1]===-1?M=E-C:(_[1]===1||(M=E-C/2),E=M+C);var D=Sn(M,T,E,w);e.forEach(function(R,I){l[I][0]=D[I].pos[0]-R.pos[0],l[I][1]=D[I].pos[1]-R.pos[1]})}else e.forEach(function(R,I){var B=R.direction;B&&(B.indexOf(f)>-1&&(l[I][0]=r[0]),B.indexOf(p)>-1&&(l[I][1]=r[1]))}),f&&(l[1][0]=r[0]/2,l[5][0]=r[0]/2),p&&(l[3][1]=r[1]/2,l[7][1]=r[1]/2)}else o&&!s?u.forEach(function(R){var I=R==="n"||R==="s";e.forEach(function(B,V){var j=B.direction,W=B.horizontal,X=B.vertical;!j||j.indexOf(R)===-1||(l[V]=[I||!W?0:r[0],!I||!X?0:r[1]])})}):l[t]=r;return l}function Ov(e,t){var r=ks(e,t),n=r[0],a=r[1],i=t.datas,o=i.clipPath,s=i.clipIndex,l=o,u=l.type,c=l.poses,d=l.splitter,f=c.map(function(b){return b.pos});if(u==="polygon")f.splice(s,0,[n,a]);else if(u==="inset"){var p=Ev.indexOf(s),v=Dv.indexOf(s),h=c.length;if(kv(c,f,8,p,v,n,a,f[4][0],f[4][1],f[0][0],f[0][1]),h===c.length)return}else return;var g=Di(e,o,f),m="".concat(u,"(").concat(g.join(d),")");Z(e,"onClip",ot(e,t,k({clipEventType:"added",clipType:u,poses:f,clipStyles:g,clipStyle:m,distX:0,distY:0},Ut({clipPath:m},t))))}function Bv(e,t){var r=t.datas,n=r.clipPath,a=r.clipIndex,i=n,o=i.type,s=i.poses,l=i.splitter,u=s.map(function(p){return p.pos}),c=u.length;if(o==="polygon")s.splice(a,1),u.splice(a,1);else if(o==="inset"){if(a<8||(Mv(s,u,a,8,c),c===s.length))return}else return;var d=Di(e,n,u),f="".concat(o,"(").concat(d.join(l),")");Z(e,"onClip",ot(e,t,k({clipEventType:"removed",clipType:o,poses:u,clipStyles:d,clipStyle:f,distX:0,distY:0},Ut({clipPath:f},t))))}var zv={name:"clippable",props:{clippable:Boolean,defaultClipPath:String,customClipPath:String,keepRatio:Boolean,clipRelative:Boolean,clipArea:Boolean,dragWithClip:Boolean,clipTargetBounds:Boolean,clipVerticalGuidelines:Array,clipHorizontalGuidelines:Array,clipSnapThreshold:Boolean},events:{onClipStart:"clipStart",onClip:"clip",onClipEnd:"clipEnd"},css:[`.control.clip-control {
    background: #6d6;
    cursor: pointer;
}
.control.clip-control.clip-radius {
    background: #d66;
}
.line.clip-line {
    background: #6e6;
    cursor: move;
    z-index: 1;
}
.clip-area {
    position: absolute;
    top: 0;
    left: 0;
}
.clip-ellipse {
    position: absolute;
    cursor: move;
    border: 1px solid #6d6;
    border: var(--zoompx) solid #6d6;
    border-radius: 50%;
    transform-origin: 0px 0px;
}`,`:host {
    --bounds-color: #d66;
}`,`.guideline {
    pointer-events: none;
    z-index: 2;
}`,`.line.guideline.bounds {
    background: #d66;
    background: var(--bounds-color);
}`],render:function(e,t){var r=e.props,n=r.customClipPath,a=r.defaultClipPath,i=r.clipArea,o=r.zoom,s=r.groupable,l=e.getState(),u=l.target,c=l.width,d=l.height,f=l.allMatrix,p=l.is3d,v=l.left,h=l.top,g=l.pos1,m=l.pos2,b=l.pos3,x=l.pos4,_=l.clipPathState,S=l.snapBoundInfos,y=l.rotation;if(!u||s)return[];var C=Eo(u,c,d,a||"inset",_||n);if(!C)return[];var M=p?4:3,E=C.type,w=C.poses,T=w.map(function(bt){var vt=zt(f,bt.pos,M);return[vt[0]-v,vt[1]-h]}),D=[],R=[],I=E==="rect",B=E==="inset",V=E==="polygon";if(I||B||V){var j=B?T.slice(0,8):T;R=j.map(function(bt,vt){var Ct=vt===0?j[j.length-1]:j[vt-1],ct=Mt(Ct,bt),ht=$s(Ct,bt);return t.createElement("div",{key:"clipLine".concat(vt),className:rt("line","clip-line","snap-control"),"data-clip-index":vt,style:{width:"".concat(ht,"px"),transform:"translate(".concat(Ct[0],"px, ").concat(Ct[1],"px) rotate(").concat(ct,"rad) scaleY(").concat(o,")")}})})}if(D=T.map(function(bt,vt){return t.createElement("div",{key:"clipControl".concat(vt),className:rt("control","clip-control","snap-control"),"data-clip-index":vt,style:{transform:"translate(".concat(bt[0],"px, ").concat(bt[1],"px) rotate(").concat(y,"rad) scale(").concat(o,")")}})}),B&&D.push.apply(D,T.slice(8).map(function(bt,vt){return t.createElement("div",{key:"clipRadiusControl".concat(vt),className:rt("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+vt,style:{transform:"translate(".concat(bt[0],"px, ").concat(bt[1],"px) rotate(").concat(y,"rad) scale(").concat(o,")")}})})),E==="circle"||E==="ellipse"){var W=C.left,X=C.top,z=C.radiusX,Y=C.radiusY,G=et(zt(f,[W,X],M),zt(f,[0,0],M)),A=G[0],N=G[1],L="none";if(!i){for(var $=Math.max(10,z/5,Y/5),U=[],Q=0;Q<=$;++Q){var at=Math.PI*2/$*Q;U.push([z+(z-o)*Math.cos(at),Y+(Y-o)*Math.sin(at)])}U.push([z,-2]),U.push([-2,-2]),U.push([-2,Y*2+2]),U.push([z*2+2,Y*2+2]),U.push([z*2+2,-2]),U.push([z,-2]),L="polygon(".concat(U.map(function(bt){return"".concat(bt[0],"px ").concat(bt[1],"px")}).join(", "),")")}D.push(t.createElement("div",{key:"clipEllipse",className:rt("clip-ellipse","snap-control"),style:{width:"".concat(z*2,"px"),height:"".concat(Y*2,"px"),clipPath:L,transform:"translate(".concat(-v+A,"px, ").concat(-h+N,"px) ").concat(Fn(f))}}))}if(i){var J=le(nt([g,m,b,x],T,!0)),tt=J.width,lt=J.height,ut=J.left,Tt=J.top;if(V||I||B){var U=B?T.slice(0,8):T;D.push(t.createElement("div",{key:"clipArea",className:rt("clip-area","snap-control"),style:{width:"".concat(tt,"px"),height:"".concat(lt,"px"),transform:"translate(".concat(ut,"px, ").concat(Tt,"px)"),clipPath:"polygon(".concat(U.map(function(vt){return"".concat(vt[0]-ut,"px ").concat(vt[1]-Tt,"px")}).join(", "),")")}}))}}return S&&["vertical","horizontal"].forEach(function(bt){var vt=S[bt],Ct=bt==="horizontal";vt.isSnap&&R.push.apply(R,vt.snap.posInfos.map(function(ct,ht){var gt=ct.pos,Kt=et(zt(f,Ct?[0,gt]:[gt,0],M),[v,h]),De=et(zt(f,Ct?[c,gt]:[gt,d],M),[v,h]);return Tr(t,"",Kt,De,o,"clip".concat(bt,"snap").concat(ht),"guideline")})),vt.isBound&&R.push.apply(R,vt.bounds.map(function(ct,ht){var gt=ct.pos,Kt=et(zt(f,Ct?[0,gt]:[gt,0],M),[v,h]),De=et(zt(f,Ct?[c,gt]:[gt,d],M),[v,h]);return Tr(t,"",Kt,De,o,"clip".concat(bt,"bounds").concat(ht),"guideline","bounds","bold")}))}),nt(nt([],D,!0),R,!0)},dragControlCondition:function(e,t){return t.inputEvent&&(t.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(e,t){var r=e.props,n=r.dragWithClip,a=n===void 0?!0:n;return a?!1:this.dragControlStart(e,t)},drag:function(e,t){return this.dragControl(e,k(k({},t),{isDragTarget:!0}))},dragEnd:function(e,t){return this.dragControlEnd(e,t)},dragControlStart:function(e,t){var r=e.state,n=e.props,a=n.defaultClipPath,i=n.customClipPath,o=r.target,s=r.width,l=r.height,u=t.inputEvent?t.inputEvent.target:null,c=u&&u.getAttribute("class")||"",d=t.datas,f=Eo(o,s,l,a||"inset",i);if(!f)return!1;var p=f.clipText,v=f.type,h=f.poses,g=Z(e,"onClipStart",ot(e,t,{clipType:v,clipStyle:p,poses:h.map(function(m){return m.pos})}));return g===!1?(d.isClipStart=!1,!1):(d.isControl=c&&c.indexOf("clip-control")>-1,d.isLine=c.indexOf("clip-line")>-1,d.isArea=c.indexOf("clip-area")>-1||c.indexOf("clip-ellipse")>-1,d.clipIndex=u?parseInt(u.getAttribute("data-clip-index"),10):-1,d.clipPath=f,d.isClipStart=!0,r.clipPathState=p,qe(e,t),!0)},dragControl:function(e,t){var r,n,a=t.datas,i=t.originalDatas,o=t.isDragTarget;if(!a.isClipStart)return!1;var s=a,l=s.isControl,u=s.isLine,c=s.isArea,d=s.clipIndex,f=s.clipPath;if(!f)return!1;var p=Ye(e.props,"clippable"),v=p.keepRatio,h=0,g=0,m=i.draggable,b=xe(t);o&&m?(r=m.prevBeforeDist,h=r[0],g=r[1]):(h=b[0],g=b[1]);var x=[h,g],_=e.state,S=_.width,y=_.height,C=!c&&!l&&!u,M=f.type,E=f.poses,w=f.splitter,T=E.map(function(St){return St.pos});C&&(h=-h,g=-g);var D=!l||E[d].direction==="nesw",R=M==="inset"||M==="rect",I=E.map(function(){return[0,0]});if(l&&!D){var B=E[d],V=B.horizontal,j=B.vertical,W=[h*Math.abs(V),g*Math.abs(j)];I=Pv(E,d,W,R,v)}else D&&(I=T.map(function(){return[h,g]}));var X=T.map(function(St,Xt){return ft(St,I[Xt])}),z=nt([],X,!0);_.snapBoundInfos=null;var Y=f.type==="circle",G=f.type==="ellipse";if(Y||G){var A=le(X),N=Math.abs(A.bottom-A.top),L=Math.abs(G?A.right-A.left:N),$=X[0][1]+N,U=X[0][0]-L,Q=X[0][0]+L;Y&&(z.push([Q,A.bottom]),I.push([1,0])),z.push([A.left,$]),I.push([0,1]),z.push([U,A.bottom]),I.push([1,0])}var at=il((p.clipHorizontalGuidelines||[]).map(function(St){return yt("".concat(St),y)}),(p.clipVerticalGuidelines||[]).map(function(St){return yt("".concat(St),S)}),S,y),J=[],tt=[];if(Y||G)J=[z[4][0],z[2][0]],tt=[z[1][1],z[3][1]];else if(R){var lt=[z[0],z[2],z[4],z[6]],ut=[I[0],I[2],I[4],I[6]];J=lt.filter(function(St,Xt){return ut[Xt][0]}).map(function(St){return St[0]}),tt=lt.filter(function(St,Xt){return ut[Xt][1]}).map(function(St){return St[1]})}else J=z.filter(function(St,Xt){return I[Xt][0]}).map(function(St){return St[0]}),tt=z.filter(function(St,Xt){return I[Xt][1]}).map(function(St){return St[1]});var Tt=[0,0],bt=go(at,p.clipTargetBounds&&{left:0,top:0,right:S,bottom:y},J,tt,5),vt=bt.horizontal,Ct=bt.vertical,ct=vt.offset,ht=Ct.offset;if(vt.isBound&&(Tt[1]+=ct),Ct.isBound&&(Tt[0]+=ht),(G||Y)&&I[0][0]===0&&I[0][1]===0){var A=le(X),gt=A.bottom-A.top,Kt=G?A.right-A.left:gt,De=Ct.isBound?Math.abs(ht):Ct.snapIndex===0?-ht:ht,Bt=vt.isBound?Math.abs(ct):vt.snapIndex===0?-ct:ct;Kt-=De,gt-=Bt,Y&&(gt=tl(Ct,vt)>0?gt:Kt,Kt=gt);var Ft=z[0];z[1][1]=Ft[1]-gt,z[2][0]=Ft[0]+Kt,z[3][1]=Ft[1]+gt,z[4][0]=Ft[0]-Kt}else if(R&&v&&l){var Me=xl(E),Ke=Me[0],Bi=Me[1],zi=Ke&&Bi?Ke/Bi:0,Ll=E[d],Yr=Ll.direction||"",Hn=z[1][1],$=z[5][1],U=z[7][0],Q=z[3][0];ct<=ht?ct=ht/zi:ht=ct*zi,Yr.indexOf("w")>-1?U-=ht:Yr.indexOf("e")>-1?Q-=ht:(U+=ht/2,Q-=ht/2),Yr.indexOf("n")>-1?Hn-=ct:Yr.indexOf("s")>-1?$-=ct:(Hn+=ct/2,$-=ct/2);var Gl=Sn(Hn,Q,$,U);z.forEach(function(Gi,Vl){var Un;Un=Gl[Vl].pos,Gi[0]=Un[0],Gi[1]=Un[1]})}else z.forEach(function(St,Xt){var Li=I[Xt];Li[0]&&(St[0]-=ht),Li[1]&&(St[1]-=ct)});var Ai=Di(e,f,X),Yn="".concat(M,"(").concat(Ai.join(w),")");if(_.clipPathState=Yn,Y||G)J=[z[4][0],z[2][0]],tt=[z[1][1],z[3][1]];else if(R){var lt=[z[0],z[2],z[4],z[6]];J=lt.map(function(Xt){return Xt[0]}),tt=lt.map(function(Xt){return Xt[1]})}else J=z.map(function(St){return St[0]}),tt=z.map(function(St){return St[1]});if(_.snapBoundInfos=go(at,p.clipTargetBounds&&{left:0,top:0,right:S,bottom:y},J,tt,1),m){var Fl=_.is3d,Nl=_.allMatrix,$l=Fl?4:3,jn=Tt;o&&(jn=[x[0]+Tt[0]-b[0],x[1]+Tt[1]-b[1]]),m.deltaOffset=_t(Nl,[jn[0],jn[1],0,0],$l)}return Z(e,"onClip",ot(e,t,k({clipEventType:"changed",clipType:M,poses:X,clipStyle:Yn,clipStyles:Ai,distX:h,distY:g},Ut((n={},n[M==="rect"?"clip":"clipPath"]=Yn,n),t)))),!0},dragControlEnd:function(e,t){this.unset(e);var r=t.isDrag,n=t.datas,a=t.isDouble,i=n.isLine,o=n.isClipStart,s=n.isControl;return o?(Z(e,"onClipEnd",ae(e,t,{})),a&&(s?Bv(e,t):i&&Ov(e,t)),a||r):!1},unset:function(e){e.state.clipPathState="",e.state.snapBoundInfos=null}},Av={name:"originDraggable",props:{originDraggable:Boolean,originRelative:Boolean},events:{onDragOriginStart:"dragOriginStart",onDragOrigin:"dragOrigin",onDragOriginEnd:"dragOriginEnd"},css:[`:host[data-able-origindraggable] .control.origin {
    pointer-events: auto;
}`],dragControlCondition:function(e,t){return t.isRequest?t.requestAble==="originDraggable":At(t.inputEvent.target,rt("origin"))},dragControlStart:function(e,t){var r=t.datas;qe(e,t);var n=ot(e,t,{dragStart:Yt.dragStart(e,new ar().dragStart([0,0],t))}),a=Z(e,"onDragOriginStart",n);return r.startOrigin=e.state.transformOrigin,r.startTargetOrigin=e.state.targetOrigin,r.prevOrigin=[0,0],r.isDragOrigin=!0,a===!1?(r.isDragOrigin=!1,!1):n},dragControl:function(e,t){var r=t.datas,n=t.isPinch,a=t.isRequest;if(!r.isDragOrigin)return!1;var i=xe(t),o=i[0],s=i[1],l=e.state,u=l.width,c=l.height,d=l.offsetMatrix,f=l.targetMatrix,p=l.is3d,v=e.props.originRelative,h=v===void 0?!0:v,g=p?4:3,m=[o,s];if(a){var b=t.distOrigin;(b[0]||b[1])&&(m=b)}var x=ft(r.startOrigin,m),_=ft(r.startTargetOrigin,m),S=et(m,r.prevOrigin),y=Xr(d,f,x,g),C=e.getRect(),M=le(Be(y,u,c,g)),E=[C.left-M.left,C.top-M.top];r.prevOrigin=m;var w=[ce(_[0],u,h),ce(_[1],c,h)].join(" "),T=Yt.drag(e,Wr(t,e.state,E,!!n)),D=ot(e,t,k(k({width:u,height:c,origin:x,dist:m,delta:S,transformOrigin:w,drag:T},Ut({transformOrigin:w,transform:T.transform},t)),{afterTransform:T.transform}));return Z(e,"onDragOrigin",D),D},dragControlEnd:function(e,t){var r=t.datas;return r.isDragOrigin?(Z(e,"onDragOriginEnd",ae(e,t,{})),!0):!1},dragGroupControlCondition:function(e,t){return this.dragControlCondition(e,t)},dragGroupControlStart:function(e,t){var r=this.dragControlStart(e,t);return!!r},dragGroupControl:function(e,t){var r=this.dragControl(e,t);return r?(e.transformOrigin=r.transformOrigin,!0):!1},request:function(e){var t={},r=e.getRect(),n=0,a=0,i=r.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:t}},request:function(s){return"deltaOrigin"in s?(o[0]+=s.deltaOrigin[0],o[1]+=s.deltaOrigin[1]):"origin"in s?(o[0]=s.origin[0]-i[0],o[1]=s.origin[1]-i[1]):("x"in s?n=s.x-r.left:"deltaX"in s&&(n+=s.deltaX),"y"in s?a=s.y-r.top:"deltaY"in s&&(a+=s.deltaY)),{datas:t,distX:n,distY:a,distOrigin:o}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function Lv(e,t,r,n){var a=e.filter(function(l){var u=l.virtual,c=l.horizontal;return c&&!u}).length,i=e.filter(function(l){var u=l.virtual,c=l.vertical;return c&&!u}).length,o=-1;if(t===0&&(a===0?o=0:a===1&&(o=1)),t===2&&(a<=2?o=2:a<=3&&(o=3)),t===3&&(i===0?o=4:i<4&&(o=7)),t===1&&(i<=1?o=5:i<=2&&(o=6)),!(o===-1||!e[o].virtual)){var s=e[o];Gv(e,o),o<4?s.pos[0]=r:s.pos[1]=n}}function Gv(e,t){t<4?e.slice(0,t+1).forEach(function(r){r.virtual=!1}):(e[0].virtual&&(e[0].virtual=!1),e.slice(4,t+1).forEach(function(r){r.virtual=!1}))}function Fv(e,t){t<4?e.slice(t,4).forEach(function(r){r.virtual=!0}):e.slice(t).forEach(function(r){r.virtual=!0})}function Do(e,t,r,n,a){n===void 0&&(n=[0,0]);var i=[];return!e||e==="0px"?i=[]:i=Pe(e),bl(i,t,r,0,0,n,a)}function Mo(e,t,r,n,a){var i=e.state,o=i.width,s=i.height,l=Ei(a,e.props.roundRelative,o,s),u=l.raws,c=l.styles,d=l.radiusPoses,f=Tv(d,u),p=f.horizontals,v=f.verticals,h=c.join(" ");i.borderRadiusState=h;var g=ot(e,t,k({horizontals:p,verticals:v,borderRadius:h,width:o,height:s,delta:n,dist:r},Ut({borderRadius:h},t)));return Z(e,"onRound",g),g}function ko(e){var t=e.getState().style,r=t.borderRadius||"";if(!r&&e.props.groupable){var n=e.getTargets()[0];n&&(r=getComputedStyle(n).borderRadius,t.borderRadius=r)}return r}var Nv={name:"roundable",props:{roundable:Boolean,roundRelative:Boolean,minRoundControls:Array,maxRoundControls:Array,roundClickable:Boolean,roundPadding:Number,isDisplayShadowRoundControls:Boolean},events:{onRoundStart:"roundStart",onRound:"round",onRoundEnd:"roundEnd",onRoundGroupStart:"roundGroupStart",onRoundGroup:"roundGroup",onRoundGroupEnd:"roundGroupEnd"},css:[`.control.border-radius {
    background: #d66;
    cursor: pointer;
    z-index: 3;
}`,`.control.border-radius.vertical {
    background: #d6d;
    z-index: 2;
}`,`.control.border-radius.virtual {
    opacity: 0.5;
    z-index: 1;
}`,`:host.round-line-clickable .line.direction {
    cursor: pointer;
}`],className:function(e){var t=e.props.roundClickable;return t===!0||t==="line"?rt("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},render:function(e,t){var r=e.getState(),n=r.target,a=r.width,i=r.height,o=r.allMatrix,s=r.is3d,l=r.left,u=r.top,c=r.borderRadiusState,d=e.props,f=d.minRoundControls,p=f===void 0?[0,0]:f,v=d.maxRoundControls,h=v===void 0?[4,4]:v,g=d.zoom,m=d.roundPadding,b=m===void 0?0:m,x=d.isDisplayShadowRoundControls,_=d.groupable;if(!n)return null;var S=c||ko(e),y=s?4:3,C=Do(S,a,i,p,!0);if(!C)return null;var M=0,E=0,w=_?[0,0]:[l,u];return C.map(function(T,D){var R=T.horizontal,I=T.vertical,B=T.direction||"",V=nt([],T.pos,!0);E+=Math.abs(R),M+=Math.abs(I),R&&B.indexOf("n")>-1&&(V[1]-=b),I&&B.indexOf("w")>-1&&(V[0]-=b),R&&B.indexOf("s")>-1&&(V[1]+=b),I&&B.indexOf("e")>-1&&(V[0]+=b);var j=et(zt(o,V,y),w),W=T.vertical?M<=h[1]&&(x||!T.virtual):E<=h[0]&&(x||!T.virtual);return t.createElement("div",{key:"borderRadiusControl".concat(D),className:rt("control","border-radius",T.vertical?"vertical":"",T.virtual?"virtual":""),"data-radius-index":D,style:{display:W?"block":"none",transform:"translate(".concat(j[0],"px, ").concat(j[1],"px) scale(").concat(g,")")}})})},dragControlCondition:function(e,t){if(!t.inputEvent||t.isRequest)return!1;var r=t.inputEvent.target.getAttribute("class")||"";return r.indexOf("border-radius")>-1||r.indexOf("moveable-line")>-1&&r.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(e,t){return this.dragControlCondition(e,t)},dragControlStart:function(e,t){var r=t.inputEvent,n=t.datas,a=r.target,i=a.getAttribute("class")||"",o=i.indexOf("border-radius")>-1,s=i.indexOf("moveable-line")>-1&&i.indexOf("moveable-direction")>-1,l=o?parseInt(a.getAttribute("data-radius-index"),10):-1,u=-1;if(s){var c=a.getAttribute("data-line-key")||"";c&&(u=parseInt(c.replace(/render-line-/g,""),10),isNaN(u)&&(u=-1))}if(!o&&!s)return!1;var d=ot(e,t,{}),f=Z(e,"onRoundStart",d);if(f===!1)return!1;n.lineIndex=u,n.controlIndex=l,n.isControl=o,n.isLine=s,qe(e,t);var p=e.props,v=p.roundRelative,h=p.minRoundControls,g=h===void 0?[0,0]:h,m=e.state,b=m.width,x=m.height;n.isRound=!0,n.prevDist=[0,0];var _=ko(e),S=Do(_||"",b,x,g,!0)||[];return n.controlPoses=S,m.borderRadiusState=Ei(S,v,b,x).styles.join(" "),d},dragControl:function(e,t){var r=t.datas,n=r.controlPoses;if(!r.isRound||!r.isControl||!n.length)return!1;var a=r.controlIndex,i=xe(t),o=i[0],s=i[1],l=[o,s],u=et(l,r.prevDist),c=e.props.maxRoundControls,d=c===void 0?[4,4]:c,f=e.state,p=f.width,v=f.height,h=n[a],g=h.vertical,m=h.horizontal,b=n.map(function(_){var S=_.horizontal,y=_.vertical,C=[S*m*l[0],y*g*l[1]];if(S){if(d[0]===1)return C;if(d[0]<4&&S!==m)return C}else{if(d[1]===0)return C[1]=y*m*l[0]/p*v,C;if(g){if(d[1]===1)return C;if(d[1]<4&&y!==g)return C}}return[0,0]});b[a]=l;var x=n.map(function(_,S){return k(k({},_),{pos:ft(_.pos,b[S])})});return a<4?x.slice(0,a+1).forEach(function(_){_.virtual=!1}):x.slice(4,a+1).forEach(function(_){_.virtual=!1}),r.prevDist=[o,s],Mo(e,t,l,u,x)},dragControlEnd:function(e,t){var r=e.state;r.borderRadiusState="";var n=t.datas,a=t.isDouble;if(!n.isRound)return!1;var i=n.isControl,o=n.controlIndex,s=n.isLine,l=n.lineIndex,u=n.controlPoses,c=u.filter(function(m){var b=m.virtual;return b}).length,d=e.props.roundClickable,f=d===void 0?!0:d;if(a&&f){if(i&&(f===!0||f==="control"))Fv(u,o);else if(s&&(f===!0||f==="line")){var p=ks(e,t),v=p[0],h=p[1];Lv(u,l,v,h)}c!==u.filter(function(m){var b=m.virtual;return b}).length&&Mo(e,t,[0,0],[0,0],u)}var g=ae(e,t,{});return Z(e,"onRoundEnd",g),r.borderRadiusState="",g},dragGroupControlStart:function(e,t){var r=this.dragControlStart(e,t);if(!r)return!1;var n=e.moveables,a=e.props.targets,i=pe(e,"roundable",t),o=k({targets:e.props.targets,events:i.map(function(s,l){return k(k({},s),{target:a[l],moveable:n[l],currentTarget:n[l]})})},r);return Z(e,"onRoundGroupStart",o),r},dragGroupControl:function(e,t){var r=this.dragControl(e,t);if(!r)return!1;var n=e.moveables,a=e.props.targets,i=pe(e,"roundable",t),o=k({targets:e.props.targets,events:i.map(function(s,l){return k(k(k({},s),{target:a[l],moveable:n[l],currentTarget:n[l]}),Ut({borderRadius:r.borderRadius},s))})},r);return Z(e,"onRoundGroup",o),o},dragGroupControlEnd:function(e,t){var r=e.moveables,n=e.props.targets,a=pe(e,"roundable",t);Nn(e,"onRound",function(s){var l=k({targets:e.props.targets,events:a.map(function(u,c){return k(k(k({},u),{target:n[c],moveable:r[c],currentTarget:r[c]}),Ut({borderRadius:s.borderRadius},u))})},s);Z(e,"onRoundGroup",l)});var i=this.dragControlEnd(e,t);if(!i)return!1;var o=k({targets:e.props.targets,events:a.map(function(s,l){var u;return k(k({},s),{target:n[l],moveable:r[l],currentTarget:r[l],lastEvent:(u=s.datas)===null||u===void 0?void 0:u.lastEvent})})},i);return Z(e,"onRoundGroupEnd",o),o},unset:function(e){e.state.borderRadiusState=""}};function $v(e,t){var r=t?4:3,n=wt(r),a="matrix".concat(t?"3d":"","(").concat(n.join(","),")");return e===a||e==="matrix(1,0,0,1,0,0)"}var _l={isPinch:!0,name:"beforeRenderable",props:{},events:{onBeforeRenderStart:"beforeRenderStart",onBeforeRender:"beforeRender",onBeforeRenderEnd:"beforeRenderEnd",onBeforeRenderGroupStart:"beforeRenderGroupStart",onBeforeRenderGroup:"beforeRenderGroup",onBeforeRenderGroupEnd:"beforeRenderGroupEnd"},dragRelation:"weak",setTransform:function(e,t){var r=e.state,n=r.is3d,a=r.target,i=r.targetMatrix,o=a==null?void 0:a.style.transform,s=n?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(gs(i,!0),")"),l=!o||o==="none"?s:o;t.datas.startTransforms=$v(l,n)?[]:Pe(l)},resetStyle:function(e){var t=e.datas;t.nextStyle={},t.nextTransforms=e.datas.startTransforms,t.nextTransformAppendedIndexes=[]},fillDragStartParams:function(e,t){return ot(e,t,{setTransform:function(r){t.datas.startTransforms=Ot(r)?r:Pe(r)},isPinch:!!t.isPinch})},fillDragParams:function(e,t){return ot(e,t,{isPinch:!!t.isPinch})},dragStart:function(e,t){this.setTransform(e,t),this.resetStyle(t),Z(e,"onBeforeRenderStart",this.fillDragStartParams(e,t))},drag:function(e,t){this.resetStyle(t),Z(e,"onBeforeRender",ot(e,t,{isPinch:!!t.isPinch}))},dragEnd:function(e,t){Z(e,"onBeforeRenderEnd",ot(e,t,{isPinch:!!t.isPinch,isDrag:t.isDrag}))},dragGroupStart:function(e,t){var r=this;this.dragStart(e,t);var n=pe(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(o,s){var l=a[s];return r.setTransform(l,o),r.resetStyle(o),r.fillDragStartParams(l,o)});Z(e,"onBeforeRenderGroupStart",ot(e,t,{isPinch:!!t.isPinch,targets:e.props.targets,setTransform:function(){},events:i}))},dragGroup:function(e,t){var r=this;this.drag(e,t);var n=pe(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(o,s){var l=a[s];return r.resetStyle(o),r.fillDragParams(l,o)});Z(e,"onBeforeRenderGroup",ot(e,t,{isPinch:!!t.isPinch,targets:e.props.targets,events:i}))},dragGroupEnd:function(e,t){this.dragEnd(e,t),Z(e,"onBeforeRenderGroupEnd",ot(e,t,{isPinch:!!t.isPinch,isDrag:t.isDrag,targets:e.props.targets}))},dragControlStart:function(e,t){return this.dragStart(e,t)},dragControl:function(e,t){return this.drag(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupControlStart:function(e,t){return this.dragGroupStart(e,t)},dragGroupControl:function(e,t){return this.dragGroup(e,t)},dragGroupControlEnd:function(e,t){return this.dragGroupEnd(e,t)}},yl={name:"renderable",props:{},events:{onRenderStart:"renderStart",onRender:"render",onRenderEnd:"renderEnd",onRenderGroupStart:"renderGroupStart",onRenderGroup:"renderGroup",onRenderGroupEnd:"renderGroupEnd"},dragRelation:"weak",dragStart:function(e,t){Z(e,"onRenderStart",ot(e,t,{isPinch:!!t.isPinch}))},drag:function(e,t){Z(e,"onRender",this.fillDragParams(e,t))},dragAfter:function(e,t){if(t.resultCount)return this.drag(e,t)},dragEnd:function(e,t){Z(e,"onRenderEnd",this.fillDragEndParams(e,t))},dragGroupStart:function(e,t){Z(e,"onRenderGroupStart",ot(e,t,{isPinch:!!t.isPinch,targets:e.props.targets}))},dragGroup:function(e,t){var r=this,n=pe(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(o,s){var l=a[s];return r.fillDragParams(l,o)});Z(e,"onRenderGroup",ot(e,t,k(k({isPinch:!!t.isPinch,targets:e.props.targets,transform:Qr(t)},Ut(tn(t))),{events:i})))},dragGroupEnd:function(e,t){var r=this,n=pe(e,"beforeRenderable",t),a=e.moveables,i=n.map(function(o,s){var l=a[s];return r.fillDragEndParams(l,o)});Z(e,"onRenderGroupEnd",ot(e,t,k({isPinch:!!t.isPinch,isDrag:t.isDrag,targets:e.props.targets,events:i,transform:Qr(t)},Ut(tn(t)))))},dragControlStart:function(e,t){return this.dragStart(e,t)},dragControl:function(e,t){return this.drag(e,t)},dragControlAfter:function(e,t){return this.dragAfter(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupControlStart:function(e,t){return this.dragGroupStart(e,t)},dragGroupControl:function(e,t){return this.dragGroup(e,t)},dragGroupControlEnd:function(e,t){return this.dragGroupEnd(e,t)},fillDragParams:function(e,t){return ot(e,t,k({isPinch:!!t.isPinch,transform:Qr(t)},Ut(tn(t))))},fillDragEndParams:function(e,t){return ot(e,t,k({isPinch:!!t.isPinch,isDrag:t.isDrag,transform:Qr(t)},Ut(tn(t))))}};function Cr(e,t,r,n,a,i,o){var s=a==="Start",l=e.state.target,u=i.isRequest;if(!l||s&&n.indexOf("Control")>-1&&!u&&e.areaElement===i.inputEvent.target)return!1;var c="".concat(r).concat(n).concat(a),d="".concat(r).concat(n,"Condition"),f=a==="End",p=a==="After",v=s&&(!e.targetGesto||!e.controlGesto||!e.targetGesto.isFlag()||!e.controlGesto.isFlag());v&&e.updateRect(a,!0,!1),i.clientDistX=i.distX,i.clientDistY=i.distY,a===""&&!u&&gp(e.state,i);var h=nt([],e[t],!0);if(u){var g=i.requestAble;h.some(function(D){return D.name===g})||h.push.apply(h,e.props.ables.filter(function(D){return D.name===g}))}if(!h.length||h.every(function(D){return D.dragRelation}))return!1;var m=nt(nt([_l],h,!0),[yl],!1).filter(function(D){return D[c]}),b=i.datas;v&&m.forEach(function(D){D.unset&&D.unset(e)});var x=i.inputEvent,_;f&&x&&(_=document.elementFromPoint(i.clientX,i.clientY)||x.target);var S=0,y=!1,C=function(){var D;y=!0,(D=i.stop)===null||D===void 0||D.call(i)},M=m.filter(function(D){var R=D.name,I=b[R]||(b[R]={});if(s&&(I.isEventStart=!D[d]||D[d](e,i)),I.isEventStart){var B=D[c](e,k(k({},i),{stop:C,resultCount:S,datas:I,originalDatas:b,inputTarget:_}));return e._emitter.off(),s&&B===!1&&(I.isEventStart=!1),S+=B||I.isEventStart?1:0,B}return!1}),E=M.length,w=!1;if(y&&(w=!0),!w&&s&&m.length&&!E&&(w=m.filter(function(D){var R=D.name,I=b[R];return I.isEventStart?D.dragRelation!=="strong":!1}).length),(f||w)&&(e.state.gestos={},e.moveables&&e.moveables.forEach(function(D){D.state.gestos={}}),m.forEach(function(D){D.unset&&D.unset(e)})),s&&!w&&!u&&E&&(i==null||i.preventDefault()),e.isUnmounted||w)return!1;if(!s&&E&&!o||f){var T=e.props.flushSync||Gs;T(function(){e.updateRect(f?a:"",!0,!1),e.forceUpdate()})}return!s&&!f&&!p&&E&&!o&&Cr(e,t,r,n,a+"After",i),!0}function Na(e){return function(t){var r=e.props.dragTarget,n=t.inputEvent.target,a=e.areaElement;return r&&(n===r||r.contains(n))||n===a||!e.isMoveableElement(n)&&!e.controlBox.getElement().contains(n)||At(n,"moveable-area")||At(n,"moveable-padding")||At(n,"moveable-edgeDraggable")}}function Sl(e,t,r){var n=e.controlBox.getElement(),a=[],i=e.props.dragTarget;return a.push(n),(!e.props.dragArea||i)&&a.push(t),Mi(e,a,"targetAbles",r,{dragStart:Na(e),pinchStart:Na(e)})}function Mi(e,t,r,n,a){a===void 0&&(a={});var i=r==="targetAbles",o=e.props,s=o.pinchOutside,l=o.pinchThreshold,u=o.preventClickEventOnDrag,c=o.preventClickDefault,d=o.checkInput,f={preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,container:window,pinchThreshold:l,pinchOutside:s,preventClickEventOnDrag:i?u:!1,preventClickEventOnDragStart:i?c:!1,preventClickEventByCondition:i?null:function(h){return e.controlBox.getElement().contains(h.target)},checkInput:i?d:!1},p=new Ed(t,f),v=n==="Control";return["drag","pinch"].forEach(function(h){["Start","","End"].forEach(function(g){p.on("".concat(h).concat(g),function(m){var b,x=m.eventType;if(a[x]&&!a[x](m)){m.stop();return}var _=Cr(e,r,h,n,g,m);_?(e.props.stopPropagation||g==="Start"&&v)&&((b=m==null?void 0:m.inputEvent)===null||b===void 0||b.stopPropagation()):m.stop()})})}),p}var Vv=function(){function e(r,n,a){var i=this;this.target=r,this.moveable=n,this.eventName=a,this.ables=[],this._onEvent=function(o){var s=i.eventName,l=i.moveable;l.state.disableNativeEvent||i.ables.forEach(function(u){u[s](l,{inputEvent:o})})},r.addEventListener(a.toLowerCase(),this._onEvent)}var t=e.prototype;return t.setAbles=function(r){this.ables=r},t.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},e}();function Wv(e){if(e&&e.getRootNode){var t=e.getRootNode();if(t.nodeType===11)return t}}function To(e,t,r){for(var n=e,a=[],i=document.documentElement||document.body,o=!r&&e===t||e===i,s=o,l=!1,u=3,c,d,f,p=!1,v=kr(t,t,!0).offsetParent,h=1;n&&!s;){s=o;var g=getComputedStyle(n),m=g.position,b=Fs(n,g),x=rd(ap(b)),_=m==="fixed",S={hasTransform:!1,fixedContainer:null};_&&(p=!0,S=lp(n),v=S.fixedContainer);var y=x.length;!l&&y===16&&(l=!0,u=4,Pa(a),f&&(f=be(f,3,4))),l&&y===9&&(x=be(x,3,4));var C=sp(n,e,g),M=C.tagName,E=C.hasOffset,w=C.isSVG,T=C.origin,D=C.targetOrigin,R=C.offset,I=R[0],B=R[1];M==="svg"&&f&&(a.push({type:"target",target:n,matrix:up(n,u)}),a.push({type:"offset",target:n,matrix:wt(u)}));var V=void 0,j=!1,W=!1,X=parseFloat(g.zoom)||1;if(_)V=S.fixedContainer,j=!0;else{var z=kr(n,t,!1,!0,g),Y=z.offsetZoom;if(V=z.offsetParent,j=z.isEnd,W=z.isStatic,h*=Y,Y!==1&&W)I-=V.offsetLeft,B-=V.offsetTop;else if(Fd){var G=z.parentSlotElement;if(G){for(var A=V,N=0,L=0;A&&Wv(A);)N+=A.offsetLeft,L+=A.offsetTop,A=A.offsetParent;I-=N,B-=L}}}ws&&!Nd&&E&&!w&&W&&(m==="relative"||m==="static")&&(I-=V.offsetLeft,B-=V.offsetTop,o=o||j);var $=0,U=0,Q=0,at=0;if(_)E&&S.hasTransform&&(Q=V.clientLeft,at=V.clientTop);else if(E&&v!==V&&($=V.clientLeft,U=V.clientTop),E&&V===i){var J=Ns(n,!1,g);I+=J[0],B+=J[1]}if(a.push({type:"target",target:n,matrix:mn(x,u,T)}),E){var tt=n===e,lt=tt?0:n.scrollLeft,ut=tt?0:n.scrollTop;a.push({type:"offset",target:n,matrix:Mr([I-lt+$-Q,B-ut+U-at],u)})}else a.push({type:"offset",target:n,origin:T});if(X!==1&&a.push({type:"zoom",target:n,matrix:mn(ii([X,X],u),u,[0,0])}),f||(f=x),c||(c=T),d||(d=D),s||_)break;n=V,o=j,(!r||n===i)&&(s=o)}return f||(f=wt(u)),c||(c=[0,0]),d||(d=[0,0]),{zoom:h,offsetContainer:v,matrixes:a,targetMatrix:f,transformOrigin:c,targetOrigin:d,is3d:l,hasFixed:p}}function Xv(e,t,r,n){var a;r===void 0&&(r=t);var i=To(e,t),o=i.matrixes,s=i.is3d,l=i.targetMatrix,u=i.transformOrigin,c=i.targetOrigin,d=i.offsetContainer,f=i.hasFixed,p=i.zoom,v=To(d,r,!0),h=v.matrixes,g=v.is3d,m=v.offsetContainer,b=v.zoom,x=n,_=4,S=e.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in e,y=l,C=wt(_),M=wt(_),E=wt(_),w=wt(_),T=o.length;h.reverse(),o.reverse(),!s&&x&&(y=be(y,3,4),Pa(o)),!g&&x&&Pa(h),h.forEach(function(W){M=_t(M,W.matrix,_)});var D=r||document.body,R=((a=h[0])===null||a===void 0?void 0:a.target)||kr(D,D,!0).offsetParent,I=h.slice(1).reduce(function(W,X){return _t(W,X.matrix,_)},wt(_));o.forEach(function(W,X){if(T-2===X&&(E=C.slice()),T-1===X&&(w=C.slice()),!W.matrix){var z=o[X+1],Y=fp(W,z,R,_,_t(I,C,_));W.matrix=Mr(Y,_)}C=_t(C,W.matrix,_)});var B=!S&&s;y||(y=wt(B?4:3));var V=Fn(S&&y.length===16?be(y,4,3):y,B),j=M;return M=vs(M,_,_),{hasZoom:p!==1||b!==1,hasFixed:f,rootMatrix:M,originalRootMatrix:j,beforeMatrix:E,offsetMatrix:w,allMatrix:C,targetMatrix:y,targetTransform:V,transformOrigin:u,targetOrigin:c,is3d:x,offsetContainer:d,offsetRootContainer:m}}function Hv(e,t,r,n){r===void 0&&(r=t);var a=0,i=0,o=0,s={},l=Vs(e);if(e&&(a=l.offsetWidth,i=l.offsetHeight),e){var u=Xv(e,t,r,n),c=rr(u.allMatrix,u.transformOrigin,a,i);s=k(k({},u),c);var d=rr(u.allMatrix,[50,50],100,100);o=Ws([d.pos1,d.pos2],d.direction)}var f=4;return k(k(k({hasZoom:!1,width:a,height:i,rotation:o},l),{originalRootMatrix:wt(f),rootMatrix:wt(f),beforeMatrix:wt(f),offsetMatrix:wt(f),allMatrix:wt(f),targetMatrix:wt(f),targetTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!n,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null}),s)}function $a(e,t,r,n,a,i){i===void 0&&(i=[]);var o=1,s=[0,0],l=en(),u=en(),c=en(),d=en(),f=[0,0],p={},v=Hv(t,r,a,!0);if(t){var h=getComputedStyle(t);i.forEach(function(D){p[D]=h[D]});var g=v.is3d?4:3,m=rr(v.offsetMatrix,ft(v.transformOrigin,hs(v.targetMatrix,g)),v.width,v.height);o=m.direction,s=ft(m.origin,[m.left-v.left,m.top-v.top]),d=xr(v.offsetRootContainer);var b=kr(n,n,!0).offsetParent||v.offsetRootContainer;if(v.hasZoom){var x=rr(_t(v.originalRootMatrix,v.allMatrix),v.transformOrigin,v.width,v.height),_=rr(v.originalRootMatrix,bn(getComputedStyle(b)).map(function(D){return parseFloat(D)}),b.offsetWidth,b.offsetHeight);if(l=aa(x,d),c=aa(_,d,b,!0),e){var S=x.left,y=x.top;u=aa({left:S,top:y,bottom:y,right:y},d)}}else{l=xr(t),c=xr(b,!0),e&&(u=xr(e));var C=c.left,M=c.top,E=c.clientLeft,w=c.clientTop,T=[l.left-C,l.top-M];f=et(Xe(v.rootMatrix,T,4),[E+v.left,w+v.top])}}return k({targetClientRect:l,containerClientRect:c,moveableClientRect:u,rootContainerClientRect:d,beforeDirection:o,beforeOrigin:s,originalBeforeOrigin:s,target:t,style:p,offsetDelta:f},v)}function Ro(e){var t=e.pos1,r=e.pos2,n=e.pos3,a=e.pos4;if(!t||!r||!n||!a)return null;var i=Oe([t,r,n,a]),o=[i.minX,i.minY],s=et(e.origin,o);return t=et(t,o),r=et(r,o),n=et(n,o),a=et(a,o),k(k({},e),{left:e.left,top:e.top,posDelta:o,pos1:t,pos2:r,pos3:n,pos4:a,origin:s,beforeOrigin:s,isPersisted:!0})}var or=function(e){$r(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.state=k({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},$a(null)),n.renderState={},n.enabledAbles=[],n.targetAbles=[],n.controlAbles=[],n.rotation=0,n.scale=[1,1],n.isMoveableMounted=!1,n.isUnmounted=!1,n.events={mouseEnter:null,mouseLeave:null},n._emitter=new Bn,n._prevTarget=null,n._prevDragArea=!1,n._isPropTargetChanged=!1,n._hasFirstTarget=!1,n._observer=null,n._observerId=0,n._rootContainer=null,n._viewContainer=null,n._viewClassNames=[],n.checkUpdateRect=function(){if(!n.isDragging()){var a=n.props.parentMoveable;if(a){a.checkUpdateRect();return}Df(n._observerId),n._observerId=Qo(function(){n.isDragging()||n.updateRect()})}},n._onPreventClick=function(a){a.stopPropagation(),a.preventDefault()},n}var r=t.prototype;return r.render=function(){var n=this.props,a=this.getState(),i=n.parentPosition,o=n.className,s=n.target,l=n.zoom,u=n.cspNonce,c=n.translateZ,d=n.cssStyled,f=n.portalContainer,p=n.groupable,v=n.linePadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var h=i||[0,0],g=h[0],m=h[1],b=a.left,x=a.top,_=a.target,S=a.direction,y=a.hasFixed,C=a.offsetDelta,M=n.targets,E=this.isDragging(),w={};this.getEnabledAbles().forEach(function(V){w["data-able-".concat(V.name.toLowerCase())]=!0});var T=this._getAbleClassName(),D=M&&M.length&&(_||p)||s||!this._hasFirstTarget&&this.state.isPersisted,R=this.controlBox||this.props.firstRenderState||this.props.persistData,I=[b-g,x-m];!p&&n.useAccuratePosition&&(I[0]+=C[0],I[1]+=C[1]);var B={position:y?"fixed":"absolute",display:D?"block":"none",visibility:R?"visible":"hidden",transform:"translate3d(".concat(I[0],"px, ").concat(I[1],"px, ").concat(c,")"),"--zoom":l,"--zoompx":"".concat(l,"px")};return v&&(B["--moveable-line-padding"]=v),se(d,k({cspNonce:u,ref:ge(this,"controlBox"),className:"".concat(rt("control-box",S===-1?"reverse":"",E?"dragging":"")," ").concat(T," ").concat(o)},w,{onClick:this._onPreventClick,portalContainer:f,style:B}),this.renderAbles(),this._renderLines())},r.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1,this.controlBox.getElement();var n=this.props,a=n.parentMoveable,i=n.container,o=n.wrapperMoveable;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!a&&!o&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},r.componentDidUpdate=function(n){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateEvents(),this._updateTargets(),this.updateCheckInput(),this._updateObserver(n)},r.componentWillUnmount=function(){this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off();var n=this._viewContainer;n&&this._changeAbleViewClassNames([]),er(this,"targetGesto"),er(this,"controlGesto");var a=this.events;for(var i in a){var o=a[i];o&&o.destroy()}},r.getTargets=function(){var n=this.props.target;return n?[n]:[]},r.getAble=function(n){var a=this.props.ables||[];return Ce(a,function(i){return i.name===n})},r.getContainer=function(){var n=this.props,a=n.parentMoveable,i=n.wrapperMoveable,o=n.container;return o||i&&i.getContainer()||a&&a.getContainer()||this.controlBox.getElement().parentElement},r.isMoveableElement=function(n){var a;return n&&(((a=n.getAttribute)===null||a===void 0?void 0:a.call(n,"class"))||"").indexOf(ui)>-1},r.dragStart=function(n){var a=this.targetGesto,i=this.controlGesto;return a&&Na(this)({inputEvent:n})?a.isFlag()||a.triggerDragStart(n):i&&this.isMoveableElement(n.target)&&(i.isFlag()||i.triggerDragStart(n)),this},r.hitTest=function(n){var a=this.state,i=a.target,o=a.pos1,s=a.pos2,l=a.pos3,u=a.pos4,c=a.targetClientRect;if(!i)return 0;var d;if(n instanceof Element){var f=n.getBoundingClientRect();d={left:f.left,top:f.top,width:f.width,height:f.height}}else d=k({width:0,height:0},n);var p=d.left,v=d.top,h=d.width,g=d.height,m=to([o,s,u,l],c),b=hd(m,[[p,v],[p+h,v],[p+h,v+g],[p,v+g]]),x=xs(m);return!b||!x?0:Math.min(100,b/x*100)},r.isInside=function(n,a){var i=this.state,o=i.target,s=i.pos1,l=i.pos2,u=i.pos3,c=i.pos4,d=i.targetClientRect;return o?ya([n,a],to([s,l,c,u],d)):!1},r.updateRect=function(n,a,i){i===void 0&&(i=!0);var o=this.props,s=o.parentMoveable,l=this.state,u=l.target||this.props.target,c=this.getContainer(),d=s?s._rootContainer:this._rootContainer,f=$a(this.controlBox&&this.controlBox.getElement(),u,c,c,d||c,this._getRequestStyles());if(!u&&this._hasFirstTarget&&o.persistData){var p=Ro(o.persistData);for(var v in p)f[v]=p[v]}this.updateState(f,s?!1:i)},r.isDragging=function(n){var a,i,o=this.targetGesto,s=this.controlGesto;if(o!=null&&o.isFlag()){if(!n)return!0;var l=o.getEventData();return!!(!((a=l[n])===null||a===void 0)&&a.isEventStart)}if(s!=null&&s.isFlag()){if(!n)return!0;var l=s.getEventData();return!!(!((i=l[n])===null||i===void 0)&&i.isEventStart)}return!1},r.updateTarget=function(n){this.updateRect(n,!0)},r.getRect=function(){var n=this.state,a=Qt(this.state),i=a[0],o=a[1],s=a[2],l=a[3],u=le(a),c=n.width,d=n.height,f=u.width,p=u.height,v=u.left,h=u.top,g=[n.left,n.top],m=ft(g,n.origin),b=ft(g,n.beforeOrigin),x=n.transformOrigin;return{width:f,height:p,left:v,top:h,pos1:i,pos2:o,pos3:s,pos4:l,offsetWidth:c,offsetHeight:d,beforeOrigin:b,origin:m,transformOrigin:x,rotation:this.getRotation()}},r.getManager=function(){return this},r.stopDrag=function(n){var a,i;(!n||n==="target")&&((a=this.targetGesto)===null||a===void 0||a.stop()),(!n||n==="control")&&((i=this.controlGesto)===null||i===void 0||i.stop())},r.getRotation=function(){var n=this.state,a=n.pos1,i=n.pos2,o=n.direction;return _p(a,i,o)},r.request=function(n,a,i){a===void 0&&(a={});var o=this.props,s=o.ables,l=o.groupable,u=s.filter(function(g){return g.name===n})[0];if(this.isDragging()||!u||!u.request)return{request:function(){return this},requestEnd:function(){return this}};var c=this,d=u.request(this),f=i||a.isInstant,p=d.isControl?"controlAbles":"targetAbles",v="".concat(l?"Group":"").concat(d.isControl?"Control":""),h={request:function(g){return Cr(c,p,"drag",v,"",k(k({},d.request(g)),{requestAble:n,isRequest:!0}),f),this},requestEnd:function(){return Cr(c,p,"drag",v,"End",k(k({},d.requestEnd()),{requestAble:n,isRequest:!0}),f),this}};return Cr(c,p,"drag",v,"Start",k(k({},d.requestStart(a)),{requestAble:n,isRequest:!0}),f),f?h.request(a).requestEnd():h},r.destroy=function(){this.componentWillUnmount()},r.updateRenderPoses=function(){var n=this.getState(),a=this.props,i=n.originalBeforeOrigin,o=n.transformOrigin,s=n.allMatrix,l=n.is3d,u=n.pos1,c=n.pos2,d=n.pos3,f=n.pos4,p=n.left,v=n.top,h=n.isPersisted,g=a.padding||{},m=g.left,b=m===void 0?0:m,x=g.top,_=x===void 0?0:x,S=g.bottom,y=S===void 0?0:S,C=g.right,M=C===void 0?0:C,E=l?4:3,w=[];h?w=o:this.controlBox&&a.groupable?w=i:w=ft(i,[p,v]),n.renderPoses=[ft(u,nn(s,[-b,-_],o,w,E)),ft(c,nn(s,[M,-_],o,w,E)),ft(d,nn(s,[-b,y],o,w,E)),ft(f,nn(s,[M,y],o,w,E))]},r.checkUpdate=function(){this._isPropTargetChanged=!1;var n=this.props,a=n.target,i=n.container,o=n.parentMoveable,s=this.state,l=s.target,u=s.container;if(!(!l&&!a)){this.updateAbles();var c=!Oa(l,a),d=c||!Oa(u,i);if(d){var f=i||this.controlBox;f&&this.unsetAbles(),this.updateState({target:a,container:i}),!o&&f&&this.updateRect("End",!1,!1),this._isPropTargetChanged=c}}},r.waitToChangeTarget=function(){return new Promise(function(){})},r.triggerEvent=function(n,a){this._emitter.trigger(n,a);var i=this.props[n];return i&&i(a)},r.useCSS=function(n,a){var i=this.props.customStyledMap,o=n+a;return i[o]||(i[o]=Cs(n,a)),i[o]},r.getState=function(){var n,a=this.props;(a.target||!((n=a.targets)===null||n===void 0)&&n.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,o=a.persistData,s=a.firstRenderState;if(s&&!i)return s;if(!this._hasFirstTarget&&o){var l=Ro(o);if(l)return this.updateState(l,!1),this.state}return this.state.isPersisted=!1,this.state},r.updateSelectors=function(){},r.unsetAbles=function(){var n=this;this.targetAbles.forEach(function(a){a.unset&&a.unset(n)})},r.updateAbles=function(n,a){n===void 0&&(n=this.props.ables),a===void 0&&(a="");var i=this.props,o=i.triggerAblesSimultaneously,s=this.getEnabledAbles(n),l="drag".concat(a,"Start"),u="pinch".concat(a,"Start"),c="drag".concat(a,"ControlStart"),d=rn(s,[l,u],o),f=rn(s,[c],o);this.enabledAbles=s,this.targetAbles=d,this.controlAbles=f},r.updateState=function(n,a){if(a){if(this.isUnmounted)return;this.setState(n)}else{var i=this.state;for(var o in n)i[o]=n[o]}},r.getEnabledAbles=function(n){n===void 0&&(n=this.props.ables);var a=this.props;return n.filter(function(i){return i&&(i.always&&a[i.name]!==!1||a[i.name])})},r.renderAbles=function(){var n=this,a=this.props,i=a.triggerAblesSimultaneously,o={createElement:se};return this.renderState={},hp(qs(rn(this.getEnabledAbles(),["render"],i).map(function(s){var l=s.render;return l(n,o)||[]})).filter(function(s){return s}),function(s){var l=s.key;return l}).map(function(s){return s[0]})},r.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},r._getRequestStyles=function(){var n=this.getEnabledAbles().reduce(function(a,i){var o,s,l=(s=(o=i.requestStyle)===null||o===void 0?void 0:o.call(i))!==null&&s!==void 0?s:[];return nt(nt([],a,!0),l,!0)},[]);return n},r._updateObserver=function(n){var a,i=this.props,o=i.target;if(!window.ResizeObserver||!o||!i.useResizeObserver){(a=this._observer)===null||a===void 0||a.disconnect();return}if(!(n.target===o&&this._observer)){var s=new ResizeObserver(this.checkUpdateRect);s.observe(o,{box:"border-box"}),this._observer=s}},r._updateEvents=function(){var n=this.controlBox.getElement(),a=this.targetAbles.length,i=this.controlAbles.length,o=this.props,s=o.dragTarget||o.target,l=!a&&this.targetGesto||this._isTargetChanged(!0);l&&(er(this,"targetGesto"),this.updateState({gesto:null})),i||er(this,"controlGesto"),s&&a&&!this.targetGesto&&(this.targetGesto=Sl(this,s,"")),!this.controlGesto&&i&&(this.controlGesto=Mi(this,n,"controlAbles","Control"))},r._updateTargets=function(){var n=this.props;this._prevTarget=n.dragTarget||n.target,this._prevDragArea=n.dragArea},r._renderLines=function(){var n=this.props,a=n,i=a.zoom,o=a.hideDefaultLines,s=a.hideChildMoveableDefaultLines,l=a.parentMoveable;if(o||l&&s)return[];var u=this.getState().renderPoses,c={createElement:se};return[[0,1],[1,3],[3,2],[2,0]].map(function(d,f){var p=d[0],v=d[1];return Tr(c,"",u[p],u[v],i,"render-line-".concat(f))})},r._isTargetChanged=function(n){var a=this.props,i=a.dragTarget||a.target,o=this._prevTarget,s=this._prevDragArea,l=a.dragArea,u=!l&&o!==i,c=(n||l)&&s!==l;return u||c},r._updateNativeEvents=function(){var n=this,a=this.props,i=a.dragArea?this.areaElement:this.state.target,o=this.events,s=pr(o);if(this._isTargetChanged())for(var l in o){var u=o[l];u&&u.destroy(),o[l]=null}if(i){var c=this.enabledAbles;s.forEach(function(d){var f=rn(c,[d]),p=f.length>0,v=o[d];if(!p){v&&(v.destroy(),o[d]=null);return}v||(v=new Vv(i,n,d),o[d]=v),v.setAbles(f)})}},r._checkUpdateRootContainer=function(){var n=this.props.rootContainer;!this._rootContainer&&n&&(this._rootContainer=je(n,!0))},r._checkUpdateViewContainer=function(){var n=this.props.viewContainer;!this._viewContainer&&n&&(this._viewContainer=je(n,!0));var a=this._viewContainer;a&&this._changeAbleViewClassNames(nt(nt([],this._getAbleViewClassNames(),!0),[this.isDragging()?_v:""],!1))},r._changeAbleViewClassNames=function(n){var a=this._viewContainer,i=Us(n.filter(Boolean),function(c){return c}).map(function(c){var d=c[0];return d}),o=this._viewClassNames,s=zr(o,i),l=s.removed,u=s.added;l.forEach(function(c){es(a,o[c])}),u.forEach(function(c){ts(a,i[c])}),this._viewClassNames=i},r._getAbleViewClassNames=function(){var n=this;return(this.getEnabledAbles().map(function(a){var i;return((i=a.viewClassName)===null||i===void 0?void 0:i.call(a,n))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},r._getAbleClassName=function(n){var a=this;n===void 0&&(n="");var i=this.getEnabledAbles(),o=this.targetGesto,s=this.controlGesto,l=o!=null&&o.isFlag()?o.getEventData():{},u=s!=null&&s.isFlag()?s.getEventData():{};return i.map(function(c){var d,f,p,v=c.name,h=((d=c.className)===null||d===void 0?void 0:d.call(c,a))||"";return(!((f=l[v])===null||f===void 0)&&f.isEventStart||!((p=u[v])===null||p===void 0)&&p.isEventStart)&&(h+=" ".concat(rt("".concat(v).concat(n,"-dragging")))),h.trim()}).filter(Boolean).join(" ")},t.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,portalContainer:null,useResizeObserver:!1,linePadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Gs,firstRenderState:null,persistData:null,viewContainer:null,useAccuratePosition:!1},t}(ri),ki={name:"groupable",props:{defaultGroupRotate:Number,defaultGroupOrigin:String,groupable:Boolean,groupableProps:Object,targetGroups:Object,hideChildMoveableDefaultLines:Boolean},events:{},render:function(e,t){var r,n=e.props,a=n.targets||[];e.moveables=[];var i=e.getState(),o=i.left,s=i.top,l=i.isPersisted,u=[o,s],c=n.zoom||1,d=e.renderGroupRects,f=((r=n.persistData)===null||r===void 0?void 0:r.children)||[];return l?a=f.map(function(){return null}):f=[],nt(nt([],a.map(function(p,v){return t.createElement(or,{key:"moveable"+v,ref:qo(e,"moveables",v),target:p,origin:!1,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:e,parentPosition:u,persistData:f[v],zoom:c})}),!0),qs(d.map(function(p,v){var h=p.pos1,g=p.pos2,m=p.pos3,b=p.pos4,x=[h,g,m,b];return[[0,1],[1,3],[3,2],[2,0]].map(function(_,S){var y=_[0],C=_[1];return Tr(t,"",et(x[y],u),et(x[C],u),c,"group-rect-".concat(v,"-").concat(S))})})),!0)}},Yv=Vr("clickable",{props:{clickable:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(e,t){t.datas.inputTarget=t.inputEvent&&t.inputEvent.target},dragEnd:function(e,t){var r=e.props.target,n=t.inputEvent,a=t.inputTarget,i=e.isMoveableElement(a),o=!i&&e.controlBox.getElement().contains(a);if(!(!n||!a||t.isDrag||e.isMoveableElement(a)||o)){var s=r.contains(a);Z(e,"onClick",ot(e,t,{isDouble:t.isDouble,inputTarget:a,isTarget:r===a,moveableTarget:e.props.target,containsTarget:s}))}},dragGroupEnd:function(e,t){var r=t.inputEvent,n=t.inputTarget;if(!(!r||!n||t.isDrag||e.isMoveableElement(n)||t.datas.inputTarget===n)){var a=e.props.targets,i=a.indexOf(n),o=i>-1,s=!1;i===-1&&(i=Se(a,function(l){return l.contains(n)}),s=i>-1),Z(e,"onClickGroup",ot(e,t,{isDouble:t.isDouble,targets:a,inputTarget:n,targetIndex:i,isTarget:o,containsTarget:s,moveableTarget:a[i]}))}},dragControlEnd:function(e,t){this.dragEnd(e,t)},dragGroupControlEnd:function(e,t){this.dragEnd(e,t)}});function Ze(e){var t=e.originalDatas.draggable;return t||(e.originalDatas.draggable={},t=e.originalDatas.draggable),k(k({},e),{datas:t})}var jv=Vr("edgeDraggable",{css:[`.edge.edgeDraggable.line {
    cursor: move;
}`],render:function(e,t){var r=e.props,n=r.edgeDraggable;return n?cl(t,"edgeDraggable",n,e.getState().renderPoses,r.zoom):[]},dragCondition:function(e,t){var r,n=e.props,a=(r=t.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!a?!1:!n.draggable&&At(a,rt("direction"))&&At(a,rt("edge"))&&At(a,rt("edgeDraggable"))},dragStart:function(e,t){return Yt.dragStart(e,Ze(t))},drag:function(e,t){return Yt.drag(e,Ze(t))},dragEnd:function(e,t){return Yt.dragEnd(e,Ze(t))},dragGroupCondition:function(e,t){var r,n=e.props,a=(r=t.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!a?!1:!n.draggable&&At(a,rt("direction"))&&At(a,rt("line"))},dragGroupStart:function(e,t){return Yt.dragGroupStart(e,Ze(t))},dragGroup:function(e,t){return Yt.dragGroup(e,Ze(t))},dragGroupEnd:function(e,t){return Yt.dragGroupEnd(e,Ze(t))},unset:function(e){return Yt.unset(e)}}),Cl={name:"individualGroupable",props:{individualGroupable:Boolean},events:{}},Ti=[_l,gl,cv,Cp,Yt,jv,Ga,gv,bv,hv,Cv,wv,yv,Av,zv,Nv,ki,Cl,Yv,hl,yl],Uv=Ti.reduce(function(e,t){return k(k({},e),"events"in t?t.events:{})},{}),qv=Ti.reduce(function(e,t){return k(k({},e),t.props)},{}),Kv=mp(Uv),Zv=Object.keys(Kv),Jv=Object.keys(qv);function Io(e,t){var r=e[0],n=e[1],a=e[2];return(r*t[0]+n*t[1]+a)/Math.sqrt(r*r+n*n)}function ln(e,t){var r=e[0],n=e[1];return-r*t[0]-n*t[1]}function Po(e,t){return Math.max.apply(Math,e.map(function(r){var n=r[0],a=r[1],i=r[2],o=r[3];return Math.max(n[t],a[t],i[t],o[t])}))}function Oo(e,t){return Math.min.apply(Math,e.map(function(r){var n=r[0],a=r[1],i=r[2],o=r[3];return Math.min(n[t],a[t],i[t],o[t])}))}function Qv(e,t){var r,n=[0,0],a=[0,0],i=[0,0],o=[0,0],s=0,l=0;if(!e.length)return{pos1:n,pos2:a,pos3:i,pos4:o,minX:0,minY:0,maxX:0,maxY:0,width:s,height:l,rotation:t};var u=it(t,qt);if(u%90){var c=u/180*Math.PI,d=Math.tan(c),f=-1/d,p=[Ra,ao],v=[[0,0],[0,0]],h=[Ra,ao],g=[[0,0],[0,0]];e.forEach(function(X){X.forEach(function(z){var Y=Io([-d,1,0],z),G=Io([-f,1,0],z);p[0]>Y&&(v[0]=z,p[0]=Y),p[1]<Y&&(v[1]=z,p[1]=Y),h[0]>G&&(g[0]=z,h[0]=G),h[1]<G&&(g[1]=z,h[1]=G)})});var m=v[0],b=v[1],x=g[0],_=g[1],S=[-d,1,ln([-d,1],m)],y=[-d,1,ln([-d,1],b)],C=[-f,1,ln([-f,1],x)],M=[-f,1,ln([-f,1],_)];r=[[S,C],[S,M],[y,C],[y,M]].map(function(X){var z=X[0],Y=X[1];return li(z,Y)[0]}),n=r[0],a=r[1],i=r[2],o=r[3],s=h[1]-h[0],l=p[1]-p[0]}else{var E=Oo(e,0),w=Oo(e,1),T=Po(e,0),D=Po(e,1);if(n=[E,w],a=[T,w],i=[E,D],o=[T,D],s=T-E,l=D-w,u%180){var R=[i,n,o,a];n=R[0],a=R[1],i=R[2],o=R[3],s=D-w,l=T-E}}if(u%360>180){var R=[o,i,a,n];n=R[0],a=R[1],i=R[2],o=R[3]}var I=Oe([n,a,i,o]),B=I.minX,V=I.minY,j=I.maxX,W=I.maxY;return{pos1:n,pos2:a,pos3:i,pos4:o,width:s,height:l,minX:B,minY:V,maxX:j,maxY:W,rotation:t}}function wl(e,t){var r=t.map(function(n){if(Ot(n)){var a=wl(e,n),i=a.length;return i>1?a:i===1?a[0]:null}else{var o=Ce(e,function(s){var l=s.manager;return l.props.target===n});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return r.length===1&&Ot(r[0])?r[0]:r}var th=function(e){$r(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.differ=new bs,n.moveables=[],n.transformOrigin="50% 50%",n.renderGroupRects=[],n._targetGroups=[],n._hasFirstTargets=!1,n}var r=t.prototype;return r.componentDidMount=function(){e.prototype.componentDidMount.call(this)},r.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},r.getTargets=function(){return this.props.targets},r.updateRect=function(n,a,i){var o;i===void 0&&(i=!0);var s=this.state;if(!this.controlBox||s.isPersisted)return;this.moveables.forEach(function(Q){Q.updateRect(n,!1,!1)});var l=this.props,u=this.moveables,c=s.target||l.target,d=u.map(function(Q){return{finded:!1,manager:Q}}),f=this.props.targetGroups||[],p=wl(d,f);p.push.apply(p,d.filter(function(Q){var at=Q.finded;return!at}).map(function(Q){var at=Q.manager;return at}));var v=[],h=!a||n!==""&&l.updateGroup,g=l.defaultGroupRotate||0;if(!this._hasFirstTargets){var m=(o=this.props.persistData)===null||o===void 0?void 0:o.rotation;m!=null&&(g=m)}function b(Q,at,J){var tt=Q.map(function(ct){if(Ot(ct)){var ht=b(ct,at),gt=[ht.pos1,ht.pos2,ht.pos3,ht.pos4];return v.push(ht),{poses:gt,rotation:ht.rotation}}else return{poses:Qt(ct.state),rotation:ct.getRotation()}}),lt=tt.map(function(ct){var ht=ct.rotation;return ht}),ut=0,Tt=lt[0],bt=lt.every(function(ct){return Math.abs(Tt-ct)<.1});h?ut=bt?Tt:g:ut=!J&&bt?Tt:at;var vt=tt.map(function(ct){var ht=ct.poses;return ht}),Ct=Qv(vt,ut);return Ct}var x=b(p,this.rotation,!0);h&&(this.rotation=x.rotation,this.transformOrigin=l.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=f,this.renderGroupRects=v;var _=this.transformOrigin,S=this.rotation,y=this.scale,C=x.width,M=x.height,E=x.minX,w=x.minY,T=Sp([[0,0],[C,0],[0,M],[C,M]],yp(_,C,M),this.rotation/180*Math.PI),D=Oe(T.result),R=D.minX,I=D.minY,B=" rotate(".concat(S,"deg)")+" scale(".concat(y[0]>=0?1:-1,", ").concat(y[1]>=0?1:-1,")"),V="translate(".concat(-R,"px, ").concat(-I,"px)").concat(B);this.controlBox.getElement().style.transform="translate3d(".concat(E,"px, ").concat(w,"px, ").concat(this.props.translateZ||0,")"),c.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(_,";")+"width:".concat(C,"px;height:").concat(M,"px;")+"transform: ".concat(V),s.width=C,s.height=M;var j=this.getContainer(),W=$a(this.controlBox.getElement(),c,this.controlBox.getElement(),this.getContainer(),this._rootContainer||j,[]),X=[W.left,W.top],z=Qt(W),Y=z[0],G=z[1],A=z[2],N=z[3],L=Oe([Y,G,A,N]),$=[L.minX,L.minY],U=y[0]*y[1]>0?1:-1;W.pos1=et(Y,$),W.pos2=et(G,$),W.pos3=et(A,$),W.pos4=et(N,$),W.left=E-W.left+$[0],W.top=w-W.top+$[1],W.origin=et(ft(X,W.origin),$),W.beforeOrigin=et(ft(X,W.beforeOrigin),$),W.originalBeforeOrigin=ft(X,W.originalBeforeOrigin),W.transformOrigin=et(ft(X,W.transformOrigin),$),c.style.transform="translate(".concat(-R-$[0],"px, ").concat(-I-$[1],"px)")+B,this.updateState(k(k({},W),{posDelta:$,direction:U,beforeDirection:U}),i)},r.getRect=function(){return k(k({},e.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},r.triggerEvent=function(n,a,i){if(i||n.indexOf("Group")>-1)return e.prototype.triggerEvent.call(this,n,a);this._emitter.trigger(n,a)},r.updateAbles=function(){e.prototype.updateAbles.call(this,nt(nt([],this.props.ables,!0),[ki],!1),"Group")},r._updateTargets=function(){e.prototype._updateTargets.call(this),this._prevTarget=this.props.dragTarget||this.areaElement},r._updateEvents=function(){var n=this.state,a=this.props,i=this._prevTarget,o=a.dragTarget||this.areaElement;i!==o&&(er(this,"targetGesto"),er(this,"controlGesto"),n.target=null),n.target||(n.target=this.areaElement,this.controlBox.getElement().style.display="block"),n.target&&(this.targetGesto||(this.targetGesto=Sl(this,o,"Group")),this.controlGesto||(this.controlGesto=Mi(this,this.controlBox.getElement(),"controlAbles","GroupControl")));var s=!Oa(n.container,a.container);s&&(n.container=a.container);var l=a.targets,u=this.differ.update(l),c=u.added,d=u.changed,f=u.removed,p=c.length||f.length;(s||p||this.transformOrigin!==(a.defaultGroupOrigin||"50% 50%")||d.length||l.length&&!Js(this._targetGroups,a.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},r._updateObserver=function(){},t.defaultProps=k(k({},or.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),t}(or),eh=function(e){$r(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.moveables=[],n}var r=t.prototype;return r.render=function(){var n=this,a,i=this.props,o=i.cspNonce,s=i.cssStyled,l=i.persistData,u=i.targets||[],c=u.length,d=this.isUnmounted||!c,f=(a=l==null?void 0:l.children)!==null&&a!==void 0?a:[];return d&&!c&&f.length?u=f.map(function(){return null}):d||(f=[]),se(s,{cspNonce:o,ref:ge(this,"controlBox"),className:rt("control-box")},u.map(function(p,v){return se(or,k({key:"moveable"+v,ref:qo(n,"moveables",v)},n.props,{target:p,wrapperMoveable:n,isWrapperMounted:n.isMoveableMounted,persistData:f[v]}))}))},r.componentDidUpdate=function(){},r.getTargets=function(){return this.props.targets},r.updateRect=function(n,a,i){i===void 0&&(i=!0),this.moveables.forEach(function(o){o.updateRect(n,a,i)})},r.getRect=function(){return k(k({},e.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},r.request=function(){return{request:function(){return this},requestEnd:function(){return this}}},r.dragStart=function(){return this},r.hitTest=function(){return 0},r.isInside=function(){return!1},r.isDragging=function(){return!1},r.updateRenderPoses=function(){},r.checkUpdate=function(){},r.triggerEvent=function(){},r.updateAbles=function(){},r._updateEvents=function(){},r._updateObserver=function(){},t}(or);function El(e,t){var r=[];return e.forEach(function(n){if(n){if(ne(n)){t[n]&&r.push.apply(r,t[n]);return}Ot(n)?r.push.apply(r,El(n,t)):r.push(n)}}),r}function Dl(e,t){var r=[];return e.forEach(function(n){if(n){if(ne(n)){t[n]&&r.push.apply(r,t[n]);return}Ot(n)?r.push(Dl(n,t)):r.push(n)}}),r}function Ml(e,t){return e.length!==t.length||e.some(function(r,n){var a=t[n];return!r&&!a?!1:r!=a?Ot(r)&&Ot(a)?Ml(r,a):!0:!1})}var rh=function(e){$r(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.refTargets=[],n.selectorMap={},n._differ=new bs,n._elementTargets=[],n._onChangeTargets=null,n}var r=t.prototype;return t.makeStyled=function(){var n={},a=this.getTotalAbles();a.forEach(function(o){var s=o.css;s&&s.forEach(function(l){n[l]=!0})});var i=pr(n).join(`
`);this.defaultStyled=Cs("div",sf(ui,$d+i))},t.getTotalAbles=function(){return nt([gl,ki,Cl,hl],this.defaultAbles,!0)},r.render=function(){var n,a=this.constructor;a.defaultStyled||a.makeStyled();var i=this.props,o=i.ables,s=i.props,l=zd(i,["ables","props"]),u=this._updateRefs(!0),c=El(u,this.selectorMap),d=c.length>1,f=a.getTotalAbles(),p=nt(nt([],f,!0),o||[],!0),v=k(k(k({},l),s||{}),{ables:p,cssStyled:a.defaultStyled,customStyledMap:a.customStyledMap});this._elementTargets=c;var h=null,g=this.moveable,m=l.persistData;if(m!=null&&m.children&&(d=!0),d){if(l.individualGroupable)return se(eh,k({key:"individual-group",ref:ge(this,"moveable")},v,{target:null,targets:c}));var b=Dl(u,this.selectorMap);if(g&&!g.props.groupable&&!g.props.individualGroupable){var x=g.props.target;x&&c.indexOf(x)>-1&&(h=k({},g.state))}return se(th,k({key:"group",ref:ge(this,"moveable")},v,(n=l.groupableProps)!==null&&n!==void 0?n:{},{target:null,targets:c,targetGroups:b,firstRenderState:h}))}else{var _=c[0];if(g&&(g.props.groupable||g.props.individualGroupable)){var S=g.moveables||[],y=Ce(S,function(C){return C.props.target===_});y&&(h=k({},y.state))}return se(or,k({key:"single",ref:ge(this,"moveable")},v,{target:_,firstRenderState:h}))}},r.componentDidMount=function(){this._checkChangeTargets(),this._updateRefs()},r.componentDidUpdate=function(){this._checkChangeTargets()},r.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},r.getTargets=function(){var n,a;return(a=(n=this.moveable)===null||n===void 0?void 0:n.getTargets())!==null&&a!==void 0?a:[]},r.updateSelectors=function(){this.selectorMap={},this._updateRefs()},r.waitToChangeTarget=function(){var n=this,a;return this._onChangeTargets=function(){n._onChangeTargets=null,a()},new Promise(function(i){a=i})},r.waitToChangeTargets=function(){return this.waitToChangeTarget()},r.getManager=function(){return this.moveable},r._updateRefs=function(n){var a=this.refTargets,i=bi(this.props.target||this.props.targets),o=typeof document<"u",s=Ml(a,i),l=this.selectorMap,u={};return this.refTargets.forEach(function c(d){if(ne(d)){var f=l[d];f?u[d]=l[d]:o&&(s=!0,u[d]=[].slice.call(document.querySelectorAll(d)))}else Ot(d)&&d.forEach(c)}),this.refTargets=i,this.selectorMap=u,!n&&s&&this.forceUpdate(),i},r._checkChangeTargets=function(){var n,a,i,o=this._differ.update(this._elementTargets),s=o.added,l=o.removed,u=s.length||l.length;u&&((a=(n=this.props).onChangeTargets)===null||a===void 0||a.call(n,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this)),this._updateRefs()},t.defaultAbles=[],t.customStyledMap={},t.defaultStyled=null,Ad([lf(Ms)],t.prototype,"moveable",void 0),t}(ri),nh=function(e){$r(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.defaultAbles=Ti,t}(rh),ah=nh;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Va=function(e,t){return Va=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},Va(e,t)};function Ri(e,t){Va(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Rr=function(){return Rr=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Rr.apply(this,arguments)};function ih(e,t,r,n){var a=arguments.length,i=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}var oh=function(e){Ri(t,e);function t(n){var a=e.call(this,n)||this;return a.state={},a.state=a.props,a}var r=t.prototype;return r.render=function(){return Xf(se(ah,Rr({ref:ge(this,"moveable")},this.state)),this.state.parentElement)},t}(ei),Cn=Jv,kl=Ms,Tl=Zv,sh=function(e){Ri(t,e);function t(n,a){a===void 0&&(a={});var i=e.call(this)||this;i.tempElement=document.createElement("div");var o=Rr({},a),s={};Tl.forEach(function(u){s[Ef("on ".concat(u))]=function(c){return i.trigger(u,c)}}),Ji(se(oh,Rr({ref:ge(i,"innerMoveable"),parentElement:n},o,s)),i.tempElement);var l=o.target;return Ot(l)&&l.length>1&&i.updateRect(),i}var r=t.prototype;return r.setState=function(n,a){this.innerMoveable.setState(n,a)},r.forceUpdate=function(n){this.innerMoveable.forceUpdate(n)},r.dragStart=function(n){var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(n)},r.destroy=function(){Ji(null,this.tempElement),this.off(),this.tempElement=null,this.innerMoveable=null},r.getMoveable=function(){return this.innerMoveable.moveable},t=ih([Hi(kl,function(n,a){n[a]||(n[a]=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s=this.getMoveable();if(!(!s||!s[a]))return s[a].apply(s,i)})}),Hi(Cn,function(n,a){Object.defineProperty(n,a,{get:function(){return this.getMoveable().props[a]},set:function(i){var o;this.setState((o={},o[a]=i,o))},enumerable:!0,configurable:!0})})],t),t}(Bn),lh=function(e){Ri(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(sh),wr=function(){return wr=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},wr.apply(this,arguments)},Rl={};kl.forEach(function(e){Rl[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=this.$_moveable)[e].apply(t,r)}});var Il={};Cn.forEach(function(e){Il[e]=function(t){this.$_moveable[e]=t}});var Ii=xt({name:"moveable",methods:Rl,props:Cn,watch:Il,mounted:function(){var e=this,t={},r=this.$props;Cn.forEach(function(o){var s=r[o];Ar(s)||(t[o]=r[o])});var n=this.$refs,a=n.moveableElement,i=new lh(a,wr(wr({},t),{portalContainer:a}));Tl.forEach(function(o){i.on(o,function(s){e.$emit(o,wr({},s))})}),this.$_moveable=i},beforeUnmount:function(){this.$_moveable.destroy()}});const uh={ref:"moveableElement"};function ch(e,t,r,n,a,i){return H(),K("div",uh,null,512)}Ii.render=ch;Ii.__file="src/Moveable.vue";const fh=["data-eleId","data-lineIndex","data-itemIndex","onClick","onMousedown"],dh=xt({__name:"PlayerMoveable",props:{canvasSize:{type:Object,default(){return{width:0,height:0}}}},setup(e){const t=oe(),r=Gt(),n=mt(),a=mt(),i=mt(),o=dt(()=>{if(t.playerHeight===0&&t.playerWidth===0)return[];const f=[];return r.trackList.forEach(({list:p,type:v},h)=>{if(v==="audio")return;const g=p.findIndex((b,x)=>!!(t.playStartFrame>=b.start&&t.playStartFrame<=b.end&&b.draw)),m=p[g];m&&f.unshift({lineIndex:h,itemIndex:g,id:m.id,scale:m.scale/100,x:m.centerX,y:m.centerY,w:m.width,h:m.height,left:t.playerWidth/2-m.width/2,top:t.playerHeight/2-m.height/2})}),a.value&&a.value.updateRect(),f}),s=lr({target:i,className:"cc-move",container:n.value,..._u});function l(f){console.log("🚀 ~ selectItem ~ Element Id:",f),t.isPause=!0,r.selectTrackById(f)}function u(f){let{target:p,transform:v,translate:h}=f;const{lineindex:g,itemindex:m}=p.dataset,[b,x]=h;r.trackList[g].list[m].centerX=b,r.trackList[g].list[m].centerY=x,p.style.transform=v}function c(f){let{target:p,scale:v,transform:h}=f;const{lineindex:g,itemindex:m}=p.dataset,b=Math.max(Math.round(v[0]*100),1);r.trackList[g].list[m].scale=b,p.style.transform=h}function d(f,p){f.stopPropagation(),t.isPause=!0,r.selectTrackById(p),i.value=f.currentTarget,$o(()=>{a.value.dragStart(f)})}return Jt([r.selectTrackItem,o],()=>{if(n.value&&r.selectTrackItem.line!==-1&&r.selectTrackItem.index!==-1){const f=r.trackList[r.selectTrackItem.line].list[r.selectTrackItem.index];f&&o.value.find(p=>p.id===f.id)?i.value=n.value.querySelector(`.move-target[data-eleid='${f.id}']`):i.value=null}else i.value=null},{immediate:!0,flush:"post"}),(f,p)=>(H(),K("div",{ref_key:"moveContainer",ref:n,class:"absolute left-0 right-0 top-0 bottom-0 m-auto"},[(H(!0),K(ve,null,ye(o.value,(v,h)=>(H(),K("div",{key:v.id,"data-eleId":v.id,"data-lineIndex":v.lineIndex,"data-itemIndex":v.itemIndex,style:Et({zIndex:h,top:`${v.top}px`,left:`${v.left}px`,width:`${v.w}px`,height:`${v.h}px`,transform:`translate(${v.x}px, ${v.y}px) scale(${v.scale})`}),class:"move-target absolute",onClick:No(g=>l(v.id),["stop"]),onMousedown:g=>d(g,v.id)},null,44,fh))),128)),O(P(Ii),Ha({ref_key:"moveable",ref:a},s,{onDrag:u,onScale:c}),null,16)],512))}}),ph={class:"flex items-center justify-center h-8 my-2"},vh={class:"m-auto flex items-center gap-4"},hh={class:"text-xs text-purple inline-block"},gh={class:"text-xs"},mh=xt({__name:"PlayerControl",setup(e){const t=oe(),r=Gt(),n=dt(()=>$i(t.playStartFrame)),a=dt(()=>$i(r.frameCount)),i=dt(()=>[{title:"回退1s [<-]",disable:r.frameCount===0,icon:"BackwardIcon",handler:()=>{r.frameCount!==0&&t.backward()}},{title:"播放/暂停 [Space]",disable:r.frameCount===0,icon:t.isPause?"PauseIcon":"PlayIcon",handler:()=>{r.frameCount!==0&&(t.isPause=!t.isPause)}},{title:"快进1s [->]",disable:r.frameCount===0,icon:"ForwardIcon",handler:()=>{r.frameCount!==0&&t.forward()}}]);return(o,s)=>{const l=Ee,u=Vo;return H(),K("div",ph,[F("div",vh,[F("span",hh,pt(P(n)),1),(H(!0),K(ve,null,ye(P(i),(c,d)=>(H(),Pt(u,{key:d,effect:"light",content:c.title},{default:q(()=>[O(l,{size:18,class:re(["cursor-pointer box-content",[c.disable?"cursor-not-allowed":"cursor-pointer"]]),onClick:c.handler},{default:q(()=>[(H(),Pt(ur(c.icon)))]),_:2},1032,["class","onClick"])]),_:2},1032,["content"]))),128)),F("span",gh,pt(P(a)),1)])])}}});var ie,Pl,Ol,Bl,zl,Wa;class bh{constructor(t){Ni(this,ie);this.playerStore=oe(),this.trackState=Gt(),this.canvasSize=lr({width:0,height:0}),this.playerTimer=0,this.playerContext=null,this.audioPlayAt=0,this.audioContext=new AudioContext,this.captureAudioDest=this.audioContext.createMediaStreamDestination(),this.playingAudioCache=new Set,this.player=t.player,this.playerContext=this.player.value.getContext("bitmaprenderer"),Jt([()=>this.trackState.trackList,()=>this.canvasSize,()=>this.playerStore.playStartFrame],()=>Le(this,ie,Pl).call(this),{deep:!0}),Jt(()=>this.playerStore.isPause,()=>{this.playerStore.isPause?Le(this,ie,Wa).call(this):Le(this,ie,zl).call(this)})}}ie=new WeakSet,Pl=async function(){if(this.playerStore.ingLoadingCount!==0)return;const t=[],r=[];this.playerStore.playingTracks.forEach(async n=>{n instanceof ru?r.push(n):t.unshift(n)}),t.push(...r),Le(this,ie,Ol).call(this,t),this.playerStore.isPause||Le(this,ie,Bl).call(this,r)},Ol=async function(t){const r=new OffscreenCanvas(this.playerStore.playerWidth,this.playerStore.playerHeight),n=r.getContext("2d");for(const a of t)await a.draw(n,this.playerStore.playerWidth,this.playerStore.playerHeight,this.playerStore.playStartFrame);this.playerContext&&this.playerContext.transferFromImageBitmap(r.transferToImageBitmap())},Bl=async function(t){var i;const r=[];for(const o of t){const s=await o.render(this.audioContext,this.playerStore.playStartFrame);s&&r.push(s)}const n=Math.max(this.audioContext.currentTime,this.audioPlayAt);let a=0;for(const o of r)o.start(n),o.connect(this.audioContext.destination),o.connect(this.captureAudioDest),this.playingAudioCache.add(o),o.onended=()=>{o.disconnect(),this.playingAudioCache.delete(o)},a=Math.max(a,((i=o.buffer)==null?void 0:i.duration)??0);this.audioPlayAt=n+a},zl=function(){this.playerStore.playStartFrame>=this.trackState.frameCount&&(this.playerStore.playStartFrame=0),this.audioContext.resume(),this.audioPlayAt=0,this.playerTimer=eu(()=>{this.playerStore.playStartFrame++,this.playerStore.playStartFrame>=this.trackState.frameCount&&Le(this,ie,Wa).call(this)},1e3/jt)},Wa=function(){var t;(t=this.playerTimer)==null||t.cancel(),this.audioContext.suspend();for(const r of this.playingAudioCache)r.stop(),r.disconnect();this.playingAudioCache.clear()};const xh={class:"h-full flex flex-col dark:bg-night bg-gray-100"},_h={class:"flex-1 relative overflow-hidden"},yh={key:0,class:"absolute left-0 right-0 top-0 bottom-0 z-20 flex justify-center items-center"},Sh=xt({__name:"Player",props:{containerSize:{type:Object,default(){return{width:0,height:0}}}},setup(e){const t=e,r=oe(),{playerWidth:n,playerHeight:a}=nu(r),i=Gt(),o=mt(),s=mt(),l=dt(()=>{let{width:u,height:c}=t.containerSize;return c-=70,u-=10,Math.min(u/n.value,c/a.value)});return Dn(()=>{s.value=new bh({player:o})}),(u,c)=>{const d=Ee;return H(),K("div",xh,[F("div",_h,[ue(F("canvas",{ref_key:"playerCanvas",ref:o,class:"absolute left-0 right-0 top-0 bottom-0 m-auto bg-gray-900",id:"player",style:Et({zoom:P(l),width:`${P(n)}px`,height:`${P(a)}px`})},null,4),[[cr,P(i).frameCount>0]]),P(i).frameCount===0?(H(),K("div",yh,[O(d,{size:144,class:"box-content opacity-50",style:{color:"#FDE68A"}},{default:q(()=>[O(P(au))]),_:1})])):Wt("",!0),O(dh,{style:Et({zoom:P(l),width:`${P(n)}px`,height:`${P(a)}px`})},null,8,["style"])]),O(mh)])}}}),Ch=xt({__name:"CanvasPlayer",setup(e){const t=sr(),r=oe(),n=Gt(),a=mt(),i=lr({width:0,height:0});function o(l){l.stopPropagation(),n.selectTrackItem.line=-1,n.selectTrackItem.index=-1}function s(){const{width:l,height:u}=a.value.getBoundingClientRect();i.width=l,i.height=u}return Dn(()=>{s()}),window.addEventListener("resize",s,!1),Jt(()=>[t.trackHeight,t.attrWidth],()=>{s()}),Jt([()=>r.playerHeight,()=>r.playerWidth],()=>{s()}),(l,u)=>(H(),K("div",{ref_key:"playerContent",ref:a,class:"flex-1 overflow-hidden relative",onClick:o},[O(Sh,{"container-size":i},null,8,["container-size"])],512))}}),wh={class:"px-4 w-full h-10 border-b dark:border-night-light"},Eh={class:"float-left h-9 w-32 flex flex-row gap-3 flex-nowrap items-center justify-around"},Dh=["onClick"],Mh={class:"float-right flex w-52 h-9 justify-center items-center gap-4"},kh=xt({__name:"TrackControl",props:{modelValue:{type:Number,default:30}},emits:{"update:modelValue":e=>e!==null},setup(e,{emit:t}){const r=e,n=t,a=dt({get(){return r.modelValue},set(c){n("update:modelValue",c)}}),i=Gt();oe();const o=mt({fontSize:"1.75rem",padding:"0.25rem",boxSizing:"content-box"}),s=lr({showTooltip:!1,size:"small",step:10,max:100,min:0});function l(c){let d=a.value+c;d>s.max&&(d=s.max),d<s.min&&(d=s.min),a.value=d}const u=dt(()=>[{title:"撤销[Ctrl+Z]",icon:"UndoIcon",handler:i._undo},{title:"恢复[Ctrl+Shift+Z]",icon:"RedoIcon",handler:i._redo},{title:"左链接[L]",disable:i.selectTrackItem.index===-1,icon:"LeftLinkIcon",handler:i.leftLink},{title:"分割[S]",disable:i.selectTrackItem.index===-1,icon:"SplitIcon",handler:i.splitTrack},{title:"删除[Backspace]",disable:i.selectTrackItem.index===-1,icon:"DeleteIcon",handler:i.removeTrack},{title:"文字[T]",disable:!1,icon:"AddTextIcon",handler:i.addText}]);return(c,d)=>{const f=Ee,p=Vo,v=iu,h=Or,g=ou;return H(),K("div",wh,[F("div",Eh,[(H(!0),K(ve,null,ye(u.value,m=>(H(),K("div",{key:m.title,onClick:m.handler},[O(p,{effect:"light",content:m.title},{default:q(()=>[O(f,{size:"15",class:re(["focus:outline-0",m.disable?"cursor-not-allowed text-gray-400":"cursor-pointer"])},{default:q(()=>[(H(),Pt(ur(m.icon)))]),_:2},1032,["class"])]),_:2},1032,["content"])],8,Dh))),128))]),F("div",Mh,[O(v,{style:Et(o.value),class:"cursor-pointer",onClick:d[0]||(d[0]=m=>l(-10))},null,8,["style"]),O(h,Ha({modelValue:a.value,"onUpdate:modelValue":d[1]||(d[1]=m=>a.value=m)},s),null,16,["modelValue"]),O(g,{style:Et(o.value),class:"cursor-pointer",onClick:d[2]||(d[2]=m=>l(10))},null,8,["style"])])])}}}),Pi=e=>new Map([[100,100],[90,50],[80,20],[70,10],[60,80],[50,40],[40,20],[30,10],[20,40],[10,25],[0,10]]).get(e)||100,Ht=(e,t)=>{let n=Pi(e)*t;return e<70&&(n=n/jt),e<30&&(n=n/6),n},Th=(e,t)=>e>60?t:10,Rh=(e,t)=>{let r=e;return t<30?r*=60:t<70&&(r*=10),su(r*1e3).str},Ih=(e,t,r)=>{const n=e%t;let a="";return r<70?"":(a=r>80?n===0?"":`${n<10?"0":""}${n}f`:"",a)},un=.5,Ve=(e,t,r)=>{const n=Pi(t);return t<70&&(e*=r),t<30&&(e*=6),Math.round(e/n)},Ph=(e,t,r)=>{const{start:n,scale:a,step:i,focusPosition:o}=t,{ratio:s,bgColor:l,width:u,height:c,textColor:d,subTextColor:f,textSize:p,textScale:v,focusColor:h,longColor:g,shortColor:m}=r,b=Th(a,i);e.scale(s,s),e.clearRect(0,0,u,c),e.fillStyle=l,e.fillRect(0,0,u,c);const x=Pi(a),_=x*b,S=Math.floor(n/x)*x,y=Math.floor(n/_)*_,C=S-n,M=y-n,E=n+Math.ceil(u);if(o){let w=o.start,T=o.end-o.start;a<70&&(w=w/i,T=T/i),a<30&&(w=w/6,T=T/6);const D=w*x+un-n,R=T*x-un;R>x&&(e.fillStyle=h,e.fillRect(D,0,R,c*3/8))}e.beginPath(),e.fillStyle=d,e.strokeStyle=g;for(let w=y,T=0;w<E;w+=_,T++){const D=M+T*_+un;e.moveTo(D,0),e.save(),e.translate(D,c*.4),e.scale(v/s,v/s);const R=Rh(w/_,a),I=R.length*5*v*s,B=p/s*v/s/2;e.fillText(R,I,B),e.restore(),e.lineTo(D,c*10/16/s)}e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=f,e.strokeStyle=m;for(let w=S,T=0;w<E;w+=x,T++){const D=C+T*x+un;e.moveTo(D,0);const R=Ih(w/x,b,a);if(R){e.save(),e.translate(D,c*.4),e.scale(v/s,v/s);const I=R.length*5*v*s,B=p/s*v/s/2;e.fillText(R,I,B),e.restore()}w%_!==0&&e.lineTo(D,c/3/s)}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},Oh=xt({__name:"TimeLine",props:{start:{type:Number,default:0},step:{type:Number,default:jt},scale:{type:Number,default:0},focusPosition:{type:Object,default(){return{start:0,end:0}}}},emits:{selectFrame(e){return e!==null}},setup(e,{emit:t}){const r=e,n=t,a=mt(),i=mt();let o={};const{isDark:s}=lu(sr()),l=dt(()=>({bgColor:s.value?"#374151":"#E5E7EB",ratio:window.devicePixelRatio||1,textSize:12,textScale:.83,lineWidth:1,textBaseline:"middle",textAlign:"center",longColor:s.value?"#E5E7EB":"#374151",shortColor:s.value?"#9CA3AF":"#6B7280",textColor:s.value?"#E5E7EB":"#374151",subTextColor:s.value?"#9CA3AF":"#6B7280",focusColor:s.value?"#6D28D9":"#C4B5FD"})),u=lr({width:0,height:0}),c=dt(()=>({width:`${u.width/l.value.ratio}px`,height:`${u.height/l.value.ratio}px`}));function d(){Ph(o,{...r},{...u,...l.value})}function f(){o=i.value.getContext("2d"),o.font=`${l.value.textSize*l.value.ratio}px -apple-system, ".SFNSText-Regular", "SF UI Text", "PingFang SC", "Hiragino Sans GB", "Helvetica Neue", "WenQuanYi Zen Hei", "Microsoft YaHei", Arial, sans-serif`,o.lineWidth=l.value.lineWidth,o.textBaseline=l.value.textBaseline,o.textAlign=l.value.textAlign}function p(){const{width:h,height:g}=a.value.getBoundingClientRect();u.width=h*l.value.ratio,u.height=g*l.value.ratio,$o(()=>{f(),d()})}function v(h){const g=h.offsetX,m=Ve(r.start+g,r.scale,r.step);n("selectFrame",m)}return Dn(()=>{p()}),Jt(l,d),Jt(r,d),window.addEventListener("resize",p,!1),(h,g)=>(H(),K("div",{ref_key:"canvasContainer",ref:a,class:"sticky top-0 left-0 right-0 h-5 text-center leading-5 text-sm z-20"},[F("canvas",Ha({style:c.value},u,{ref_key:"timeLine",ref:i,onClick:v}),null,16)],512))}}),Bh=xt({__name:"TrackHandler",props:{isActive:{type:Boolean,default:!1},lineIndex:{type:Number,default:0},itemIndex:{type:Number,default:0}},setup(e){const t=e,r=Gt(),n=oe(),a=dt(()=>r.trackList[t.lineIndex].list[t.itemIndex]),i=mt();let o=0,s={isVA:!1,start:0,end:0,offsetR:0,offsetL:0,minStart:0,maxStart:0,minEnd:0,maxEnd:0},l=!1,u=[];function c(g,m=10){const b=[];u.forEach(_=>{Math.abs(_.left-g)<=m&&b.push({position:_.left,frame:_.start}),Math.abs(_.right-g)<=m&&b.push({position:_.right,frame:_.end})});const x=Ht(r.trackScale,n.playStartFrame);return Math.abs(x-g)<=m&&b.push({position:x,frame:n.playStartFrame}),b}function d(g,m){return m.length===0?void 0:m.reduce((x,_)=>Math.abs(_.position-g)<Math.abs(x.position-g)?_:x,{position:Number.MAX_SAFE_INTEGER,frame:0})}const f=dt(()=>Ht(r.trackScale,1));function p(g,m){const b=t.itemIndex>0?g[t.itemIndex-1]:null,x=t.itemIndex<g.length?g[t.itemIndex+1]:null,_=["video","audio"].includes(m.type),S={isVA:_,start:m.start,end:m.end,offsetR:m.offsetR,offsetL:m.offsetL,minStart:b?b.end:0,maxStart:m.end-1,minEnd:m.start+1,maxEnd:x?x.start:jt*60*60};if(_){const y=m.frameCount-S.offsetL,C=m.frameCount-S.offsetR;S.maxEnd=x?Math.min(x.start,S.start+y):Math.min(y+S.start,jt*60*60),S.minStart=b?Math.max(b.end,S.end-C):Math.max(S.end-C,0)}Object.assign(s,{...S})}function v(g,m){const{isVA:b,start:x,end:_,offsetR:S,offsetL:y,minStart:C,maxStart:M,minEnd:E,maxEnd:w}=s,T=_-x,D=y+T,R=S+T;if(m==="left"){let I=x+g;I>M&&(I=M),I<C&&(I=C);let B=I-x;b?(_-I>D&&(I=_-D,B=I-x),r.trackList[t.lineIndex].list[t.itemIndex].offsetL=Math.max(y+B,0)):r.trackList[t.lineIndex].list[t.itemIndex].frameCount=_-I,r.trackList[t.lineIndex].list[t.itemIndex].start=I}else{let I=_+g;if(I>w&&(I=w),I<E&&(I=E),b){I-x>R&&(I=x+R);const B=I-_;r.trackList[t.lineIndex].list[t.itemIndex].offsetR=Math.max(S-B,0)}else r.trackList[t.lineIndex].list[t.itemIndex].frameCount=I-x;r.trackList[t.lineIndex].list[t.itemIndex].end=I}}function h(g,m){var C;g.preventDefault(),g.stopPropagation(),u=[];for(let M=0;M<r.trackList.length;M++)for(let E=0;E<r.trackList[M].list.length;E++)if(M!==t.lineIndex||E!==t.itemIndex){const w=r.trackList[M].list[E];u.push({start:w.start,end:w.end,left:Ht(r.trackScale,w.start),right:Ht(r.trackScale,w.end)})}n.isPause=!0;const{pageX:b}=g;o=b,l=!0,p(((C=r.trackList[t.lineIndex])==null?void 0:C.list)||[],a.value);const x=a.value.start,_=a.value.end,S=i.value.closest(".trackItem"),y=m==="left"?S.offsetLeft:S.offsetLeft+S.offsetWidth;document.onmousemove=M=>{if(!l)return;const{pageX:E}=M,w=o-E,T=c(y-w);r.dragData.fixLines=[T];const D=d(y-w,T),R=D!=null&&D.frame?m==="left"?D.frame-x:D.frame-_:-Math.round(w/f.value);v(R,m)},document.onmouseup=()=>{l=!1,document.onmouseup=null,document.onmousemove=null}}return(g,m)=>ue((H(),K("div",{class:re(["absolute left-0 right-0 top-0 bottom-0 border z-20",{"dark:border-gray-100 border-gray-600":e.isActive}]),ref_key:"el",ref:i},[F("div",{class:"cursor-c-resize flex flex-col justify-center absolute -top-px -bottom-px -left-2 text-center rounded-tl rounded-bl w-2 dark:bg-gray-100 bg-gray-500 dark:text-gray-800 text-gray-100",ref:"handlerLeft",onMousedown:m[0]||(m[0]=b=>h(b,"left"))},m[2]||(m[2]=[F("span",null,"|",-1)]),544),F("div",{class:"cursor-c-resize flex flex-col justify-center absolute -top-px -bottom-px -right-2 text-center rounded-tr rounded-br w-2 dark:bg-gray-100 bg-gray-500 dark:text-gray-800 text-gray-100",ref:"handlerRight",onMousedown:m[1]||(m[1]=b=>h(b,"right"))},m[3]||(m[3]=[F("span",null,"|",-1)]),544)],2)),[[cr,e.isActive]])}}),zh={},Ah={class:"loading absolute top-0 left-0 right-0 bottom-0 bg-gray-600 flex flex-row justify-start items-center"};function Lh(e,t){return H(),K("div",Ah,t[0]||(t[0]=[F("span",null,null,-1),F("span",null,null,-1),F("span",null,null,-1),F("span",null,null,-1),F("span",null,null,-1)]))}const Oi=Mn(zh,[["render",Lh],["__scopeId","data-v-5979cec8"]]),Gh={class:"flex flex-col rounded overflow-hidden h-full"},Fh={class:"flex items-center text-xs pl-2 overflow-hidden h-5 leading-5 bg-[#4b4f54] text-white"},Nh={class:"mr-4 shrink-0"},$h={class:"shrink-0"},Vh=["src"],Wh={key:0,class:"pl-2 overflow-hidden h-4 flex items-center bg-gray-700 relative text-xs overflow-ellipsis whitespace-nowrap text-white"},Xh=xt({__name:"VideoItem",props:{trackItem:{type:Object}},setup(e){const t=e,r=oe(),n=Gt(),a=mt(),i=mt(!0),o=mt([]);async function s(){try{r.ingLoadingCount++,i.value=!0;const l=Ht(n.trackScale,t.trackItem.frameCount),u=Math.ceil(l/50),c=Math.ceil(t.trackItem.source.duration*1e6/u),d=await uu.thumbnails(t.trackItem,n.trackScale,c);o.value=d.map(({img:f})=>URL.createObjectURL(f))}finally{i.value=!1,r.ingLoadingCount--}}return Jt(()=>[t.trackItem.source],s,{immediate:!0,flush:"post"}),Wo(()=>{o.value.forEach(l=>{URL.revokeObjectURL(l)})}),(l,u)=>{const c=Ya,d=Ee;return H(),K("div",Gh,[F("div",Fh,[O(d,{size:"18"},{default:q(()=>[O(c,{class:"inline-block mr-2 shrink-0"})]),_:1}),F("span",Nh,"["+pt(e.trackItem.source.duration.toFixed(1))+"s]",1),F("span",$h,pt(`${e.trackItem.name}.${e.trackItem.format}`),1)]),F("div",{ref_key:"container",ref:a,class:"bg-gray-400 bg-opacity-70 flex-1 relative whitespace-nowrap overflow-hidden",style:Et({left:`-${P(Ht)(P(n).trackScale,e.trackItem.offsetL)}px`})},[(H(!0),K(ve,null,ye(P(o),(f,p)=>(H(),K("img",{key:p,src:f,alt:"",class:"image-item",draggable:"false"},null,8,Vh))),128))],4),e.trackItem.source.meta.prompt?(H(),K("div",Wh,[F("span",null,pt(e.trackItem.source.meta.prompt),1)])):Wt("",!0),ue(O(Oi,{class:"pl-12 bg-opacity-70"},null,512),[[cr,P(i)||e.trackItem.loading]])])}}});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Lt(e,t,r,n){return new(r||(r=Promise))(function(a,i){function o(u){try{l(n.next(u))}catch(c){i(c)}}function s(u){try{l(n.throw(u))}catch(c){i(c)}}function l(u){var c;u.done?a(u.value):(c=u.value,c instanceof r?c:new r(function(d){d(c)})).then(o,s)}l((n=n.apply(e,[])).next())})}class Hr{constructor(){this.listeners={}}on(t,r,n){if(this.listeners[t]||(this.listeners[t]=new Set),this.listeners[t].add(r),n==null?void 0:n.once){const a=()=>{this.un(t,a),this.un(t,r)};return this.on(t,a),a}return()=>this.un(t,r)}un(t,r){var n;(n=this.listeners[t])===null||n===void 0||n.delete(r)}once(t,r){return this.on(t,r,{once:!0})}unAll(){this.listeners={}}emit(t,...r){this.listeners[t]&&this.listeners[t].forEach(n=>n(...r))}}const Bo={decode:function(e,t){return Lt(this,void 0,void 0,function*(){const r=new AudioContext({sampleRate:t});return r.decodeAudioData(e).finally(()=>r.close())})},createBuffer:function(e,t){return typeof e[0]=="number"&&(e=[e]),function(r){const n=r[0];if(n.some(a=>a>1||a<-1)){const a=n.length;let i=0;for(let o=0;o<a;o++){const s=Math.abs(n[o]);s>i&&(i=s)}for(const o of r)for(let s=0;s<a;s++)o[s]/=i}}(e),{duration:t,length:e[0].length,sampleRate:e[0].length/t,numberOfChannels:e.length,getChannelData:r=>e==null?void 0:e[r],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function Al(e,t){const r=t.xmlns?document.createElementNS(t.xmlns,e):document.createElement(e);for(const[n,a]of Object.entries(t))if(n==="children")for(const[i,o]of Object.entries(t))typeof o=="string"?r.appendChild(document.createTextNode(o)):r.appendChild(Al(i,o));else n==="style"?Object.assign(r.style,a):n==="textContent"?r.textContent=a:r.setAttribute(n,a.toString());return r}function zo(e,t,r){const n=Al(e,t||{});return r==null||r.appendChild(n),n}var Hh=Object.freeze({__proto__:null,createElement:zo,default:zo});const Yh={fetchBlob:function(e,t,r){return Lt(this,void 0,void 0,function*(){const n=yield fetch(e,r);if(n.status>=400)throw new Error(`Failed to fetch ${e}: ${n.status} (${n.statusText})`);return function(a,i){Lt(this,void 0,void 0,function*(){if(!a.body||!a.headers)return;const o=a.body.getReader(),s=Number(a.headers.get("Content-Length"))||0;let l=0;const u=d=>Lt(this,void 0,void 0,function*(){l+=(d==null?void 0:d.length)||0;const f=Math.round(l/s*100);i(f)}),c=()=>Lt(this,void 0,void 0,function*(){let d;try{d=yield o.read()}catch{return}d.done||(u(d.value),yield c())});c()})}(n.clone(),t),n.blob()})}};class jh extends Hr{constructor(t){super(),this.isExternalMedia=!1,t.media?(this.media=t.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),t.mediaControls&&(this.media.controls=!0),t.autoplay&&(this.media.autoplay=!0),t.playbackRate!=null&&this.onMediaEvent("canplay",()=>{t.playbackRate!=null&&(this.media.playbackRate=t.playbackRate)},{once:!0})}onMediaEvent(t,r,n){return this.media.addEventListener(t,r,n),()=>this.media.removeEventListener(t,r,n)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const t=this.getSrc();t.startsWith("blob:")&&URL.revokeObjectURL(t)}canPlayType(t){return this.media.canPlayType(t)!==""}setSrc(t,r){if(this.getSrc()===t)return;this.revokeSrc();const n=r instanceof Blob&&this.canPlayType(r.type)?URL.createObjectURL(r):t;this.media.src=n}destroy(){this.media.pause(),this.isExternalMedia||(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(t){this.media=t}play(){return Lt(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(t){this.media.currentTime=t}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(t){this.media.volume=t}getMuted(){return this.media.muted}setMuted(t){this.media.muted=t}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(t,r){r!=null&&(this.media.preservesPitch=r),this.media.playbackRate=t}getMediaElement(){return this.media}setSinkId(t){return this.media.setSinkId(t)}}class Xn extends Hr{constructor(t,r){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.subscriptions=[],this.options=t;const n=this.parentFromOptionsContainer(t.container);this.parent=n;const[a,i]=this.initHtml();n.appendChild(a),this.container=a,this.scrollContainer=i.querySelector(".scroll"),this.wrapper=i.querySelector(".wrapper"),this.canvasWrapper=i.querySelector(".canvases"),this.progressWrapper=i.querySelector(".progress"),this.cursor=i.querySelector(".cursor"),r&&i.appendChild(r),this.initEvents()}parentFromOptionsContainer(t){let r;if(typeof t=="string"?r=document.querySelector(t):t instanceof HTMLElement&&(r=t),!r)throw new Error("Container not found");return r}initEvents(){const t=n=>{const a=this.wrapper.getBoundingClientRect(),i=n.clientX-a.left,o=n.clientX-a.left;return[i/a.width,o/a.height]};this.wrapper.addEventListener("click",n=>{const[a,i]=t(n);this.emit("click",a,i)}),this.wrapper.addEventListener("dblclick",n=>{const[a,i]=t(n);this.emit("dblclick",a,i)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:n,scrollWidth:a,clientWidth:i}=this.scrollContainer,o=n/a,s=(n+i)/a;this.emit("scroll",o,s)});const r=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{r().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}onContainerResize(){const t=this.parent.clientWidth;t===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=t,this.reRender())}initDrag(){this.subscriptions.push(function(t,r,n,a,i=3,o=0,s=100){if(!t)return()=>{};const l=matchMedia("(pointer: coarse)").matches;let u=()=>{};const c=d=>{if(d.button!==o)return;d.preventDefault(),d.stopPropagation();let f=d.clientX,p=d.clientY,v=!1;const h=Date.now(),g=S=>{if(S.preventDefault(),S.stopPropagation(),l&&Date.now()-h<s)return;const y=S.clientX,C=S.clientY,M=y-f,E=C-p;if(v||Math.abs(M)>i||Math.abs(E)>i){const w=t.getBoundingClientRect(),{left:T,top:D}=w;v||(n==null||n(f-T,p-D),v=!0),r(M,E,y-T,C-D),f=y,p=C}},m=S=>{if(v){const y=S.clientX,C=S.clientY,M=t.getBoundingClientRect(),{left:E,top:w}=M;a==null||a(y-E,C-w)}u()},b=S=>{S.relatedTarget&&S.relatedTarget!==document.documentElement||m(S)},x=S=>{v&&(S.stopPropagation(),S.preventDefault())},_=S=>{v&&S.preventDefault()};document.addEventListener("pointermove",g),document.addEventListener("pointerup",m),document.addEventListener("pointerout",b),document.addEventListener("pointercancel",b),document.addEventListener("touchmove",_,{passive:!1}),document.addEventListener("click",x,{capture:!0}),u=()=>{document.removeEventListener("pointermove",g),document.removeEventListener("pointerup",m),document.removeEventListener("pointerout",b),document.removeEventListener("pointercancel",b),document.removeEventListener("touchmove",_),setTimeout(()=>{document.removeEventListener("click",x,{capture:!0})},10)}};return t.addEventListener("pointerdown",c),()=>{u(),t.removeEventListener("pointerdown",c)}}(this.wrapper,(t,r,n)=>{this.emit("drag",Math.max(0,Math.min(1,n/this.wrapper.getBoundingClientRect().width)))},t=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,t/this.wrapper.getBoundingClientRect().width)))},t=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,t/this.wrapper.getBoundingClientRect().width)))}))}getHeight(t){return t==null?128:isNaN(Number(t))?t==="auto"&&this.parent.clientHeight||128:Number(t)}initHtml(){const t=document.createElement("div"),r=t.attachShadow({mode:"open"});return r.innerHTML=`
      <style>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[t,r]}setOptions(t){if(this.options.container!==t.container){const r=this.parentFromOptionsContainer(t.container);r.appendChild(this.container),this.parent=r}t.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=t,this.reRender()}getWrapper(){return this.wrapper}getScroll(){return this.scrollContainer.scrollLeft}setScroll(t){this.scrollContainer.scrollLeft=t}setScrollPercentage(t){const{scrollWidth:r}=this.scrollContainer,n=r*t;this.setScroll(n)}destroy(){var t;this.subscriptions.forEach(r=>r()),this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect()}createDelay(t=10){let r,n;const a=()=>{r&&clearTimeout(r),n&&n()};return this.timeouts.push(a),()=>new Promise((i,o)=>{a(),n=o,r=setTimeout(()=>{r=void 0,n=void 0,i()},t)})}convertColorValues(t){if(!Array.isArray(t))return t||"";if(t.length<2)return t[0]||"";const r=document.createElement("canvas"),n=r.getContext("2d"),a=r.height*(window.devicePixelRatio||1),i=n.createLinearGradient(0,0,0,a),o=1/(t.length-1);return t.forEach((s,l)=>{const u=l*o;i.addColorStop(u,s)}),i}renderBarWaveform(t,r,n,a){const i=t[0],o=t[1]||t[0],s=i.length,{width:l,height:u}=n.canvas,c=u/2,d=window.devicePixelRatio||1,f=r.barWidth?r.barWidth*d:1,p=r.barGap?r.barGap*d:r.barWidth?f/2:0,v=r.barRadius||0,h=l/(f+p)/s,g=v&&"roundRect"in n?"roundRect":"rect";n.beginPath();let m=0,b=0,x=0;for(let _=0;_<=s;_++){const S=Math.round(_*h);if(S>m){const M=Math.round(b*c*a),E=M+Math.round(x*c*a)||1;let w=c-M;r.barAlign==="top"?w=0:r.barAlign==="bottom"&&(w=u-E),n[g](m*(f+p),w,f,E,v),m=S,b=0,x=0}const y=Math.abs(i[_]||0),C=Math.abs(o[_]||0);y>b&&(b=y),C>x&&(x=C)}n.fill(),n.closePath()}renderLineWaveform(t,r,n,a){const i=o=>{const s=t[o]||t[0],l=s.length,{height:u}=n.canvas,c=u/2,d=n.canvas.width/l;n.moveTo(0,c);let f=0,p=0;for(let v=0;v<=l;v++){const h=Math.round(v*d);if(h>f){const m=c+(Math.round(p*c*a)||1)*(o===0?-1:1);n.lineTo(f,m),f=h,p=0}const g=Math.abs(s[v]||0);g>p&&(p=g)}n.lineTo(f,c)};n.beginPath(),i(0),i(1),n.fill(),n.closePath()}renderWaveform(t,r,n){if(n.fillStyle=this.convertColorValues(r.waveColor),r.renderFunction)return void r.renderFunction(t,n);let a=r.barHeight||1;if(r.normalize){const i=Array.from(t[0]).reduce((o,s)=>Math.max(o,Math.abs(s)),0);a=i?1/i:1}r.barWidth||r.barGap||r.barAlign?this.renderBarWaveform(t,r,n,a):this.renderLineWaveform(t,r,n,a)}renderSingleCanvas(t,r,n,a,i,o,s,l){const u=window.devicePixelRatio||1,c=document.createElement("canvas"),d=t[0].length;c.width=Math.round(n*(o-i)/d),c.height=a*u,c.style.width=`${Math.floor(c.width/u)}px`,c.style.height=`${a}px`,c.style.left=`${Math.floor(i*n/u/d)}px`,s.appendChild(c);const f=c.getContext("2d");if(this.renderWaveform(t.map(p=>p.slice(i,o)),r,f),c.width>0&&c.height>0){const p=c.cloneNode(),v=p.getContext("2d");v.drawImage(c,0,0),v.globalCompositeOperation="source-in",v.fillStyle=this.convertColorValues(r.progressColor),v.fillRect(0,0,c.width,c.height),l.appendChild(p)}}renderChannel(t,r,n,a){var{overlay:i}=r,o=function(s,l){var u={};for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&l.indexOf(c)<0&&(u[c]=s[c]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function"){var d=0;for(c=Object.getOwnPropertySymbols(s);d<c.length;d++)l.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(s,c[d])&&(u[c[d]]=s[c[d]])}return u}(r,["overlay"]);return Lt(this,void 0,void 0,function*(){const s=document.createElement("div"),l=this.getHeight(o.height);s.style.height=`${l}px`,i&&a>0&&(s.style.marginTop=`-${l}px`),this.canvasWrapper.style.minHeight=`${l}px`,this.canvasWrapper.appendChild(s);const u=s.cloneNode();this.progressWrapper.appendChild(u);const c=t[0].length,d=(_,S)=>{this.renderSingleCanvas(t,o,n,l,Math.max(0,_),Math.min(S,c),s,u)};if(!this.isScrollable)return void d(0,c);const{scrollLeft:f,scrollWidth:p,clientWidth:v}=this.scrollContainer,h=c/p;let g=Math.min(Xn.MAX_CANVAS_WIDTH,v);if(o.barWidth||o.barGap){const _=o.barWidth||.5,S=_+(o.barGap||_/2);g%S!=0&&(g=Math.floor(g/S)*S)}const m=Math.floor(Math.abs(f)*h),b=Math.floor(m+g*h),x=b-m;x<=0||(d(m,b),yield Promise.all([Lt(this,void 0,void 0,function*(){if(m===0)return;const _=this.createDelay();for(let S=m;S>=0;S-=x)yield _(),d(Math.max(0,S-x),S)}),Lt(this,void 0,void 0,function*(){if(b===c)return;const _=this.createDelay();for(let S=b;S<c;S+=x)yield _(),d(S,Math.min(c,S+x))})]))})}render(t){return Lt(this,void 0,void 0,function*(){this.timeouts.forEach(s=>s()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const r=window.devicePixelRatio||1,n=this.scrollContainer.clientWidth,a=Math.ceil(t.duration*(this.options.minPxPerSec||0));this.isScrollable=a>n;const i=this.options.fillParent&&!this.isScrollable,o=(i?n:a)*r;this.wrapper.style.width=i?"100%":`${a}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=t,this.emit("render");try{if(this.options.splitChannels)yield Promise.all(Array.from({length:t.numberOfChannels}).map((s,l)=>{var u;const c=Object.assign(Object.assign({},this.options),(u=this.options.splitChannels)===null||u===void 0?void 0:u[l]);return this.renderChannel([t.getChannelData(l)],c,o,l)}));else{const s=[t.getChannelData(0)];t.numberOfChannels>1&&s.push(t.getChannelData(1)),yield this.renderChannel(s,this.options,o,0)}}catch{return}this.emit("rendered")})}reRender(){if(!this.audioData)return;const{scrollWidth:t}=this.scrollContainer,{right:r}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&t!==this.scrollContainer.scrollWidth){const{right:n}=this.progressWrapper.getBoundingClientRect();let a=n-r;a*=2,a=a<0?Math.floor(a):Math.ceil(a),a/=2,this.scrollContainer.scrollLeft+=a}}zoom(t){this.options.minPxPerSec=t,this.reRender()}scrollIntoView(t,r=!1){const{scrollLeft:n,scrollWidth:a,clientWidth:i}=this.scrollContainer,o=t*a,s=n,l=n+i,u=i/2;if(this.isDragging)o+30>l?this.scrollContainer.scrollLeft+=30:o-30<s&&(this.scrollContainer.scrollLeft-=30);else{(o<s||o>l)&&(this.scrollContainer.scrollLeft=o-(this.options.autoCenter?u:0));const c=o-n-u;r&&this.options.autoCenter&&c>0&&(this.scrollContainer.scrollLeft+=Math.min(c,10))}{const c=this.scrollContainer.scrollLeft,d=c/a,f=(c+i)/a;this.emit("scroll",d,f)}}renderProgress(t,r){if(isNaN(t))return;const n=100*t;this.canvasWrapper.style.clipPath=`polygon(${n}% 0, 100% 0, 100% 100%, ${n}% 100%)`,this.progressWrapper.style.width=`${n}%`,this.cursor.style.left=`${n}%`,this.cursor.style.transform=`translateX(-${Math.round(n)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(t,r)}exportImage(t,r,n){return Lt(this,void 0,void 0,function*(){const a=this.canvasWrapper.querySelectorAll("canvas");if(!a.length)throw new Error("No waveform data");if(n==="dataURL"){const i=Array.from(a).map(o=>o.toDataURL(t,r));return Promise.resolve(i)}return Promise.all(Array.from(a).map(i=>new Promise((o,s)=>{i.toBlob(l=>{l?o(l):s(new Error("Could not export image"))},t,r)})))})}}Xn.MAX_CANVAS_WIDTH=4e3;class Uh extends Hr{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}class Ao extends Hr{constructor(t=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=t,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return Lt(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(t){if(this.currentSrc=t,this._duration=void 0,!t)return this.buffer=null,void this.emit("emptied");fetch(t).then(r=>{if(r.status>=400)throw new Error(`Failed to fetch ${t}: ${r.status} (${r.statusText})`);return r.arrayBuffer()}).then(r=>this.currentSrc!==t?null:this.audioContext.decodeAudioData(r)).then(r=>{this.currentSrc===t&&(this.buffer=r,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var t;if(!this.paused)return;this.paused=!1,(t=this.bufferNode)===null||t===void 0||t.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let r=this.playedDuration*this._playbackRate;r>=this.duration&&(r=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,r),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var t;this.paused=!0,(t=this.bufferNode)===null||t===void 0||t.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return Lt(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(t){var r,n;const a=t-this.currentTime;(r=this.bufferNode)===null||r===void 0||r.stop(this.audioContext.currentTime+a),(n=this.bufferNode)===null||n===void 0||n.addEventListener("ended",()=>{this.bufferNode=null,this.pause()},{once:!0})}setSinkId(t){return Lt(this,void 0,void 0,function*(){return this.audioContext.setSinkId(t)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this.bufferNode&&(this.bufferNode.playbackRate.value=t)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(t){const r=!this.paused;r&&this._pause(),this.playedDuration=t/this._playbackRate,r&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var t,r;return(t=this._duration)!==null&&t!==void 0?t:((r=this.buffer)===null||r===void 0?void 0:r.duration)||0}set duration(t){this._duration=t}get volume(){return this.gainNode.gain.value}set volume(t){this.gainNode.gain.value=t,this.emit("volumechange")}get muted(){return this._muted}set muted(t){this._muted!==t&&(this._muted=t,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(t){return/^(audio|video)\//.test(t)}getGainNode(){return this.gainNode}getChannelData(){const t=[];if(!this.buffer)return t;const r=this.buffer.numberOfChannels;for(let n=0;n<r;n++)t.push(this.buffer.getChannelData(n));return t}}const qh={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class Ir extends jh{static create(t){return new Ir(t)}constructor(t){const r=t.media||(t.backend==="WebAudio"?new Ao:void 0);super({media:r,mediaControls:t.mediaControls,autoplay:t.autoplay,playbackRate:t.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},qh,t),this.timer=new Uh;const n=r?void 0:this.getMediaElement();this.renderer=new Xn(this.options,n),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins(),Promise.resolve().then(()=>{this.emit("init");const a=this.options.url||this.getSrc()||"";(a||this.options.peaks&&this.options.duration)&&this.load(a,this.options.peaks,this.options.duration).catch(()=>null)})}updateProgress(t=this.getCurrentTime()){return this.renderer.renderProgress(t/this.getDuration(),this.isPlaying()),t}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const t=this.updateProgress();this.emit("timeupdate",t),this.emit("audioprocess",t)}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const t=this.updateProgress();this.emit("timeupdate",t)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",t=>{this.emit("error",t.error)}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(t,r)=>{this.options.interact&&(this.seekTo(t),this.emit("interaction",t*this.getDuration()),this.emit("click",t,r))}),this.renderer.on("dblclick",(t,r)=>{this.emit("dblclick",t,r)}),this.renderer.on("scroll",(t,r)=>{const n=this.getDuration();this.emit("scroll",t*n,r*n)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",t=>{this.emit("dragstart",t)}),this.renderer.on("dragend",t=>{this.emit("dragend",t)}));{let t;this.subscriptions.push(this.renderer.on("drag",r=>{if(!this.options.interact)return;let n;this.renderer.renderProgress(r),clearTimeout(t),this.isPlaying()?n=0:this.options.dragToSeek===!0?n=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(n=this.options.dragToSeek.debounceTime),t=setTimeout(()=>{this.seekTo(r)},n),this.emit("interaction",r*this.getDuration()),this.emit("drag",r)}))}}initPlugins(){var t;!((t=this.options.plugins)===null||t===void 0)&&t.length&&this.options.plugins.forEach(r=>{this.registerPlugin(r)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(t=>t()),this.mediaSubscriptions=[]}setOptions(t){this.options=Object.assign({},this.options,t),this.renderer.setOptions(this.options),t.audioRate&&this.setPlaybackRate(t.audioRate),t.mediaControls!=null&&(this.getMediaElement().controls=t.mediaControls)}registerPlugin(t){return t._init(this),this.plugins.push(t),this.subscriptions.push(t.once("destroy",()=>{this.plugins=this.plugins.filter(r=>r!==t)})),t}getWrapper(){return this.renderer.getWrapper()}getScroll(){return this.renderer.getScroll()}setScrollTime(t){const r=t/this.getDuration();this.renderer.setScrollPercentage(r)}getActivePlugins(){return this.plugins}loadAudio(t,r,n,a){var i;return Lt(this,void 0,void 0,function*(){if(this.emit("load",t),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!r&&!n){const s=this.options.fetchParams||{};window.AbortController&&!s.signal&&(this.abortController=new AbortController,s.signal=(i=this.abortController)===null||i===void 0?void 0:i.signal);const l=u=>this.emit("loading",u);r=yield Yh.fetchBlob(t,l,s)}this.setSrc(t,r);const o=a||this.getDuration()||(yield new Promise(s=>{this.onMediaEvent("loadedmetadata",()=>s(this.getDuration()),{once:!0})}));if(!t&&!r){const s=this.getMediaElement();s instanceof Ao&&(s.duration=o)}if(n)this.decodedData=Bo.createBuffer(n,o||0);else if(r){const s=yield r.arrayBuffer();this.decodedData=yield Bo.decode(s,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(t,r,n){return Lt(this,void 0,void 0,function*(){try{return yield this.loadAudio(t,void 0,r,n)}catch(a){throw this.emit("error",a),a}})}loadBlob(t,r,n){return Lt(this,void 0,void 0,function*(){try{return yield this.loadAudio("blob",t,r,n)}catch(a){throw this.emit("error",a),a}})}zoom(t){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(t),this.emit("zoom",t)}getDecodedData(){return this.decodedData}exportPeaks({channels:t=2,maxLength:r=8e3,precision:n=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const a=Math.min(t,this.decodedData.numberOfChannels),i=[];for(let o=0;o<a;o++){const s=this.decodedData.getChannelData(o),l=[],u=Math.round(s.length/r);for(let c=0;c<r;c++){const d=s.slice(c*u,(c+1)*u);let f=0;for(let p=0;p<d.length;p++){const v=d[p];Math.abs(v)>Math.abs(f)&&(f=v)}l.push(Math.round(f*n)/n)}i.push(l)}return i}getDuration(){let t=super.getDuration()||0;return t!==0&&t!==1/0||!this.decodedData||(t=this.decodedData.duration),t}toggleInteraction(t){this.options.interact=t}setTime(t){super.setTime(t),this.updateProgress(t),this.emit("timeupdate",t)}seekTo(t){const r=this.getDuration()*t;this.setTime(r)}playPause(){return Lt(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(t){this.setTime(this.getCurrentTime()+t)}empty(){this.load("",[[0]],.001)}setMediaElement(t){this.unsubscribePlayerEvents(),super.setMediaElement(t),this.initPlayerEvents()}exportImage(t="image/png",r=1,n="dataURL"){return Lt(this,void 0,void 0,function*(){return this.renderer.exportImage(t,r,n)})}destroy(){var t;this.emit("destroy"),(t=this.abortController)===null||t===void 0||t.abort(),this.plugins.forEach(r=>r.destroy()),this.subscriptions.forEach(r=>r()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}Ir.BasePlugin=class extends Hr{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}},Ir.dom=Hh;const Kh={class:"flex flex-col rounded overflow-hidden h-full"},Zh={class:"flex items-center text-xs pl-2 overflow-hidden h-5 leading-5 bg-[#395c96] text-gray-100"},Jh={class:"mr-4 shrink-0"},Qh={class:"overflow-hidden bg-blue-900 bg-opacity-60 flex-1 relative"},tg={key:0,class:"pl-2 overflow-hidden h-4 bg-gray-600 relative text-xs text-white"},eg=xt({__name:"AudioItem",props:{trackItem:{type:Object,default(){return{showWidth:"0px",showLeft:"0px"}}}},setup(e){const t=e,r=oe(),n=dt(()=>{const{start:s,end:l,offsetL:u,offsetR:c,frameCount:d}=t.trackItem,f=l-s;return{transformOrigin:"left top",left:`-${u/f*100}%`,right:`-${c/f*100}%`}}),a=mt(!0),i=mt();async function o(){r.ingLoadingCount++;try{const s=cu(t.trackItem.source.url);Ir.create({container:i.value,url:s,...fu})}finally{a.value=!1,r.ingLoadingCount--}}return Jt(()=>t.trackItem.source&&i.value,()=>{i.value&&o()},{immediate:!0}),(s,l)=>{const u=Xo,c=Ee;return H(),K("div",Kh,[F("div",Zh,[O(c,{size:"18"},{default:q(()=>[O(u,{class:"inline-block mr-2 shrink-0"})]),_:1}),F("span",Jh,pt(`${e.trackItem.name}.${e.trackItem.format}`),1)]),F("div",Qh,[F("div",{style:Et(P(n)),class:"absolute",ref_key:"waveRef",ref:i},null,4)]),e.trackItem.source.meta.prompt?(H(),K("div",tg,[F("span",null,pt(e.trackItem.source.meta.prompt),1)])):Wt("",!0),ue(O(Oi,{class:"pl-12 bg-opacity-70"},null,512),[[cr,P(a)||e.trackItem.loading]])])}}}),rg={class:"flex flex-col rounded overflow-hidden h-full"},ng={class:"flex items-center text-xs pl-2 overflow-hidden h-6 leading-6 bg-red-900 bg-opacity-70 text-gray-300"},ag={class:"mr-4 shrink-0"},ig=xt({__name:"TextItem",props:{trackItem:{type:Object,default(){return{width:"0px",left:"0px"}}}},setup(e){const t=e;return(r,n)=>{const a=Ho,i=Ee;return H(),K("div",rg,[F("div",ng,[O(i,{size:"18"},{default:q(()=>[O(a,{class:"inline-block mr-2 shrink-0"})]),_:1}),F("span",ag,pt(t.trackItem.text),1)])])}}}),og={class:"flex flex-col rounded overflow-hidden h-full"},sg={class:"flex items-center text-xs pl-2 overflow-hidden h-full leading-6 bg-yellow-700 bg-opacity-70 text-white"},lg=["src"],ug={class:"mr-4 shrink-0 flex flex-col gap-1"},cg={class:"text-xs h-4"},fg={key:0,class:"overflow-hidden h-4 relative text-xs text-white"},dg=xt({__name:"ImageItem",props:{trackItem:{type:Object,default(){return{width:"0px",left:"0px"}}}},setup(e){const t=e;async function r(){t.trackItem}return Jt(()=>t.trackItem.source,r,{immediate:!0,flush:"post"}),(n,a)=>(H(),K("div",og,[F("div",sg,[F("img",{src:e.trackItem.source.cover,class:"h-full inline-block mr-2 shrink-0",alt:"",draggable:"false"},null,8,lg),F("div",ug,[F("div",cg,pt(`${e.trackItem.name}.${e.trackItem.format}`),1),e.trackItem.source.meta.prompt?(H(),K("div",fg,[F("span",null,pt(e.trackItem.source.meta.prompt),1)])):Wt("",!0)])]),ue(O(Oi,{class:"pl-12 bg-opacity-70"},null,512),[[cr,e.trackItem.loading]])]))}}),pg=["data-type","data-line","data-index"],vg=xt({__name:"TrackItem",props:{trackType:{type:String,default:""},lineIndex:{type:Number,default:0},itemIndex:{type:Number,default:0},trackItem:{type:Object,default(){return{width:"0px",left:"0px"}}}},setup(e){const t=e,r=Gt(),n=dt(()=>r.selectTrackItem.line===t.lineIndex&&r.selectTrackItem.index===t.itemIndex),a=new Map([["video",Xh],["audio",eg],["text",ig],["image",dg]]),i=dt(()=>r.moveTrackData.lineIndex===t.lineIndex&&r.moveTrackData.itemIndex===t.itemIndex);function o(l){l.preventDefault(),l.stopPropagation(),r.selectTrackItem.line=t.lineIndex,r.selectTrackItem.index=t.itemIndex}const s=dt(()=>i.value?{width:t.trackItem.showWidth,left:`${parseInt(t.trackItem.showLeft)+r.dragData.moveX}px`,top:`${r.dragData.moveY}px`}:{width:t.trackItem.showWidth,left:t.trackItem.showLeft});return(l,u)=>(H(),K("div",{class:re(["text-left text-sm top-0 absolute trackItem",[P(ja).get(t.trackItem.type),i.value?"z-50 isDrag":"z-10"]]),style:Et([s.value]),"data-type":t.trackItem.type,"data-line":e.lineIndex,"data-index":e.itemIndex,onClick:o},[O(Bh,{isActive:n.value,lineIndex:e.lineIndex,itemIndex:e.itemIndex},null,8,["isActive","lineIndex","itemIndex"]),(H(),Pt(ur(P(a).get(e.trackItem.type)),{trackItem:e.trackItem},null,8,["trackItem"]))],14,pg))}}),hg=["data-index","data-type"],gg=xt({__name:"TrackLine",props:{isMain:{type:Boolean,default:!1},lineType:{type:String,default:""},lineIndex:{type:Number,default:0},lineData:{type:Array,default(){return[]}}},setup(e){const t=e,r=Gt(),n=dt(()=>r.selectTrackItem.line===t.lineIndex);return(a,i)=>(H(),K("div",{class:re(["mb-1 mt-1 relative ml-2 trackLine",[P(ja).get(e.lineType),P(n)?"dark:bg-gray-700 bg-gray-400 bg-opacity-20":"bg-gray-200 bg-opacity-10",e.isMain?"bg-blue-500 bg-opacity-20":""]]),"data-index":e.lineIndex,"data-type":e.lineType},[(H(!0),K(ve,null,ye(e.lineData,(o,s)=>(H(),Pt(vg,{key:o.id,lineIndex:e.lineIndex,itemIndex:s,trackItem:o},null,8,["lineIndex","itemIndex","trackItem"]))),128))],10,hg))}}),mg=Mn(gg,[["__scopeId","data-v-b1bbe857"]]),bg={class:"absolute pt-10 pb-5 min-w-full flex flex-col justify-center min-h-full overflow-x-hidden left-0 right-0"},xg=["title"],_g=xt({__name:"TrackListIcon",props:{listData:{type:Array,default(){return[]}},offsetTop:{type:Number,default:0}},setup(e){const t=e,r=new Map([["video",Ya],["audio",Xo],["text",Ho],["image",du]]),n=mt();return Jt(()=>t.offsetTop,()=>{n.value.scrollTop=t.offsetTop}),(a,i)=>{const o=Ee;return H(),K("div",{ref_key:"iconList",ref:n,class:"relative w-12 flex h-full flex-col items-center justify-start overflow-y-hidden overflow-x-scroll border-r-2 dark:border-gray-700 border-gray-300 border-t"},[i[0]||(i[0]=F("span",{class:"w-full h-5 sticky top-0 left-0 right-0 z-20"},null,-1)),F("div",bg,[(H(!0),K(ve,null,ye(e.listData,(s,l)=>(H(),K("div",{key:l,class:re(["z-10 flex justify-center items-center w-12 text-center mb-1 mt-1",[P(ja).get(s.type),s.main?"bg-blue-500 bg-opacity-20":""]]),title:s.main?"主轨道":""},[O(o,{size:"20"},{default:q(()=>[(H(),Pt(ur(P(r).get(s.type))))]),_:2},1024)],10,xg))),128))])],512)}}}),yg=xt({__name:"TrackPlayPoint",setup(e){const t={left:10},r=Gt(),n=oe(),a=dt(()=>({left:`${t.left}px`,transform:`translate(${Ht(r.trackScale,n.playStartFrame)}px, 0px)`})),i=mt(!1);function o(u){u.stopPropagation(),u.preventDefault(),n.isPause=!0,i.value=!0}function s(u){if(i.value){const c=document.getElementById("track-container").getBoundingClientRect(),f=Ve(u.pageX-t.left-c.left,r.trackScale,30)-1,p=f<0?0:f>r.frameCount?r.frameCount:f;n.playStartFrame=p}}document.addEventListener("mousemove",s);function l(u){i.value=!1}return document.addEventListener("mouseup",l),(u,c)=>(H(),K("div",{class:"z-30 w-px absolute -top-5 bottom-0 bg-gray-700 dark:bg-gray-100 transition-transform duration-75",id:"trackPlayPoint",style:Et(a.value),onMousedown:o},c[0]||(c[0]=[F("span",{class:"playPoint block border-1 border-gray-600 bg-gray-600 h-3 w-2.5 dark:border-gray-100 dark:bg-gray-100 sticky top-0 right-0 left-0 cursor-move"},null,-1)]),36))}}),Sg=Mn(yg,[["__scopeId","data-v-35987b9d"]]),Cg={class:"trackList flex flex-1 flex-row w-full overflow-x-hidden overflow-y-auto relative"},wg={key:0,class:"flex justify-center items-center h-24 m-auto w-2/3 dark:bg-gray-500 bg-gray-200 rounded-md text-sm border-dashed border-2 dark:border-gray-500 border-gray-200 hover:dark:border-blue-300 hover:border-blue-400"},Eg=xt({__name:"TrackList",setup(e){const t=Gt(),r=oe(),n=mt(),a=mt(),i={left:10,right:200},o=mt(0-i.left),s=mt(0),l=dt(()=>t.trackScale),u=dt(()=>({width:Ht(l.value,t.frameCount)+i.right})),c=mt(-1),d=mt(0),f=mt(!0),p=dt(()=>t.dragData.dragPoint);let v=mt(0);const h=dt(()=>t.trackList.map((G,A)=>{G.main&&(v.value=A);const N=G.list.map(L=>({...L,showWidth:`${Ht(l.value,L.end-L.start)}px`,showLeft:`${Ht(l.value,L.start)}px`}));return{...G,list:N}}));function g(G,A,N){G.preventDefault(),G.stopPropagation(),t.selectTrackItem.line=A,t.selectTrackItem.index=N}function m(G){const A=G-1,N=A<0?0:A;r.isPause=!0,r.playStartFrame=N}let b=0;const x=ca(()=>{t.trackScale-=b>0?10:-10,b=0},100),_=G=>{(G.ctrlKey||G.metaKey)&&(G.preventDefault(),b||(b=G.deltaY),x())};function S(){const{scrollLeft:G,scrollTop:A}=n.value;o.value=G-i.left,s.value=A}let y={left:0,right:0,start:0,end:0},C=[],M;function E(G){const A=window.getComputedStyle(G);return{left:parseInt(A.left),right:parseInt(A.left)+parseInt(A.width)}}function w(G){if(M=G.target.closest(".trackItem"),!M)return;r.isPause=!0;const A=Number(M.dataset.line),N=Number(M.dataset.index);t.dragData.dragPoint.x=G.pageX,t.dragData.dragPoint.y=G.pageY,t.dragData.dataInfo=t.trackList[A].list[N],t.dragData.dragType=M.dataset.type,t.moveTrackData.lineIndex=A,t.moveTrackData.itemIndex=N,t.selectTrackItem.line=-1,t.selectTrackItem.index=0;const L=t.trackList[A].list[N];y={start:L.start,end:L.end,left:Ht(t.trackScale,L.start),right:Ht(t.trackScale,L.end)},C=[];for(let $=0;$<t.trackList.length;$++)for(let U=0;U<t.trackList[$].list.length;U++)if($!==A||U!==N){const Q=t.trackList[$].list[U];C.push({start:Q.start,end:Q.end,left:Ht(t.trackScale,Q.start),right:Ht(t.trackScale,Q.end)})}}function T(G,A,{start:N,end:L}){if(G.type!==A.type)return{overlap:!0,index:0};const $=A.list.filter(U=>U.id!==G.id);if($.length===0)return{overlap:!1,index:0};if($[0].start>=L)return{overlap:!1,index:0};if($[$.length-1].end<=N)return{overlap:!1,index:$.length};for(let U=0;U<$.length-1;U++){const Q=$[U],at=$[U+1];if(N>=Q.end&&L<=at.start)return{overlap:!1,index:U+1}}return{overlap:!0,index:0}}function D(){const G=M.offsetTop+M.offsetHeight/2+M.offsetParent.offsetTop,A=Array.from(document.querySelectorAll(".trackLine"));if(A[0].offsetTop>G)return{isNewLine:!0,insertIndex:0};for(let N=0;N<A.length;N++){const L=A[N];if(L.offsetTop<=G&&L.offsetTop+L.offsetHeight>=G)return{isNewLine:!1,insertIndex:N,elem:L};if(N+1!==A.length){const $=A[N+1];if(L.offsetTop+L.offsetHeight<=G&&$.offsetTop>=G)return{isNewLine:!0,insertIndex:N+1}}}return{isNewLine:!0,insertIndex:A.length}}let R={left:0,right:0,start:0,end:0};function I(){let{isNewLine:G,insertIndex:A,elem:N}=D();const L=E(M),$=R.left||L.left,U=R.right||L.right,Q=R.start||Ve($,t.trackScale,jt),at=R.end||Ve(U,t.trackScale,jt);if(!N)return{insertIndex:A,itemIndex:0,left:$,right:U,isNewLine:G,start:Q,end:at};const J=t.dragData.dataInfo,tt=t.trackList[A],{overlap:lt,index:ut}=T(J,tt,{start:Q,end:at});return lt&&(G=!0,N.offsetLeft+N.offsetWidth/2<M.offsetTop+M.offsetParent.offsetTop+M.offsetHeight/2&&(A-=1)),{insertIndex:A,itemIndex:ut,left:$,right:U,isNewLine:G,start:Q,end:at}}function B(G,A=10){const N=[];C.forEach($=>{Math.abs($.left-G)<=A&&N.push({position:$.left,frame:$.start}),Math.abs($.right-G)<=A&&N.push({position:$.right,frame:$.end})});const L=Ht(t.trackScale,r.playStartFrame);return Math.abs(L-G)<=A&&N.push({position:L,frame:r.playStartFrame}),N}function V({left:G,right:A},N){if(R={left:0,right:0,start:0,end:0},N[0].length===0&&N[1].length===0)return;const L=N[0].reduce((U,Q)=>Math.abs(Q.position-G)<Math.abs(U.position-G)?Q:U,{position:Number.MAX_SAFE_INTEGER,frame:0}),$=N[1].reduce((U,Q)=>Math.abs(Q.position-A)<Math.abs(U.position-A)?Q:U,{position:Number.MAX_SAFE_INTEGER,frame:0});Math.abs(L.position-G)<Math.abs($.position-A)?(R.left=L.position,R.start=L.frame,t.dragData.moveX=L.position-y.left):(R.right=$.position,R.end=$.frame,t.dragData.moveX=$.position-y.right)}function j(G){if(M){t.dragData.moveX=G.pageX-t.dragData.dragPoint.x,t.dragData.moveY=G.pageY-t.dragData.dragPoint.y;const A=t.dragData.moveX+y.left,N=t.dragData.moveX+y.right;t.dragData.fixLines=[B(A),B(N)],V({left:A,right:N},t.dragData.fixLines)}}function W(G){let A=t.dragData.dataInfo;const N=Math.max(R.right!==0?Ve(G.right,t.trackScale,jt)-(A.end-A.start):Ve(G.left,t.trackScale,jt),0);A.end=N+(A.end-A.start),A.start=N;const L=A;let $=0,U=0;t.trackList.forEach((at,J)=>{at.list.forEach((tt,lt)=>{tt.id===A.id&&($=J,U=lt)})}),t.trackList[$].list.splice(U,1),G.isNewLine?t.trackList.splice(G.insertIndex,0,{type:L.type,list:[L]}):t.trackList[G.insertIndex].list.splice(G.itemIndex,0,L);const Q=t.trackList.findIndex(at=>at.list.length===0);Q!==-1&&t.trackList.splice(Q,1)}function X(G){if(M){t.dragData.moveX=G.pageX-t.dragData.dragPoint.x,t.dragData.moveY=G.pageY-t.dragData.dragPoint.y;const A=t.dragData.moveX+y.left,N=t.dragData.moveX+y.right;t.dragData.fixLines=[B(A),B(N)],V({left:A,right:N},t.dragData.fixLines);const L=I();W(L),M=null}t.dragData.fixLines=[],t.moveTrackData.lineIndex=-1,t.moveTrackData.itemIndex=-1,t.dragData.moveX=0,t.dragData.moveY=0}function z(G){const A=a.value,{left:N}=A.getBoundingClientRect(),{clientX:L}=G,{x:$}=p.value,U=L-N-$;d.value=U<0?0:U}async function Y(){const G=Ve(d.value,t.trackScale,jt),A=await t.createTrack(t.dragData.dataInfo,G);t.addTrack(A),d.value=0,t.dragData.dataInfo={},t.moveTrackData.lineIndex=-1,t.moveTrackData.itemIndex=-1,t.dragData.moveX=0,t.dragData.moveY=0}return(G,A)=>(H(),K("div",Cg,[O(_g,{listData:h.value,offsetTop:s.value},null,8,["listData","offsetTop"]),F("div",{class:"flex-1 overflow-x-scroll overflow-y-auto flex-col shrink-0 grow relative",ref_key:"trackList",ref:n,onScroll:S,onWheel:_,onClick:A[0]||(A[0]=N=>g(N,-1,-1))},[O(Oh,{start:o.value,scale:l.value,step:P(jt),focusPosition:P(t).selectResource,onSelectFrame:m},null,8,["start","scale","step","focusPosition"]),F("div",{class:"absolute top-5 flex shrink-0 grow min-w-full",style:{"min-height":"calc(100% - 20px)"},ref_key:"trackListContainer",ref:a,onMousedown:w,onMousemove:j,onMouseup:X,onMouseleave:X,onDragover:No(z,["stop","prevent"]),onDrop:Y},[h.value.length===0?(H(),K("div",wg,[O(Ya,{class:"text-xl mr-4"}),A[1]||(A[1]=kt(" 将素材拖拽到这里，开始编辑你的大作吧~ "))])):(H(),K("div",{key:1,class:"z-10 pt-5 pb-5 min-w-full flex shrink-0 grow flex-col justify-center min-h-full",style:Et({width:`${u.value.width}px`}),id:"track-container"},[(H(!0),K(ve,null,ye(h.value,(N,L)=>(H(),Pt(mg,{key:N.list.reduce(($,U)=>$+U.id,"line"),style:Et({"margin-left":`${i.left}px`}),class:re([c.value===L?f.value?"showLine-t":"showLine-b":""]),lineType:N.type,isActive:P(t).selectTrackItem.line===L,lineIndex:L,isMain:N.main,lineData:N.list},null,8,["style","class","lineType","isActive","lineIndex","isMain","lineData"]))),128))],4)),ue(O(Sg,null,null,512),[[cr,h.value.length!==0]]),h.value.length!==0?(H(!0),K(ve,{key:2},ye(P(t).dragData.fixLines.reduce((N,L)=>N.concat(L),[]),(N,L)=>(H(),K("div",{key:L,class:"z-30 w-px absolute -top-5 bottom-0 bg-yellow-300 dark:bg-yellow-300 pointer-events-none",style:Et({left:`${N.position+10}px`})},null,4))),128)):Wt("",!0),h.value.length!==0&&d.value!==0?(H(),K("div",{key:3,class:"z-30 w-px absolute -top-5 bottom-0 bg-yellow-300 dark:bg-yellow-300",style:Et({left:`${d.value}px`})},null,4)):Wt("",!0)],544)],544)]))}}),Dg=xt({__name:"TrackContainer",setup(e){const t=sr(),r=Gt(),n=dt(()=>({height:`${t.trackHeight}px`}));return(a,i)=>(H(),K("div",{class:"overflow-hidden select-none relative pt-2 flex flex-col dark:bg-night-light bg-white rounded",style:Et(P(n))},[O(kh,{modelValue:P(r).trackScale,"onUpdate:modelValue":i[0]||(i[0]=o=>P(r).trackScale=o)},null,8,["modelValue"]),O(Eg)],4))}}),Lo=xt({__name:"SplitLine",props:{disabled:{type:Boolean,default:!1},newWidth:{type:Number,default:0},newHeight:{type:Number,default:0},direction:{type:String,default:"horizontal"},limitSize:{type:Object,default(){return{minHeight:0,maxHeight:999999,minWidth:0,maxWidth:999999}}}},emits:{"update:newWidth":e=>e!==null,"update:newHeight":e=>e!==null},setup(e,{emit:t}){const r=e,n=t,a=dt({get(){return r.newWidth},set(p){n("update:newWidth",p)}}),i=dt({get(){return r.newHeight},set(p){n("update:newHeight",p)}}),o=mt(),s=sr(),l=dt(()=>r.direction==="vertical"),u=dt(()=>s.isDark?"#E5E7EB":"#1F2937"),c={left:0,top:0};let d=!1;function f(){if(r.disabled)return;const{left:p,top:v}=o.value.getBoundingClientRect();c.left=parseInt(p),c.top=parseInt(v),d=!0,document.onmousemove=h=>{if(!d)return;const{pageX:g,pageY:m}=h,{top:b,left:x}=c,{minHeight:_,maxHeight:S,minWidth:y,maxWidth:C}=r.limitSize,M=g-x,E=m-b;if(c.left=g,c.top=m,l.value){const w=a.value-M;a.value=w>C?C:w<y?y:w}else{const w=i.value-E;i.value=w>S?S:w<_?_:w}},document.onmouseup=()=>{d=!1,document.onmouseup=null,document.onmousemove=null}}return(p,v)=>{const h=Ee;return H(),K("div",{ref_key:"lineElement",ref:o,class:re(["flex justify-center items-center",[e.disabled?"cursor-no-drop":l.value?"cursor-c-resize":"cursor-r-resize",l.value?"w-2 h-full flex-col":"h-2 w-full flex-row"]]),onMousedown:f},[F("span",{class:re(["absolute flex z-10 dark:bg-gray-800 bg-gray-200",l.value?"h-8 w-4 flex-col":"w-8 h-4 flex-row"])},[O(h,{class:re(["flex-auto",l.value?"rotate-90":""]),color:u.value},{default:q(()=>[O(P(pu))]),_:1},8,["class","color"])],2)],34)}}}),Mg={class:"flex h-full overflow-hidden relative container-box !p-0 bg-transparent"},kg={class:"flex flex-col gap-2 w-full"},Tg=xt({__name:"GenerateContainer",setup(e){const t=mt(0),r=dt(()=>Vi[t.value]);return(n,a)=>(H(),K("div",Mg,[F("div",kg,[O(Ua,{"active-index":P(t),"onUpdate:activeIndex":a[0]||(a[0]=i=>vn(t)?t.value=i:null),menu:P(Vi)},null,8,["active-index","menu"]),(H(),Pt(Yo,null,[(H(),Pt(ur(P(r).component),{key:P(r).key}))],1024))])]))}}),Rg=jo(),te=Gt(),gr=oe(),Ig=()=>{ee("backspace,delete",(e,t)=>{te.removeTrack(),e.preventDefault()}),ee("space",(e,t)=>{gr.isPause=!gr.isPause,e.preventDefault()}),ee("right",(e,t)=>{gr.forward(),e.preventDefault()}),ee("left",(e,t)=>{gr.backward(),e.preventDefault()}),ee("t|T",(e,t)=>{te.addText(),e.preventDefault()}),ee("l",(e,t)=>{te.leftLink(),e.preventDefault()}),ee("s",(e,t)=>{te.splitTrack(),e.preventDefault()}),ee("ctrl+c",(e,t)=>{te.selectResource&&(te.copyData=te.selectResource,e.preventDefault())}),ee("ctrl+v",(e,t)=>{(async()=>{if(te.copyData){const r=await te.copyTrack(te.copyData),n=r.end-r.start;r.start=gr.playStartFrame,r.end=r.start+n,te.addTrack(r),e.preventDefault()}})()}),ee("ctrl+s",(e,t)=>{Rg.saveProject().then(()=>{Uo.success("保存成功")}),e.preventDefault()}),ee("ctrl+z",(e,t)=>{te._undo(),e.preventDefault()}),ee("ctrl+shift+z",(e,t)=>{te._redo(),e.preventDefault()})},Pg=()=>{ee.deleteScope("all")},Og={class:"w-full h-full overflow-hidden flex flex-col items-center"},Bg={class:"flex-1 w-full overflow-auto"},zg={class:"w-full upload-container"},Ag=xt({__name:"UploadContainer",setup(e){const t=vu(),r=mt([]),n=mt(!1),a=mt(0),i=dt(()=>t.getTypeList(o.value.key,!0).value),o=dt(()=>Wi.filter(l=>l.fileType)[a.value]),s=async()=>{if(r.value.length===0){Uo.error("请选择文件再上传");return}n.value=!0;try{const l=r.value[0].raw,u=await gu(o.value.key,l);t.addResource(u,!0),r.value=[]}finally{n.value=!1}};return Jt(()=>r.value,()=>{r.value.length>0&&s()}),(l,u)=>{const c=yu,d=Ee,f=mu,p=Pr;return H(),K("div",Og,[O(Ua,{"active-index":P(a),"onUpdate:activeIndex":u[0]||(u[0]=v=>vn(a)?a.value=v:null),menu:P(Wi)},null,8,["active-index","menu"]),F("div",Bg,[O(c,{"list-data":P(i),type:P(o).key},null,8,["list-data","type"])]),ue((H(),K("div",zg,[O(f,{"file-list":P(r),"onUpdate:fileList":u[1]||(u[1]=v=>vn(r)?r.value=v:null),class:"w-full",drag:"",action:"","show-file-list":!1,"auto-upload":!1,accept:P(o).fileType,limit:1},{default:q(()=>[O(d,{class:"el-icon--upload mt-2",size:"40"},{default:q(()=>[O(P(hu))]),_:1}),u[2]||(u[2]=F("div",{class:"el-upload__text !mt-[-10px] mb-4"},[kt(" 拖拽文件到此 或 "),F("em",null,"点击上传")],-1))]),_:1},8,["file-list","accept"])])),[[p,P(n)]])])}}}),Lg=Mn(Ag,[["__scopeId","data-v-097f20f4"]]),Gg={class:"flex h-full overflow-hidden relative container-box !p-0 bg-transparent"},Fg={class:"flex flex-col gap-2 w-full"},Ng=xt({__name:"ClipAIMenu",setup(e){const t=mt(0),r=dt(()=>Xi[t.value]);return(n,a)=>(H(),K("div",Gg,[F("div",Fg,[O(Ua,{"active-index":P(t),"onUpdate:activeIndex":a[0]||(a[0]=i=>vn(t)?t.value=i:null),menu:P(Xi),class:"mb-2"},null,8,["active-index","menu"]),(H(),Pt(Yo,null,[(H(),Pt(ur(P(r).component),{key:P(r).key}))],1024))])]))}}),$g={class:"flex flex-1 overflow-hidden gap-4 p-4 h-full"},Vg={class:"w-[370px] flex flex-col rounded overflow-hidden"},Wg={class:"flex flex-1 flex-col overflow-hidden gap-2"},Xg={class:"flex flex-1 flex-row flex-nowrap container-box gap-2"},Kg=xt({__name:"index",setup(e){const t=sr(),r=jo(),n=mt(),a=lr({minHeight:200,maxHeight:document.body.getBoundingClientRect().height-200,minWidth:300,maxWidth:600});return Dn(()=>{Ig(),n.value=setInterval(async()=>{await r.saveProject()},30*1e3)}),Wo(()=>{Pg(),clearInterval(n.value)}),(i,o)=>{const s=Go,l=Fo;return H(),K("div",$g,[F("div",Vg,[O(l,{type:"border-card",class:"flex-1 overflow-hidden"},{default:q(()=>[O(s,{class:"h-full",label:"生成区"},{default:q(()=>[O(Tg)]),_:1}),O(s,{class:"h-full",label:"上传区"},{default:q(()=>[O(Lg)]),_:1}),O(s,{class:"h-full",label:"工具区"},{default:q(()=>[O(Ng)]),_:1})]),_:1})]),F("div",Wg,[F("div",Xg,[O(Ch),O(Lo,{"new-width":P(t).attrWidth,"onUpdate:newWidth":o[0]||(o[0]=u=>P(t).attrWidth=u),direction:"vertical","limit-size":P(a)},null,8,["new-width","limit-size"]),O(af)]),O(Lo,{"new-height":P(t).trackHeight,"onUpdate:newHeight":o[1]||(o[1]=u=>P(t).trackHeight=u),direction:"horizontal","limit-size":P(a)},null,8,["new-height","limit-size"]),O(Dg)])])}}});export{Kg as default};
