import{b as E0,a1 as Lt,c2 as g1,o as ge,e as Fe,f as ie,h as oe,a6 as Vt,M as t1,ae as M1,y as rt,d4 as a1,bE as ht,a3 as U0,a5 as A1,v as B0,ai as R0,g as Q,al as r1,d5 as Kt,d6 as Bt,ce as Q0,d7 as k1,a as a0,H as A0,w as xe,j as I0,bX as T1,a4 as n1,d8 as E1,d9 as B1,da as s1,cC as mt,d1 as lt,A as nt,z as z0,bi as R1,db as Rt,dc as Qt,dd as I1,de as l1,l as V0,aE as L1,L as $0,F as k0,i as O0,I as J0,X as V1,df as H1,dg as D1,au as it,dh as N1,di as O1,dj as F1,dk as P1,x as Z0,K as i1,dl as ot,s as j0,G as X0,aP as Y0,u as o1,aX as z1,dm as c1,dn as u1,cJ as U1,dp as $1,a_ as _1,cF as G1,cE as j1,ad as f1,dq as X1,cK as Y1,dr as q1,ds as Z1,dt as W1,du as K1,dv as Q1,dw as G0,dx as J1,dy as ea,dz as ta,dA as aa,dB as ra,aV as v1,aC as Ht,aD as Dt,aF as na,aN as Nt,cD as Ot,d2 as sa,dC as Jt,dD as la,dE as ia,dF as oa,dG as ca,dH as d1,dI as ua,dJ as _a}from"./index-KuFrev5g.js";import{E as fa,d as h1,b as ct,a as ut,c as Ft}from"./el-progress-DEU-0ZNE.js";const va=E0({name:"ImgEmpty"}),da=E0({...va,setup(ke){const de=Lt("empty"),ce=g1();return(N,J)=>(ge(),Fe("svg",{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[ie("defs",null,[ie("linearGradient",{id:`linearGradient-1-${oe(ce)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[ie("stop",{"stop-color":`var(${oe(de).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),ie("stop",{"stop-color":`var(${oe(de).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),ie("linearGradient",{id:`linearGradient-2-${oe(ce)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[ie("stop",{"stop-color":`var(${oe(de).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),ie("stop",{"stop-color":`var(${oe(de).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),ie("rect",{id:`path-3-${oe(ce)}`,x:"0",y:"0",width:"17",height:"36"},null,8,["id"])]),ie("g",{id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[ie("g",{id:"B-type",transform:"translate(-1268.000000, -535.000000)"},[ie("g",{id:"Group-2",transform:"translate(1268.000000, 535.000000)"},[ie("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${oe(de).cssVarBlockName("fill-color-3")})`},null,8,["fill"]),ie("polygon",{id:"Rectangle-Copy-14",fill:`var(${oe(de).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,["fill"]),ie("g",{id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},[ie("polygon",{id:"Rectangle-Copy-10",fill:`var(${oe(de).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,["fill"]),ie("polygon",{id:"Rectangle-Copy-11",fill:`var(${oe(de).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,["fill"]),ie("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${oe(ce)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,["fill"]),ie("polygon",{id:"Rectangle-Copy-13",fill:`var(${oe(de).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,["fill"])]),ie("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${oe(ce)})`,x:"13",y:"45",width:"40",height:"36"},null,8,["fill"]),ie("g",{id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},[ie("use",{id:"Mask",fill:`var(${oe(de).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${oe(ce)}`},null,8,["fill","xlink:href"]),ie("polygon",{id:"Rectangle-Copy",fill:`var(${oe(de).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${oe(ce)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,["fill","mask"])]),ie("polygon",{id:"Rectangle-Copy-18",fill:`var(${oe(de).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,["fill"])])])])]))}});var ha=Vt(da,[["__file","img-empty.vue"]]);const ma=t1({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),pa=E0({name:"ElEmpty"}),ba=E0({...pa,props:ma,setup(ke){const de=ke,{t:ce}=M1(),N=Lt("empty"),J=rt(()=>de.description||ce("el.table.emptyText")),se=rt(()=>({width:a1(de.imageSize)}));return(C,b)=>(ge(),Fe("div",{class:U0(oe(N).b())},[ie("div",{class:U0(oe(N).e("image")),style:A1(oe(se))},[C.image?(ge(),Fe("img",{key:0,src:C.image,ondragstart:"return false"},null,8,["src"])):ht(C.$slots,"image",{key:1},()=>[Q(ha)])],6),ie("div",{class:U0(oe(N).e("description"))},[C.$slots.description?ht(C.$slots,"description",{key:0}):(ge(),Fe("p",{key:1},B0(oe(J)),1))],2),C.$slots.default?(ge(),Fe("div",{key:0,class:U0(oe(N).e("bottom"))},[ht(C.$slots,"default")],2)):R0("v-if",!0)],2))}});var xa=Vt(ba,[["__file","empty.vue"]]);const yt=r1(xa),ya=t1({trigger:Kt.trigger,placement:Bt.placement,disabled:Kt.disabled,visible:Q0.visible,transition:Q0.transition,popperOptions:Bt.popperOptions,tabindex:Bt.tabindex,content:Q0.content,popperStyle:Q0.popperStyle,popperClass:Q0.popperClass,enterable:{...Q0.enterable,default:!0},effect:{...Q0.effect,default:"light"},teleported:Q0.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),wa={"update:visible":ke=>k1(ke),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},Sa="onUpdate:visible",Ca=E0({name:"ElPopover"}),ga=E0({...Ca,props:ya,emits:wa,setup(ke,{expose:de,emit:ce}){const N=ke,J=rt(()=>N[Sa]),se=Lt("popover"),C=a0(),b=rt(()=>{var R;return(R=oe(C))==null?void 0:R.popperRef}),Z=rt(()=>[{width:a1(N.width)},N.popperStyle]),V=rt(()=>[se.b(),N.popperClass,{[se.m("plain")]:!!N.content}]),q=rt(()=>N.transition===`${se.namespace.value}-fade-in-linear`),ye=()=>{var R;(R=C.value)==null||R.hide()},W=()=>{ce("before-enter")},fe=()=>{ce("before-leave")},H=()=>{ce("after-enter")},T=()=>{ce("update:visible",!1),ce("after-leave")};return de({popperRef:b,hide:ye}),(R,ue)=>(ge(),A0(oe(n1),T1({ref_key:"tooltipRef",ref:C},R.$attrs,{trigger:R.trigger,placement:R.placement,disabled:R.disabled,visible:R.visible,transition:R.transition,"popper-options":R.popperOptions,tabindex:R.tabindex,content:R.content,offset:R.offset,"show-after":R.showAfter,"hide-after":R.hideAfter,"auto-close":R.autoClose,"show-arrow":R.showArrow,"aria-label":R.title,effect:R.effect,enterable:R.enterable,"popper-class":oe(V),"popper-style":oe(Z),teleported:R.teleported,persistent:R.persistent,"gpu-acceleration":oe(q),"onUpdate:visible":oe(J),onBeforeShow:W,onBeforeHide:fe,onShow:H,onHide:T}),{content:xe(()=>[R.title?(ge(),Fe("div",{key:0,class:U0(oe(se).e("title")),role:"title"},B0(R.title),3)):R0("v-if",!0),ht(R.$slots,"default",{},()=>[I0(B0(R.content),1)])]),default:xe(()=>[R.$slots.reference?ht(R.$slots,"reference",{key:0}):R0("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var Ma=Vt(ga,[["__file","popover.vue"]]);const e1=(ke,de)=>{const ce=de.arg||de.value,N=ce==null?void 0:ce.popperRef;N&&(N.triggerRef=ke)};var Aa={mounted(ke,de){e1(ke,de)},updated(ke,de){e1(ke,de)}};const ka="popover",Ta=E1(Aa,ka),wt=r1(Ma,{directive:Ta});var m1={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */(function(ke,de){(function(N,J){ke.exports=J()})(B1,function(){return function(){var ce={686:function(se,C,b){b.d(C,{default:function(){return c0}});var Z=b(279),V=b.n(Z),q=b(370),ye=b.n(q),W=b(817),fe=b.n(W);function H(Xe){try{return document.execCommand(Xe)}catch{return!1}}var T=function(Be){var Y=fe()(Be);return H("cut"),Y},R=T;function ue(Xe){var Be=document.documentElement.getAttribute("dir")==="rtl",Y=document.createElement("textarea");Y.style.fontSize="12pt",Y.style.border="0",Y.style.padding="0",Y.style.margin="0",Y.style.position="absolute",Y.style[Be?"right":"left"]="-9999px";var Qe=window.pageYOffset||document.documentElement.scrollTop;return Y.style.top="".concat(Qe,"px"),Y.setAttribute("readonly",""),Y.value=Xe,Y}var U=function(Be,Y){var Qe=ue(Be);Y.container.appendChild(Qe);var v=fe()(Qe);return H("copy"),Qe.remove(),v},be=function(Be){var Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},Qe="";return typeof Be=="string"?Qe=U(Be,Y):Be instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(Be==null?void 0:Be.type)?Qe=U(Be.value,Y):(Qe=fe()(Be),H("copy")),Qe},Ne=be;function Re(Xe){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Re=function(Y){return typeof Y}:Re=function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},Re(Xe)}var De=function(){var Be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Y=Be.action,Qe=Y===void 0?"copy":Y,v=Be.container,x=Be.target,a=Be.text;if(Qe!=="copy"&&Qe!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(x!==void 0)if(x&&Re(x)==="object"&&x.nodeType===1){if(Qe==="copy"&&x.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(Qe==="cut"&&(x.hasAttribute("readonly")||x.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(a)return Ne(a,{container:v});if(x)return Qe==="cut"?R(x):Ne(x,{container:v})},r0=De;function Ke(Xe){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ke=function(Y){return typeof Y}:Ke=function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},Ke(Xe)}function l0(Xe,Be){if(!(Xe instanceof Be))throw new TypeError("Cannot call a class as a function")}function qe(Xe,Be){for(var Y=0;Y<Be.length;Y++){var Qe=Be[Y];Qe.enumerable=Qe.enumerable||!1,Qe.configurable=!0,"value"in Qe&&(Qe.writable=!0),Object.defineProperty(Xe,Qe.key,Qe)}}function _e(Xe,Be,Y){return Be&&qe(Xe.prototype,Be),Y&&qe(Xe,Y),Xe}function P(Xe,Be){if(typeof Be!="function"&&Be!==null)throw new TypeError("Super expression must either be null or a function");Xe.prototype=Object.create(Be&&Be.prototype,{constructor:{value:Xe,writable:!0,configurable:!0}}),Be&&o0(Xe,Be)}function o0(Xe,Be){return o0=Object.setPrototypeOf||function(Qe,v){return Qe.__proto__=v,Qe},o0(Xe,Be)}function je(Xe){var Be=S0();return function(){var Qe=L0(Xe),v;if(Be){var x=L0(this).constructor;v=Reflect.construct(Qe,arguments,x)}else v=Qe.apply(this,arguments);return Je(this,v)}}function Je(Xe,Be){return Be&&(Ke(Be)==="object"||typeof Be=="function")?Be:H0(Xe)}function H0(Xe){if(Xe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xe}function S0(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function L0(Xe){return L0=Object.setPrototypeOf?Object.getPrototypeOf:function(Y){return Y.__proto__||Object.getPrototypeOf(Y)},L0(Xe)}function C0(Xe,Be){var Y="data-clipboard-".concat(Xe);if(Be.hasAttribute(Y))return Be.getAttribute(Y)}var _0=function(Xe){P(Y,Xe);var Be=je(Y);function Y(Qe,v){var x;return l0(this,Y),x=Be.call(this),x.resolveOptions(v),x.listenClick(Qe),x}return _e(Y,[{key:"resolveOptions",value:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof v.action=="function"?v.action:this.defaultAction,this.target=typeof v.target=="function"?v.target:this.defaultTarget,this.text=typeof v.text=="function"?v.text:this.defaultText,this.container=Ke(v.container)==="object"?v.container:document.body}},{key:"listenClick",value:function(v){var x=this;this.listener=ye()(v,"click",function(a){return x.onClick(a)})}},{key:"onClick",value:function(v){var x=v.delegateTarget||v.currentTarget,a=this.action(x)||"copy",O=r0({action:a,container:this.container,target:this.target(x),text:this.text(x)});this.emit(O?"success":"error",{action:a,text:O,trigger:x,clearSelection:function(){x&&x.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(v){return C0("action",v)}},{key:"defaultTarget",value:function(v){var x=C0("target",v);if(x)return document.querySelector(x)}},{key:"defaultText",value:function(v){return C0("text",v)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(v){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return Ne(v,x)}},{key:"cut",value:function(v){return R(v)}},{key:"isSupported",value:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],x=typeof v=="string"?[v]:v,a=!!document.queryCommandSupported;return x.forEach(function(O){a=a&&!!document.queryCommandSupported(O)}),a}}]),Y}(V()),c0=_0},828:function(se){var C=9;if(typeof Element<"u"&&!Element.prototype.matches){var b=Element.prototype;b.matches=b.matchesSelector||b.mozMatchesSelector||b.msMatchesSelector||b.oMatchesSelector||b.webkitMatchesSelector}function Z(V,q){for(;V&&V.nodeType!==C;){if(typeof V.matches=="function"&&V.matches(q))return V;V=V.parentNode}}se.exports=Z},438:function(se,C,b){var Z=b(828);function V(W,fe,H,T,R){var ue=ye.apply(this,arguments);return W.addEventListener(H,ue,R),{destroy:function(){W.removeEventListener(H,ue,R)}}}function q(W,fe,H,T,R){return typeof W.addEventListener=="function"?V.apply(null,arguments):typeof H=="function"?V.bind(null,document).apply(null,arguments):(typeof W=="string"&&(W=document.querySelectorAll(W)),Array.prototype.map.call(W,function(ue){return V(ue,fe,H,T,R)}))}function ye(W,fe,H,T){return function(R){R.delegateTarget=Z(R.target,fe),R.delegateTarget&&T.call(W,R)}}se.exports=q},879:function(se,C){C.node=function(b){return b!==void 0&&b instanceof HTMLElement&&b.nodeType===1},C.nodeList=function(b){var Z=Object.prototype.toString.call(b);return b!==void 0&&(Z==="[object NodeList]"||Z==="[object HTMLCollection]")&&"length"in b&&(b.length===0||C.node(b[0]))},C.string=function(b){return typeof b=="string"||b instanceof String},C.fn=function(b){var Z=Object.prototype.toString.call(b);return Z==="[object Function]"}},370:function(se,C,b){var Z=b(879),V=b(438);function q(H,T,R){if(!H&&!T&&!R)throw new Error("Missing required arguments");if(!Z.string(T))throw new TypeError("Second argument must be a String");if(!Z.fn(R))throw new TypeError("Third argument must be a Function");if(Z.node(H))return ye(H,T,R);if(Z.nodeList(H))return W(H,T,R);if(Z.string(H))return fe(H,T,R);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function ye(H,T,R){return H.addEventListener(T,R),{destroy:function(){H.removeEventListener(T,R)}}}function W(H,T,R){return Array.prototype.forEach.call(H,function(ue){ue.addEventListener(T,R)}),{destroy:function(){Array.prototype.forEach.call(H,function(ue){ue.removeEventListener(T,R)})}}}function fe(H,T,R){return V(document.body,H,T,R)}se.exports=q},817:function(se){function C(b){var Z;if(b.nodeName==="SELECT")b.focus(),Z=b.value;else if(b.nodeName==="INPUT"||b.nodeName==="TEXTAREA"){var V=b.hasAttribute("readonly");V||b.setAttribute("readonly",""),b.select(),b.setSelectionRange(0,b.value.length),V||b.removeAttribute("readonly"),Z=b.value}else{b.hasAttribute("contenteditable")&&b.focus();var q=window.getSelection(),ye=document.createRange();ye.selectNodeContents(b),q.removeAllRanges(),q.addRange(ye),Z=q.toString()}return Z}se.exports=C},279:function(se){function C(){}C.prototype={on:function(b,Z,V){var q=this.e||(this.e={});return(q[b]||(q[b]=[])).push({fn:Z,ctx:V}),this},once:function(b,Z,V){var q=this;function ye(){q.off(b,ye),Z.apply(V,arguments)}return ye._=Z,this.on(b,ye,V)},emit:function(b){var Z=[].slice.call(arguments,1),V=((this.e||(this.e={}))[b]||[]).slice(),q=0,ye=V.length;for(q;q<ye;q++)V[q].fn.apply(V[q].ctx,Z);return this},off:function(b,Z){var V=this.e||(this.e={}),q=V[b],ye=[];if(q&&Z)for(var W=0,fe=q.length;W<fe;W++)q[W].fn!==Z&&q[W].fn._!==Z&&ye.push(q[W]);return ye.length?V[b]=ye:delete V[b],this}},se.exports=C,se.exports.TinyEmitter=C}},N={};function J(se){if(N[se])return N[se].exports;var C=N[se]={exports:{}};return ce[se](C,C.exports,J),C.exports}return function(){J.n=function(se){var C=se&&se.__esModule?function(){return se.default}:function(){return se};return J.d(C,{a:C}),C}}(),function(){J.d=function(se,C){for(var b in C)J.o(C,b)&&!J.o(se,b)&&Object.defineProperty(se,b,{enumerable:!0,get:C[b]})}}(),function(){J.o=function(se,C){return Object.prototype.hasOwnProperty.call(se,C)}}(),J(686)}().default})})(m1);var Ea=m1.exports;const Ba=s1(Ea),p1=ke=>({toClipboard(de,ce){return new Promise((N,J)=>{const se=document.createElement("button"),C=new Ba(se,{text:()=>de,action:()=>"copy",container:ce!==void 0?ce:document.body});C.on("success",b=>{C.destroy(),N(b)}),C.on("error",b=>{C.destroy(),J(b)}),document.body.appendChild(se),se.click(),document.body.removeChild(se)})}}),Ra={class:"h-24 cursor-pointer center bg-night hover:border-2 hover:border-purple box-border overflow-hidden"},Ia=["src"],La=["src"],Va={class:"flex-1 overflow-hidden flex gap-4 items-center"},Ha=["src"],Da={key:2,class:"relative w-24"},Na={class:"h-24 flex flex-col cursor-pointer center hover:border-2 hover:border-purple box-border overflow-hidden"},Oa={class:"w-20 text-center text-ellipsis overflow-hidden whitespace-nowrap"},Fa={class:"whitespace-pre overflow-auto max-h-[600px] select-text"},Pa=E0({__name:"ResourceItem",props:{data:{},type:{},noAction:{type:Boolean}},setup(ke){const de=ke,ce=mt(),N=lt(),{toClipboard:J}=p1(),se=a0(!1);async function C(V){V.stopPropagation(),ce.dragData.dataInfo=de.data,ce.dragData.dragType=de.type,ce.dragData.dragPoint.x=V.offsetX,ce.dragData.dragPoint.y=V.offsetY,ce.selectTrackItem.line=-1,ce.selectTrackItem.index=-1}async function b(V){V.stopPropagation();const q=await ce.createTrack(de.data);ce.addTrack(q)}const Z=async V=>{try{const q=window.getSelection().toString();await J(q===""?V:q),V0.success("复制成功")}catch(q){console.error(q)}};return(V,q)=>{var R,ue;const ye=fa,W=L1,fe=$0,H=wt,T=$0;return["image","video"].includes(V.type)?(ge(),Fe("div",{key:0,class:"relative w-24",draggable:"true",onDragstart:C},[ie("div",Ra,[V.type==="image"?(ge(),A0(ye,{key:0,class:"max-h-full max-w-full","preview-teleported":"",src:V.data.cover,"preview-src-list":[de.data.cover]},null,8,["src","preview-src-list"])):(ge(),Fe("img",{key:1,onClick:q[0]||(q[0]=U=>se.value=!0),src:de.data.cover,alt:""},null,8,Ia)),oe(se)?(ge(),A0(W,{key:2,title:"原始视频",center:"",modelValue:oe(se),"onUpdate:modelValue":q[1]||(q[1]=U=>nt(se)?se.value=U:null)},{default:xe(()=>[ie("video",{controls:"",src:de.data.url},null,8,La)]),_:1},8,["modelValue"])):R0("",!0)]),z0(ie("span",{class:"h-5 absolute bottom-1 right-2 text-xs text-gray-400"},B0((ue=(R=V.data)==null?void 0:R.duration)==null?void 0:ue.toFixed(1))+" s",513),[[R1,V.data.duration]]),ie("div",{class:"absolute top-2 right-1 bg-red-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:q[2]||(q[2]=U=>oe(N).removeResource(V.type,V.data.meta.recordId,V.data.meta.model==="upload"))},[Q(fe,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:xe(()=>[Q(oe(Rt))]),_:1})]),V.noAction?R0("",!0):(ge(),Fe("div",{key:0,class:"absolute bottom-2 right-1 bg-blue-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:b},[Q(fe,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:xe(()=>[Q(oe(Qt))]),_:1})]))],32)):["audio","music","speech"].includes(V.type)?(ge(),Fe("div",{key:1,class:"relative w-full h-10 flex items-center py-1 px-2 gap-2 overflow-hidden",draggable:"true",onDragstart:C},[ie("div",Va,[Q(H,null,{reference:xe(()=>[ie("audio",{class:"h-10",controls:"",preload:"metadata",src:V.data.url},null,8,Ha)]),default:xe(()=>{var U;return[ie("div",null,B0((U=V.data.meta)==null?void 0:U.prompt),1)]}),_:1})]),ie("div",{class:"bg-red-500 rounded-full w-6 h-6",onClick:q[3]||(q[3]=U=>oe(N).removeResource(V.type,V.data.meta.recordId,V.data.meta.model==="upload"))},[Q(fe,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:xe(()=>[Q(oe(Rt))]),_:1})]),V.noAction?R0("",!0):(ge(),Fe("div",{key:0,class:"bg-blue-500 rounded-full w-6 h-6",onClick:b},[Q(fe,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:xe(()=>[Q(oe(Qt))]),_:1})]))],32)):(ge(),Fe("div",Da,[Q(H,{trigger:"click",placement:"right",width:400},{reference:xe(()=>{var U;return[ie("div",Na,[Q(T,{size:"30"},{default:xe(()=>[Q(oe(I1))]),_:1}),ie("div",Oa,B0((U=V.data.meta)==null?void 0:U.prompt),1)])]}),default:xe(()=>[ie("div",Fa,B0(V.data.result),1),ie("button",{class:"absolute top-4 right-6 bg-night-light",onClick:q[4]||(q[4]=()=>Z(V.data.result))},[Q(T,{size:"18",color:"#1473e6"},{default:xe(()=>[Q(oe(l1))]),_:1})])]),_:1}),ie("div",{class:"absolute top-2 right-1 bg-red-500 rounded-full w-6 h-6 opacity-0 hover:opacity-100 transition-opacity duration-150",onClick:q[5]||(q[5]=U=>oe(N).removeResource(V.type,V.data.meta.recordId))},[Q(fe,{size:16,color:"#fff",class:"cursor-pointer p-1 box-content"},{default:xe(()=>[Q(oe(Rt))]),_:1})])]))}}}),za={class:"w-full flex flex-col mt-2"},Ua={class:"flex flex-row flex-wrap gap-4 w-full"},St=E0({__name:"ResourceList",props:{listData:{},type:{},noAction:{type:Boolean}},setup(ke){return(de,ce)=>(ge(),Fe("div",za,[ie("ul",Ua,[(ge(!0),Fe(k0,null,O0(de.listData,(N,J)=>(ge(),Fe("li",{key:`${N.name}${N.cover}${J}`,class:"flex flex-col max-w-full"},[Q(Pa,{data:N,type:de.type,"no-action":de.noAction},null,8,["data","type","no-action"])]))),128))])]))}}),$a="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='44'%20height='44'%20viewBox='0%200%2044%2044'%20fill='none'%3e%3cpath%20d='M22%204C19.6362%204%2017.2956%204.46558%2015.1117%205.37017C12.9278%206.27475%2010.9435%207.60062%209.27208%209.27208C7.60062%2010.9435%206.27475%2012.9278%205.37017%2015.1117C4.46558%2017.2956%204%2019.6362%204%2022C4%2024.3638%204.46558%2026.7044%205.37017%2028.8883C6.27475%2031.0722%207.60062%2033.0565%209.27208%2034.7279C10.9435%2036.3994%2012.9278%2037.7253%2015.1117%2038.6298C17.2956%2039.5344%2019.6362%2040%2022%2040C26.7739%2040%2031.3523%2038.1036%2034.7279%2034.7279C38.1036%2031.3523%2040%2026.7739%2040%2022C40%2017.2261%2038.1036%2012.6477%2034.7279%209.27208C31.3523%205.89642%2026.7739%204%2022%204ZM0%2022C0%209.85%209.85%200%2022%200C34.15%200%2044%209.85%2044%2022C44%2034.15%2034.15%2044%2022%2044C9.85%2044%200%2034.15%200%2022ZM16%2014V22H12V14H16ZM32%2014V22H28V14H32ZM31.436%2025.56L30.936%2027.5C30.398%2029.59%2029.35%2031.29%2027.71%2032.434C26.098%2033.56%2024.126%2034%2022%2034H20V30H22C23.6%2030%2024.686%2029.666%2025.42%2029.154C26.126%2028.662%2026.714%2027.862%2027.064%2026.502L27.562%2024.564L31.436%2025.56Z'%20fill='%234D5FFF'/%3e%3c/svg%3e",Ga="/assets/thinking-CeJ7EOuC.gif",ja={class:"w-full h-full overflow-hidden flex flex-col items-center gap-4"},Xa={ref:"contentChatText",class:"flex-1 w-full flex flex-col mt-4 overflow-auto gap-4"},Ya={class:"avatar"},qa={key:0,src:$a},Za={key:1,src:Ga},Wa={class:"chat-textbox"},Ka=["onClick"],Qa={key:2,class:"flex items-center mt-2 gap-3"},Ja=["onClick"],er=["onClick"],tr={class:"w-full"},ar={class:"flex items-center w-full gap-2"},rr={class:"w-22"},nr={class:"flex-1"},sr=E0({__name:"TextGenerate",setup(ke){const{toClipboard:de}=p1(),ce=lt(),N=a0(!1),J=a0(""),se=a0(null),C=a0(),b=a0(""),Z=J0({style:"Promotional video",messages:ce.textList}),V=()=>{var T;(T=se.value)==null||T.click()},q=T=>{var U;const ue=(U=T.target.files)==null?void 0:U[0];ue&&(C.value=ue,b.value=ue.name)},ye=async()=>{if(!C.value&&!J.value){V0.warning("请输入文字或上传文件");return}N.value=!0;try{J.value?Z.messages.push({role:"user",content:J.value}):Z.messages.push({role:"user",content:"请解析该文件并扩写"}),Z.messages.push({role:"system",content:"生成中...",loading:1});let T;J.value?T=await N1({style:Z.style,prompt:J.value}):T=await O1(C.value),Z.messages.pop(),Z.messages.push({role:"system",content:T})}finally{C.value=null,J.value="",N.value=!1}},W=async T=>{N.value=!0;try{Z.messages.push({role:"user",content:"请输出分镜头脚本"}),Z.messages.push({role:"system",content:"生成中...",loading:1});const R=await F1(T);Z.messages.pop(),Z.messages.push({role:"system",content:R})}finally{N.value=!1}},fe=async T=>{try{await de(T),V0.success("复制成功")}catch(R){console.error(R)}},H=()=>{Z.messages.pop(),ye()};return V1(()=>ce.textList,()=>{Z.messages=ce.textList},{deep:!0}),(T,R)=>{const ue=P1,U=$0,be=Z0,Ne=h1,Re=ct,De=ut,r0=i1,Ke=ot,l0=j0,qe=X0;return ge(),Fe("div",ja,[ie("div",Xa,[(ge(!0),Fe(k0,null,O0(Z.messages,(_e,P)=>(ge(),Fe("div",{key:P,class:U0(["chat-item text-sm","chat-item-"+_e.role])},[ie("div",Ya,[_e.role==="system"&&!_e.loading?(ge(),Fe("img",qa)):R0("",!0),_e.role==="system"&&_e.loading?(ge(),Fe("img",Za)):R0("",!0),_e.role==="user"?(ge(),A0(U,{key:2,size:"20",class:"mt-[-2px]"},{default:xe(()=>[Q(ue)]),_:1})):R0("",!0)]),ie("div",Wa,[_e.edit?(ge(),A0(be,{key:1,type:"textarea",modelValue:_e.content,"onUpdate:modelValue":o0=>_e.content=o0,autosize:"",onMouseleave:o0=>_e.edit=!1,class:"text-xs text-white w-[250px]"},null,8,["modelValue","onUpdate:modelValue","onMouseleave"])):(ge(),Fe("div",{key:0,class:"text-xs select-text text-white",onClick:o0=>_e.edit=!0},B0(_e.content),9,Ka)),_e.role==="system"?(ge(),Fe("div",Qa,[ie("button",{onClick:()=>fe(_e.content)},[Q(U,{color:"white"},{default:xe(()=>[Q(oe(l1))]),_:1})],8,Ja),P===Z.messages.length-1?(ge(),Fe("button",{key:0,onClick:R[0]||(R[0]=()=>H())},[Q(U,{color:"white"},{default:xe(()=>[Q(oe(H1))]),_:1})])):R0("",!0),ie("button",{onClick:()=>W(_e.content)},[Q(U,{color:"white"},{default:xe(()=>[Q(oe(D1))]),_:1})],8,er)])):R0("",!0)])],2))),128))],512),ie("div",tr,[C.value?(ge(),A0(Ne,{key:0,type:"primary",class:"my-2 text-xs dark:text-white",closable:"",onClose:R[1]||(R[1]=_e=>C.value=null)},{default:xe(()=>[ie("span",null,"上传文件："+B0(b.value),1)]),_:1})):R0("",!0),z0((ge(),Fe("div",ar,[ie("div",rr,[Q(De,{modelValue:Z.style,"onUpdate:modelValue":R[2]||(R[2]=_e=>Z.style=_e),placeholder:"风格"},{default:xe(()=>[Q(Re,{value:"Promotional video",label:"宣传片"}),Q(Re,{value:"Movie",label:"电影"}),Q(Re,{value:"Ad",label:"广告"}),Q(Re,{value:"E-commerce",label:"电商"}),Q(Re,{value:"Custom",label:"自定义"})]),_:1},8,["modelValue"])]),ie("div",nr,[Q(be,{modelValue:J.value,"onUpdate:modelValue":R[3]||(R[3]=_e=>J.value=_e),class:"mr-4",placeholder:C.value?`上传文件：${b.value}`:"输入提示词",disabled:C.value,onKeyup:it(ye,["enter"])},{suffix:xe(()=>[Q(U,{class:"cursor-pointer",size:"18",onClick:V},{default:xe(()=>[Q(r0)]),_:1}),ie("input",{ref_key:"fileInputRef",ref:se,class:"file-input",type:"file",name:"file",accept:".txt, .pdf, .doc, .docx",hidden:"",onChange:q},null,544)]),_:1},8,["modelValue","placeholder","disabled"])]),Q(l0,{class:"dark:bg-purple-heavy",circle:"",onClick:ye},{default:xe(()=>[Q(Ke)]),_:1})])),[[qe,N.value]])])])}}}),lr=Y0(sr,[["__scopeId","data-v-077cb817"]]),ir="/assets/Animal%20Style-SPLSx5eZ.jpg",or="/assets/Photographic-C7RP-Q5A.jpg",cr="/assets/Digital%20Art-ByQ-bzsF.jpg",ur="/assets/Comic%20Book-D976tfHO.jpg",_r="/assets/Fantasy%20Art-CgrBn785.jpg",fr="/assets/Analog%20Film-DEsGCAVQ.jpg",vr="/assets/Neon%20Punk-B0zK9mas.jpg",dr="/assets/Isometric-ZSC2MyD6.jpg",hr="/assets/Low%20Poly-Cp7ce7We.jpg",mr="/assets/Line%20Art-Bfum2pMd.jpg",pr="/assets/Cinematic-h70DiEqR.jpg",br="/assets/3D%20Model-D_rqPM5C.jpg",xr="/assets/Pixel%20Art-Gj3olXpc.jpg",yr="/assets/Graffiti%20Style-DDRDX0fW.jpg",wr="/assets/Advertising%20Poster-D0B4G4tP.jpg",Sr="/assets/Craft%20Clay-BxJ-yc0A.jpg",Cr="data:image/svg+xml,%3csvg%20width='17'%20height='33'%20viewBox='0%200%2017%2033'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M13.4583%2016.5H12.0416V20.625H9.91659V23.375H13.4583V16.5ZM4.95825%2012.375H7.08325V9.625H3.54159V16.5H4.95825V12.375ZM14.8749%204.125H2.12492C1.34575%204.125%200.708252%205.3625%200.708252%206.875V26.125C0.708252%2027.6375%201.34575%2028.875%202.12492%2028.875H14.8749C15.6541%2028.875%2016.2916%2027.6375%2016.2916%2026.125V6.875C16.2916%205.3625%2015.6541%204.125%2014.8749%204.125ZM14.8749%2026.1388H2.12492V6.86125H14.8749V26.1388Z'%20fill='%23969696'%20/%3e%3c/svg%3e",gr="data:image/svg+xml,%3csvg%20width='23'%20height='33'%20viewBox='0%200%2023%2033'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18.2083%2016.5H16.2916V20.625H13.4166V23.375H18.2083V16.5ZM6.70825%2012.375H9.58325V9.625H4.79159V16.5H6.70825V12.375ZM20.1249%204.125H2.87492C1.82075%204.125%200.958252%205.3625%200.958252%206.875V26.125C0.958252%2027.6375%201.82075%2028.875%202.87492%2028.875H20.1249C21.1791%2028.875%2022.0416%2027.6375%2022.0416%2026.125V6.875C22.0416%205.3625%2021.1791%204.125%2020.1249%204.125ZM20.1249%2026.1388H2.87492V6.86125H20.1249V26.1388Z'%20fill='%23969696'%20/%3e%3c/svg%3e",Mr="data:image/svg+xml,%3csvg%20width='27'%20height='33'%20viewBox='0%200%2027%2033'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M21.375%2016.5H19.125V20.625H15.75V23.375H21.375V16.5ZM7.875%2012.375H11.25V9.625H5.625V16.5H7.875V12.375ZM23.625%204.125H3.375C2.1375%204.125%201.125%205.3625%201.125%206.875V26.125C1.125%2027.6375%202.1375%2028.875%203.375%2028.875H23.625C24.8625%2028.875%2025.875%2027.6375%2025.875%2026.125V6.875C25.875%205.3625%2024.8625%204.125%2023.625%204.125ZM23.625%2026.1388H3.375V6.86125H23.625V26.1388Z'%20fill='%23969696'%20/%3e%3c/svg%3e",Ar="data:image/svg+xml,%3csvg%20width='26'%20height='22'%20viewBox='0%200%2026%2022'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M20.5833%2011H18.4166V13.75H15.1666V15.5833H20.5833V11ZM7.58325%208.25H10.8333V6.41667H5.41659V11H7.58325V8.25ZM22.7499%202.75H3.24992C2.05825%202.75%201.08325%203.575%201.08325%204.58333V17.4167C1.08325%2018.425%202.05825%2019.25%203.24992%2019.25H22.7499C23.9416%2019.25%2024.9166%2018.425%2024.9166%2017.4167V4.58333C24.9166%203.575%2023.9416%202.75%2022.7499%202.75ZM22.7499%2017.4258H3.24992V4.57417H22.7499V17.4258Z'%20fill='%23969696'%20/%3e%3c/svg%3e",kr="data:image/svg+xml,%3csvg%20width='31'%20height='22'%20viewBox='0%200%2031%2022'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M24.5418%2011H21.9584V13.75H18.0834V15.5833H24.5418V11ZM9.04175%208.25H12.9167V6.41667H6.45842V11H9.04175V8.25ZM27.1251%202.75H3.87508C2.45425%202.75%201.29175%203.575%201.29175%204.58333V17.4167C1.29175%2018.425%202.45425%2019.25%203.87508%2019.25H27.1251C28.5459%2019.25%2029.7084%2018.425%2029.7084%2017.4167V4.58333C29.7084%203.575%2028.5459%202.75%2027.1251%202.75ZM27.1251%2017.4258H3.87508V4.57417H27.1251V17.4258Z'%20fill='%23969696'%20/%3e%3c/svg%3e",Tr="data:image/svg+xml,%3csvg%20width='35'%20height='22'%20viewBox='0%200%2035%2022'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M28.6364%2011H25.4545V14.6667H20.6818V17.1111H28.6364V11ZM9.54545%207.33333H14.3182V4.88889H6.36364V11H9.54545V7.33333ZM31.8182%200H3.18182C1.43182%200%200%201.1%200%202.44444V19.5556C0%2020.9%201.43182%2022%203.18182%2022H31.8182C33.5682%2022%2035%2020.9%2035%2019.5556V2.44444C35%201.1%2033.5682%200%2031.8182%200ZM31.8182%2019.5678H3.18182V2.43222H31.8182V19.5678Z'%20fill='%23969696'%20/%3e%3c/svg%3e",w2={draggable:!0,resizable:!1,scalable:!0,dragArea:!1,origin:!1,snappable:!0,stopPropagation:!0,snapThreshold:5,isDisplaySnapDigit:!0,snapGap:!0,snapElement:!0,snapCenter:!0,snapDigit:10,snapVertical:!0,snapHorizontal:!0,throttleDrag:1,throttleResize:1,throttleScale:.01,keepRatio:!0,renderDirections:["nw","ne","se","sw"],rotatable:!1,throttleRotate:.2,elementGuidelines:[],pinchable:!1},Er=[{value:"Anime Style",text:"动画风格",img:ir},{value:"Photographic",text:"照片摄影",img:or},{value:"Digital Art",text:"数字艺术",img:cr},{value:"Comic Book",text:"漫画书",img:ur},{value:"Fantasy Ar",text:"奇幻艺术",img:_r},{value:"Analog Film",text:"模拟胶片",img:fr},{value:"Neon Punk",text:"霓虹朋克",img:vr},{value:"Isometric",text:"等轴测投影",img:dr},{value:"Low Poly",text:"低聚物",img:hr},{value:"Line Art",text:"线条艺术",img:mr},{value:"Cinematic",text:"电影风格",img:pr},{value:"3D Model",text:"3D模型",img:br},{value:"Pixel Art",text:"像素艺术",img:xr},{value:"Graffiti Style",text:"涂鸦风格",img:yr},{value:"Advertising Poster",text:"广告风格",img:wr},{value:"Craft Clay",text:"粘土风格",img:Sr}],It=[{text:"9:16",img:Cr,value:"(768, 1344)"},{text:"3:4",img:gr,value:"(832, 1152)"},{text:"1:1",img:Mr,value:"(1024, 1024)"},{text:"4:3",img:Ar,value:"(1152, 896)"},{text:"16:9",img:kr,value:"(1344, 768)"},{text:"21:9",img:Tr,value:"(1536, 640)"}],Br=[{text:"电子音乐",value:"Electronic music"},{text:"小调",value:"Minor music"},{text:"恐怖音乐",value:"Horror music"},{text:"梦幻音乐",value:"Fantasy music"},{text:"鼓点音乐",value:"Drumbeat music"},{text:"电影配乐",value:"Movie score"},{text:"先锋音乐",value:"Pioneer Music"},{text:"伤感风",value:"Sad music "},{text:"爵士",value:"Jazz"},{text:"摇滚乐",value:"Rock music"},{text:"极简主义",value:"Minimalist music"},{text:"钢琴曲",value:"Piano"}],Rr=[90,60,30,16,8,4],S2=[{value:"#b80000",label:"深红色"},{value:"#db3e00",label:"橙红色"},{value:"#fccb00",label:"亮黄色"},{value:"#008b02",label:"深绿色"},{value:"#006b76",label:"深青色"},{value:"#1273de",label:"蓝色"},{value:"#004dcf",label:"深蓝色"},{value:"#5300eb",label:"深紫色"},{value:"#eb9694",label:"浅粉色"},{value:"#fad0c3",label:"浅肉色"},{value:"#fef3bd",label:"浅黄色"},{value:"#c1e1c5",label:"浅草绿色"},{value:"#bedadc",label:"浅蓝绿色"},{value:"#c4def6",label:"浅蓝色"},{value:"#bed3f3",label:"浅蓝紫色"}],Ir=["动画风格","照片摄影","数字艺术","漫画书","奇幻艺术","模拟胶片","霓虹朋克","等轴测投影","低聚物","线条艺术","电影风格","3D模型","像素艺术","涂鸦风格","广告风格","粘土风格"],Lr={class:"w-full h-full overflow-hidden flex flex-col items-center gap-4"},Vr={class:"flex-1 w-full overflow-auto"},Hr={class:"flex items-center w-full gap-2"},Dr={class:"w-32"},Nr={class:"grid-container2"},Or=["onClick"],Fr={class:"grid-container"},Pr=["onClick"],zr=["src"],Ur=E0({__name:"ImageGenerate",setup(ke){const de=lt(),ce=o1(),N=a0(!1),J=J0({prompt:"",sizeStr:"(768, 1344)",samples:1,color:"",keywords:[],model:"kolor"}),se=async()=>{if(!J.prompt){V0.error("请输入文字描述");return}N.value=!0;try{const b=await z1(J);de.imageList.push(...b)}finally{N.value=!1}},C=b=>{J.keywords.includes(b)?J.keywords=J.keywords.filter(Z=>Z!=b):J.keywords.push(b)};return(b,Z)=>{const V=ct,q=ut,ye=c1,W=$0,fe=wt,H=u1,T=Z0,R=ot,ue=j0,U=X0;return ge(),Fe("div",Lr,[ie("div",Vr,[Q(St,{"list-data":oe(de).imageList,type:"image"},null,8,["list-data"])]),z0((ge(),Fe("div",Hr,[ie("div",Dr,[Q(q,{modelValue:J.model,"onUpdate:modelValue":Z[0]||(Z[0]=be=>J.model=be),placeholder:""},{default:xe(()=>[(ge(!0),Fe(k0,null,O0(oe(ce).savedModelList,be=>(ge(),A0(V,{key:be.modelUuid,value:be.modelUuid,label:be.modelName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),Q(T,{modelValue:J.prompt,"onUpdate:modelValue":Z[1]||(Z[1]=be=>J.prompt=be),placeholder:"请输入提示词",onKeyup:it(se,["enter"])},{suffix:xe(()=>[Q(fe,{trigger:"click",width:"280"},{reference:xe(()=>[Q(W,{size:18,class:"cursor-pointer mr-2"},{default:xe(()=>[Q(ye)]),_:1})]),default:xe(()=>[ie("div",Nr,[(ge(!0),Fe(k0,null,O0(oe(Ir),(be,Ne)=>(ge(),Fe("div",{key:Ne,class:"item",onClick:Re=>C(be)},[ie("span",{class:U0(["text",{active:J.keywords.includes(be)}])},B0(be),3)],8,Or))),128))])]),_:1}),Q(fe,{trigger:"click"},{reference:xe(()=>[Q(W,{size:18,class:"cursor-pointer"},{default:xe(()=>[Q(H)]),_:1})]),default:xe(()=>[ie("div",Fr,[(ge(!0),Fe(k0,null,O0(oe(It),(be,Ne)=>(ge(),Fe("div",{key:Ne,class:"item",onClick:Re=>J.sizeStr=be.value},[ie("img",{class:"icon",src:be.img},null,8,zr),ie("span",{class:U0(["text",{active:be.value==J.sizeStr}])},B0(be.text),3)],8,Pr))),128))])]),_:1})]),_:1},8,["modelValue"]),Q(ue,{class:"dark:bg-purple-heavy",circle:"",onClick:se},{default:xe(()=>[Q(R)]),_:1})])),[[U,N.value]])])}}}),b1=Y0(Ur,[["__scopeId","data-v-d5df35b8"]]),$r={class:"w-full flex-1 overflow-hidden flex flex-col items-center gap-4"},Gr={class:"flex-1 w-full overflow-auto"},jr={class:"flex items-center w-full gap-2"},Xr={class:"w-20"},Yr={class:"flex-1"},qr=["onClick"],Zr=E0({__name:"MusicGenerate",setup(ke){const de=lt(),ce=a0(!1),N=J0({prompt:"",style:"Electronic music",len:4}),J=async()=>{if(!N.prompt){V0.error("请输入文字描述");return}ce.value=!0;try{const se=await U1(N);de.audioList.push(se)}finally{ce.value=!1}};return(se,C)=>{const b=St,Z=ct,V=ut,q=$1,ye=$0,W=wt,fe=Z0,H=ot,T=j0,R=X0;return ge(),Fe("div",$r,[ie("div",Gr,[Q(b,{"list-data":oe(de).audioList,type:"music"},null,8,["list-data"])]),z0((ge(),Fe("div",jr,[ie("div",Xr,[Q(V,{modelValue:N.style,"onUpdate:modelValue":C[0]||(C[0]=ue=>N.style=ue),placeholder:"风格"},{default:xe(()=>[(ge(!0),Fe(k0,null,O0(oe(Br),(ue,U)=>(ge(),A0(Z,{key:U,value:ue.value,label:ue.text},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),ie("div",Yr,[Q(fe,{modelValue:N.prompt,"onUpdate:modelValue":C[1]||(C[1]=ue=>N.prompt=ue),placeholder:"请输入提示词",onKeyup:it(J,["enter"])},{suffix:xe(()=>[Q(W,{trigger:"click",width:80},{reference:xe(()=>[Q(ye,{size:18,class:"cursor-pointer"},{default:xe(()=>[Q(q)]),_:1})]),default:xe(()=>[ie("div",null,[(ge(!0),Fe(k0,null,O0(oe(Rr),(ue,U)=>(ge(),Fe("div",{class:U0(["time-text m-2 cursor-pointer",{active:ue==N.len}]),key:U,onClick:be=>N.len=ue},B0(ue)+"s ",11,qr))),128))])]),_:1})]),_:1},8,["modelValue"])]),Q(T,{class:"dark:bg-purple-heavy",circle:"",onClick:J},{default:xe(()=>[Q(H)]),_:1})])),[[R,ce.value]])])}}}),x1=Y0(Zr,[["__scopeId","data-v-6c1f8eda"]]),Wr={class:"w-full h-full overflow-hidden flex flex-col items-center gap-4"},Kr={class:"flex-1 w-full overflow-auto"},Qr={class:"w-full"},Jr=["title"],en={class:"flex items-center w-full gap-2"},tn={class:"grid-container2"},an=["onClick"],rn=["src"],nn={class:"grid-container"},sn=["onClick"],ln=["src"],on=E0({__name:"VideoGenerate",setup(ke){const de=lt(),ce=a0(!1),N=a0(null),J=a0(""),se=J0({prompt:"",imageUrl:"",sizeStr:It[0].value,style:"Anime Style"}),C=()=>{var V;(V=N.value)==null||V.click()},b=async V=>{var W;const ye=(W=V.target.files)==null?void 0:W[0];if(ye){const fe=await _1();J.value=ye.name,se.imageUrl=fe.url}},Z=async()=>{if(!se.prompt){V0.error("请输入文字描述");return}ce.value=!0;try{let V;se.imageUrl?V=await G1(se):V=await j1(se),de.videoList.push(V)}finally{ce.value=!1}};return(V,q)=>{const ye=St,W=h1,fe=i1,H=$0,T=c1,R=wt,ue=u1,U=Z0,be=ot,Ne=j0,Re=X0;return ge(),Fe("div",Wr,[ie("div",Kr,[Q(ye,{"list-data":oe(de).videoList,type:"video"},null,8,["list-data"])]),ie("div",Qr,[oe(se).imageUrl?(ge(),A0(W,{key:0,type:"primary",class:"my-2 text-xs dark:text-white",closable:"",onClose:q[0]||(q[0]=De=>oe(se).imageUrl="")},{default:xe(()=>[ie("span",{title:oe(J),class:"inline-block max-w-[300px] overflow-ellipsis overflow-hidden whitespace-nowrap"},"上传文件："+B0(oe(J)),9,Jr)]),_:1})):R0("",!0),z0((ge(),Fe("div",en,[Q(U,{modelValue:oe(se).prompt,"onUpdate:modelValue":q[1]||(q[1]=De=>oe(se).prompt=De),placeholder:"请输入提示词",onKeyup:it(Z,["enter"])},{suffix:xe(()=>[Q(H,{class:"cursor-pointer mr-2",size:"18",onClick:C},{default:xe(()=>[Q(fe)]),_:1}),ie("input",{ref_key:"fileInputRef",ref:N,class:"file-input",type:"file",name:"file",accept:"image/*",hidden:"",onChange:b},null,544),Q(R,{trigger:"click",width:"325"},{reference:xe(()=>[Q(H,{size:18,class:"cursor-pointer mr-2"},{default:xe(()=>[Q(T)]),_:1})]),default:xe(()=>[ie("div",tn,[(ge(!0),Fe(k0,null,O0(oe(Er),(De,r0)=>(ge(),Fe("div",{key:r0,class:"item",onClick:Ke=>oe(se).style=De.value},[ie("img",{class:"img",src:De.img},null,8,rn),ie("span",{class:U0(["text",{active:De.value==oe(se).style}])},B0(De.text),3)],8,an))),128))])]),_:1}),Q(R,{trigger:"click"},{reference:xe(()=>[Q(H,{size:18,class:"cursor-pointer"},{default:xe(()=>[Q(ue)]),_:1})]),default:xe(()=>[ie("div",nn,[(ge(!0),Fe(k0,null,O0(oe(It),(De,r0)=>(ge(),Fe("div",{key:r0,class:"item",onClick:Ke=>oe(se).sizeStr=De.value},[ie("img",{class:"icon",src:De.img},null,8,ln),ie("span",{class:U0(["text",{active:De.value==oe(se).sizeStr}])},B0(De.text),3)],8,sn))),128))])]),_:1})]),_:1},8,["modelValue"]),Q(Ne,{class:"dark:bg-purple-heavy",circle:"",onClick:Z},{default:xe(()=>[Q(be)]),_:1})])),[[Re,oe(ce)]])])])}}}),y1=Y0(on,[["__scopeId","data-v-0c693297"]]);var w1={exports:{}};(function(ke){(function(de){var ce=typeof window=="object"&&!!window.document,N=ce?window:Object;de(N,ce),ke.exports&&(ke.exports=N.Recorder)})(function(de,ce){var N=function(){},J=function(v){return typeof v=="number"},se=function(v){return JSON.stringify(v)},C=function(v){return new S0(v)},b=C.LM="2024-10-20 22:15",Z="https://github.com/xiangyuecn/Recorder",V="Recorder",q="getUserMedia",ye="srcSampleRate",W="sampleRate",fe="bitRate",H="catch",T=de[V];if(T&&T.LM==b){T.CLog(T.i18n.$T("K8zP::重复导入{1}",0,V),3);return}C.IsOpen=function(){var v=C.Stream;if(v){var x=o0(v),a=x[0];if(a){var O=a.readyState;return O=="live"||O==a.LIVE}}return!1},C.BufferSize=4096,C.Destroy=function(){je(V+" Destroy"),_e();for(var v in R)R[v]()};var R={};C.BindDestroy=function(v,x){R[v]=x},C.Support=function(){if(!ce)return!1;var v=navigator.mediaDevices||{};return v[q]||(v=navigator,v[q]||(v[q]=v.webkitGetUserMedia||v.mozGetUserMedia||v.msGetUserMedia)),!(!v[q]||(C.Scope=v,!C.GetContext()))},C.GetContext=function(v){if(!ce)return null;var x=window.AudioContext;if(x||(x=window.webkitAudioContext),!x)return null;var a=C.Ctx,O=0;return a||(a=C.Ctx=new x,O=1,C.NewCtxs=C.NewCtxs||[],C.BindDestroy("Ctx",function(){var ee=C.Ctx;ee&&ee.close&&(ue(ee),C.Ctx=0);var me=C.NewCtxs;C.NewCtxs=[];for(var he=0;he<me.length;he++)ue(me[he])})),v&&a.close&&(O||(a._useC||ue(a),a=new x),a._useC=1,C.NewCtxs.push(a)),a},C.CloseNewCtx=function(v){if(v&&v.close){ue(v);for(var x=C.NewCtxs||[],a=x.length,O=0;O<x.length;O++)if(x[O]==v){x.splice(O,1);break}je(Y("mSxV::剩{1}个GetContext未close",0,a+"-1="+x.length),x.length?3:0)}};var ue=function(v){if(v&&v.close&&!v._isC&&(v._isC=1,v.state!="closed"))try{v.close()}catch(x){je("ctx close err",1,x)}},U=C.ResumeCtx=function(v,x,a,O){var ee=0,me=0,he=0,Ie=0,Le="EventListener",Ve="ResumeCtx ",Me=function(e0,Pe){me&&v0(),ee||(ee=1,e0&&O(e0,Ie),Pe&&a(Ie)),Pe&&(!v._LsSC&&v["add"+Le]&&v["add"+Le]("statechange",Ze),v._LsSC=1,he=1)},v0=function(e0){if(!(e0&&me)){me=e0?1:0;for(var Pe=["focus","mousedown","mouseup","touchstart","touchend"],s0=0;s0<Pe.length;s0++)window[(e0?"add":"remove")+Le](Pe[s0],Ze,!0)}},Ze=function(){var e0=v.state,Pe=be(e0);if(!ee&&!x(Pe?++Ie:Ie))return Me();Pe?(he&&je(Ve+"sc "+e0,3),v0(1),v.resume().then(function(){he&&je(Ve+"sc "+v.state),Me(0,1)})[H](function(s0){je(Ve+"error",1,s0),be(v.state)||Me(s0.message||"error")})):e0=="closed"?(he&&!v._isC&&je(Ve+"sc "+e0,1),Me("ctx closed")):Me(0,1)};Ze()},be=C.CtxSpEnd=function(v){return v=="suspended"||v=="interrupted"},Ne=function(v){var x=v.state,a="ctx.state="+x;return be(x)&&(a+=Y("nMIy::（注意：ctx不是running状态，rec.open和start至少要有一个在用户操作(触摸、点击等)时进行调用，否则将在rec.start时尝试进行ctx.resume，可能会产生兼容性问题(仅iOS)，请参阅文档中runningContext配置）")),a},Re="ConnectEnableWebM";C[Re]=!0;var De="ConnectEnableWorklet";C[De]=!1;var r0=function(v){var x=v.BufferSize||C.BufferSize,a=v.Stream,O=a._c,ee=O[W],me={},he=o0(a),Ie=he[0],Le=null,Ve="";if(Ie&&Ie.getSettings){Le=Ie.getSettings();var Me=Le[W];Me&&Me!=ee&&(Ve=Y("eS8i::Stream的采样率{1}不等于{2}，将进行采样率转换（注意：音质不会变好甚至可能变差），主要在移动端未禁用回声消除时会产生此现象，浏览器有回声消除时可能只会返回16k采样率的音频数据，",0,Me,ee))}a._ts=Le,je(Ve+"Stream TrackSet: "+se(Le),Ve?3:0);var v0=function(g){var e=a._m=O.createMediaStreamSource(a),l=O.destination,h="createMediaStreamDestination";O[h]&&(l=a._d=O[h]()),e.connect(g),g.connect(l)},Ze,e0,Pe,s0="",f=a._call,D=function(g,e){for(var l in f){if(e!=ee){me.index=0,me=C.SampleData([g],e,ee,me,{_sum:1});var h=me.data,E=me._sum}else{me={};for(var d=g.length,h=new Int16Array(d),E=0,i=0;i<d;i++){var u=Math.max(-1,Math.min(1,g[i]));u=u<0?u*32768:u*32767,h[i]=u,E+=Math.abs(u)}}for(var s in f)f[s](h,E);return}},z="ScriptProcessor",S="audioWorklet",le=V+" "+S,p="RecProc",M="MediaRecorder",te=M+".WebM.PCM",I=O.createScriptProcessor||O.createJavaScriptNode,K=Y("ZGlf::。由于{1}内部1秒375次回调，在移动端可能会有性能问题导致回调丢失录音变短，PC端无影响，暂不建议开启{1}。",0,S),w=function(){e0=a.isWorklet=!1,l0(a),je(Y("7TU0::Connect采用老的{1}，",0,z)+Be.get(C[De]?Y("JwCL::但已设置{1}尝试启用{2}",2):Y("VGjB::可设置{1}尝试启用{2}",2),[V+"."+De+"=true",S])+s0+K,3);var g=a._p=I.call(O,x,1,1);v0(g),g.onaudioprocess=function(e){var l=e.inputBuffer.getChannelData(0);D(l,ee)}},ae=function(){Ze=a.isWebM=!1,qe(a),e0=a.isWorklet=!I||C[De];var g=window.AudioWorkletNode;if(!(e0&&O[S]&&g)){w();return}var e=function(){var i=function(s){return s.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,le)},u="class "+p+" extends AudioWorkletProcessor{";return u+="constructor "+i(function(s){DEL_super(s);var y=this,r=s.processorOptions.bufferSize;y.bufferSize=r,y.buffer=new Float32Array(r*2),y.pos=0,y.port.onmessage=function(F){F.data.kill&&(y.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",s)}),u+="process "+i(function(s,y,r){var F=this,o=F.bufferSize,c=F.buffer,_=F.pos;if(s=(s[0]||[])[0]||[],s.length){c.set(s,_),_+=s.length;var m=~~(_/o)*o;if(m){this.port.postMessage({val:c.slice(0,m)});var k=c.subarray(m,_);c=new Float32Array(o*2),c.set(k),_=k.length,F.buffer=c}F.pos=_}return!F.kill}),u+='}try{registerProcessor("'+p+'", '+p+')}catch(e){$C.error("'+le+' Reg Error",e)}',u=u.replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(u)))},l=function(){return e0&&a._na},h=a._na=function(){Pe!==""&&(clearTimeout(Pe),Pe=setTimeout(function(){Pe=0,l()&&(je(Y("MxX1::{1}未返回任何音频，恢复使用{2}",0,S,z),3),I&&w())},500))},E=function(){if(l()){var i=a._n=new g(O,p,{processorOptions:{bufferSize:x}});v0(i),i.port.onmessage=function(u){Pe&&(clearTimeout(Pe),Pe=""),l()?D(u.data.val,ee):e0||je(Y("XUap::{1}多余回调",0,S),3)},je(Y("yOta::Connect采用{1}，设置{2}可恢复老式{3}",0,S,V+"."+De+"=false",z)+s0+K,3)}},d=function(){if(l()){if(O[p]){E();return}var i=e();O[S].addModule(i).then(function(u){l()&&(O[p]=1,E(),Pe&&h())})[H](function(u){je(S+".addModule Error",1,u),l()&&w()})}};U(O,function(){return l()},d,d)},A=function(){var g=window[M],e="ondataavailable",l="audio/webm; codecs=pcm";Ze=a.isWebM=C[Re];var h=g&&e in g.prototype&&g.isTypeSupported(l);if(s0=h?"":Y("VwPd::（此浏览器不支持{1}）",0,te),!Ze||!h){ae();return}var E=function(){return Ze&&a._ra};a._ra=function(){Pe!==""&&(clearTimeout(Pe),Pe=setTimeout(function(){E()&&(je(Y("vHnb::{1}未返回任何音频，降级使用{2}",0,M,S),3),ae())},500))};var d=Object.assign({mimeType:l},C.ConnectWebMOptions),i=a._r=new g(a,d),u=a._rd={};i[e]=function(s){var y=new FileReader;y.onloadend=function(){if(E()){var r=L0(new Uint8Array(y.result),u);if(!r)return;if(r==-1){ae();return}Pe&&(clearTimeout(Pe),Pe=""),D(r,u.webmSR)}else Ze||je(Y("O9P7::{1}多余回调",0,M),3)},y.readAsArrayBuffer(s.data)},i.start(~~(x/48)),je(Y("LMEm::Connect采用{1}，设置{2}可恢复使用{3}或老式{4}",0,te,V+"."+Re+"=false",S,z))};A()},Ke=function(v){v._na&&v._na(),v._ra&&v._ra()},l0=function(v){v._na=null,v._n&&(v._n.port.postMessage({kill:!0}),v._n.disconnect(),v._n=null)},qe=function(v){if(v._ra=null,v._r){try{v._r.stop()}catch(x){je("mr stop err",1,x)}v._r=null}},_e=function(v){v=v||C;var x=v==C,a=v.Stream;a&&(a._m&&(a._m.disconnect(),a._m=null),!a._RC&&a._c&&C.CloseNewCtx(a._c),a._RC=null,a._c=null,a._d&&(P(a._d.stream),a._d=null),a._p&&(a._p.disconnect(),a._p.onaudioprocess=a._p=null),l0(a),qe(a),x&&P(a)),v.Stream=0},P=C.StopS_=function(v){for(var x=o0(v),a=0;a<x.length;a++){var O=x[a];O.stop&&O.stop()}v.stop&&v.stop()},o0=function(v){var x=0,a=0,O=[];v.getAudioTracks&&(x=v.getAudioTracks(),a=v.getVideoTracks()),x||(x=v.audioTracks,a=v.videoTracks);for(var ee=0,me=x?x.length:0;ee<me;ee++)O.push(x[ee]);for(var ee=0,me=a?a.length:0;ee<me;ee++)O.push(a[ee]);return O};C.SampleData=function(v,x,a,O,ee){var me="SampleData";O||(O={});var he=O.index||0,Ie=O.offset||0,Le=O.raisePrev||0,Ve=O.filter;if(Ve&&Ve.fn&&(Ve.sr&&Ve.sr!=x||Ve.srn&&Ve.srn!=a)&&(Ve=null,je(Y("d48C::{1}的filter采样率变了，重设滤波",0,me),3)),!Ve)if(a<=x){var Me=a>x*3/4?0:a/2*3/4;Ve={fn:Me?C.IIRFilter(!0,x,Me):0}}else{var Me=x>a*3/4?0:x/2*3/4;Ve={fn:Me?C.IIRFilter(!0,a,Me):0}}Ve.sr=x,Ve.srn=a;var v0=Ve.fn,Ze=O.frameNext||[];ee||(ee={});var e0=ee.frameSize||1;ee.frameType&&(e0=ee.frameType=="mp3"?1152:1);var Pe=ee._sum,s0=0,f=v.length;he>f+1&&je(Y("tlbC::{1}似乎传入了未重置chunk {2}",0,me,he+">"+f),3);for(var D=0,z=he;z<f;z++)D+=v[z].length;var S=x/a;if(S>1)D=Math.max(0,D-Math.floor(Ie)),D=Math.floor(D/S);else if(S<1){var le=1/S;D=Math.floor(D*le)}D+=Ze.length;for(var p=new Int16Array(D),M=0,z=0;z<Ze.length;z++)p[M]=Ze[z],M++;for(;he<f;he++){var te=v[he],I=te instanceof Float32Array,z=Ie,K=te.length,w=v0&&v0.Embed,ae=0,A=0,g=0,e=0;if(S<1){for(var l=M+z,h=Le,E=0;E<K;E++){var d=te[E];I&&(d=Math.max(-1,Math.min(1,d)),d=d<0?d*32768:d*32767);var i=Math.floor(l);l+=le;for(var u=Math.floor(l),s=(d-h)/(u-i),y=1;i<u;i++,y++){var r=Math.floor(h+y*s);w?(g=r,e=w.b0*g+w.b1*w.x1+w.b0*w.x2-w.a1*w.y1-w.a2*w.y2,w.x2=w.x1,w.x1=g,w.y2=w.y1,w.y1=e,r=e):r=v0?v0(r):r,r>32767?r=32767:r<-32768&&(r=-32768),Pe&&(s0+=Math.abs(r)),p[i]=r,M++}h=Le=d,z+=le}Ie=z%1;continue}for(var E=0,F=0;E<K;E++,F++){if(F<K){var d=te[F];I&&(d=Math.max(-1,Math.min(1,d)),d=d<0?d*32768:d*32767),w?(g=d,e=w.b0*g+w.b1*w.x1+w.b0*w.x2-w.a1*w.y1-w.a2*w.y2,w.x2=w.x1,w.x1=g,w.y2=w.y1,w.y1=e):e=v0?v0(d):d}if(ae=A,A=e,F==0){E--;continue}var o=Math.floor(z);if(E==o){var c=Math.ceil(z),_=z-o,m=ae,k=c<K?A:m,t=m+(k-m)*_;t>32767?t=32767:t<-32768&&(t=-32768),Pe&&(s0+=Math.abs(t)),p[M]=t,M++,z+=S}}Ie=Math.max(0,z-K)}S<1&&M+1==D&&(D--,p=new Int16Array(p.buffer.slice(0,D*2))),M-1!=D&&M!=D&&je(me+" idx:"+M+" != size:"+D,3),Ze=null;var n=D%e0;if(n>0){var G=(D-n)*2;Ze=new Int16Array(p.buffer.slice(G)),p=new Int16Array(p.buffer.slice(0,G))}var B={index:he,offset:Ie,raisePrev:Le,filter:Ve,frameNext:Ze,sampleRate:a,data:p};return Pe&&(B._sum=s0),B},C.IIRFilter=function(v,x,a){var O=2*Math.PI*a/x,ee=Math.sin(O),me=Math.cos(O),he=ee/2,Ie=1+he,Le=-2*me/Ie,Ve=(1-he)/Ie;if(v)var Me=(1-me)/2/Ie,v0=(1-me)/Ie;else var Me=(1+me)/2/Ie,v0=-(1+me)/Ie;var Ze=0,e0=0,Pe=0,s0=0,f=0,D=function(z){return Pe=Me*z+v0*Ze+Me*e0-Le*s0-Ve*f,e0=Ze,Ze=z,f=s0,s0=Pe,Pe};return D.Embed={x1:0,x2:0,y1:0,y2:0,b0:Me,b1:v0,a1:Le,a2:Ve},D},C.PowerLevel=function(v,x){var a=v/x||0,O;return a<1251?O=Math.round(a/1250*10):O=Math.round(Math.min(100,Math.max(0,(1+Math.log(a/1e4)/Math.log(10))*100))),O},C.PowerDBFS=function(v){var x=Math.max(.1,v||0),a=32767;return x=Math.min(x,a),x=20*Math.log(x/a)/Math.log(10),Math.max(-100,Math.round(x))},C.CLog=function(v,x){if(typeof console=="object"){var a=new Date,O=("0"+a.getMinutes()).substr(-2)+":"+("0"+a.getSeconds()).substr(-2)+"."+("00"+a.getMilliseconds()).substr(-3),ee=this&&this.envIn&&this.envCheck&&this.id,me=["["+O+" "+V+(ee?":"+ee:"")+"]"+v],he=arguments,Ie=C.CLog,Le=2,Ve=Ie.log||console.log;for(J(x)?Ve=x==1?Ie.error||console.error:x==3?Ie.warn||console.warn:Ve:Le=1;Le<he.length;Le++)me.push(he[Le]);Je?Ve&&Ve("[IsLoser]"+me[0],me.length>1?me:""):Ve.apply(console,me)}};var je=function(){C.CLog.apply(this,arguments)},Je=!0;try{Je=!console.log.apply}catch{}var H0=0;function S0(v){var x=this;x.id=++H0,Qe();var a={type:"mp3",onProcess:N};for(var O in v)a[O]=v[O];x.set=a;var ee=a[fe],me=a[W];(ee&&!J(ee)||me&&!J(me))&&x.CLog(Y.G("IllegalArgs-1",[Y("VtS4::{1}和{2}必须是数值",0,W,fe)]),1,v),a[fe]=+ee||16,a[W]=+me||16e3,x.state=0,x._S=9,x.Sync={O:9,C:9}}C.Sync={O:9,C:9},C.prototype=S0.prototype={CLog:je,_streamStore:function(){return this.set.sourceStream?this:C},_streamGet:function(){return this._streamStore().Stream},_streamCtx:function(){var v=this._streamGet();return v&&v._c},open:function(v,x){var a=this,O=a.set,ee=a._streamStore(),me=0;v=v||N;var he=function(M,te){te=!!te,a.CLog(Y("5tWi::录音open失败：")+M+",isUserNotAllow:"+te,1),me&&C.CloseNewCtx(me),x&&x(M,te)};a._streamTag=q;var Ie=function(){a.CLog("open ok, id:"+a.id+" stream:"+a._streamTag),v(),a._SO=0},Le=ee.Sync,Ve=++Le.O,Me=Le.C;a._O=a._O_=Ve,a._SO=a._S;var v0=function(){if(Me!=Le.C||!a._O){var M=Y("dFm8::open被取消");return Ve==Le.O?a.close():M=Y("VtJO::open被中断"),he(M),!0}};if(!ce){he(Y.G("NonBrowser-1",["open"])+Y("EMJq::，可尝试使用RecordApp解决方案")+"("+Z+"/tree/master/app-support-sample)");return}var Ze=a.envCheck({envName:"H5",canProcess:!0});if(Ze){he(Y("A5bm::不能录音：")+Ze);return}var e0,Pe=function(){e0=O.runningContext,e0||(e0=me=C.GetContext(!0))};if(O.sourceStream){if(a._streamTag="set.sourceStream",!C.GetContext()){he(Y("1iU7::不支持此浏览器从流中获取录音"));return}Pe(),_e(ee);var s0=a.Stream=O.sourceStream;s0._c=e0,s0._RC=O.runningContext,s0._call={};try{r0(ee)}catch(M){_e(ee),he(Y("BTW2::从流中打开录音失败：")+M.message);return}Ie();return}var f=function(M,te){try{window.top.a}catch{he(Y("Nclz::无权录音(跨域，请尝试给iframe添加麦克风访问策略，如{1})",0,'allow="camera;microphone"'));return}D(1,M)&&(/Found/i.test(M)?he(te+Y("jBa9::，无可用麦克风")):he(te))},D=function(M,te){if(/Permission|Allow/i.test(te))M&&he(Y("gyO5::用户拒绝了录音权限"),!0);else if(window.isSecureContext===!1)M&&he(Y("oWNo::浏览器禁止不安全页面录音，可开启https解决"));else return 1};if(C.IsOpen()){Ie();return}if(!C.Support()){f("",Y("COxc::此浏览器不支持录音"));return}Pe();var z=function(M){setTimeout(function(){M._call={};var te=C.Stream;te&&(_e(),M._call=te._call),C.Stream=M,M._c=e0,M._RC=O.runningContext,!v0()&&(C.IsOpen()?(te&&a.CLog(Y("upb8::发现同时多次调用open"),1),r0(ee),Ie()):he(Y("Q1GA::录音功能无效：无音频流")))},100)},S=function(M){var te=M.name||M.message||M.code+":"+M,I="";le==1&&D(0,te)&&(I=Y("KxE2::，将尝试禁用回声消除后重试")),a.CLog(Y("xEQR::请求录音权限错误")+I+"|"+M,I?3:1,M),I?p(1):f(te,Y("bDOG::无法录音：")+M)},le=0,p=function(M){le++;var te="audioTrackSet",I="autoGainControl",K="echoCancellation",w="noiseSuppression",ae=te+":{"+K+","+w+","+I+"}",A=JSON.parse(se(O[te]||!0));a.CLog("open... "+le+" "+te+":"+se(A)),M&&(typeof A!="object"&&(A={}),A[I]=!1,A[K]=!1,A[w]=!1),A[W]&&a.CLog(Y("IjL3::注意：已配置{1}参数，可能会出现浏览器不能正确选用麦克风、移动端无法启用回声消除等现象",0,te+"."+W),3);var g={audio:A,video:O.videoTrackSet||!1};try{var e=C.Scope[q](g,z,S)}catch(l){a.CLog(q,3,l),g={audio:!0,video:!1},e=C.Scope[q](g,z,S)}a.CLog(q+"("+se(g)+") "+Ne(e0)+Y("RiWe::，未配置 {1} 时浏览器可能会自动启用回声消除，移动端未禁用回声消除时可能会降低系统播放音量（关闭录音后可恢复）和仅提供16k采样率的音频流（不需要回声消除时可明确配置成禁用来获得48k高音质的流），请参阅文档中{2}配置",0,ae,te)+"("+Z+") LM:"+b+" UA:"+navigator.userAgent),e&&e.then&&e.then(z)[H](S)};p()},close:function(v){v=v||N;var x=this,a=x._streamStore();x._stop();var O=" stream:"+x._streamTag,ee=a.Sync;if(x._O=0,x._O_!=ee.O){x.CLog(Y("hWVz::close被忽略（因为同时open了多个rec，只有最后一个会真正close）")+O,3),v();return}ee.C++,_e(a),x.CLog("close,"+O),v()},mock:function(v,x){var a=this;return a._stop(),a.isMock=1,a.mockEnvInfo=null,a.buffers=[v],a.recSize=v.length,a._setSrcSR(x),a._streamTag="mock",a},_setSrcSR:function(v){var x=this,a=x.set,O=a[W];O>v?a[W]=v:O=0,x[ye]=v,x.CLog(ye+": "+v+" set."+W+": "+a[W]+(O?" "+Y("UHvm::忽略")+": "+O:""),O?3:0)},envCheck:function(v){var x,a=this,O=a.set,ee="CPU_BE";if(!x&&!C[ee]&&typeof Int8Array=="function"&&!new Int8Array(new Int32Array([1]).buffer)[0]&&(Qe(ee),x=Y("Essp::不支持{1}架构",0,ee)),!x){var me=O.type,he=a[me+"_envCheck"];O.takeoffEncodeChunk&&(he?v.canProcess||(x=Y("7uMV::{1}环境不支持实时处理",0,v.envName)):x=Y("2XBl::{1}类型不支持设置takeoffEncodeChunk",0,me)+(a[me]?"":Y("LG7e::(未加载编码器)"))),!x&&he&&(x=a[me+"_envCheck"](v,O))}return x||""},envStart:function(v,x){var a=this,O=a.set;if(a.isMock=v?1:0,a.mockEnvInfo=v,a.buffers=[],a.recSize=0,v&&(a._streamTag="env$"+v.envName),a.state=1,a.envInLast=0,a.envInFirst=0,a.envInFix=0,a.envInFixTs=[],a._setSrcSR(x),a.engineCtx=0,a[O.type+"_start"]){var ee=a.engineCtx=a[O.type+"_start"](O);ee&&(ee.pcmDatas=[],ee.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(v,x){var a=this,O=a.set,ee=a.engineCtx;if(a.state!=1){a.state||a.CLog("envIn at state=0",3);return}var me=a[ye],he=v.length,Ie=C.PowerLevel(x,he),Le=a.buffers,Ve=Le.length;Le.push(v);var Me=Le,v0=Ve,Ze=Date.now(),e0=Math.round(he/me*1e3);a.envInLast=Ze,a.buffers.length==1&&(a.envInFirst=Ze-e0);var Pe=a.envInFixTs;Pe.splice(0,0,{t:Ze,d:e0});for(var s0=Ze,f=0,D=0;D<Pe.length;D++){var z=Pe[D];if(Ze-z.t>3e3){Pe.length=D;break}s0=z.t,f+=z.d}var S=Pe[1],le=Ze-s0,p=le-f;if(p>le/3&&(S&&le>1e3||Pe.length>=6)){var M=Ze-S.t-e0;if(M>e0/5){var te=!O.disableEnvInFix;if(a.CLog("["+Ze+"]"+Be.get(Y(te?"4Kfd::补偿{1}ms":"bM5i::未补偿{1}ms",1),[M]),3),a.envInFix+=M,te){var I=new Int16Array(M*me/1e3);he+=I.length,Le.push(I)}}}var K=a.recSize,w=he,ae=K+w;if(a.recSize=ae,ee){var A=C.SampleData(Le,me,O[W],ee.chunkInfo);ee.chunkInfo=A,K=ee.pcmSize,w=A.data.length,ae=K+w,ee.pcmSize=ae,Le=ee.pcmDatas,Ve=Le.length,Le.push(A.data),me=A[W]}var g=Math.round(ae/me*1e3),e=Le.length,l=Me.length,h=function(){for(var s=E?0:-w,y=Le[0]==null,r=Ve;r<e;r++){var F=Le[r];F==null?y=1:(s+=F.length,ee&&F.length&&a[O.type+"_encode"](ee,F))}if(y&&ee){var r=v0;for(Me[0]&&(r=0);r<l;r++)Me[r]=null}y&&(s=E?w:0,Le[0]=null),ee?ee.pcmSize+=s:a.recSize+=s},E=0,d="rec.set.onProcess";try{E=O.onProcess(Le,Ie,g,me,Ve,h)}catch(s){console.error(d+Y("gFUF::回调出错是不允许的，需保证不会抛异常"),s)}var i=Date.now()-Ze;if(i>10&&a.envInFirst-Ze>1e3&&a.CLog(d+Y("2ghS::低性能，耗时{1}ms",0,i),3),E===!0){for(var u=0,D=Ve;D<e;D++)Le[D]==null?u=1:Le[D]=new Int16Array(0);u?a.CLog(Y("ufqH::未进入异步前不能清除buffers"),3):ee?ee.pcmSize-=w:a.recSize-=w}else h()},start:function(){var v=this,x=1;if(v.set.sourceStream?v.Stream||(x=0):C.IsOpen()||(x=0),!x){v.CLog(Y("6WmN::start失败：未open"),1);return}var a=v._streamCtx();if(v.CLog(Y("kLDN::start 开始录音，")+Ne(a)+" stream:"+v._streamTag),v._stop(),v.envStart(null,a[W]),v.state=3,v._SO&&v._SO+1!=v._S){v.CLog(Y("Bp2y::start被中断"),3);return}v._SO=0;var O=function(){v.state==3&&(v.state=1,v.resume())},ee="AudioContext resume: ",me=v._streamGet();me._call[v.id]=function(){v.CLog(ee+a.state+"|stream ok"),O()},U(a,function(he){return he&&v.CLog(ee+"wait..."),v.state==3},function(he){he&&v.CLog(ee+a.state),O()},function(he){v.CLog(ee+a.state+Y("upkE::，可能无法录音：")+he,1),O()})},pause:function(){var v=this,x=v._streamGet();v.state&&(v.state=2,v.CLog("pause"),x&&delete x._call[v.id])},resume:function(){var v=this,x=v._streamGet(),a="resume",O=a+"(wait ctx)";if(v.state==3)v.CLog(O);else if(v.state){v.state=1,v.CLog(a),v.envResume(),x&&(x._call[v.id]=function(me,he){v.state==1&&v.envIn(me,he)},Ke(x));var ee=v._streamCtx();ee&&U(ee,function(me){return me&&v.CLog(O+"..."),v.state==1},function(me){me&&v.CLog(O+ee.state),Ke(x)},function(me){v.CLog(O+ee.state+"[err]"+me,1)})}},_stop:function(v){var x=this,a=x.set;x.isMock||x._S++,x.state&&(x.pause(),x.state=0),!v&&x[a.type+"_stop"]&&(x[a.type+"_stop"](x.engineCtx),x.engineCtx=0)},stop:function(v,x,a){var O=this,ee=O.set,me,he=O.envInLast-O.envInFirst,Ie=he&&O.buffers.length;O.CLog(Y("Xq4s::stop 和start时差:")+(he?he+"ms "+Y("3CQP::补偿:")+O.envInFix+"ms envIn:"+Ie+" fps:"+(Ie/he*1e3).toFixed(1):"-")+" stream:"+O._streamTag+" ("+Z+") LM:"+b);var Le=function(){O._stop(),a&&O.close()},Ve=function(z){O.CLog(Y("u8JG::结束录音失败：")+z,1),x&&x(z),Le()},Me=function(z,S,le){var p="blob",M="arraybuffer",te="dataType",I="DefaultDataType",K=O[te]||C[I]||p,w=te+"="+K,ae=z instanceof ArrayBuffer,A=0,g=ae?z.byteLength:z.size;if(K==M?ae||(A=1):K==p?typeof Blob!="function"?A=Y.G("NonBrowser-1",[w])+Y("1skY::，请设置{1}",0,V+"."+I+'="'+M+'"'):(ae&&(z=new Blob([z],{type:S})),z instanceof Blob||(A=1),S=z.type||S):A=Y.G("NotSupport-1",[w]),O.CLog(Y("Wv7l::结束录音 编码花{1}ms 音频时长{2}ms 文件大小{3}b",0,Date.now()-me,le,g)+" "+w+","+S),A){Ve(A!=1?A:Y("Vkbd::{1}编码器返回的不是{2}",0,ee.type,K)+", "+w);return}if(ee.takeoffEncodeChunk)O.CLog(Y("QWnr::启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据"),3);else if(g<Math.max(50,le/5)){Ve(Y("Sz2H::生成的{1}无效",0,ee.type));return}v&&v(z,le,S),Le()};if(!O.isMock){var v0=O.state==3;if(!O.state||v0){Ve(Y("wf9t::未开始录音")+(v0?Y("Dl2c::，开始录音前无用户交互导致AudioContext未运行"):""));return}}O._stop(!0);var Ze=O.recSize;if(!Ze){Ve(Y("Ltz3::未采集到录音"));return}if(!O[ee.type]){Ve(Y("xGuI::未加载{1}编码器，请尝试到{2}的src/engine内找到{1}的编码器并加载",0,ee.type,V));return}if(O.isMock){var e0=O.envCheck(O.mockEnvInfo||{envName:"mock",canProcess:!1});if(e0){Ve(Y("AxOH::录音错误：")+e0);return}}var Pe=O.engineCtx;if(O[ee.type+"_complete"]&&Pe){var D=Math.round(Pe.pcmSize/ee[W]*1e3);me=Date.now(),O[ee.type+"_complete"](Pe,function(S,le){Me(S,le,D)},Ve);return}if(me=Date.now(),!O.buffers[0]){Ve(Y("xkKd::音频buffers被释放"));return}var s0=C.SampleData(O.buffers,O[ye],ee[W]);ee[W]=s0[W];var f=s0.data,D=Math.round(f.length/ee[W]*1e3);O.CLog(Y("CxeT::采样:{1} 花:{2}ms",0,Ze+"->"+f.length,Date.now()-me)),setTimeout(function(){me=Date.now(),O[ee.type](f,function(z,S){Me(z,S,D)},function(z){Ve(z)})})}};var L0=function(v,x){x.pos||(x.pos=[0],x.tracks={},x.bytes=[]);var a=x.tracks,O=[x.pos[0]],ee=function(){x.pos[0]=O[0]},me=x.bytes.length,he=new Uint8Array(me+v.length);if(he.set(x.bytes),he.set(v,me),x.bytes=he,!x._ht){if(c0(he,O),Xe(he,O),!C0(c0(he,O),[24,83,128,103]))return;for(c0(he,O);O[0]<he.length;){var Ie=c0(he,O),Le=Xe(he,O),Ve=[0],Me=0;if(!Le)return;if(C0(Ie,[22,84,174,107])){for(;Ve[0]<Le.length;){var v0=c0(Le,Ve),Ze=Xe(Le,Ve),e0=[0],Pe={channels:0,sampleRate:0};if(C0(v0,[174]))for(;e0[0]<Ze.length;){var s0=c0(Ze,e0),f=Xe(Ze,e0),D=[0];if(C0(s0,[215])){var z=_0(f);Pe.number=z,a[z]=Pe}else if(C0(s0,[131])){var z=_0(f);z==1?Pe.type="video":z==2?(Pe.type="audio",Me||(x.track0=Pe),Pe.idx=Me++):Pe.type="Type-"+z}else if(C0(s0,[134])){for(var S="",le=0;le<f.length;le++)S+=String.fromCharCode(f[le]);Pe.codec=S}else if(C0(s0,[225]))for(;D[0]<f.length;){var p=c0(f,D),M=Xe(f,D);if(C0(p,[181])){var z=0,te=new Uint8Array(M.reverse()).buffer;M.length==4?z=new Float32Array(te)[0]:M.length==8?z=new Float64Array(te)[0]:je("WebM Track !Float",1,M),Pe[W]=Math.round(z)}else C0(p,[98,100])?Pe.bitDepth=_0(M):C0(p,[159])&&(Pe.channels=_0(M))}}}x._ht=1,je("WebM Tracks",a),ee();break}}}var I=x.track0;if(I){var K=I[W];if(x.webmSR=K,I.bitDepth==16&&/FLOAT/i.test(I.codec)&&(I.bitDepth=32,je("WebM 16->32 bit",3)),K<8e3||I.bitDepth!=32||I.channels<1||!/(\b|_)PCM\b/i.test(I.codec))return x.bytes=[],x.bad||je("WebM Track Unexpected",3,x),x.bad=1,-1;for(var w=[],ae=0;O[0]<he.length;){var v0=c0(he,O),Ze=Xe(he,O);if(!Ze)break;if(C0(v0,[163])){var A=Ze[0]&15,Pe=a[A];if(!Pe)je("WebM !Track"+A,1,a);else if(Pe.idx===0){for(var g=new Uint8Array(Ze.length-4),le=4;le<Ze.length;le++)g[le-4]=Ze[le];w.push(g),ae+=g.length}}ee()}if(ae){var e=new Uint8Array(he.length-x.pos[0]);e.set(he.subarray(x.pos[0])),x.bytes=e,x.pos[0]=0;for(var g=new Uint8Array(ae),le=0,l=0;le<w.length;le++)g.set(w[le],l),l+=w[le].length;var te=new Float32Array(g.buffer);if(I.channels>1){for(var h=[],le=0;le<te.length;)h.push(te[le]),le+=I.channels;te=new Float32Array(h)}return te}}},C0=function(v,x){if(!v||v.length!=x.length)return!1;if(v.length==1)return v[0]==x[0];for(var a=0;a<v.length;a++)if(v[a]!=x[a])return!1;return!0},_0=function(v){for(var x="",a=0;a<v.length;a++){var O=v[a];x+=(O<16?"0":"")+O.toString(16)}return parseInt(x,16)||0},c0=function(v,x,a){var O=x[0];if(!(O>=v.length)){var ee=v[O],me=("0000000"+ee.toString(2)).substr(-8),he=/^(0*1)(\d*)$/.exec(me);if(he){var Ie=he[1].length,Le=[];if(!(O+Ie>v.length)){for(var Ve=0;Ve<Ie;Ve++)Le[Ve]=v[O],O++;return a&&(Le[0]=parseInt(he[2]||"0",2)),x[0]=O,Le}}}},Xe=function(v,x){var a=c0(v,x,1);if(a){var O=_0(a),ee=x[0],me=[];if(O<2147483647){if(ee+O>v.length)return;for(var he=0;he<O;he++)me[he]=v[ee],ee++}return x[0]=ee,me}},Be=C.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(v,x){var a=V+".i18n.put: ",O=v.overwrite;O=O==null||O;var ee=v.lang;if(ee=Be.alias[ee]||ee,!ee)throw new Error(a+"set.lang?");var me=Be.locales[ee];me||(me={},Be.locales[ee]=me);for(var he=/^([\w\-]+):/,Ie,Le=0;Le<x.length;Le++){var Me=x[Le];if(Ie=he.exec(Me),!Ie){je(a+"'key:'? "+Me,3,v);continue}var Ve=Ie[1],Me=Me.substr(Ve.length+1);!O&&me[Ve]||(me[Ve]=Me)}},get:function(){return Be.v_G.apply(null,arguments)},v_G:function(v,x,a){x=x||[],a=a||Be.lang,a=Be.alias[a]||a;var O=Be.locales[a],ee=O&&O[v]||"";return!ee&&a!="zh"?a=="en"?Be.v_G(v,x,"zh"):Be.v_G(v,x,"en"):(Be.lastLang=a,ee=="=Empty"?"":ee.replace(/\{(\d+)(\!?)\}/g,function(me,he,Ie){return he=+he||0,me=x[he-1],(he<1||he>x.length)&&(me="{?}",je("i18n["+v+"] no {"+he+"}: "+ee,3)),Ie?"":me}))},$T:function(){return Be.v_T.apply(null,arguments)},v_T:function(){for(var v=arguments,x="",a=[],O=0,ee=V+".i18n.$T:",me=/^([\w\-]*):/,he,Ie=0;Ie<v.length;Ie++){var Le=v[Ie];if(Ie==0){if(he=me.exec(Le),x=he&&he[1],!x)throw new Error(ee+"0 'key:'?");Le=Le.substr(x.length+1)}if(O===-1)a.push(Le);else{if(O)throw new Error(ee+" bad args");if(Le===0)O=-1;else if(J(Le)){if(Le<1)throw new Error(ee+" bad args");O=Le}else{var Ve=Ie==1?"en":Ie?"":"zh";if(he=me.exec(Le),he&&(Ve=he[1]||Ve,Le=Le.substr(he[1].length+1)),!he||!Ve)throw new Error(ee+Ie+" 'lang:'?");Be.put({lang:Ve,overwrite:!1},[x+":"+Le])}}}return x?O>0?x:Be.v_G(x,a):""}},Y=Be.$T;Y.G=Be.get,Y("NonBrowser-1::非浏览器环境，不支持{1}",1),Y("IllegalArgs-1::参数错误：{1}",1),Y("NeedImport-2::调用{1}需要先导入{2}",2),Y("NotSupport-1::不支持：{1}",1),C.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var Qe=C.Traffic=function(v){if(ce){v=v?"/"+V+"/Report/"+v:"";var x=C.TrafficImgUrl;if(x){var a=C.Traffic,O=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],ee=O[1]||"http://file/",me=(O[0]||ee)+v;if(x.indexOf("//")==0&&(/^https:/i.test(me)?x="https:"+x:x="http:"+x),v&&(x=x+"&cu="+encodeURIComponent(ee+v)),!a[me]){a[me]=1;var he=new Image;he.src=x,je("Traffic Analysis Image: "+(v||V+".TrafficImgUrl="+C.TrafficImgUrl))}}}};T&&(je(Y("8HO5::覆盖导入{1}",0,V),1),T.Destroy()),de[V]=C})})(w1);var cn=w1.exports;const un=s1(cn);(function(ke){var de=typeof window=="object"&&!!window.document,ce=de?window:Object,N=ce.Recorder,J=N.i18n;ke(N,J,J.$T,de)})(function(ke,de,ce,N){var J="48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000",se="8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 192, 224, 256, 320";ke.prototype.enc_mp3={stable:!0,takeEC:"full",getTestMsg:function(){return ce("Zm7L::采样率范围：{1}；比特率范围：{2}（不同比特率支持的采样率范围不同，小于32kbps时采样率需小于32000）",0,J,se)}};var C=function(H){var T=H.bitRate,R=H.sampleRate,ue=R;if((" "+se+",").indexOf(" "+T+",")==-1&&ke.CLog(ce("eGB9::{1}不在mp3支持的取值范围：{2}",0,"bitRate="+T,se),3),(" "+J+",").indexOf(" "+R+",")==-1){for(var U=J.split(", "),be=[],Ne=0;Ne<U.length;Ne++)be.push({v:+U[Ne],s:Math.abs(U[Ne]-R)});be.sort(function(Re,De){return Re.s-De.s}),ue=be[0].v,H.sampleRate=ue,ke.CLog(ce("zLTa::sampleRate已更新为{1}，因为{2}不在mp3支持的取值范围：{3}",0,ue,R,J),3)}},b=function(){return ce.G("NeedImport-2",["mp3.js","src/engine/mp3-engine.js"])},Z=N&&typeof Worker=="function";ke.prototype.mp3=function(H,T,R){var ue=this,U=ue.set,be=H.length;if(!ke.lamejs){R(b());return}if(Z){var Ne=ue.mp3_start(U);if(Ne){if(Ne.isW){ue.mp3_encode(Ne,H),ue.mp3_complete(Ne,T,R,1);return}ue.mp3_stop(Ne)}}C(U);var Re=new ke.lamejs.Mp3Encoder(1,U.sampleRate,U.bitRate),De=57600,r0=new Int8Array(5e5),Ke=0,l0=0,qe=0,_e=function(){try{if(l0<be)var P=Re.encodeBuffer(H.subarray(l0,l0+De));else{qe=1;var P=Re.flush()}}catch(S0){if(console.error(S0),!qe)try{Re.flush()}catch(L0){console.error(L0)}R("MP3 Encoder: "+S0.message);return}var o0=P.length;if(o0>0){if(Ke+o0>r0.length){var je=new Int8Array(r0.length+Math.max(5e5,o0));je.set(r0.subarray(0,Ke)),r0=je}r0.set(P,Ke),Ke+=o0}if(l0<be)l0+=De,setTimeout(_e);else{var Je=[r0.buffer.slice(0,Ke)],H0=W.fn(Je,Ke,be,U.sampleRate);fe(H0,U),T(Je[0]||new ArrayBuffer(0),"audio/mp3")}};_e()};var V;ke.BindDestroy("mp3Worker",function(){V&&(ke.CLog("mp3Worker Destroy"),V.terminate(),V=null)}),ke.prototype.mp3_envCheck=function(H,T){var R="";return T.takeoffEncodeChunk&&(ye()||(R=ce("yhUs::当前浏览器版本太低，无法实时处理"))),!R&&!ke.lamejs&&(R=b()),R},ke.prototype.mp3_start=function(H){return ye(H)};var q={id:0},ye=function(H,T){var R=function(qe){var _e=qe.data,P=be.wkScope.wk_ctxs,o0=be.wkScope.wk_lame,je=be.wkScope.wk_mp3TrimFix,Je=P[_e.id];if(_e.action=="init")P[_e.id]={sampleRate:_e.sampleRate,bitRate:_e.bitRate,takeoff:_e.takeoff,pcmSize:0,memory:new Int8Array(5e5),mOffset:0,encObj:new o0.Mp3Encoder(1,_e.sampleRate,_e.bitRate)};else if(!Je)return;var H0=function(_0){var c0=_0.length;if(Je.mOffset+c0>Je.memory.length){var Xe=new Int8Array(Je.memory.length+Math.max(5e5,c0));Xe.set(Je.memory.subarray(0,Je.mOffset)),Je.memory=Xe}Je.memory.set(_0,Je.mOffset),Je.mOffset+=c0};switch(_e.action){case"stop":if(!Je.isCp)try{Je.encObj.flush()}catch(_0){console.error(_0)}Je.encObj=null,delete P[_e.id];break;case"encode":if(Je.isCp)break;Je.pcmSize+=_e.pcm.length;try{var S0=Je.encObj.encodeBuffer(_e.pcm)}catch(_0){Je.err=_0,console.error(_0)}S0&&S0.length>0&&(Je.takeoff?Ne.onmessage({action:"takeoff",id:_e.id,chunk:S0}):H0(S0));break;case"complete":Je.isCp=1;try{var S0=Je.encObj.flush()}catch(_0){Je.err=_0,console.error(_0)}if(S0&&S0.length>0&&(Je.takeoff?Ne.onmessage({action:"takeoff",id:_e.id,chunk:S0}):H0(S0)),Je.err){Ne.onmessage({action:_e.action,id:_e.id,err:"MP3 Encoder: "+Je.err.message});break}var L0=[Je.memory.buffer.slice(0,Je.mOffset)],C0=je.fn(L0,Je.mOffset,Je.pcmSize,Je.sampleRate);Ne.onmessage({action:_e.action,id:_e.id,blob:L0[0]||new ArrayBuffer(0),meta:C0});break}},ue=function(qe){Ne.onmessage=function(_e){var P=_e;qe&&(P=_e.data);var o0=q[P.id];o0&&(P.action=="takeoff"?o0.set.takeoffEncodeChunk(new Uint8Array(P.chunk.buffer)):(o0.call&&o0.call(P),o0.call=null))}},U=function(){var qe={worker:Ne,set:H};return H?(qe.id=++q.id,q[qe.id]=qe,C(H),Ne.postMessage({action:"init",id:qe.id,sampleRate:H.sampleRate,bitRate:H.bitRate,takeoff:!!H.takeoffEncodeChunk,x:new Int16Array(5)})):Ne.postMessage({x:new Int16Array(5)}),qe},be,Ne=V;if(T||!Z)return ke.CLog(ce("k9PT::当前环境不支持Web Worker，mp3实时编码器运行在主线程中"),3),Ne={postMessage:function(qe){R({data:qe})}},be={wkScope:{wk_ctxs:{},wk_lame:ke.lamejs,wk_mp3TrimFix:W}},ue(),U();try{if(!Ne){var Re=(R+"").replace(/[\w\$]+\.onmessage/g,"self.postMessage");Re=Re.replace(/[\w\$]+\.wkScope/g,"wkScope");var De=");wk_lame();self.onmessage="+Re;De+=";var wkScope={ wk_ctxs:{},wk_lame:wk_lame",De+=",wk_mp3TrimFix:{rm:"+W.rm+",fn:"+W.fn+"} }";var r0=ke.lamejs.toString(),Ke=(window.URL||webkitURL).createObjectURL(new Blob(["var wk_lame=(",r0,De],{type:"text/javascript"}));Ne=new Worker(Ke),setTimeout(function(){(window.URL||webkitURL).revokeObjectURL(Ke)},1e4),ue(1)}var l0=U();return l0.isW=1,V=Ne,l0}catch(qe){return Ne&&Ne.terminate(),console.error(qe),ye(H,1)}};ke.prototype.mp3_stop=function(H){if(H&&H.worker){H.worker.postMessage({action:"stop",id:H.id}),H.worker=null,delete q[H.id];var T=-1;for(var R in q)T++;T&&ke.CLog(ce("fT6M::mp3 worker剩{1}个未stop",0,T),3)}},ke.prototype.mp3_encode=function(H,T){H&&H.worker&&H.worker.postMessage({action:"encode",id:H.id,pcm:T})},ke.prototype.mp3_complete=function(H,T,R,ue){var U=this;H&&H.worker?(H.call=function(be){ue&&U.mp3_stop(H),be.err?R(be.err):(fe(be.meta,H.set),T(be.blob,"audio/mp3"))},H.worker.postMessage({action:"complete",id:H.id})):R(ce("mPxH::mp3编码器未start"))},ke.mp3ReadMeta=function(H,T){var R=typeof window<"u"&&window.parseInt||typeof self<"u"&&self.parseInt||parseInt,ue=new Uint8Array(H[0]||[]);if(ue.length<4)return null;var U=function(_0,c0){return("0000000"+((c0||ue)[_0]||0).toString(2)).substr(-8)},be=U(0)+U(1),Ne=U(2)+U(3);if(!/^1{11}/.test(be))return null;var Re={"00":2.5,10:2,11:1}[be.substr(11,2)],De={"01":3}[be.substr(13,2)],r0={1:[44100,48e3,32e3],2:[22050,24e3,16e3],"2.5":[11025,12e3,8e3]}[Re];r0&&(r0=r0[R(Ne.substr(4,2),2)]);var Ke=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320]][Re==1?1:0][R(Ne.substr(0,4),2)];if(!Re||!De||!Ke||!r0)return null;for(var l0=Math.round(T*8/Ke),qe=De==1?384:De==2||Re==1?1152:576,_e=qe/r0*1e3,P=Math.floor(qe*Ke/8/r0*1e3),o0=0,je=0,Je=0;Je<H.length;Je++){var H0=H[Je];if(je+=H0.byteLength,je>=P+3){var S0=new Uint8Array(H0),L0=H0.byteLength-(je-(P+3)+1),C0=U(L0,S0);o0=C0.charAt(6)=="1";break}}return o0&&P++,{version:Re,layer:De,sampleRate:r0,bitRate:Ke,duration:l0,size:T,hasPadding:o0,frameSize:P,frameDurationFloat:_e}};var W={rm:ke.mp3ReadMeta,fn:function(H,T,R,ue){var U=this.rm(H,T);if(!U)return{size:T,err:"mp3 unknown format"};var be=Math.round(R/ue*1e3),Ne=Math.floor((U.duration-be)/U.frameDurationFloat);if(Ne>0){var Re=Ne*U.frameSize-(U.hasPadding?1:0);T-=Re;for(var De=0,r0=[],Ke=0;Ke<H.length;Ke++){var l0=H[Ke];if(Re<=0)break;Re>=l0.byteLength?(Re-=l0.byteLength,r0.push(l0),H.splice(Ke,1),Ke--):(H[Ke]=l0.slice(Re),De=l0,Re=0)}var qe=this.rm(H,T);if(!qe){De&&(H[0]=De);for(var Ke=0;Ke<r0.length;Ke++)H.splice(Ke,0,r0[Ke]);U.err="mp3 fix error: 已还原，错误原因不明"}var _e=U.trimFix={};_e.remove=Ne,_e.removeDuration=Math.round(Ne*U.frameDurationFloat),_e.duration=Math.round(T*8/U.bitRate)}return U}},fe=function(H,T){var R="MP3 Info: ";(H.sampleRate&&H.sampleRate!=T.sampleRate||H.bitRate&&H.bitRate!=T.bitRate)&&(ke.CLog(R+ce("uY9i::和设置的不匹配{1}，已更新成{2}",0,"set:"+T.bitRate+"kbps "+T.sampleRate+"hz","set:"+H.bitRate+"kbps "+H.sampleRate+"hz"),3,T),T.sampleRate=H.sampleRate,T.bitRate=H.bitRate);var ue=H.trimFix;ue?(R+=ce("iMSm::Fix移除{1}帧",0,ue.remove)+" "+ue.removeDuration+"ms -> "+ue.duration+"ms",ue.remove>2&&(H.err=(H.err?H.err+", ":"")+ce("b9zm::移除帧数过多"))):R+=(H.duration||"-")+"ms",H.err?ke.CLog(R,H.size?1:0,H.err,H):ke.CLog(R,H)}});(function(ke){var de=typeof window=="object"&&!!window.document,ce=de?window:Object,N=ce.Recorder;ke(N)})(function(ke){function de(){var ce=function(f){return Math.log(f)/Math.log(10)},N=function(f){throw new Error("abort("+f+")")};function J(f){return new Int8Array(f)}function se(f){return new Int16Array(f)}function C(f){return new Int32Array(f)}function b(f){return new Float32Array(f)}function Z(f){return new Float64Array(f)}function V(f){if(f.length==1)return b(f[0]);var D=f[0];f=f.slice(1);for(var z=[],S=0;S<D;S++)z.push(V(f));return z}function q(f){if(f.length==1)return C(f[0]);var D=f[0];f=f.slice(1);for(var z=[],S=0;S<D;S++)z.push(q(f));return z}function ye(f){if(f.length==1)return se(f[0]);var D=f[0];f=f.slice(1);for(var z=[],S=0;S<D;S++)z.push(ye(f));return z}function W(f){if(f.length==1)return new Array(f[0]);var D=f[0];f=f.slice(1);for(var z=[],S=0;S<D;S++)z.push(W(f));return z}var fe={};fe.fill=function(f,D,z,S){if(arguments.length==2)for(var le=0;le<f.length;le++)f[le]=arguments[1];else for(var le=D;le<z;le++)f[le]=S};var H={};H.arraycopy=function(f,D,z,S,le){for(var p=D+le;D<p;)z[S++]=f[D++]};var T={};T.SQRT2=1.4142135623730951,T.FAST_LOG10=function(f){return ce(f)},T.FAST_LOG10_X=function(f,D){return ce(f)*D};function R(f){this.ordinal=f}R.short_block_allowed=new R(0),R.short_block_coupled=new R(1),R.short_block_dispensed=new R(2),R.short_block_forced=new R(3);var ue={};ue.MAX_VALUE=34028235e31;function U(f){this.ordinal=f}U.vbr_off=new U(0),U.vbr_mt=new U(1),U.vbr_rh=new U(2),U.vbr_abr=new U(3),U.vbr_mtrh=new U(4),U.vbr_default=U.vbr_mtrh;function be(f){var D=f;this.ordinal=function(){return D}}be.STEREO=new be(0),be.JOINT_STEREO=new be(1),be.DUAL_CHANNEL=new be(2),be.MONO=new be(3),be.NOT_SET=new be(4);function Ne(){var f=3,D=98,z=4;this.getLameShortVersion=function(){return f+"."+D+"."+z}}function Re(){var f=null;this.qupvt=null,this.setModules=function(o){this.qupvt=o,f=o};function D(o){this.bits=0|o}var z=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function S(o,c,_,m,k,t){var n=.5946/c;for(o=o>>1;o--!=0;)k[t++]=n>_[m++]?0:1,k[t++]=n>_[m++]?0:1}function le(o,c,_,m,k,t){o=o>>1;var n=o%2;for(o=o>>1;o--!=0;){var G,B,$,re,ve,pe,Oe,$e;G=_[m++]*c,B=_[m++]*c,ve=0|G,$=_[m++]*c,pe=0|B,re=_[m++]*c,Oe=0|$,G+=f.adj43[ve],$e=0|re,B+=f.adj43[pe],k[t++]=0|G,$+=f.adj43[Oe],k[t++]=0|B,re+=f.adj43[$e],k[t++]=0|$,k[t++]=0|re}if(n!=0){var G,B,ve,pe;G=_[m++]*c,B=_[m++]*c,ve=0|G,pe=0|B,G+=f.adj43[ve],B+=f.adj43[pe],k[t++]=0|G,k[t++]=0|B}}function p(o,c,_,m,k){var t,n,G=0,B,$=0,re=0,ve=0,pe=c,Oe=0,$e=pe,ze=0,x0=o,y0=0;for(B=k!=null&&m.global_gain==k.global_gain,m.block_type==a.SHORT_TYPE?n=38:n=21,t=0;t<=n;t++){var d0=-1;if((B||m.block_type==a.NORM_TYPE)&&(d0=m.global_gain-(m.scalefac[t]+(m.preflag!=0?f.pretab[t]:0)<<m.scalefac_scale+1)-m.subblock_gain[m.window[t]]*8),B&&k.step[t]==d0)$!=0&&(le($,_,x0,y0,$e,ze),$=0),re!=0&&N();else{var p0=m.width[t];if(G+m.width[t]>m.max_nonzero_coeff){var g0;g0=m.max_nonzero_coeff-G+1,fe.fill(c,m.max_nonzero_coeff,576,0),p0=g0,p0<0&&(p0=0),t=n+1}if($==0&&re==0&&($e=pe,ze=Oe,x0=o,y0=ve),k!=null&&k.sfb_count1>0&&t>=k.sfb_count1&&k.step[t]>0&&d0>=k.step[t]?($!=0&&(le($,_,x0,y0,$e,ze),$=0,$e=pe,ze=Oe,x0=o,y0=ve),re+=p0):(re!=0&&(S(re,_,x0,y0,$e,ze),re=0,$e=pe,ze=Oe,x0=o,y0=ve),$+=p0),p0<=0){re!=0&&N(),$!=0&&N();break}}t<=n&&(Oe+=m.width[t],ve+=m.width[t],G+=m.width[t])}$!=0&&(le($,_,x0,y0,$e,ze),$=0),re!=0&&N()}function M(o,c,_){var m=0,k=0;do{var t=o[c++],n=o[c++];m<t&&(m=t),k<n&&(k=n)}while(c<_);return m<k&&(m=k),m}function te(o,c,_,m,k,t){var n=P.ht[m].xlen*65536+P.ht[k].xlen,G=0,B;do{var $=o[c++],re=o[c++];$!=0&&($>14&&($=15,G+=n),$*=16),re!=0&&(re>14&&(re=15,G+=n),$+=re),G+=P.largetbl[$]}while(c<_);return B=G&65535,G>>=16,G>B&&(G=B,m=k),t.bits+=G,m}function I(o,c,_,m){var k=0,t=P.ht[1].hlen;do{var n=o[c+0]*2+o[c+1];c+=2,k+=t[n]}while(c<_);return m.bits+=k,1}function K(o,c,_,m,k){var t=0,n,G=P.ht[m].xlen,B;m==2?B=P.table23:B=P.table56;do{var $=o[c+0]*G+o[c+1];c+=2,t+=B[$]}while(c<_);return n=t&65535,t>>=16,t>n&&(t=n,m++),k.bits+=t,m}function w(o,c,_,m,k){var t=0,n=0,G=0,B=P.ht[m].xlen,$=P.ht[m].hlen,re=P.ht[m+1].hlen,ve=P.ht[m+2].hlen;do{var pe=o[c+0]*B+o[c+1];c+=2,t+=$[pe],n+=re[pe],G+=ve[pe]}while(c<_);var Oe=m;return t>n&&(t=n,Oe++),t>G&&(t=G,Oe=m+2),k.bits+=t,Oe}var ae=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function A(o,c,_,m){var k=M(o,c,_);switch(k){case 0:return k;case 1:return I(o,c,_,m);case 2:case 3:return K(o,c,_,ae[k-1],m);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return w(o,c,_,ae[k-1],m);default:k>c0.IXMAX_VAL&&N(),k-=15;var t;for(t=24;t<32&&!(P.ht[t].linmax>=k);t++);var n;for(n=t-8;n<24&&!(P.ht[n].linmax>=k);n++);return te(o,c,_,n,t,m)}}this.noquant_count_bits=function(o,c,_){var m=c.l3_enc,k=Math.min(576,c.max_nonzero_coeff+2>>1<<1);for(_!=null&&(_.sfb_count1=0);k>1&&!(m[k-1]|m[k-2]);k-=2);c.count1=k;for(var t=0,n=0;k>3;k-=4){var G;if(((m[k-1]|m[k-2]|m[k-3]|m[k-4])&2147483647)>1)break;G=((m[k-4]*2+m[k-3])*2+m[k-2])*2+m[k-1],t+=P.t32l[G],n+=P.t33l[G]}var B=t;if(c.count1table_select=0,t>n&&(B=n,c.count1table_select=1),c.count1bits=B,c.big_values=k,k==0)return B;if(c.block_type==a.SHORT_TYPE)t=3*o.scalefac_band.s[3],t>c.big_values&&(t=c.big_values),n=c.big_values;else if(c.block_type==a.NORM_TYPE){if(t=c.region0_count=o.bv_scf[k-2],n=c.region1_count=o.bv_scf[k-1],n=o.scalefac_band.l[t+n+2],t=o.scalefac_band.l[t+1],n<k){var $=new D(B);c.table_select[2]=A(m,n,k,$),B=$.bits}}else c.region0_count=7,c.region1_count=a.SBMAX_l-1-7-1,t=o.scalefac_band.l[8],n=k,t>n&&(t=n);if(t=Math.min(t,k),n=Math.min(n,k),0<t){var $=new D(B);c.table_select[0]=A(m,0,t,$),B=$.bits}if(t<n){var $=new D(B);c.table_select[1]=A(m,t,n,$),B=$.bits}if(o.use_best_huffman==2&&N(),_!=null&&c.block_type==a.NORM_TYPE){for(var re=0;o.scalefac_band.l[re]<c.big_values;)re++;_.sfb_count1=re}return B},this.count_bits=function(o,c,_,m){var k=_.l3_enc,t=c0.IXMAX_VAL/f.IPOW20(_.global_gain);return _.xrpow_max>t?c0.LARGE_BITS:(p(c,k,f.IPOW20(_.global_gain),_,m),o.substep_shaping&2&&N(),this.noquant_count_bits(o,_,m))};function g(o,c,_,m,k,t,n){for(var G=c.big_values,B=0;B<=22;B++)m[B]=c0.LARGE_BITS;for(var B=0;B<16;B++){var $=o.scalefac_band.l[B+1];if($>=G)break;var re=0,ve=new D(re),pe=A(_,0,$,ve);re=ve.bits;for(var Oe=0;Oe<8;Oe++){var $e=o.scalefac_band.l[B+Oe+2];if($e>=G)break;var ze=re;ve=new D(ze);var x0=A(_,$,$e,ve);ze=ve.bits,m[B+Oe]>ze&&(m[B+Oe]=ze,k[B+Oe]=B,t[B+Oe]=pe,n[B+Oe]=x0)}}}function e(o,c,_,m,k,t,n,G){for(var B=c.big_values,$=2;$<a.SBMAX_l+1;$++){var re=o.scalefac_band.l[$];if(re>=B)break;var ve=k[$-2]+c.count1bits;if(_.part2_3_length<=ve)break;var pe=new D(ve),Oe=A(m,re,B,pe);ve=pe.bits,!(_.part2_3_length<=ve)&&(_.assign(c),_.part2_3_length=ve,_.region0_count=t[$-2],_.region1_count=$-2-t[$-2],_.table_select[0]=n[$-2],_.table_select[1]=G[$-2],_.table_select[2]=Oe)}}this.best_huffman_divide=function(o,c){var _=new Be,m=c.l3_enc,k=C(23),t=C(23),n=C(23),G=C(23);if(!(c.block_type==a.SHORT_TYPE&&o.mode_gr==1)){_.assign(c),c.block_type==a.NORM_TYPE&&(g(o,c,m,k,t,n,G),e(o,_,c,m,k,t,n,G));var B=_.big_values;if(!(B==0||(m[B-2]|m[B-1])>1)&&(B=c.count1+2,!(B>576))){_.assign(c),_.count1=B;for(var $=0,re=0;B>_.big_values;B-=4){var ve=((m[B-4]*2+m[B-3])*2+m[B-2])*2+m[B-1];$+=P.t32l[ve],re+=P.t33l[ve]}if(_.big_values=B,_.count1table_select=0,$>re&&($=re,_.count1table_select=1),_.count1bits=$,_.block_type==a.NORM_TYPE)e(o,_,c,m,k,t,n,G);else{if(_.part2_3_length=$,$=o.scalefac_band.l[8],$>B&&($=B),$>0){var pe=new D(_.part2_3_length);_.table_select[0]=A(m,0,$,pe),_.part2_3_length=pe.bits}if(B>$){var pe=new D(_.part2_3_length);_.table_select[1]=A(m,$,B,pe),_.part2_3_length=pe.bits}c.part2_3_length>_.part2_3_length&&c.assign(_)}}}};var l=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],h=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],E=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],d=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];Re.slen1_tab=E,Re.slen2_tab=d;function i(o,c){for(var _,m=c.tt[1][o],k=c.tt[0][o],t=0;t<P.scfsi_band.length-1;t++){for(_=P.scfsi_band[t];_<P.scfsi_band[t+1]&&!(k.scalefac[_]!=m.scalefac[_]&&m.scalefac[_]>=0);_++);if(_==P.scfsi_band[t+1]){for(_=P.scfsi_band[t];_<P.scfsi_band[t+1];_++)m.scalefac[_]=-1;c.scfsi[o][t]=1}}var n=0,G=0;for(_=0;_<11;_++)m.scalefac[_]!=-1&&(G++,n<m.scalefac[_]&&(n=m.scalefac[_]));for(var B=0,$=0;_<a.SBPSY_l;_++)m.scalefac[_]!=-1&&($++,B<m.scalefac[_]&&(B=m.scalefac[_]));for(var t=0;t<16;t++)if(n<l[t]&&B<h[t]){var re=E[t]*G+d[t]*$;m.part2_length>re&&(m.part2_length=re,m.scalefac_compress=t)}}this.best_scalefac_store=function(o,c,_,m){var k=m.tt[c][_],t,n,G,B,$=0;for(G=0,t=0;t<k.sfbmax;t++){var re=k.width[t];for(G+=re,B=-re;B<0&&k.l3_enc[B+G]==0;B++);B==0&&(k.scalefac[t]=$=-2)}if(k.scalefac_scale==0&&k.preflag==0){var ve=0;for(t=0;t<k.sfbmax;t++)k.scalefac[t]>0&&(ve|=k.scalefac[t]);if(!(ve&1)&&ve!=0){for(t=0;t<k.sfbmax;t++)k.scalefac[t]>0&&(k.scalefac[t]>>=1);k.scalefac_scale=$=1}}if(k.preflag==0&&k.block_type!=a.SHORT_TYPE&&o.mode_gr==2){for(t=11;t<a.SBPSY_l&&!(k.scalefac[t]<f.pretab[t]&&k.scalefac[t]!=-2);t++);if(t==a.SBPSY_l){for(t=11;t<a.SBPSY_l;t++)k.scalefac[t]>0&&(k.scalefac[t]-=f.pretab[t]);k.preflag=$=1}}for(n=0;n<4;n++)m.scfsi[_][n]=0;for(o.mode_gr==2&&c==1&&m.tt[0][_].block_type!=a.SHORT_TYPE&&m.tt[1][_].block_type!=a.SHORT_TYPE&&(i(_,m),$=0),t=0;t<k.sfbmax;t++)k.scalefac[t]==-2&&(k.scalefac[t]=0);$!=0&&(o.mode_gr==2?this.scale_bitcount(k):this.scale_bitcount_lsf(o,k))};var u=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],s=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],y=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(o){var c,_,m=0,k=0,t,n=o.scalefac;if(o.block_type==a.SHORT_TYPE)t=u,o.mixed_block_flag!=0&&(t=s);else if(t=y,o.preflag==0){for(_=11;_<a.SBPSY_l&&!(n[_]<f.pretab[_]);_++);if(_==a.SBPSY_l)for(o.preflag=1,_=11;_<a.SBPSY_l;_++)n[_]-=f.pretab[_]}for(_=0;_<o.sfbdivide;_++)m<n[_]&&(m=n[_]);for(;_<o.sfbmax;_++)k<n[_]&&(k=n[_]);for(o.part2_length=c0.LARGE_BITS,c=0;c<16;c++)m<l[c]&&k<h[c]&&o.part2_length>t[c]&&(o.part2_length=t[c],o.scalefac_compress=c);return o.part2_length==c0.LARGE_BITS};var r=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(o,c){var _,m,k,t,n,G,B,$,re=C(4),ve=c.scalefac;for(c.preflag!=0?_=2:_=0,B=0;B<4;B++)re[B]=0;if(c.block_type==a.SHORT_TYPE){m=1;var pe=f.nr_of_sfb_block[_][m];for($=0,k=0;k<4;k++)for(t=pe[k]/3,B=0;B<t;B++,$++)for(n=0;n<3;n++)ve[$*3+n]>re[k]&&(re[k]=ve[$*3+n])}else{m=0;var pe=f.nr_of_sfb_block[_][m];for($=0,k=0;k<4;k++)for(t=pe[k],B=0;B<t;B++,$++)ve[$]>re[k]&&(re[k]=ve[$])}for(G=!1,k=0;k<4;k++)re[k]>r[_][k]&&(G=!0);if(!G){var Oe,$e,ze,x0;for(c.sfb_partition_table=f.nr_of_sfb_block[_][m],k=0;k<4;k++)c.slen[k]=F[re[k]];switch(Oe=c.slen[0],$e=c.slen[1],ze=c.slen[2],x0=c.slen[3],_){case 0:c.scalefac_compress=(Oe*5+$e<<4)+(ze<<2)+x0;break;case 1:c.scalefac_compress=400+(Oe*5+$e<<2)+ze;break;case 2:c.scalefac_compress=500+Oe*3+$e;break}}if(!G)for(c.part2_length=0,k=0;k<4;k++)c.part2_length+=c.slen[k]*c.sfb_partition_table[k];return G};var F=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(o){for(var c=2;c<=576;c+=2){for(var _=0,m;o.scalefac_band.l[++_]<c;);for(m=z[_][0];o.scalefac_band.l[m+1]>c;)m--;for(m<0&&(m=z[_][0]),o.bv_scf[c-2]=m,m=z[_][1];o.scalefac_band.l[m+o.bv_scf[c-2]+2]>c;)m--;m<0&&(m=z[_][1]),o.bv_scf[c-1]=m}}}De.STEPS_per_dB=100,De.MAX_dB=120,De.GAIN_NOT_ENOUGH_SAMPLES=-24601,De.GAIN_ANALYSIS_ERROR=0,De.GAIN_ANALYSIS_OK=1,De.INIT_GAIN_ANALYSIS_ERROR=0,De.INIT_GAIN_ANALYSIS_OK=1,De.YULE_ORDER=10,De.MAX_ORDER=De.YULE_ORDER,De.MAX_SAMP_FREQ=48e3,De.RMS_WINDOW_TIME_NUMERATOR=1,De.RMS_WINDOW_TIME_DENOMINATOR=20,De.MAX_SAMPLES_PER_WINDOW=De.MAX_SAMP_FREQ*De.RMS_WINDOW_TIME_NUMERATOR/De.RMS_WINDOW_TIME_DENOMINATOR+1;function De(){}function r0(){function f(p,M,te,I,K,w,ae,A,g,e,l,h,E,d){this.quant_comp=M,this.quant_comp_s=te,this.safejoint=I,this.nsmsfix=K,this.st_lrm=w,this.st_s=ae,this.nsbass=A,this.scale=g,this.masking_adj=e,this.ath_lower=l,this.ath_curve=h,this.interch=E,this.sfscale=d}var D;this.setModules=function(p){D=p};function z(p,M,te){N()}var S=[new f(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new f(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new f(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new f(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new f(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new f(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new f(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new f(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new f(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new f(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new f(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new f(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new f(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new f(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new f(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new f(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new f(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function le(p,M,te){var I=M,K=D.nearestBitrateFullIndex(M);if(p.VBR=U.vbr_abr,p.VBR_mean_bitrate_kbps=I,p.VBR_mean_bitrate_kbps=Math.min(p.VBR_mean_bitrate_kbps,320),p.VBR_mean_bitrate_kbps=Math.max(p.VBR_mean_bitrate_kbps,8),p.brate=p.VBR_mean_bitrate_kbps,p.VBR_mean_bitrate_kbps>320&&(p.disable_reservoir=!0),S[K].safejoint>0&&(p.exp_nspsytune=p.exp_nspsytune|2),S[K].sfscale>0&&(p.internal_flags.noise_shaping=2),Math.abs(S[K].nsbass)>0){var w=int(S[K].nsbass*4);w<0&&(w+=64),p.exp_nspsytune=p.exp_nspsytune|w<<2}return te!=0?p.quant_comp=S[K].quant_comp:Math.abs(p.quant_comp- -1)>0||(p.quant_comp=S[K].quant_comp),te!=0?p.quant_comp_short=S[K].quant_comp_s:Math.abs(p.quant_comp_short- -1)>0||(p.quant_comp_short=S[K].quant_comp_s),te!=0?p.msfix=S[K].nsmsfix:Math.abs(p.msfix- -1)>0||(p.msfix=S[K].nsmsfix),te!=0?p.internal_flags.nsPsy.attackthre=S[K].st_lrm:Math.abs(p.internal_flags.nsPsy.attackthre- -1)>0||(p.internal_flags.nsPsy.attackthre=S[K].st_lrm),te!=0?p.internal_flags.nsPsy.attackthre_s=S[K].st_s:Math.abs(p.internal_flags.nsPsy.attackthre_s- -1)>0||(p.internal_flags.nsPsy.attackthre_s=S[K].st_s),te!=0?p.scale=S[K].scale:Math.abs(p.scale- -1)>0||(p.scale=S[K].scale),te!=0?p.maskingadjust=S[K].masking_adj:Math.abs(p.maskingadjust-0)>0||(p.maskingadjust=S[K].masking_adj),S[K].masking_adj>0?te!=0?p.maskingadjust_short=S[K].masking_adj*.9:Math.abs(p.maskingadjust_short-0)>0||(p.maskingadjust_short=S[K].masking_adj*.9):te!=0?p.maskingadjust_short=S[K].masking_adj*1.1:Math.abs(p.maskingadjust_short-0)>0||(p.maskingadjust_short=S[K].masking_adj*1.1),te!=0?p.ATHlower=-S[K].ath_lower/10:Math.abs(-p.ATHlower*10-0)>0||(p.ATHlower=-S[K].ath_lower/10),te!=0?p.ATHcurve=S[K].ath_curve:Math.abs(p.ATHcurve- -1)>0||(p.ATHcurve=S[K].ath_curve),te!=0?p.interChRatio=S[K].interch:Math.abs(p.interChRatio- -1)>0||(p.interChRatio=S[K].interch),M}this.apply_preset=function(p,M,te){switch(M){case Me.R3MIX:{M=Me.V3,p.VBR=U.vbr_mtrh;break}case Me.MEDIUM:{M=Me.V4,p.VBR=U.vbr_rh;break}case Me.MEDIUM_FAST:{M=Me.V4,p.VBR=U.vbr_mtrh;break}case Me.STANDARD:{M=Me.V2,p.VBR=U.vbr_rh;break}case Me.STANDARD_FAST:{M=Me.V2,p.VBR=U.vbr_mtrh;break}case Me.EXTREME:{M=Me.V0,p.VBR=U.vbr_rh;break}case Me.EXTREME_FAST:{M=Me.V0,p.VBR=U.vbr_mtrh;break}case Me.INSANE:return M=320,p.preset=M,le(p,M,te),p.VBR=U.vbr_off,M}switch(p.preset=M,M){case Me.V9:return z(),M;case Me.V8:return z(),M;case Me.V7:return z(),M;case Me.V6:return z(),M;case Me.V5:return z(),M;case Me.V4:return z(),M;case Me.V3:return z(),M;case Me.V2:return z(),M;case Me.V1:return z(),M;case Me.V0:return z(),M}return 8<=M&&M<=320?le(p,M,te):(p.preset=0,M)}}function Ke(){var f;this.setModules=function(D){f=D},this.ResvFrameBegin=function(D,z){var S=D.internal_flags,le,p=S.l3_side,M=f.getframebits(D);z.bits=(M-S.sideinfo_len*8)/S.mode_gr;var te=8*256*S.mode_gr-8;D.brate>320?N():(le=8*1440,D.strict_ISO&&N()),S.ResvMax=le-M,S.ResvMax>te&&(S.ResvMax=te),(S.ResvMax<0||D.disable_reservoir)&&(S.ResvMax=0);var I=z.bits*S.mode_gr+Math.min(S.ResvSize,S.ResvMax);return I>le&&(I=le),p.resvDrain_pre=0,S.pinfo!=null&&N(),I},this.ResvMaxBits=function(D,z,S,le){var p=D.internal_flags,M,te=p.ResvSize,I=p.ResvMax;le!=0&&(te+=z),p.substep_shaping&1&&(I*=.9),S.bits=z,te*10>I*9?(M=te-I*9/10,S.bits+=M,p.substep_shaping|=128):(M=0,p.substep_shaping&=127,!D.disable_reservoir&&!(p.substep_shaping&1)&&(S.bits-=.1*z));var K=te<p.ResvMax*6/10?te:p.ResvMax*6/10;return K-=M,K<0&&(K=0),K},this.ResvAdjust=function(D,z){D.ResvSize-=z.part2_3_length+z.part2_length},this.ResvFrameEnd=function(D,z){var S,le=D.l3_side;D.ResvSize+=z*D.mode_gr;var p=0;le.resvDrain_post=0,le.resvDrain_pre=0,(S=D.ResvSize%8)!=0&&(p+=S),S=D.ResvSize-p-D.ResvMax,S>0&&(p+=S);{var M=Math.min(le.main_data_begin*8,p)/8;le.resvDrain_pre+=8*M,p-=8*M,D.ResvSize-=8*M,le.main_data_begin-=M}le.resvDrain_post+=p,D.ResvSize-=p}}l0.NUMTOCENTRIES=100,l0.MAXFRAMESIZE=2880;function l0(){this.setModules=function(z,S,le){};var f=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function D(z,S){var le=S^z;return S=S>>8^f[le&255],S}this.updateMusicCRC=function(z,S,le,p){for(var M=0;M<p;++M)z[0]=D(S[le+M],z[0])}}qe.EQ=function(f,D){return Math.abs(f)>Math.abs(D)?Math.abs(f-D)<=Math.abs(f)*1e-6:Math.abs(f-D)<=Math.abs(D)*1e-6},qe.NEQ=function(f,D){return!qe.EQ(f,D)};function qe(){var f=this,D=null,z=null;this.setModules=function(i,u,s,y){D=s,z=y};var S=null,le=0,p=0,M=0;this.getframebits=function(i){var u=i.internal_flags,s;u.bitrate_index!=0?s=P.bitrate_table[i.version][u.bitrate_index]:s=i.brate;var y=0|(i.version+1)*72e3*s/i.out_samplerate+u.padding;return 8*y};function te(i){H.arraycopy(i.header[i.w_ptr].buf,0,S,p,i.sideinfo_len),p+=i.sideinfo_len,le+=i.sideinfo_len*8,i.w_ptr=i.w_ptr+1&Ie.MAX_HEADER_BUF-1}function I(i,u,s){for(;s>0;){var y;M==0&&(M=8,p++,i.header[i.w_ptr].write_timing==le&&te(i),S[p]=0),y=Math.min(s,M),s-=y,M-=y,S[p]|=u>>s<<M,le+=y}}function K(i,u){var s=i.internal_flags,y;if(u>=8&&(I(s,76,8),u-=8),u>=8&&(I(s,65,8),u-=8),u>=8&&(I(s,77,8),u-=8),u>=8&&(I(s,69,8),u-=8),u>=32){var r=D.getLameShortVersion();if(u>=32)for(y=0;y<r.length&&u>=8;++y)u-=8,I(s,r.charCodeAt(y),8)}for(;u>=1;u-=1)I(s,s.ancillary_flag,1),s.ancillary_flag^=i.disable_reservoir?0:1}function w(i,u,s){for(var y=i.header[i.h_ptr].ptr;s>0;){var r=Math.min(s,8-(y&7));s-=r,i.header[i.h_ptr].buf[y>>3]|=u>>s<<8-(y&7)-r,y+=r}i.header[i.h_ptr].ptr=y}function ae(i,u){var s=i.internal_flags,y,r,F;if(y=s.l3_side,s.header[s.h_ptr].ptr=0,fe.fill(s.header[s.h_ptr].buf,0,s.sideinfo_len,0),i.out_samplerate<16e3?w(s,4094,12):w(s,4095,12),w(s,i.version,1),w(s,1,2),w(s,i.error_protection?0:1,1),w(s,s.bitrate_index,4),w(s,s.samplerate_index,2),w(s,s.padding,1),w(s,i.extension,1),w(s,i.mode.ordinal(),2),w(s,s.mode_ext,2),w(s,i.copyright,1),w(s,i.original,1),w(s,i.emphasis,2),i.error_protection&&w(s,0,16),i.version==1){for(w(s,y.main_data_begin,9),s.channels_out==2?w(s,y.private_bits,3):w(s,y.private_bits,5),F=0;F<s.channels_out;F++){var o;for(o=0;o<4;o++)w(s,y.scfsi[F][o],1)}for(r=0;r<2;r++)for(F=0;F<s.channels_out;F++){var c=y.tt[r][F];w(s,c.part2_3_length+c.part2_length,12),w(s,c.big_values/2,9),w(s,c.global_gain,8),w(s,c.scalefac_compress,4),c.block_type!=a.NORM_TYPE?(w(s,1,1),w(s,c.block_type,2),w(s,c.mixed_block_flag,1),c.table_select[0]==14&&(c.table_select[0]=16),w(s,c.table_select[0],5),c.table_select[1]==14&&(c.table_select[1]=16),w(s,c.table_select[1],5),w(s,c.subblock_gain[0],3),w(s,c.subblock_gain[1],3),w(s,c.subblock_gain[2],3)):(w(s,0,1),c.table_select[0]==14&&(c.table_select[0]=16),w(s,c.table_select[0],5),c.table_select[1]==14&&(c.table_select[1]=16),w(s,c.table_select[1],5),c.table_select[2]==14&&(c.table_select[2]=16),w(s,c.table_select[2],5),w(s,c.region0_count,4),w(s,c.region1_count,3)),w(s,c.preflag,1),w(s,c.scalefac_scale,1),w(s,c.count1table_select,1)}}else for(w(s,y.main_data_begin,8),w(s,y.private_bits,s.channels_out),r=0,F=0;F<s.channels_out;F++){var c=y.tt[r][F];w(s,c.part2_3_length+c.part2_length,12),w(s,c.big_values/2,9),w(s,c.global_gain,8),w(s,c.scalefac_compress,9),c.block_type!=a.NORM_TYPE?(w(s,1,1),w(s,c.block_type,2),w(s,c.mixed_block_flag,1),c.table_select[0]==14&&(c.table_select[0]=16),w(s,c.table_select[0],5),c.table_select[1]==14&&(c.table_select[1]=16),w(s,c.table_select[1],5),w(s,c.subblock_gain[0],3),w(s,c.subblock_gain[1],3),w(s,c.subblock_gain[2],3)):(w(s,0,1),c.table_select[0]==14&&(c.table_select[0]=16),w(s,c.table_select[0],5),c.table_select[1]==14&&(c.table_select[1]=16),w(s,c.table_select[1],5),c.table_select[2]==14&&(c.table_select[2]=16),w(s,c.table_select[2],5),w(s,c.region0_count,4),w(s,c.region1_count,3)),w(s,c.scalefac_scale,1),w(s,c.count1table_select,1)}i.error_protection&&N();{var _=s.h_ptr;s.h_ptr=_+1&Ie.MAX_HEADER_BUF-1,s.header[s.h_ptr].write_timing=s.header[_].write_timing+u,s.h_ptr==s.w_ptr}}function A(i,u){var s=P.ht[u.count1table_select+32],y,r=0,F=u.big_values,o=u.big_values;for(y=(u.count1-u.big_values)/4;y>0;--y){var c=0,_=0,m;m=u.l3_enc[F+0],m!=0&&(_+=8,u.xr[o+0]<0&&c++),m=u.l3_enc[F+1],m!=0&&(_+=4,c*=2,u.xr[o+1]<0&&c++),m=u.l3_enc[F+2],m!=0&&(_+=2,c*=2,u.xr[o+2]<0&&c++),m=u.l3_enc[F+3],m!=0&&(_++,c*=2,u.xr[o+3]<0&&c++),F+=4,o+=4,I(i,c+s.table[_],s.hlen[_]),r+=s.hlen[_]}return r}function g(i,u,s,y,r){var F=P.ht[u],o=0;if(u==0)return o;for(var c=s;c<y;c+=2){var _=0,m=0,k=F.xlen,t=F.xlen,n=0,G=r.l3_enc[c],B=r.l3_enc[c+1];if(G!=0&&(r.xr[c]<0&&n++,_--),u>15){if(G>14){var $=G-15;n|=$<<1,m=k,G=15}if(B>14){var re=B-15;n<<=k,n|=re,m+=k,B=15}t=16}B!=0&&(n<<=1,r.xr[c+1]<0&&n++,_--),G=G*t+B,m-=_,_+=F.hlen[G],I(i,F.table[G],_),I(i,n,m),o+=_+m}return o}function e(i,u){var s=3*i.scalefac_band.s[3];s>u.big_values&&(s=u.big_values);var y=g(i,u.table_select[0],0,s,u);return y+=g(i,u.table_select[1],s,u.big_values,u),y}function l(i,u){var s,y,r,F;s=u.big_values;var o=u.region0_count+1;return r=i.scalefac_band.l[o],o+=u.region1_count+1,F=i.scalefac_band.l[o],r>s&&(r=s),F>s&&(F=s),y=g(i,u.table_select[0],0,r,u),y+=g(i,u.table_select[1],r,F,u),y+=g(i,u.table_select[2],F,s,u),y}function h(i){var u,s,y,r,F=0,o=i.internal_flags,c=o.l3_side;if(i.version==1)for(u=0;u<2;u++)for(s=0;s<o.channels_out;s++){var _=c.tt[u][s],m=Re.slen1_tab[_.scalefac_compress],k=Re.slen2_tab[_.scalefac_compress];for(r=0,y=0;y<_.sfbdivide;y++)_.scalefac[y]!=-1&&(I(o,_.scalefac[y],m),r+=m);for(;y<_.sfbmax;y++)_.scalefac[y]!=-1&&(I(o,_.scalefac[y],k),r+=k);_.block_type==a.SHORT_TYPE?r+=e(o,_):r+=l(o,_),r+=A(o,_),F+=r}else for(u=0,s=0;s<o.channels_out;s++){var _=c.tt[u][s],t,n,G=0;if(r=0,y=0,n=0,_.block_type==a.SHORT_TYPE){for(;n<4;n++){var B=_.sfb_partition_table[n]/3,$=_.slen[n];for(t=0;t<B;t++,y++)I(o,Math.max(_.scalefac[y*3+0],0),$),I(o,Math.max(_.scalefac[y*3+1],0),$),I(o,Math.max(_.scalefac[y*3+2],0),$),G+=3*$}r+=e(o,_)}else{for(;n<4;n++){var B=_.sfb_partition_table[n],$=_.slen[n];for(t=0;t<B;t++,y++)I(o,Math.max(_.scalefac[y],0),$),G+=$}r+=l(o,_)}r+=A(o,_),F+=G+r}return F}function E(){this.total=0}function d(i,u){var s=i.internal_flags,y,r,F;return s.w_ptr,F=s.h_ptr-1,F==-1&&(F=Ie.MAX_HEADER_BUF-1),y=s.header[F].write_timing-le,u.total=y,y>=0&&N(),r=f.getframebits(i),y+=r,u.total+=r,u.total%8!=0?u.total=1+u.total/8:u.total=u.total/8,u.total+=p+1,y}this.flush_bitstream=function(i){var u=i.internal_flags,s,y;u.h_ptr-1,s=u.l3_side,!((y=d(i,new E))<0)&&(K(i,y),u.ResvSize=0,s.main_data_begin=0,u.findReplayGain&&N(),u.findPeakSample&&N())},this.format_bitstream=function(i){var u=i.internal_flags,s;s=u.l3_side;var y=this.getframebits(i);K(i,s.resvDrain_pre),ae(i,y);var r=8*u.sideinfo_len;if(r+=h(i),K(i,s.resvDrain_post),r+=s.resvDrain_post,s.main_data_begin+=(y-r)/8,d(i,new E)!=u.ResvSize,s.main_data_begin*8!=u.ResvSize&&(u.ResvSize=s.main_data_begin*8),le>1e9){var F;for(F=0;F<Ie.MAX_HEADER_BUF;++F)u.header[F].write_timing-=le;le=0}return 0},this.copy_buffer=function(i,u,s,y,r){var F=p+1;if(F<=0)return 0;if(y!=0&&F>y)return-1;if(H.arraycopy(S,0,u,s,F),p=-1,M=0,r!=0){var o=C(1);o[0]=i.nMusicCRC,z.updateMusicCRC(o,u,s,F),i.nMusicCRC=o[0],F>0&&(i.VBR_seek_table.nBytesWritten+=F),i.decode_on_the_fly&&N()}return F},this.init_bit_stream_w=function(i){S=J(Me.LAME_MAXMP3BUFFER),i.h_ptr=i.w_ptr=0,i.header[i.h_ptr].write_timing=0,p=-1,M=0,le=0}}function _e(f,D,z,S){this.xlen=f,this.linmax=D,this.table=z,this.hlen=S}var P={};P.t1HB=[1,1,1,0],P.t2HB=[1,2,1,3,1,1,3,2,0],P.t3HB=[3,2,1,1,1,1,3,2,0],P.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],P.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],P.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],P.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],P.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],P.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],P.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],P.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],P.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],P.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],P.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],P.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],P.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],P.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],P.t1l=[1,4,3,5],P.t2l=[1,4,7,4,5,7,6,7,8],P.t3l=[2,3,7,4,4,7,6,7,8],P.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],P.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],P.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],P.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],P.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],P.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],P.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],P.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],P.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],P.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],P.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],P.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],P.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],P.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],P.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],P.ht=[new _e(0,0,null,null),new _e(2,0,P.t1HB,P.t1l),new _e(3,0,P.t2HB,P.t2l),new _e(3,0,P.t3HB,P.t3l),new _e(0,0,null,null),new _e(4,0,P.t5HB,P.t5l),new _e(4,0,P.t6HB,P.t6l),new _e(6,0,P.t7HB,P.t7l),new _e(6,0,P.t8HB,P.t8l),new _e(6,0,P.t9HB,P.t9l),new _e(8,0,P.t10HB,P.t10l),new _e(8,0,P.t11HB,P.t11l),new _e(8,0,P.t12HB,P.t12l),new _e(16,0,P.t13HB,P.t13l),new _e(0,0,null,P.t16_5l),new _e(16,0,P.t15HB,P.t15l),new _e(1,1,P.t16HB,P.t16l),new _e(2,3,P.t16HB,P.t16l),new _e(3,7,P.t16HB,P.t16l),new _e(4,15,P.t16HB,P.t16l),new _e(6,63,P.t16HB,P.t16l),new _e(8,255,P.t16HB,P.t16l),new _e(10,1023,P.t16HB,P.t16l),new _e(13,8191,P.t16HB,P.t16l),new _e(4,15,P.t24HB,P.t24l),new _e(5,31,P.t24HB,P.t24l),new _e(6,63,P.t24HB,P.t24l),new _e(7,127,P.t24HB,P.t24l),new _e(8,255,P.t24HB,P.t24l),new _e(9,511,P.t24HB,P.t24l),new _e(11,2047,P.t24HB,P.t24l),new _e(13,8191,P.t24HB,P.t24l),new _e(0,0,P.t32HB,P.t32l),new _e(0,0,P.t33HB,P.t33l)],P.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],P.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],P.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],P.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],P.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],P.scfsi_band=[0,6,11,16,21];function o0(f){this.bits=f}function je(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function Je(){this.setModules=function(f,D){}}function H0(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=b(a.SBMAX_l),this.s=b(a.SBMAX_s),this.psfb21=b(a.PSFB21),this.psfb12=b(a.PSFB12),this.cb_l=b(a.CBANDS),this.cb_s=b(a.CBANDS),this.eql_w=b(a.BLKSIZE/2)}function S0(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=be.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function L0(f){var D=f;this.quantize=D,this.iteration_loop=function(z,S,le,p){var M=z.internal_flags,te=b(Y.SFBMAX),I=b(576),K=C(2),w=0,ae=M.l3_side,A=new o0(w);this.quantize.rv.ResvFrameBegin(z,A),w=A.bits;for(var g=0;g<M.mode_gr;g++){this.quantize.qupvt.on_pe(z,S,K,w,g,g),M.mode_ext==a.MPG_MD_MS_LR&&N();for(var e=0;e<M.channels_out;e++){var l,h,E=ae.tt[g][e];E.block_type!=a.SHORT_TYPE?(l=0,h=M.PSY.mask_adjust-l):(l=0,h=M.PSY.mask_adjust_short-l),M.masking_lower=Math.pow(10,h*.1),this.quantize.init_outer_loop(M,E),this.quantize.init_xrpow(M,E,I)&&(this.quantize.qupvt.calc_xmin(z,p[g][e],E,te),this.quantize.outer_loop(z,E,te,I,e,K[e])),this.quantize.iteration_finish_one(M,g,e)}}this.quantize.rv.ResvFrameEnd(M,w)}}function C0(){}function _0(f,D,z,S){this.l=C(1+a.SBMAX_l),this.s=C(1+a.SBMAX_s),this.psfb21=C(1+a.PSFB21),this.psfb12=C(1+a.PSFB12);var le=this.l,p=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],H.arraycopy(this.arrL,0,le,0,Math.min(this.arrL.length,this.l.length)),H.arraycopy(this.arrS,0,p,0,Math.min(this.arrS.length,this.s.length)),H.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),H.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}c0.Q_MAX=257,c0.Q_MAX2=116,c0.LARGE_BITS=1e5,c0.IXMAX_VAL=8206;function c0(){var f=null,D=null,z=null;this.setModules=function(d,i,u){f=d,D=i,z=u};function S(d){return ae[d+c0.Q_MAX2]}this.IPOW20=function(d){return A[d]};var le=2220446049250313e-31,p=c0.IXMAX_VAL,M=p+2,te=c0.Q_MAX,I=c0.Q_MAX2,K=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var w=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=w,this.sfBandIndex=[new _0([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _0([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _0([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _0([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _0([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _0([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _0([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _0([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _0([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var ae=b(te+I+1),A=b(te),g=b(M),e=b(M);this.adj43=e;function l(d,i){var u=z.ATHformula(i,d);return u-=K,u=Math.pow(10,u/10+d.ATHlower),u}function h(d){for(var i=d.internal_flags.ATH.l,u=d.internal_flags.ATH.psfb21,s=d.internal_flags.ATH.s,y=d.internal_flags.ATH.psfb12,r=d.internal_flags,F=d.out_samplerate,o=0;o<a.SBMAX_l;o++){var c=r.scalefac_band.l[o],_=r.scalefac_band.l[o+1];i[o]=ue.MAX_VALUE;for(var m=c;m<_;m++){var k=m*F/1152,t=l(d,k);i[o]=Math.min(i[o],t)}}for(var o=0;o<a.PSFB21;o++){var c=r.scalefac_band.psfb21[o],_=r.scalefac_band.psfb21[o+1];u[o]=ue.MAX_VALUE;for(var m=c;m<_;m++){var k=m*F/1152,t=l(d,k);u[o]=Math.min(u[o],t)}}for(var o=0;o<a.SBMAX_s;o++){var c=r.scalefac_band.s[o],_=r.scalefac_band.s[o+1];s[o]=ue.MAX_VALUE;for(var m=c;m<_;m++){var k=m*F/384,t=l(d,k);s[o]=Math.min(s[o],t)}s[o]*=r.scalefac_band.s[o+1]-r.scalefac_band.s[o]}for(var o=0;o<a.PSFB12;o++){var c=r.scalefac_band.psfb12[o],_=r.scalefac_band.psfb12[o+1];y[o]=ue.MAX_VALUE;for(var m=c;m<_;m++){var k=m*F/384,t=l(d,k);y[o]=Math.min(y[o],t)}y[o]*=r.scalefac_band.s[13]-r.scalefac_band.s[12]}d.noATH&&N(),r.ATH.floor=10*ce(l(d,-1))}this.iteration_init=function(d){var i=d.internal_flags,u=i.l3_side,s;if(i.iteration_init_init==0){for(i.iteration_init_init=1,u.main_data_begin=0,h(d),g[0]=0,s=1;s<M;s++)g[s]=Math.pow(s,4/3);for(s=0;s<M-1;s++)e[s]=s+1-Math.pow(.5*(g[s]+g[s+1]),.75);for(e[s]=.5,s=0;s<te;s++)A[s]=Math.pow(2,(s-210)*-.1875);for(s=0;s<=te+I;s++)ae[s]=Math.pow(2,(s-210-I)*.25);f.huffman_init(i);{var y,r,F,o;for(s=d.exp_nspsytune>>2&63,s>=32&&(s-=64),y=Math.pow(10,s/4/10),s=d.exp_nspsytune>>8&63,s>=32&&(s-=64),r=Math.pow(10,s/4/10),s=d.exp_nspsytune>>14&63,s>=32&&(s-=64),F=Math.pow(10,s/4/10),s=d.exp_nspsytune>>20&63,s>=32&&(s-=64),o=F*Math.pow(10,s/4/10),s=0;s<a.SBMAX_l;s++){var c;s<=6?c=y:s<=13?c=r:s<=20?c=F:c=o,i.nsPsy.longfact[s]=c}for(s=0;s<a.SBMAX_s;s++){var c;s<=5?c=y:s<=10?c=r:s<=11?c=F:c=o,i.nsPsy.shortfact[s]=c}}}},this.on_pe=function(d,i,u,s,y,r){var F=d.internal_flags,o=0,c,_=C(2),m,k=new o0(o),t=D.ResvMaxBits(d,s,k,r);o=k.bits;var n=o+t;for(n>Ie.MAX_BITS_PER_GRANULE&&(n=Ie.MAX_BITS_PER_GRANULE),c=0,m=0;m<F.channels_out;++m)u[m]=Math.min(Ie.MAX_BITS_PER_CHANNEL,o/F.channels_out),_[m]=0|u[m]*i[y][m]/700-u[m],_[m]>s*3/4&&(_[m]=s*3/4),_[m]<0&&(_[m]=0),_[m]+u[m]>Ie.MAX_BITS_PER_CHANNEL&&(_[m]=Math.max(0,Ie.MAX_BITS_PER_CHANNEL-u[m])),c+=_[m];if(c>t)for(m=0;m<F.channels_out;++m)_[m]=t*_[m]/c;for(m=0;m<F.channels_out;++m)u[m]+=_[m],t-=_[m];for(c=0,m=0;m<F.channels_out;++m)c+=u[m];return c>Ie.MAX_BITS_PER_GRANULE&&N(),n},this.athAdjust=function(d,i,u){var s=90.30873362,y=94.82444863,r=T.FAST_LOG10_X(i,10),F=d*d,o=0;return r-=u,F>1e-20&&(o=1+T.FAST_LOG10_X(F,10/s)),o<0&&(o=0),r*=o,r+=u+s-y,Math.pow(10,.1*r)},this.calc_xmin=function(d,i,u,s){var y=0,r=d.internal_flags,F,o=0,c=0,_=r.ATH,m=u.xr,k=d.VBR==U.vbr_mtrh?1:0,t=r.masking_lower;for((d.VBR==U.vbr_mtrh||d.VBR==U.vbr_mt)&&(t=1),F=0;F<u.psy_lmax;F++){var n,G,B,$,re,ve;d.VBR==U.vbr_rh||d.VBR==U.vbr_mtrh?G=athAdjust(_.adjust,_.l[F],_.floor):G=_.adjust*_.l[F],re=u.width[F],B=G/re,$=le,ve=re>>1,n=0;do{var pe,Oe;pe=m[o]*m[o],n+=pe,$+=pe<B?pe:B,o++,Oe=m[o]*m[o],n+=Oe,$+=Oe<B?Oe:B,o++}while(--ve>0);if(n>G&&c++,F==a.SBPSY_l&&N(),k!=0&&(G=$),!d.ATHonly){var $e=i.en.l[F];if($e>0){var ze;ze=n*i.thm.l[F]*t/$e,k!=0&&(ze*=r.nsPsy.longfact[F]),G<ze&&(G=ze)}}k!=0?s[y++]=G:s[y++]=G*r.nsPsy.longfact[F]}var x0=575;if(u.block_type!=a.SHORT_TYPE)for(var y0=576;y0--!=0&&qe.EQ(m[y0],0);)x0=y0;u.max_nonzero_coeff=x0;for(var d0=u.sfb_smin;F<u.psymax;d0++,F+=3){var re,p0,g0;for(d.VBR==U.vbr_rh||d.VBR==U.vbr_mtrh?g0=athAdjust(_.adjust,_.s[d0],_.floor):g0=_.adjust*_.s[d0],re=u.width[F],p0=0;p0<3;p0++){var n=0,G,B,$,ve=re>>1;B=g0/re,$=le;do{var pe,Oe;pe=m[o]*m[o],n+=pe,$+=pe<B?pe:B,o++,Oe=m[o]*m[o],n+=Oe,$+=Oe<B?Oe:B,o++}while(--ve>0);if(n>g0&&c++,d0==a.SBPSY_s&&N(),k!=0?G=$:G=g0,!d.ATHonly&&!d.ATHshort){var $e=i.en.s[d0][p0];if($e>0){var ze;ze=n*i.thm.s[d0][p0]*t/$e,k!=0&&(ze*=r.nsPsy.shortfact[d0]),G<ze&&(G=ze)}}k!=0?s[y++]=G:s[y++]=G*r.nsPsy.shortfact[d0]}d.useTemporal&&(s[y-3]>s[y-3+1]&&(s[y-3+1]+=(s[y-3]-s[y-3+1])*r.decay),s[y-3+1]>s[y-3+2]&&(s[y-3+2]+=(s[y-3+1]-s[y-3+2])*r.decay))}return c};function E(d){this.s=d}this.calc_noise_core=function(d,i,u,s){var y=0,r=i.s,F=d.l3_enc;if(r>d.count1)for(;u--!=0;){var o;o=d.xr[r],r++,y+=o*o,o=d.xr[r],r++,y+=o*o}else if(r>d.big_values){var c=b(2);for(c[0]=0,c[1]=s;u--!=0;){var o;o=Math.abs(d.xr[r])-c[F[r]],r++,y+=o*o,o=Math.abs(d.xr[r])-c[F[r]],r++,y+=o*o}}else for(;u--!=0;){var o;o=Math.abs(d.xr[r])-g[F[r]]*s,r++,y+=o*o,o=Math.abs(d.xr[r])-g[F[r]]*s,r++,y+=o*o}return i.s=r,y},this.calc_noise=function(d,i,u,s,y){var r=0,F=0,o,c,_=0,m=0,k=0,t=-20,n=0,G=d.scalefac,B=0;for(s.over_SSD=0,o=0;o<d.psymax;o++){var $=d.global_gain-(G[B++]+(d.preflag!=0?w[o]:0)<<d.scalefac_scale+1)-d.subblock_gain[d.window[o]]*8,re=0;if(y!=null&&y.step[o]==$)re=y.noise[o],n+=d.width[o],u[r++]=re/i[F++],re=y.noise_log[o];else{var ve=S($);if(c=d.width[o]>>1,n+d.width[o]>d.max_nonzero_coeff){var pe;pe=d.max_nonzero_coeff-n+1,pe>0?c=pe>>1:c=0}var Oe=new E(n);re=this.calc_noise_core(d,Oe,c,ve),n=Oe.s,y!=null&&(y.step[o]=$,y.noise[o]=re),re=u[r++]=re/i[F++],re=T.FAST_LOG10(Math.max(re,1e-20)),y!=null&&(y.noise_log[o]=re)}if(y!=null&&(y.global_gain=d.global_gain),k+=re,re>0){var $e;$e=Math.max(0|re*10+.5,1),s.over_SSD+=$e*$e,_++,m+=re}t=Math.max(t,re)}return s.over_count=_,s.tot_noise=k,s.over_noise=m,s.max_noise=t,_}}function Xe(){this.global_gain=0,this.sfb_count1=0,this.step=C(39),this.noise=b(39),this.noise_log=b(39)}function Be(){this.xr=b(576),this.l3_enc=C(576),this.scalefac=C(Y.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=C(3),this.subblock_gain=C(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=C(Y.SFBMAX),this.window=C(Y.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=C(4),this.max_nonzero_coeff=0;var f=this;function D(S){return new Int32Array(S)}function z(S){return new Float32Array(S)}this.assign=function(S){f.xr=z(S.xr),f.l3_enc=D(S.l3_enc),f.scalefac=D(S.scalefac),f.xrpow_max=S.xrpow_max,f.part2_3_length=S.part2_3_length,f.big_values=S.big_values,f.count1=S.count1,f.global_gain=S.global_gain,f.scalefac_compress=S.scalefac_compress,f.block_type=S.block_type,f.mixed_block_flag=S.mixed_block_flag,f.table_select=D(S.table_select),f.subblock_gain=D(S.subblock_gain),f.region0_count=S.region0_count,f.region1_count=S.region1_count,f.preflag=S.preflag,f.scalefac_scale=S.scalefac_scale,f.count1table_select=S.count1table_select,f.part2_length=S.part2_length,f.sfb_lmax=S.sfb_lmax,f.sfb_smin=S.sfb_smin,f.psy_lmax=S.psy_lmax,f.sfbmax=S.sfbmax,f.psymax=S.psymax,f.sfbdivide=S.sfbdivide,f.width=D(S.width),f.window=D(S.window),f.count1bits=S.count1bits,f.sfb_partition_table=S.sfb_partition_table.slice(0),f.slen=D(S.slen),f.max_nonzero_coeff=S.max_nonzero_coeff}}var Y={};Y.SFBMAX=a.SBMAX_s*3;function Qe(){this.rv=null;var f;this.qupvt=null;var D,z=new Je,S;this.setModules=function(e,l,h,E){f=l,this.rv=l,D=h,this.qupvt=h,S=E,z.setModules(D,S)};function le(e,l,h,E){E=0;for(var d=0;d<=h;++d){var i=Math.abs(e.xr[d]);E+=i,l[d]=Math.sqrt(i*Math.sqrt(i)),l[d]>e.xrpow_max&&(e.xrpow_max=l[d])}return E}this.init_xrpow=function(e,l,h){var E=0,d=0|l.max_nonzero_coeff;if(l.xrpow_max=0,fe.fill(h,d,576,0),E=le(l,h,d,E),E>1e-20){var i=0;e.substep_shaping&2&&(i=1);for(var u=0;u<l.psymax;u++)e.pseudohalf[u]=i;return!0}return fe.fill(l.l3_enc,0,576,0),!1};function p(e,l){var h=e.ATH,E=l.xr;if(l.block_type!=a.SHORT_TYPE)for(var d=!1,i=a.PSFB21-1;i>=0&&!d;i--){var u=e.scalefac_band.psfb21[i],s=e.scalefac_band.psfb21[i+1],y=D.athAdjust(h.adjust,h.psfb21[i],h.floor);e.nsPsy.longfact[21]>1e-12&&(y*=e.nsPsy.longfact[21]);for(var r=s-1;r>=u;r--)if(Math.abs(E[r])<y)E[r]=0;else{d=!0;break}}else for(var F=0;F<3;F++)for(var d=!1,i=a.PSFB12-1;i>=0&&!d;i--){var u=e.scalefac_band.s[12]*3+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*F+(e.scalefac_band.psfb12[i]-e.scalefac_band.psfb12[0]),s=u+(e.scalefac_band.psfb12[i+1]-e.scalefac_band.psfb12[i]),o=D.athAdjust(h.adjust,h.psfb12[i],h.floor);e.nsPsy.shortfact[12]>1e-12&&(o*=e.nsPsy.shortfact[12]);for(var r=s-1;r>=u;r--)if(Math.abs(E[r])<o)E[r]=0;else{d=!0;break}}}this.init_outer_loop=function(e,l){l.part2_3_length=0,l.big_values=0,l.count1=0,l.global_gain=210,l.scalefac_compress=0,l.table_select[0]=0,l.table_select[1]=0,l.table_select[2]=0,l.subblock_gain[0]=0,l.subblock_gain[1]=0,l.subblock_gain[2]=0,l.subblock_gain[3]=0,l.region0_count=0,l.region1_count=0,l.preflag=0,l.scalefac_scale=0,l.count1table_select=0,l.part2_length=0,l.sfb_lmax=a.SBPSY_l,l.sfb_smin=a.SBPSY_s,l.psy_lmax=e.sfb21_extra?a.SBMAX_l:a.SBPSY_l,l.psymax=l.psy_lmax,l.sfbmax=l.sfb_lmax,l.sfbdivide=11;for(var h=0;h<a.SBMAX_l;h++)l.width[h]=e.scalefac_band.l[h+1]-e.scalefac_band.l[h],l.window[h]=3;if(l.block_type==a.SHORT_TYPE){var E=b(576);l.sfb_smin=0,l.sfb_lmax=0,l.mixed_block_flag!=0&&N(),l.psymax=l.sfb_lmax+3*((e.sfb21_extra?a.SBMAX_s:a.SBPSY_s)-l.sfb_smin),l.sfbmax=l.sfb_lmax+3*(a.SBPSY_s-l.sfb_smin),l.sfbdivide=l.sfbmax-18,l.psy_lmax=l.sfb_lmax;var d=e.scalefac_band.l[l.sfb_lmax];H.arraycopy(l.xr,0,E,0,576);for(var h=l.sfb_smin;h<a.SBMAX_s;h++)for(var i=e.scalefac_band.s[h],u=e.scalefac_band.s[h+1],s=0;s<3;s++)for(var y=i;y<u;y++)l.xr[d++]=E[3*y+s];for(var r=l.sfb_lmax,h=l.sfb_smin;h<a.SBMAX_s;h++)l.width[r]=l.width[r+1]=l.width[r+2]=e.scalefac_band.s[h+1]-e.scalefac_band.s[h],l.window[r]=0,l.window[r+1]=1,l.window[r+2]=2,r+=3}l.count1bits=0,l.sfb_partition_table=D.nr_of_sfb_block[0][0],l.slen[0]=0,l.slen[1]=0,l.slen[2]=0,l.slen[3]=0,l.max_nonzero_coeff=575,fe.fill(l.scalefac,0),p(e,l)};function M(e){this.ordinal=e}M.BINSEARCH_NONE=new M(0),M.BINSEARCH_UP=new M(1),M.BINSEARCH_DOWN=new M(2);function te(e,l,h,E,d){var i,u=e.CurrentStep[E],s=!1,y=e.OldValue[E],r=M.BINSEARCH_NONE;for(l.global_gain=y,h-=l.part2_length;;){var F;if(i=S.count_bits(e,d,l,null),u==1||i==h)break;i>h?(r==M.BINSEARCH_DOWN&&(s=!0),s&&(u/=2),r=M.BINSEARCH_UP,F=u):(r==M.BINSEARCH_UP&&(s=!0),s&&(u/=2),r=M.BINSEARCH_DOWN,F=-u),l.global_gain+=F,l.global_gain<0&&N(),l.global_gain>255&&N()}for(;i>h&&l.global_gain<255;)l.global_gain++,i=S.count_bits(e,d,l,null);return e.CurrentStep[E]=y-l.global_gain>=4?4:2,e.OldValue[E]=l.global_gain,l.part2_3_length=i,i}function I(e){for(var l=0;l<e.sfbmax;l++)if(e.scalefac[l]+e.subblock_gain[e.window[l]]==0)return!1;return!0}function K(e,l,h,E,d){var i;switch(e){default:case 9:{l.over_count>0?(i=h.over_SSD<=l.over_SSD,h.over_SSD==l.over_SSD&&(i=h.bits<l.bits)):i=h.max_noise<0&&h.max_noise*10+h.bits<=l.max_noise*10+l.bits;break}case 0:i=h.over_count<l.over_count||h.over_count==l.over_count&&h.over_noise<l.over_noise||h.over_count==l.over_count&&qe.EQ(h.over_noise,l.over_noise)&&h.tot_noise<l.tot_noise;break;case 8:N();case 1:i=h.max_noise<l.max_noise;break;case 2:i=h.tot_noise<l.tot_noise;break;case 3:i=h.tot_noise<l.tot_noise&&h.max_noise<l.max_noise;break;case 4:i=h.max_noise<=0&&l.max_noise>.2||h.max_noise<=0&&l.max_noise<0&&l.max_noise>h.max_noise-.2&&h.tot_noise<l.tot_noise||h.max_noise<=0&&l.max_noise>0&&l.max_noise>h.max_noise-.2&&h.tot_noise<l.tot_noise+l.over_noise||h.max_noise>0&&l.max_noise>-.05&&l.max_noise>h.max_noise-.1&&h.tot_noise+h.over_noise<l.tot_noise+l.over_noise||h.max_noise>0&&l.max_noise>-.1&&l.max_noise>h.max_noise-.15&&h.tot_noise+h.over_noise+h.over_noise<l.tot_noise+l.over_noise+l.over_noise;break;case 5:i=h.over_noise<l.over_noise||qe.EQ(h.over_noise,l.over_noise)&&h.tot_noise<l.tot_noise;break;case 6:i=h.over_noise<l.over_noise||qe.EQ(h.over_noise,l.over_noise)&&(h.max_noise<l.max_noise||qe.EQ(h.max_noise,l.max_noise)&&h.tot_noise<=l.tot_noise);break;case 7:i=h.over_count<l.over_count||h.over_noise<l.over_noise;break}return l.over_count==0&&(i=i&&h.bits<l.bits),i}function w(e,l,h,E,d){var i=e.internal_flags,u;l.scalefac_scale==0?u=1.2968395546510096:u=1.6817928305074292;for(var s=0,y=0;y<l.sfbmax;y++)s<h[y]&&(s=h[y]);var r=i.noise_shaping_amp;switch(r==3&&N(),r){case 2:break;case 1:s>1?s=Math.pow(s,.5):s*=.95;break;case 0:default:s>1?s=1:s*=.95;break}for(var F=0,y=0;y<l.sfbmax;y++){var o=l.width[y],c;if(F+=o,!(h[y]<s)){for(i.substep_shaping&2&&N(),l.scalefac[y]++,c=-o;c<0;c++)E[F+c]*=u,E[F+c]>l.xrpow_max&&(l.xrpow_max=E[F+c]);if(i.noise_shaping_amp==2)return}}}function ae(e,l){for(var h=1.2968395546510096,E=0,d=0;d<e.sfbmax;d++){var i=e.width[d],u=e.scalefac[d];if(e.preflag!=0&&(u+=D.pretab[d]),E+=i,u&1){u++;for(var s=-i;s<0;s++)l[E+s]*=h,l[E+s]>e.xrpow_max&&(e.xrpow_max=l[E+s])}e.scalefac[d]=u>>1}e.preflag=0,e.scalefac_scale=1}function A(e,l,h){var E,d=l.scalefac;for(E=0;E<l.sfb_lmax;E++)if(d[E]>=16)return!0;for(var i=0;i<3;i++){var u=0,s=0;for(E=l.sfb_lmax+i;E<l.sfbdivide;E+=3)u<d[E]&&(u=d[E]);for(;E<l.sfbmax;E+=3)s<d[E]&&(s=d[E]);if(!(u<16&&s<8)){if(l.subblock_gain[i]>=7)return!0;l.subblock_gain[i]++;var y=e.scalefac_band.l[l.sfb_lmax];for(E=l.sfb_lmax+i;E<l.sfbmax;E+=3){var r,F=l.width[E],o=d[E];if(o=o-(4>>l.scalefac_scale),o>=0){d[E]=o,y+=F*3;continue}d[E]=0;{var c=210+(o<<l.scalefac_scale+1);r=D.IPOW20(c)}y+=F*(i+1);for(var _=-F;_<0;_++)h[y+_]*=r,h[y+_]>l.xrpow_max&&(l.xrpow_max=h[y+_]);y+=F*(3-i-1)}{var r=D.IPOW20(202);y+=l.width[E]*(i+1);for(var _=-l.width[E];_<0;_++)h[y+_]*=r,h[y+_]>l.xrpow_max&&(l.xrpow_max=h[y+_])}}}return!1}function g(e,l,h,E,d){var i=e.internal_flags;w(e,l,h,E);var u=I(l);return u?!1:(i.mode_gr==2?u=S.scale_bitcount(l):u=S.scale_bitcount_lsf(i,l),u?(i.noise_shaping>1&&(fe.fill(i.pseudohalf,0),l.scalefac_scale==0?(ae(l,E),u=!1):l.block_type==a.SHORT_TYPE&&i.subblock_gain>0&&(u=A(i,l,E)||I(l))),u||(i.mode_gr==2?u=S.scale_bitcount(l):u=S.scale_bitcount_lsf(i,l)),!u):!0)}this.outer_loop=function(e,l,h,E,d,i){var u=e.internal_flags,s=new Be,y=b(576),r=b(Y.SFBMAX),F=new je,o,c=new Xe,_=9999999,m=!1,k=!1,t=0;if(te(u,l,i,d,E),u.noise_shaping==0)return 100;D.calc_noise(l,h,r,F,c),F.bits=l.part2_3_length,s.assign(l);var n=0;for(H.arraycopy(E,0,y,0,576);!m;){do{var G=new je,B,$=255;if(u.substep_shaping&2?B=20:B=3,u.sfb21_extra&&N(),!g(e,s,r,E))break;s.scalefac_scale!=0&&($=254);var re=i-s.part2_length;if(re<=0)break;for(;(s.part2_3_length=S.count_bits(u,E,s,c))>re&&s.global_gain<=$;)s.global_gain++;if(s.global_gain>$)break;if(F.over_count==0){for(;(s.part2_3_length=S.count_bits(u,E,s,c))>_&&s.global_gain<=$;)s.global_gain++;if(s.global_gain>$)break}if(D.calc_noise(s,h,r,G,c),G.bits=s.part2_3_length,l.block_type!=a.SHORT_TYPE?o=e.quant_comp:o=e.quant_comp_short,o=K(o,F,G)?1:0,o!=0)_=l.part2_3_length,F=G,l.assign(s),n=0,H.arraycopy(E,0,y,0,576);else if(u.full_outer_loop==0&&(++n>B&&F.over_count==0||u.noise_shaping_amp==3&&k&&n>30||u.noise_shaping_amp==3&&k&&s.global_gain-t>15))break}while(s.global_gain+s.scalefac_scale<255);u.noise_shaping_amp==3?N():m=!0}return e.VBR==U.vbr_rh||e.VBR==U.vbr_mtrh?H.arraycopy(y,0,E,0,576):u.substep_shaping&1&&N(),F.over_count},this.iteration_finish_one=function(e,l,h){var E=e.l3_side,d=E.tt[l][h];S.best_scalefac_store(e,l,h,E),e.use_best_huffman==1&&S.best_huffman_divide(e,d),f.ResvAdjust(e,d)}}function v(){var f=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*T.SQRT2*.5/2384e-9,.017876148*T.SQRT2*.5/2384e-9,.003134727*T.SQRT2*.5/2384e-9,.002457142*T.SQRT2*.5/2384e-9,971317e-9*T.SQRT2*.5/2384e-9,218868e-9*T.SQRT2*.5/2384e-9,101566e-9*T.SQRT2*.5/2384e-9,13828e-9*T.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],D=12,z=36,S=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],le=S[a.SHORT_TYPE],p=S[a.SHORT_TYPE],M=S[a.SHORT_TYPE],te=S[a.SHORT_TYPE],I=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function K(A,g,e){for(var l=10,h=g+238-14-286,E=-15;E<0;E++){var d,i,u;d=f[l+-10],i=A[h+-224]*d,u=A[g+224]*d,d=f[l+-9],i+=A[h+-160]*d,u+=A[g+160]*d,d=f[l+-8],i+=A[h+-96]*d,u+=A[g+96]*d,d=f[l+-7],i+=A[h+-32]*d,u+=A[g+32]*d,d=f[l+-6],i+=A[h+32]*d,u+=A[g+-32]*d,d=f[l+-5],i+=A[h+96]*d,u+=A[g+-96]*d,d=f[l+-4],i+=A[h+160]*d,u+=A[g+-160]*d,d=f[l+-3],i+=A[h+224]*d,u+=A[g+-224]*d,d=f[l+-2],i+=A[g+-256]*d,u-=A[h+256]*d,d=f[l+-1],i+=A[g+-192]*d,u-=A[h+192]*d,d=f[l+0],i+=A[g+-128]*d,u-=A[h+128]*d,d=f[l+1],i+=A[g+-64]*d,u-=A[h+64]*d,d=f[l+2],i+=A[g+0]*d,u-=A[h+0]*d,d=f[l+3],i+=A[g+64]*d,u-=A[h+-64]*d,d=f[l+4],i+=A[g+128]*d,u-=A[h+-128]*d,d=f[l+5],i+=A[g+192]*d,u-=A[h+-192]*d,i*=f[l+6],d=u-i,e[30+E*2]=u+i,e[31+E*2]=f[l+7]*d,l+=18,g--,h++}{var i,u,s,y;u=A[g+-16]*f[l+-10],i=A[g+-32]*f[l+-2],u+=(A[g+-48]-A[g+16])*f[l+-9],i+=A[g+-96]*f[l+-1],u+=(A[g+-80]+A[g+48])*f[l+-8],i+=A[g+-160]*f[l+0],u+=(A[g+-112]-A[g+80])*f[l+-7],i+=A[g+-224]*f[l+1],u+=(A[g+-144]+A[g+112])*f[l+-6],i-=A[g+32]*f[l+2],u+=(A[g+-176]-A[g+144])*f[l+-5],i-=A[g+96]*f[l+3],u+=(A[g+-208]+A[g+176])*f[l+-4],i-=A[g+160]*f[l+4],u+=(A[g+-240]-A[g+208])*f[l+-3],i-=A[g+224],s=i-u,y=i+u,u=e[14],i=e[15]-u,e[31]=y+u,e[30]=s+i,e[15]=s-i,e[14]=y-u}{var r;r=e[28]-e[0],e[0]+=e[28],e[28]=r*f[l+-2*18+7],r=e[29]-e[1],e[1]+=e[29],e[29]=r*f[l+-2*18+7],r=e[26]-e[2],e[2]+=e[26],e[26]=r*f[l+-4*18+7],r=e[27]-e[3],e[3]+=e[27],e[27]=r*f[l+-4*18+7],r=e[24]-e[4],e[4]+=e[24],e[24]=r*f[l+-6*18+7],r=e[25]-e[5],e[5]+=e[25],e[25]=r*f[l+-6*18+7],r=e[22]-e[6],e[6]+=e[22],e[22]=r*T.SQRT2,r=e[23]-e[7],e[7]+=e[23],e[23]=r*T.SQRT2-e[7],e[7]-=e[6],e[22]-=e[7],e[23]-=e[22],r=e[6],e[6]=e[31]-r,e[31]=e[31]+r,r=e[7],e[7]=e[30]-r,e[30]=e[30]+r,r=e[22],e[22]=e[15]-r,e[15]=e[15]+r,r=e[23],e[23]=e[14]-r,e[14]=e[14]+r,r=e[20]-e[8],e[8]+=e[20],e[20]=r*f[l+-10*18+7],r=e[21]-e[9],e[9]+=e[21],e[21]=r*f[l+-10*18+7],r=e[18]-e[10],e[10]+=e[18],e[18]=r*f[l+-12*18+7],r=e[19]-e[11],e[11]+=e[19],e[19]=r*f[l+-12*18+7],r=e[16]-e[12],e[12]+=e[16],e[16]=r*f[l+-14*18+7],r=e[17]-e[13],e[13]+=e[17],e[17]=r*f[l+-14*18+7],r=-e[20]+e[24],e[20]+=e[24],e[24]=r*f[l+-12*18+7],r=-e[21]+e[25],e[21]+=e[25],e[25]=r*f[l+-12*18+7],r=e[4]-e[8],e[4]+=e[8],e[8]=r*f[l+-12*18+7],r=e[5]-e[9],e[5]+=e[9],e[9]=r*f[l+-12*18+7],r=e[0]-e[12],e[0]+=e[12],e[12]=r*f[l+-4*18+7],r=e[1]-e[13],e[1]+=e[13],e[13]=r*f[l+-4*18+7],r=e[16]-e[28],e[16]+=e[28],e[28]=r*f[l+-4*18+7],r=-e[17]+e[29],e[17]+=e[29],e[29]=r*f[l+-4*18+7],r=T.SQRT2*(e[2]-e[10]),e[2]+=e[10],e[10]=r,r=T.SQRT2*(e[3]-e[11]),e[3]+=e[11],e[11]=r,r=T.SQRT2*(-e[18]+e[26]),e[18]+=e[26],e[26]=r-e[18],r=T.SQRT2*(-e[19]+e[27]),e[19]+=e[27],e[27]=r-e[19],r=e[2],e[19]-=e[3],e[3]-=r,e[2]=e[31]-r,e[31]+=r,r=e[3],e[11]-=e[19],e[18]-=r,e[3]=e[30]-r,e[30]+=r,r=e[18],e[27]-=e[11],e[19]-=r,e[18]=e[15]-r,e[15]+=r,r=e[19],e[10]-=r,e[19]=e[14]-r,e[14]+=r,r=e[10],e[11]-=r,e[10]=e[23]-r,e[23]+=r,r=e[11],e[26]-=r,e[11]=e[22]-r,e[22]+=r,r=e[26],e[27]-=r,e[26]=e[7]-r,e[7]+=r,r=e[27],e[27]=e[6]-r,e[6]+=r,r=T.SQRT2*(e[0]-e[4]),e[0]+=e[4],e[4]=r,r=T.SQRT2*(e[1]-e[5]),e[1]+=e[5],e[5]=r,r=T.SQRT2*(e[16]-e[20]),e[16]+=e[20],e[20]=r,r=T.SQRT2*(e[17]-e[21]),e[17]+=e[21],e[21]=r,r=-T.SQRT2*(e[8]-e[12]),e[8]+=e[12],e[12]=r-e[8],r=-T.SQRT2*(e[9]-e[13]),e[9]+=e[13],e[13]=r-e[9],r=-T.SQRT2*(e[25]-e[29]),e[25]+=e[29],e[29]=r-e[25],r=-T.SQRT2*(e[24]+e[28]),e[24]-=e[28],e[28]=r-e[24],r=e[24]-e[16],e[24]=r,r=e[20]-r,e[20]=r,r=e[28]-r,e[28]=r,r=e[25]-e[17],e[25]=r,r=e[21]-r,e[21]=r,r=e[29]-r,e[29]=r,r=e[17]-e[1],e[17]=r,r=e[9]-r,e[9]=r,r=e[25]-r,e[25]=r,r=e[5]-r,e[5]=r,r=e[21]-r,e[21]=r,r=e[13]-r,e[13]=r,r=e[29]-r,e[29]=r,r=e[1]-e[0],e[1]=r,r=e[16]-r,e[16]=r,r=e[17]-r,e[17]=r,r=e[8]-r,e[8]=r,r=e[9]-r,e[9]=r,r=e[24]-r,e[24]=r,r=e[25]-r,e[25]=r,r=e[4]-r,e[4]=r,r=e[5]-r,e[5]=r,r=e[20]-r,e[20]=r,r=e[21]-r,e[21]=r,r=e[12]-r,e[12]=r,r=e[13]-r,e[13]=r,r=e[28]-r,e[28]=r,r=e[29]-r,e[29]=r,r=e[0],e[0]+=e[31],e[31]-=r,r=e[1],e[1]+=e[30],e[30]-=r,r=e[16],e[16]+=e[15],e[15]-=r,r=e[17],e[17]+=e[14],e[14]-=r,r=e[8],e[8]+=e[23],e[23]-=r,r=e[9],e[9]+=e[22],e[22]-=r,r=e[24],e[24]+=e[7],e[7]-=r,r=e[25],e[25]+=e[6],e[6]-=r,r=e[4],e[4]+=e[27],e[27]-=r,r=e[5],e[5]+=e[26],e[26]-=r,r=e[20],e[20]+=e[11],e[11]-=r,r=e[21],e[21]+=e[10],e[10]-=r,r=e[12],e[12]+=e[19],e[19]-=r,r=e[13],e[13]+=e[18],e[18]-=r,r=e[28],e[28]+=e[3],e[3]-=r,r=e[29],e[29]+=e[2],e[2]-=r}}function w(A,g){for(var e=0;e<3;e++){var l,h,E,d,i,u;d=A[g+2*3]*S[a.SHORT_TYPE][0]-A[g+5*3],l=A[g+0*3]*S[a.SHORT_TYPE][2]-A[g+3*3],h=d+l,E=d-l,d=A[g+5*3]*S[a.SHORT_TYPE][0]+A[g+2*3],l=A[g+3*3]*S[a.SHORT_TYPE][2]+A[g+0*3],i=d+l,u=-d+l,l=(A[g+1*3]*S[a.SHORT_TYPE][1]-A[g+4*3])*2069978111953089e-26,d=(A[g+4*3]*S[a.SHORT_TYPE][1]+A[g+1*3])*2069978111953089e-26,A[g+3*0]=h*190752519173728e-25+l,A[g+3*5]=-i*190752519173728e-25+d,E=E*.8660254037844387*1907525191737281e-26,i=i*.5*1907525191737281e-26+d,A[g+3*1]=E-i,A[g+3*2]=E+i,h=h*.5*1907525191737281e-26-l,u=u*.8660254037844387*1907525191737281e-26,A[g+3*3]=h+u,A[g+3*4]=h-u,g++}}function ae(A,g,e){var l,h;{var E,d,i,u,s,y,r,F;E=e[17]-e[9],i=e[15]-e[11],u=e[14]-e[12],s=e[0]+e[8],y=e[1]+e[7],r=e[2]+e[6],F=e[3]+e[5],A[g+17]=s+r-F-(y-e[4]),h=(s+r-F)*p[19]+(y-e[4]),l=(E-i-u)*p[18],A[g+5]=l+h,A[g+6]=l-h,d=(e[16]-e[10])*p[18],y=y*p[19]+e[4],l=E*p[12]+d+i*p[13]+u*p[14],h=-s*p[16]+y-r*p[17]+F*p[15],A[g+1]=l+h,A[g+2]=l-h,l=E*p[13]-d-i*p[14]+u*p[12],h=-s*p[17]+y-r*p[15]+F*p[16],A[g+9]=l+h,A[g+10]=l-h,l=E*p[14]-d+i*p[12]-u*p[13],h=s*p[15]-y+r*p[16]-F*p[17],A[g+13]=l+h,A[g+14]=l-h}{var o,c,_,m,k,t,n,G;o=e[8]-e[0],_=e[6]-e[2],m=e[5]-e[3],k=e[17]+e[9],t=e[16]+e[10],n=e[15]+e[11],G=e[14]+e[12],A[g+0]=k+n+G+(t+e[13]),l=(k+n+G)*p[19]-(t+e[13]),h=(o-_+m)*p[18],A[g+11]=l+h,A[g+12]=l-h,c=(e[7]-e[1])*p[18],t=e[13]-t*p[19],l=k*p[15]-t+n*p[16]+G*p[17],h=o*p[14]+c+_*p[12]+m*p[13],A[g+3]=l+h,A[g+4]=l-h,l=-k*p[17]+t-n*p[15]-G*p[16],h=o*p[13]+c-_*p[14]-m*p[12],A[g+7]=l+h,A[g+8]=l-h,l=-k*p[16]+t-n*p[17]-G*p[15],h=o*p[12]-c+_*p[13]-m*p[14],A[g+15]=l+h,A[g+16]=l-h}}this.mdct_sub48=function(A,g,e){for(var l=g,h=286,E=0;E<A.channels_out;E++){for(var d=0;d<A.mode_gr;d++){for(var i,u=A.l3_side.tt[d][E],s=u.xr,y=0,r=A.sb_sample[E][1-d],F=0,o=0;o<18/2;o++)for(K(l,h,r[F]),K(l,h+32,r[F+1]),F+=2,h+=64,i=1;i<32;i+=2)r[F-1][i]*=-1;for(i=0;i<32;i++,y+=18){var c=u.block_type,_=A.sb_sample[E][d],m=A.sb_sample[E][1-d];if(u.mixed_block_flag!=0&&i<2&&(c=0),A.amp_filter[i]<1e-12)fe.fill(s,y+0,y+18,0);else if(A.amp_filter[i]<1&&N(),c==a.SHORT_TYPE){for(var o=-D/4;o<0;o++){var k=S[a.SHORT_TYPE][o+3];s[y+o*3+9]=_[9+o][I[i]]*k-_[8-o][I[i]],s[y+o*3+18]=_[14-o][I[i]]*k+_[15+o][I[i]],s[y+o*3+10]=_[15+o][I[i]]*k-_[14-o][I[i]],s[y+o*3+19]=m[2-o][I[i]]*k+m[3+o][I[i]],s[y+o*3+11]=m[3+o][I[i]]*k-m[2-o][I[i]],s[y+o*3+20]=m[8-o][I[i]]*k+m[9+o][I[i]]}w(s,y)}else{for(var t=b(18),o=-z/4;o<0;o++){var n,G;n=S[c][o+27]*m[o+9][I[i]]+S[c][o+36]*m[8-o][I[i]],G=S[c][o+9]*_[o+9][I[i]]-S[c][o+18]*_[8-o][I[i]],t[o+9]=n-G*le[3+o+9],t[o+18]=n*le[3+o+9]+G}ae(s,y,t)}if(c!=a.SHORT_TYPE&&i!=0)for(var o=7;o>=0;--o){var B,$;B=s[y+o]*M[20+o]+s[y+-1-o]*te[28+o],$=s[y+o]*te[28+o]-s[y+-1-o]*M[20+o],s[y+-1-o]=B,s[y+o]=$}}}if(l=e,h=286,A.mode_gr==1)for(var re=0;re<18;re++)H.arraycopy(A.sb_sample[E][1][re],0,A.sb_sample[E][0][re],0,32)}}}function x(){this.thm=new me,this.en=new me}a.ENCDELAY=576,a.POSTDELAY=1152,a.MDCTDELAY=48,a.FFTOFFSET=224+a.MDCTDELAY,a.DECDELAY=528,a.SBLIMIT=32,a.CBANDS=64,a.SBPSY_l=21,a.SBPSY_s=12,a.SBMAX_l=22,a.SBMAX_s=13,a.PSFB21=6,a.PSFB12=6,a.BLKSIZE=1024,a.HBLKSIZE=a.BLKSIZE/2+1,a.BLKSIZE_s=256,a.HBLKSIZE_s=a.BLKSIZE_s/2+1,a.NORM_TYPE=0,a.START_TYPE=1,a.SHORT_TYPE=2,a.STOP_TYPE=3,a.MPG_MD_LR_LR=0,a.MPG_MD_LR_I=1,a.MPG_MD_MS_LR=2,a.MPG_MD_MS_I=3,a.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function a(){var f=a.MPG_MD_MS_LR,D=null;this.psy=null;var z=null,S=null;this.setModules=function(I,K,w,ae){D=I,this.psy=K,z=K,S=ae};var le=new v;function p(I){var K,w;if(I.ATH.useAdjust==0){I.ATH.adjust=1;return}if(w=I.loudness_sq[0][0],K=I.loudness_sq[1][0],I.channels_out==2?N():(w+=w,K+=K),I.mode_gr==2&&(w=Math.max(w,K)),w*=.5,w*=I.ATH.aaSensitivityP,w>.03125)I.ATH.adjust>=1?I.ATH.adjust=1:I.ATH.adjust<I.ATH.adjustLimit&&(I.ATH.adjust=I.ATH.adjustLimit),I.ATH.adjustLimit=1;else{var ae=31.98*w+625e-6;I.ATH.adjust>=ae?(I.ATH.adjust*=ae*.075+.925,I.ATH.adjust<ae&&(I.ATH.adjust=ae)):I.ATH.adjustLimit>=ae?I.ATH.adjust=ae:I.ATH.adjust<I.ATH.adjustLimit&&(I.ATH.adjust=I.ATH.adjustLimit),I.ATH.adjustLimit=ae}}function M(I){var K,w;for(I.bitrate_stereoMode_Hist[I.bitrate_index][4]++,I.bitrate_stereoMode_Hist[15][4]++,I.channels_out==2&&N(),K=0;K<I.mode_gr;++K)for(w=0;w<I.channels_out;++w){var ae=I.l3_side.tt[K][w].block_type|0;I.l3_side.tt[K][w].mixed_block_flag!=0&&(ae=4),I.bitrate_blockType_Hist[I.bitrate_index][ae]++,I.bitrate_blockType_Hist[I.bitrate_index][5]++,I.bitrate_blockType_Hist[15][ae]++,I.bitrate_blockType_Hist[15][5]++}}function te(I,K){var w=I.internal_flags,ae,A;if(w.lame_encode_frame_init==0){var g,e,l=b(2014),h=b(2014);for(w.lame_encode_frame_init=1,g=0,e=0;g<286+576*(1+w.mode_gr);++g)g<576*w.mode_gr?(l[g]=0,w.channels_out==2&&(h[g]=0)):(l[g]=K[0][e],w.channels_out==2&&(h[g]=K[1][e]),++e);for(A=0;A<w.mode_gr;A++)for(ae=0;ae<w.channels_out;ae++)w.l3_side.tt[A][ae].block_type=a.SHORT_TYPE;le.mdct_sub48(w,l,h)}}this.lame_encode_mp3_frame=function(I,K,w,ae,A,g){var e,l=W([2,2]);l[0][0]=new x,l[0][1]=new x,l[1][0]=new x,l[1][1]=new x;var h=W([2,2]);h[0][0]=new x,h[0][1]=new x,h[1][0]=new x,h[1][1]=new x;var E,d=[null,null],i=I.internal_flags,u=V([2,4]),s=[.5,.5],y=[[0,0],[0,0]],r=[[0,0],[0,0]],F,o,c;if(d[0]=K,d[1]=w,i.lame_encode_frame_init==0&&te(I,d),i.padding=0,(i.slot_lag-=i.frac_SpF)<0&&(i.slot_lag+=I.out_samplerate,i.padding=1),i.psymodel!=0){var _,m=[null,null],k=0,t=C(2);for(c=0;c<i.mode_gr;c++){for(o=0;o<i.channels_out;o++)m[o]=d[o],k=576+c*576-a.FFTOFFSET;if(I.VBR==U.vbr_mtrh||I.VBR==U.vbr_mt?N():_=z.L3psycho_anal_ns(I,m,k,c,l,h,y[c],r[c],u[c],t),_!=0)return-4;for(I.mode==be.JOINT_STEREO&&N(),o=0;o<i.channels_out;o++){var n=i.l3_side.tt[c][o];n.block_type=t[o],n.mixed_block_flag=0}}}else N();if(p(i),le.mdct_sub48(i,d[0],d[1]),i.mode_ext=a.MPG_MD_LR_LR,I.force_ms?i.mode_ext=a.MPG_MD_MS_LR:I.mode==be.JOINT_STEREO&&N(),i.mode_ext==f?(E=h,F=r):(E=l,F=y),I.analysis&&i.pinfo!=null&&N(),I.VBR==U.vbr_off||I.VBR==U.vbr_abr){var G,B;for(G=0;G<18;G++)i.nsPsy.pefirbuf[G]=i.nsPsy.pefirbuf[G+1];for(B=0,c=0;c<i.mode_gr;c++)for(o=0;o<i.channels_out;o++)B+=F[c][o];for(i.nsPsy.pefirbuf[18]=B,B=i.nsPsy.pefirbuf[9],G=0;G<9;G++)B+=(i.nsPsy.pefirbuf[G]+i.nsPsy.pefirbuf[18-G])*a.fircoef[G];for(B=670*5*i.mode_gr*i.channels_out/B,c=0;c<i.mode_gr;c++)for(o=0;o<i.channels_out;o++)F[c][o]*=B}return i.iteration_loop.iteration_loop(I,F,s,E),D.format_bitstream(I),e=D.copy_buffer(i,ae,A,g,1),I.bWriteVbrTag&&S.addVbrFrame(I),I.analysis&&i.pinfo!=null&&N(),M(i),e}}function O(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function ee(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[C(4),C(4)];for(var f=0;f<2;f++)for(var D=0;D<2;D++)this.tt[f][D]=new Be}function me(){this.l=b(a.SBMAX_l),this.s=V([a.SBMAX_s,3]);var f=this;this.assign=function(D){H.arraycopy(D.l,0,f.l,0,a.SBMAX_l);for(var z=0;z<a.SBMAX_s;z++)for(var S=0;S<3;S++)f.s[z][S]=D.s[z][S]}}function he(){this.last_en_subshort=V([4,9]),this.lastAttacks=C(4),this.pefirbuf=b(19),this.longfact=b(a.SBMAX_l),this.shortfact=b(a.SBMAX_s),this.attackthre=0,this.attackthre_s=0}Ie.MFSIZE=3*1152+a.ENCDELAY-a.MDCTDELAY,Ie.MAX_HEADER_BUF=256,Ie.MAX_BITS_PER_CHANNEL=4095,Ie.MAX_BITS_PER_GRANULE=7680,Ie.BPC=320;function Ie(){var f=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=V([2,Ie.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new ee,this.ms_ratio=b(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=C(2),this.CurrentStep=C(2),this.masking_lower=0,this.bv_scf=C(576),this.pseudohalf=C(Y.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*Ie.BPC+1),this.itime=Z(2),this.sideinfo_len=0,this.sb_sample=V([2,2,18,a.SBLIMIT]),this.amp_filter=b(32);function D(){this.write_timing=0,this.ptr=0,this.buf=J(f)}this.header=new Array(Ie.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new _0,this.minval_l=b(a.CBANDS),this.minval_s=b(a.CBANDS),this.nb_1=V([4,a.CBANDS]),this.nb_2=V([4,a.CBANDS]),this.nb_s1=V([4,a.CBANDS]),this.nb_s2=V([4,a.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=b(4),this.loudness_sq=V([2,2]),this.loudness_sq_save=b(2),this.mld_l=b(a.SBMAX_l),this.mld_s=b(a.SBMAX_s),this.bm_l=C(a.SBMAX_l),this.bo_l=C(a.SBMAX_l),this.bm_s=C(a.SBMAX_s),this.bo_s=C(a.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=q([a.CBANDS,2]),this.s3ind_s=q([a.CBANDS,2]),this.numlines_s=C(a.CBANDS),this.numlines_l=C(a.CBANDS),this.rnumlines_l=b(a.CBANDS),this.mld_cb_l=b(a.CBANDS),this.mld_cb_s=b(a.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=b(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=C(2),this.nsPsy=new he,this.VBR_seek_table=new O,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=q([16,5]),this.bitrate_blockType_Hist=q([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var z=0;z<this.en.length;z++)this.en[z]=new me;for(var z=0;z<this.thm.length;z++)this.thm[z]=new me;for(var z=0;z<this.header.length;z++)this.header[z]=new D}function Le(){var f=b(a.BLKSIZE),D=b(a.BLKSIZE_s/2),z=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function S(p,M,te){var I=0,K,w,ae;te<<=1;var A=M+te;K=4;do{var g,e,l,h,E,d,i;i=K>>1,h=K,E=K<<1,d=E+h,K=E<<1,w=M,ae=w+i;do{var u,s,y,r;s=p[w+0]-p[w+h],u=p[w+0]+p[w+h],r=p[w+E]-p[w+d],y=p[w+E]+p[w+d],p[w+E]=u-y,p[w+0]=u+y,p[w+d]=s-r,p[w+h]=s+r,s=p[ae+0]-p[ae+h],u=p[ae+0]+p[ae+h],r=T.SQRT2*p[ae+d],y=T.SQRT2*p[ae+E],p[ae+E]=u-y,p[ae+0]=u+y,p[ae+d]=s-r,p[ae+h]=s+r,ae+=K,w+=K}while(w<A);for(e=z[I+0],g=z[I+1],l=1;l<i;l++){var F,o;F=1-2*g*g,o=2*g*e,w=M+l,ae=M+h-l;do{var c,_,m,u,s,k,y,t,r,n;_=o*p[w+h]-F*p[ae+h],c=F*p[w+h]+o*p[ae+h],s=p[w+0]-c,u=p[w+0]+c,k=p[ae+0]-_,m=p[ae+0]+_,_=o*p[w+d]-F*p[ae+d],c=F*p[w+d]+o*p[ae+d],r=p[w+E]-c,y=p[w+E]+c,n=p[ae+E]-_,t=p[ae+E]+_,_=g*y-e*n,c=e*y+g*n,p[w+E]=u-c,p[w+0]=u+c,p[ae+d]=k-_,p[ae+h]=k+_,_=e*t-g*r,c=g*t+e*r,p[ae+E]=m-c,p[ae+0]=m+c,p[w+d]=s-_,p[w+h]=s+_,ae+=K,w+=K}while(w<A);F=e,e=F*z[I+0]-g*z[I+1],g=F*z[I+1]+g*z[I+0]}I+=2}while(K<te)}var le=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(p,M,te,I,K){for(var w=0;w<3;w++){var ae=a.BLKSIZE_s/2,A=65535&576/3*(w+1),g=a.BLKSIZE_s/8-1;do{var e,l,h,E,d,i=le[g<<2]&255;e=D[i]*I[te][K+i+A],d=D[127-i]*I[te][K+i+A+128],l=e-d,e=e+d,h=D[i+64]*I[te][K+i+A+64],d=D[63-i]*I[te][K+i+A+192],E=h-d,h=h+d,ae-=4,M[w][ae+0]=e+h,M[w][ae+2]=e-h,M[w][ae+1]=l+E,M[w][ae+3]=l-E,e=D[i+1]*I[te][K+i+A+1],d=D[126-i]*I[te][K+i+A+129],l=e-d,e=e+d,h=D[i+65]*I[te][K+i+A+65],d=D[62-i]*I[te][K+i+A+193],E=h-d,h=h+d,M[w][ae+a.BLKSIZE_s/2+0]=e+h,M[w][ae+a.BLKSIZE_s/2+2]=e-h,M[w][ae+a.BLKSIZE_s/2+1]=l+E,M[w][ae+a.BLKSIZE_s/2+3]=l-E}while(--g>=0);S(M[w],ae,a.BLKSIZE_s/2)}},this.fft_long=function(p,M,te,I,K){var w=a.BLKSIZE/8-1,ae=a.BLKSIZE/2;do{var A,g,e,l,h,E=le[w]&255;A=f[E]*I[te][K+E],h=f[E+512]*I[te][K+E+512],g=A-h,A=A+h,e=f[E+256]*I[te][K+E+256],h=f[E+768]*I[te][K+E+768],l=e-h,e=e+h,ae-=4,M[ae+0]=A+e,M[ae+2]=A-e,M[ae+1]=g+l,M[ae+3]=g-l,A=f[E+1]*I[te][K+E+1],h=f[E+513]*I[te][K+E+513],g=A-h,A=A+h,e=f[E+257]*I[te][K+E+257],h=f[E+769]*I[te][K+E+769],l=e-h,e=e+h,M[ae+a.BLKSIZE/2+0]=A+e,M[ae+a.BLKSIZE/2+2]=A-e,M[ae+a.BLKSIZE/2+1]=g+l,M[ae+a.BLKSIZE/2+3]=g-l}while(--w>=0);S(M,ae,a.BLKSIZE/2)},this.init_fft=function(p){for(var M=0;M<a.BLKSIZE;M++)f[M]=.42-.5*Math.cos(2*Math.PI*(M+.5)/a.BLKSIZE)+.08*Math.cos(4*Math.PI*(M+.5)/a.BLKSIZE);for(var M=0;M<a.BLKSIZE_s/2;M++)D[M]=.5*(1-Math.cos(2*Math.PI*(M+.5)/a.BLKSIZE_s))}}function Ve(){var f=new Le,D=2.302585092994046,z=2,S=16,le=2,p=16,M=.34,te=1/(14752*14752)/(a.BLKSIZE/2),I=.01,K=.8,w=.6,ae=.3,A=3.5,g=21,e=.2302585093;function l(X,L){for(var j=0,Ae=0;Ae<a.BLKSIZE/2;++Ae)j+=X[Ae]*L.ATH.eql_w[Ae];return j*=te,j}function h(X,L,j,Ae,Ce,ne,we,Se,Te,Ye,Ee){var h0=X.internal_flags;Te<2?(f.fft_long(h0,Ae[Ce],Te,Ye,Ee),f.fft_short(h0,ne[we],Te,Ye,Ee)):Te==2&&N(),L[0]=Ae[Ce+0][0],L[0]*=L[0];for(var t0=a.BLKSIZE/2-1;t0>=0;--t0){var f0=Ae[Ce+0][a.BLKSIZE/2-t0],b0=Ae[Ce+0][a.BLKSIZE/2+t0];L[a.BLKSIZE/2-t0]=(f0*f0+b0*b0)*.5}for(var n0=2;n0>=0;--n0){j[n0][0]=ne[we+0][n0][0],j[n0][0]*=j[n0][0];for(var t0=a.BLKSIZE_s/2-1;t0>=0;--t0){var f0=ne[we+0][n0][a.BLKSIZE_s/2-t0],b0=ne[we+0][n0][a.BLKSIZE_s/2+t0];j[n0][a.BLKSIZE_s/2-t0]=(f0*f0+b0*b0)*.5}}{for(var Ge=0,t0=11;t0<a.HBLKSIZE;t0++)Ge+=L[t0];h0.tot_ener[Te]=Ge}X.analysis&&N(),X.athaa_loudapprox==2&&Te<2&&(h0.loudness_sq[Se][Te]=h0.loudness_sq_save[Te],h0.loudness_sq_save[Te]=l(L,h0))}var E=8,d=23,i=15,u,s,y,r=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function F(){u=Math.pow(10,(E+1)/16),s=Math.pow(10,(d+1)/16),y=Math.pow(10,i/10)}var o=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],c=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],_=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function m(X,L,j,Ae,Ce,ne){var we;if(L>X)if(L<X*s)we=L/X;else return X+L;else{if(X>=L*s)return X+L;we=X/L}if(X+=L,Ae+3<=6){if(we>=u)return X;var Se=0|T.FAST_LOG10_X(we,16);return X*c[Se]}var Se=0|T.FAST_LOG10_X(we,16);if(L=Ce.ATH.cb_l[j]*Ce.ATH.adjust,X<y*L){if(X>L){var Te,Ye;return Te=1,Se<=13&&(Te=_[Se]),Ye=T.FAST_LOG10_X(X/L,10/15),X*((o[Se]-Te)*Ye+Te)}return Se>13?X:X*_[Se]}return X*o[Se]}function k(X,L,j,Ae,Ce){var ne,we,Se=0,Te=0;for(ne=we=0;ne<a.SBMAX_s;++we,++ne){for(var Ye=X.bo_s[ne],Ee=X.npart_s,h0=Ye<Ee?Ye:Ee;we<h0;)Se+=L[we],Te+=j[we],we++;if(X.en[Ae].s[ne][Ce]=Se,X.thm[Ae].s[ne][Ce]=Te,we>=Ee){++ne;break}{var t0=X.PSY.bo_s_weight[ne],f0=1-t0;Se=t0*L[we],Te=t0*j[we],X.en[Ae].s[ne][Ce]+=Se,X.thm[Ae].s[ne][Ce]+=Te,Se=f0*L[we],Te=f0*j[we]}}for(;ne<a.SBMAX_s;++ne)X.en[Ae].s[ne][Ce]=0,X.thm[Ae].s[ne][Ce]=0}function t(X,L,j,Ae){var Ce,ne,we=0,Se=0;for(Ce=ne=0;Ce<a.SBMAX_l;++ne,++Ce){for(var Te=X.bo_l[Ce],Ye=X.npart_l,Ee=Te<Ye?Te:Ye;ne<Ee;)we+=L[ne],Se+=j[ne],ne++;if(X.en[Ae].l[Ce]=we,X.thm[Ae].l[Ce]=Se,ne>=Ye){++Ce;break}{var h0=X.PSY.bo_l_weight[Ce],t0=1-h0;we=h0*L[ne],Se=h0*j[ne],X.en[Ae].l[Ce]+=we,X.thm[Ae].l[Ce]+=Se,we=t0*L[ne],Se=t0*j[ne]}}for(;Ce<a.SBMAX_l;++Ce)X.en[Ae].l[Ce]=0,X.thm[Ae].l[Ce]=0}function n(X,L,j,Ae,Ce,ne){var we=X.internal_flags,Se,Te;for(Te=Se=0;Te<we.npart_s;++Te){for(var Ye=0,Ee=we.numlines_s[Te],h0=0;h0<Ee;++h0,++Se){var t0=L[ne][Se];Ye+=t0}j[Te]=Ye}for(Se=Te=0;Te<we.npart_s;Te++){var f0=we.s3ind_s[Te][0],b0=we.s3_ss[Se++]*j[f0];for(++f0;f0<=we.s3ind_s[Te][1];)b0+=we.s3_ss[Se]*j[f0],++Se,++f0;{var n0=le*we.nb_s1[Ce][Te];Ae[Te]=Math.min(b0,n0)}if(we.blocktype_old[Ce&1]==a.SHORT_TYPE){var n0=p*we.nb_s2[Ce][Te],Ge=Ae[Te];Ae[Te]=Math.min(n0,Ge)}we.nb_s2[Ce][Te]=we.nb_s1[Ce][Te],we.nb_s1[Ce][Te]=b0}for(;Te<=a.CBANDS;++Te)j[Te]=0,Ae[Te]=0}function G(X,L,j,Ae){var Ce=X.internal_flags;X.short_blocks==R.short_block_coupled&&!(L[0]!=0&&L[1]!=0)&&(L[0]=L[1]=0);for(var ne=0;ne<Ce.channels_out;ne++)Ae[ne]=a.NORM_TYPE,X.short_blocks==R.short_block_dispensed&&(L[ne]=1),X.short_blocks==R.short_block_forced&&(L[ne]=0),L[ne]!=0?Ce.blocktype_old[ne]==a.SHORT_TYPE&&(Ae[ne]=a.STOP_TYPE):(Ae[ne]=a.SHORT_TYPE,Ce.blocktype_old[ne]==a.NORM_TYPE&&(Ce.blocktype_old[ne]=a.START_TYPE),Ce.blocktype_old[ne]==a.STOP_TYPE&&(Ce.blocktype_old[ne]=a.SHORT_TYPE)),j[ne]=Ce.blocktype_old[ne],Ce.blocktype_old[ne]=Ae[ne]}function B(X,L,j){return j>=1?X:j<=0?L:L>0?Math.pow(X/L,j)*L:0}var $=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function re(X,L){for(var j=309.07,Ae=0;Ae<a.SBMAX_s-1;Ae++)for(var Ce=0;Ce<3;Ce++){var ne=X.thm.s[Ae][Ce];if(ne>0){var we=ne*L,Se=X.en.s[Ae][Ce];Se>we&&(Se>we*1e10?j+=$[Ae]*(10*D):j+=$[Ae]*T.FAST_LOG10(Se/we))}}return j}var ve=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function pe(X,L){for(var j=281.0575,Ae=0;Ae<a.SBMAX_l-1;Ae++){var Ce=X.thm.l[Ae];if(Ce>0){var ne=Ce*L,we=X.en.l[Ae];we>ne&&(we>ne*1e10?j+=ve[Ae]*(10*D):j+=ve[Ae]*T.FAST_LOG10(we/ne))}}return j}function Oe(X,L,j,Ae,Ce){var ne,we;for(ne=we=0;ne<X.npart_l;++ne){var Se=0,Te=0,Ye;for(Ye=0;Ye<X.numlines_l[ne];++Ye,++we){var Ee=L[we];Se+=Ee,Te<Ee&&(Te=Ee)}j[ne]=Se,Ae[ne]=Te,Ce[ne]=Se*X.rnumlines_l[ne]}}function $e(X,L,j,Ae){var Ce=r.length-1,ne=0,we=j[ne]+j[ne+1];if(we>0){var Se=L[ne];Se<L[ne+1]&&(Se=L[ne+1]),we=20*(Se*2-we)/(we*(X.numlines_l[ne]+X.numlines_l[ne+1]-1));var Te=0|we;Te>Ce&&(Te=Ce),Ae[ne]=Te}else Ae[ne]=0;for(ne=1;ne<X.npart_l-1;ne++)if(we=j[ne-1]+j[ne]+j[ne+1],we>0){var Se=L[ne-1];Se<L[ne]&&(Se=L[ne]),Se<L[ne+1]&&(Se=L[ne+1]),we=20*(Se*3-we)/(we*(X.numlines_l[ne-1]+X.numlines_l[ne]+X.numlines_l[ne+1]-1));var Te=0|we;Te>Ce&&(Te=Ce),Ae[ne]=Te}else Ae[ne]=0;if(we=j[ne-1]+j[ne],we>0){var Se=L[ne-1];Se<L[ne]&&(Se=L[ne]),we=20*(Se*2-we)/(we*(X.numlines_l[ne-1]+X.numlines_l[ne]-1));var Te=0|we;Te>Ce&&(Te=Ce),Ae[ne]=Te}else Ae[ne]=0}var ze=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(X,L,j,Ae,Ce,ne,we,Se,Te,Ye){var Ee=X.internal_flags,h0=V([2,a.BLKSIZE]),t0=V([2,3,a.BLKSIZE_s]),f0=b(a.CBANDS+1),b0=b(a.CBANDS+1),n0=b(a.CBANDS+2),Ge=C(2),u0=C(2),M0,He,We,Ue,m0,W0,D0,i0,pt=V([2,576]),F0,et=C(a.CBANDS+2),st=C(a.CBANDS+2);for(fe.fill(st,0),M0=Ee.channels_out,X.mode==be.JOINT_STEREO&&(M0=4),X.VBR==U.vbr_off?F0=Ee.ResvMax==0?0:Ee.ResvSize/Ee.ResvMax*.5:X.VBR==U.vbr_rh||X.VBR==U.vbr_mtrh||X.VBR==U.vbr_mt?F0=.6:F0=1,He=0;He<Ee.channels_out;He++){var _t=L[He],ft=j+576-350-g+192;for(Ue=0;Ue<576;Ue++){var Ct,gt;for(Ct=_t[ft+Ue+10],gt=0,m0=0;m0<(g-1)/2-1;m0+=2)Ct+=ze[m0]*(_t[ft+Ue+m0]+_t[ft+Ue+g-m0]),gt+=ze[m0+1]*(_t[ft+Ue+m0+1]+_t[ft+Ue+g-m0-1]);pt[He][Ue]=Ct+gt}Ce[Ae][He].en.assign(Ee.en[He]),Ce[Ae][He].thm.assign(Ee.thm[He]),M0>2&&N()}for(He=0;He<M0;He++){var zt,Ut,P0=b(12),K0=[0,0,0,0],Mt=b(12),$t=1,Gt,jt=b(a.CBANDS),Xt=b(a.CBANDS),w0=[0,0,0,0],Yt=b(a.HBLKSIZE),qt=V([3,a.HBLKSIZE_s]);for(Ue=0;Ue<3;Ue++)P0[Ue]=Ee.nsPsy.last_en_subshort[He][Ue+6],Mt[Ue]=P0[Ue]/Ee.nsPsy.last_en_subshort[He][Ue+4],K0[0]+=P0[Ue];He==2&&N();{var Zt=pt[He&1],vt=0;for(Ue=0;Ue<9;Ue++){for(var C1=vt+64,T0=1;vt<C1;vt++)T0<Math.abs(Zt[vt])&&(T0=Math.abs(Zt[vt]));Ee.nsPsy.last_en_subshort[He][Ue]=P0[Ue+3]=T0,K0[1+Ue/3]+=T0,T0>P0[Ue+3-2]?T0=T0/P0[Ue+3-2]:P0[Ue+3-2]>T0*10?T0=P0[Ue+3-2]/(T0*10):T0=0,Mt[Ue+3]=T0}}for(X.analysis&&N(),Gt=He==3?Ee.nsPsy.attackthre_s:Ee.nsPsy.attackthre,Ue=0;Ue<12;Ue++)w0[Ue/3]==0&&Mt[Ue]>Gt&&(w0[Ue/3]=Ue%3+1);for(Ue=1;Ue<4;Ue++){var At;K0[Ue-1]>K0[Ue]?At=K0[Ue-1]/K0[Ue]:At=K0[Ue]/K0[Ue-1],At<1.7&&(w0[Ue]=0,Ue==1&&(w0[0]=0))}for(w0[0]!=0&&Ee.nsPsy.lastAttacks[He]!=0&&(w0[0]=0),(Ee.nsPsy.lastAttacks[He]==3||w0[0]+w0[1]+w0[2]+w0[3]!=0)&&($t=0,w0[1]!=0&&w0[0]!=0&&(w0[1]=0),w0[2]!=0&&w0[1]!=0&&(w0[2]=0),w0[3]!=0&&w0[2]!=0&&(w0[3]=0)),He<2?u0[He]=$t:N(),Te[He]=Ee.tot_ener[He],Ut=t0,zt=h0,h(X,Yt,qt,zt,He&1,Ut,He&1,Ae,He,L,j),Oe(Ee,Yt,f0,jt,Xt),$e(Ee,jt,Xt,et),i0=0;i0<3;i0++){var kt,N0;for(n(X,qt,b0,n0,He,i0),k(Ee,b0,n0,He,i0),D0=0;D0<a.SBMAX_s;D0++){if(N0=Ee.thm[He].s[D0][i0],N0*=K,w0[i0]>=2||w0[i0+1]==1){var dt=i0!=0?i0-1:2,T0=B(Ee.thm[He].s[D0][dt],N0,w*F0);N0=Math.min(N0,T0)}if(w0[i0]==1){var dt=i0!=0?i0-1:2,T0=B(Ee.thm[He].s[D0][dt],N0,ae*F0);N0=Math.min(N0,T0)}else if(i0!=0&&w0[i0-1]==3||i0==0&&Ee.nsPsy.lastAttacks[He]==3){var dt=i0!=2?i0+1:0,T0=B(Ee.thm[He].s[D0][dt],N0,ae*F0);N0=Math.min(N0,T0)}kt=P0[i0*3+3]+P0[i0*3+4]+P0[i0*3+5],P0[i0*3+5]*6<kt&&(N0*=.5,P0[i0*3+4]*6<kt&&(N0*=.5)),Ee.thm[He].s[D0][i0]=N0}}for(Ee.nsPsy.lastAttacks[He]=w0[2],W0=0,We=0;We<Ee.npart_l;We++){for(var tt=Ee.s3ind[We][0],Tt=f0[tt]*r[et[tt]],at=Ee.s3_ll[W0++]*Tt;++tt<=Ee.s3ind[We][1];)Tt=f0[tt]*r[et[tt]],at=m(at,Ee.s3_ll[W0++]*Tt,tt,tt-We,Ee);at*=.158489319246111,Ee.blocktype_old[He&1]==a.SHORT_TYPE?n0[We]=at:n0[We]=B(Math.min(at,Math.min(z*Ee.nb_1[He][We],S*Ee.nb_2[He][We])),at,F0),Ee.nb_2[He][We]=Ee.nb_1[He][We],Ee.nb_1[He][We]=at}for(;We<=a.CBANDS;++We)f0[We]=0,n0[We]=0;t(Ee,f0,n0,He)}for((X.mode==be.STEREO||X.mode==be.JOINT_STEREO)&&N(),X.mode==be.JOINT_STEREO&&N(),G(X,u0,Ye,Ge),He=0;He<M0;He++){var bt,xt=0,Wt,Et;He>1?N():(bt=we,xt=0,Wt=Ye[He],Et=Ce[Ae][He]),Wt==a.SHORT_TYPE?bt[xt+He]=re(Et,Ee.masking_lower):bt[xt+He]=pe(Et,Ee.masking_lower),X.analysis&&(Ee.pinfo.pe[Ae][He]=bt[xt+He])}return 0};function x0(X){var L,j,Ae,Ce;return L=X,L>=0?L*=3:L*=1.5,L>=.5&&L<=2.5?(Ce=L-.5,j=8*(Ce*Ce-2*Ce)):j=0,L+=.474,Ae=15.811389+7.5*L-17.5*Math.sqrt(1+L*L),Ae<=-60?0:(L=Math.exp((j+Ae)*e),L/=.6609193,L)}function y0(X){return X<0&&(X=0),X=X*.001,13*Math.atan(.76*X)+3.5*Math.atan(X*X/(7.5*7.5))}function d0(X,L,j,Ae,Ce,ne,we,Se,Te,Ye,Ee,h0){var t0=b(a.CBANDS+1),f0=Se/(h0>15?2*576:2*192),b0=C(a.HBLKSIZE),n0;Se/=Te;var Ge=0,u0=0;for(n0=0;n0<a.CBANDS;n0++){var M0,He;for(M0=y0(Se*Ge),t0[n0]=Se*Ge,He=Ge;y0(Se*He)-M0<M&&He<=Te/2;He++);for(X[n0]=He-Ge,u0=n0+1;Ge<He;)b0[Ge++]=n0;if(Ge>Te/2){Ge=Te/2,++n0;break}}t0[n0]=Se*Ge;for(var We=0;We<h0;We++){var Ue,m0,W0,D0,i0;W0=Ye[We],D0=Ye[We+1],Ue=0|Math.floor(.5+Ee*(W0-.5)),Ue<0&&(Ue=0),m0=0|Math.floor(.5+Ee*(D0-.5)),m0>Te/2&&(m0=Te/2),j[We]=(b0[Ue]+b0[m0])/2,L[We]=b0[m0];var pt=f0*D0;we[We]=(pt-t0[L[We]])/(t0[L[We]+1]-t0[L[We]]),we[We]<0?we[We]=0:we[We]>1&&(we[We]=1),i0=y0(Se*Ye[We]*Ee),i0=Math.min(i0,15.5)/15.5,ne[We]=Math.pow(10,1.25*(1-Math.cos(Math.PI*i0))-2.5)}Ge=0;for(var F0=0;F0<u0;F0++){var et=X[F0],M0,st;M0=y0(Se*Ge),st=y0(Se*(Ge+et-1)),Ae[F0]=.5*(M0+st),M0=y0(Se*(Ge-.5)),st=y0(Se*(Ge+et-.5)),Ce[F0]=st-M0,Ge+=et}return u0}function p0(X,L,j,Ae,Ce,ne){var we=V([a.CBANDS,a.CBANDS]),Se,Te=0;if(ne)for(var Ye=0;Ye<L;Ye++)for(Se=0;Se<L;Se++){var Ee=x0(j[Ye]-j[Se])*Ae[Se];we[Ye][Se]=Ee*Ce[Ye]}else N();for(var Ye=0;Ye<L;Ye++){for(Se=0;Se<L&&!(we[Ye][Se]>0);Se++);for(X[Ye][0]=Se,Se=L-1;Se>0&&!(we[Ye][Se]>0);Se--);X[Ye][1]=Se,Te+=X[Ye][1]-X[Ye][0]+1}for(var h0=b(Te),t0=0,Ye=0;Ye<L;Ye++)for(Se=X[Ye][0];Se<=X[Ye][1];Se++)h0[t0++]=we[Ye][Se];return h0}function g0(X){var L=y0(X);return L=Math.min(L,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*L))-2.5)}this.psymodel_init=function(X){var L=X.internal_flags,j,Ae=!0,Ce=13,ne=24,we=0,Se=0,Te=-8.25,Ye=-4.5,Ee=b(a.CBANDS),h0=b(a.CBANDS),t0=b(a.CBANDS),f0=X.out_samplerate;switch(X.experimentalZ){default:case 0:Ae=!0;break;case 1:Ae=!(X.VBR==U.vbr_mtrh||X.VBR==U.vbr_mt);break;case 2:Ae=!1;break;case 3:Ce=8,we=-1.75,Se=-.0125,Te=-8.25,Ye=-2.25;break}for(L.ms_ener_ratio_old=.25,L.blocktype_old[0]=L.blocktype_old[1]=a.NORM_TYPE,j=0;j<4;++j){for(var Ge=0;Ge<a.CBANDS;++Ge)L.nb_1[j][Ge]=1e20,L.nb_2[j][Ge]=1e20,L.nb_s1[j][Ge]=L.nb_s2[j][Ge]=1;for(var b0=0;b0<a.SBMAX_l;b0++)L.en[j].l[b0]=1e20,L.thm[j].l[b0]=1e20;for(var Ge=0;Ge<3;++Ge){for(var b0=0;b0<a.SBMAX_s;b0++)L.en[j].s[b0][Ge]=1e20,L.thm[j].s[b0][Ge]=1e20;L.nsPsy.lastAttacks[j]=0}for(var Ge=0;Ge<9;Ge++)L.nsPsy.last_en_subshort[j][Ge]=10}for(L.loudness_sq_save[0]=L.loudness_sq_save[1]=0,L.npart_l=d0(L.numlines_l,L.bo_l,L.bm_l,Ee,h0,L.mld_l,L.PSY.bo_l_weight,f0,a.BLKSIZE,L.scalefac_band.l,a.BLKSIZE/(2*576),a.SBMAX_l),j=0;j<L.npart_l;j++){var n0=we;Ee[j]>=Ce&&(n0=Se*(Ee[j]-Ce)/(ne-Ce)+we*(ne-Ee[j])/(ne-Ce)),t0[j]=Math.pow(10,n0/10),L.numlines_l[j]>0?L.rnumlines_l[j]=1/L.numlines_l[j]:L.rnumlines_l[j]=0}L.s3_ll=p0(L.s3ind,L.npart_l,Ee,h0,t0,Ae);var Ge=0;for(j=0;j<L.npart_l;j++){var u0;u0=ue.MAX_VALUE;for(var M0=0;M0<L.numlines_l[j];M0++,Ge++){var He=f0*Ge/(1e3*a.BLKSIZE),We;We=this.ATHformula(He*1e3,X)-20,We=Math.pow(10,.1*We),We*=L.numlines_l[j],u0>We&&(u0=We)}L.ATH.cb_l[j]=u0,u0=-20+Ee[j]*20/10,u0>6&&(u0=100),u0<-15&&(u0=-15),u0-=8,L.minval_l[j]=Math.pow(10,u0/10)*L.numlines_l[j]}for(L.npart_s=d0(L.numlines_s,L.bo_s,L.bm_s,Ee,h0,L.mld_s,L.PSY.bo_s_weight,f0,a.BLKSIZE_s,L.scalefac_band.s,a.BLKSIZE_s/(2*192),a.SBMAX_s),Ge=0,j=0;j<L.npart_s;j++){var u0,n0=Te;Ee[j]>=Ce&&(n0=Ye*(Ee[j]-Ce)/(ne-Ce)+Te*(ne-Ee[j])/(ne-Ce)),t0[j]=Math.pow(10,n0/10),u0=ue.MAX_VALUE;for(var M0=0;M0<L.numlines_s[j];M0++,Ge++){var He=f0*Ge/(1e3*a.BLKSIZE_s),We;We=this.ATHformula(He*1e3,X)-20,We=Math.pow(10,.1*We),We*=L.numlines_s[j],u0>We&&(u0=We)}L.ATH.cb_s[j]=u0,u0=-7+Ee[j]*7/12,Ee[j]>12&&(u0*=1+Math.log(1+u0)*3.1),Ee[j]<12&&(u0*=1+Math.log(1-u0)*2.3),u0<-15&&(u0=-15),u0-=8,L.minval_s[j]=Math.pow(10,u0/10)*L.numlines_s[j]}L.s3_ss=p0(L.s3ind_s,L.npart_s,Ee,h0,t0,Ae),F(),f.init_fft(L),L.decay=Math.exp(-1*D/(I*f0/192));{var Ue;Ue=A,X.exp_nspsytune&2&&(Ue=1),Math.abs(X.msfix)>0&&(Ue=X.msfix),X.msfix=Ue;for(var m0=0;m0<L.npart_l;m0++)L.s3ind[m0][1]>L.npart_l-1&&(L.s3ind[m0][1]=L.npart_l-1)}var W0=576*L.mode_gr/f0;if(L.ATH.decay=Math.pow(10,-12/10*W0),L.ATH.adjust=.01,L.ATH.adjustLimit=1,X.ATHtype!=-1){var He,D0=X.out_samplerate/a.BLKSIZE,i0=0;for(He=0,j=0;j<a.BLKSIZE/2;++j)He+=D0,L.ATH.eql_w[j]=1/Math.pow(10,this.ATHformula(He,X)/10),i0+=L.ATH.eql_w[j];for(i0=1/i0,j=a.BLKSIZE/2;--j>=0;)L.ATH.eql_w[j]*=i0}{for(var m0=Ge=0;m0<L.npart_s;++m0)for(j=0;j<L.numlines_s[m0];++j)++Ge;for(var m0=Ge=0;m0<L.npart_l;++m0)for(j=0;j<L.numlines_l[m0];++j)++Ge}for(Ge=0,j=0;j<L.npart_l;j++){var He=f0*(Ge+L.numlines_l[j]/2)/(1*a.BLKSIZE);L.mld_cb_l[j]=g0(He),Ge+=L.numlines_l[j]}for(;j<a.CBANDS;++j)L.mld_cb_l[j]=1;for(Ge=0,j=0;j<L.npart_s;j++){var He=f0*(Ge+L.numlines_s[j]/2)/(1*a.BLKSIZE_s);L.mld_cb_s[j]=g0(He),Ge+=L.numlines_s[j]}for(;j<a.CBANDS;++j)L.mld_cb_s[j]=1;return 0};function q0(X,L){X<-.3&&(X=3410),X/=1e3,X=Math.max(.1,X);var j=3.64*Math.pow(X,-.8)-6.8*Math.exp(-.6*Math.pow(X-3.4,2))+6*Math.exp(-.15*Math.pow(X-8.7,2))+(.6+.04*L)*.001*Math.pow(X,4);return j}this.ATHformula=function(X,L){var j;switch(L.ATHtype){case 0:j=q0(X,9);break;case 1:j=q0(X,-1);break;case 2:j=q0(X,0);break;case 3:j=q0(X,1)+6;break;case 4:j=q0(X,L.ATHcurve);break;default:j=q0(X,0);break}return j}}function Me(){var f=this,D=128*1024;Me.V9=410,Me.V8=420,Me.V7=430,Me.V6=440,Me.V5=450,Me.V4=460,Me.V3=470,Me.V2=480,Me.V1=490,Me.V0=500,Me.R3MIX=1e3,Me.STANDARD=1001,Me.EXTREME=1002,Me.INSANE=1003,Me.STANDARD_FAST=1004,Me.EXTREME_FAST=1005,Me.MEDIUM=1006,Me.MEDIUM_FAST=1007;var z=16384+D;Me.LAME_MAXMP3BUFFER=z;var S,le,p,M,te,I=new Ve,K,w;this.enc=new a,this.setModules=function(t,n,G,B,$,re,ve,pe,Oe){S=t,le=n,p=G,M=B,te=$,K=re,w=pe,this.enc.setModules(le,I,M,K)};function ae(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=b(a.SBMAX_l),this.bo_s_weight=b(a.SBMAX_s)}function A(){this.lowerlimit=0}function g(t,n){this.lowpass=n}var e=4294479419;function l(t){var n;return t.class_id=e,n=t.internal_flags=new Ie,t.mode=be.NOT_SET,t.original=1,t.in_samplerate=44100,t.num_channels=2,t.num_samples=-1,t.bWriteVbrTag=!0,t.quality=-1,t.short_blocks=null,n.subblock_gain=-1,t.lowpassfreq=0,t.highpassfreq=0,t.lowpasswidth=-1,t.highpasswidth=-1,t.VBR=U.vbr_off,t.VBR_q=4,t.ATHcurve=-1,t.VBR_mean_bitrate_kbps=128,t.VBR_min_bitrate_kbps=0,t.VBR_max_bitrate_kbps=0,t.VBR_hard_min=0,n.VBR_min_bitrate=1,n.VBR_max_bitrate=13,t.quant_comp=-1,t.quant_comp_short=-1,t.msfix=-1,n.resample_ratio=1,n.OldValue[0]=180,n.OldValue[1]=180,n.CurrentStep[0]=4,n.CurrentStep[1]=4,n.masking_lower=1,n.nsPsy.attackthre=-1,n.nsPsy.attackthre_s=-1,t.scale=-1,t.athaa_type=-1,t.ATHtype=-1,t.athaa_loudapprox=-1,t.athaa_sensitivity=0,t.useTemporal=null,t.interChRatio=-1,n.mf_samples_to_encode=a.ENCDELAY+a.POSTDELAY,t.encoder_padding=0,n.mf_size=a.ENCDELAY-a.MDCTDELAY,t.findReplayGain=!1,t.decode_on_the_fly=!1,n.decode_on_the_fly=!1,n.findReplayGain=!1,n.findPeakSample=!1,n.RadioGain=0,n.AudiophileGain=0,n.noclipGainChange=0,n.noclipScale=-1,t.preset=0,t.write_id3tag_automatic=!0,0}this.lame_init=function(){var t=new S0;return l(t),t.lame_allocated_gfp=1,t};function h(t){return t>1?0:t<=0?1:Math.cos(Math.PI/2*t)}this.nearestBitrateFullIndex=function(t){var n=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],G=0,B=0,$=0,re=0;re=n[16],$=16,B=n[16],G=16;for(var ve=0;ve<16;ve++)if(Math.max(t,n[ve+1])!=t){re=n[ve+1],$=ve+1,B=n[ve],G=ve;break}return re-t>t-B?G:$};function E(t,n){switch(t){case 44100:return n.version=1,0;case 48e3:return n.version=1,1;case 32e3:return n.version=1,2;case 22050:return n.version=0,0;case 24e3:return n.version=0,1;case 16e3:return n.version=0,2;case 11025:return n.version=0,0;case 12e3:return n.version=0,1;case 8e3:return n.version=0,2;default:return n.version=0,-1}}function d(t,n,G){G<16e3&&(n=2);for(var B=P.bitrate_table[n][1],$=2;$<=14;$++)P.bitrate_table[n][$]>0&&Math.abs(P.bitrate_table[n][$]-t)<Math.abs(B-t)&&(B=P.bitrate_table[n][$]);return B}function i(t,n,G){G<16e3&&(n=2);for(var B=0;B<=14;B++)if(P.bitrate_table[n][B]>0&&P.bitrate_table[n][B]==t)return B;return-1}function u(t,n){var G=[new g(8,2e3),new g(16,3700),new g(24,3900),new g(32,5500),new g(40,7e3),new g(48,7500),new g(56,1e4),new g(64,11e3),new g(80,13500),new g(96,15100),new g(112,15600),new g(128,17e3),new g(160,17500),new g(192,18600),new g(224,19400),new g(256,19700),new g(320,20500)],B=f.nearestBitrateFullIndex(n);t.lowerlimit=G[B].lowpass}function s(t){var n=t.internal_flags,G=32;if(n.lowpass1>0){for(var B=999,$=0;$<=31;$++){var re=$/31;re>=n.lowpass2&&(G=Math.min(G,$)),n.lowpass1<re&&re<n.lowpass2&&(B=Math.min(B,$))}B==999?n.lowpass1=(G-.75)/31:n.lowpass1=(B-.75)/31,n.lowpass2=G/31}n.highpass2>0&&N(),n.highpass2>0&&N();for(var $=0;$<32;$++){var ve,pe,re=$/31;n.highpass2>n.highpass1?N():ve=1,n.lowpass2>n.lowpass1?pe=h((re-n.lowpass1)/(n.lowpass2-n.lowpass1+1e-20)):pe=1,n.amp_filter[$]=ve*pe}}function y(t){var n=t.internal_flags;switch(t.quality){default:case 9:n.psymodel=0,n.noise_shaping=0,n.noise_shaping_amp=0,n.noise_shaping_stop=0,n.use_best_huffman=0,n.full_outer_loop=0;break;case 8:t.quality=7;case 7:n.psymodel=1,n.noise_shaping=0,n.noise_shaping_amp=0,n.noise_shaping_stop=0,n.use_best_huffman=0,n.full_outer_loop=0;break;case 6:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.noise_shaping_amp=0,n.noise_shaping_stop=0,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=0,n.full_outer_loop=0;break;case 5:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.noise_shaping_amp=0,n.noise_shaping_stop=0,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=0,n.full_outer_loop=0;break;case 4:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.noise_shaping_amp=0,n.noise_shaping_stop=0,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0;break;case 3:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.noise_shaping_amp=1,n.noise_shaping_stop=1,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0;break;case 2:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.substep_shaping==0&&(n.substep_shaping=2),n.noise_shaping_amp=1,n.noise_shaping_stop=1,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0;break;case 1:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.substep_shaping==0&&(n.substep_shaping=2),n.noise_shaping_amp=2,n.noise_shaping_stop=1,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0;break;case 0:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.substep_shaping==0&&(n.substep_shaping=2),n.noise_shaping_amp=2,n.noise_shaping_stop=1,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0;break}}function r(t){var n=t.internal_flags;t.frameNum=0,t.write_id3tag_automatic&&w.id3tag_write_v2(t),n.bitrate_stereoMode_Hist=q([16,5]),n.bitrate_blockType_Hist=q([16,6]),n.PeakSample=0,t.bWriteVbrTag&&K.InitVbrTag(t)}this.lame_init_params=function(t){var n=t.internal_flags;if(n.Class_ID=0,n.ATH==null&&(n.ATH=new H0),n.PSY==null&&(n.PSY=new ae),n.rgdata==null&&(n.rgdata=new C0),n.channels_in=t.num_channels,n.channels_in==1&&(t.mode=be.MONO),n.channels_out=t.mode==be.MONO?1:2,n.mode_ext=a.MPG_MD_MS_LR,t.mode==be.MONO&&(t.force_ms=!1),t.VBR==U.vbr_off&&t.VBR_mean_bitrate_kbps!=128&&t.brate==0&&(t.brate=t.VBR_mean_bitrate_kbps),t.VBR==U.vbr_off||t.VBR==U.vbr_mtrh||t.VBR==U.vbr_mt||(t.free_format=!1),t.VBR==U.vbr_off&&t.brate==0&&N(),t.VBR==U.vbr_off&&t.compression_ratio>0&&N(),t.out_samplerate!=0&&(t.out_samplerate<16e3?(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,64)):t.out_samplerate<32e3?(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,160)):(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,32),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,320))),t.lowpassfreq==0){var G=16e3;switch(t.VBR){case U.vbr_off:{var B=new A;u(B,t.brate),G=B.lowerlimit;break}case U.vbr_abr:{var B=new A;u(B,t.VBR_mean_bitrate_kbps),G=B.lowerlimit;break}case U.vbr_rh:N();default:N()}t.mode==be.MONO&&(t.VBR==U.vbr_off||t.VBR==U.vbr_abr)&&(G*=1.5),t.lowpassfreq=G|0}switch(t.out_samplerate==0&&N(),t.lowpassfreq=Math.min(20500,t.lowpassfreq),t.lowpassfreq=Math.min(t.out_samplerate/2,t.lowpassfreq),t.VBR==U.vbr_off&&(t.compression_ratio=t.out_samplerate*16*n.channels_out/(1e3*t.brate)),t.VBR==U.vbr_abr&&N(),t.bWriteVbrTag||(t.findReplayGain=!1,t.decode_on_the_fly=!1,n.findPeakSample=!1),n.findReplayGain=t.findReplayGain,n.decode_on_the_fly=t.decode_on_the_fly,n.decode_on_the_fly&&(n.findPeakSample=!0),n.findReplayGain&&N(),n.decode_on_the_fly&&!t.decode_only&&N(),n.mode_gr=t.out_samplerate<=24e3?1:2,t.framesize=576*n.mode_gr,t.encoder_delay=a.ENCDELAY,n.resample_ratio=t.in_samplerate/t.out_samplerate,t.VBR){case U.vbr_mt:case U.vbr_rh:case U.vbr_mtrh:{var $=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];t.compression_ratio=$[t.VBR_q]}break;case U.vbr_abr:t.compression_ratio=t.out_samplerate*16*n.channels_out/(1e3*t.VBR_mean_bitrate_kbps);break;default:t.compression_ratio=t.out_samplerate*16*n.channels_out/(1e3*t.brate);break}t.mode==be.NOT_SET&&(t.mode=be.JOINT_STEREO),t.highpassfreq>0?N():(n.highpass1=0,n.highpass2=0),t.lowpassfreq>0?(n.lowpass2=2*t.lowpassfreq,t.lowpasswidth>=0?N():n.lowpass1=1*2*t.lowpassfreq,n.lowpass1/=t.out_samplerate,n.lowpass2/=t.out_samplerate):N(),s(t),n.samplerate_index=E(t.out_samplerate,t),n.samplerate_index<0&&N(),t.VBR==U.vbr_off?t.free_format?n.bitrate_index=0:(t.brate=d(t.brate,t.version,t.out_samplerate),n.bitrate_index=i(t.brate,t.version,t.out_samplerate),n.bitrate_index<=0&&N()):n.bitrate_index=1,t.analysis&&(t.bWriteVbrTag=!1),n.pinfo!=null&&(t.bWriteVbrTag=!1),le.init_bit_stream_w(n);for(var re=n.samplerate_index+3*t.version+6*(t.out_samplerate<16e3?1:0),ve=0;ve<a.SBMAX_l+1;ve++)n.scalefac_band.l[ve]=M.sfBandIndex[re].l[ve];for(var ve=0;ve<a.PSFB21+1;ve++){var pe=(n.scalefac_band.l[22]-n.scalefac_band.l[21])/a.PSFB21,Oe=n.scalefac_band.l[21]+ve*pe;n.scalefac_band.psfb21[ve]=Oe}n.scalefac_band.psfb21[a.PSFB21]=576;for(var ve=0;ve<a.SBMAX_s+1;ve++)n.scalefac_band.s[ve]=M.sfBandIndex[re].s[ve];for(var ve=0;ve<a.PSFB12+1;ve++){var pe=(n.scalefac_band.s[13]-n.scalefac_band.s[12])/a.PSFB12,Oe=n.scalefac_band.s[12]+ve*pe;n.scalefac_band.psfb12[ve]=Oe}n.scalefac_band.psfb12[a.PSFB12]=192,t.version==1?n.sideinfo_len=n.channels_out==1?21:36:n.sideinfo_len=n.channels_out==1?13:21,t.error_protection&&(n.sideinfo_len+=2),r(t),n.Class_ID=e;{var $e;for($e=0;$e<19;$e++)n.nsPsy.pefirbuf[$e]=700*n.mode_gr*n.channels_out;t.ATHtype==-1&&(t.ATHtype=4)}switch(t.VBR){case U.vbr_mt:t.VBR=U.vbr_mtrh;case U.vbr_mtrh:{t.useTemporal==null&&(t.useTemporal=!1),p.apply_preset(t,500-t.VBR_q*10,0),t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),t.quality<5&&(t.quality=0),t.quality>5&&(t.quality=5),n.PSY.mask_adjust=t.maskingadjust,n.PSY.mask_adjust_short=t.maskingadjust_short,t.experimentalY?n.sfb21_extra=!1:n.sfb21_extra=t.out_samplerate>44e3,n.iteration_loop=new VBRNewIterationLoop(te);break}case U.vbr_rh:{p.apply_preset(t,500-t.VBR_q*10,0),n.PSY.mask_adjust=t.maskingadjust,n.PSY.mask_adjust_short=t.maskingadjust_short,t.experimentalY?n.sfb21_extra=!1:n.sfb21_extra=t.out_samplerate>44e3,t.quality>6&&(t.quality=6),t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),n.iteration_loop=new VBROldIterationLoop(te);break}default:{var ze;n.sfb21_extra=!1,t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),ze=t.VBR,ze==U.vbr_off&&(t.VBR_mean_bitrate_kbps=t.brate),p.apply_preset(t,t.VBR_mean_bitrate_kbps,0),t.VBR=ze,n.PSY.mask_adjust=t.maskingadjust,n.PSY.mask_adjust_short=t.maskingadjust_short,ze==U.vbr_off?n.iteration_loop=new L0(te):N();break}}return t.VBR!=U.vbr_off&&N(),t.tune&&N(),y(t),t.athaa_type<0?n.ATH.useAdjust=3:n.ATH.useAdjust=t.athaa_type,n.ATH.aaSensitivityP=Math.pow(10,t.athaa_sensitivity/-10),t.short_blocks==null&&(t.short_blocks=R.short_block_allowed),t.short_blocks==R.short_block_allowed&&(t.mode==be.JOINT_STEREO||t.mode==be.STEREO)&&(t.short_blocks=R.short_block_coupled),t.quant_comp<0&&(t.quant_comp=1),t.quant_comp_short<0&&(t.quant_comp_short=0),t.msfix<0&&(t.msfix=0),t.exp_nspsytune=t.exp_nspsytune|1,t.internal_flags.nsPsy.attackthre<0&&(t.internal_flags.nsPsy.attackthre=Ve.NSATTACKTHRE),t.internal_flags.nsPsy.attackthre_s<0&&(t.internal_flags.nsPsy.attackthre_s=Ve.NSATTACKTHRE_S),t.scale<0&&(t.scale=1),t.ATHtype<0&&(t.ATHtype=4),t.ATHcurve<0&&(t.ATHcurve=4),t.athaa_loudapprox<0&&(t.athaa_loudapprox=2),t.interChRatio<0&&(t.interChRatio=0),t.useTemporal==null&&(t.useTemporal=!0),n.slot_lag=n.frac_SpF=0,t.VBR==U.vbr_off&&(n.slot_lag=n.frac_SpF=(t.version+1)*72e3*t.brate%t.out_samplerate|0),M.iteration_init(t),I.psymodel_init(t),0};function F(t,n){(t.in_buffer_0==null||t.in_buffer_nsamples<n)&&(t.in_buffer_0=b(n),t.in_buffer_1=b(n),t.in_buffer_nsamples=n)}this.lame_encode_flush=function(t,n,G,B){var $=t.internal_flags,re=ye([2,1152]),ve=0,pe,Oe,$e,ze,x0=$.mf_samples_to_encode-a.POSTDELAY,y0=o(t);if($.mf_samples_to_encode<1)return 0;for(pe=0,t.in_samplerate!=t.out_samplerate&&N(),$e=t.framesize-x0%t.framesize,$e<576&&($e+=t.framesize),t.encoder_padding=$e,ze=(x0+$e)/t.framesize;ze>0&&ve>=0;){var d0=y0-$.mf_size,p0=t.frameNum;d0*=t.in_samplerate,d0/=t.out_samplerate,d0>1152&&(d0=1152),d0<1&&(d0=1),Oe=B-pe,B==0&&(Oe=0),ve=this.lame_encode_buffer(t,re[0],re[1],d0,n,G,Oe),G+=ve,pe+=ve,ze-=p0!=t.frameNum?1:0}return $.mf_samples_to_encode=0,ve<0||(Oe=B-pe,B==0&&(Oe=0),le.flush_bitstream(t),ve=le.copy_buffer($,n,G,Oe,1),ve<0)?ve:(G+=ve,pe+=ve,Oe=B-pe,B==0&&(Oe=0),t.write_id3tag_automatic&&N(),pe)},this.lame_encode_buffer=function(t,n,G,B,$,re,ve){var pe=t.internal_flags,Oe=[null,null];if(pe.Class_ID!=e)return-3;if(B==0)return 0;F(pe,B),Oe[0]=pe.in_buffer_0,Oe[1]=pe.in_buffer_1;for(var $e=0;$e<B;$e++)Oe[0][$e]=n[$e],pe.channels_in>1&&(Oe[1][$e]=G[$e]);return c(t,Oe[0],Oe[1],B,$,re,ve)};function o(t){var n=a.BLKSIZE+t.framesize-a.FFTOFFSET;return n=Math.max(n,512+t.framesize-32),n}function c(t,n,G,B,$,re,ve){var pe=t.internal_flags,Oe=0,$e,ze,x0,y0,d0,p0=[null,null],g0=[null,null];if(pe.Class_ID!=e)return-3;if(B==0)return 0;if(d0=le.copy_buffer(pe,$,re,ve,0),d0<0)return d0;if(re+=d0,Oe+=d0,g0[0]=n,g0[1]=G,qe.NEQ(t.scale,0)&&qe.NEQ(t.scale,1))for(ze=0;ze<B;++ze)g0[0][ze]*=t.scale,pe.channels_out==2&&(g0[1][ze]*=t.scale);if(qe.NEQ(t.scale_left,0)&&qe.NEQ(t.scale_left,1))for(ze=0;ze<B;++ze)g0[0][ze]*=t.scale_left;if(qe.NEQ(t.scale_right,0)&&qe.NEQ(t.scale_right,1))for(ze=0;ze<B;++ze)g0[1][ze]*=t.scale_right;t.num_channels==2&&pe.channels_out==1&&N(),y0=o(t),p0[0]=pe.mfbuf[0],p0[1]=pe.mfbuf[1];for(var q0=0;B>0;){var X=[null,null],L=0,j=0;X[0]=g0[0],X[1]=g0[1];var Ae=new m;if(k(t,p0,X,q0,B,Ae),L=Ae.n_in,j=Ae.n_out,pe.findReplayGain&&!pe.decode_on_the_fly&&S.AnalyzeSamples(pe.rgdata,p0[0],pe.mf_size,p0[1],pe.mf_size,j,pe.channels_out)==De.GAIN_ANALYSIS_ERROR)return-6;if(B-=L,q0+=L,pe.channels_out==2,pe.mf_size+=j,pe.mf_samples_to_encode<1&&N(),pe.mf_samples_to_encode+=j,pe.mf_size>=y0){var Ce=ve-Oe;if(ve==0&&(Ce=0),$e=_(t,p0[0],p0[1],$,re,Ce),$e<0)return $e;for(re+=$e,Oe+=$e,pe.mf_size-=t.framesize,pe.mf_samples_to_encode-=t.framesize,x0=0;x0<pe.channels_out;x0++)for(ze=0;ze<pe.mf_size;ze++)p0[x0][ze]=p0[x0][ze+t.framesize]}}return Oe}function _(t,n,G,B,$,re){var ve=f.enc.lame_encode_mp3_frame(t,n,G,B,$,re);return t.frameNum++,ve}function m(){this.n_in=0,this.n_out=0}function k(t,n,G,B,$,re){var ve=t.internal_flags;if(ve.resample_ratio<.9999||ve.resample_ratio>1.0001)N();else{re.n_out=Math.min(t.framesize,$),re.n_in=re.n_out;for(var pe=0;pe<re.n_out;++pe)n[0][ve.mf_size+pe]=G[0][B+pe],ve.channels_out==2&&(n[1][ve.mf_size+pe]=G[1][B+pe])}}}function v0(){this.setModules=function(f,D){}}function Ze(){this.setModules=function(f,D,z){}}function e0(){}function Pe(){this.setModules=function(f,D){}}function s0(f,D,z){f!=1&&N("fix cc: only supports mono");var S=new Me,le=new v0,p=new De,M=new qe,te=new r0,I=new c0,K=new Qe,w=new l0,ae=new Ne,A=new Pe,g=new Ke,e=new Re,l=new Ze,h=new e0;S.setModules(p,M,te,I,K,w,ae,A,h),M.setModules(p,h,ae,w),A.setModules(M,ae),te.setModules(S),K.setModules(M,g,I,e),I.setModules(e,g,S.enc.psy),g.setModules(M),e.setModules(I),w.setModules(S,M,ae),le.setModules(l,h),l.setModules(ae,A,te);var E=S.lame_init();E.num_channels=f,E.in_samplerate=D,E.out_samplerate=D,E.brate=z,E.mode=be.STEREO,E.quality=3,E.bWriteVbrTag=!1,E.disable_reservoir=!0,E.write_id3tag_automatic=!1,S.lame_init_params(E);var d=1152,i=0|1.25*d+7200,u=J(i);this.encodeBuffer=function(s,y){f==1&&(y=s),s.length>d&&(d=s.length,i=0|1.25*d+7200,u=J(i));var r=S.lame_encode_buffer(E,s,y,s.length,u,0,i);return new Int8Array(u.subarray(0,r))},this.flush=function(){var s=S.lame_encode_flush(E,u,0,i);return new Int8Array(u.subarray(0,s))}}Y.SFBMAX=a.SBMAX_s*3,de.Mp3Encoder=s0}de(),ke.lamejs=de});(function(ke){var de=typeof window=="object"&&!!window.document,ce=de?window:Object,N=ce.Recorder,J=N.i18n;ke(N,J,J.$T,de)})(function(ke,de,ce,N){var J=function(b){return new C(b)},se="WaveView",C=function(b){var Z=this,V={scale:2,speed:9,phase:21.8,fps:20,keep:!0,lineWidth:3,linear1:[0,"rgba(150,96,238,1)",.2,"rgba(170,79,249,1)",1,"rgba(53,199,253,1)"],linear2:[0,"rgba(209,130,255,0.6)",1,"rgba(53,199,255,0.6)"],linearBg:[0,"rgba(255,255,255,0.2)",1,"rgba(54,197,252,0.2)"]};for(var q in b)V[q]=b[q];Z.set=b=V;var ye="compatibleCanvas";if(b[ye])var W=Z.canvas=b[ye];else{if(!N)throw new Error(ce.G("NonBrowser-1",[se]));var fe=b.elem;fe&&(typeof fe=="string"?fe=document.querySelector(fe):fe.length&&(fe=fe[0])),fe&&(b.width=fe.offsetWidth,b.height=fe.offsetHeight);var H=Z.elem=document.createElement("div");H.style.fontSize=0,H.innerHTML='<canvas style="width:100%;height:100%;"/>';var W=Z.canvas=H.querySelector("canvas");fe&&(fe.innerHTML="",fe.appendChild(H))}var T=b.scale,R=b.width*T,ue=b.height*T;if(!R||!ue)throw new Error(ce.G("IllegalArgs-1",[se+" width=0 height=0"]));W.width=R,W.height=ue;var U=Z.ctx=W.getContext("2d");Z.linear1=Z.genLinear(U,R,b.linear1),Z.linear2=Z.genLinear(U,R,b.linear2),Z.linearBg=Z.genLinear(U,ue,b.linearBg,!0),Z._phase=0};C.prototype=J.prototype={genLinear:function(b,Z,V,q){for(var ye=b.createLinearGradient(0,0,q?0:Z,q?Z:0),W=0;W<V.length;)ye.addColorStop(V[W++],V[W++]);return ye},genPath:function(b,Z,V){for(var q=[],ye=this,W=ye.set,fe=W.scale,H=W.width*fe,T=W.height*fe/2,R=0;R<=H;R+=fe){var ue=(1+Math.cos(Math.PI+R/H*2*Math.PI))/2,U=ue*T*Z*Math.sin(2*Math.PI*(R/H)*b+V)+T;q.push(U)}return q},input:function(b,Z,V){var q=this;q.sampleRate=V,q.pcmData=b,q.pcmPos=0,q.inputTime=Date.now(),q.schedule()},schedule:function(){var b=this,Z=b.set,V=Math.floor(1e3/Z.fps);b.timer||(b.timer=setInterval(function(){b.schedule()},V));var q=Date.now(),ye=b.drawTime||0;if(!(q-ye<V)){b.drawTime=q;for(var W=b.sampleRate/Z.fps,fe=b.pcmData,H=b.pcmPos,T=Math.max(0,Math.min(W,fe.length-H)),R=0,ue=0;ue<T;ue++,H++)R+=Math.abs(fe[H]);b.pcmPos=H,(T||!Z.keep)&&b.draw(ke.PowerLevel(R,T)),!T&&q-b.inputTime>1300&&(clearInterval(b.timer),b.timer=0)}},draw:function(b){var Z=this,V=Z.set,q=Z.ctx,ye=V.scale,W=V.width*ye,fe=V.height*ye,H=V.speed/V.fps,T=Z._phase-=H,R=T+H*V.phase,ue=b/100,U=Z.genPath(2,ue,T),be=Z.genPath(1.8,ue,R);q.clearRect(0,0,W,fe),q.beginPath();for(var Ne=0,Re=0;Re<=W;Ne++,Re+=ye)Re==0?q.moveTo(Re,U[Ne]):q.lineTo(Re,U[Ne]);Ne--;for(var Re=W-1;Re>=0;Ne--,Re-=ye)q.lineTo(Re,be[Ne]);q.closePath(),q.fillStyle=Z.linearBg,q.fill(),Z.drawPath(be,Z.linear2),Z.drawPath(U,Z.linear1)},drawPath:function(b,Z){var V=this,q=V.set,ye=V.ctx,W=q.scale,fe=q.width*W;ye.beginPath();for(var H=0,T=0;T<=fe;H++,T+=W)T==0?ye.moveTo(T,b[H]):ye.lineTo(T,b[H]);ye.lineWidth=q.lineWidth*W,ye.strokeStyle=Z,ye.stroke()}},ke[se]=J});const _n={class:"w-full h-full overflow-hidden flex flex-col gap-4"},fn={class:"flex-1 w-full overflow-auto"},vn={key:0,class:"text-xs text-left"},dn={class:"flex items-center w-full gap-2"},hn={class:"w-20 shrink-0"},mn={class:"flex-1"},pn={class:"flex items-center cursor-pointer gap-2"},bn=E0({__name:"SpeechGenerate",setup(ke){const de=lt(),ce=a0(!1),N=a0([]),J=J0({prompt:"",voiceUrl:""}),se=a0(""),C=a0(null),b=a0(),Z=a0(!1),V=()=>{C.value=un({type:"mp3",sampleRate:16e3,bitRate:16}),C.value.open(()=>{console.log("录音已打开"),C.value.start(),Z.value=!0,console.log("已开始录音")},(T,R)=>{console.log((R?"UserNotAllow，":"")+"无法录音:"+T)})},q=()=>{if(!C.value){console.error("未打开录音");return}C.value.stop((T,R)=>{Z.value=!1,b.value=T;var ue=(window.URL||webkitURL).createObjectURL(T);console.log("录音成功",T,ue,"时长:"+R+"ms"),C.value.close(),C.value=null},T=>{console.error("结束录音出错："+T),C.value.close(),C.value=null})},ye=()=>{var T=URL.createObjectURL(b.value),R=document.createElement("audio");R.controls=!0,document.body.appendChild(R),R.src=T,R.play(),setTimeout(function(){URL.revokeObjectURL(R.src)},5e3)},W=async()=>{if(!se.value){V0.error("请先填写音色名称");return}ce.value=!0,await X1(se.value,b.value),H(),V0("旁白已生成，请选择对应音色"),ce.value=!1},fe=async()=>{if(!J.prompt){V0.error("请输入文字描述");return}ce.value=!0;try{const T=await Y1(J);de.speechList.push(T)}finally{ce.value=!1}},H=async()=>{N.value=await q1(),N.value.push({voiceName:"自定义",voiceUrl:"custom"}),J.voiceUrl=N.value[0].voiceUrl};return f1(async()=>{H()}),(T,R)=>{const ue=St,U=ct,be=ut,Ne=Z0,Re=ot,De=j0,r0=Z1,Ke=$0,l0=n1,qe=W1,_e=K1,P=Q1,o0=X0;return ge(),Fe("div",_n,[ie("div",fn,[Q(ue,{"list-data":oe(de).speechList,type:"speech"},null,8,["list-data"])]),J.voiceUrl==="custom"?(ge(),Fe("div",vn," 朗读内容：清晨的阳光透过窗帘洒在桌上，温暖而明亮 ")):R0("",!0),z0((ge(),Fe("div",dn,[ie("div",hn,[Q(be,{modelValue:J.voiceUrl,"onUpdate:modelValue":R[0]||(R[0]=je=>J.voiceUrl=je),placeholder:"音色"},{default:xe(()=>[(ge(!0),Fe(k0,null,O0(N.value,(je,Je)=>(ge(),A0(U,{key:Je,value:je.voiceUrl,label:je.voiceName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),J.voiceUrl!=="custom"?(ge(),Fe(k0,{key:0},[ie("div",mn,[Q(Ne,{modelValue:J.prompt,"onUpdate:modelValue":R[1]||(R[1]=je=>J.prompt=je),placeholder:"请输入提示词",onKeyup:it(fe,["enter"])},null,8,["modelValue"])]),ie("div",null,[Q(De,{class:"dark:bg-purple-heavy",circle:"",onClick:fe},{default:xe(()=>[Q(Re)]),_:1})])],64)):(ge(),Fe(k0,{key:1},[Q(Ne,{modelValue:se.value,"onUpdate:modelValue":R[2]||(R[2]=je=>se.value=je),placeholder:"请输入音色名称"},null,8,["modelValue"]),ie("div",pn,[Z.value?(ge(),A0(l0,{key:1,content:"停止录音"},{default:xe(()=>[Q(Ke,{size:"18",onClick:q},{default:xe(()=>[Q(qe)]),_:1})]),_:1})):(ge(),A0(l0,{key:0,content:"开始/重新录音"},{default:xe(()=>[Q(Ke,{size:"18",onClick:V},{default:xe(()=>[Q(r0)]),_:1})]),_:1})),b.value?(ge(),A0(l0,{key:2,content:"试听录音"},{default:xe(()=>[Q(Ke,{size:"18",onClick:ye},{default:xe(()=>[Q(_e)]),_:1})]),_:1})):R0("",!0),b.value?(ge(),A0(l0,{key:3,content:"克隆录音"},{default:xe(()=>[Q(De,{type:"primary",circle:"",onClick:W},{default:xe(()=>[Q(P),R[3]||(R[3]=I0(" >"))]),_:1})]),_:1})):R0("",!0)])],64))])),[[o0,ce.value]])])}}}),S1=Y0(bn,[["__scopeId","data-v-6219a4f2"]]),xn="data:image/svg+xml,%3csvg%20width='39'%20height='39'%20viewBox='0%200%2039%2039'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M38.1431%2019.5715C38.1431%2024.497%2036.1864%2029.2208%2032.7036%2032.7036C29.2208%2036.1864%2024.497%2038.1431%2019.5715%2038.1431C14.6461%2038.1431%209.92231%2036.1864%206.43948%2032.7036C2.95664%2029.2208%201%2024.497%201%2019.5715M38.1431%2019.5715C38.1431%2014.6461%2036.1864%209.92231%2032.7036%206.43948C29.2208%202.95664%2024.497%201%2019.5715%201C14.6461%201%209.92231%202.95664%206.43948%206.43948C2.95664%209.92231%201%2014.6461%201%2019.5715M38.1431%2019.5715H1'%20stroke='black'%20stroke-width='1.71429'%20stroke-linecap='round'%20stroke-linejoin='round'%20/%3e%3cpath%20d='M26.7145%2019.5715C26.3636%2026.363%2023.8621%2032.8669%2019.5716%2038.1431C15.2811%2032.8669%2012.7796%2026.363%2012.4287%2019.5715C12.7796%2012.7801%2015.2811%206.27618%2019.5716%201C23.8621%206.27618%2026.3636%2012.7801%2026.7145%2019.5715Z'%20stroke='black'%20stroke-width='1.71429'%20stroke-linecap='round'%20stroke-linejoin='round'%20/%3e%3c/svg%3e",yn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='44'%20height='36'%20viewBox='0%200%2044%2036'%20fill='none'%3e%3cpath%20d='M3.95022%2036C2.82415%2036%201.88467%2035.604%201.13178%2034.812C0.378889%2034.02%200.00162963%2033.0309%200%2031.8446V4.15543C0%202.97086%200.377259%201.98257%201.13178%201.19057C1.8863%200.398571%202.82496%200.00171429%203.94778%200H14.4833C15.0097%200%2015.5214%200.111429%2016.0184%200.334286C16.5155%200.560572%2016.9408%200.859714%2017.2944%201.23171L21.0124%205.14286H40.0522C41.1767%205.14286%2042.1161%205.53971%2042.8707%206.33343C43.6252%207.12714%2044.0016%208.11543%2044%209.29829V31.8471C44%2033.03%2043.6236%2034.0183%2042.8707%2034.812C42.1178%2035.6057%2041.1783%2036.0017%2040.0522%2036H3.95022ZM3.95022%2033.4286H40.0522C40.4906%2033.4286%2040.8507%2033.2803%2041.1327%2032.9837C41.4146%2032.6871%2041.5555%2032.3083%2041.5555%2031.8471V9.29571C41.5555%208.83457%2041.4146%208.45571%2041.1327%208.15914C40.8507%207.86257%2040.4906%207.71428%2040.0522%207.71428H20.0322L15.5613%203.01628C15.4049%202.85171%2015.2403%202.73686%2015.0676%202.67171C14.8981%202.60486%2014.7204%202.57143%2014.5347%202.57143H3.95022C3.51185%202.57143%203.1517%202.71971%202.86978%203.01628C2.58785%203.31286%202.44607%203.69257%202.44444%204.15543V31.8471C2.44444%2032.3083%202.58541%2032.6871%202.86733%2032.9837C3.14926%2033.2803%203.51022%2033.4286%203.95022%2033.4286ZM28.1111%2021.8571V25.7143C28.1111%2026.0811%2028.2276%2026.3871%2028.4607%2026.6323C28.6937%2026.8774%2028.9846%2027%2029.3333%2027C29.6821%2027%2029.973%2026.8774%2030.206%2026.6323C30.439%2026.3871%2030.5556%2026.0811%2030.5556%2025.7143V21.8571H34.2222C34.571%2021.8571%2034.8619%2021.7346%2035.0949%2021.4894C35.3279%2021.2443%2035.4444%2020.9383%2035.4444%2020.5714C35.4444%2020.2046%2035.3279%2019.8986%2035.0949%2019.6534C34.8619%2019.4083%2034.571%2019.2857%2034.2222%2019.2857H30.5556V15.4286C30.5556%2015.0634%2030.439%2014.7574%2030.206%2014.5106C29.973%2014.2637%2029.6821%2014.1411%2029.3333%2014.1429C28.9846%2014.1446%2028.6937%2014.2671%2028.4607%2014.5106C28.2276%2014.754%2028.1111%2015.06%2028.1111%2015.4286V19.2857H24.4444C24.0973%2019.2857%2023.8064%2019.4083%2023.5718%2019.6534C23.3371%2019.8986%2023.2206%2020.2046%2023.2222%2020.5714C23.2239%2020.9383%2023.3404%2021.2443%2023.5718%2021.4894C23.8032%2021.7346%2024.0941%2021.8571%2024.4444%2021.8571H28.1111Z'%20fill='black'%20/%3e%3c/svg%3e",wn="/assets/text-Bawtd9wL.svg",Sn="/assets/image-u_BKjo-Z.svg",Cn="/assets/audio-CJrvzMXN.svg",gn="data:image/svg+xml,%3csvg%20width='47'%20height='35'%20viewBox='0%200%2047%2035'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M24.5587%2025.2417C27.1992%2023.8368%2029.2941%2021.5893%2030.5101%2018.8567C31.7261%2016.1241%2031.9934%2013.0633%2031.2694%2010.1613C30.5455%207.2593%2028.8719%204.68272%2026.5149%202.84145C24.1578%201.00019%2021.2528%200%2018.2618%200C15.2709%200%2012.3658%201.00019%2010.0088%202.84145C7.65176%204.68272%205.97816%207.2593%205.25421%2010.1613C4.53026%2013.0633%204.79755%2016.1241%206.01356%2018.8567C7.22957%2021.5893%209.32445%2023.8368%2011.9649%2025.2417C7.49619%2026.5051%203.45807%2029.1315%200.262913%2032.936C0.066299%2033.1846%20-0.0257691%2033.4999%200.0062336%2033.8152C0.0382363%2034.1305%200.191793%2034.421%200.434339%2034.6249C0.676885%2034.8289%200.989344%2034.9304%201.30545%2034.9078C1.62156%2034.8853%201.91646%2034.7405%202.1276%2034.5042C6.29979%2029.5459%2012.0279%2026.8138%2018.2618%2026.8138C24.4957%2026.8138%2030.2259%2029.5459%2034.392%2034.5042C34.4932%2034.6321%2034.619%2034.7384%2034.7621%2034.8168C34.9051%2034.8952%2035.0625%2034.9441%2035.2247%2034.9606C35.387%2034.977%2035.551%2034.9608%2035.7069%2034.9127C35.8627%2034.8646%2036.0074%2034.7858%2036.1322%2034.6808C36.2571%2034.5758%2036.3596%2034.4468%2036.4336%2034.3015C36.5077%2034.1562%2036.5519%2033.9974%2036.5635%2033.8347C36.5751%2033.672%2036.5539%2033.5086%2036.5012%2033.3543C36.4485%2033.1999%2036.3653%2033.0577%2036.2567%2032.936C33.0615%2029.1315%2029.0274%2026.5051%2024.5587%2025.2417ZM7.29307%2013.4076C7.29307%2011.2382%207.93638%209.11749%209.14164%207.31369C10.3469%205.50988%2012.06%204.10399%2014.0643%203.27379C16.0685%202.44359%2018.274%202.22638%2020.4017%202.64961C22.5294%203.07284%2024.4839%204.11751%2026.0179%205.65152C27.5519%207.18553%2028.5966%209.13997%2029.0198%2011.2677C29.443%2013.3954%2029.2258%2015.6009%2028.3956%2017.6052C27.5654%2019.6094%2026.1595%2021.3225%2024.3557%2022.5278C22.5519%2023.733%2020.4312%2024.3763%2018.2618%2024.3763C15.3537%2024.3731%2012.5656%2023.2165%2010.5093%2021.1601C8.45296%2019.1038%207.2963%2016.3157%207.29307%2013.4076ZM38.0706%204.95557C39.2072%207.62843%2039.793%2010.5031%2039.793%2013.4076C39.793%2016.3121%2039.2072%2019.1868%2038.0706%2021.8596C37.9287%2022.1323%2037.689%2022.3412%2037.3996%2022.4446C37.1101%2022.548%2036.7923%2022.5383%2036.5098%2022.4173C36.2272%2022.2963%2036.0008%2022.0731%2035.8759%2021.7922C35.751%2021.5114%2035.7368%2021.1938%2035.8362%2020.9029C36.8441%2018.5326%2037.3636%2015.9833%2037.3636%2013.4076C37.3636%2010.8319%2036.8441%208.28262%2035.8362%205.91228C35.7368%205.62144%2035.751%205.30379%2035.8759%205.02296C36.0008%204.74213%2036.2272%204.51887%2036.5098%204.39789C36.7923%204.27691%2037.1101%204.26715%2037.3996%204.37057C37.689%204.47398%2037.9287%204.68293%2038.0706%204.95557ZM46.2931%2013.4076C46.3003%2017.2043%2045.5317%2020.9625%2044.0343%2024.4515C43.8944%2024.7286%2043.654%2024.9418%2043.3622%2025.0477C43.0704%2025.1536%2042.7492%2025.1441%2042.4642%2025.0213C42.1791%2024.8985%2041.9516%2024.6715%2041.8282%2024.3867C41.7048%2024.1019%2041.6947%2023.7807%2041.7999%2023.4887C43.1605%2020.3019%2043.8619%2016.8727%2043.8619%2013.4076C43.8619%209.94252%2043.1605%206.5133%2041.7999%203.3265C41.6947%203.0345%2041.7048%202.71332%2041.8282%202.42852C41.9516%202.14371%2042.1791%201.91673%2042.4642%201.79389C42.7492%201.67106%2043.0704%201.66162%2043.3622%201.76751C43.654%201.87339%2043.8944%202.08662%2044.0343%202.36369C45.5317%205.8527%2046.3003%209.61087%2046.2931%2013.4076Z'%20fill='black'%20/%3e%3c/svg%3e",Mn="/assets/video-BzvmtkKS.svg",An="/assets/clip-hUlHHzXQ.svg",kn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"};function Tn(ke,de){return ge(),Fe("svg",kn,de[0]||(de[0]=[ie("path",{fill:"currentColor",d:"M544 864V672h128L512 480L352 672h128v192H320v-1.6c-5.376.32-10.496 1.6-16 1.6A240 240 0 0 1 64 624c0-123.136 93.12-223.488 212.608-237.248A239.81 239.81 0 0 1 512 192a239.87 239.87 0 0 1 235.456 194.752c119.488 13.76 212.48 114.112 212.48 237.248a240 240 0 0 1-240 240c-5.376 0-10.56-1.28-16-1.6v1.6z"},null,-1)]))}const Pt={name:"ep-upload-filled",render:Tn};function C2(ke){return G0(J1)}function g2(ke){const de=ea(ta.records,ke.page,ke.pageSize);return G0({records:de.records,total:de.total})}function En(ke,de){return G0(aa)}function Bn(ke){return G0(ra)}const Rn={class:"flex flex-col w-full"},In={class:"upload-container"},Ln=E0({__name:"AILayout",setup(ke){const de=v1(),ce=a0(!1),N=a0([]),J=J0({style:"画册排版",productName:"",keyword:""}),se=async()=>{try{if(ce.value=!0,N.value.length===0){V0.error("请选择图片压缩包再上传");return}const C=N.value[0].raw,b=await En(C,J);ce.value=!1,de.loading=!0,await de.addTemplate(b)}finally{de.loading=!1,ce.value=!1}};return(C,b)=>{const Z=Z0,V=Ht,q=Dt,ye=Pt,W=$0,fe=Ft,H=j0,T=X0;return z0((ge(),Fe("div",Rn,[Q(q,{size:"default"},{default:xe(()=>[Q(V,{label:"布局风格"},{default:xe(()=>[Q(Z,{disabled:"",modelValue:oe(J).style,"onUpdate:modelValue":b[0]||(b[0]=R=>oe(J).style=R)},null,8,["modelValue"])]),_:1}),Q(V,{label:"产品名称"},{default:xe(()=>[Q(Z,{modelValue:oe(J).productName,"onUpdate:modelValue":b[1]||(b[1]=R=>oe(J).productName=R)},null,8,["modelValue"])]),_:1}),Q(V,{label:"关键词"},{default:xe(()=>[Q(Z,{modelValue:oe(J).keyword,"onUpdate:modelValue":b[2]||(b[2]=R=>oe(J).keyword=R)},null,8,["modelValue"])]),_:1})]),_:1}),ie("div",In,[Q(fe,{"file-list":oe(N),"onUpdate:fileList":b[3]||(b[3]=R=>nt(N)?N.value=R:null),drag:"",action:"","auto-upload":!1,accept:".zip",limit:1},{default:xe(()=>[Q(W,{class:"el-icon--upload mt-2",size:"60"},{default:xe(()=>[Q(ye)]),_:1}),b[4]||(b[4]=ie("div",{class:"el-upload__text !mt-[-10px] mb-4"},[I0(" 拖拽图片压缩包到此 或 "),ie("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),Q(H,{size:"default",class:"mt-4 w-full",onClick:se},{default:xe(()=>b[5]||(b[5]=[I0(" 生成 ")])),_:1})])),[[T,oe(ce)]])}}}),Vn=Y0(Ln,[["__scopeId","data-v-7584b142"]]),Hn={class:"flex flex-col w-full h-full overflow-hidden"},Dn={class:"flex-1 px-2 w-full overflow-auto"},Nn={class:"grid grid-cols-2 gap-4"},On=["src"],Fn={class:"mt-6 flex justify-around"},Pn=E0({__name:"AIStoryboard",setup(ke){const de=v1(),ce=o1(),N=mt(),J=na(),se=a0(!1),C=J0({prompt:"",modelUuid:"",trigger:""}),b=a0([]),Z=async()=>{var ye,W;try{se.value=!0,C.trigger=(W=(ye=ce.savedModelList.find(fe=>fe.modelUuid===C.modelUuid))==null?void 0:ye.trainParam)==null?void 0:W.conceptSentence,b.value=await Bn(C)}finally{se.value=!1}},V=async()=>{try{if(!b.value.length)return;de.loading=!0,await de.addStory(b.value)}finally{de.loading=!1}},q=async()=>{if(!b.value.length)return;J.push("/editor");let ye=0;for(let W=0;W<b.value.length;W++){const fe=b.value[W],H=Nt(fe);H.type="image",H.duration=4;const T=await N.createTrack(H,ye);N.addTrack(T),ye+=H.duration*Ot}};return(ye,W)=>{const fe=ct,H=ut,T=Ht,R=Z0,ue=Dt,U=j0,be=yt,Ne=X0;return z0((ge(),Fe("div",Hn,[Q(ue,{size:"default"},{default:xe(()=>[Q(T,{label:"模型"},{default:xe(()=>[Q(H,{modelValue:oe(C).modelUuid,"onUpdate:modelValue":W[0]||(W[0]=Re=>oe(C).modelUuid=Re)},{default:xe(()=>[(ge(!0),Fe(k0,null,O0(oe(ce).savedModelList,Re=>(ge(),A0(fe,{key:Re.modelUuid,label:Re.modelName,value:Re.modelUuid},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Q(T,{label:"提示词"},{default:xe(()=>[Q(R,{modelValue:oe(C).prompt,"onUpdate:modelValue":W[1]||(W[1]=Re=>oe(C).prompt=Re)},null,8,["modelValue"])]),_:1})]),_:1}),Q(U,{size:"default",class:"mt-2 w-full",onClick:Z},{default:xe(()=>W[2]||(W[2]=[I0("生成")])),_:1}),W[5]||(W[5]=ie("div",{class:"mt-6 mb-4 font-semibold text-base text-center"},"故事板",-1)),ie("div",Dn,[oe(b).length?(ge(),Fe(k0,{key:0},[ie("div",Nn,[(ge(!0),Fe(k0,null,O0(oe(b),(Re,De)=>(ge(),Fe("div",{key:De},[ie("img",{src:Re.url,alt:""},null,8,On)]))),128))]),ie("div",Fn,[Q(U,{class:"!bg-purple-heavy hover:bg-transparent !text-white",onClick:V},{default:xe(()=>W[3]||(W[3]=[I0(" 添加画板 ")])),_:1}),Q(U,{class:"!bg-purple-heavy hover:bg-transparent !text-white",onClick:q},{default:xe(()=>W[4]||(W[4]=[I0(" 添加剪辑区 ")])),_:1})])],64)):(ge(),A0(be,{key:1,class:"h-full",description:"暂无结果"}))])])),[[Ne,oe(se)]])}}}),zn=Y0(Pn,[["__scopeId","data-v-4c7b8c5d"]]),Un={class:"w-full h-full overflow-hidden flex flex-col items-center"},$n={class:"flex items-center w-full gap-4"},Gn={class:"flex-1"},jn={class:"flex-1 w-full px-4 h-full overflow-auto"},Xn={key:0,class:"w-full flex flex-col gap-6"},Yn={class:"text-xs text-silver-800 mb-2"},qn={key:1},Zn={class:"mt-10 mb-6 flex justify-around"},Wn=E0({__name:"AnalyzeVideo",setup(ke){const de=a0(!1),ce=a0(!1),N=mt(),J=J0({link:"",path:"",url:""}),se=a0({workflowId:10,scenes:[]}),C=a0(""),b=a0(null),Z=()=>{var W;(W=b.value)==null||W.click()},V=async W=>{var T;const H=(T=W.target.files)==null?void 0:T[0];if(H){if(H.size>104857600){V0.error("文件大小超过100MB，请重新上传");return}de.value=!0,C.value=H.name;const ue=await _1();J.path=ue.path,J.url=ue.url,de.value=!1}},q=async()=>{if(!J.url&&!J.link){V0.warning("请输入链接或上传视频文件");return}de.value=!0;try{if(J.link){const W=await Jt({url:J.link});se.value=W}if(J.path){const W=await Jt(J);se.value=W}}finally{J.link="",de.value=!1}},ye=async()=>{ce.value=!0;try{if(!J.url||!J.path||!se.value)return;const W=await la(J.url,J.path,se.value);se.value=W;let fe=0;for(let H=0;H<se.value.scenes.length;H++){const T=se.value.scenes[H],R=Nt(T);R.type="video";const ue=await N.createTrack(R,fe);ue.silent=!0,N.addTrack(ue),fe+=R.duration*Ot}}finally{ce.value=!1}};return(W,fe)=>{const H=$0,T=Z0,R=ot,ue=j0,U=yt,be=X0;return z0((ge(),Fe("div",Un,[fe[2]||(fe[2]=ie("div",{class:"mt-2 mb-4 font-semibold text-base"},"视频上传",-1)),z0((ge(),Fe("div",$n,[ie("div",Gn,[Q(T,{modelValue:oe(J).link,"onUpdate:modelValue":fe[0]||(fe[0]=Ne=>oe(J).link=Ne),class:"mr-4",placeholder:oe(J).url?`上传文件：${oe(C)}`:"输入链接或上传（大小不超过100MB）",onKeyup:it(q,["enter"])},{suffix:xe(()=>[Q(H,{class:"cursor-pointer",size:"18",onClick:Z},{default:xe(()=>[Q(oe(sa))]),_:1}),ie("input",{ref_key:"fileInputRef",ref:b,class:"file-input",type:"file",name:"file",accept:"video/*",hidden:"",onChange:V},null,544)]),_:1},8,["modelValue","placeholder"])]),Q(ue,{class:"dark:bg-purple-heavy",circle:"",onClick:q},{default:xe(()=>[Q(R)]),_:1})])),[[be,oe(de)]]),fe[3]||(fe[3]=ie("div",{class:"mt-10 mb-6 font-semibold text-base"},"解析结果",-1)),ie("div",jn,[oe(se).scenes.length?(ge(),Fe("div",Xn,[(ge(!0),Fe(k0,null,O0(oe(se).scenes,(Ne,Re)=>(ge(),Fe("div",{key:Re},[ie("div",Yn," 镜头时间："+B0(Ne.startTime)+"s - "+B0(Ne.endTime)+"s ",1),Q(T,{class:"w-full",autosize:{minRows:1,maxRows:6},modelValue:oe(se).scenes[Re].description,"onUpdate:modelValue":De=>oe(se).scenes[Re].description=De,type:"textarea",placeholder:"画面描述"},null,8,["modelValue","onUpdate:modelValue"])]))),128))])):(ge(),Fe("div",qn,[Q(U,{class:"mt-10",description:"暂无结果"})]))]),ie("div",Zn,[Q(ue,{class:"!bg-purple-heavy hover:bg-transparent !text-white",disabled:!oe(se).workflowId,onClick:ye},{default:xe(()=>fe[1]||(fe[1]=[I0("生成视频流")])),_:1},8,["disabled"])])])),[[be,oe(ce)]])}}}),Kn=Y0(Wn,[["__scopeId","data-v-d3e3b6b5"]]);async function M2(ke,de){return G0(ia)}async function A2(ke,de,ce){return G0(oa)}async function k2(ke,de){return G0(ca)}async function Qn(ke){return G0(d1)}async function Jn(ke,de){return G0({success:!0,name:ke,batchUuid:"batch-uuid-"+Date.now()})}async function e2(){return G0(ua)}async function t2(ke,de){return G0(d1)}const a2={class:"w-full h-full overflow-hidden flex flex-col items-center"},r2={class:"flex flex-col w-full gap-4"},n2={class:"upload-container"},s2={class:"flex-1 w-full px-4 h-full overflow-auto"},l2=["src"],i2={class:"mt-6 flex justify-around"},o2=E0({__name:"RandomClip",setup(ke){const de=mt(),ce=a0(!1),N=a0([]),J=a0(),se=async()=>{try{if(ce.value=!0,N.value.length===0){V0.error("请选择图片压缩包再上传");return}const Z=N.value[0].raw,V=await Qn(Z);J.value=V}finally{ce.value=!1}},C=async()=>{if(!J.value)return;let Z=0;for(let V=0;V<J.value.scenes.length;V++){const q=J.value.scenes[V],ye=Nt(q);ye.type="video";const W=await de.createTrack(ye,Z);W.silent=!0,de.addTrack(W),Z+=ye.duration*Ot}},b=async()=>{if(!J.value)return;const V=await(await fetch(J.value.record.url)).blob(),q=await _a();await q.write(V),await q.close()};return(Z,V)=>{var R,ue;const q=Pt,ye=$0,W=Ft,fe=j0,H=yt,T=X0;return ge(),Fe("div",a2,[V[5]||(V[5]=ie("div",{class:"mt-2 mb-4 font-semibold text-base"},"素材包上传",-1)),z0((ge(),Fe("div",r2,[ie("div",n2,[Q(W,{"file-list":oe(N),"onUpdate:fileList":V[0]||(V[0]=U=>nt(N)?N.value=U:null),drag:"",action:"","auto-upload":!1,accept:".zip",limit:1},{default:xe(()=>[Q(ye,{class:"el-icon--upload mt-2",size:"60"},{default:xe(()=>[Q(q)]),_:1}),V[1]||(V[1]=ie("div",{class:"el-upload__text !mt-[-10px] mb-4"},[I0(" 拖拽视频压缩包到此 或 "),ie("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),Q(fe,{class:"w-full",onClick:se},{default:xe(()=>V[2]||(V[2]=[I0(" 生成随机剪辑视频 ")])),_:1})])),[[T,oe(ce)]]),V[6]||(V[6]=ie("div",{class:"mt-8 mb-4 font-semibold text-base"},"剪辑结果",-1)),ie("div",s2,[(ue=(R=oe(J))==null?void 0:R.record)!=null&&ue.url?(ge(),Fe(k0,{key:0},[ie("video",{class:"w-full",src:oe(J).record.url,controls:""},null,8,l2),ie("div",i2,[Q(fe,{class:"!bg-purple-heavy hover:bg-transparent !text-white",onClick:C},{default:xe(()=>V[3]||(V[3]=[I0(" 添加剪辑区 ")])),_:1}),Q(fe,{class:"!bg-purple-heavy hover:bg-transparent !text-white",onClick:b},{default:xe(()=>V[4]||(V[4]=[I0(" 保存视频 ")])),_:1})])],64)):(ge(),A0(H,{key:1,class:"h-full",description:"暂无结果"}))])])}}}),c2=Y0(o2,[["__scopeId","data-v-c36e7cec"]]),u2={class:"w-full h-full overflow-hidden flex flex-col items-center"},_2={class:"flex flex-col w-full"},f2={class:"upload-container"},v2={class:"flex flex-col w-full"},d2={class:"flex-1 w-full px-4 h-full overflow-auto"},h2=["src"],m2={class:"mt-6 flex justify-around"},p2=E0({__name:"ProAIClip",setup(ke){const de=mt(),ce=a0(!1),N=a0(""),J=a0([]),se=a0(),C=a0(!1),b=a0(""),Z=a0(),V=a0(),q=async()=>{try{if(ce.value=!0,J.value.length===0){V0.error("请选择图片压缩包再上传");return}const H=J.value[0].raw;await Jn(N.value,H),fe()}finally{ce.value=!1}},ye=async()=>{try{if(C.value=!0,!Z.value){V0.error("请选择预剪辑结果");return}V.value=await t2(b.value,Z.value)}finally{C.value=!1}},W=async()=>{if(!V.value)return;const H=await de.createTrack(V.value);de.addTrack(H)},fe=async()=>{const H=await e2();se.value=H};return f1(fe),(H,T)=>{const R=Z0,ue=Ht,U=Dt,be=Pt,Ne=$0,Re=Ft,De=j0,r0=ct,Ke=ut,l0=yt,qe=X0;return ge(),Fe("div",u2,[T[8]||(T[8]=ie("div",{class:"mt-2 mb-4 font-semibold text-base"},"素材包上传",-1)),z0((ge(),Fe("div",_2,[Q(U,null,{default:xe(()=>[Q(ue,{label:"名称"},{default:xe(()=>[Q(R,{placeholder:"输入预剪辑名称",modelValue:oe(N),"onUpdate:modelValue":T[0]||(T[0]=_e=>nt(N)?N.value=_e:null)},null,8,["modelValue"])]),_:1})]),_:1}),ie("div",f2,[Q(Re,{"file-list":oe(J),"onUpdate:fileList":T[1]||(T[1]=_e=>nt(J)?J.value=_e:null),drag:"",action:"","auto-upload":!1,accept:".zip",limit:1},{default:xe(()=>[Q(Ne,{class:"el-icon--upload mt-2",size:"60"},{default:xe(()=>[Q(be)]),_:1}),T[4]||(T[4]=ie("div",{class:"el-upload__text !mt-[-10px] mb-4"},[I0(" 拖拽视频压缩包到此 或 "),ie("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),Q(De,{class:"w-full mt-2",onClick:q},{default:xe(()=>T[5]||(T[5]=[I0(" 根据素材预剪辑 ")])),_:1})])),[[qe,oe(ce)]]),T[9]||(T[9]=ie("div",{class:"mt-6 mb-4 font-semibold text-base"},"剪辑生成",-1)),ie("div",v2,[Q(U,null,{default:xe(()=>[Q(ue,{label:"提示词"},{default:xe(()=>[Q(R,{placeholder:"提示词",modelValue:oe(b),"onUpdate:modelValue":T[2]||(T[2]=_e=>nt(b)?b.value=_e:null)},null,8,["modelValue"])]),_:1}),Q(ue,{label:"预剪辑片段"},{default:xe(()=>[Q(Ke,{modelValue:oe(Z),"onUpdate:modelValue":T[3]||(T[3]=_e=>nt(Z)?Z.value=_e:null),placeholder:"请选择"},{default:xe(()=>[(ge(!0),Fe(k0,null,O0(oe(se),_e=>(ge(),A0(r0,{key:_e.batchUuid,label:_e.name,value:_e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),Q(De,{class:"w-full",onClick:ye},{default:xe(()=>T[6]||(T[6]=[I0(" 生成剪辑内容 ")])),_:1})]),T[10]||(T[10]=ie("div",{class:"mt-6 mb-4 font-semibold text-base"},"剪辑结果",-1)),ie("div",d2,[oe(V)?(ge(),Fe(k0,{key:0},[ie("video",{class:"w-full",src:oe(V).url,controls:""},null,8,h2),ie("div",m2,[Q(De,{class:"!bg-purple-heavy hover:bg-transparent !text-white",onClick:W},{default:xe(()=>T[7]||(T[7]=[I0(" 添加剪辑区 ")])),_:1})])],64)):(ge(),A0(l0,{key:1,class:"h-full","image-size":100,description:"暂无结果"}))])])}}}),b2=Y0(p2,[["__scopeId","data-v-d31b6e56"]]),T2=[{title:"文本",key:"text",icon:"TextIcon",component:lr},{title:"图片",key:"image",fileType:"image/*",icon:"ImageIcon",component:b1},{title:"音频",key:"music",fileType:"audio/*",icon:"AudioIcon",component:x1},{title:"旁白",key:"speech",fileType:"audio/*",icon:"VoiceIcon",component:S1},{title:"视频",key:"video",fileType:"video/*",icon:"VideoIcon",component:y1}],E2=[{title:"图片",key:"image",fileType:"image/*",icon:"ImageIcon",component:b1},{title:"音频",key:"music",fileType:"audio/*",icon:"AudioIcon",component:x1},{title:"旁白",key:"speech",fileType:"audio/*",icon:"VoiceIcon",component:S1},{title:"视频",key:"video",fileType:"video/*",icon:"VideoIcon",component:y1}],B2=[{title:"视频解析",key:"Video Analysis",icon:"HAnalyzeIcon",iconSize:16,component:Kn},{title:"随机剪辑",key:"Random Clip",icon:"HRdClipIcon",component:c2},{title:"智能剪辑",key:"AI Clip",icon:"HAIClipIcon",iconSize:20,component:b2}],R2=[{title:"智能布局",key:"AI layout",icon:"HLayoutIcon",component:Vn},{title:"故事板",key:"image",icon:"HStoryboardIcon",component:zn}],I2=[{title:"官网首页",icon:xn,key:"home",url:"https://magicmaker.obs.cn-north-4.myhuaweicloud.com/frontends/zoomclip/%E5%AE%98%E7%BD%91%E9%A6%96%E9%A1%B5_batch.mp4"},{title:"新建项目",icon:yn,key:"project",url:"https://magicmaker.obs.cn-north-4.myhuaweicloud.com/frontends/zoomclip/%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE_batch.mp4"},{title:"创意脚本",icon:wn,key:"text",url:"https://magicmaker.obs.cn-north-4.myhuaweicloud.com/frontends/zoomclip/%E6%96%87%E6%9C%AC%E7%94%9F%E6%88%90_batch.mp4"},{title:"图片生成",icon:Sn,key:"image",url:"https://magicmaker.obs.cn-north-4.myhuaweicloud.com/frontends/zoomclip/%E5%9B%BE%E7%89%87%E7%94%9F%E6%88%90_batch.mp4"},{title:"音乐生成",icon:Cn,key:"audio",url:"https://magicmaker.obs.cn-north-4.myhuaweicloud.com/frontends/zoomclip/%E9%9F%B3%E4%B9%90%E7%94%9F%E6%88%90_batch.mp4"},{title:"旁白生成",icon:gn,key:"speech",url:"https://magicmaker.obs.cn-north-4.myhuaweicloud.com/frontends/zoomclip/%E6%97%81%E7%99%BD%E7%94%9F%E6%88%90_batch.mp4"},{title:"视频生成",icon:Mn,key:"video",url:"https://magicmaker.obs.cn-north-4.myhuaweicloud.com/frontends/zoomclip/%E8%A7%86%E9%A2%91%E7%94%9F%E6%88%90_batch.mp4"},{title:"剪辑导出",icon:An,key:"clip",url:"https://magicmaker.obs.cn-north-4.myhuaweicloud.com/frontends/zoomclip/%E5%89%AA%E8%BE%91%E5%8C%BA_batch.mp4"}];export{S2 as C,R2 as D,yt as E,I2 as G,St as _,C2 as a,Ir as b,wt as c,w2 as d,A2 as e,T2 as f,g2 as g,E2 as h,B2 as i,M2 as p,k2 as t};
