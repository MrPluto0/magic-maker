import{m as St,v as Lt,Q as tt,J as N,i as et,p as I,c as at,d as rt}from"./chunk-Z4I3LXIE-keaImZ--.js";import"./chunk-UFIBX7QP-DJDUTK68.js";import{W as At,z}from"./chunk-DORO2AZZ-DsUrfRl-.js";import"./chunk-66ULMTWW-DsF6fhIy.js";import"./chunk-LA3PGSPR-DuQNQ5r_.js";import{u as It}from"./chunk-LA5IGN2Q-C91kziwX.js";import{m as Mt,N as S,d as Nt,X as Bt,H as Et,B as D,w as nt}from"./chunk-4IXHFASB-DHgp_pL0.js";import{E as Tt,I as Ct,a as Rt,V as b,c as q,d as it,X as W,P as st,q as lt,b as P,n as X,i as $,e as Dt,Y as Ut,R as Pt,O as Wt}from"./dist-QNDTTFGF-xyGUN-Ni.js";import{c as x,r as F}from"./index-KuFrev5g.js";x();x();x();x();var Y={normal:zt,vee:Xt,undirected:qt};function $t(a){Y=a}function zt(a,e,t,r){var n=a.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),i=n.append("path").attr("d","M 0 0 L 10 5 L 0 10 z").style("stroke-width",1).style("stroke-dasharray","1,0");N(i,t[r+"Style"]),t[r+"Class"]&&i.attr("class",t[r+"Class"])}function Xt(a,e,t,r){var n=a.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),i=n.append("path").attr("d","M 0 0 L 10 5 L 0 10 L 4 5 z").style("stroke-width",1).style("stroke-dasharray","1,0");N(i,t[r+"Style"]),t[r+"Class"]&&i.attr("class",t[r+"Class"])}function qt(a,e,t,r){var n=a.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),i=n.append("path").attr("d","M 0 5 L 10 5").style("stroke-width",1).style("stroke-dasharray","1,0");N(i,t[r+"Style"]),t[r+"Class"]&&i.attr("class",t[r+"Class"])}x();x();x();function Yt(a,e){var t=a;return t.node().appendChild(e.label),N(t,e.labelStyle),t}x();function Ht(a,e){for(var t=a.append("text"),r=Ot(e.label).split(`
`),n=0;n<r.length;n++)t.append("tspan").attr("xml:space","preserve").attr("dy","1em").attr("x","1").text(r[n]);return N(t,e.labelStyle),t}function Ot(a){for(var e="",t=!1,r,n=0;n<a.length;++n)if(r=a[n],t){switch(r){case"n":e+=`
`;break;default:e+=r}t=!1}else r==="\\"?t=!0:e+=r;return e}function Q(a,e,t){var r=e.label,n=a.append("g");e.labelType==="svg"?Yt(n,e):typeof r!="string"||e.labelType==="html"?tt(n,e):Ht(n,e);var i=n.node().getBBox(),s;switch(t){case"top":s=-e.height/2;break;case"bottom":s=e.height/2-i.height;break;default:s=-i.height/2}return n.attr("transform","translate("+-i.width/2+","+s+")"),n}var H=function(a,e){var t=e.nodes().filter(function(i){return et(e,i)}),r=a.selectAll("g.cluster").data(t,function(i){return i});I(r.exit(),e).style("opacity",0).remove();var n=r.enter().append("g").attr("class","cluster").attr("id",function(i){var s=e.node(i);return s.id}).style("opacity",0).each(function(i){var s=e.node(i),l=b(this);b(this).append("rect");var d=l.append("g").attr("class","label");Q(d,s,s.clusterLabelPos)});return r=r.merge(n),r=I(r,e).style("opacity",1),r.selectAll("rect").each(function(i){var s=e.node(i),l=b(this);N(l,s.style)}),r};function Vt(a){H=a}x();var O=function(a,e){var t=a.selectAll("g.edgeLabel").data(e.edges(),function(n){return at(n)}).classed("update",!0);t.exit().remove(),t.enter().append("g").classed("edgeLabel",!0).style("opacity",0),t=a.selectAll("g.edgeLabel"),t.each(function(n){var i=b(this);i.select(".label").remove();var s=e.edge(n),l=Q(i,e.edge(n),0).classed("label",!0),d=l.node().getBBox();s.labelId&&l.attr("id",s.labelId),S(s,"width")||(s.width=d.width),S(s,"height")||(s.height=d.height)});var r;return t.exit?r=t.exit():r=t.selectAll(null),I(r,e).style("opacity",0).remove(),t};function jt(a){O=a}x();x();function K(a,e){return a.intersect(e)}var V=function(a,e,t){var r=a.selectAll("g.edgePath").data(e.edges(),function(s){return at(s)}).classed("update",!0),n=Kt(r,e);Zt(r,e);var i=r.merge!==void 0?r.merge(n):r;return I(i,e).style("opacity",1),i.each(function(s){var l=b(this),d=e.edge(s);d.elem=this,d.id&&l.attr("id",d.id),rt(l,d.class,(l.classed("update")?"update ":"")+"edgePath")}),i.selectAll("path.path").each(function(s){var l=e.edge(s);l.arrowheadId=Nt("arrowhead");var d=b(this).attr("marker-end",function(){return"url("+Ft(location.href,l.arrowheadId)+")"}).style("fill","none");I(d,e).attr("d",function(u){return Qt(e,u)}),N(d,l.style)}),i.selectAll("defs *").remove(),i.selectAll("defs").each(function(s){var l=e.edge(s),d=t[l.arrowhead];d(b(this),l.arrowheadId,l,"arrowhead")}),i};function Gt(a){V=a}function Ft(a,e){var t=a.split("#")[0];return t+"#"+e}function Qt(a,e){var t=a.edge(e),r=a.node(e.v),n=a.node(e.w),i=t.points.slice(1,t.points.length-1);return i.unshift(K(r,i[0])),i.push(K(n,i[i.length-1])),ot(t,i)}function ot(a,e){var t=(Pt||Wt.line)().x(function(r){return r.x}).y(function(r){return r.y});return(t.curve||t.interpolate)(a.curve),t(e)}function Jt(a){var e=a.getBBox(),t=a.ownerSVGElement.getScreenCTM().inverse().multiply(a.getScreenCTM()).translate(e.width/2,e.height/2);return{x:t.e,y:t.f}}function Kt(a,e){var t=a.enter().append("g").attr("class","edgePath").style("opacity",0);return t.append("path").attr("class","path").attr("d",function(r){var n=e.edge(r),i=e.node(r.v).elem,s=Bt(n.points.length).map(function(){return Jt(i)});return ot(n,s)}),t.append("defs"),t}function Zt(a,e){var t=a.exit();I(t,e).style("opacity",0).remove()}x();var j=function(a,e,t){var r=e.nodes().filter(function(s){return!et(e,s)}),n=a.selectAll("g.node").data(r,function(s){return s}).classed("update",!0);n.exit().remove(),n.enter().append("g").attr("class","node").style("opacity",0),n=a.selectAll("g.node"),n.each(function(s){var l=e.node(s),d=b(this);rt(d,l.class,(d.classed("update")?"update ":"")+"node"),d.select("g.label").remove();var u=d.append("g").attr("class","label"),o=Q(u,l),g=t[l.shape],c=Et(o.node().getBBox(),"width","height");l.elem=this,l.id&&d.attr("id",l.id),l.labelId&&u.attr("id",l.labelId),S(l,"width")&&(c.width=l.width),S(l,"height")&&(c.height=l.height),c.width+=l.paddingLeft+l.paddingRight,c.height+=l.paddingTop+l.paddingBottom,u.attr("transform","translate("+(l.paddingLeft-l.paddingRight)/2+","+(l.paddingTop-l.paddingBottom)/2+")");var h=b(this);h.select(".label-container").remove();var f=g(h,c,l).classed("label-container",!0);N(f,l.style);var w=f.node().getBBox();l.width=w.width,l.height=w.height});var i;return n.exit?i=n.exit():i=n.selectAll(null),I(i,e).style("opacity",0).remove(),n};function te(a){j=a}x();function ee(a,e){var t=a.filter(function(){return!b(this).classed("update")});function r(n){var i=e.node(n);return"translate("+i.x+","+i.y+")"}t.attr("transform",r),I(a,e).style("opacity",1).attr("transform",r),I(t.selectAll("rect"),e).attr("width",function(n){return e.node(n).width}).attr("height",function(n){return e.node(n).height}).attr("x",function(n){var i=e.node(n);return-i.width/2}).attr("y",function(n){var i=e.node(n);return-i.height/2})}x();function ae(a,e){var t=a.filter(function(){return!b(this).classed("update")});function r(n){var i=e.edge(n);return S(i,"x")?"translate("+i.x+","+i.y+")":""}t.attr("transform",r),I(a,e).style("opacity",1).attr("transform",r)}x();function re(a,e){var t=a.filter(function(){return!b(this).classed("update")});function r(n){var i=e.node(n);return"translate("+i.x+","+i.y+")"}t.attr("transform",r),I(a,e).style("opacity",1).attr("transform",r)}x();x();x();function dt(a,e,t,r){var n=a.x,i=a.y,s=n-r.x,l=i-r.y,d=Math.sqrt(e*e*l*l+t*t*s*s),u=Math.abs(e*t*s/d);r.x<n&&(u=-u);var o=Math.abs(e*t*l/d);return r.y<i&&(o=-o),{x:n+u,y:i+o}}function ne(a,e,t){return dt(a,e,e,t)}x();x();function ie(a,e,t,r){var n,i,s,l,d,u,o,g,c,h,f,w,p,v,_;if(n=e.y-a.y,s=a.x-e.x,d=e.x*a.y-a.x*e.y,c=n*t.x+s*t.y+d,h=n*r.x+s*r.y+d,!(c!==0&&h!==0&&Z(c,h))&&(i=r.y-t.y,l=t.x-r.x,u=r.x*t.y-t.x*r.y,o=i*a.x+l*a.y+u,g=i*e.x+l*e.y+u,!(o!==0&&g!==0&&Z(o,g))&&(f=n*l-i*s,f!==0)))return w=Math.abs(f/2),p=s*u-l*d,v=p<0?(p-w)/f:(p+w)/f,p=i*d-n*u,_=p<0?(p-w)/f:(p+w)/f,{x:v,y:_}}function Z(a,e){return a*e>0}function M(a,e,t){var r=a.x,n=a.y,i=[],s=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY;e.forEach(function(f){s=Math.min(s,f.x),l=Math.min(l,f.y)});for(var d=r-a.width/2-s,u=n-a.height/2-l,o=0;o<e.length;o++){var g=e[o],c=e[o<e.length-1?o+1:0],h=ie(a,t,{x:d+g.x,y:u+g.y},{x:d+c.x,y:u+c.y});h&&i.push(h)}return i.length?(i.length>1&&i.sort(function(f,w){var p=f.x-t.x,v=f.y-t.y,_=Math.sqrt(p*p+v*v),E=w.x-t.x,L=w.y-t.y,y=Math.sqrt(E*E+L*L);return _<y?-1:_===y?0:1}),i[0]):(console.log("NO INTERSECTION FOUND, RETURN NODE CENTER",a),a)}x();function J(a,e){var t=a.x,r=a.y,n=e.x-t,i=e.y-r,s=a.width/2,l=a.height/2,d,u;return Math.abs(i)*s>Math.abs(n)*l?(i<0&&(l=-l),d=i===0?0:l*n/i,u=l):(n<0&&(s=-s),d=s,u=n===0?0:s*i/n),{x:t+d,y:r+u}}var G={rect:le,ellipse:oe,circle:de,diamond:ce};function se(a){G=a}function le(a,e,t){var r=a.insert("rect",":first-child").attr("rx",t.rx).attr("ry",t.ry).attr("x",-e.width/2).attr("y",-e.height/2).attr("width",e.width).attr("height",e.height);return t.intersect=function(n){return J(t,n)},r}function oe(a,e,t){var r=e.width/2,n=e.height/2,i=a.insert("ellipse",":first-child").attr("x",-e.width/2).attr("y",-e.height/2).attr("rx",r).attr("ry",n);return t.intersect=function(s){return dt(t,r,n,s)},i}function de(a,e,t){var r=Math.max(e.width,e.height)/2,n=a.insert("circle",":first-child").attr("x",-e.width/2).attr("y",-e.height/2).attr("r",r);return t.intersect=function(i){return ne(t,r,i)},n}function ce(a,e,t){var r=e.width*Math.SQRT2/2,n=e.height*Math.SQRT2/2,i=[{x:0,y:-n},{x:-r,y:0},{x:0,y:n},{x:r,y:0}],s=a.insert("polygon",":first-child").attr("points",i.map(function(l){return l.x+","+l.y}).join(" "));return t.intersect=function(l){return M(t,i,l)},s}function he(){var a=function(e,t){fe(t);var r=U(e,"output"),n=U(r,"clusters"),i=U(r,"edgePaths"),s=O(U(r,"edgeLabels"),t),l=j(U(r,"nodes"),t,G);It(t),re(l,t),ae(s,t),V(i,t,Y);var d=H(n,t);ee(d,t),ge(t)};return a.createNodes=function(e){return arguments.length?(te(e),a):j},a.createClusters=function(e){return arguments.length?(Vt(e),a):H},a.createEdgeLabels=function(e){return arguments.length?(jt(e),a):O},a.createEdgePaths=function(e){return arguments.length?(Gt(e),a):V},a.shapes=function(e){return arguments.length?(se(e),a):G},a.arrows=function(e){return arguments.length?($t(e),a):Y},a}var ue={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:"rect"},pe={arrowhead:"normal",curve:$};function fe(a){a.nodes().forEach(function(e){var t=a.node(e);!S(t,"label")&&!a.children(e).length&&(t.label=e),S(t,"paddingX")&&D(t,{paddingLeft:t.paddingX,paddingRight:t.paddingX}),S(t,"paddingY")&&D(t,{paddingTop:t.paddingY,paddingBottom:t.paddingY}),S(t,"padding")&&D(t,{paddingLeft:t.padding,paddingRight:t.padding,paddingTop:t.padding,paddingBottom:t.padding}),D(t,ue),nt(["paddingLeft","paddingRight","paddingTop","paddingBottom"],function(r){t[r]=Number(t[r])}),S(t,"width")&&(t._prevWidth=t.width),S(t,"height")&&(t._prevHeight=t.height)}),a.edges().forEach(function(e){var t=a.edge(e);S(t,"label")||(t.label=""),D(t,pe)})}function ge(a){nt(a.nodes(),function(e){var t=a.node(e);S(t,"_prevWidth")?t.width=t._prevWidth:delete t.width,S(t,"_prevHeight")?t.height=t._prevHeight:delete t.height,delete t._prevWidth,delete t._prevHeight})}function U(a,e){var t=a.select("g."+e);return t.empty()&&(t=a.append("g").attr("class",e)),t}x();F(Tt(),1);F(Ct(),1);F(Rt(),1);function ct(a,e,t){let r=e.width,n=e.height,i=(r+n)*.9,s=[{x:i/2,y:0},{x:i,y:-i/2},{x:i/2,y:-i},{x:0,y:-i/2}],l=B(a,i,i,s);return t.intersect=function(d){return M(t,s,d)},l}function ht(a,e,t){let r=e.height,n=r/4,i=e.width+2*n,s=[{x:n,y:0},{x:i-n,y:0},{x:i,y:-r/2},{x:i-n,y:-r},{x:n,y:-r},{x:0,y:-r/2}],l=B(a,i,r,s);return t.intersect=function(d){return M(t,s,d)},l}function ut(a,e,t){let r=e.width,n=e.height,i=[{x:-n/2,y:0},{x:r,y:0},{x:r,y:-n},{x:-n/2,y:-n},{x:0,y:-n/2}],s=B(a,r,n,i);return t.intersect=function(l){return M(t,i,l)},s}function pt(a,e,t){let r=e.width,n=e.height,i=[{x:-2*n/6,y:0},{x:r-n/6,y:0},{x:r+2*n/6,y:-n},{x:n/6,y:-n}],s=B(a,r,n,i);return t.intersect=function(l){return M(t,i,l)},s}function ft(a,e,t){let r=e.width,n=e.height,i=[{x:2*n/6,y:0},{x:r+n/6,y:0},{x:r-2*n/6,y:-n},{x:-n/6,y:-n}],s=B(a,r,n,i);return t.intersect=function(l){return M(t,i,l)},s}function gt(a,e,t){let r=e.width,n=e.height,i=[{x:-2*n/6,y:0},{x:r+2*n/6,y:0},{x:r-n/6,y:-n},{x:n/6,y:-n}],s=B(a,r,n,i);return t.intersect=function(l){return M(t,i,l)},s}function yt(a,e,t){let r=e.width,n=e.height,i=[{x:n/6,y:0},{x:r-n/6,y:0},{x:r+2*n/6,y:-n},{x:-2*n/6,y:-n}],s=B(a,r,n,i);return t.intersect=function(l){return M(t,i,l)},s}function xt(a,e,t){let r=e.width,n=e.height,i=[{x:0,y:0},{x:r+n/2,y:0},{x:r,y:-n/2},{x:r+n/2,y:-n},{x:0,y:-n}],s=B(a,r,n,i);return t.intersect=function(l){return M(t,i,l)},s}function vt(a,e,t){let r=e.height,n=e.width+r/4,i=a.insert("rect",":first-child").attr("rx",r/2).attr("ry",r/2).attr("x",-n/2).attr("y",-r/2).attr("width",n).attr("height",r);return t.intersect=function(s){return J(t,s)},i}function wt(a,e,t){let r=e.width,n=e.height,i=[{x:0,y:0},{x:r,y:0},{x:r,y:-n},{x:0,y:-n},{x:0,y:0},{x:-8,y:0},{x:r+8,y:0},{x:r+8,y:-n},{x:-8,y:-n},{x:-8,y:0}],s=B(a,r,n,i);return t.intersect=function(l){return M(t,i,l)},s}function bt(a,e,t){let r=e.width,n=r/2,i=n/(2.5+r/50),s=e.height+i,l="M 0,"+i+" a "+n+","+i+" 0,0,0 "+r+" 0 a "+n+","+i+" 0,0,0 "+-r+" 0 l 0,"+s+" a "+n+","+i+" 0,0,0 "+r+" 0 l 0,"+-s,d=a.attr("label-offset-y",i).insert("path",":first-child").attr("d",l).attr("transform","translate("+-r/2+","+-(s/2+i)+")");return t.intersect=function(u){let o=J(t,u),g=o.x-t.x;if(n!=0&&(Math.abs(g)<t.width/2||Math.abs(g)==t.width/2&&Math.abs(o.y-t.y)>t.height/2-i)){let c=i*i*(1-g*g/(n*n));c!=0&&(c=Math.sqrt(c)),c=i-c,u.y-t.y>0&&(c=-c),o.y+=c}return o},d}function ye(a){a.shapes().question=ct,a.shapes().hexagon=ht,a.shapes().stadium=vt,a.shapes().subroutine=wt,a.shapes().cylinder=bt,a.shapes().rect_left_inv_arrow=ut,a.shapes().lean_right=pt,a.shapes().lean_left=ft,a.shapes().trapezoid=gt,a.shapes().inv_trapezoid=yt,a.shapes().rect_right_inv_arrow=xt}function xe(a){a({question:ct}),a({hexagon:ht}),a({stadium:vt}),a({subroutine:wt}),a({cylinder:bt}),a({rect_left_inv_arrow:ut}),a({lean_right:pt}),a({lean_left:ft}),a({trapezoid:gt}),a({inv_trapezoid:yt}),a({rect_right_inv_arrow:xt})}function B(a,e,t,r){return a.insert("polygon",":first-child").attr("points",r.map(function(n){return n.x+","+n.y}).join(" ")).attr("transform","translate("+-e/2+","+t/2+")")}var ve={addToRender:ye,addToRenderV2:xe},mt={},we=function(a){let e=Object.keys(a);for(let t of e)mt[t]=a[t]},kt=async function(a,e,t,r,n,i){let s=r?r.select(`[id="${t}"]`):b(`[id="${t}"]`),l=n||document,d=Object.keys(a);for(let u of d){let o=a[u],g="default";o.classes.length>0&&(g=o.classes.join(" "));let c=q(o.styles),h=o.text!==void 0?o.text:o.id,f;if(it(W().flowchart.htmlLabels)){let v={label:await st(h.replace(/fa[blrs]?:fa-[\w-]+/g,_=>`<i class='${_.replace(":"," ")}'></i>`),W())};f=tt(s,v).node(),f.parentNode.removeChild(f)}else{let v=l.createElementNS("http://www.w3.org/2000/svg","text");v.setAttribute("style",c.labelStyle.replace("color:","fill:"));let _=h.split(lt.lineBreakRegex);for(let E of _){let L=l.createElementNS("http://www.w3.org/2000/svg","tspan");L.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),L.setAttribute("dy","1em"),L.setAttribute("x","1"),L.textContent=E,v.appendChild(L)}f=v}let w=0,p="";switch(o.type){case"round":w=5,p="rect";break;case"square":p="rect";break;case"diamond":p="question";break;case"hexagon":p="hexagon";break;case"odd":p="rect_left_inv_arrow";break;case"lean_right":p="lean_right";break;case"lean_left":p="lean_left";break;case"trapezoid":p="trapezoid";break;case"inv_trapezoid":p="inv_trapezoid";break;case"odd_right":p="rect_left_inv_arrow";break;case"circle":p="circle";break;case"ellipse":p="ellipse";break;case"stadium":p="stadium";break;case"subroutine":p="subroutine";break;case"cylinder":p="cylinder";break;case"group":p="rect";break;default:p="rect"}P.warn("Adding node",o.id,o.domId),e.setNode(i.db.lookUpDomId(o.id),{labelType:"svg",labelStyle:c.labelStyle,shape:p,label:f,rx:w,ry:w,class:g,style:c.style,id:i.db.lookUpDomId(o.id)})}},_t=async function(a,e,t){let r=0,n,i;if(a.defaultStyle!==void 0){let s=q(a.defaultStyle);n=s.style,i=s.labelStyle}for(let s of a){r++;let l="L-"+s.start+"-"+s.end,d="LS-"+s.start,u="LE-"+s.end,o={};s.type==="arrow_open"?o.arrowhead="none":o.arrowhead="normal";let g="",c="";if(s.style!==void 0){let h=q(s.style);g=h.style,c=h.labelStyle}else switch(s.stroke){case"normal":g="fill:none",n!==void 0&&(g=n),i!==void 0&&(c=i);break;case"dotted":g="fill:none;stroke-width:2px;stroke-dasharray:3;";break;case"thick":g=" stroke-width: 3.5px;fill:none";break}o.style=g,o.labelStyle=c,s.interpolate!==void 0?o.curve=X(s.interpolate,$):a.defaultInterpolate!==void 0?o.curve=X(a.defaultInterpolate,$):o.curve=X(mt.curve,$),s.text===void 0?s.style!==void 0&&(o.arrowheadStyle="fill: #333"):(o.arrowheadStyle="fill: #333",o.labelpos="c",it(W().flowchart.htmlLabels)?(o.labelType="html",o.label=`<span id="L-${l}" class="edgeLabel L-${d}' L-${u}" style="${o.labelStyle}">${await st(s.text.replace(/fa[blrs]?:fa-[\w-]+/g,h=>`<i class='${h.replace(":"," ")}'></i>`),W())}</span>`):(o.labelType="text",o.label=s.text.replace(lt.lineBreakRegex,`
`),s.style===void 0&&(o.style=o.style||"stroke: #333; stroke-width: 1.5px;fill:none"),o.labelStyle=o.labelStyle.replace("color:","fill:"))),o.id=l,o.class=d+" "+u,o.minlen=s.length||1,e.setEdge(t.db.lookUpDomId(s.start),t.db.lookUpDomId(s.end),o,r)}},be=function(a,e){return P.info("Extracting classes"),e.db.getClasses()},me=async function(a,e,t,r){P.info("Drawing flowchart");let{securityLevel:n,flowchart:i}=W(),s;n==="sandbox"&&(s=b("#i"+e));let l=n==="sandbox"?b(s.nodes()[0].contentDocument.body):b("body"),d=n==="sandbox"?s.nodes()[0].contentDocument:document,u=r.db.getDirection();u===void 0&&(u="TD");let o=i.nodeSpacing||50,g=i.rankSpacing||50,c=new Mt({multigraph:!0,compound:!0}).setGraph({rankdir:u,nodesep:o,ranksep:g,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),h,f=r.db.getSubGraphs();for(let y=f.length-1;y>=0;y--)h=f[y],r.db.addVertex(h.id,h.title,"group",void 0,h.classes);let w=r.db.getVertices();P.warn("Get vertices",w);let p=r.db.getEdges(),v=0;for(v=f.length-1;v>=0;v--){h=f[v],Dt("cluster").append("text");for(let y=0;y<h.nodes.length;y++)P.warn("Setting subgraph",h.nodes[y],r.db.lookUpDomId(h.nodes[y]),r.db.lookUpDomId(h.id)),c.setParent(r.db.lookUpDomId(h.nodes[y]),r.db.lookUpDomId(h.id))}await kt(w,c,e,l,d,r),await _t(p,c,r);let _=new he;ve.addToRender(_),_.arrows().none=function(y,m,A,k){let T=y.append("marker").attr("id",m).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 0 0 L 0 0 z");N(T,A[k+"Style"])},_.arrows().normal=function(y,m){y.append("marker").attr("id",m).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowheadPath").style("stroke-width",1).style("stroke-dasharray","1,0")};let E=l.select(`[id="${e}"]`),L=l.select("#"+e+" g");for(_(L,c),L.selectAll("g.node").attr("title",function(){return r.db.getTooltip(this.id)}),r.db.indexNodes("subGraph"+v),v=0;v<f.length;v++)if(h=f[v],h.title!=="undefined"){let y=d.querySelectorAll("#"+e+' [id="'+r.db.lookUpDomId(h.id)+'"] rect'),m=d.querySelectorAll("#"+e+' [id="'+r.db.lookUpDomId(h.id)+'"]'),A=y[0].x.baseVal.value,k=y[0].y.baseVal.value,T=y[0].width.baseVal.value,R=b(m[0]).select(".label");R.attr("transform",`translate(${A+T/2}, ${k+14})`),R.attr("id",e+"Text");for(let C=0;C<h.classes.length;C++)m[0].classList.add(h.classes[C])}if(!i.htmlLabels){let y=d.querySelectorAll('[id="'+e+'"] .edgeLabel .label');for(let m of y){let A=m.getBBox(),k=d.createElementNS("http://www.w3.org/2000/svg","rect");k.setAttribute("rx",0),k.setAttribute("ry",0),k.setAttribute("width",A.width),k.setAttribute("height",A.height),m.insertBefore(k,m.firstChild)}}Ut(c,E,i.diagramPadding,i.useMaxWidth),Object.keys(w).forEach(function(y){let m=w[y];if(m.link){let A=l.select("#"+e+' [id="'+r.db.lookUpDomId(y)+'"]');if(A){let k=d.createElementNS("http://www.w3.org/2000/svg","a");k.setAttributeNS("http://www.w3.org/2000/svg","class",m.classes.join(" ")),k.setAttributeNS("http://www.w3.org/2000/svg","href",m.link),k.setAttributeNS("http://www.w3.org/2000/svg","rel","noopener"),n==="sandbox"?k.setAttributeNS("http://www.w3.org/2000/svg","target","_top"):m.linkTarget&&k.setAttributeNS("http://www.w3.org/2000/svg","target",m.linkTarget);let T=A.insert(function(){return k},":first-child"),R=A.select(".label-container");R&&T.append(function(){return R.node()});let C=A.select(".label");C&&T.append(function(){return C.node()})}}})},ke={setConf:we,addVertices:kt,addEdges:_t,getClasses:be,draw:me},Te={parser:At,db:z,renderer:St,styles:Lt,init:a=>{a.flowchart||(a.flowchart={}),a.flowchart.arrowMarkerAbsolute=a.arrowMarkerAbsolute,ke.setConf(a.flowchart),z.clear(),z.setGen("gen-1")}};export{Te as diagram};
